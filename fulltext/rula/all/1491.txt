Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2010

Power Quality Improvement by Supercapacitor Energy Storage
Irtaza Mohammad Syed
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Power and Energy Commons Recommended Citation
Syed, Irtaza Mohammad, "Power Quality Improvement by Supercapacitor Energy Storage" (2010). Theses and dissertations. Paper 1495.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

Power Quality Improvement by Supercapacitor Energy Storage
by

Irtaza Mohammad Syed B. Eng, NED University of Engineering and Technology Pakistan, 1996

A thesis presented to Ryerson University in partial fulfillment of the requirements for the degree of Master of Applied Science in the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2010

© Irtaza M. Syed, 2010

Author's Declaration

I hereby declare that I am the sole author of this thesis or dissertation. I authorize Ryerson University to lend this thesis or dissertation to other institutions or individuals for the purpose of scholarly research.

_______________ Irtaza M. Syed

I further authorize Ryerson University to reproduce this thesis or dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

_______________ Irtaza M. Syed

~ ii ~

Borrower's Page
Ryerson University requires the signature of all persons using or photocopying this thesis. Please sign below, provide address and date. Name Signature Address Date

~ iii ~

ABSTRACT
Harnessing green and renewable sources of energy is a future solution that addresses rising energy demands and growing environmental concerns. Among these, tapping wind energy using wind turbines appears to be one of the most promising solutions. A wind energy conversion system captures kinetic energy of wind and converts it into electrical energy. By nature, availability of wind energy is stochastic and intermittent. In contrast, electric power system expects a steady and planned supply of energy. This thesis addresses the gap in characteristics of wind energy supply and conventional electric energy demand. This thesis considers a doubly fed induction generator (DFIG) connected to a wind turbine to harness wind energy. The proposed topology connects a Supercapacitor through a buck-boost chopper to the DC link of rotor circuit. The Supercapacitor works to perform the job of a flywheel. The thesis proposes an appropriate control system that controls the output of the DFIG to constant value (PREF) eliminating short-term fluctuations. This control system works to control the buck-boost chopper and works as an inner control loop. Thereafter, this thesis proposes an optimization algorithm that considers short-term forecasted wind speeds (energy) for several minutes. It then optimizes to determine a minimum set of output values of the DFIG (PREF). It ensures that output of the DFIG has minimum changes thus minimizing intermittency in the DFIG output. This optimization algorithm forms the outer loop in the overall control strategy. The complete system is implemented in Matlab/Simulink and analysed in this thesis. The results demonstrate that the inner and outer control loops work to minimize output power oscillations and improve power quality.

~ iv ~

ACKNOWLEDGMENTS
The author expresses his deepest gratitude and appreciation to his supervisors, Professor Dr. Bin Wu and Associate Professor Dr. Bala Venkatesh for their continuous guidance, aspiration, enlightenment, inspiring instruction, encouragement and exceptional support throughout this research. The financial support represented by the NSERC Discovery grant, Canada awarded to Dr. Bala Venkatesh is gratefully acknowledged. The author wishes to thank his parents, siblings, family and friends for their support and encouragement. Finally special thanks to all my instructors, professors and colleagues at Dawood College of Engineering and Technology (NED University) and Ryerson University.

~v~

TABLE OF CONTENTS
ABSTRACT ACKNOWLEDGEMENT LIST OF ABBREVIATIONS / ACRONYMS LIST OF SYMBOLS LIST OF TABLES LIST OF FIGURES CHAPTER 1. INTRODUCTION 1.1 Introduction 1.2 Problem Formulation 2. WIND ENERGY CONVERSION SYSTEM 2.1 Introduction 2.2 WECS Types 2.3 DFIG WECS 3. POWER QUALITY IMPROVEMENT BY SESS 3.1 Introduction 3.2 Supercapacitor 3.3 DC/DC Converter 3.3.1 Sizing of the Inductor 3.3.2 Sizing of the Supercapacitor 3.4 Control System 3.4.1 System Limits Indicator 3.4.2 Pref Setting System 3.4.3 Power Control System 1 1 2 6 6 9 10 19 19 21 26 26 29 33 34 35 36 iv v viii x xiv xv

~ vi ~

3.4.4 Operation Control System 3.5 Operating Principle 3.6 Conclusions 4. SIMULATION RESULTS 4.1 Introduction 4.2 DFIG-WECS Operation without SESS/POA 4.3 DFIG-WECS Operation with SESS/POA 4.4 Conclusions 5. POWER OPTIMIZATION 5.1 Introduction 5.2 Problem Formulation 5.3 Iterative Search Technique 5.3.1 IST Algorithm 5.3.2 IST Results 5.4 Mixed Integer Linear Programming Technique 5.4.1 MILPT Algorithm 5.4.2 MILPT Results 5.5 Effect of SC Initial Energy 5.6 Algorithms Comparison 5.7 Conclusions 6. CONCLUSIONS REFERENCES APPENDICES APPENDIX A: IST APPENDIX B: MILPT APPENDIX C: Simulated System Data

37 39 40 41 41 41 45 49 51 51 51 54 55 55 57 57 57 59 62 65 66 68 71 71 78 84

~ vii ~

LIST OF ABBREVIATIONS/ACRONYMS
BESS DFIG ESR FSFP FSVP GSC IEI IG IGBT IST kW kWh LAB MILPT MPE MPPT MW MWh MWs OCS PCS POA PQI PSS RSC Battery Energy Storage System Doubly Fed Induction Generator Equivalent Series Resistance Fixed Speed Fixed Pitch Fixed Speed Variable Pitch Grid Side Control Instantaneous Energy Indicator Induction Generator Insulated Gate Bipolar Transistor Iterative Search Technique kilo Watt kilo Watt hour Lead Acid Battery Mixed Integer Linear Programming Technique Maximum Power Extraction Maximum Power Point Tracking Mega Watt Mega Watt hour Mega Watt sec Operation Control System Power Control System Power Optimization Algorithm Power Quality Improvement Pref Setting System Rotor Side Control

~ viii ~

SC SESS SLI SMES TSR VSFP VSVP WECS WT

Supercapacitor Supercapacitor Energy Storage System System Limits Indicator Superconductive Magnetic Energy Storage Tip Speed Ratio Variable Speed Fixed Pitch Variable Speed Variable Pitch Wind Energy Conversion System Wind Turbine

~ ix ~

LIST OF SYMBOLS
A Ccell Cdclink Cp Cs Csc Cscmin D Edclink EW EC0 ECmin ECmax Eot Esc ESRs ESRcell ESRsc EC0 Escf Ewt f f1 f2 ids, iqs, idr, iqr Swept area Individual cell capacitance DC-link capacitance Power co-efficient Total series capacitance SC capacitance Supercapacitor minimum capacitance Duty cycle Instantaneous energy of DC-link capacitor Wind Energy SC initial energy Minimum SC energy Maximum SC energy Total output energy in time t Energy of SC Series string resistance Cell individual ESR SC-Bank total ESR SC-Bank initial energy SC-Bank energy at the end of simulation Total wind energy in time t Switching frequency of DC-DC converter Stator source frequency Rotor source frequency Stator and rotor d-q axis currents

~x~

Isc IL ILoff ILon Ls, Lr Lm ns n2 nr np ns NH NX p PC PCt PCmin PCmax Pm Pmeas POt POmax Pr Pref Pref-optimal Ps

SC current Change in inductor current Change in inductor current during toff Change in inductor current during ton Stator and rotor inductances Magnetizing inductance Synchronous speed Rotor flux speed due to f2 Net rotor speed due to WT and f2 Number of SC series strings needed in parallel to form SC -Bank Number of SC cells in series to form SC -Bank Number of hours Number of seconds Number of poles SC power Maximum input in the tth instant Minimum SC power Maximum SC power Mechanical power Measured output power of DFIG-WECS Net output power in the tth instant Maximum output power Rotor power Power reference Optimal Pref Stator power

~ xi ~

Psc PW PWt PWT R Rs and Rr s t td toff ton T Te UDt USt Vcell Vdclink vds, vqs, vdr, vqr Vsc Vscmax Vscmin Vscnom W Windcut-in  

SC-Bank power rating, same WECS Grid Side Converter Rating Wind Power Wind power of the tth instant Power extracted by WT Blades radius Stator and rotor resistances Slip Time Time of fluctuations that we want to eliminate Off-time of DC-DC converter On-time of DC-DC converter Time period of DC-DC converter Electromagnetic torque Variable denoting downward Pref level change Variable denoting upward Pref level change Individual cell voltage DC-link voltage Stator and rotor d-q axis voltages SC voltage Maximum SC voltage Minimum SC voltage Nominal SC voltage Wind speed Wind cut-in speed Pitch angle Tip Speed Ratio (TSR)

~ xii ~

ds, qs, dr, qr opt  r opt s

Stator and rotor flux linkages Optimal  Air density Rotor speed Optimal r Synchronous speed

~ xiii ~

LIST OF TABLES
Table 1: SC and Lead acid battery comparison Table 2: Induction machine data Table 3: Turbine data Table 4: Topology data Table 5: Misc data 23 85 85 85 86

~ xiv ~

LIST OF FIGURES
Figure 1: DFIG-WECS with Proposed Topology Figure 2: Wind Turbine Figure 3: Stationary reference frame model Figure 4: DFIG Speed-frequency relationship Figure 5: DFIG-WECS Figure 6: Proposed Topology Figure 7: SC model Figure 8: SC Bank Figure 9: 2 Q chopper with SC & DC-link Cap Figure 10: Simulation results with D = 0.25 Figure 11: Simulation results with D = 0.75 Figure 12: Control Scheme (Proposed) Figure 13: SLI (Proposed) Figure 14: PSS (Proposed) Figure 15: PCS (Proposed) Figure 16: OCS (Proposed) Figure 17: Wind pattern (120 Sec) Figure 18: Grid Active power (pu) Figure 19: Grid Reactive power (pu) Figure 20: DC-link voltage (V) Figure 21: Grid voltage (V) Figure 22: Phase a Current (A) Figure 23: Grid Active power (pu) Figure 24: Grid Reactive power (pu) Figure 25: DC-link voltage (V) 4 7 12 15 17 20 22 25 27 31 32 33 35 36 37 38 42 42 43 43 44 44 46 46 47

~ xv ~

Figure 26: Grid voltage (V) Figure 27: Phase a Current (A) Figure 28: SC Energy Figure 29: Wind power & Power reference IST Figure 30: Total wind and IST Energy Figure 31: Wind power & Power reference MILPT Figure 32: Total wind and MILPT Energy Figure 33: Power reference with ECo = Min Figure 34: Power reference with ECo = Max Figure 35: Power reference with ECo = 50% Figure 36: Effects of EC0 Figure 37: ECo effect on MILPT Wind Pattern 1 Figure 38: ECo effect on IST Wind Pattern1 Figure 39: ECo effect on MILPT Wind Pattern 2 Figure 40: ECo effect on IST Wind Pattern 2 Figure 41: Pw and Pref for IST (120 Samples) Figure 42: Wind and IST Energy (120 Samples) Figure 43: Pw and Pref for IST (600 Samples) Figure 44: Wind and IST Energy (600 Samples) Figure 45: Pw and Pref for MILPT (120 Samples) Figure 46: Wind and MILPT Energy (120 Samples) Figure 47: Pw and Pref for MILPT (600 Samples) Figure 48: Wind and MILPT Energy (600 Samples) Figure 49: Pw and Pref for MILPT (120 Samples, extreme conditions) Figure 50: Wind and MILPT Energy (120 Samples, extreme conditions)

47 48 48 56 56 58 58 60 60 61 61 63 63 64 64 76 76 77 77 82 82 83 83 84 84

~ xvi ~

Ryerson University

Chapter 1 INTRODUCTION

2010

CHAPTER 1 INTRODUCTION

1.1 INTRODUCTION
Electricity from wind energy is one of the fastest growing methods of electricity generation and its penetration in the world is expected to grow up to 12% of the global demand by 2020 [1] . In this type of electricity generation, kinetic energy from moving air is converted into electricity by wind turbines that are mounted in locations where there are favorable weather patterns. Wind turbines may be employed individually, but are often installed in groups to form wind farms or wind power plants. Electricity generated by wind farms may be used locally or transmitted on the electric grid to power homes and businesses far away. The use of wind energy reduces the environmental impact of generating electricity because it does not require fuel and does not produce pollution or greenhouse gases. While renewable energy is considered as a key solution to reduce green house gas emissions, its inherent intermittent nature poses a big challenge. One of the problems, besides being nondispatch-able and others, is associated with the quality of power generated and thus supplied into the grid. These problems become even bigger when wind generators are connected to a weak grid and due to this reason wind power is restricted in some cases. Thus, the problem of intermittency of renewable energy sources cannot be overlooked [2].

~1~

Ryerson University

Chapter 1 INTRODUCTION

2010

1.2 PROBLEM FORMULATION
Quality of power output from wind generators suffer due to sporadic fluctuations of wind speed. This intermittence, an inherent characteristic of wind, imposes special requirements on the surrounding power system. Thus, wind power systems challenge the power quality, energy planning, power flow controls, and dispensability in the local grid. In some cases, it even restricts integration of the wind power. The horizontal flow of wind consists of two overlapping effects, namely Macro-meteorological and Micro-meteorological fluctuations [3]-[4]. The macro-meteorological fluctuations indicate the movements of large-scale weather patterns such as the day and night cycle, the movement of depressions and cyclones. The micro-meteorological fluctuations originate from the atmospheric turbulence with typical time scales of 1 to 600 seconds. Output of wind generators fluctuate in a similar manner to the wind speeds although they are modified by the physical and electrical characteristics of the wind generator. Experience and research show that power system is more susceptible and sensitive to medium frequency wind power fluctuations (0.01 ~ 1 Hz) [5]-[6]. Integration of an energy storage system into a wind generator can effectively suppress these power fluctuations and thus improve quality of power supplied to the connected grid. Smoothing long-term power fluctuations requires a higher capacity of storage and thus a higher cost. The cost of this solution is the main limiting factor in its application. A short term energy storage solution presents itself as the optimal solution to the problem of short term fluctuations (1 ­ 600 sec) [3]-[4] from size, cost and quality point of view. A variety

~2~

Ryerson University

Chapter 1 INTRODUCTION

2010

of options is available but different factors dictate a choice of Supercapacitor (SC) as an Energy Storage device. Supercapacitor Energy Storage Systems (SESS) are used to reduce voltage flicker, current harmonic elimination, compensation of pulsating load and uninterruptable power supply[7]-[10], but less is done in the field of wind energy[11],[12]. Superconducting Magnetic Energy Storage (SMES) System and Battery Energy Storage System (BESS) have been researched on short term wind power fluctuations smoothing [13], but SESS with less auxiliary equipment is more stable and convenient than SMES and it has longer cycle life and less maintenance compared to BESS. This research thesis focuses on decoupled control of short term power fluctuations with SESS and two quadrant DC-DC converter with an output power optimization algorithm for Doubly Fed Induction Generator (DFIG) based Wind Energy Conversion Systems (WECS). The proposed topology is shown in Figure 1 and verified by simulation in Matlab/Simulink. DFIG-WECS is shown in solid while the proposed topology is shown in shaded and dotted lines. The proposed topology consist of SC-Bank (Energy storage) connected to DFIG-WECS through a DC-DC (Buck-Boost) converter. DC-DC converter is controlled through a proposed control scheme to either extract power from or inject power into the DFIG-WECS based on the optimal power reference set by Power Optimization Algorithm (POA).

~3~

Ryerson University

Chapter 1 INTRODUCTION

2010

Figure 1: DFIG-WECS with proposed topology (dotted line and shaded boxes)

~4~

Ryerson University

Chapter 1 INTRODUCTION

2010

This thesis is organized in the following manner. Chapter 2 provides the basic system being optimized and proposes the use of SESS connected to a DFIG using a chopper. Chapter 3 presents the proposed control algorithm for ensuring that the DFIG outputs a set value of power. It forms the inner control loop. Chapter 4 shows results of simulation for DFIG-WECS both with and without the proposed topology and the proposed inner control algorithm. Chapter 5 proposes two power optimization algorithms and their solution methods that consider a forecasted wind generation and determine the optimal output such that the output is as steady as possible. These optimization algorithms form the outer control loop. The results of this study are discussed. Chapter 6 presents conclusions for the thesis.

~5~

Ryerson University

Chapter 2 WECS

2010

CHAPTER 2 WIND ENERGY CONVERSION SYSTEM

2.1 INTRODUCTION
A wind energy conversion system is a complex system in which knowledge from a wide array of fields comprising Aerodynamics, Mechanical, Civil and Electrical Engineering come together. The principle components of a modern wind turbine are the tower, the rotor and the nacelle, which accommodates the transmission mechanisms and the generator as shown in Figure 2 [21]. The wind turbine captures wind's kinetic energy in the rotor consisting of two or more blades mechanically coupled to an electrical generator. The main component of the mechanical assembly is the gearbox, which transforms the slower rotational speeds of the wind turbine to higher rotational speeds on the electrical generator side. The rotation of the electrical generator's shaft driven by the wind turbine generates electricity, whose output is maintained as per specifications, by employing suitable control and supervising techniques. Besides monitoring the output, these control systems also include protection systems to protect the overall system.

~6~

Ryerson University

Chapter 2 WECS

2010

WECS can either operate at a fixed speed or a range of speeds with a fixed or a variable pitch. Both Synchronous and Induction machines can be employed in WECS. WECS can be employed in isolated grids, on-grid or off-grid applications. Each type of WECS and method of deployment has its own set of advantages and disadvantages.

Figure 2: Wind Turbine [21]

~7~

Ryerson University

Chapter 2 WECS

2010

Wind Energy Conversion System (WECS) is used to capture the energy available in the wind to convert into electrical energy. Energy available in wind is given by EW = ½  A W3 t where EW is wind Energy,  is air density, A is swept area, W is wind speed and t is time. Instantaneous Power can be computed by: PW = ½  A W 3 where PW is a wind Power. Wind power extracted by Wind Turbine (WT) depends on Cp, given by Cp = PWT / PW where Cp is power co-efficient and Cp  59%, known as Betz limit [20]. Combining (2) & (3) PWT = ½  A W3 Cp where PWT is power extracted by WT. Cp is not a constant and is the function of (, ), where  is Tip Speed Ratio (TSR) and  is the pitch angle. Tip Speed Ratio (TSR) is given by  = r . R/ W where R is wind turbine radius and r is generators rotor speed. Consequently, from (4) & (5), for Maximum Power Point Tracking (MPPT) for all wind speeds we need optimal values of  &  for every wind speed. It is obvious then that for MPPT we need a Wind Energy Conversion System (WECS) that allows changes in  &  as W changes. Now as (5) (4) (3) (2) (1)

~8~

Ryerson University every Cp,
optimal

Chapter 2 WECS

2010

has only one optimal value of optimal, therefore it is important to achieve this

optimal for every wind speed (W) by controlling rotor speed. Achieving this optimal for every wind speed (W) ensures maximum power extraction for every W and this process is known as Maximum Power Point Tracking (MPPT) and given by PWt=½A(R opt/opt) 3 Cp where PWt is optimal value of PWT, opt is optimal r and opt is optimal . (6)

2.2 WECS TYPES
Fixed speed WECS are divided into Fixed Speed Fixed Pitch (FSFP) and Fixed Speed Variable Pitch (FSVP). In FSFP, Induction Generator (IG) is directly connected to the Grid, IG speed is locked to grid frequency and maximum conversion is possible at only one wind speed (W). In FSVP, IG is directly connected to the Grid, IG speed is locked to grid frequency and maximum conversion is possible at only one W but also performs better at low wind speed due to variable pitch. Variable speed WECS are divided into Variable Speed Fixed Pitch (VSFP) and Variable Speed Variable Pitch (VSVP). In VSFP, IG is connected to the Grid through power converter, IG speed is not locked to grid frequency and maximum conversion is possible at more than one W but no pitch regulation. In VSVP, IG is connected to the Grid through power converter, IG speed is not locked to grid

~9~

Ryerson University

Chapter 2 WECS

2010

frequency and maximum conversion is possible at more than one W additionally provides pitch regulation. In this work we chose VSVP, which employs a DFIG, based on the reasons outlined below:         Enhanced energy capture in a wide range wind speeds Ability to control active and reactive power Reduced size of power electronics converter (rated at 30% of power generated) Less power losses ( due to reduced size power converter) Improved power quality (reduced tower and flicker effects) Reduced stresses of the mechanical structure Reduced acoustic noise Cost effective

Due to these same reasons, most of the major wind turbine manufactures are developing new wind turbines based on variable-speed operation with pitch control using a direct-driven synchronous generator and DFIG. Therefore, DFIG is the best candidate for larger wind turbines.

2.3 DOUBLY FED INDUCTION GENERATOR WECS
Doubly fed induction generator (DFIG) is modeled using SimPowerSystems blockset [ver. 7.3.0.324] and implements the well-known Park transformation induction machine model in a stationary reference frame, shown in Figure 3 [23]. Voltage equations are: vds= Rsids + pds (7)

~ 10 ~

Ryerson University vqs= Rsiqs + vdr= Rridr + vqr= Rr.iqr + p. + r. - r.

Chapter 2 WECS

2010 (8) (9) (10)

where vds, vqs, vdr, vqr are stator and rotor d-q axis voltages, ids, iqs, idr, iqr are stator and rotor d-q axis currents, Rs and Rr are stator and rotor resistances, r is rotor speed and ds, qs, dr, qr are stator and rotor flux linkages. Flux linkage equations are: ds = Lsids + Lmidr qs = Lsiqs + Lmiqr dr = Lridr + Lmids qr = Lriqr + Lmiqs (11) (12) (13) (14)

where Ls= Lls + Lm and Lr= Llr + Lm and Ls, Lr are stator and rotor inductances, Lm is magnetizing inductance. Torque equation is: Te = 3p/2 (iqsds + idsqs) where Te is electromagnetic torque and p is number of poles. DFIG is a Wound Rotor Induction Machine (WRIM) with stator and rotor connected to different sources, thus doubly fed. Usually stator is directly connected to the grid with a fixed frequency and rotor via frequency converter. The method which involves additional voltage of variable frequency in the rotor winding, based on the fact that for electromechanical power conversion (15)

~ 11 ~

Ryerson University

Chapter 2 WECS

2010

magnetic fields generated by stator and rotor currents must be mutually static, i-e they have to rotate with same speed.

Figure 3: Stationary reference frame model [23] Consider a machine with a stator having p poles that is connected to a source with a frequency of f1 and a shorted rotor terminals. The flux created by the stator will rotate at synchronous speed given by [19]

~ 12 ~

Ryerson University

Chapter 2 WECS

2010 (16)

Now if the rotor is connected to an electrical source of frequency f2, then there will be a flux created by the rotor that will rotate at a speed with respect to the rotor given by [19] (17) Since the two magnetic fields, due to stator and rotor, must rotate synchronously, therefore (18) Using (16), (17) and re-arranging (18) can be (19) If any two phases of the source connected across the rotor are interchanged then [19] (20) In general, the rotor's mechanical speed of a DFIG machine is given by [19] (21) As shown in the Figure 4, a DFIG can be operated in sub-synchronous or super-synchronous modes as determined by the phase sequence of the voltage. A range of 30% of rated speed is

achieved by varying the magnitude and frequency of the voltage applied across the rotor. Positive phase sequence rotor voltage results in the sub-synchronous mode and a negative phase sequence rotor voltage results in the super-synchronous mode of operation.

~ 13 ~

Ryerson University

Chapter 2 WECS

2010

As shown in the Figure 5, the DFIG stator is directly connected to grid while rotor is connected to grid through Rotor Side Converter (RSC) and Grid Side Converter (GSC) with DC-link capacitor between them for decoupled control. Both RSC and GSC are voltage source

converters that use forced-commutated power electronic devices (IGBTs) to synthesize an AC voltage from a DC voltage across the DC-link capacitor. Sometimes a transformer is used to connect GSC to the grid, as well. The three phase rotor windings are connected to RSC by slip rings and brushes. The power extracted by the Wind Turbine is converted into electrical power by induction generator and transmitted to grid by both rotor and stator. The control system generates the pitch angle command and the voltage command signals Vr and Vg for RSC and GSC respectively, in order to control power of the wind turbine, the DC bus voltage and the reactive power or voltage at the grid terminals. In this arrangement, the stator always delivers power to the grid but direction of the rotor power depends on the mechanical speed of the rotor. The rotor power flows into the grid for supersynchronous speeds and the rotor draws power from the grid for sub synchronous mode. At the synchronous speed, rotor does not draw or supply power to the grid. The rotor power supplied to grid at super-synchronous speed tends to increase DC-link voltage and vice-versa at sub synchronous speed. GSC is thus used to keep this voltage constant. The phase sequence of the AC voltage generated by the RSC constitutes a positive-sequence for the sub synchronous speed and negative for super synchronous speed. Both RSC and GSC can be used to absorb or generate reactive power or control voltage at the grid terminals but RSC is preferred due to the reduction

~ 14 ~

Ryerson University

Chapter 2 WECS

2010

in converter rating requirement as reactive power injection through the rotor is effectively amplified by a factor of 1/s, where s is slip.

Figure 4: DFIG Speed-frequency relationship

~ 15 ~

Ryerson University

Chapter 2 WECS

2010

The generator control is based on dq control coordinate system, where the q-axis component is used to control active power and d-axis component is used to control reactive power. The dq coordinate system decouples the speed control action from the reactive power and/or voltage control. This allows the two rotor voltages Vdr and Vqr to be regulated separately. DFIG control system performs the following [22]:  For speeds less than or equal to rated speed, pitch angle is kept constant at zero and for speeds higher than rated speed pitch angle is changed in such a way that power is kept constant at rated value despite of changes in wind speed (Pitch angle control).  Power flow control such that a pre-defined power-vs-speed characteristic is followed and also absorbs /generates reactive power or control voltage at the grid (RSC control).  Keeping DC-link voltage constant by transferring real power from/to DC-link capacitor (GSC control). The relationships among different parameters for DFIG operating in steady state with ideal characteristics (neglecting losses) as shown in Figure 5 are [20]: Ps= Pm ­ Pr where Ps is Stator power, Pm is mechanical power and Pr is rotor power. Te=Pm/ r where Te is torque and r is rotor speed. (23) (22)

~ 16 ~

Ryerson University

Chapter 2 WECS

2010

Figure 5: DFIG-WECS (Lossless)

~ 17 ~

Ryerson University s = (s- r)/ s

Chapter 2 WECS

2010 (24)

where s is a synchronous speed, r is a rotor speed and s is slip. Slip (s) denotes the speed difference between the rotor speed and the synchronous speed, usually expressed as a percent of the synchronous speed . Rotor power is related to stator power by slip and is given as Pr = -s Ps Using (22) and (25) Pm = (1 ­ s) Ps Therefore POt= Ps + Pr where POt is the power supplied into the grid. (27) (26) (25)

~ 18 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

CHAPTER 3 POWER QUALITY IMPROVEMENT BY SUPERCAPACITOR ENERGY STORAGE SYSTEM

3.1 INTRODUCTION
Proposed system as shown in Figure 6 consists of DC-DC converter, SC-Bank, Control Scheme and Power Optimization Algorithm. The operating principle can be outlined as:  The instantaneous value of Pref-optimal is defined by Power Optimization Algorithm (Chapter 5) for a given wind data set using a proposed optimization algorithm.  Control scheme block The control scheme aims to hold DFIG's output POt equal to Pref-optimal Compares output power POt with Pref-optimal Controls DC-DC converter to either work in Buck or Boost mode to extract or inject power so that POt becomes equal to Pref-optimal SC-Bank either works as storage or source of energy This chapter presents the DC-DC converter, SC-Bank and Control scheme (the inner control loop). The Power Optimization Algorithm (POA) will be discussed in Chapter 5.

~ 19 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

Figure 6: Proposed topology (dotted and shaded)

~ 20 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

3.2 SUPERCAPACITOR
The concept and usage of capacitors is not new, however supercapacitor (SC) with low Equivalent Series Resistance (ESR) is a relatively new technology. SC with high ESR, suitable for low current applications, has existed for some time now; the breakthrough in the technology is the SC with low ESR. In this work, we consider SC with low ESR. In terms of power, SC power density supersedes both capacitor and battery but in terms of energy density, SC is better than capacitors but lags behind batteries. Supercapacitors are different from other capacitors in terms of the electrodes used. Supercapacitors are based on a carbon (nanotube) technology [26]. The carbon technology used in these capacitors creates a very large surface area with an extremely small separation distance by a physical barrier made from activated carbon that when an electrical charge is applied to the material a double electric field is generated which acts like a dielectric. The thickness of the electric double layer is as thin as a molecule. The surface area of the activated carbon layer is extremely large yielding several thousands of square meters per gram. This large surface area allows for higher power densities. SC model used in this study is shown in Figure 7 and is adequate for this kind of study [17]. A selection criterion for storage systems is usually based on: Storage capacity, Available power, Depth of discharge or Power transmission rate, Charge / Discharge time, Efficiency, Durability (cycling capacity), Costs, Feasibility, Self-discharge, Mass and volume densities of energy, Monitoring and control equipment, Operational constraints, Reliability, Ease of maintenance, Simple design, Operational flexibility and Environmental aspects [14].

~ 21 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

Figure 7: SC model

SC as a storage device was chosen by comparing characteristics of Lead Acid Battery (LAB) and SC as given in the Table 1. Energy related cost ($/kWh) of LAB is $245 per kWh and supercapacitor is $82,000 per kWh while power related cost ($/kW) for LAB is $300 per kW and $300 per kW for supercapacitor [25]. It may be summarized that, from Table 1, for fast charge/discharge applications such as this, SC is highly desirable.

The maximum voltage across a single cell of Supercapacitor is in the range of 2.7 V to 3.0 V. A combination of Supercapacitor cells are required to create the SC-bank with design objectives such as maximum SC-Bank voltage (Vscmax), minimum SC-Bank voltage (Vscmin), nominal SCBank voltage (Vscnom), SC-Bank current (Isc), Supercapacitor power rating (Psc), discharge time (td), individual SC cell capacitance (Ccell) and individual SC cell voltage (Vcell).

~ 22 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

Table 1: Characteristics of SC and Lead Acid Battery (LAB) [12] [15] [16] Feature High power density High efficiency of cycles Long cycle life Long shelf life Shorter dis/charge time Wider temperature range Easy to charge Low internal resistance Environmentally safe No maintenance High energy density Slow self discharge Low price SC Yes Yes Yes Yes Yes Yes Yes Yes Yes Yes No No No LAB No No No No No No No No No No Yes Yes Yes

~ 23 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

Now connecting these cells in series and parallel combination forms a bank. The combination affects the ESR and capacitance of the SC-bank. The following procedure is used to find how many parallel strings of series connected Supercapacitor cells are needed and with how many Supercapacitor cells are required in each series string. Consider the rated voltage of a Supercapacitor cell as Vcell then the total voltage of the SC-Bank equals: Vscmax = ns . Vcell Similarly if the Equivalent Series Resistance of a cell is ESRcell then the series string ESR is: ESRs = ns . ESRcell (29) (28)

where ns is number of SC cells in series to form a single string. Individual series string capacitance (Cs) of ns series SC cells is given by Cs = Ccell/ ns (30)

Considering the power rating of the SC-bank (Psc) and a minimum SC-bank voltage of Vscmin, the maximum current (Iscmax) received by the SC-Bank is given by Iscmax = Psc / Vscmin (31)

Now as current (Icell) of an individual series string with ns series SC cells is less than Iscmax, we need np number of series strings in parallel to form the SC-Bank, given by np = Iscmax / Icell Now total capacitance (Csc) due to np number of series strings in parallel is given by Csc = np Cs Finally, the total ESR (ESRsc) due to np number of series strings in parallel is given by ESRsc = ESRs / np (34) (33) (32)

~ 24 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

Figure 8 shows such an arrangement to from a SC-Bank.

Figure 8: SC-Bank

~ 25 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

3.3 DC/DC CONVERTER
A DC-DC converter, shown in Figure 6 at the beginning of this chapter and proposed in this study, is a 2-quadrant buck-boost chopper. Figure 9 shows Buck-Boost converter with DC-link capacitor added to a converter on one side and SC on the other side. The two-quadrant chopper is made to switch between Buck and Boost modes as the need arises and thus ensures flow of current in both directions with a fixed voltage polarity. It operates in the Boost mode when transferring power from SC to DFIG-WECS and in the Buck mode while transferring power in the other direction to keep DC-link voltage constant, simply by varying duty cycle. As electronic devices inherently carry current in one direction therefore anti-parallel diodes are included to get bi-directionality. The SC voltage is limited to a lower voltage (Vscmin) of 100 volts to avoid the Supercapacitor voltage (Vsc) dropping to zero volts and thus preserve stability and efficiency of the buck-boost converter.

3.3.1 SIZING OF THE INDUCTOR
In boost mode, IGBT2 is turned on (with IGBT1 turned off) and thus inductor energy builds up linearly assuming that the SC behaves as a DC source and the inductor (L) is ideal. The change in the inductor's current is given by IL-on = (Vsc/L) ton (35)

where IL-on is a change in inductor current for on-time, ton. When IGBT2 is turned off (with IGBT1 turned ON) then inductor energy decays linearly and is given by IL-off = [(Vsc ­ Vdclink)/L] toff where IL-off is a change in inductor current for off-time, toff and Vdclink is DC-link voltage. (36)

~ 26 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

Figure 9: 2 Q chopper with SC & DC-link Cap

~ 27 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

But the DC-link voltage is given by (32), the standard boost converter equation [24] Vdclink = Vsc /(1-D) where D is duty cycle and given as D= ton/T Therefore IL-off = [(Vsc- Vsc /(1-D) )/L] toff (39) (38) (37)

Choosing a 50% duty cycle (toff = ton ) for design purposes and using IL = IL-off = IL-on, equation (35) becomes L = (Vsc/ IL) D . T where T is period and f is switching frequency. The DFIG-WECS chosen in this study has the following data: DC-link voltage is 1200 volts, Grid Side Converter rating is 0.75 MW and a switching frequency of 1620 Hz. The Grid Side Converter rating of 0.75 MW is chosen to equal the Supercapacitor rating, Psc. In the proposed topology, the SC-Bank is designed for a maximum voltage of 1350 volts (Vscmax), a minimum voltage of 100 volts (Vscmin) and a nominal operating voltage of 1200 volts (Vscnom, DC-link voltage). Thus, the minimum inductance required for the buck-boost converter (L) is calculated with the following data: Psc= 0.75 MW, Vscnom = 1200 V, Vscmax = 1350 V, Vscmin = 100 V, f = 1620 Hz, D = Dmax =1 (to allow for maximum ripple), and with a ripple of 1%. The maximum SC-bank current is: Iscmax = Psc / Vscmin = 7.5 kA (40)

~ 28 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

Now inductor current ripple allowed of 1% is IL =75 A Then value of inductor is L = (Vsc/ IL) D . T = 9.87 mH From the above, a standard value of 10 mH was chosen.

3.3.2 SIZING OF THE SUPERCAPACITOR
In general, the energy in the Supercapacitor is given by Esc=1/2 . Csc . Vsc2 (41)

where Esc is energy, Csc is capacitance and Vsc is voltage of the SC. Defining lower limit of voltage (Vscmin) and relating Esc= Psc td and solving for Csc gives Csc =2 Psc td / (Vscnom-Vscmin)2 (42)

where td is the period of time that we want to eliminate fluctuation in WECS output, 120 seconds in this case. Csc is the required capacitance to perform this function. Now as Psc= 0.75 MW, Vscnom = 1200 V, Vscmin = 100 V, td = 120 seconds then Csc required is calculated to be 148.7 F using (42). This SC with a capacitance of Csc has enough capacity to either extract or supply 0.75 MW of power for 120 seconds. The Buck-Boost converter was simulated with the following data to verify design: Psc =0.75 MW, Csc=150 F, L=10 mH, Vdclink=1200 volts, f = 1620 Hz Results are shown in Figure 10 & 11 for D=0.25 and D=0.75 respectively. Considering the Figure 10, the following data is observed (D=0.25):

~ 29 ~

Ryerson University Switching Frequency f = 1620 Hz. Average IL The value of IL-on The value of ton The time period (T) The Vsc The VDC-link = 156 A = 25A = 154.32 s = 617 s = 300 V = 1200 V

Chapter 3 PQI BY SESS

2010

The power output of the SuperCapacitor = 0.0468 MW. It is clear from the Figures 10 & 11 that magnitude of both current and voltage change as duty cycle D is varied. This change in voltage and current cause power to change and thus power can be adjusted by controlling D.

~ 30 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

Figure 10: Simulation results with D=0.25

~ 31 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

Figure 11: Simulation results with D=0.75

~ 32 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

3.4 CONTROL SCHEME
Control scheme for the proposed topology shown in Figure 6 consists of System Limits Indicator (SLI), Pref Setting System (PSS), Power Control System (PCS) and Operation Control System (OCS) as shown in Figure 12.

Figure 12: Control Scheme (proposed)

~ 33 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

The following text explains the operating principle of the control scheme:   SLI monitors wind speed (W) and voltage across SC (Vsc). SLI outputs a logic 1 if both Vsc>Vscmin and W>Windcut-in and its output equals 0 otherwise.   PSS sets Pref = Pref-optimal if SLI output is 1 otherwise Pref is set to 0. PCS generates gating signals for the switching devices of the buck-boost chopper to maintain output of the DFIG (POt) equal to Pref-optimal  OCS Keeps Vdclink and Vsc with in operating limits. Passes gating signal from PCS. Manages SESS The system also displays different variables for monitoring including MPPT based instantaneous wind turbine power, PWt. Now we will look at each of the building blocks of the control scheme one by one in detail.

3.4.1 SYSTEM LIMITS INDICATOR (SLI)
SLI shown in Figure 13 indicates whether system is operating in the defined working limits by measuring both Vsc and W. SLI checks for both Vsc and W and compares with their respective limits, Vscmin and Windcut-in (DFIG-WECS turns on only if Wind speed > Windcut-in otherwise it is turned off). SLI outputs logic zero if any limit is violated otherwise its output equals a logic one. Output of SLI is sent to PSS for further processing.

~ 34 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

In this specific example, if Vsc is greater than 100 volts (Vscmin) and wind speed (W) is greater than 5 m/sec (Windcut-in), then the system is deemed to operate in the normal limits and this block outputs a logic value of 1 and otherwise outputs a value of 0. Referring to Figure 13, these comparisons are completed by two comparators. Outputs of the two comparators are logically intersected (AND) and sent to PSS for further processing.

Figure 13: System Limits Indicator (proposed)

3.4.2 Pref SETTING SYSTEM (PSS)
SLI output is received and used by PSS to set Pref as shown in Figure 14. PSS sets Pref = Pref-optimal (Pref-optimal is defined by POA and discussed in Chapter 5) if SLI outputs a logic one and sets power reference Pref = 0 if SLI outputs a logic zero. Output of PSS is sent to PCS to generate gating signals. PSS also displays power reference set.

~ 35 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

Figure 14: Pref Setting System (proposed)

3.4.3 POWER CONTROL SYSTEM (PCS)
PCS generates gating signals for the chopper such that the DFIG's output power (POt) equals Pref-optimal. As shown in Figure 15 carrier based PWM control system compares instantaneous output power measured (Pmeas) with Pref and passes difference through a Proportional-Integral (PI) controller for comparison with triangular carrier wave to generate a control signal. Depending upon whether this difference between Pmeas and Pref is greater or smaller than triangular wave, a logic zero or one is produced respectively, to turn DC-DC converter OFF or ON and thus keep output power in the vicinity of Pref. This Control signal in essence controls operation of the DCDC converter: a) to operate in the Buck mode when energy is transferred from DC-link capacitor to SC-Bank, and, b) in the Boost mode to transfer energy from SC-Bank to the DC-link capacitor. A train of pulses (zeros and ones) produced this way controls output power of the DFIG (POt) by either injecting into or extracting power from the Supercapacitor capacitor. This control signal is supplied to Operation Control System (OCS) for the final phase of the process.

~ 36 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

P and I values used for PI controller are 0.7 and 10 respectively and were determined through a trial and error process.

Figure 15: Power Control System (proposed)

3.4.4 OPERATION CONTROL SYSTEM (OCS)
The internal structure of OCS is shown in Figure 16. It outputs the gating signal (C1) to control chopper's operation, the Supercapacitor control signal (C2) to turn SC-Bank on or off and the System control signal (C3) to isolate the proposed SESS topology in the event of a failure. The following text explains the operation of OCS. OCS receives the voltage signal Vdclink from the DC-link capacitor, the voltage signal Vsc from the Supercapacitor and the chopper gating signal from PCS. The magnitude of Vsc is limited between upper and lower limits of 1350 volts and 100 volts respectively. In a similar manner, the DC-link voltage is to be kept between 1000 volts and 1350 volts. If both of these variables (Vsc

~ 37 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

and Vdclink) are within the limits then OCS produces the control signal C2 (binary) that either turns SC on or turns it off. If these same variables (Vsc and Vdclink) remain within their respective limits, then the gating signal from PCS is sent to the DC-DC converter as C1. The measured output power of the DFIG WECS (Pmeas) is used to determine whether SESS should be kept connected or not and accordingly produces a binary variable (C3). The comparator checks to see if Pmeas is above zero. If this condition is not true, i.e. if Pmeas equals zero, the SESS is isolated from the DFIG-WECS by setting C3 to 0.

Figure 16: Operation Control System (proposed)

~ 38 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

3.5 OPERATING PRINCIPLE
Referring to Figure 6 and discussion throughout this chapter the overall operating principle is as follows:   Pref-optimal for given wind data is found by the Power Optimization Algorithm in Chapter 5. Control scheme blocks The objective is to measure and control DFIG output to Pref-optimal. The SLI block determines if W and Vsc are within their limits. PSS sets Pref to equal Pref-optimal if SLI indicates normal operation. PCS produces gating signal for the chopper to control output power (Pmeas) of DFIG such that it equals Pref-optimal. OCS checks if all the voltages within the system are within their limits. If they are within their limits, it passes the gating signal to the chopper and enables the SC. It checks to see if output power is more than zero in which case it enables SESS operation.  The DC-DC converter is controlled by OCS, in normal condition, to either work in Buck or Boost mode to extract or inject power to regulate output power Pmeas such that it equals Pref-optimal.  SC-Bank works as either a storage or source of energy, as a storage in Buck mode to extract energy from DC-link capacitor and as a source in Boost mode to inject energy into the DC-link capacitor.

~ 39 ~

Ryerson University

Chapter 3 PQI BY SESS

2010

3.6 CONCLUSIONS
In conclusion, this chapter presents a topology to connect SC to the DFIG WECS through a chopper. The control system for the chopper is presented. The design for the chopper and control system are presented as well. In the next Chapter, an example of the working of the proposed topology and the inner control loop are presented.

~ 40 ~

Ryerson University

Chapter 4 SIMULATION RESULTS

2010

CHAPTER 4 SIMULATION RESULTS
4.1 INTRODUCTION
In this chapter of the thesis, we look at the response of DFIG-WECS with the proposed SESS topology and the inner control loop. This response is compared with the performance of DFIGWECS without the proposed SESS topology. Various system parameters are measured in both cases and compared to arrive at conclusions. In order to facilitate this comparative study, we select a data set for wind pattern having 120 points. The wind pattern is shown in Figure 17.

4.2 DFIG-WECS OPERATION WITHOUT PROPOSED TOPOLOGY
In this section of the chapter, we look at the response of DFIG-WECS without the proposed SESS topology. Simulation results are shown in Figures 18-22 for the wind pattern shown in Figure 17 that lasts for 120 seconds. The net energy in wind for 120 seconds equals 48.1 MW-s and the average power is equal to 0.401 MW. It may be observed in Figure 20 that the DC link voltage remains at 1200 V and that output reactive power in Figure 19 remains at 0 Mvar despite a changing output real power. These are achieved by the control system of the Grid Side Converter that works independent of the proposed SESS system.

~ 41 ~

Ryerson University

Chapter 4 SIMULATION RESULTS

2010

Figure 17: Wind pattern (120 Sec) (MW)

Figure 18: Grid Active power

~ 42 ~

Ryerson University (Mvar)

Chapter 4 SIMULATION RESULTS

2010

Figure 19: Grid Reactive power

Figure 20: DC-link voltage (V)

~ 43 ~

Ryerson University

Chapter 4 SIMULATION RESULTS

2010

Figure 21: Grid voltage (V)

Figure 22: Phase a Current (A)

~ 44 ~

Ryerson University

Chapter 4 SIMULATION RESULTS

2010

From the Figure 18, one can see that all of the input power from the wind turbine reaches to the output of the DFIG. This output power is highly variable.

4.3 DFIG-WECS OPERATION WITH PROPOSED TOPOLOGY
This section discusses response of DFIG WECS with the proposed SESS topology and the inner control loop. The results are shown in Figures 23-28 for the same wind pattern shown in Figure 17. It is a two-step procedure:  The optimal output power reference level for DFIG-WECS is established for the given wind pattern using the optimization technique proposed in Chapter 5. This value is Pref-optimal and it equals 0.401 MW in this example.  The WECS output power (power injected into the grid by WECS) is controlled around this optimal power reference level, Pref-optimal by SESS and the inner control loop.

Analyzing graphs in Figures 18 and 23 and comparing them, the following is seen. The power output of DFIG-WECS without SESS system is variable and follows the wind power. However, it can be seen that the output of DFIG-WECS with the SESS system and inner control is nearly constant. This constant value equals the Pref-optimal value of 0.401 MW as determined by the optimization algorithm presented in Chapter 5.

~ 45 ~

Ryerson University (MW)

Chapter 4 SIMULATION RESULTS

2010

Figure 23: Grid Active power

(Mvar)

Figure 24: Grid Reactive power

~ 46 ~

Ryerson University

Chapter 4 SIMULATION RESULTS

2010

Figure 25: DC-link voltage (V)

Figure 26: Grid Voltage (V)

~ 47 ~

Ryerson University

Chapter 4 SIMULATION RESULTS

2010

Figure 27: Phase a Current (A)

Figure 28: SC Energy (MWs)

~ 48 ~

Ryerson University

Chapter 4 SIMULATION RESULTS

2010

4.4 CONCLUSIONS
Looking at the responses of the system in Figures 18-22 in section 4.2 (DFIG-WECS without proposed topology) and Figures 23-28 in section 4.3 (DFIG-WECS with proposed topology) following can be observed:     DC-link voltage is almost same in both cases, around 1200 volts. Grid voltage is almost same in both cases, 575 volts. Reactive power is same in both cases, maintained at zero. Phase current varies from 320 A to 930 A without the proposed topology and is constant around 570 A with the proposed topology.  Active power changes from 0.35 MW to 0.90 MW without proposed topology and is maintained around an average power of 0.401 MW with proposed topology.  SC energy starts from, and ends with, 0.363 MW-s of energy while it varies in the 120 seconds in between due to charging and discharging commands from the inner control loop.  The total energy extracted from wind is supplied into the grid in both cases.

Thus, it is clear from the graphs and remarks above that the energy in the SC changes due to continuous charging and discharging. This is done to keep the output power of DFIG-WECS at a constant value. This charging and discharging of the SC is accomplished by controlling the duty cycle of the buck-boost converter. It is noticeable that the proposed optimization algorithm

~ 49 ~

Ryerson University

Chapter 4 SIMULATION RESULTS

2010

ensures that the energy in the SC at the start and the end of the 120 seconds remains the same whereby the net energy from wind is transferred to the connected electric network. The total energy supplied into the grid (0.401 MW x 120 sec = 48.1 MW-s) equals energy extracted from wind (48.1 MW-s). Therefore, it is concluded that the integration of the proposed SESS topology and the proposed optimization algorithm (chapter 5) with DFIG-WECS can improve quality of the power supplied into the grid despite of the fluctuating nature of the wind speed.

~ 50 ~

Ryerson University

Chapter 5 POWER OPTIMIZATION

2010

CHAPTER 5 POWER OPTIMIZATION ALGORITHM

5.1 INTRODUCTION
The nature of wind speed is intermittent and thus power produced by WECS is intermittent as well. In order to avoid injecting this irregular power into the grid, a mechanism to smoothen this intermittence is required. The goal here is to keep power produced by WECS at a constant value or a minimum set of constant values subject to operating limits. Such a solution must ensure that the total extractable wind energy is delivered into the connected power grid. Referring to Figure 6 and discussions in Chapter 3, the chopper's control system receives a Pref-optimal value. The inner control loop proposed in Chapter 3 along with the SESS holds the DFIG's output to this value eliminating short-term power fluctuations and supplies a constant power into the grid. This chapter presents an optimization algorithm that determines this Pref-optimal for a given wind speed data and forms the outer control loop.

5.2 PROBLEM FORMULATION
Consider that the optimization is completed for NH periods with each period representing a duration of NX seconds. The total power input into and output from the supercapacitor is limited

~ 51 ~

Ryerson University

Chapter 5 POWER OPTIMIZATION

2010

by the capability of itself and the connected chopper. Considering all the constraining elements, the maximum input in the tth instant (PCt < 0) when the supercapacitor is charging is given by PCmin. Similarly the maximum output capacity of the supercapacitor is given by PCmax. Constraining the tth instant power input/output of the supercapacitor to these limits, the following constraint may be formulated: PCmin < PCt < PCmax ; t = 1 to NH (43)

The net output in the tth instant (POt) of the DFIG is constrained by the max equipment rating of POmax. Accordingly, the tth instant power output is constrained as below: 0 < POt < POmax ; t = 1 to NH (44)

The variable PCt is the power input/output of the supercapacitor in the tth instant. Multiplying it by NX seconds (numerically equal to NX. PCt) represents the energy input/output of the supercapacitor. Since we do wish to store or take any energy at the end of the NH periods and ensure that energy in the supercapacitor remains unchanged, the following constraint is enforced.
t

PCt = 0

(45)

The min and max amount of energy that can be stored in the supercapacitor at any instance is given by ECmin and ECmax. In the tth instant, adding energy input/output from preceding instants (
k=1:t

NX. PCk) to the initial energy EC0, one may determine the total energy. This total energy

in the tth instant is constrained to be within the supercapacitor energy capacity as below: ECmin < ECt = EC0 +
k=1:t

NX . PCk < ECmax

;

t = 1 to NH

(46)

In the tth instant, the system power balance is described by the equality below that ensures that

~ 52 ~

Ryerson University

Chapter 5 POWER OPTIMIZATION

2010

the power from the wind turbine is either channelled to the SC or output of DFIG: PWt = PCt + POt ; t = 1 to NH (47)

If in the tth instant, the output increases by any value, then the variable USt assumes a value of 1 and remains at zero otherwise. Similarly, if in the tth instant, the output decreases by any value, then the variable UDt assumes a value of 1 and remains at zero otherwise. In each instant their values remain between 0 and 1 and hence they can be constrained as a below. It must be borne in mind that these are integer variables. 0 < USt < 1 0 < UDt < 1 ; ; t = 1 to NH t = 1 to NH (48) (49)

The change in power of the whole DFIG from the tth instant (POt) and the next instant (POt+1) is given by (POt+1 - POt). The integers UDt and USt track these changes if there is decrease or increase respectively and limit it to POmax. In the absence of a decrease or increase, this change (POt+1 - POt) should be equal to zero. This is represented concisely as a below: -POmax .D,t+1 < POt+1- POt < POmax (USt+1) ; t = 1 to NH-1 (50)

Since the power can either increase or decrease in the tth instant: 0 < USt + UDt < 1 ; t = 1 to NH (51)

The objective of the optimization is to minimize the number of changes in the power output, thus: Minimize:
t

(USt + UDt)

(52)

Subject to constraint (43)-(51). This proposed formulation was solved to minimize the number of output power changes subject

~ 53 ~

Ryerson University

Chapter 5 POWER OPTIMIZATION

2010

to the limits and constraints defined above. Two solution techniques are proposed to solve the power output optimization challenge and they are:   Iterative Search Technique (IST) Mixed Integer Linear Programming Technique (MILPT)

These algorithms are presented in the following text. These algorithms were tested on a wind speed data set with 12 points. The wind speed is in meters/sec and power in Megawatts. Wind Power = [7 6 8 6 11 10 11 11 12 11 10 11] m/s = [0.2 0.12 0.29 0.12 0.73 0.55 0.73 0.73 0.95 0.73 0.55 0.73] MW

Total Energy = 6.43MWs

5.3 ITERATIVE SEARCH TECHNIQUE (IST)
This method of output power optimization is based on an iterative search. The method searches for the minimum set of fixed output values (Pref-optimal). Parameters such as wind data, SC initial energy and operating limits are considered in the optimization method. From the wind speed and power data, the average wind power value is determined. This average value is an initial guess for the constant output power of DFIG (Pref-optimal) and the number of output levels is one (the minimum possible). The algorithm then checks to see if the initial guess satisfies operating constraints such as converter rating etc. If the constraints are satisfied, then the solution is retained as the optimal solution. If the constraints are not satisfied, then the algorithm repeats this set of steps with one more output level in an incremental manner until it finds the optimal solution.

~ 54 ~

Ryerson University

Chapter 5 POWER OPTIMIZATION

2010

5.3.1 IST Algorithm
Step 1: Variables (wind pattern, counters, etc) are declared and initialised Step 2: Rated power, minimum and maximum limits and initial status of the devices are defined Step 3: The total wind energy for given wind pattern is calculated Step 4: Pref-optimal is found by simple averaging the data points Step 5: An iterative search is initiated to determine Pref-optimal values such that the minimum set of output values are used. Step 6: The optimal Pref-optimal value is recorded

5.3.2 IST Results
The data set presented in Section 5.1 is used for analysis. The results of scheduling are presented in Figures 29 and 30. By analyzing the graphs in Figures 29 and 30, one level of output power transfers the varying wind power. The difference between the output power and input wind power is stored or released appropriately from the supercapacitor. This ensures that the grid sees a static power output. Matlab code and simulation results for data sets with 120 samples and 600 samples with an initial energy that equals 50% of the supercapacitor's capacity are provided in Appendix A.

~ 55 ~

Ryerson University

Chapter 5 POWER OPTIMIZATION

2010

Figure 29: Wind power & power reference (IST)

Figure 30: Total wind and IST Energy

~ 56 ~

Ryerson University

Chapter 5 POWER OPTIMIZATION

2010

5.4 MIXED INTEGER LINEAR PROGRAMMING TECHNIQUE (MILPT)
The goal here, as before, is to minimize the number of output power levels and thus minimize output power fluctuations. The proposed method solves the formulation in (52) with constraints in (43)-(51) using the MILP technique.

5.4.1 MILPT Algorithm
The formulation above (43)-(52) is programmed in MATLAB and solved using the

optimization function mosekopt, an optimization toolbox. The proposed algorithm is given below: Step 1: Variables are declared and initialised Step 2: Constraints and limits are defined based on devices ratings, initial status and other operational constraints Step 3: The formulation (43)-(52) is solved to minimise number of output power levels Step 4: The Pref-optimal and other variables are recorded and plotted

5.4.2 MILPT Results
The data given in Section 5.1 is used for determining the optimal set of value for the DFIG. The output power and energy from DFIG are shown in Figures 31 and 32. It can be seen that a constant power output with one level is the optimal solution as shown in the previous algorithm as well. The power supplied to the grid is constant and free of fluctuations. The Matlab code and simulation results for data sets having 120 samples and 600 samples with an initial supercapacitor charge of 50% of full capacity are provided in Appendix B.

~ 57 ~

Ryerson University

Chapter 5 POWER OPTIMIZATION

2010

Figure 31: Wind power & power reference (MILPT)

Figure 32: Total wind and MILPT Energy

~ 58 ~

Ryerson University

Chapter 5 POWER OPTIMIZATION

2010

5.5 EFFECT OF SC INITIAL ENERGY
The energy in the supercapacitor plays a vital role in stabilizing the output of the DFIG. This section considers a data set with 600 points of wind power for 600 seconds. This data is scheduled using the MILPT algorithm proposed in the previous section. The results of scheduling the system with three cases are presented Figure 33, 34, and 35. Figure 33 shows the optimal schedule of the system power output with an initial energy of the supercapacitor at the minimum value of zero. It delivers the output at three levels. Figure 34 shows the optimal output power of the system with the initial energy of the supercapacitor at its maximum. It shows the optimal schedule in this case with output power at three levels. Thereafter, Figure 35 shows the output power for case where the initial energy equaled 50% of the supercapacitor's capacity and in this case the number of output levels equal one. Hence, when the supercapacitor's charge is at 50% of its capacity, the output has the least number of power levels.

Thereafter, for various values of initial energy expressed in percentage of the total energy capacity of the supercapacitor, the minimum number of output power levels is determined and presented in Figure 36. Very clearly, it can be seen that with a half charged supercapacitor, the system has the minimum number of output levels.

~ 59 ~

Ryerson University

Chapter 5 POWER OPTIMIZATION

2010

Figure 33: Pref-optimal with zero initial energy in the supercapacitor

Figure 34: Pref-optimal with initial energy in the supercapacitor at its maximum

~ 60 ~

Ryerson University

Chapter 5 POWER OPTIMIZATION

2010

Figure 35: Pref-optimal with initial energy in the supercapacitor at 50% of its capacity

EC0

Figure 36: Effects of initial energy in the supercapacitor expressed as a percentage of its capacity

~ 61 ~

Ryerson University

Chapter 5 POWER OPTIMIZATION

2010

5.6 ALGORITHMS COMPARISON
Discussions and graphs above clearly show that both IST and MILPT are effective in eliminating fluctuations and thus improving power quality of the output of the DFIG. These techniques are compared in this section.

Two wind patterns with 120 data points each are considered for analysis. The effect of changing the SC's initial energy, expressed as a percentage of its total capacity, is shown in Figure 37 and 38 for pattern 1 and Figures 39 and 40 for pattern 2.

From the graphs, one may easily see that when the initial energy of the supercapacitor is close to 50%, the two methods perform well and have one output level.

When the SC has a very low or a very high initial energy that is closer to 0% or 100%, then there is more output levels. Then it those cases, MILPT get a lesser number of output levels.

~ 62 ~

Ryerson University

Chapter 5 POWER OPTIMIZATION

2010

2.5 2 MILPT Levels 1.5 1 0.5 0 1 21 41 61 81
100

EC0

Figure 37: ECo effect on MILPT Wind Pattern-1

9 8 7 Levels 6 5 4 3 2 1 0 1 21 41 61 81
100

IST

EC0

Figure 38: ECo effect on IST Wind Pattern-1

~ 63 ~

Ryerson University

Chapter 5 POWER OPTIMIZATION

2010

2.5 2 MILPT Levels 1.5 1 0.5 0 1 21 41 61 81
100

EC0

Figure 39: ECo effect on MILPT Wind Pattern-2

9 8 7 6 Levels 5 4 3 2 1 0 1 21 41 61 81
100

IST

EC0

Figure 40: ECo effect on IST Wind Pattern-2

~ 64 ~

Ryerson University

Chapter 5 POWER OPTIMIZATION

2010

5.7 CONCLUSIONS
Two algorithms that minimize the number of constant output power levels have been proposed and implemented. They have been tested on wind power data sets with 120 and 600 samples. Their analysis results have been presented. The role of initial energy in the supercapacitor on the number of levels in the output power was analyzed. From the results, it can be concluded that the initial energy of the supercapacitor should be kept at a value that is closer to 50% of the supercapacitor's capacity and this is found to minimize the number of Pref-optimal levels.

Therefore, when either of the Power Optimization Algorithms proposed in this chapter is used as the outer control loop with proposed topology of Chapter 3 as inner control loop, the short term wind power fluctuations can be eliminated effectively and quality of the power supplied into the grid can be improved.

~ 65 ~

Ryerson University

REFERENCES

2010

CHAPTER 6 CONCLUSIONS
This thesis proposes the use of a Supercapacitor in tandem with a chopper and two layers of control systems to stabilize output power of a DFIG-WECS with an oscillatory input wind power. Figure 1 shows DFIG-WECS with proposed topology, the complete system.

The key contributions of this thesis are outlined chapter-wise: Chapters 3 and 4 Chapter 3 proposes a Supercapacitor Energy Storage System that consists of a Supercapacitor, a buck-boost chopper and an inner control system. This topology receives an optimal DFIG output command (Pref-optimal) from the optimization algorithm proposed in Chapter 5. The inner control system optimally controls the chopper such that power from Supercapacitor compensates changes in the input wind power and results in a constant DFIG output of Pref-optimal. Therefore, it automatically controls the output of the DFIG using SESS to hold it at Pref-optimal despite an oscillatory wind power input at the turbine shaft. In Chapter 4, the performance of the proposed topology with the inner control loop is presented and discussed. The most important practical benefit of this proposed solution is that the proposed solution can be implemented on any DFIG as an addition.

~ 66 ~

Ryerson University Chapter 5

REFERENCES

2010

In this chapter, two optimization algorithms are proposed. The objective of the optimization algorithms is to determine a minimum number of output power values for DFIG given a forecasted varying wind power input over a period 120 to 600 seconds. The optimization is constrained by limits of the DFIG and SESS. These optimization algorithms determine the least set of Pref-optimal values. As explained earlier, this set of Prefoptimal

values are given to SESS such that the inner control loop can hold the DFIG's

output to these values.

The key features of the topology proposed are:  Decoupled design and control to ensure proposed topology integration into DFIGWECS without any change in the DFIG-WECS    Power quality improvement by short term power fluctuations elimination Total energy supplied to the grid equals total energy extracted from wind POA and SESS with control system works with any number of data samples and provides optimal power reference level(s) and minimizes the changes in DFIG WECS output

~ 67 ~

Ryerson University

REFERENCES

2010

REFERENCES
[1] C. Millais and S. Teske Wind Force 12: A blueprint to achieve 12% of the worlds electricity from wind power by 2020., Greenpeace and European Wind Energy Association,www.ewea.org/03publications/WindForce12.htm, May, 2004. Chad Abbey and Géza Joos. Short-term Energy Storage for Wind Energy Applications, 0-7803-9208-6/05© 2005 IEEE Van Der Hoven I. Power spectrum of horizontal wind speed in the frequency range from 0·007 to 900 cycles per hour, Journal of Meteorology 1957; 14: 160­ 164. Rohatgi JS, Nelson V. Wind Characteristics--an Analysis for the Generation of Wind Power. Alternate Energy Institute, West Texas A&M University: Canyon, TX, 1994; C. Luo, H. Banakar, B. Shen and B. Ooi, Strategies to smooth wind power fluctuations of wind turbine generator, IEEE Transactions on Energy conversion, vol. 22, pp. 341-349, June, 2007. W. Li, G. Joos, C. Abbey,  Wind power impact on system frequency deviation and an ESS based power filtering algorithm solution, Power systems conference and Exposition, PSCE, '06, pp.2077-2084, 2006. Chong Han, Alex Q, Haung, Ding Li, Haresh Mamath, Mike Ingram & Anley Atcityy, Modeling & design of a transmission of Ultracap integrating voltage source converter with Ultracapacitor energy storage, Applied power electronics conference and exposition, APEC'01, pp.7-14,2006. Jiancheng Zhang, Research on Supercapacitor energy storage system power networks, power electronics and Drives systems, vol. 4, pp1366-1369, 2005. Domenico Casadei, Gabriele Grandi and Cloudio Rossi, A Supercapacitor based power conditioning system for power quality improvement and uninterruptible power supply, Industrial Electronics, vol.4, pp. 1247-1252,2002.

[2]

[3]

[4]

[5]

[6]

[7]

[8]

[9]

~ 68 ~

Ryerson University [10]

REFERENCES

2010

I. Galkin, A. Stepanov and J. Laugis, Outlook of usage of Supercapacitors in uninterruptable power supplies, Baltic Electronics Conference, pp 1-4, 2006. C. Banos, M. Aten, P. Cartwright and T.C. Green, Benefits and control of STATCOM with energy storage in wind power generation, AC and DC Power Transmission, pp.230-235, 2006 Chad Abbey, Geza Joos, Supercapacitor Energy Storage for Wind Energy Applications, IEEE TRANSACTIONS ON INDUSTRY APPLICATIONS, VOL. 43, NO 3, MAY/JUNE, 2007 F. Zhou, Chad Abbey, Geza Joos, L. Jiao and B.T. Ooi,use of large capacity SMES to improve the power quality and stability of wind farms, Power Engineering Society General Meeting IEEE, vol. 2, pp. 2025-2030, June 2004. H.Ibrahim a. b, A.Ilinca, ,J.Perron, Energy storage systems Characteristics and Comparisons, Renewable and Sustainable Energy Reviews 12 (2008) 1221­1250 Document#10073627, www.maxwell.com Ultracapacitor Sizing, Maxwell Technologies,

[11]

[12]

[13]

[14]

[15]

[16]

Andrew Stepanov, Ilija Galkin and Lauris Bisenieks, Implementation of Supercapacitors in Uninterruptable power supplies, European conference of Power electronics and applications, vol.1-10, pp.4949-4955, 2007 Wei Li and Geza Joos, A Power Electronic Interface for a Battery Supercapacitor Hybrid Energy Storage System for Wind Applications, 39th IEEE PESC, vol. 1-10, pp. 1762-1768, 2008 www.electronicsweekly.com/Articles/2006/03/03/37810/Supercapacitors-seegrowth-as-costs-fall.htm Theodore Wildi, Electrical Machines, Drives and Power Systems, publisher Prentice Hall, 2006 Brendan Fox [et al], Wind power integration, connection and operational aspects, publisher, London Institution of Engineering and Technology, 2007 http://www.energy.iastate.edu/renewable/wind/wem/images/wem-07_fig01.gif

[17]

[18]

[19]

[20]

[21]

~ 69 ~

Ryerson University [22]

REFERENCES

2010

Istvan Erlich and Fekadu Shewarega, Introduction of Wind Power Generation into the First Course in Power Systems, IEEE, 2007. Bimal K. Bose, Modern Power Electronics and AC Drives publisher Prentice Hall, 2002 M. H. Rashid, Power Electronics Circuits, Devices, and Applications, publisher Pearson Prentice Hall, 2004 http://prod.sandia.gov/techlib/access-control.cgi/2001/010765.pdf http://en.wikipedia.org/wiki/Electric_double-layer_capacitor

[23]

[24]

[25] [26]

~ 70 ~

Ryerson University

APPENDICES

2010

APPENDIX A: ITERATIVE SEARCH TECHNIQUE

IST Code
clear; clc; %xxxxxxxxxxxxxxxxxxxxxx Data xxxxxxxxxxxxxxxxxxxxxxxxx% Prate = 1.5e6; PconN = -0.75e6; PconP = +0.75e6; Escmin = 0; Escmax = +157.3e6; Esci =0; %157.3e6; 78.65e6 % %xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx% % 120 samples % Figure 39 Data Wind=[10 9 10 9 8 10 9 7 8 6 8 6 9 10 11 10 9 10 11 10 9 7 8 10 9 10 8 9 8 7 9 8 9 9 9 9 10 9 10 8 10 11 10 8 6 9 6 8 8 9 10 9 7 6 8 9 8 9 7 8 6 8 9 10 11 10 10 11 10 9 10 9 11 10 9 7 7 8 10 11 9 8 7 10 8 9 6 8 6 9 7 8 10 9 10 9 10 10 9 8 10 10 9 7 8 6 9 6 8 7 8 9 8 9 9 8 7 8 7 8]; % Figure 39 Data %Wind=[7 8 6 7 7 6 8 8 6 9 6 8 8 9 10 9 7 6 8 9 8 9 7 8 6 8 9 10 11 10 10 11 10 9 10 9 11 10 9 7 7 8 10 11 9 8 7 10 8 9 6 8 6 9 7 8 10 9 10 9 10 10 9 8 10 10 9 7 8 6 9 6 8 6 8 10 9 11 10 9 8 9 7 8 6 8 10 9 10 9 8 10 9 7 8 6 9 10 11 10 9 10 11 10 9 7 8 10 9 10 8 9 8 7 9 8 9 8 9 9 ]; c=numel(Wind); for j=1:c PW(1,j)=0; end for j=1:c if(Wind(1,j)<6) PW(1,j)=0; elseif(Wind(1,j)==6) PW(1,j)=0.12e6;

~ 71 ~

Ryerson University elseif(Wind(1,j)==7) PW(1,j)=0.2e6; elseif(Wind(1,j)==8) PW(1,j)=0.29e6; elseif(Wind(1,j)==9) PW(1,j)=0.41e6; elseif(Wind(1,j)==10) PW(1,j)=0.55e6; elseif(Wind(1,j)==11) PW(1,j)=0.73e6; elseif(Wind(1,j)==12) PW(1,j)=0.95e6; elseif(Wind(1,j)==13) PW(1,j)=1.21e6; else PW(1,j)=1.21e6; end end Pw=PW; n1=numel(Pw); Prefa=0;Pwt=0; for j=1:n1 Prefa=Prefa+Pw(1,j); Pwt=Pwt + Pw(1,j); Pwx(1,j)=Pwt; end

APPENDICES

2010

Prefb= Prefa/j; Psci = Esci; Psc=Psci; Pscmin=Escmin; Pscmax=Escmax; ctr=1; Pwd=0; PrefNew=0; Pwb=0; while(ctr<=n1) %xxxxxxxxxxxxxxxxxxxxxxxx Middle xxxxxxxxxxxxxxxxxxxxxxxxxxxx% if(Pw(1,ctr)<Prefb) Pscn=Prefb-Pw(1,ctr); if (((Psc - Pscn)>=Pscmin) && (Pscn<=PconP) && (Prefb<=Prate)) Pref(1,ctr)=Prefb; Pscd(1,ctr) = Psc - Pscn; Psc = Psc - Pscn;

~ 72 ~

Ryerson University

APPENDICES

2010

else b=ctr; Pwb=0; while(Pw(1,ctr)<Prefb) Pwb=Pwb+Pw(1,ctr); ctr=ctr+1; if(ctr>n1) break; end end Pwb=Pwb/(ctr-b); if(Psci==Pscmin) Pwb = Pwb - (0.75 * Pwb); Prefb=Pwb; end ctr=ctr-1; for i=b:ctr Pscn=Pw(1,i)-Prefb; if (((Psc + Pscn)>=Pscmin) && (Pscn<=PconP) && (Prefb<=Prate)) Pref(1,i)=Prefb; Pscd(1,i) = Psc + Pscn; Psc = Psc + Pscn; end end Pwd=0; if(ctr==n1) ctr=ctr-1; end for j=1:ctr Pwd=Pwd+Pref(1,j); end PrefNew=(Pwt-Pwd)/(n1-ctr); Prefb=PrefNew; end else % Pw > Pref Pscn=Pw(1,ctr)-Prefb; if (((Psc + Pscn)<=Pscmax) && (Pscn<=PconP) && (Prefb<=Prate)) Pref(1,ctr)=Prefb; Pscd(1,ctr) = Psc + Pscn; Psc = Psc + Pscn; else b=ctr;

~ 73 ~

Ryerson University

APPENDICES

2010

Pwb=0; while(Pw(1,ctr)>Prefb) Pwb=Pwb+Pw(1,ctr); ctr=ctr+1; c=ctr; if(ctr>n1) break; end end Pwb=Pwb/(ctr-b); if(Psci==Pscmax) Pwb = Pwb + (0.75 * Pwb); Prefb=Pwb; end ctr=ctr-1; for i=b:ctr Pscn=Pw(1,i)-Prefb; if (((Psc + Pscn)<=Pscmax) && (Pscn<=PconP) && (Prefb<=Prate)) Pref(1,i)=Prefb; Pscd(1,i) = Psc + Pscn; Psc = Psc + Pscn; end end Pwd=0; if(ctr==n1) ctr=ctr-1; end for j=1:ctr Pwd=Pwd+Pref(1,j); end PrefNew=(Pwt-Pwd)/(n1-ctr); Prefb=PrefNew; end end ctr=ctr+1; end Pot=0;Pct=0; for q=1:n1 Pot=Pot+Pref(1,q); Pod(1,q)=Pot; Pa=Pw(1,q)-Pref(1,q);

~ 74 ~

Ryerson University Pc(1,q)=Pw(1,q)-Pref(1,q); Pct=Pct+Pc(1,q); end Pref' Pwt Pot

APPENDICES

2010

subplot(2,1,1) plot(Pw,'.-b'); % Power gen or WT hold on grid on plot(Pref,'.r'); % P reference xlabel('sec'); ylabel('Power'); title('Pref Optimal') hold off subplot(2,1,2) plot(Pwx,'.b'); % Power gen or WT hold on plot(Pod,'.r'); % Power gen or WT hold on xlabel('sec'); ylabel('Power'); title('Pref Optimal')

~ 75 ~

Ryerson University

APPENDICES

2010

IST Results
120 Data Samples

Figure 41: Pw and Pref for IST (120 Samples)

Figure 42: Total wind and IST Energy (120 Samples)

~ 76 ~

Ryerson University
600 Data Samples

APPENDICES

2010

Figure 43: Pw and Pref for IST 600 Samples

Figure 44: Total wind and IST Energy (600 Samples)

~ 77 ~

Ryerson University

APPENDICES

2010

APPENDIX B: MIXED INTEGER LINEAR PROGRAMMING TECHNIQUE
MILPT Code
close all; clear all; clc; clear prob;

% ------------DATA-----------------Pomax = +1.5e6; Pcmin = -0.75e6; Pcmax = +0.75e6; Ecmin = 0; Ecmax = +187.2e6; Ec0 =78.65e6; % 120 Samples (Wind Pattern) Wind=[8 6 9 6 8 10 9 10 8 12 10 9 7 6 8 10 9 11 8 9 8 9 7 8 8 6 9 10 11 12 10 11 10 9 10 9 12 10 9 7 6 8 10 11 9 8 7 10 8 9 6 8 6 9 6 8 10 9 10 7 10 9 10 8 12 10 9 7 8 6 9 6 8 6 8 10 9 11 8 9 8 9 7 8 6 8 10 9 10 9 8 10 9 7 8 6 9 10 11 12 9 11 10 11 9 8 7 10 8 9 6 8 6 9 6 8 10 9 10 8]; c=numel(Wind); % blank 120 Samples storage created for j=1:c Pw(1,j)=0; end % MPPT based corresPonding Power stored for 120 wind samples for j=1:c %Wind(1,j)=Wind(1,j); if(Wind(1,j)<6) Pw(1,j)=0; elseif(Wind(1,j)==6) Pw(1,j)=0.12e6; elseif(Wind(1,j)==7) Pw(1,j)=0.2e6; elseif(Wind(1,j)==8) Pw(1,j)=0.29e6;

~ 78 ~

Ryerson University elseif(Wind(1,j)==9) Pw(1,j)=0.41e6; elseif(Wind(1,j)==10) Pw(1,j)=0.55e6; elseif(Wind(1,j)==11) Pw(1,j)=0.73e6; elseif(Wind(1,j)==12) Pw(1,j)=0.95e6; elseif(Wind(1,j)==13) Pw(1,j)=1.21e6; else Pw(1,j)=1.21e6; end end Pw=Pw'; %

APPENDICES

2010

-----------DATA END --------------

Nh = numel(Pw); Nh1 = Nh - 1; Nr = 1 + 3 * Nh + 2 * Nh1 ; Nc = 4 * Nh ; prob.a = sparse(Nr , Nc ); prob.blx (0*Nh+1:1*Nh,1) = Pcmin; prob.bux(0*Nh+1:1*Nh,1) = Pcmax; prob.blx (1*Nh+1:2*Nh,1) = 0; prob.bux(1*Nh+1:2*Nh,1) = Pomax; prob.blx (2*Nh+1:4*Nh,1) = 0; prob.bux(2*Nh+1:4*Nh,1) = 1; Pwt=0; for i=1:Nh Pwt=Pwt+Pw(i,1); Pwd(i,1)=Pwt; end % sum (Pct) = 0; Rw = 0; prob.a(Rw+1,1:Nh) = 1;

prob.blc(Rw+1) = 0; prob.buc(Rw+1) = 0;

% Ecmin - Ec0 < sum_k(Pck) < Ecmax - Ec0 Rw = 1; prob.blc (Rw+(1:Nh)) = Ecmin - Ec0; prob.buc (Rw+(1:Nh)) = Ecmax - Ec0;

~ 79 ~

Ryerson University

APPENDICES
end;

2010

for t = 1 : Nh; for k = 1:t; prob.a(Rw+t,1:k) = 1; end;

% Pwt < Pct + Pot < Pwt Rw = 1 + Nh; prob.blc(Rw + (1:Nh)) = Pw; prob.buc(Rw + (1:Nh)) = Pw; prob.a(Rw + (1:Nh) , (1:Nh)) = speye(Nh); %Pc prob.a(Rw + (1:Nh) , Nh + (1:Nh)) = speye(Nh); %Po

% -inf < Pot+1 - Pot - Pomax * USt+1 < 0 Rw = 1 + 2*Nh; prob.blc(Rw + (1:Nh1)) = -inf; prob.buc(Rw + (1:Nh1)) = 0; prob.a (Rw + (1:Nh1), Nh+(1:Nh1) ) = -speye(Nh1); %Pot prob.a (Rw + (1:Nh1), Nh+(2:Nh ) ) = ... prob.a (Rw + (1:Nh1), Nh+(2:Nh ) ) +speye(Nh1); %Pot+1 prob.a (Rw + (1:Nh1),2*Nh+(2:Nh ) ) = -speye(Nh1) * Pomax; %USt1 % 0 < Pos,t+1 - Pos1 + Pomax * Ds,t+1 < inf Rw = 1 + 2*Nh + Nh1; prob.blc(Rw + (1:Nh1)) = 0; prob.buc(Rw + (1:Nh1)) = inf; prob.a (Rw + (1:Nh1), Nh+(1:Nh1) ) = -speye(Nh1); %Pot prob.a (Rw + (1:Nh1), Nh+(2:Nh ) ) = ... prob.a (Rw + (1:Nh1), Nh+(2:Nh ) ) +speye(Nh1); %Pot+1 prob.a (Rw + (1:Nh1),3*Nh+(2:Nh ) ) = +speye(Nh1) * Pomax; % 0 < Us,t+1 - Us,t - Ss,t+1 + Ds,t+1 < 0 % 0 < Sst + Dst < 1 Rw = 1 + 2*Nh + 2*Nh1 prob.blc(Rw + (1:Nh)) = 0; prob.buc(Rw + (1:Nh)) = 1; prob.a (Rw + (1:Nh), 2*Nh+(1:Nh) ) = speye(Nh) ; %Sst prob.a (Rw + (1:Nh), 3*Nh+(1:Nh) ) = speye(Nh) ; %Dst prob.c(1,Nc) = 0; prob.c(2*Nh + (1:2*Nh) ) = 1; prob.ints.sub=[2*Nh + (1:2*Nh)]; [r, res]=mosekopt('minimize',prob); Pc = res.sol.int.xx(0*Nh+1:1*Nh); Po = res.sol.int.xx(1*Nh+1:2*Nh); S = res.sol.int.xx(2*Nh+1:3*Nh);

%UDt+1

~ 80 ~

Ryerson University

APPENDICES

2010

D = res.sol.int.xx(3*Nh+1:4*Nh); Ec = prob.a(2:Nh+1,:) * res.sol.int.xx; Pot=0; for i=1:Nh Pot=Pot+Po(i,1); Pod(i,1)=Pot; end [' Pw Pc Ec Po [Pw Pc Ec Po S D] Pwt Pot subplot(2,1,1) plot(Pw,'.-b'); hold on grid on plot(Po,'.r'); xlabel('Sec'); ylabel('Power'); title('Mosek Pref Optimal') hold off subplot(2,1,2) plot(Pwd,'.b'); hold on plot(Pod,'.r'); hold on xlabel('Sec'); ylabel('Power'); title('Pref Optimal') hold off

S

D ']

~ 81 ~

Ryerson University
120 Data Samples

APPENDICES

2010

Figure 45: Pw and Pref for MILPT 120 Samples

Figure 46: Total wind and MILPT Energy (120 Samples)

~ 82 ~

Ryerson University
600 Data Samples

APPENDICES

2010

Figure 47: Pw and Pref for MILPT 600 Samples

Figure 48: Total wind and MILPT Energy (600 Samples)

~ 83 ~

Ryerson University

APPENDICES

2010

120 Data Samples with zero, rated and above rated wind speeds

E(MW)

1.4 1.2 1 0.8 0.6 0.4 0.2 0 1 6 11 16 21 26 31 36 41 46 51 56 61 66 71 76 81 86 91 96 101 106 111 116 Wind Power Power Reference

Sec

Figure 49: Pw and Pref for MILPT 120 Samples

E(MWh)

60 50 40 30 20 10 0 1 6 11 16 21 26 31 36 41 46 51 56 61 66 71 76 81 86 91 96 101 106 111 116 Total Wind Energy Total Output Energy

Sec

Figure 50: Total wind and MILPT Energy (120 Samples)

~ 84 ~

Ryerson University

APPENDICES

2010

APPENDIX C: SIMULATED SYSTEM DATA
Table 2: Induction machine data Name fs Vnom Pnom Rs Lls Lm Value 60 Hz 575 V(L-L) 1.5e6/0.9 VA 0.00706 pu 0.171 pu 0.29 Name H F P Rr Llr Value 5.041 s 0.01 pu 3-pairs 0.005 pu 0.156 pu

Table 3: Turbine data Name Pmech P@C Value 1.5e6 W 0.73 pu Name r @ C Value 1.2 pu

Table 4: Topology data Name Esc Vnom Vmin Rsc Value 157.3 MJ 1200 V 100 V 4.5 m Name C Vmax L Value 150 F 1350 V 10 mH

~ 85 ~

Ryerson University

APPENDICES
Table 5: Misc data Name Vdclink Cdclink R-Rlchoke Value 1200 V 10e-3 F 0.0030 pu Name L-Rlchoke fpwm Value 0.30 pu 1620 Hz

2010

~ 86 ~


