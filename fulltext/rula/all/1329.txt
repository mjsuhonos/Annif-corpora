Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2010

Current source converters for megawatt wind energy conversion systems
Jingya Dai
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Electrical and Computer Engineering Commons Recommended Citation
Dai, Jingya, "Current source converters for megawatt wind energy conversion systems" (2010). Theses and dissertations. Paper 841.

This Dissertation is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

CURRENT SOURCE CONVERTERS FOR MEGAWATT WIND ENERGY CONVERSION SYSTEMS
By

Jingya Dai
B. Sc., Shanghai Jiao Tong University, Shanghai, China, 2001 M. Sc., Shanghai Jiao Tong University, Shanghai, China, 2004

A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of Doctor of Philosophy in the program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2010 © Jingya Dai, 2010

Author's Declaration
I hereby declare that I am the sole author of this dissertation.

I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research.

___________________

I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

___________________

iii

Borrower's Page
Ryerson University requires the signatures of all persons using or photocopying this dissertation. Please sign below, and give address and date.

Name

Address

Signature

Date

v

Current Source Converters for Megawatt Wind Energy Conversion Systems
Jingya Dai
Doctor of Philosophy Electrical and Computer Engineering Ryerson University, Toronto, 2010

Abstract
The rapid growth of wind energy market has propelled the research and development of highpower wind turbines in the megawatt range. At this power level, current source converter (CSC) topologies possess favorable features such as simple structure, grid friendly waveforms, controllable power factor, and reliable grid short-circuit protection. This dissertation proposes the use of current source converters for permanent magnet synchronous generator based megawatt wind energy conversion systems (WECS). Related research in terms of converter topology, modulation scheme, control strategy and grid integration are carried out to adapt the proposed configuration for megawatt wind applications. Various current source converter topologies are compared for wind applications. Detailed feasibility study and performance evaluation are conducted based on theoretical analysis and simulation results. Among all, the back-to-back pulse-width modulated (PWM) current source converter is identified as the most promising converter configuration for megawatt WECS due to its high performance, control flexibility and compliance with grid connection codes. A novel multi-sampling space vector modulation (MS-SVM) scheme with superior harmonic performance and controllability is proposed to operate the PWM CSC. The device switching frequency under MS-SVM is investigated and methods to eliminate additional switching are presented. The proposed scheme is compared with the conventional modulation schemes. It is demonstrated that the MS-SVM scheme provides superior performance at low switching vii

frequency. It not only offers high control flexibility but also substantially reduces the low-order harmonics existing in the conventional schemes. System modeling and controller design for the current source converter based WECS are then presented. Dynamic, steady-state and small-signal models are developed for analysis and controller design. An optimum dc-link current control scheme is developed to achieve the best dynamic performance and maximize the system overall efficiency. Control strategies such as decoupled active and reactive power control and power feed-forward control are also proposed to further improve the system dynamic performance. Grid integration issues, especially the low-voltage ride-through capability of the current source converter based WECS, are addressed. Challenges for the grid-connected current source converter are identified based on grid code requirements. A unified dc-link current control scheme is proposed to assist the system to ride through grid low-voltage faults while maintaining the control capability of active and reactive power during and after the fault. The unified dc-link controller can be well embedded in the system control structure. Smooth transitions between normal and fault operations are achieved. Simulation and experimental verifications for various objectives are provided throughout the dissertation. The results validate the proposed solutions for the main challenges of using current source converter in a megawatt WECS.

viii

Acknowledgement
The work presented in this dissertation was carried out in the Laboratory of Electric Drive Application and Research (LEDAR) at Ryerson University. I would like to express my deep gratitude to my supervisors, Professors Bin Wu and Dewei Xu for their invaluable guidance, generous support, and consistent kindness throughout the course of the work. I would like to thank all my friends in LEDAR, especially Dr. Yongqiang Lang, Dr. Yunwei Li, and Albert Qiu, for many fruitful discussions and joyful time that we shared together. Thanks are extended to Dr. Navid R. Zargari, Dr. Manish Pande and other colleagues at Rockwell Automation Canada for their kind support during my part time work there. Special appreciation goes to my dear parents and brother for understanding and supporting me all along. Thanks to my husband, for always being by my side and inspiring me. Financial supports from Professors Bin Wu, Dewei Xu and Ryerson University are gratefully acknowledged.

ix

List of Publications
Patents
[1] J. Dai, D. Xu, B. Wu, and N. R. Zargari, `Unified DC Link Current Control Scheme for Grid Fault Ride-through in Current Source Converter Based Wind Energy Conversion Systems', Provisional Application for US Patent, Serial #61/239,949, filed September 4, 2009. Full patent application is in preparation. [2] J. Dai, Y. Lang, B. Wu, D. Xu and N. R. Zargari, `Power Conversion Systems and Methods for Controlling Harmonic Distortion,' European Patent Application Serial #09180852.7, filed December 29, 2009. [3] J. Dai, Y. Lang, B. Wu, D. Xu and N. R. Zargari, `Power Conversion Systems and Methods for Controlling Harmonic distortion,' Chinese Patent Application filed by December 30, 2009, Serial # to be provided. [4] J. Dai, Y. Lang, B. Wu, D. Xu and N. R. Zargari, `Power Conversion Systems and Methods for Controlling Harmonic distortion,' US Patent Application Serial #12/345,916, filed December 30, 2008.

Journal and conference publications
[1] J. Dai, D. Xu, and B. Wu, "A Novel Control Scheme for Current-Source-Converter-Based PMSG Wind Energy Conversion Systems," Power Electronics, IEEE Transactions on, vol. 24, pp. 963972, 2009. [2] J. Dai, Y. Lang, B. Wu, D. Xu, and N. R. Zargari, "A Multisampling SVM Scheme for Current Source Converters With Superior Harmonic Performance," Power Electronics, IEEE Transactions on, vol. 24, pp. 2436-2445, 2009.

x

[3]

J. Dai, D. Xu, B. Wu, and N. R. Zargari, "Unified DC Link Current Controller for Low-voltage ride-through in Current Source Converter Based Wind Energy Conversion Systems", submitted to Power Electronics, IEEE Transactions on, first revision submitted on Feb 2010.

[4]

J. Dai, D. Xu, B. Wu, and N. R. Zargari, "A unified dc link current control scheme for grid fault ride-through in current source converter based wind energy conversion systems," in Energy Conversion Congress and Exposition, 2009. ECCE. IEEE, 2009, pp. 1383-1390.

[5]

J. Dai, Y. Lang, B. Wu, D. Xu, and N. Zargari, "A Multi-sampling SVM Scheme for Current Source Converter with Superior Harmonic Performance," in Applied Power Electronics Conference and Exposition, 2009, APEC 2009, Twenty-Fourth Annual IEEE, 2009, pp. 132-138.

[6]

J. Dai, D. Xu, B. Wu, N. R. Zargari, and Y. Lang, "Dynamic performance analysis and improvements of a current source converter based PMSM wind energy system," in Power Electronics Specialists Conference, 2008. PESC 2008. IEEE, 2008, pp. 99-105.

[7]

J. Dai, D. Xu, and B. Wu, "A Novel Control System for Current Source Converter Based Variable Speed PM Wind Power Generators," in Power Electronics Specialists Conference, 2007. PESC 2007. IEEE, 2007, pp. 1852-1857.

xi

Table of Contents
Abstract........................................................................................................................................ vii Acknowledgement ........................................................................................................................ ix List of Publications ....................................................................................................................... x Table of Contents ........................................................................................................................ xii List of Figures and Tables........................................................................................................ xvii Glossary of Acronyms and Symbols....................................................................................... xxiii Chapter 1 Introduction.............................................................................................................. 1 1.1 Background of wind energy conversion systems.......................................................... 2 1.1.1 Configuration of wind energy conversion systems................................................. 2 1.1.2 Megawatt wind energy conversion systems ........................................................... 3 1.2 Review of prior art for megawatt WECS...................................................................... 4 1.2.1 System configurations............................................................................................. 4 1.2.2 High-power converters............................................................................................ 7 1.2.3 Grid fault ride-through.......................................................................................... 13 1.3 Dissertation objectives ................................................................................................ 14 1.3.1 Proposed configuration ......................................................................................... 14 1.3.2 Objectives ............................................................................................................. 16 1.4 Dissertation outline ..................................................................................................... 18 Chapter 2 Current Source Converter Topologies for PMSG-WECS ................................. 20 2.1 Grid-side converter topologies.................................................................................... 21 2.1.1 Thyristor converter................................................................................................ 22 2.1.2 PWM CSI.............................................................................................................. 23 2.2 Generator-side converter topologies ........................................................................... 24 xii

2.2.1 Diode rectifier ....................................................................................................... 24 2.2.2 PWM CSR ............................................................................................................ 29 2.3 Diode rectifier with PWM CSI ................................................................................... 33 2.3.1 System operating range......................................................................................... 33 2.3.2 Comparision with PWM VSI topology................................................................. 35 2.4 Diode rectifier and PWM CSI with a current boost stage .......................................... 38 2.5 PWM CSR and PWM CSI.......................................................................................... 41 2.6 Summary of different CSC topologies........................................................................ 42 Chapter 3 Multi-sampling SVM for CSC with Superior Harmonic Performance............ 44 3.1 PWM schemes for CSC .............................................................................................. 45 3.1.1 Selective Harmonic Elimination (SHE)................................................................ 46 3.1.2 Trapezoidal Pulse-width Modulation (TPWM) .................................................... 48 3.1.3 Space Vector Modulation (SVM) ......................................................................... 49 3.1.4 Comparison of modulation schemes..................................................................... 52 3.2 Multi-sampling SVM .................................................................................................. 54 3.3 Selection of switching patterns for MS-SVM............................................................. 55 3.4 Switching frequency of MS-SVM .............................................................................. 58 3.4.1 Case 1.................................................................................................................... 60 3.4.2 Case 2.................................................................................................................... 61 3.4.3 Case 3.................................................................................................................... 62 3.4.4 Methods to reduce switching frequency ............................................................... 62 3.5 Comparison of MS-SVM with conventional SVM .................................................... 64 3.5.1 Low-order harmonics............................................................................................ 65 3.5.2 Grid- or generator-side performance .................................................................... 67 3.6 Experimental verification............................................................................................ 69 3.7 Conclusions................................................................................................................. 72 Chapter 4 Modeling and Analysis of CSC based PMSG-WECS......................................... 74 4.1 System configuration and modeling ........................................................................... 74 xiii

4.1.1 Wind turbine power model ................................................................................... 76 4.1.2 Current source converters ..................................................................................... 79 4.1.3 Generator-side model............................................................................................ 82 4.1.4 Grid-side model .................................................................................................... 84 4.1.5 dc-link model ........................................................................................................ 85 4.1.6 State-space equations ............................................................................................ 86 4.2 Analysis of steady-state operations............................................................................. 87 4.2.1 Steady-state equations........................................................................................... 87 4.2.2 Generator-side minimum dc-link current requirement ......................................... 89 4.2.3 Grid-side minimum dc-link current requirement.................................................. 90 4.3 System stability and controller design ........................................................................ 92 4.3.1 Small-signal model ............................................................................................... 92 4.3.2 Transfer function derivation ................................................................................. 93 4.3.3 Control system stability analysis .......................................................................... 94 4.3.4 Controller design procedure.................................................................................. 95 4.4 Verification of the system model................................................................................ 96 4.4.1 Verification of the grid-side model....................................................................... 96 4.4.2 Verification of the generator-side model ............................................................ 100 4.5 Conclusions............................................................................................................... 104 Chapter 5 Control System Design for PWM CSC Based PMSG-WECS ......................... 105 5.1 Overview of the control system ................................................................................ 105 5.2 dc-link current control............................................................................................... 108 5.2.1 dc-link current control by generator-side converter............................................ 109 5.2.2 dc-link current control by grid-side converter .................................................... 114 5.2.3 Improvement of dc-link current control.............................................................. 117 5.2.4 Simulation and experimental verification........................................................... 120 5.3 Grid-side control ....................................................................................................... 121 5.3.1 dc-link current control......................................................................................... 122

xiv

5.3.2 Grid-side reactive power control ........................................................................ 126 5.4 Generator-side control .............................................................................................. 128 5.4.1 Generator speed control ...................................................................................... 129 5.4.2 Optimized generator operation ........................................................................... 131 5.5 Power feed-forward to improve dynamic performance ............................................ 131 5.6 Simulation verification.............................................................................................. 132 5.6.1 Simulation system setup ..................................................................................... 132 5.6.2 Power flow control.............................................................................................. 133 5.6.3 Minimum dc-link current control........................................................................ 135 5.6.4 Grid voltage and current waveforms................................................................... 136 5.7 Experimental verification.......................................................................................... 138 5.7.1 Experimental setup.............................................................................................. 138 5.7.2 Power flow control.............................................................................................. 138 5.7.3 Minimum dc-link current control........................................................................ 138 5.7.4 Grid voltage and current waveforms................................................................... 139 5.7.5 Power feed-forward control performance........................................................... 141 5.8 Conclusions............................................................................................................... 142 Chapter 6 Unified DC-Link Current Controller for Grid Low-Voltage Ride-Through. 144 6.1 Grid integration requirements for WECS ................................................................. 144 6.1.1 General requirements .......................................................................................... 145 6.1.2 Low-voltage ride-through in converter based WECS......................................... 146 6.2 Grid-integrated CSC-WECS..................................................................................... 148 6.3 Unified dc-link current controller ............................................................................. 149 6.3.1 dc-link current controller design......................................................................... 150 6.3.2 Reactive current compensation to support grid voltage...................................... 153 6.3.3 Addtional features and concerns......................................................................... 155 6.4 Simulation verification.............................................................................................. 156 6.4.1 Simulation setup.................................................................................................. 156

xv

6.4.2 Simulation results................................................................................................ 156 6.5 Experimental verification.......................................................................................... 160 6.5.1 Grid fault simulator setup ................................................................................... 160 6.5.2 Grid voltage phase lock loop .............................................................................. 161 6.5.3 Experimental results............................................................................................ 161 6.6 Conclusions............................................................................................................... 165 Chapter 7 Conclusions........................................................................................................... 166 7.1 Conclusions............................................................................................................... 166 7.2 Future work............................................................................................................... 169 References.................................................................................................................................. 170 Appendix A System Parameters in Simulation and Experiment ......................................... 178 Appendix B Small-Signal Models for CSC-PMSG-WECS................................................... 180

xvi

List of Figures and Tables
Figures
Fig. 1-1 Basic components of wind energy conversion systems ................................................................. 2 Fig. 1-2 Configuration of a WECS using a DFIG........................................................................................ 5 Fig. 1-3 Configuration of a direct-drive/semi-direct-drive WECS using an EESG..................................... 6 Fig. 1-4 Configuration of a direct-drive/semi-direct-drive WECS using a PMSG. ..................................... 7 Fig. 1-5 Enercon GmbH E112 using low-voltage converters ...................................................................... 8 Fig. 1-6 Per phase diagram of typical medium-voltage voltage source converter topologies ................... 10 Fig. 1-7 ABB PCS 6000 using medium-voltage neutral point clamped converter. ................................... 11 Fig. 1-8 PWM current source converter connected to the grid. ................................................................. 14 Fig. 1-9 Dissertation organization.............................................................................................................. 18 Fig. 2-1 Simplified structure of full-rating power converter based wind energy conversion system. ....... 20 Fig. 2-2 Three-phase thyristor converter connected to the grid. ................................................................ 22 Fig. 2-3 PWM current source inverter connected to the grid..................................................................... 24 Fig. 2-4 Three-phase diode rectifier connected to a PMSG....................................................................... 25 Fig. 2-5 Optimum generator operating speed, torque and power versus wind speed. ............................... 26 Fig. 2-6 Calculated dc-link current for a diode rectifier connected to a PMSG. ....................................... 28 Fig. 2-7 PWM current source rectifier connected to a PMSG. .................................................................. 29 Fig. 2-8 Phasor diagrams of the generator variables using different generator d-axis current. ................. 30 Fig. 2-9 Phasor diagrams of the converter current using different generator d-axis current. .................... 31 Fig. 2-10 Steady-state voltage and current values using different generator d-axis current. ..................... 32 Fig. 2-11 A wind energy conversion system using diode rectifier and PWM CSI .................................... 33 Fig. 2-12 dc-link current requirements for the configuration of PWM CSI with diode rectifier............... 34 Fig. 2-13 Simulated waveforms of a WECS using diode rectifier with PWM CSI ................................... 36 Fig. 2-14 A wind energy conversion system using diode rectifier and PWM VSI.................................... 36

xvii

Fig. 2-15 dc-link voltage requirements for the configuration of VSC with diode rectifier ....................... 37 Fig. 2-16 A wind energy conversion system using diode rectifier and PWM CSI with a chopper ........... 38 Fig. 2-17 Controller diagram of a WECS using diode rectifier and PWM CSI with a chopper. ............... 39 Fig. 2-18 Simulated waveforms of a WECS using diode rectifier and PWM CSI with a chopper............ 40 Fig. 2-19 Simulated steady-state grid- and generator-side waveforms at rated wind speed. ..................... 41 Fig. 2-20 A wind energy conversion system using PWM CSR and PWM CSI. ....................................... 41 Fig. 3-1 PWM current source inverter ....................................................................................................... 46 Fig. 3-2 Nine-pulse SHE pattern................................................................................................................ 47 Fig. 3-3 Nine-pulse TPWM pattern. .......................................................................................................... 48 Fig. 3-4 Operating principle of SVM for CSI............................................................................................ 50 Fig. 3-5 Vector selection in conventional SVM......................................................................................... 51 Fig. 3-6 Harmonic profile of conventional SVM....................................................................................... 52 Fig. 3-7 Vector selection in the proposed MS-SVM.................................................................................. 54 Fig. 3-8 Harmonic profile of MS-SVM with SR = 8 ................................................................................. 55 Fig. 3-9 Harmonic profile of MS-SVM with SR =  ................................................................................ 55 Fig. 3-10 Various switching patterns for current source converters. ......................................................... 56 Fig. 3-11 Nine-pulse triangle carrier based SPWM method. ..................................................................... 57 Fig. 3-12 Nine-pulse saw-tooth-carrier based SPWM method. ................................................................. 58 Fig. 3-13 Location of counter periods in the space vector plane. .............................................................. 59 Fig. 3-14 Case 1 ­ one additional switching caused by the sector transition............................................. 60 Fig. 3-15 Case 2 ­ two additional switchings caused by the sector transition........................................... 61 Fig. 3-16 Case 3- additional switching caused by the discretization ......................................................... 62 Fig. 3-17 Simulated waveforms of Case 2 ................................................................................................. 63 Fig. 3-18 Simulated waveforms of Case 3 ................................................................................................. 64 Fig. 3-19 Magnitudes of 5th and 7th order harmonics as the modulation index changes ............................ 65 Fig. 3-20 Magnitudes of 5th and 7th order harmonics as the control angle changes ................................... 66

xviii

Fig. 3-21 Configuration of a current source converter connected to the grid ............................................ 67 Fig. 3-22 Magnitude plot of grid current with respect to the converter current......................................... 68 Fig. 3-23 Grid current THD as the converter modulation index changes .................................................. 69 Fig. 3-24 Experimental waveforms of SVM and MS-SVM with unity modulation index ........................ 70 Fig. 3-25 Experimental waveforms of switching frequency reduction in Case 2 ...................................... 71 Fig. 3-26 Experimental waveforms of switching frequency reduction in Case 3 ...................................... 72 Fig. 4-1 Configuration of a CSC- PMSG-WECS system. ......................................................................... 74 Fig. 4-2 Wind turbine power characteristics .............................................................................................. 77 Fig. 4-3 Wind turbine power efficiency curve ........................................................................................... 78 Fig. 4-4 Configuration of the grid-side CSC.............................................................................................. 79 Fig. 4-5 Configuration of generator-side current source converter............................................................ 82 Fig. 4-6 Equivalent circuit of PMSG in synchronous frame...................................................................... 83 Fig. 4-7 Equivalent circuit of the grid-side model. .................................................................................... 85 Fig. 4-8 Configuration of the dc link. ........................................................................................................ 85 Fig. 4-9 Generator operating speed, mechanical torque and power curves. .............................................. 89 Fig. 4-10 dc-link current requirements as the wind speed changes. .......................................................... 92 Fig. 4-11 A typical control loop diagram................................................................................................... 94 Fig. 4-12 Simplified diagram of the grid-side dc-link current control loop............................................... 97 Fig. 4-13 dc-link current step responses based on transfer function deduction ......................................... 99 Fig. 4-14 dc-link current step responses in simulation ............................................................................ 100 Fig. 4-15 Simplified diagram of the generator-side speed control loop................................................... 101 Fig. 4-16 Generator speed step responses based on transfer function deduction..................................... 102 Fig. 4-17 Generator speed step responses in simulation. ......................................................................... 103 Fig. 5-1 Converter configuration and control variables in a CSC-PMSG-WECS. .................................. 105 Fig. 5-2 Simplified control block diagram with dc-link current controlled by generator-side converter.109 Fig. 5-3 dc-link current control loop using generator-side converter. ..................................................... 111

xix

Fig. 5-4 Root locus plot of generator-side dc-link current controller with compensation. ...................... 112 Fig. 5-5 Magnitude plot of open-loop transfer function Gc_genKgenGgenHf_gen. .......................................... 113 Fig. 5-6 Root loci variation with inertia in generator-side dc-link current controller.............................. 114 Fig. 5-7 Simplified control block diagram with dc-link current controlled by grid-side converter......... 115 Fig. 5-8 dc-link current control loop using grid-side converter. .............................................................. 115 Fig. 5-9 Root locus plot of grid-side dc-link current controller with compensation................................ 116 Fig. 5-10 Magnitude plot of open-loop transfer function Gc_gridKgridGgridHf_grid....................................... 117 Fig. 5-11 Root locus plot of grid-side dc-link current controller with damping. ..................................... 118 Fig. 5-12 Magnitude plot of open-loop transfer function Gc_gridKgridGgridHf_grid with damping................ 119 Fig. 5-13 Step response of the dc-link current controlled by the grid-side converter with damping....... 119 Fig. 5-14 Simulated waveform of dc-link current step response. ............................................................ 120 Fig. 5-15 Experimental waveform of dc-link current step response. ....................................................... 121 Fig. 5-16 Block diagram of the grid-side converter control..................................................................... 122 Fig. 5-17 Block diagram of dc-link current control loop. ........................................................................ 124 Fig. 5-18 Bode plot of dc-link current open-loop transfer function without compensation. ................... 124 Fig. 5-19 Bode plot of dc-link current open-loop transfer function with compensation.......................... 125 Fig. 5-20 Block diagram of grid reactive current control loop. ............................................................... 127 Fig. 5-21 Bode plot of grid reactive current open-loop transfer function without compensation............ 127 Fig. 5-22 Bode plot of grid reactive current open-loop transfer function with compensation................. 128 Fig. 5-23 Block diagram of the generator-side converter control. ........................................................... 129 Fig. 5-24 Root locus plot of generator speed control loop....................................................................... 130 Fig. 5-25 Bode plot of generator speed open-loop transfer function with compensation. ....................... 130 Fig. 5-26 dc-link current regulator with generator power feed-forward .................................................. 132 Fig. 5-27 Power flow control response to wind speed step changes........................................................ 134 Fig. 5-28 Generator speed and grid output power responses with slower speed regulation. ................... 135 Fig. 5-29 Minimum dc-link current control at different wind speeds...................................................... 136

xx

Fig. 5-30 Minimum dc-link current and grid-side converter response with slower speed regulation. .... 137 Fig. 5-31 Steady-state grid-side waveforms at rated condition for unity power factor operation. .......... 137 Fig. 5-32 Experimental waveforms of power flow control...................................................................... 139 Fig. 5-33 Experimental waveforms of minimum dc-link current control. ............................................... 140 Fig. 5-34 Steady-state experimental waveforms of grid line-to-line voltage and line current................. 140 Fig. 5-35 Experimental waveforms of dc-link current response to mechanical torque step changes. ..... 141 Fig. 5-36 Experimental waveforms of dc-link current response to the step changes in both mechanical torque and generator speed. ...................................................................................................................... 142 Fig. 6-1 Grid low-voltage ride-through requirement in E. ON grid code. ............................................... 146 Fig. 6-2 Reactive current compensation requirement in E. ON grid code. .............................................. 147 Fig. 6-3 Configuration of the grid-integrated current source converter based WECS............................. 148 Fig. 6-4 Simplified block diagram of the control system with the unified dc-link current controller. .... 150 Fig. 6-5 Selection of the reference values for grid- and generator-side converters. ................................ 152 Fig. 6-6 Block diagram of the unified dc-link current controller............................................................. 152 Fig. 6-7 Grid currents and minimum dc-link current requirements as the grid voltage changes. ............ 154 Fig. 6-8 Simulated grid voltage profile and responses of controller outputs to the grid fault. ................ 157 Fig. 6-9 Simulated fault ride-through waveforms of dc-link current and grid currents........................... 158 Fig. 6-10 Simulated fault ride-through waveforms of generator speed and grid output powers. ............ 159 Fig. 6-11 Simulated grid phase voltage and current waveforms during fault. ......................................... 160 Fig. 6-12 Configuration of the grid fault simulator in experiment .......................................................... 161 Fig. 6-13 Grid voltage DPLL performance when grid voltage drops to zero. ......................................... 162 Fig. 6-14 Experimental waveforms of grid voltage magnitude and controller outputs. .......................... 163 Fig. 6-15 Experimental waveforms of dc-link current and grid currents................................................. 163 Fig. 6-16 Experimental waveforms of generator speed and grid output powers ..................................... 164 Fig. 6-17 Experimental waveforms of grid phase current and line-to-line voltage ................................. 164 Fig. A-1 Low-voltage experimental setup of a CSC-PMSG-WECS . .................................................... 179

xxi

Tables
Table 1-1 Comparison of a 4.5MW system using LV and MV converters ................................................. 9 Table 2-1 Comparison of three CSC converter topologies ........................................................................ 43 Table 3-1 Comparison of the carrier frequencies in CSC and VSC........................................................... 56 Table 3-2 Parameters of MS-SVM and SVM methods for comparison .................................................... 65 Table A-1 System parameters in simulation and experiment .................................................................. 178

xxii

Glossary of Acronyms and Symbols
CSC DFIG DPF DPLL DSP EESG EMF FFT FOC FPGA GTO LCI LV LVRT MPPT MS-SVM MV NPC PCC PFC PF Current Source Converter Doubly-Fed Induction Generator Displacement Power Factor Digital Phase-Locked Loop Digital Signal Processor Electrically Excited Synchronous Generator Electro-Motive Force Fast Fourier Transformation Field Oriented Control Field Programmable Gate Array Gate-Turn-Off Thyristor Load Commutated Inverter Low Voltage Low-Voltage Ride-Through Maximum Power Point Tracking Multi-Sampling Space Vector Modulation Medium Voltage Neutral Point Clamped Point of Common Coupling Power Factor Compensation Power Factor

xxiii

PLL PMSG PWM SCIG SCR SGCT SHE SR SVM THD TPWM VOC VSC WECS

Phase-Locked Loop Permanent Magnet Synchronous Machine Pulse-Width Modulation Squirrel-Cage Induction Generator Silicon Controlled Rectifier Symmetric Gate-Controlled Thyristor Selective Harmonic Elimination Sampling Ratio Space Vector Modulation Total Harmonic Distortion Trapezoidal Pulse-Width Modualtion Voltage Oriented Control Voltage Source Converter Wind Energy Conversion System

To avoid confusions, the variables in this dissertation are represented as follows. · The low-case letters normally refer to instantaneous quantities and upper-case letter refer to constants, average, or RMS value. · A variable with a suffix `a' or `b' , or `c' represents its corresponding phase a, phase b or phase c component, respectively. · A variable with a suffix `d' or `q' stands for the corresponding direct-axis or quadratureaxis components in the defined synchronous reference frame, respectively. · The sign  followed by a variable represents the small-signal variation of the variable. · A variable with superscript `*' denotes the reference value of this variable. · A variable followed by ( s ) indicates the Laplace transformation of the variable. xxiv

The following provides explanations to the variables that are commonly used in this dissertation. Other variables which only appear in specific sections are explained in the context where they appear.

Voltages Vb vcia , vcib , vcic base voltage of the system, which is the magnitude of the grid phase voltage grid-side capacitor voltages

vcid , vciq vcrd , vcrq vdcr vdci

d-axis, q-axis grid-side capacitor voltages in the synchronous frame d-axis, q-axis generator-side capacitor voltages in the synchronous frame dc-voltage of the generator-side converter dc-voltage of the grid-side converter generator terminal voltage voltage across the dc-link inductance

vg vLdc

vsa , vsb , vsc grid phase voltages vsd , vsq vs_ab d-axis, q-axis grid voltages in the synchronous frame
grid line-to-line voltage across phase a and b

Currents

Ib

base current of the system, which is the magnitude of the grid phase current

icia , icib , icic grid-side capacitor currents icid , iciq icrd , icrq d-axis, q-axis grid-side capacitor currents in the synchronous frame d-axis, q-axis generator-side capacitor currents

xxv

idc igd , igq isa , isb , isc isd , isq iwia , iwib , iwic iwid , iwiq iwrd , iwrq

dc-link current d-axis, q-axis generator stator currents in the synchronous frame grid phase currents d-axis, q-axis grid phase currents in the synchronous frame grid-side converter output currents d-axis, q-axis grid-side converter output currents in the synchronous frame d-axis, q-axis generator-side converter output currents in the synchronous frame

Flux linkage

f  gd
 gq

magnetic flux of the generator rotor d-axis generator stator flux linkage q-axis generator stator flux linkage

Frequencies and time constant

g
m s

electrical angular frequency of the generator mechanical angular frequency of the generator frequency of the grid voltage

Power and torque

Pdc Pg

power stored in the dc-link inductor generator output power

xxvi

Po Pmech Qo Teg Tm Tmech

grid-side real power output captured power from wind grid-side reactive power output electrical torque of the generator mechanical torque applied to the generator shaft mechanical torque applied to the wind turbine

LC components and generator parameters

Ci Cr
J

grid-side converter ac capacitor value generator-side converter ac capacitor value inertia of the wind turbine and generator generator d-axis synchronous inductance in the synchronous frame dc-link inductance generator q-axis synchronous inductance in the synchronous frame grid-side equivalent line inductance number of pole pairs of the generator generator stator resistance grid-side equivalent resistance

Ld Ldc Lq Ls
P Rg Rs

Converter modulation scheme related

f1 fs

fundamental frequency of the modulated waveform sampling frequency of the converter modulation scheme xxvii

f sw Gaci Gacr I w1 I wn ma mi mia , mib , mic mid , miq

device switching frequency of the converter ac gain of the modulation scheme used at the grid-side converter ac gain of the modulation scheme used at the generator-side converter the magnitude of fundamental component in converter current the magnitude of n-th order harmonic in converter current modulation index of current source inverter or rectifier modulation index of the grid-side converter equivalent phase modulation indices of the grid-side converter equivalent d-axis, q-axis modulation indices of the grid-side converter in the

synchronous frame
mr mrd , mrq

modulation index of the generator-side converter equivalent d-axis, q-axis modulation indices of the generator-side converter in the

synchronous frame
Np Tms Ts T1 , T2 , T0

the number of pulses in each half fundamental cycle of a modulated waveform sampling time period of the converter modulation scheme counter period of the converter modulation scheme dwell times for active vector 1, active vector 2, and zero vector. delay angle of the grid-side converter delay angle of the generator-side converter angle of a vector in the space vector plane relative angle of a vector within the sector it is located

i r  ref sec

xxviii

Miscellaneous

vw
d dt
s

wind turbine speed derivative operator Laplace operator

xxix

Chapter 1 Introduction
Wind energy has stood out as one of the most promising and dynamically growing sources for electricity generation. In 2008, worldwide wind energy growth was at an increased rate of 29%, with 27,261 megawatts (MW) added by new installations [1]. The total power capacity of installed wind turbines as a result has boosted up to 121,188 MW by the end of 2008, accounting for more than 1.5 % of the global electricity consumption. Today, more and more countries set up favorable policies to stimulate the growth of green energy, with particular interests on solar and wind. It is expected that the global wind power capacity will increase steadily and contribute more than 12% of the global electricity consumption by the year 2020. Environmental concern is the main factor that stimulates wind energy growth. Existing fossil energy based power generators contribute huge quantity of greenhouse gas emissions amounting up to 40% of the global total [2]. The booming of wind energy is expected to help phase out fossil-fuel generation and reduce greenhouse gas emissions. Besides environmental benefits, wind energy also provides a sustainable solution to escalating concerns about energy crisis. Moreover, it is becoming a significant stimulus to economic development by providing a mass of direct or indirect job opportunities instead of importing/exporting fossil energy resources. The wind energy industry has made tremendous advancements in various aspects of the technology. The improvements done to turbine and blade design, system control and electrical generation systems have significantly brought down the cost of wind energy. In the meantime, the size of an individual wind turbine has upgraded from a few kilowatts to a few megawatts, mainly driven by the saving of manufacturing and installation cost. The wind energy cost is becoming comparable to the cost of conventional fossil generators. All the technology advancements, together with other factors, have led to a substantial boost of wind power generation into the grid. This increased wind penetration also brings concerns of power system quality and stability. System operators are now enforcing grid connection codes on 1

large grid-connected wind turbines or wind farms. For wind turbines rated at megawatt level, variable-speed generation is the dominant technology because of its higher energy efficiency, better power quality and lower mechanical stress. The variable-speed operation of the turbine necessitates the use of power electronic converters to interface the generators with the grid. In this dissertation, current source converters (CSCs) are proposed for megawatt wind energy conversion systems (WECSs) using permanent magnet synchronous generators (PMSGs). Comprehensive work is carried out to analyze and design a complete converter system for wind power generation from the perspectives of converter topology, modulation scheme, system control and grid integration. This chapter starts with the introduction of basic configurations, latest trends and requirements for megawatt WECS. A comprehensive review on generator and converter topologies is then provided. Following the review, a new configuration is proposed, based on which the objectives and motivations of the dissertation are defined. The organization of the dissertation is summarized at the end.

1.1 Background of wind energy conversion systems
1.1.1 Configuration of wind energy conversion systems

Drive Train
Gear Box

G Generator Transformer Grid

Wind Turbine

Power Converter

Fig. 1-1 Basic components of wind energy conversion systems.

A WECS produces electricity by converting kinetic energy of the wind to electrical power. As shown in Fig. 1-1, the fundamental components of a typical WECS include wind turbine, drive train, electrical generator, possible power electronic converter, and transformer for connection with the grid.

2

The wind turbine extracts power from the fluctuating wind and converts it into mechanical energy. It is normally composed of three blades and a turbine hub for supporting the blades. The mechanical power extracted from the wind depends on many factors: wind speed, turbine angular speed, air density, blade shape and etc. In general, for a particular wind turbine and wind speed, the generated power peaks at a certain turbine rotor speed. According to the wind turbine aerodynamic characteristics, this maximum power is proportional to the cubic of wind speed [12]. The rotational motion of the turbine rotor is then coupled to the electrical generator by the mechanical drive train. The structure of the drive train strongly depends on the configuration of the WECS and may be either direct coupling or using a gearbox. The rated rotating speed of a megawatt wind turbine is normally around 10 to 15 rpm [3]. Generators directly driven by the wind turbine rotor have to be designed with a large number of poles and a large diameter to accommodate such a low turbine speed. In order to optimize the generator design, a gearbox working as a speed multiplier can be used to step up the mechanical speed of the generator rotor. The generator transforms mechanical energy to electrical energy with variable frequency and variable magnitude. Several machine types, such as squirrel-cage induction generator (SCIG), doubly-fed induction generator (DFIG), electrically excited synchronous generator (EESG) and permanent magnet synchronous generator (PMSG) have found applications in practical WECSs. The generators can be directly connected to the grid or via a power electronic converter. Detailed review of the generator and converter configurations for WECS is provided in the following sections. Finally, a WECS is connected to the grid or a wind farm power station through a voltage step-up transformer. Most megawatt wind turbines are connected to the medium-voltage network [3]. Large offshore wind farms are usually connected to the grid with even higher voltage level.

1.1.2 Megawatt wind energy conversion systems
The research presented in this dissertation targets high-power wind turbines rated at megawatt levels. Industry survey reveals that the average power rating of wind turbines has kept increasing over the past decades. Currently, developments are primarily focused on the power range of 1.5MW to 5MW per unit [4]. This is mainly propelled by the associated cost saving in initial foundation and the increase of energy harvest capability at higher altitudes with higher wind speeds. Another important driving force towards larger turbine ratings is the emerging 3

offshore wind farm technology. In the last couple of years, offshore wind farms have been expanding worldwide while existing practices are almost entirely in the shallow seas of Europe [5]. Space limitation onshore, more effective energy harvest due to higher average wind speeds and less turbulence at offshore sites, and the possible use of shorter towers because of lower wind shear are the main reasons that render offshore wind power attractive. Offshore wind turbines normally have large diameters and power ratings. Despite the prominent advantages, offshore wind capacity accounts for only roughly 1.2 percent (around 1,170 megawatts worldwide) of the total installed capacity by the end of 2007. The industry is still evaluating the viability of the offshore wind farm development due to its high cost of foundations and submarine electrical connection to the on-shore grid. Large wind turbines or wind farms have to be connected to the power system to effectively transmit and deliver the electrical energy. The power contribution of wind energy is still small compared to conventional power plants. Worldwide, there is an ambition to increase wind power share of the total electricity supply. With high penetration of wind power, the effects caused by the interaction between the WECS and the grid become significant and raise concerns. Random changes in wind speed or sudden disconnection of wind turbines may cause power quality problems or even disturb the stable operation of the grid. It is therefore widely recognized that the turbines should be designed to be compliant with the grid connection codes to enable large scale wind penetration without compromising system stability. Grid codes generally include requirements for fault ride-through capability, active power and frequency regulation, reactive power and voltage control, grid power quality and system protection.

1.2 Review of prior art for megawatt WECS
In this section, a review of previous wind power technology and research on megawatt WECS is provided. The review is carried out with a focus on the following three subjects: system configuration, converter topology and grid integration.

1.2.1 System configurations
A variety of configurations are developed for WECS. These configurations can be generally divided into two categories according to their operating mode, namely, fixed-speed wind turbine and variable-speed wind turbine. In fixed-speed configurations, the generator terminals are 4

directly connected to the grid and thus generator speed is locked within the small vicinity centering around the corresponding synchronous speed. No power converter is required in this case. On the contrary, variable-speed configurations invariably employ power converters for adjusting the generator speed according to the aerodynamic characteristics of the wind turbine. The variable-speed operation of the turbine results in higher energy efficiency and lower mechanical stress. Therefore, it becomes the dominant technology in large WECSs. The following subsections are dedicated to introduction of the well-established variable-speed configurations that are popularly used in the industry.
1.2.1.1 Configuration using a doubly-fed induction generator

The first configuration shown in Fig. 1-2 employs a DFIG and a power converter connected to the generator rotor windings [6, 7]. The stator windings of the generator are directly connected to the grid, providing a major path for the power flow. The converter controls the currents in the rotor windings and only handles the slip power of the rotor. Such a scheme requires a converter rated at around 30% of the nominal power. The converter is able to regulate the turbine speed up to the converter's maximum capacity.

Fig. 1-2 Configuration of a WECS using a DFIG.

A large percentage of the WECSs running in the field are using the DFIG configuration. This is mainly due to its cost reduction by using the fractional-rating power converter. However, the DFIG configuration has certain disadvantages that can not be overlooked. 1) The connection of the power converter necessitates the use a wound rotor with slip rings and brushes. The average life cycle of the brushes used in DFIG is only 6-12 months, which makes regular maintenance a required task. This drawback prevents DFIG from offshore applications where the maintenance cost is quite expensive. 5

2) The DFIG configuration generally requires a costly gearbox to provide a high gear-ratio for the wind turbine rotating speed to be transformed to the generator speed. The use of gearbox also brings problems of increased cost, reduced reliability and necessary regular maintenance. 3) The capability to control grid active/reactive power as well as to ride through grid faults is limited because of the reduced capacity of the power converter.
1.2.1.2 Configuration using a direct-drive or semi-direct-drive synchronous generator

The direct-drive configuration, as the name indicates, intends to avoid the use of gearbox. To achieve this objective, the rated operating speed of the generator has to be the same as that of the wind turbine. This requirement inevitably results in a machine design with high number of poles and large diameter due to the low mechanical speed and high torque of the turbine. Induction generator is not suitable for this configuration because the design of a direct-drive system leads to high magnetizing current and thereby low power factor and efficiency [8]. Synchronous generators, including electrically excited synchronous generators (EESG) and permanent magnet synchronous generators (PMSG), are the preferred types for direct-drive configuration, as shown in Fig. 1-3 and Fig. 1-4. In the past few years, the concept of semi-direct-drive also emerged as a compromise to optimize cost, size and weight of the overall system [9]. This configuration employs a one-stage gearbox in the drive train and hence, the generator pole number can be reduced to make the design more compact.

Fig. 1-3 Configuration of a direct-drive/semi-direct-drive WECS using an EESG.

All direct-drive and semi-direct-drive configurations require a full-rating power converter between the stator circuit and the grid to enable generator speed variations. Such a converter is costly and low in efficiency compared with the partially rated converter in DFIG. However, the elimination or reduced complexity of the gearbox offsets the increased cost and reduces

6

maintenance. The full-rating power converter also brings full control capability which can be utilized to significantly improve fault ride-through capability of the generation system. As a result, the direct-drive configuration with full-rating power converter becomes a favorable option for megawatt WECS.

Gear Box

PMSG

Power Converter Grid

Fig. 1-4 Configuration of a direct-drive/semi-direct-drive WECS using a PMSG.

The EESG configuration [10] in Fig. 1-3 needs an excitation circuit to provide rotor field current via a slip ring. The exciter and slip ring can be removed by replacing the EESG with a PMSG, as shown in Fig. 1-4. The advantages of using a PMSG [11, 12] are elimination of field copper loss, higher power density, light weight, and reduced maintenance. In the meantime, problems such as loss of flexibility of field control and possible demagnetization also arise. In terms of cost, a comparison in [9] concluded that the cost of direct-drive EESG is higher than that of PMSG. Although the direct-drive PMSG solution is currently having less market share than the EESG, it is lately getting more attention and becomes an attractive solution for offshore applications.

1.2.2 High-power converters
Power converters for megawatt WECS are typically in the range of 0.5MW to 5MW. The existing systems normally employ 690V low-voltage (LV) converter technology, where the converters are rated at 0.5MW to 0.75MW each. Medium-voltage (MV) converters, as another group of competitive candidates for wind power applications, are operated in the voltage range of 2.3 ~ 13.8 kV. Their power ratings cover from several hundreds kilowatts to tens of megawatts.
1.2.2.1 Low-voltage two-level voltage source converter

To date, LV converters are still the dominant converter for WECS. The technology of twolevel six-device voltage source converter (VSC) is very well developed and widely accepted in low-voltage applications. A typical example of high-power LV converter used by Enercon E112 7

is illustrated in Fig. 1-5. The converter system is rated at 690V with 4.5MW power rating. The phase current reaches 3765A under rated condition. In E112, more than eight low-voltage converter modules are parallel connected to produce desired current and power.

Fig. 1-5 Enercon GmbH E112 using low-voltage converters.

The design presents a number of technical concerns [13]: 1) Reduced reliability due to possible circulating currents among paralleled converters. 2) High component count which is proportional to the wind turbine power rating. 3) Large current leads to challenges in cabling, low efficiency and increased cost. 4) Complex control and communication between modules. 5) Large current in the generator causes low efficiency.
1.2.2.2 Medium-voltage multilevel voltage source converter

An alternative solution to address the above issues associated with the LV converter is to use MV power converters. In the past few years, a movement towards the application of MV converters among wind power converter manufacturers can be noticed. Two leading companies producing high-power converters, ABB and Converteam (formerly Alstom), have both constructed MV wind turbines in the field for converter system testing [6][7]. Major wind

8

turbine manufacturers such as Vestas and Enercon are also actively involved in investigating and sourcing MV converters for large wind turbines. The benefit of the MV converter is manifested by a simple comparison between 4.16kV (North America standards) and 690V converters for a 4.5MW system. As shown in Table 1-1, the phase current in the MV converter is only 625A, which is much lower than that in the LV converter (3765A). Substantial power loss and cost pertaining to high-current cables are saved by the use of MV converter as a result.
Table 1-1 Comparison of a 4.5MW system using LV and MV converters

Converter Type

Low Voltage

Medium Voltage

Line Voltage (V)

690

4160

Phase Current (A)

3765

625

Generally speaking, MV converter is superior at high power levels whereas LV converter is more cost-effective at low power levels [14]. MV converters in the power range between 2MW and 6MW are more compact than LV converters. They offer competitive prices and involve fewer components, which is an inherent advantage in terms of reliability. The costs of cables and connections are also reduced. The upgrade of converter voltage level from LV to MV is accompanied with higher device voltage stresses. At MV level, either devices are connected in series to share the stress or multilevel converter topologies are used to clamp individual device voltage to a lower level. Fig. 1-6 shows the per-phase diagram of several typical MV VSC topologies [15]. The first topology in the figure is the conventional two-level VSC with series-connected devices for voltage sharing. When used in MV, this topology gives rise to very large dv/dt and common-mode voltage at the ac outputs, resulting in possibility to damage the devices and cause premature failure of the machine winding insulation. Switching actions of the series-connected devices have to be synchronized and proper measures of the gating circuits have to be taken in 9

order to ensure proper sharing of the voltage stress. Moreover, measures for dynamic voltage sharing among the devices add complexity and cost to the system.

Fig. 1-6 Per phase diagram of typical medium-voltage voltage source converter topologies [15].

The rest three in Fig. 1-6 are the most well known multilevel voltage source converter topologies, namely the diode clamped converter, cascaded H-bridge converter and flying capacitor converter. Multilevel VSCs in general comprise more devices to help produce ac voltage waveforms with multiple voltage steps. Compared to the two-level VSC, they share several common features such as higher quality ac voltage waveforms with lower dv/dt and THD, exemption from device series-connection and reduced common-mode voltage magnitude. Cascaded H-bridge converter is made up of multiple units of single-phase H-bridge power cells connected in series on their ac side. This topology is popular in MV drives for its ability to achieve very high output voltage and superior waveform quality. However, the topology requires a number of isolated dc supplies, each feeding one of the H-bridge cells. In a WECS, the dc supplies have to be obtained from specially designed generators with a large number of isolated coils [16] or costly zigzag transformers [17]. The high cost and complexity involved with these designs prevent the cascaded H-bridge converters from wide application in WECS. The flying capacitor converter is constructed by adding clamping dc capacitors to the twolevel VSC. Although it is also able to produce multilevel waveforms, the large number of dc

10

capacitors, complex control for capacitor voltage pre-charge and balancing make its feasibility very limited for WECS. Among all of the multilevel VSC topologies, the diode clamped converter is the only one currently being manufactured for large wind turbine systems. Fig. 1-7 illustrates a three-level back-to-back diode clamped converter in a practical medium-voltage WECS. Also referred as the neutral point clamped (NPC) converter, this topology is used by both ABB and Converteam. In the NPC converter, two series-connected capacitors in the dc-link create a neutral point reference in the circuit. Additional switching devices and diodes are employed to enable the output terminals to be connected to the dc neutral point and have its voltage potential. This results in smaller voltage steps and lower current ripple at the ac side. In addition, the clamping diodes guarantee the voltage sharing between the two blocking switches without the need for special voltage sharing circuits.

Fig. 1-7 ABB PCS 6000 using medium-voltage neutral point clamped converter [18].

The ac outputs of VSCs are chopped voltage waveforms with high dv/dt. Even though the NPC converter reduces the magnitude of voltage steps, a filter network composed of three-phase inductor and capacitor functioning as dv/dt filter is still indispensable. The dv/dt issue can be mitigated by applying diode clamped inverters with higher output levels. However, the significantly increased number of clamping diodes and devices make the system complicated and costly. The voltage sharing of devices in NPC converter relies on the balancing of the dc capacitor voltages. Difference in the dc capacitor voltages due to time-varying ac magnitudes, control and device switching actions may accumulate during operation and give rise to higher voltage stress

11

to some of the devices. Special control algorithms are therefore necessary to balance the capacitor voltages.
1.2.2.3 Other medium-voltage converter topologies

Besides multilevel VSCs, some other converter topologies were also proposed for large wind turbines in the literature. These works can be categorized into two groups: multilevel matrix converters and load commutated inverter (LCI) based CSC. A conventional matrix converter employs nine bidirectional switches to achieve direct ac to ac conversion. The basic idea for its operation is that, by properly switching the devices to connect the output terminals to the input terminals, desired input/output voltage and current waveforms with variable frequency can be synthesized. The converter can perform fast dynamic control since no dc energy storage component is employed. But its fault ride-through capability is limited due to the same reason. The operations of the two ac sides are directly coupled which degrades the system performance. In recent literature, several multilevel matrix topologies were proposed for high-power medium-voltage WECS. The methods to generate multilevel output voltage are more or less similar to replacing its input-output branches with the phase legs of the diode clamped converter [19], cascaded H-bridge converter [20] [21] and flying capacitor converter [22]. The "multilevel" ideas, when combined with the matrix converter concept, generally result in a great number of power semiconductor devices and complicated control. The same capacitor balancing issue as in some of the multilevel voltage source converters also exists in these converters. Generally speaking, the practicability of matrix converters for high-power applications is still limited. The other group of topologies is LCI based converter employing SCR thyristors as switching devices. The thyristors does not have self turn-off capability, but can be naturally commutated by the load voltage with a leading power factor. The LCI features low manufacturing cost and high efficiency mainly due to the use of low-cost SCR devices and lack of PWM operation. It is a popular solution for very large drives, where the initial investment and operating efficiency are of great importance. However, LCI itself is not a grid-friendly topology. It normally generates high-amplitude low-frequency current harmonics to the grid and the output power factor is not controllable. In view of this, active filters or compensators of high power ratings are unavoidable for the LCI to improve the grid connection performance. 12

1.2.3 Grid fault ride-through
Existing grid connection codes require fault ride-through (FRT) capabilities for wind turbines. Three-phase short-circuit faults are considered as the most challenging case among all. In most of the existing WECSs, the ability to ride through the grid faults is not possible without control or hardware modifications. The fault ride-through (FRT) requirement, also named low-voltage ride-through (LVRT) requirement, imposes great challenges to wind turbine/converter manufacturers and designers. Recently, considerable research works have been carried out to address this issue [23-26]. Besides the requirement of WECS to remain operational during fault, a large amount of reactive current from the WECS to support grid voltage recovery is also demanded. The DFIG configuration is hitherto the dominant technology in the present wind market. However, its real power control and reactive current compensation capability during voltage sags or faults is very limited due to the fractional-rating power converters and partial coupling with the grid. In a DFIG configuration, grid short-circuit faults can result in a current increase in the stator windings. Because of the magnetic coupling between the stator and rotor, high voltages or currents would be induced in the rotor circuit. The high current may destroy the converter if no protection measures are taken. A significant amount of research has been focusing on how to help the DFIG system to ride through grid faults. In general, control improvement alone won't solve the problem. Additional hardwares [27-30] such as crowbar and energy storage systems have to be used during fault. Other than that, increased converter capacity or external VAR compensation unit for reactive current supply is also compulsory. On the contrary, direct-drive PMSG configuration employing full-rating power converters completely decouples the generator from the grid, providing wide operating range and improved capability of fault ride-through [14, 31]. Despite its favorable flexibility, control improvement is still necessary in such systems to properly manipulate the behavior of the converter and generator during and after fault. In a VSC based direct-drive WECS, when low-voltage grid fault occurs, the active power output to the grid may be interrupted while the generator is still dumping power to the converter. The lack of power output will cause the dc capacitors to be overcharged, leading to over-voltage in the dc link of the converter. Two methods were proposed to prevent the dc-link over-voltage in such situations: the first one dumps the excessive energy to 13

external resistors or energy storage systems [32, 33], whereas the second method is to allow the incoming wind energy to be temporarily stored in the moment of inertia of the turbine-generator system. Commercial products like ENERCON E112 using LV VSC, ABB PCS6000 using MV VSC [18] are all equipped with additional energy dissipating units in the dc link to limit its voltage magnitude.

1.3 Dissertation objectives
1.3.1 Proposed configuration
The initiative of this work is to study and develop a promising high-power medium- voltage WECS not only in accordance with market trends but also practical for future industrial production. As mentioned in the review, wind turbine ratings are increasing to the range of 1.5MW to 5MW; large wind turbines and wind farms are now required to follow grid connection codes for power quality and system stability concerns. Taking these into account, the configuration using direct-drive PMSG and full-rating power converter emerges as an attractive solution for future implementation of large grid-connected wind turbines. As for converter type, MV converters fit right in the voltage and power ranges of large wind turbines and are getting significant attention from major manufacturers. Potential increasing demands for MV wind power converters are expected in the near future.

S1
A

S3

S5 iwi vci is vs

vdc
idc

B

C

Li Ci

S4

S6

S2

Fig. 1-8 PWM current source converter connected to the grid.

Rather than focusing on well developed VSC, this dissertation proposes the use of PWM current source converter (CSC) for wind power conversion in a PMSG-WECS configuration. The power circuit of a grid-connected PWM CSC is plotted in Fig. 1-8. The converter is fed by a 14

dc current source, which is normally obtained by employing a large dc-link inductor. The six devices can be actively turned on and off by the applied gating signals, providing chopped current waveforms at its ac terminals. A three-phase capacitor Ci is required to assist the commutation of the switching devices. PWM CSC not only contributes to the variety of MV converter topologies for wind applications but also possesses its own merits and specialties which are detailed as following.
1) Simple converter topology.

State-of-the-art PWM CSC drives available in the market use symmetrical gate commutated thyristor (SGCT) devices. The output voltage can reach up to 6.6kV by simply connecting the devices in series. Hence, the topology retains its simplicity with low device count even at high voltages. This is a favorable feature for large WECSs aiming at higher voltage levels.
2) Grid friendly waveforms.

The PWM CSC outputs chopped current waveforms which are filtered by ac capacitors, therefore, its ac waveforms are close to sinusoidal with low harmonics. It inherently avoids the high dv/dt and wave reflection issues in PWM VSC and can be used in applications requiring long cables. This feature offers the flexibility to locate the converters in the wind towers, either in the nacelle or at the bottom of the tower.
3) Reliable grid short-circuit protection.

Another advantage of CSC-based WECS lies in its short-circuit or over-current protection capability. The current changing rate during a grid short-circuit fault is limited by the dc-link inductor. VSC, under this circumstance, will produce a large amount of short-circuit current because of the high voltage on dc-link capacitor and very little inductances in between the converter and the grid. As a result, CSC provides superior advantage over the VSC for grid lowvoltage ride-through as requested by most of the newest grid connection codes.
4) Limited device switching frequency.

In the most modern high-power PWM CSC, the device switching frequency is limited to around 420Hz for minimizing power losses and device thermal stress. Selective harmonic elimination (SHE) is the dominant modulation scheme for eliminating low-order harmonics 15

associated with the low switching frequency. Nevertheless, this modulation scheme provides limited flexibility for control system design.
5) Limited dynamic performance.

The main drawback of CSC consists in its limited dynamic performance by reasons of: 1) the use of a large dc-link inductor and 2) the modulation scheme with limited switching frequency and less flexibility. The dynamic performance can be improved with advancements in device characteristics and optimized modulation schemes.
6) Possible LC resonances.

Another problem of CSC based WECS is the grid-side power factor and possible resonances caused by the ac capacitors. This effect can be mitigated by active damping and power factor control schemes proposed in [23-27]. The capacitors may, however, help to reduce the size of additional VAR compensation apparatus when the grid requires large reactive power to assist voltage recovery during sags.

1.3.2 Objectives
On the market of electric motor drives, PWM CSC based products are widely used in the high-power medium-voltage range. However, no research work or commercial product addresses its applications in WECS prior to this work. Although the current available PWM CSC drives can also work in the power regenerative mode, they are not intentionally designed for generation mode operation. It is therefore important to understand the differences between the two applications and focus on the special issues related to PWM CSC based WECS. The main objectives of this dissertation are summarized as follows.
1) CSC converter topology investigation.

A complete converter system for generation application includes grid-side and generator-side converters. The PWM CSC based drive available in the market employs PWM current source inverter (CSI) as the machine-side converter, and offers two options for the line-side converter: multi-pulse rectifier using SCR thyristors and PWM current source rectifier (CSR). For generation application, the energy flow direction is opposite to that in drives. This work proposes

16

PWM CSI as the grid-side converter in order to satisfy the stringent grid code requirements. On the generator side, diode rectifier, SCR thyristor and PWM CSR are all potential candidates. The first objective of this work is thereby to investigate and analyze possible CSC topologies (including both generator- and grid-side converters) and identify a suitable topology for large WECSs.
2) CSC PWM scheme selection.

As mentioned above, the device switching frequency of high-power CSC is constrained to a few hundred Hertz for reducing switching loss and device thermal stress. The low switching frequency greatly influences the choice of CSC modulation schemes in practice. Space vector modulation (SVM) has more flexibility for converter control but is not widely used in commercial products, mainly because of its high magnitudes of low-order harmonics at low switching frequency. Selective harmonic elimination (SHE) can eliminate the low-order harmonics but the control flexibility of the modulation scheme is limited. The second objective of the work, therefore, is to explore an existing or new modulation scheme that is appropriate for the proposed converter system configuration. Several aspects need to be considered: harmonic profile, switching frequency, and flexibility for converter control.
3) System modeling and control.

According to the literature survey, little research work has been carried out on CSC based permanent magnet synchronous machine (PMSM) drives. It is necessary to establish accurate models for studying the steady-state and transient performances of the system. The CSC-PMSGWECS is a non-linear high-order system due to the presence of ac filter capacitors, machine/line inductances and dc-link inductance. Effect of possible LC resonances to the control system design and system stability should be evaluated. The main control tasks in a CSC-PMSG-WECS include the generator speed control, dc-link current control and grid power factor (PF) control. The first two are common in both drive and generation systems. However, the grid PF control capability of commercial MV CSC drives is somewhat limited due to the loss of control freedoms as the result of using SHE. In order to achieve flexible PF control in CSC-PMSG-WECS, additional control freedom from the converter or system variables need to be employed. 17

The third objective can be divided into the following goals: (a) development of a dynamic model for the whole system; (b) evaluation of the steady-state operating condition; (c) derivation of a small-signal model for controller design; (d) use of system transfer functions to select control method, design control loops and validate system stability; (e) verification of the controller design in simulations and experiments.
4) Grid integration of CSC-PMSG-WECS.

Compliance with grid connection code requirements and state-of-the-art technologies for low-voltage ride-through are to be developed. Previous works on control improvement have been entirely in the field of VSC based WECS. The LVRT of CSC-PMSG-WECS requires the development of novel methods since it is new to CSC based systems and is specially associated with wind power generation application. Therefore, the last objective of the dissertation is to develop a new control scheme to address the LVRT issue, and thus enable the CSC-PMSG-WECS with full grid connection code compatibility.

1.4 Dissertation outline
This dissertation consists of seven chapters which are organized as follows. A diagram summarizing the main contents is provided in Fig. 1-9.

Fig. 1-9 Dissertation organization.

Chapter 1 presents the background and introduction of the study. Chapter 2 investigates various current source converter topologies for wind power generation application. Several major aspects such as feasibility, cost, ratings and performance are reviewed. 18

The comparison of these topologies helps in the choice of a suitable and competitive solution for high-power medium-voltage WECS. Chapter 3 develops a suitable modulation scheme for the selected converter topology. Various modulation schemes for CSCs are studied. Benefits and drawbacks associated with each modulation scheme are discussed. The selected modulation scheme together with the converter topology lays the foundation for system analysis and controller design. Chapter 4 carries out the development of system models for CSC-PMSG-WECS. Several models, including a nonlinear dynamic model, a steady-state model and a small-signal model are established. The steady-state operating point of the system is calculated. The dynamic performance derived from theoretical analysis is compared with simulation verification. Chapter 5 focuses on the design of the control system. The control system includes several feedback control loops such as the dc-link current loop, the grid reactive current loop and the generator speed loop. Critical conditions for the controllers are identified. Various controller design techniques are employed to cope with the characteristics of the individual loops. Simulations and experiments are conducted to demonstrate the system control performance. Chapter 6 investigates the major aspects for grid integration of a CSC-PMSG-WECS. A novel control scheme is developed for the CSC-PMSG-WECS to ride through grid low-voltage faults. Details of the proposed control structure are elaborated and supported by both simulation and experimental results. Chapter 7 summarizes the main contributions and conclusions of the dissertation. Possible future research works are also suggested.

19

Chapter 2 Current Source Converter Topologies for PMSG-WECS
A variable-speed wind energy conversion system (WECS) is basically an electric drive system working in the regenerative mode. In Fig. 2-1 where a typical full-rating power converter based WECS is shown, the real power flows from the generator to the grid via the power electronic converter. The source voltage of the system is the generator terminal voltage which varies with the rotor speed and magnetic flux; under variable-speed operation, it may take any value from low voltage (usually half of the rated value) to the rated voltage of the machine. The output of the system is connected to high-voltage grid via a step-up transformer. Therefore, the load voltage is fixed by the grid and its magnitude is normally higher than that of the generator voltage. This situation is opposite to drive systems in which the source voltage is normally higher than the load voltage.

Fig. 2-1 Simplified structure of full-rating power converter based wind energy conversion system.

Both voltage source converters (VSCs) and current source converters (CSCs) can be used in a WECS. Although the present market is dominated by VSC technologies, CSCs do have their distinctive advantages and are likely to be strong candidates for future implementations. A CSC 20

requires a dc-link inductor to provide a smooth dc current for operation. The grid-side converter in a CSC is a current source inverter (CSI) which converts the dc-link current to three-phase ac currents that can be accepted by the grid. Contrary to voltage source inverters (VSI) which are voltage-buck converters, CSIs are essentially voltage-boost converters. Theoretically, they are well suited for full-rating power converter based WECS where the source voltage is lower than the load voltage. The voltage-boost feature offers the CSIs more flexibility to be combined with different types of generator-side converters and the resultant configurations may provide wider operating range for the system than the VSI based converters do. In this sense, CSCs are attractive potential solutions and should have a place in the variety of converter topologies for large WECSs. Several CSC topologies can be used in the WECS. The grid-side converter can be chosen between a PWM CSI and a phase-controlled thyristor converter; whereas for the generator-side, diode rectifier, thyristor rectifier and PWM current source rectifier (CSR) are possible choices. The selection of the converter topology relies on the system requirements and overall performance. This chapter is dedicated to discussing and comparing these possible solutions. Based on the feature study and comparison result, one suitable topology will be selected for detailed analysis throughout the rest of this dissertation.

2.1 Grid-side converter topologies
The major functions of the grid-side converter include regulating the output of active and reactive power to the grid and conforming to the grid connection codes. As mentioned in the first chapter, the newest grid codes impose more critical requirements on grid-connected WECS due to the fact of the increasing wind power penetration. The main terms of the codes consist in the following aspects: harmonic limitation of grid current or voltage waveforms, grid-side power factor, grid voltage and frequency regulation and grid fault ride-through capability. In order to satisfy all these requirements, a PWM CSI is a good choice for the grid-side converter, as it provides high control flexibility, generates low harmonic contents and is able to adjust the power factor. Some previous research also proposed the use of thyristor based load commutated inverter (LCI) in the WECS to interface the grid. Although LCI is lower in cost than the PWM CSI, its harmonic profile and power factor are inferior and therefore, adding passive or

21

active filters at the grid side becomes a must. A diode rectifier cannot be used at the grid side because it offers only unidirectional power flow from ac to dc.

2.1.1 Thyristor converter
Thyristor converter is widely employed as rectifiers in CSI based drives to provide an adjustable dc current. A thyristor converter can work in either rectifying or inverting mode. The bidirectional power flow capability allows it to be used as the grid-side converter in wind power generation applications [34-36].

T1

T3

T5 iwi vwi is vs

A
vdc idc T4 T6

B

C
T2

Li

Fig. 2-2 Three-phase thyristor converter connected to the grid.

Fig. 2-2 shows the simplified circuit diagram of a grid-connected thyristor converter fed by a dc current source. When forward-biased, the thyristor devices can be turned on by injecting positive current pulses to the gate terminal. The turn-off process requires a negative anode current and cannot be actively controlled from the gate. For this reason, the thyristor converter is normally operated with the principle of phase control, which only offers one control freedom of the delay angle  i . Also due to phase control the ac side power factor is always lagging. Since each device in the converter is only switched once per fundamental cycle, the ac current waveforms at the grid side are highly distorted. In [34-36] where thyristor converters are used in a WECS, passive or active filters are necessary to improve the grid-side power quality, adding cost and complexity to the system. The power factor (PF) of a single thyristor converter is given in (2-1). The displacement power factor (DPF) is closely related to the delay angle  i and the conduction angle i . The

22

DPF becomes worse under no load or light load conditions, where delay angle  i is close to 90º. The distortion factor (DF) is dependant on the THD of the line current waveform.
PF = DPF × DF = cos ( i + i 2 ) × 1 1 + THD 2 (2-1)

Power factor compensation (PFC) is strictly requested by the grid codes for large WECSs. For the thyristor converter, active filters may be employed to compensate the power factor and harmonics. However, the current rating of an active filter for thyristor converter PFC can reach up to 40% that of the whole system [34]. The additional cost and complexity involved obviously nullifies the low-cost advantage of the converter itself. The topology presented in [35] makes use of an extra control freedom from a dual thyristor converter. By applying opposite delay angles to the two constituent converters, reactive current components generated by each converter can be cancelled out. This configuration requires additional force commutation circuits for one of the converters since it is not operated in the line commutated mode.

2.1.2 PWM CSI
The simplified circuit diagram of a PWM CSI is shown in Fig. 2-3. The converter is composed of six reverse-blocking power devices and is fed by a dc current source. The devices can be turned on and off by the applied gating signals. The PWM CSI requires a three-phase capacitor Ci at its ac output to assist current commutation among the phases. Otherwise, a high voltage spike would be induced by the energy trapped in the line inductors, causing damage to the switching devices. This topology has several prominent features such as simple circuit structure, well defined output current waveforms, smoothed voltage waveforms, controllable power factor and reliable short-circuit protection [15]. The steady-state grid-side and dc-link voltages and currents can be related by, I wi = mi I dc Vdc = mV i ci cos  i (2-2) (2-3)

where I wi , Vci are the steady-state magnitudes of the three-phase components iwi , vci , respectively; I dc , Vdc are the steady-state average values of the dc components idc , vdc , respectively;

23

mi ,  i are the converter modulation index and delay angle, respectively.

S1 A
vdc idc S4

S3

S5 iwi vci is vs

B
S6

C

Li Ci

S2

Fig. 2-3 PWM current source inverter connected to the grid.

The switching devices employed in the PWM CSI offer two freedoms, namely mi and  i , for converter control. Both mi and the absolute value of cos  i are typically in the range of [ 0, 1] , so the magnitude of the ac current I wi is equal to or less than that of the dc-link current I dc . Conversely, the average dc-link voltage Vdc will not be higher than the magnitude of the ac voltage Vci . In order to maintain proper operation at the grid side, the dc-link current always needs to be controlled above a minimum required level determined by the active and reactive power control objectives.

2.2 Generator-side converter topologies
The generator-side converter functions as a rectifier to convert the generator ac voltage to dclink voltage or current. Available options for the generator-side converter in a CSI based WECS include: diode rectifier, thyristor rectifier and PWM CSR. Due to the same reason of poor PF and high THD as mentioned in Section 2.1.1, thyristor rectifier is not considered here.

2.2.1 Diode rectifier
Three-phase diode rectifier provides a low-cost solution to convert ac power into dc. A simplified circuit diagram of a diode rectifier interfacing the generator is shown in Fig. 2-4. The permanent magnet synchronous generator (PMSG) is assumed to have a surface mounted magnet, and thus the dq-axis synchronous inductances are the same. The PMSG is simplified as a voltage 24

source eg with a finite source inductance Lg , which represent the back-EMF and the synchronous inductance, respectively. The load at the dc link can be considered as a voltage source or a current source.

eg

Lg

vg

ig

a

b

c

vdc idc

Fig. 2-4 Three-phase diode rectifier connected to a PMSG.

Without taking Lg into consideration, the theoretical power factor at the input of the diode rectifier is 0.955 [37]. Due to the presence of a large input line inductance, the current commutations in the rectifier are not instantaneous and will cause voltage drops at the dc output. The commutation angle as well as the resultant voltage drop depends on the machine inductance Lg and the dc-link current I dc . If the commutation angle is less than 60º of the input fundamental frequency, the voltage loss caused by commutation happens six times per fundamental cycle and the average dc output voltage can be calculated as, Vdc = 3 2 Eg , LL - 3





g Lg I dc

(2-4)

where Eg , LL is the magnitude of the line-to-line back-EMF eg . The commutation angle  can be expressed as, cos  = 1 - 2 g Lg I dc Eg , LL (0    60 ) (2-5)

It can be observed from the equations that the longer time the commutation takes, the more voltage drop the dc output will suffer.

25

If the commutation angle increases and exceeds 60º, the decrease of the dc voltage will be more rapid until it drops to zero. Rectifier input power factor will decrease as well and the generator stator winding current will increase substantially. This mode of operation is unreasonable and should be avoided. The primary objective for the generator-side control is to obtain the maximum power input from varying wind speed. This task can be achieved by adjusting the generator speed to the optimum value. Since the diode rectifier does not offer any control freedom, the generator-side performance can only be adjusted by varying the dc-link current or voltage. In the following part, the solution to the steady-state dc-link current magnitude for maximum power point tracking (MPPT) is provided.
 g ,opt , Teg ,opt , Pg ,opt ( pu )
1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8
vw ( pu )
3 Pg , opt  vw

Pitch angle  = 0o

 g ,opt  vw

2 Teg , opt  vw

Fig. 2-5 Optimum generator operating speed, torque and power versus wind speed.

According to the wind turbine characteristics, the maximum power input from a particular wind speed vw can only be achieved with a corresponding generator speed g ,opt . In a typical wind turbine system, the relations of the wind speed to the optimum generator speed, electrical torque and power can be expressed in (2-6). The curves illustrating these relations in per unit (pu) values are shown in Fig. 2-5. 26

 g , opt  vw   2 Teg , opt  vw  3   Pg , opt  vw

(2-6)

Assume the maximum power is obtained and the losses in the generator and diode rectifier are negligible, the dc-link power Pdc equals to the generated electrical power.
Pdc = Vdc I dc = Pg ,opt

(2-7)

Substituting (2-4) into (2-7), we have

3 2  3    Eg , LL -   g ,opt Lg I dc   I dc - Pg ,opt = 0   The dc-link current can be calculated by solving the above equation,
I dc = -k1 ± k2 k1  k2 = 2 k3 -2k3

(2-8)

(2-9)

where
k1 = 3 2 Eg , LL > 0
2



3 2  12 k2 =  E  , g LL    -  g ,opt Lg Pg ,opt   3 k3 =  g ,opt Lg > 0

(2-10)



In (2-10), the value of k2 depends on the system parameters. If k2 < 0 , I dc does not have a real solution, which means the maximum power point cannot be achieved. Therefore, in order to achieve MPPT in such a system, a parameter constraint for the synchronous generator needs to be satisfied,
2 Eg , LL 

2  g ,opt Pg ,opt Lg 3

(2-11)

Equation (2-11) implies that, for given operating speed and power, a minimum required value exists for the back-EMF of the PMSG, which depends on the value of the synchronous
27

inductance. For generators having larger synchronous inductances, the excitation of the generator also needs to be larger to ensure proper power output. Assume k2 > 0 , we have k2 = k12 - 12 g Lg Pg ,opt  < k1 . Therefore, both solutions in (2-9) are positive, while I dc1 = k1 - k2

(

)

( 2 k3 )

is less than I dc 2 = k1 + k2

(

)

( 2 k3 ) .

The values of

I dc1 and I dc 2 vary with the system parameters. In a real system, I dc1 is normally in the range of 0~1.5pu whereas I dc 2 can be much higher than 2pu. This high value of I dc 2 leads to an unreasonable dc-link current that does not satisfy its prerequisite given in equation (2-5), as shown in Fig. 2-6. Therefore, only I dc1 is the solution for the circuit.
I dc1 , I dc 2 ( pu )

Calculated I dc 2

Calculated I dc1

Simulated I dc

vw ( pu )

Fig. 2-6 Calculated dc-link current for a diode rectifier connected to a PMSG.

A simulation is carried out in Matlab/Simulink to verify the above calculations. The model includes a wind turbine model, a PMSG and a full-bridge diode rectifier connected to a current source. The parameters of the PMSG for simulation are listed in Appendix A. In the simulation, the generator speed regulator receives the reference speed given by the wind turbine model and outputs a reference for the dc-link current. The steady-state dc-link currents at different wind

28

speeds in simulation are also marked in Fig. 2-6 with checks. The simulated and the calculated values are consistent. To sum up, diode rectifier can be employed as the generator-side converter in a WECS, provided that the synchronous inductance of the PMSG is within a reasonable range such that the dc-link current can be controlled at a desired value, making the generator working at the optimum point.

2.2.2 PWM CSR
Unlike diode rectifier or thyristor rectifier, PWM CSR employs fully controllable active switching devices to perform the rectification. As shown in Fig. 2-7, a PWM CSR is no different from a PWM CSI except that the power flow direction in the CSR is from ac to dc. The active switching devices bring additional cost to the system but offer much higher control flexibilities over the diodes or thyristors. Under PWM scheme, the phase angle and magnitude of the ac current can be arbitrarily adjusted by the rectifier to realize various control objectives in the generator.

S4

S6
a

S2

eg

Lg

ig

vg

iwr
b
c

vdcr
idc

icr

Cr

S1

S3

S5

Fig. 2-7 PWM current source rectifier connected to a PMSG.

The phasor equations in steady state at the generator terminals are given as below,
Eg = Vg + j g Lg I g

(2-12) (2-13) (2-14)

I cr = j g CrVcr I g = I cr + I wr

29

The phasor diagrams of the generator variables are illustrated in Fig. 2-8 for four different control methods. In all these cases, the generator flux is assumed to be the same and its direction is set as the d-axis of the synchronous frame. The induced back-EMF leads the flux by 90º and therefore lies on the q-axis. All the cases have the same amount of q-axis current I gq that is corresponding to the maximum power point. The dq-axis inductances are assumed identical; hence the d-axis current I gd will not affect the generator flux or torque. The power factor at the generator terminals can be any value from lagging to leading as I gd is adjusted from positive to negative. Accordingly, the generator terminal voltage can be lower, equal or higher than its backEMF.
I gq I gd Ig Vg I gq

Eg

q -axis

Eg Ig Vg

j g Lg I g

I gd

q-axis j g Lg I g

f
d -axis

f
d -axis

(a)
I gq = I g
I gd

(b)
Ig I gq

Eg

I gd = 0

q-axis j g Lg I g

Eg

q-axis j g Lg I g
Vg

f
d -axis
(c)

Vg

f
d -axis
(d)

Fig. 2-8 Phasor diagrams of the generator variables using different generator d-axis current.

Once the generator voltage and current are defined, it is easy to derive the converter current according to (2-13) and (2-14). The corresponding phasor diagrams are shown in Fig. 2-9. The four cases illustrated above impose different steady-state rating requirements on the generator and the converter. The voltage ratings of both are determined by the larger magnitude between the generator back-EMF and the terminal voltage. The current ratings of the generator and the converter are dictated by the respective magnitudes of their steady-state currents. The generator terminal voltage, generator current and converter dc-link current in cases (a), (b) and (c) 30

are summarized in Fig. 2-10. The calculation is based on the simulation system parameters in Appendix A.
I cr Ig

Eg

I cr
q-axis
Ig

Eg

q-axis

f
d -axis

I wr

Vg
(a)

f
d -axis

I wr Vg

(b)
I cr Eg Ig I wr Eg

I cr

Ig
I wr

q-axis

q-axis

f
d -axis

f
Vg

Vg

(c)

d -axis

(d)

Fig. 2-9 Phasor diagrams of the converter current using different generator d-axis current.

Among all, case (a) gives the maximum generator terminal power factor. The terminal voltage under this condition is less than the generator back-EMF. Since no-load or light-load condition may occur at rated rotor speed, the voltage ratings of the generator armature windings and the rectifier should still be designed according to the magnitude of the no-load back-EMF. On the other hand, the fact that d-axis currents of the generator and the capacitor are of opposite directions results in a large converter current I wr . Consequently, the required KVA rating for the rectifier converter is high. This case is quite similar to the use of a diode rectifier which also leads to unity displacement factor at the generator terminals. The terminal voltage in case (b) is controlled to be equal to the generator back-EMF. Under this condition, the generator and rectifier voltage ratings are the same as case (a) but lower than the other cases. The required current ratings are lower than case (a). Nevertheless, the control of the rectifier to approach cases (a) and (b) are relatively complex since the d-axis current reference changes with the generator operating conditions.

31

Case (c) happens when the generator d-axis current I gd is controlled to be zero. In this case, the terminal voltage would be higher than the back-EMF and will determine the voltage ratings of the generator and the converter. Because the d-axis current is zero, the back-EMF and the armature current are in phase, the generator current is minimized and is equal to the torque producing current on the q-axis. As a result, the generated power is maximized. This design saves permanent magnet material.
Vg ( pu )

1 0.8 0.6 0.4 0.2 0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8
I g ( pu )

c b a

vw ( pu )
a b c

1 0.8 0.6 0.4 0.2 0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8
I dc _ gen _ min ( pu )

vw ( pu )
a b c

1 0.8 0.6 0.4 0.2 0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8
vw ( pu )

Fig. 2-10 Steady-state voltage and current values using different generator d-axis current.

In case (d), the generator produces positive d-axis current which counterbalances most of the reactive current produced by the capacitors. For this reason, it requires the least rectifier current among all the cases. However, the decrease in current rating requirement is not obtained without a cost. The generator terminal voltage in this case becomes much higher than the back-EMF, which significantly raises the voltage ratings and thereby the overall system cost. This drawback renders the working mode almost useless. 32

In general, the use of active switches on the generator-side converter enables various options for generator control. Among them, the control in case (c) is the simplest for practical implementation. The resultant generator/converter currents are minimized, and so does the generator winding loss. Therefore, case (c) is commonly used in normal operating conditions. However, other control methods as described in cases (a), (b) and (d) can be incorporated for specific conditions where magnetic flux or generator/converter voltage is limited.

2.3 Diode rectifier with PWM CSI
Based on the above evaluations for individual converter topologies at both sides of the system, a few possible combinations emerge for realizing a CSC based WECS. Starting from this section, several feasible topologies will be discussed. Their overall performance in a WECS will be analyzed. This section investigates a topology utilizing a diode rectifier as the generator-side converter and a PWM CSI as the grid-side converter. The two converters are linked by a dc inductor, as shown in Fig. 2-11. The topology has a simple structure and features relatively low cost.

idc

Ldc

S1

S3

S5 iwi vci

v g ig
a

b

A
c
S4

B
S6

C S2 Ci

Fig. 2-11 A wind energy conversion system using diode rectifier and PWM CSI.

2.3.1 System operating range
To understand the feasibility of this topology, it is necessary to evaluate the dc-link current commonly shared by the grid-side and generator-side converters. Previous study reveals that the dc-link current has to be the one and only value corresponding to the maximum power point to ensure MPPT operation of the generator; in the meantime, it needs to be above a minimum value to satisfy active and reactive power control requirements on the grid side. Therefore, if all the

33

control objectives on both sides are to be achieved simultaneously, the generator-side dc-link current determined by the MPPT should always be higher than the minimum level required by the grid-side converter. Fig. 2-12 provides the dc-link current requirements from both sides with respect to the wind speed, under the assumption that the maximum power is delivered to the grid. The grid-side PWM CSI has a large ac capacitor, which absorbs considerable amount of leading current. The leading current needs to be compensated by the converter if unity power factor (UPF) is required at the grid connection point. The minimum grid-side dc-link current requirements for UPF operation are shown as dashed lines in Fig. 2-12, where the capacitance is valued at 0.35pu and 0.5pu, respectively. In the low wind speed range (0~0.5pu), the real power extracted from the turbine is relatively low and the dc-link current is mainly determined by the reactive current in the capacitors, resulting in almost constant values. As the wind speed goes up, the grid-side dclink current requirements rise as well as the active current increases. Another dashed line in Fig. 2-12 indicates the case where only the grid real power is controlled. The minimum dc-link current changes from zero to rated current as the wind speed increases from zero to rated value.
I dc ( pu )
I dc _ gen ( f = 0.6 pu ) I dc _ gen ( f = 0.8 pu )

I dc _ gen ( f = 1.0 pu )

I dc _ grid _ min ( Ci = 0.5 pu , UPF )
I dc _ grid _ min ( Ci = 0.35 pu , UPF )

I dc _ grid _ min ( real power output )

I dc _ gen ( f = 1.2 pu )
I dc _ gen ( f = 1.4 pu )
vw ( pu )

Fig. 2-12 dc-link current requirements for the configuration of PWM CSI with diode rectifier.

34

The other five curves in solid lines illustrate the operating dc-link current for MPPT at the generator side. The curves are given under different magnetic flux, ranging from 0.6pu to 1.4pu. It's reasonable that when the generator terminal voltage drops as the magnetic flux reduces, the dc-link current are increased accordingly in order to obtain the same amount of power in the dclink. Taking the case of 1.0pu magnetic flux and 0.35pu output capacitor as an example, the system can only ensure desired operation in the wind speed range from 0.7pu to 1pu where I dc _ gen > I dc _ grid _ min . If the wind speed is lower than 0.7pu, the generator-side dc-link current drops below the minimum requirement from the grid side. Although MPPT operation is still achievable, the grid-side power factor can no longer be maintained at unity. To retrieve the UPF control capability in the range of half to full wind speed, the magnetic flux has to be reduced to around 0.6pu. However, this brings another drawback as the dc-link current at rated wind speed is substantially increased, from 1.07pu at  f = 1.0 pu to way above 1.5pu at  f = 0.6 pu . In this case, the current ratings of the generator and converters have to be oversized. Simulation of the proposed diode rectifier with PWM CSI topology for wind applications is carried out on a 1.56MW/3000V/300A system. The generator parameters are the same as stated in Appendix A. Fig. 2-13 shows the simulation results under three different wind speeds (1pu, 0.5pu, and 0.8pu). The generator flux in simulation is 1pu. The generator speed curves demonstrate that the optimum speed reference is well tracked by the real value, meaning that MPPT is obtained under all three conditions. The converter dc-link current varies with the wind speed in order to achieve MPPT at the generator side. Grid-side active and reactive powers are also shown in the last subfigure. Rated active power and UPF are achieved at rated wind speed. As the wind speed drops to half of the rated value, the power extracted from the turbine is substantially reduced. In the meantime, due to the limited dc-link current at this speed, grid-side converter is not able to maintain the reactive power at zero. As a result, the reactive power rises slightly. The reactive power is again controlled to zero when the wind speed steps up to 0.8pu.

2.3.2 Comparision with PWM VSI topology
As shown in Fig. 2-14, replacing the PWM CSI with a PWM VSI, we can derive the voltage source version of a WECS with a diode rectifier front-end. 35

vw ( pu )

1.5 1 0.5 0 1 1.5 2 2.5 3 3.5 Time (s)

 g ( pu )
1.5 1 0.5 0 1
idc ( A)
* g

g

1.5

2

2.5

3

3.5 Time (s)

600 400 200 0 1
6

1.5

2
6

2.5

3

3.5 Time (s)

Po (×10 MW ), Qo (×10 VA)
2 1 0 -1 1 1.5 2 2.5 3 3.5 Time (s)

Fig. 2-13 Simulated waveforms of a WECS using diode rectifier with PWM CSI.

idc

S1

S3

S5 is vs

v g ig

a

b

A
c

Cdc

vdc
S4

B
S6

C
S2

Fig. 2-14 A wind energy conversion system using diode rectifier and PWM VSI.

Similar system operating range for the VSI based WECS can be derived in Fig. 2-15. The PWM VSI is a voltage-buck converter and the magnitude of its dc-link voltage has to be higher 36

than that of the ac grid voltage. The requirement of the minimum dc-link voltage for grid-side converter operation is given in (2-15), where Vb is the base value of the system and equals to the magnitude of the grid phase voltage. The equation is derived based on the conventional carrier based sinusoidal PWM scheme without any over-modulation strategy. If this requirement is not satisfied, both real power and reactive power cannot be properly controlled at the grid side. Vdc _ grid _ min = 2Vb
Vdc ( pu )

(2-15)

5 4.5 4 3.5 3 2.5 2 1.5 1 0.5 0 0 0.1 0.2
Vdc _ grid _ min

Vdc _ gen ( f = 5 pu )
Vdc _ gen ( f = 4 pu ) Vdc _ gen ( f = 3 pu )

Vdc _ gen ( f = 2 pu )

Vdc _ gen ( f = 1 pu )

0.3

0.4

0.5

0.6

0.7

0.8

vw ( pu )

Fig. 2-15 dc-link voltage requirements for the configuration of VSC with diode rectifier.

The dc-link voltages for the generator side MPPT control at various generator magnetic flux levels are also plotted in Fig. 2-15. The flux of the generator has to be at least 2.5 times that of the rated value for achieving proper operation from half to rated wind speed. The resultant dc voltage at rated wind speed is twice the minimum required level from the grid side. The voltage ratings of generator, diode rectifier and grid-side PWM VSI have to be multiplied by a factor of 2 to 3, which is not desirable for a high-power medium-voltage system. Using flux adjustment method may enlarge the operating range. However, the generator rotor flux has to be raised to a level much higher than the rated value to ensure operation in the low wind speed region, leading to increased magnetic cost of the machine. Generally speaking, the diode rectifier with PWM 37

VSI topology is not suitable for high-power large WECS which is very sensitive to ratings and costs. The above discussions provide comparison of a diode rectifier with a PWM CSI or a PWM VSI in the WECS. The voltage-boost characteristic of CSI is naturally in accordance with the wind energy system where the source voltage is lower than the load voltage, thus offers wider operating ranges. On the contrary, the voltage-buck characteristic of the VSI necessitates the increase of the source voltage or additional voltage-boost stage for the system to operate properly.

2.4 Diode rectifier and PWM CSI with a current boost stage
An intermediate dc/dc stage can be inserted between the diode and the PWM CSI to coordinate the operation of both converters. This additional stage serves as a current booster that decouples the dc-link currents of the two sides.
idcg
CS1
Ldc
idc S1 S3 S5 iwi is vs

v g ig

a

b

A
c

B
S6

C

S4

S2

Ci

Fig. 2-16 A wind energy conversion system using diode rectifier and PWM CSI with a chopper.

The converter topology using a dc chopper to boost the dc-link current is shown in Fig. 2-16. When the active device in the chopper is turned on, the real power flows from the generator to the grid through the diode rectifier, switching device CS1 , dc-link inductor and the PWM CSI. When the device is off, the current path interconnecting the PWM CSI and diode rectifier is cut. A free-wheeling diode across the dc link is hereby necessary to resume the current path for the dc inductor. To maintain the current in the generator stator winding, a dc capacitor Cdc is placed at the output of the diode rectifier bridge.

38

The dc chopper brings an additional degree of freedom for system control. As shown in Fig. 2-17, the duty cycle of the chopper, D, can be used to control the generator torque or speed through adjusting the generator-side dc-link current idcg . The two control freedoms of the gridconnected PWM CSI can then be employed to control the grid-side dc-link current idc and the reactive power element. In another sense, the additional current-boost stage increases the system complexity and power loss. All the power transferred to the grid-side converter goes through the single switching device in the chopper. The conducting current and switching stress of the chopper are relatively higher compared to those of the switching devices in the PWM CSI. The topology and control scheme presented in Fig. 2-16 and Fig. 2-17 are simulated in Matlab/Simulink with a 1.56MW WECS. Base values and main parameters for the simulation are given in Appendix A. The maximum power point tracking of the system can be obtained either by speed or torque control. If the torque control mode is employed, the torque reference can be transformed into the dc-link current reference according to similar derivation as provided in Section 2.2.1. The duty cycle of the chopper can be properly selected to obtain the desired dclink current at the generator side. If the speed control mode is required, a generator-side speed regulator will be added to provide the reference for the electrical torque. The derivation of the duty cycle of the chopper from the torque reference is the same as that in torque control mode, and can be combined into the speed regulator. Therefore, in the controller diagram shown in Fig. 2-17, the speed regulator output directly gives th reference of the duty cycle D. On the grid side, the outputs of the dc-link current regulator and the reactive current regulator are combined to calculate the CSI modulation index and delay angle.

Ldc

g
D

idc 2

vs , is

Fig. 2-17 Controller diagram of a WECS using diode rectifier and PWM CSI with a chopper.

39

 g ( pu )
g 
* g

D

idcg , idc ( A)

idc idcg

Po (×106 MW ), Qo (×106 VA)

Po

Qo

Fig. 2-18 Simulated waveforms of a WECS using diode rectifier and PWM CSI with a chopper.

Simulation waveforms are given in Fig. 2-18. The same wind speed step changes as in Fig. 2-13 are applied. The grid-side dc-link currents idc in simulation are controlled to a constant value by the PWM CSI. The duty cycle of the chopper is adjusted at different wind speeds so that the generator-side dc-link current idcg is regulated to the desired value and generator speed traces the reference value for MPPT. The output reactive power is adjusted to zero for all wind speeds. The grid- and generator-side waveforms at rated wind speed are displayed in Fig. 2-19. Grid current and voltage waveforms are sinusoidal and are in phase with each other. The waveforms at the generator terminals are distorted due to the use of naturally commutated diode rectifier. Nevertheless, the fundamental components of the current and voltage are almost in phase. 40

vcra , iga ( pu )
iga

vcra

vsa , isa ( pu )
vsa isa

Fig. 2-19 Simulated steady-state grid- and generator-side waveforms at rated wind speed.

2.5 PWM CSR and PWM CSI
As mentioned in Section 2.2, the use of diode rectifier in the WECS results in over-current or over-voltage design of the generator and causes large harmonic currents in the stator windings. Alternatively, a PWM CSR can be used in connection with a PWM CSI to form a back-to-back configuration, as shown in Fig. 2-20.

 S4
v g ig iwr
a

 S6
b

 S2

idc

Ldc

S1

S3

S5 iwi vci

A
c

B
S6

C S2 Ci

Cr

S1

 S3

 S5

S4

Fig. 2-20 A wind energy conversion system using PWM CSR and PWM CSI.

The back-to-back PWM current source converter offers a number of advantages compared to the other configurations mentioned above.

41

1)

There are in total four control freedoms available for control system design. The control freedoms in the generator-side CSR enable the realization of different control objectives for the generator, such that it can be operated under the various modes described in Section 2.2.2 to achieve optimum performance.

2)

PWM switching patterns can be employed to improve the generator current quality, thereby reduce the generator torque ripple and harmonic losses.

3)

The dc-link current is adjustable by either the CSR or the CSI with modulation index control, enabling the system to fulfill both MPPT and power factor control in the full range of operation.

4)

The converters and generator ratings can be fully utilized. The required generator voltage and current can be minimized.

5)

The system is capable of four quadrant operations, which may be helpful in dealing with various working conditions such as faults.

6)

The dynamic performance of the system is improved compared to the other solutions.

2.6 Summary of different CSC topologies
This chapter proposes several feasible CSC based topologies for WECS. The topologies described in Sections 2.3 to 2.5 have their own advantages and disadvantages. A brief summary is given in Table 2-1. The diode rectifier with PWM CSI presents the most simple and low-cost solution. However, the use of diode rectifier imposes constraints on the generator rating and results in higher stator current THD. The system operating range is also limited due to short of control freedoms. Generator magnetic flux can be adjusted to expand the system operating range but is only achieved at the cost of oversized generator and converters, which offsets the solution's cost advantage. The second topology using a dc chopper to bridge the diode rectifier and the PWM CSI introduces an additional control freedom to manipulate the dc-link current, and therefore is able to operate the system in the full range. Because the converter interfacing the generator is still a diode rectifier, the generator-side performance is not improved. Moreover, the added stage 42

brings complexity and power loss penalties to the system design. In particular, the switch in the chopper normally needs to withstand higher stresses than the other devices in the CSI such that special attention should be paid to its selection and reliability design. The last topology replaces the diode rectifier with a higher cost PWM CSR, adding full control capability to both sides. The fully controllable converters enhance the system performance in the full range of operation. The power rating of the converter and generator are minimal in this configuration, which offsets the higher cost of the converter system. This topology is therefore selected for detailed studies in the following chapters.
Table 2-1 Comparison of three CSC converter topologies Diode + Chopper + PWM CSI Medium to high PWM CSR + PWM CSI High

Comparison Items

Diode + PWM CSI

Converter Cost

Low

Control freedoms

2

3

4

Generator current THD

High

High

Low

Generator rating

High

High

Low

Converter rating

High

Medium

Low

System operating range

Partial

Full range

Full range

Dynamic performance

Low

Medium

High

43

Chapter 3 Multi-sampling SVM for CSC with Superior Harmonic Performance
Power electronic converters are composed of power semiconductor devices operating in the on and off states. The back-to-back PWM CSC selected for study in Chapter 2 employs fully controllable switching devices in both generator- and grid-side converters and therefore allows a variety of modulation schemes to be applied. The choice of the modulation scheme is essential to system performance and needs to be determined before the control system design. A few factors should be carefully considered in the selection of modulation scheme for the CSC-PMSG-WECS. They are listed as follows. 1) Device switching frequency and loss. CSC is commonly used in high-power mediumvoltage (2.3-13.8kV) applications in industry [15]. The power semiconductor devices used in a high-power CSC are normally symmetric gate-turn-off thyristors (SGTO) or symmetric gatecontrolled thyristors (SGCT) with reverse voltage blocking capability [38]. The device switching frequency for these converters is normally limited to a few hundred hertz so as to reduce switching loss and satisfy device switching limitations. 2) Harmonic distortion. A general goal of modulation scheme design for VSC or CSC is to achieve an ac voltage/current waveform with low total harmonic distortion (THD). At the same time, the low-order harmonics should be suppressed as much as possible. In CSCs, the ac capacitors together with the line/motor inductances form LC filters which have their inherent resonance frequencies. The harmonics near the resonance frequency of the filter should be carefully considered and processed. 3) Number of freedoms available for control system design. In general, two control freedoms exist in a three-phase full-bridge PWM ac/dc power converter, namely the modulation index and

44

delay angle. However, the implementation of certain modulation schemes may cause loss of control freedoms and hence affect the system performance. 4) dc utilization. By switching the power devices, the currents at the ac terminals in a CSC are constructed by segments from the dc-link current. Therefore, the magnitude of the ac currents is limited by the dc-link current level and the modulation scheme. Higher dc utilization in a CSC means wider operating range, lower dc current for synthesizing a given ac current and lower conduction loss. This chapter starts with a brief overview of existing modulation schemes for PWM CSC, followed by the introduction of the proposed multi-sampling space vector modulation (MS-SVM) which provides harmonic performance superior to the existing schemes. Detailed comparisons on the proposed and existing schemes are presented. The device switching frequency of the MSSVM is investigated in detail and methods to limit the additional switching are explained. Both simulation and experimental results are given to verify the proposed scheme. The outcome of this chapter offers a practical and flexible modulation scheme with desirable harmonic performance for the CSC-PMSG-WECS. The scheme is implemented in the converter modulator and lays a foundation for control system design.

3.1 PWM schemes for CSC
The major modulation schemes for the PWM CSC are selective harmonic elimination (SHE), trapezoidal pulse-width modulation (TPWM) and space vector modulation (SVM) [15]. A backto-back PWM CSC consists of a PWM current source rectifier (CSR) and a PWM current source inverter (CSI). The CSR and the CSI are no different from each other in terms of modulation so the above mentioned modulation schemes apply to both of them. A simplified PWM CSI, composed of six symmetric devices and fed by a dc current source idc , is shown in Fig. 3-1. The inverter produces a defined PWM output current iw . The current commutations of the converter necessitate a three-phase capacitor in parallel with the load. Any modulation scheme for the CSI must satisfy a basic constraint. At any time instant, two and only two switches in the inverter, one connected to the positive dc bus and the other to the

45

negative, must be on to carry the dc current. As a result the output at the bridge terminals are defined current waveforms and the dc-link current will not be interrupted.

S1

S3

S5
iw

A
vdc idc S4 S6
B
C

Load
Cf

S2

Fig. 3-1 PWM current source inverter.

The typical switching frequency for practical high-power CSC using SGCTs is about 400Hz to 600Hz. This low switching frequency may lead to possible low-order harmonics in the modulated waveforms and cause undesirable effects such as beat phenomenon [39] and LC resonance [40]. The following discussions of different schemes are all based on a device switching frequency around 540Hz. In other words there are nine pulses in each half cycle of the modulated phase current waveforms assuming the fundamental frequency of the modulating signal is 60Hz.

3.1.1 Selective Harmonic Elimination (SHE)
SHE is an offline designed modulation scheme that could eliminate a number of unwanted low-order harmonics with limited number of pulses. In order to achieve better harmonic performance and to reduce the complexity in finding switching pattern solutions, the pulses are normally arranged in such a way that the derived PWM waveforms have a quarter-wave symmetrical shape. The outcome of the arrangement is that all the even-order harmonics are completely removed while all the existing harmonics are either in phase or 180º out of phase with the fundamental component [41]. Consequently, the total number of harmonics to be eliminated by the SHE, k , is related to the number of pulses in each half fundamental cycle, N p , k = ( N p - 1) / 2 (3-1)

46

Taking a typical nine-pulse pattern as an example, the four angle freedoms [1  2 3  4 ] can be selected such that the 5th, 7th, 11th, and 13th order harmonic components are completely eliminated. The waveform of phase current iw and its harmonic profile are given in Fig. 3-2. In the figure, I w1 and I wn are the magnitudes of the fundamental component and the n-th order harmonic current, respectively.
iw ( pu )

1  2  4 3  6

 2

(a)

I wn / I w1 ( % )

I w1 = 1.109 pu THD = 53.39%

n
(b)

Fig. 3-2 Nine-pulse SHE pattern; (a) Phase current waveform; (b) Harmonic profile.

The main advantage of SHE lies in its ability to eliminate low-order harmonics with limited device switching frequency. For example, if we have five pulses in each half fundamental cycle, there exist two freedoms for angle selection which can be used to completely remove the 5th and 7th order components from the harmonic spectrum. This can hardly be achieved by the other modulation schemes. Despite the superior harmonic performance, SHE lacks the flexibility for control because a set of off-line calculated angles is only valid at a certain modulation index. In practice, SHE is normally utilized with fixed modulation index. If variation of the modulation index is needed, the 47

solutions for all the required modulation indices have to be calculated offline and stored in the system prior to operation. This adds to the complexity of system control and is not practical in real applications. Moreover, the calculation of SHE angles with a large number of pulses per fundamental cycle sometimes involves transcendental equations that have no solutions, which prevents the SHE from being applied to a full frequency range.

3.1.2 Trapezoidal Pulse-width Modulation (TPWM)
Carrier and modulating waveforms for S1

1 0 -1
Carrier and modulating waveforms for S 4

1 0 -1
Gating signals for S1

1 0 -1
Gating signals for S4

1 0 -1
iw ( pu )

1 0 -1 0
I wn / I w1 ( % )

0.004

0.008
(a)

0.012

Time (s)

30 25 20 15 10 5 0 0 10

3( N p - 1)

I w1 = 1.051 THD = 45.57%

ma = 1 f s = 1080 Hz

20

30
(b)

40

50

n

Fig. 3-3 Nine-pulse TPWM pattern; (a) Modulation waveforms; (b) Harmonic profile.

48

The TPWM method is a carrier based modulation scheme. The carrier and modulation waves for TPWM are specially designed to meet the switching constraints in CSC, as shown in Fig. 3-3. The design of TPWM ensures that during a  / 3 period, three devices out of the six are always off. Among the rest three, one device is always on by keeping its carrier wave zero and modulation wave positive; the modulation and carrier waves for the other two devices are arranged to produce complementary gating signals such that only one of them is on at any time instant. The switching constraints of CSC are thus satisfied. TPWM is essentially an over-modulation scheme. Although it allows the modulation index to be changed from 0 to 1, the dc utilization rate is restricted to [0.66, 0.74]. The controllable range of output current magnitude is quite limited. The spectrum of TPWM with nine pulses per half fundamental cycle is provided in Fig. 3-3(b). The harmonics appear as side bands centered around 3( N p - 1) . For N p = 9 , the 5th and 7th are around 4% and 2% of the fundamental magnitude. This is mainly because the trapezoidal modulation waveform itself contains the 5th and 7th order harmonics.

3.1.3 Space Vector Modulation (SVM)
Similar to widely used SVM schemes for voltage source inverters, the SVM for CSI is also a digitally implemented vector synthesizing method. A CSI has nine switching states coming from the six devices, among which six are active switching states that produce finite ac current and three are zero states that simply output zero. Fig. 3-4(a) shows the  space vector plane where the switching states are represented by their corresponding current vectors. The entire plane is divided into six sectors by the six active vectors ( I 1 to I 6 ), whereas all the three zero vectors lie on the center and are designated as I 0 . The desired three-phase output current iw can be expressed as a referece vector I ref rotating counterclockwise in the vector plane. Each revolution of I ref corresponds to an entire fundamental cycle of the ac current. The ratio between the magnitudes of I ref and the dc current I dc determines the modulation index ma of the converter, given as ma = I ref I dc . The angle  ref

49

is defined as the phase displacement between the reference vector and the  axis of the vector plane.


I3

I4

I2

T2 In2 Ts
I n0

In2

 ref
I0

I ref



I ref

sec
T1 I n1 Ts
I n1

I5

I1

I6

(a)

(b )

Fig. 3-4 Operating principle of SVM for CSI; (a) Space vector diagram; (b) Vector synthesis.

As shown in Fig. 3-4(b), the reference vector can be synthesized by the adjacent vectors based on the principle of ampere-second balance. Assume during a sampling period Ts , the vector is constant and is located in Sector n, it can be synthesized by vectors I n1 , I n 2 and I n 0 .

sec in the figure is the angle displacement of the reference vector within that particular sector,
thus its value is in the range of [ 0,  3) . The equations for the current synthesis can be given as,

  I ref Ts = I n1T1 + I n 2T2 + I n 0T0   Ts = T1 + T2 + T0
The vector dwelling times can be derived by solving (3-2),
T1 = ma sin( 3 - sec )Ts  T2 = ma sin secTs T = T - T - T s 1 2  0

(3-2)

(3-3)

Once the vector dwelling times are calculated, the vector sequence in a sampling period needs to be determined for the generation of PWM pulses. Various sequences are available but

50

they are associated with different device switching frequencies and harmonic profiles [42]. One of the simplest, the so-called three-segment sequence, is taken as an example for discussion. If we still suppose the vector is located in Sector n, the three-segment sequence will be I n1  I n 2  I n 0 . The switching pattern generated with this sequence has the advantage that the transition from one sector to another involves only one device switch-on and one device switchoff. Hence, in each sampling period, three switch-ons and three switch-offs take place, which is equivalent to three full device switchings. If the sampling frequency is f s = 1/ Ts , the corresponding device switching frequency is f sw = f s / 2 . The vector selection process in a practical implementation of the there-segment sequence is shown in Fig. 3-5. A digital counter is required which repeatedly counts from zero to Ts . In each counter period, the calculated T1 and T1 + T2 are compared with the counter value to determine the vector selection. For the conventional SVM being discussed here, the dwelling times T1 and T2 are calculated once and are kept fixed within each counter period. As shown in the figure, the algorithm selects vector I n1 at the beginning of a sampling period. Once the counter value reaches T1 , the second vector I n 2 is chosen instead. As the counter keeps counting up, the zero vector I n 0 will eventually replace I n 2 when the counter value is greater than T1 + T2 . The whole process starts all over when the counter enters a new period. The PWM current harmonic profile associated with this sequence is given in Fig. 3-6. It can be observed that the 5th and 7th order harmonics are about 8% and 4% of the fundamental component.
Counter value
T1 + T2 T1
Ts

counter

0

I n1

I n2

I n0

t

Fig. 3-5 Vector selection in conventional SVM.

51

I wn / I w1 ( % ) I w1 = 1.029 pu THD = 45.59% ma = 1 f s = 1080 Hz

n

Fig. 3-6 Harmonic profile of conventional SVM.

The harmonic profile of the conventional SVM is undesirable for ac filter design in the CSC. The ac capacitor together with the line-side inductance or machine-side inductance will cause LC resonances. The resonance frequency is normally between 3.5pu to 4.5pu of the fundamental frequency to ensure not only desired current quality but also acceptable cost. The low-order harmonic currents (mainly 5th and 7th) will cause harmonic voltages as well as resonance problems. This prevents the conventional SVM from wider application in practical high-power current source converters.

3.1.4 Comparison of modulation schemes
The modulation schemes discussed above are the most commonly used for CSC. In a typical high-power CSC drive system, only SHE is employed for line-side converter while the machineside converter uses the combination of SHE, TPWM and SVM [43]. Among these three options, SHE is widely used for high-fundamental-frequency operations due to its capability of eliminating unwanted low-order harmonics with limited switching frequency [44-46]. However, the optimized switching angles of SHE are calculated offline from transcendental equations that sometimes have no solutions. As the ac fundamental frequency goes down and the number of pulses per cycle increases, the converter needs to switch to TPWM or SVM methods. In addition, smooth and flexible modulation index control [45] in real time is difficult since one set of SHE angles is only optimized for a certain modulation index. Compared with SHE, TPWM and SVM [47] provide the flexibility of modulation index control. With gating signals generated in real time, both methods have excellent dynamic performances. However, the practical applications of TPWM and SVM in CSC have been 52

limited to the low-base-frequency range. This is because of the fact that their outputs contain low-order harmonics, particularly the 5th and 7th, lying very close to the resonance frequencies of the ac filters and will be amplified if the system damping is insufficient. In general, the TPWM still provides a slightly better harmonic profile than that of SVM. However, the dc utilization of the TPWM is limited to around 0.66 to 0.74 [15], which limits the control of grid-side power factor in the low-frequency range as well as the system dynamic performance during startup. Therefore, the system has to switch to SVM at very low frequencies. SVM has been consistently studied and widely used for various voltage source converters [48, 49]. Previous research on space vector techniques for CSC generally fall into two categories: methods that are adopted from SVM for VSC [50] or matrix converters [51], and the direct CSC SVM based on current vector synthesis with various vector sequences [42, 52-56]. So far, there has been little study that focuses on reducing the low-order harmonics under limited switching frequencies. Reference [42] investigated the magnitudes of lower-order harmonics (5th and 7th) of different vector sequences and combined two sequences to give a better harmonic performance. But this approach adds to the complexity of system control while the overall performance is still not desirable for practical use. [56] deals with reducing low-order harmonics in CSC SVM with low switching frequencies by re-positioning the reference vectors in each counter period. However, the improvement is limited at high modulation indices and the method is not suitable for the cases where counter periods may be across the sector boundaries. Detailed description of these cases is provided in the following sections. With special focus on how to minimize low-order harmonics generated by PWM while still achieve enough control freedoms, the following part introduces a multi-sampling SVM scheme for the control of CSC. The MS-SVM not only has the same flexibility of modulation index control as the conventional SVM but also possesses a superior harmonic performance close to SHE. Since the MS-SVM can be used in the whole range of fundamental frequencies, it completely avoids the complexity involved in switching between different modulation schemes which is currently used in the industry.

53

3.2 Multi-sampling SVM
Fig. 3-7 illustrates the proposed MS-SVM method. The dwelling time calculation is still based on the same counter period Ts as the conventional SVM while the sampling of vector angle and calculation of T1 and T1 + T2 are performed more frequently. In the following discussion, Ts designates the counter period and Tms is the sampling period. SR = Ts Tms is the sampling ratio. Similar to the conventional SVM, the number of counter periods within one sector in MS-SVM should be an integer to eliminate sub-order harmonics; moreover, it should be a multiple of six to eliminate triple order harmonics.

T1 + T2
T1

Ts

0

I n1

I n2

I n0

t

Fig. 3-7 Vector selection in the proposed MS-SVM.

As shown in Fig. 3-7, the values of T1 and T1 + T2 are not kept constant within each counter period. Instead, they gradually changes and reflects the most updated reference vector angle. The intersection points with the counter value move accordingly to the new positions. The harmonics obtained with SR = 8 are demonstrated in Fig. 3-8 as an example. It can be observed from the harmonic profile that the low-order harmonics, especially the 5th and 7th are much lower than those in Fig. 3-6. Note that the sampling ratio SR in real applications can be any integer number. The higher the sampling ratio is, the closer the performance of the MS-SVM to that of the continuous approach ( SR =  ). Fig. 3-9 shows the harmonic profile obtained with SR =  , the 5th and 7th harmonics are almost zero in this case. The choice of the sampling ratio is a balance between sampling frequency and performance of low-order harmonics. In this chapter, a sampling ratio of eight is chosen for detailed explanation.

54

I wn / I w1 ( % )

30 25 20 15 10 5 0 0 10 20

I w1 = 1.003 pu THD = 51.98%

ma = 1 f s = 1080 Hz f ms = 8 f s

30

40

50

n

Fig. 3-8 Harmonic profile of MS-SVM with SR = 8 .
I wn / I w1 ( % ) I w1 = 1 pu THD = 52.79% ma = 1 f s = 1080 Hz f ms = 

n

Fig. 3-9 Harmonic profile of MS-SVM with SR =  .

3.3 Selection of switching patterns for MS-SVM
The three-segment sequence discussed above is one of the many possible vector sequences for CSC SVM. Similar to SVM schemes for VSC, the SVM schemes for CSC can be divided into two types based on their similarity to carrier-based modulation: one type is triangle-carrier based, and the other type is saw-tooth-carrier based [42]. In Fig. 3-10, several commonly recognized sequences for CSC SVM are illustrated. It is well known that in VSC modulation schemes, the triangle-carrier based methods provide better overall harmonic performance over the saw-tooth-carrier based methods with similar device switching frequency. This conclusion does not hold true for CSC. In order to obtain a PWM current waveform with the same number of pulses ( N p ) per fundamental half cycle in

55

CSC, the carrier frequency of the triangle-carrier-based methods and the saw-tooth-carrier-based methods are N p f1 and 2 N p f1 , respectively. A comparison is given in Table 3-1.
Counter Counter

0

Ts
Io In In

2Ts
In Io

0

Ts In In In Io

SQ1

I n +1 I n +1

In Io

I n +1 I n +1
In

Io In I o1

SQ4 SQ5

I n +1
Io

SQ2

I n +1

SQ3 I o1

I n +1 I o 2 I o 2 I n +1

SQ6 I o1

I n +1 I o 2

Fig. 3-10 Various switching patterns for current source converters.

Table 3-1 Comparison of the carrier frequencies in CSC and VSC. Converter VSC ( N p pulses) CSC ( N p pulses) Triangle carrier
N p f1 N p f1

Saw-tooth carrier
N p f1 2 N p f1

Fig. 3-11 and Fig. 3-12 show the phase current waveforms and harmonic profiles for these two sinusoidal PWM (SPWM) methods. The SPWM gating signals for CSC can be derived from those of VSC with a mapping logic [52]. Although carrier-based SPWM methods are not commonly used in CSC, they are illustrated here to explain the relation between carrier type and switching frequency. In this aspect, digitally implemented SVM and carrier-based SPWM are of no difference. The dominant harmonics of the triangle-carrier based methods are centered around N p f1 , while for the saw-tooth-carrier based methods they are centered around 2 N p f1 . When the switching frequency is relatively low, for instance N p = 9 , the 5th and 7th harmonics appear as 56

sidebands of the switching frequency and have high magnitudes in the spectrum of the trianglecarrier based methods. Due to the fact that the carrier frequency of saw-tooth-carrier based methods are twice that of the triangle-carrier-based methods, the low order harmonics such as 5th and 7th are farther from the dominant harmonics and therefore have much lower magnitudes in saw-tooth carrier based methods.
I w ( pu )

1 0 -1 0.015
I wn I w1 ( % )

0.02

0.025

t (s)

(a)
35 30 25 20 15 10 5 0 0 10 20 30 40 50
Np
I w1 = 0.866 pu THD = 70.44%

ma = 1 f s = 540 Hz

n

(b)
Fig. 3-11 Nine-pulse triangle carrier based SPWM method; (a) Phase current waveform; (b) Harmonic profile.

The MS-SVM approach in essence is to approximate the naturally sampled PWM. It is effective to reduce the low-order harmonics caused by discretization but cannot affect the inherent low-order harmonics as sidebands of the switching frequency, which is the major reason for high magnitudes of low-order harmonics in triangle-carrier based SVM vector sequences. For this reason, the multi-sampling method is more suitable to be applied with the saw-tooth-carrierbased vector sequences. Among all the saw-tooth-carrier based sequences presented in [42], the three-segment sequence  I n1  I n 2  I n 0 provides the best overall performance and is thereby selected for detailed analysis and implementation in the following sections. 57

I w ( pu )

1 0 -1 0.015
I wn I w1 ( % )

0.02

0.025

t (s)

(a)
35 30 25 20 15 10 5 0 0 10 20 30 40 50

2N p

I w1 = 0.866 pu THD = 68.68%

ma = 1 f s = 1080 Hz

n

(b)
Fig. 3-12 Nine-pulse saw-tooth-carrier based SPWM method; (a) Phase current waveform; (b) Harmonic profile.

3.4 Switching frequency of MS-SVM
Compared with conventional SVM, the harmonic performance of the multi-sampling approach is substantially improved with only limited additional switching. The switching pattern and switching frequency of the MS-SVM may vary with the modulation index and delay angle. Same as in the conventional SVM, the modulation index affects the total dwell time of active vectors and hereby the magnitude of the output current. The angle of the reference vector in a practical application is the sum of the angle of a synchronous frame  syn and the control angle  w . The synchronous frame can be oriented on the line voltage or motor rotor flux/rotor position and rotates at a certain speed. The control angle  w defines the angle displacement between the reference vector and the synchronous reference frame. During operation, the modulation counter period is normally aligned with the synchronous frame, such that when  syn is zero, it's also the beginning of a complete counter period. As control angle  w varies, the calculated dwell times in

58

particular counter periods will also change. In summary, the adjustment of either the modulation index ma or the control angle  w results in different switching patterns and output waveforms.
I ( n +1)2
I ( n +1)2

I n 2 ( I ( n +1)1 )

I refk I ref 1 I0

I n 2 ( I ( n +1)1 )

I refk

I ref 1
I0

I n1 ( I ( n -1)2 )

I n1 ( I ( n -1)2 )

I ( n -1)1

I ( n -1)1

(a)

(b)

Fig. 3-13 Location of counter periods in the space vector plane; (a) No counter period spans two sectors; (b) Some counters periods span two sectors.

Fig. 3-13 shows two cases with the same ac fundamental frequency and counter period but different control angle  w . Fig. 3-13(a) illustrates the case of  w = 0 where no counter period spans two sectors. In this case, the sampled vectors from I ref 1 to I refk in a certain counter period are all located in the same sector, and no additional switching is generated. Fig. 3-13(b) shows another case having a random finite  w which causes some counter periods such as CP0 and CP3 to span two sectors. Taking CP3 as an example, the sector transition from Sector n to n+1 happens within the counter period. The sampled reference vectors within CP3 can be either in Sector n ( I ref 1 ) or in Sector n+1 ( I refk ). This situation will cause additional switching, but helps to reduce the low-order harmonics. In total there are three different cases that may increase the switching frequency. They will be discussed in detail in the following sub-sections. Generally, the sector boundary crossing is the main reason for additional switching, as can be observed in

59

all the three cases. Whenever a sector transition happens, a new set of vectors that define the new sector are employed, adding to the number of vector transitions in the current counter period.

3.4.1 Case 1
For the first two cases, the waveforms of the continuous approach ( SR =  ) are used for better explanation. The desired fundamental frequency is f1 = 60 Hz and the counter period is Ts = 1/ (18 f1 ) . In each sector, the counter repeats the up-counting from 0 to Ts for three times. The curves of T1 and T1 + T2 recur in every sector, as shown in Fig. 3-14. It is observed that the value of T1 in a sector is monotonically decreasing. Mostly, it has only one intersection with the counter value in a counter period, such as the cases of CP 1 and CP 2. The only chance of two intersections is in a counter period during which a sector transition happens, such as CP3 . Regarding to T1 + T2 , although the value is not monotonic within one sector, its rate of change is much slower than that of the counter value. Consequently, the possible number of crossing point between T1 + T2 and the counter value is limited to one.
Sector n
Ts

Sector (n+1) CP2 CP3

CP1

T1 + T2 T1

0

counter
t1 t2 t3 t4 t5 t6

sector transition at t3

Fig. 3-14 Case 1 ­ one additional switching caused by the sector transition.

Fig. 3-14 demonstrates the case that one more device switching is added by the MS-SVM method. Starting from t1 in CP3 , the reference is located in Sector n and the first vector I n1 is selected until the counter approaches t2 when t2 - t1 = T1 ( t2 ) . Then the controller switches to the second vector I n 2 . Before the counter value reaches T1 + T2 , a sector change from Sector n to

60

Sector n+1 takes place at t3 . Another set of vectors for Sector n+1 is then selected and the dwelling times are re-calculated based on the relative angle in the new sector, causing a step-up of T1 from 0 to maTs sin ( 6 ) . Once again the counter value is lower than T1 , and the vector I ( n +1)1 is applied. For any two adjacent sectors, I ( n +1)1 and I n 2 are actually the same and therefore this transition involves no additional switching. Similarly, the vector switches to I ( n +1)2 and zero vector I ( n +1)0 at t4 and t5 successively. The counter period CP3 thus includes 4 transitions of different vectors:  I n1  I n 2 I ( n +1)1

(

)

 I ( n +1) 2  I ( n +1)0 . Compared with normal SVM

sequence  I n1  I n 2  I n 0 , one more transition of vectors is inserted. As a result, the device switching frequency is increased from f s 2 to f s 2 + f1 , where f s = 1 Ts and f1 is the fundamental frequency.

3.4.2 Case 2
Fig. 3-15 gives another case of increased switching frequency using MS-SVM. The difference between Fig. 3-14 and Fig. 3-15 lies in the value of the delay angle that affects the sector transition position within a counter period.
Sector n
Ts

Sector (n+1) CP3

CP1

CP2
T1 + T2

T1

0

counter
t1 t2 t3t4t5

sector transition at t4

Fig. 3-15 Case 2 ­ two additional switchings caused by the sector transition.

In this case, two more switchings are added to the device due to the sector transition at t4 . Before t4 , the modulation operates in the same way as the conventional SVM, switching from
I n1 to I n 2 and then to the zero vector I n 0 at instant t3 . Although there is no crossing point after

61

t3 , a sector change at t4 forces the MS-SVM to select I ( n +1)0 as the new zero vector. This transition from one zero vector to another involves two device switch-ons and two device switchoffs. Consequently, the device switching frequency is now f s 2 + 2 f1 .

3.4.3 Case 3
The above two are the most common cases of switching frequency increase in the MS-SVM method. Moreover, additional switching due to discretization of the calculated values of T1 and T2 may also occur in practical implementation, as shown in Fig. 3-16. In this case the sampling frequency is 8 f s , so the dwell times are calculated eight times during a counter period. The situation illustrated in Fig. 3-16 is quite similar to the one in Case 1, except that the discretized value of T1 + T2 results in multiple intersections with the counter value, which are circled in the figure. Consequently, two more transitions follow the zero vector in Case 1, i.e. from I ( n +1)0 to I ( n +1)2 , and then back to I ( n +1)0 . It should be mentioned that Case 3 only happens when the curve of T1 + T2 is increasing, and its slope is comparable to that of the counter value. The duration of the additional switching is normally very short. To summarize, the combined effect of sector transition and discrete value of dwell time raise the switching frequency from f s 2 in SVM to f s 2 + 3 f1 in MS-SVM.

Ts
T1 + T2

T1

Fig. 3-16 Case 3- additional switching caused by the discretization.

3.4.4 Methods to reduce switching frequency

62

The foregoing analysis provides a clear image how the switching frequency of the MS-SVM method is increased compared with the conventional SVM. Because higher switching frequency brings higher loss as well as other problems, it is desired to reduce the switching frequency in MS-SVM while maintaining the same superior harmonic profile. A general approach can be used for this purpose based on the above case studies: during one counter period, once the zero vector is selected, the system will keep using it till the end of the counter period. Hence, the additional zero vector transition in Case 2 are simply removed and the switching frequency is reduced from f s 2 + 2 f1 to f s 2 . Since the selection of a different zero vector doesn't affect the output waveforms, the harmonic profile won't be changed for Case 2. Fig. 3-17 provides the simulated waveforms of Case 2 with and without the method to reduce switching frequency. The additional switching due to the discretization in Case 3 are also removed by the general approach. The device frequency of the MS-SVM method is now reduced to f s 2 + f1 , similar to that of Case 1. The duration of the additional pulse is so short that they can be eliminated with almost no impact on the harmonic profile of the output waveform, as shown in Fig. 3-18.
Device Gating 1 0 Phase Waveform 1 0 -1 (a) MS-SVM method Device Gating 1 0 Phase Waveform 1 0 -1 t (s) 0.068 0.072 0.076 0.064 (b) MS-SVM method with reduced switching frequency Fig. 3-17 Simulated waveforms of Case 2.

63

Fig. 3-18 Simulated waveforms of Case 3.

The additional switching in Case 1 actually helps to improve the harmonics performance and cannot be eliminated by this means. In summary, the device switching frequency of the MSSVM can be reduced to the same as that of the conventional SVM or higher by one fundamental frequency with almost no impact on the harmonic profile.

3.5 Comparison of MS-SVM with conventional SVM
To stress the improvement in harmonic performance of MS-SVM, it is compared with conventional SVM in detail from the perspective of harmonics contents. The MS-SVM method evolves from the conventional SVM method, but is associated with a slightly higher switching frequency. To justify the comparison, three cases are considered and listed in Table 3-2. Notice that the device switching frequency of the second SVM method is selected to be 720Hz instead of 600Hz to avoid triple order harmonics.

64

Table 3-2 Parameters of MS-SVM and SVM methods for comparison Device Switching Frequency (Hz) 540 or 600

PWM Methods

Counter Period (s)

Sampling Ratio (SR)

MS_SVM

1/1080

8

SVM_540Hz

1/1080

1

540

SVM_720Hz

1/1440

1

720

3.5.1 Low-order harmonics
Fig. 3-19 and Fig. 3-20 illustrate the 5th and 7th order harmonics under different modulation schemes versus the modulation index and control angle. The base value in the figures is the maximum fundamental current component I w1,max obtained at unity modulation index.
I wn / I w1,max

w = 0

ma

Fig. 3-19 Magnitudes of 5th and 7th order harmonics as the modulation index changes.

65

While the control angle is fixed to zero, the magnitudes of the 5th and 7th order harmonics under all three methods as the modulation index varies from zero to unity are shown in Fig. 3-19. It's a significant feature that the magnitudes of the 5th and 7th order harmonic currents under MSSVM are lower than 0.022 in the full range of modulation index. At unity modulation index, the magnitudes of the 5th under SVM_540Hz and SVM_720Hz are about 8.5% and 7.5% of I w1,max , respectively. By using the proposed MS-SVM method, the 5th order harmonic is reduced to 1.2%, which is only about 14% of that from SVM_540Hz and 16% of that from SVM_720Hz. The curve derived from the MS-SVM method is not as smooth as those of SVM_540Hz and SVM_720Hz, this is mainly because of the multi-sampling method with a low sampling ratio. As the sampling ratio increases, the curve will approach to the one using naturally sampled method.
I wn / I w1,max

0.13 0.12 0.11 0.1 0.09 0.08 0.07 0.06 0.05 0.04 0.03 0.02 0.01 0 0

ma = 1

5th of SVM_540Hz

5th of SVM_720Hz 7th of SVM_540Hz

7th of SVM_720Hz 7th of MS-SVM 2 4 6 8 10 12 14 5th of MS-SVM 16

 w (deg)

Fig. 3-20 Magnitudes of 5th and 7th order harmonics as the control angle changes.

As mentioned earlier, the varying control angle also leads to different PWM waveforms. Fig. 3-20 shows the curves of the 5th and 7th order harmonic magnitudes versus the control angle. In this figure, the modulation index is kept at unity. Since each counter period occupies 20º of the space vector plane, the corresponding values of vector dwell time and the harmonic profile repeat every 20º as the control angle increases. The magnitude of 5th from SVM_540Hz is in the

66

range of 8% ~ 11% of I w1,max while for MS-SVM, it is always below 1.2%. With MS-SVM, the 7th order harmonic magnitude is also substantially reduced at various control angles. In general, the magnitudes of the 5th and 7th order harmonics under MS-SVM are significantly suppressed in the full range of modulation index and control angle, particularly in the high modulation index region.

3.5.2 Grid- or generator-side performance
The current source converter generates PWM current waveforms with harmonics. When the converter is connected to the grid or generator, the current harmonics will appear in the grid or generator currents. A typical configuration of a current source converter connected to the grid is shown in Fig. 3-21. The magnitudes of the harmonic currents in the grid depend on the harmonics generated by the converter as well as the LC parameters and source impedance. In the figure, the grid voltage can be simplified as a voltage source with small source impedance. Ls represents the sum of the line inductance and the leakage inductance of the transformer; its value is around 0.1 to 0.15pu. Rs represents the transformer and line losses. The line-side filter capacitor is typically in the range of 0.4pu to 0.6pu. Therefore, the LC resonance frequency is around 3.3 to 5pu.
iw

is ici Ls Rs

vs

Ci

Fig. 3-21 Configuration of a current source converter connected to the grid.

Fig. 3-22 shows the magnitude plot of the transfer function of is iw . The converter LC components are tuned to have a resonance frequency of 3.7pu. As we can observe from the figure, the magnitudes of the high-frequency components in the grid current descend at 40dB/decade as the frequency increases. In a CSC, low-order harmonics close to LC resonance frequency are the major concerns because they might be amplified or only lightly damped by the LC filter. A close look at the harmonic profile of the conventional SVM in Fig. 3-6 and MSSVM in Fig. 3-8 reveals that the magnitudes of 5th, 7th, 11th and 13th harmonics in MS-SVM are 67

all reduced. The magnitudes of some higher-order harmonics in MS-SVM are observed to be more significant than those of the conventional SVM, leading to a higher THD of iw . This is not a big issue since the high-order harmonics are far above the system resonance frequencies, and can be efficiently damped. Fig. 3-23 compares the THDs of the grid current is using the three SVM methods with the same LC filter. The THD of the grid current obtained by MS-SVM is observed to be substantially reduced despite of higher THD of iw , particularly at the high modulation index region. This enables the performance of the grid-connected CSC to satisfy the IEEE Standard 519 [57] in the full range of modulation index. The conventional SVM methods exceed the harmonic current limit (5%) in the high modulation index range. Similarly, when a CSC is used to drive a machine, the filter capacitors of the CSC and the inductances of the generator form an LC filter. Using MS-SVM instead of conventional SVM method helps to reduce the harmonics current and hence the torque ripples of the generator.
Magnitude (dB) 60 40 20 0 -20 -40 -60 -80 101 102 103 Frequency (Hz)

5th 7th 11th 13th

Fig. 3-22 Magnitude plot of grid current with respect to the converter current.

68

0.09 0.08 0.07

THD

SVM_540Hz 0.06 0.05 0.04 0.03 MS-SVM 0.02 0.01 0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 ma SVM_720Hz

Fig. 3-23 Grid current THD as the converter modulation index changes.

3.6 Experimental verification
To verify the theoretical analysis and simulation results, experiments on a DSP-FPGA based controller platform are carried out to generate the MS-SVM gatings [42]. The FPGA detects the line voltage zero crossing points and performs digital phase-locked loop (PLL) to synchronize the gating signals with the line voltage. To coordinate with the MS-SVM method, the PLL gives 18*8 interrupts per fundamental-frequency cycle to calculate the dwell times, select the switching pattern and update them in FPGA for gating generation. The counter in FPGA is reset after every 8 interrupts. Fig. 3-24 provides the gating signals of both SVM and MS-SVM under unity modulation index. In this case, it's possible to have only eight pulses per cycle because no zero vector is required in some of the counter periods. Traditional SVM method has eight pulses for each device in a fundamental cycle while the MS-SVM generates one more pulse in each cycle. Channels 3 and 4 show the phase waveforms of the SVM method and its harmonic profile. The 5th, 7th, 11th and 13th order harmonics can be observed with high magnitudes from the spectrum in Channel 4. Correspondingly, channels 5 and 6 provide the phase waveforms and FFT result of the MS-SVM method. The low-order harmonics are reduced from around 7~10% of the 69

fundamental-frequency component to very low magnitudes. It verifies that MS-SVM gives superior harmonic performance for CSC.

Device gating S1 of SVM

Device gating S1 of MS-SVM

Phase waveform of SVM

5th

FFT of Channel 3 7th 11th 13th 17th

Phase waveform of MS-SVM

5th

FFT of Channel 5 7th 11th 13th 17th

Fig. 3-24 Experimental waveforms of SVM and MS-SVM with unity modulation index.

The above figure also gives an example of Case 1 in which one additional pulse is generated per fundamental cycle in MS-SVM. Fig. 3-25 and Fig. 3-26 display the waveforms of Cases 2 and 3, respectively, together with the waveforms of the proposed methods to reduce the additional switching. Fig. 3-25 is obtained under the same conditions as those in Fig. 3-17, where the modulation index equals to 0.8 and the control angle is  36 . The first channel shows the device gating of the MS-SVM. It has 11 pulses in one fundamental cycle. The second channel shows the device gating with the reduced switching frequency method. Only nine pulses are observed in this case. The same phase waveforms and harmonic profiles are observed in channels 3 to 6. Therefore,

70

the switching frequency of MS-SVM in Case 2 can be reduced to the same as that of the conventional SVM without affecting the harmonic profile.

Fig. 3-25 Experimental waveforms of switching frequency reduction in Case 2.

The waveforms of Case 3 with reduced frequency method are shown in Fig. 3-26, obtained under the same conditions as those in Fig. 3-18. The modulation index is 0.84 and the delay angle is zero. The first two channels give the waveforms of the MS-SVM with or without the reduced switching frequency method. Although they seem to be identical at the first glance, if we zoom in the first pulse to a smaller time scale, an additional pulse is detected. This is due to the discretization of the calculated dwell time as explained in 3.4.3. The resultant device switching frequency rises from 540Hz to 720Hz. As mentioned earlier, the pulse is normally very narrow and can be eliminated without even affecting the harmonic profile. Channel 4 shows the small pulse is eliminated and its FFT result in channel 6 is almost the same as that shown in channel 5.

71

Fig. 3-26 Experimental waveforms of switching frequency reduction in Case 3.

3.7 Conclusions
This chapter compares different modulation schemes for current source converters and proposes a new multi-sampling space vector modulation (MS-SVM) scheme to substantially suppress the low-order harmonics in the PWM waveforms. It is targeted for high-power mediumvoltage applications such as large WECS where low device switching frequency is required to reduce switching losses. The proposed MS-SVM is derived from the conventional SVM, but overcomes the drawbacks of high magnitudes of low-order harmonics in the output current. It has a similar harmonic performance to the widely-used selective harmonic elimination (SHE) scheme, while still offers the flexibility of variable modulation index control which the SHE lacks. The switching frequency of the MS-SVM is investigated and an effective method is proposed to minimize the device switching frequency without affecting the harmonic profile. Comparison results with the conventional SVM demonstrate that the MS-SVM can achieve

72

much better low-order harmonic performance in the full operating range, thus significantly improves the current THD. Both simulation and experimental results verify the modulation scheme and the switching frequency minimization method.

73

Chapter 4 Modeling and Analysis of PWM CSC based PMSG-WECS
Based on the converter topology chosen in Chapter 2 and PWM scheme developed in Chapter 3, the system models and analytical methods for the current source converter based wind energy conversion system are developed in this chapter. Various aspects associated with the system are explored, including: 1) Dynamic modeling of the components (turbine, generator, converter and the grid); 2) Selection of system parameters and quiescent value calculation of variables; 3) Small-signal modeling and transfer-function derivation of the system; 4) Analytical methods for the controller design. The main objective is to derive the dynamic and steady-state models of the CSC-PMSGWECS. This provides the theoretical basis for control system design in the following chapters.

4.1 System configuration and modeling
Wind turbine Generator
Pg

Generator-side converter

vLdc
Ldc

idcGrid-side converter

Grid integration
Po Qo

g
PMSG

ig

vcr iwr
icr

vdcr

iwi vdci

vci

is vs s

ici
Ci

Cr

Fig. 4-1 Configuration of a CSC- PMSG-WECS system.

74

The complete system of the proposed CSC-PMSG-WECS is shown in Fig. 4-1. The illustrated configuration consists of a large wind turbine, a high-power PMSG, a full-rating backto-back CSC, and a grid-connected transformer. The back-to-back CSC, according to the functions, can be divided into a generator-side converter and a grid-side converter interconnected through a dc-link inductor. A step-up transformer is employed to connect the converter to the grid, providing isolation and grid integration. In a variable-speed WECS, the generator speed or torque should be regulated to achieve maximum power point tracking of the wind turbine. On the other side, the real and reactive power output should satisfy the grid code. In this work, generator-side equations are derived with respect to the generator rotor flux oriented synchronous reference frame, whereas grid-side equations are obtained based on the grid voltage oriented synchronous frame. The modeling of the system starts with deriving three-phase equations from the electrical circuit. The equations are then transformed into their corresponding synchronous frames based on which the control system will be designed. The abc subscripts used hereafter denote the threephase components in the stationary reference frame. The d and q subscripts refer to the d-axis and q-axis of the selected reference frame, respectively. The transformation from abc frame to dq frame is expressed in (4-1) under the assumption of three-phase balanced system. x represents a system variable which can be a three-phase current, voltage, or flux linkage.  is the angle of the synchronous frame with respect to the aaxis of the stationary frame. Any three-phase components can be expressed as a vector in both frames. The length of the vector denotes the magnitude of the component.
 xd  2  cos  x  =   q  3  - sin  cos ( - 2 3) x  cos ( - 4 3)   a   x - sin ( - 4 3)   b    xc  

- sin ( - 2 3)

(4-1)

The system includes a few passive elements that introduce differential terms into the dynamic equations. The transformation of a differential term from abc to dq brings additional terms due to the rotating action of the dq frame, as can be seen in (4-2),
d [ x ]abc dt


d [ x ]dq dt

0 + 

-  [ x ]dq 0  

(4-2)

75

where [ x ]abc stands for the vector [ xa

xb

xc ] and [ x ]dq represents   xd
T

xq   .  is the

T

rotating speed of the dq reference frame with respect to the abc stationary frame.

4.1.1 Wind turbine power model
The modeling of the wind turbine for electrical system design mainly focuses on the amount of captured power from the wind and thus the mechanical torque applied to the shaft of the generator. The mechanical power extracted from the wind depends on many factors. A simple equation is often used to describe the power characteristics of wind turbines:

Pmech =


2

3 Ac p (  , ) vw

(4-3)

where Pmech is the mechanical power extracted from the wind; vw is the wind velocity in m s ;

 is the air density in kg m3 ; A is the area swept by the rotor blades of the turbine in m 2 ; c p
is the power coefficient, which is a function of  and  ;  is the blade pitch angle in degrees;

 , namely the tip speed ratio, is the ratio between the rotor tip speed vtip and the wind speed vw .
The relation between the blade tip speed and the turbine rotor speed r is a constant K b for a rigid system representation. The generator mechanical speed m is direct proportional to the turbine rotor speed. Particularly in a direct-drive system, m equals r . Therefore  = K bm vw . The above equation indicates a few design factors affecting wind power capture. As the power increases with the length of the turbine blades, which is the radius of the covered area A , doubling the blades length will quadruple the wind turbine power rating. This is one of the reasons that lead to larger wind turbines. Air density and wind speed are influencing factors for site selection, among other environmental factors. Tip speed ratio and pitch angle control can be employed to manipulate extracted wind power during operation. The relation between torque and mechanical power is given by the following equation:

Tmech =

Pmech

m

= Kb

Pmech  vw

(4-4)

76

One of the key control objectives of WECS is to achieve maximum power capture when the wind speed is lower than the rated. According to the turbine characteristics, the maximum power point is determined by the pitch angle and tip speed ratio at a certain wind speed. As a result, with a given pitch angle, the optimum turbine generator speed, torque and power is related to the wind speed by,
2 3 , Pmech ,opt  vw  g ,opt  vw , Tmech,opt  vw

(4-5)

Fig. 4-2 shows power curves of a typical wind turbine under various wind speeds at zero pitch angle. For wind speed within the rated value, it's possible to find the corresponding rotor speed at which efficiency and power generation are maximized.

Fig. 4-2 Wind turbine power characteristics.

The power efficiency curve is normally obtained by field data collection on the real wind turbines. Fig. 4-3 provides typical c p curves as it varies with tip speed ratio and pitch angle. According to GE's model in [58], the c p curves can be expressed in a mathematical representation using polynomials. The curve fit is a good approximation for a specific value of

 in the range of 2 to 13 m s if a polynomial of four degrees is used.
77

c p ( ,  )    i , j i  j
i =0 j =0

4

4

(4-6)

Taking  = 0° as an example, the curve fit of power efficiency curve is shown as a dash line in Fig. 4-3. Its polynomial expression is given in (4-7).

(c )
cp

p  =0

= 3.16e - 4 4 - 0.01 3 + 0.105 2 - 0.309 1 + 0.289

(4-7)

0.5 0.4

curve fit of c p ( = 0o )

 = 0o

 = 5o
0.3

 = 10o
0.2

 = 15o
0.1

 = 20o

0

-0.1 0 5 10



Fig. 4-3 Wind turbine power efficiency curve.

By replacing c p ( ,  ) in (4-3) with the polynomial expression, we can derive the equations for mechanical power and torque applied to the generator.
Pmech =
4 4 3  i j  Avw    i , j   2  i =0 j =0  4 -1 3 0 2 1 1 2 0 3 = k4m vw + k3m vw + k2m vw + k1m vw + k0m vw



(4-8)

3 -1 2 0 1 1 0 2 -1 3 Tmech = k4m vw + k3m vw + k2m vw + k1m vw + k0m vw

(4-9)

78

where k x =


2

AK bx   i , x i ( x = 0,1,...4 ) . The values of  i , x are obtained from the curve fitting
i =0

4

of c p . The coefficient  AK bx 2 can be determined according to the rated values of Pmech , m and vw . The derived mechanical torque equation can be used in the system model to calculate the torque at any wind speed and generator speed. The equation alters with the change of pitch angle. Pitch angle is usually adjusted to limit or regulate the active power. For the sake of convenience in electrical system analysis, the pitch angle can be assumed constant.

4.1.2 Current source converters
The CSC in this system uses a back-to-back configuration. The grid- and generator-side converters have the same topology but reversed energy flow. In this subsection, the modeling of the grid-side converter will be elaborated first. The same method can be applied to the generatorside converter.

S1
a

S3

S5 iwi vci is

vdci idc S4

b

c

ici
Ci

S6

S2

Fig. 4-4 Configuration of the grid-side CSC.

The configuration of the grid-side CSC is given in Fig. 4-4. The ac side of the converter has three-phase modulated waveforms dictated by the gating signals of the devices. The device switching actions generate high-frequency harmonics in the system. The ac capacitors serve as the harmonic current filter in addition to its function to ensure safe current commutation.
(a) Three-phase equations in stationary frame

79

Using the MS-SVM scheme proposed in Chapter 3, the ac side current waveforms can be expressed as,
iwia ( t ) = Gaci mi idc cos (s t -  i ) + a5 cos ( 5 (s t -  5 ) ) + a7 cos ( 7 (s t -  7 ) ) + ... iwib ( t ) = Gaci mi idc iwic ( t ) = Gaci mi idc
s i i

( ( cos ( t -  ( cos ( t - 
s

) ) 3) ) + ...)
(4-10)

- 2 3) + a5 cos ( 5 (s t -  5 - 2 3) ) + a7 cos ( 7 (s t -  7 - 2 3) ) + ... + 2 3) + a5 cos ( 5 (s t -  5 + 2 3) ) + a7 cos ( 7 (s t -  7 + 2

where mi ,  i - modulation index and delay angle of the grid-side current source converter; Gaci ac gain of the corresponding PWM modulation scheme. For MS-SVM, Gaci = 1 ;

s

- fundamental frequency of the grid voltage and current;

an ,  n - coefficient and phase angle of the nth order harmonics, n= 5, 7, 11... The coefficients can be extracted from the harmonic profile of the PWM current produced by MS-SVM in Chapter 3. As in Fig. 3-8 where modulation index equals to 1, the coefficients of low-order harmonics a5 , a7 and a11 are only around 0.01, being very low compared to that of the fundamental component. The high-order harmonic components are negligible since they can be substantially reduced by the LC filters. Therefore, the modeling for current source converters is derived based on the averaged model which neglects the harmonic components. Incorporating the phase information into the modulation index, (4-10) can be simplified as,

[iwi ]abc = Gaci [ mi ]abc idc
where  mia   mi cos (s t -  i )     =  mib  =  mi cos (s t -  i - 2 3)    mic     mi cos (s t -  i + 2 3)  

(4-11)

[ mi ]abc

(4-12)

The power balance of the grid-side converter gives the following equation with loss in the circuit neglected. vdci idc = [iwi ]abc [ vci ]abc
T

(4-13)

80

Substituting (4-11) into (4-13), the average dc-link voltage vdci can be derived as a function of the three-phase voltage [ vci ]abc and the three-phase modulation indices. vdci = Gaci [mi ]T abc [vci ]abc (4-14)

The ac current equations can be obtained based on the three-phase circuit given in Fig. 4-4. [ici ]abc = Ci d [vci ]abc dt (4-15) (4-16)

[is ]abc = [iwi ]abc - [ici ]abc
(b) dq-axis equations in rotating synchronous frame

The design of the control system is based on the defined rotating synchronous frame. Hence it's desirable to transform the above three-phase equations into the dq synchronous frame. Perform frame transformation on (4-11), (4-14) and (4-15), we have,
iwid   mid   i  = Gaci  m  idc  wiq   iq 

(4-17)

vdci = 1.5Gaci (mid vcid + miq vciq )

(4-18) d  vcid - s Ci vciq  dt  d vciq + s Ci vcid   dt 

 d vcid   0 icid  +  i  = Ci   dt  vciq   ciq      s

 C -s  vcid    i =     0    vciq   C i  

(4-19)

isd  iwid - icid  i  =  i - i   sq   wiq ciq 

(4-20)

mid and miq are the equivalent d- and q-axis modulation indices of the converter, respectively. The generator-side converter as shown in Fig. 4-5 has similar equations as those listed above, and they are summarized as below.

81

S4 ig vcr iwr
a

S6

S2

b icr Cr S1 S3 S5

c

vdcr
idc

Fig. 4-5 Configuration of generator-side current source converter.

iwrd   mrd   i  = Gacr  m  idc  wrq   rq 

(4-21)

vdcr = 1.5Gacr (mrd vcrd + mrq vcrq )

(4-22)

icrd  d vcrd   0  i  = Cr  v  +  dt  crq   g  crq 

 - g  vcrd  Cr v  =  0    crq  C r  

d  vcrd - g vcrq  dt  d vcrq +  g vcrd   dt 

(4-23)

igd  icrd + iwrd  i  =  i + i   gq   crq wrq 

(4-24)

In these equations,  g is the electrical angular speed of the generator. mrd and mrq are the equivalent d- and q-axis modulation indices of the generator-side converter, respectively. The generator-side converter also uses MS-SVM switching method, and hence Gacr = 1 .

4.1.3 Generator-side model
PMSG based WECSs eliminate or reduce the mechanical stages of the gearbox and saves cost and maintenance. This feature, however, presents a challenge in generator design for converting the mechanical power from low rotational speed into electrical power of high frequency. The number of generator poles and the rotor diameter are significantly enlarged. Most designs of PMSG for WECS use a surface-mounted permanent magnet rotor since it leads to a simple rotor design with a low weight [59]. Because the magnet is surface-mounted and the

82

permeability of a permanent magnet is very close to that of air, the armature reactance can be much smaller in a PMSG with surface-mounted magnets than that in an EESG. The surfacemounted PMSG is also referred to as non-salient pole PMSG, in which the d- and q-axis synchronous inductances are considered the same. From the literature, the synchronous inductance of a PMSG for high-power low speed wind applications is usually above 0.4pu [60, 61].

 g gq
d  gd dt

Rg

igd

vcrd

 g gd
d  gq dt

Rg

igq

vcrq

Fig. 4-6 Equivalent circuit of PMSG in synchronous frame.

Because the synchronous inductance varies as a function of the rotor angle in a salient pole machine, the equivalent circuit of a PMSG is normally derived directly in the synchronous rotating frame. Fig. 4-6 presents the equivalent circuits of the PMSG in rotor flux oriented synchronous frame, where the core loss in rotor is neglected. The generator terminal voltage vg in this case is the same as the capacitor voltage vcr of the generator-side converter. The dynamic equations are provided in (4-25),
 d gd  -  g gq - Rg igd   v  crd  dt  v  =   crq   d gq +   - R i  g gd g gq    dt 

(4-25)

where

83

  gd = - Ld igd + f    gq = - Lq igq

(4-26)

Here,  f is the magnetic flux linkage of the rotor. Rg is the generator resistance. Ld and Lq are d- and q-axis synchronous inductances, which are the sum of the leakage inductance and the magnetizing inductance. Since the rotor is assumed to have surface-mounted magnet, Ld = Lq is hence valid for the following discussions. The dynamic equations can be rearranged by combining (4-25) and (4-26),
digd   - - Rg igd +  g Lq igq L d    vcrd  dt   = v  di   crq gq   -L -  g Ld igd - Rg igq +  g f  q  dt  

(4-27)

For the convenience of evaluating the design of the electrical control system, the wind turbine and generator are considered as a one-mass system. So the torque relations are,

Teg = 1.5Pigq  f - ( Lq - Ld ) igd

(

)

(4-28)

Tm - Teg =

J d g P dt

(4-29)

where P is the number of pole pairs of the generator; J is the total inertia of the wind turbinegenerator system; Tm is the mechanical torque applied by the wind turbine, and can be derived according to (4-9); Teg is the electrical torque produced in the generator.

4.1.4 Grid-side model
Today, large wind turbines are required to be connected to medium-voltage or high-voltage transmission lines. This normally requires a transformer at the output of the WECS to step up the generated voltage with relatively low magnitudes. A three-phase equivalent circuit reflecting the low-voltage side of the output transformer is illustrated in Fig. 4-7. The grid is assumed to be stiff and can be simplified as a voltage source with small source impedance ( Ls and Rs ). Ls represents the sum of the line impedance and leakage inductance of the transformer, while Rs stands for the transformer and line losses. 84

vci is

Rs

Ls

vs

Fig. 4-7 Equivalent circuit of the grid-side model.

The three-phase equation can be derived straightforwardly from the equivalent circuit.

d [is ]abc 1 = ([vci ]abc - [vs ]abc - Rs [is ]abc ) dt Ls
The dq-axis equations based on the grid voltage oriented synchronous frame are,
 v + Ls  vcid   sd v  =   ciq   v + L sq s   disd  - s isq - Rs isd  dt  disq  + s isd - Rs isq  dt 

(4-30)

(4-31)

4.1.5 dc-link model
The generator-side and grid-side current source converters are linked by the dc-link inductor, as shown in Fig. 4-8.
idc Ldc

vLdc
vdcr

vdci

Fig. 4-8 Configuration of the dc link.

The dc-link current is given by,

vLdc = Ldc

d idc = vdcr - vdci dt

(4-32)

Replace vdci and vdcr in (4-32) with (4-18) and (4-22), we have, 85

d 1.5 idc = ( Gacr mrd vcrd + Gacr mrq vcrq - Gaci mid vcid - Gaci miq vciq ) dt Ldc

(4-33)

4.1.6 State-space equations
Combining all the equations derived for the converter, generator, and the grid, a 10th order system is constructed to simulate the dynamic behavior of the CSC-PMSG-WECS. The statespace equations beginning with the differential terms are listed below.
1 d  dt igd = L ( -vcrd - Rg igd +  g Lq igq ) d  1 d  dt igq = L ( g f - vcrq - Rg igq -  g Ld igd ) q  d 1  vcrd =  g vcrq + ( igd - Gacr mrd idc ) Cr  dt d 1  vcrq = -g vcrd + ( igq - Gacr mrq idc ) Cr  dt d P Tm - 1.5Pigq  f - ( Lq - Ld ) igd  g = J  dt   d isd = s isq + 1 ( vcid - vsd - Rs isd )  dt Ls   d i = - i + 1 ( v - v - R i ) s sd ciq sq s sq  dt sq Ls   d v =  v + 1 (i - G m i ) s ciq sd aci id dc  dt cid Ci   d v = - v + 1 i - G m i ( sq aci iq dc ) s cid  dt ciq Ci   d i = 1.5 G m v + G m v - G m v - G m v acr rq crq aci id cid aci iq ciq )  dt dc L ( acr rd crd dc 

(

(

))

(4-34)

A simplified state-space equation in a matrix form can be written as, d x = Ax + Bu dt where x= igd igq vcrd vcrq (4-35)

g

isd

isq

vcid

vciq

idc  

T

(4-36)

86

u= Tm

vsd

vsq

mrd

mrq

mid

miq  

T

(4-37)

Detailed contents of matrix A and B are provided in Appendix B.1. Note that the above equations includes Tm instead of the mechanical torque equation derived in Section 4.1.1. If the torque profile based on the wind turbine characteristics, wind speed and generator speed is considered, the input variable Tm can be substituted by a function of vw and  g , and the torque equation can be written as (4-38). d P g = Tm - 1.5Pigq  f - ( Lq - Ld ) igd dt J P 3 -1 2 0 1 1 0 2 -1 3 = k4m vw + k3m vw + k2m vw + k1m vw + k0m vw ) - 1.5 Pigq  f - ( Lq - Ld ) igd ( J

(

(

))

(

(

))

(4-38)

4.2 Analysis of steady-state operations
The system steady-state operations are investigated in this section. The outcome can be used for: (a) determining the values of the system variables at the selected operating point where small-signal modeling is applied; (b) helping to decide the system control schemes based on the steady-state values.

4.2.1 Steady-state equations
The steady-state equations of the system can be derived by setting the differential terms to zero in (4-34).
vcrd =  g Lq igq - Rg igd vcrq =  g f -  g Ld igd - Rg igq mrd idc =

(4-39) (4-40) (4-41)

1 (g Cr vcrq + igd ) Gacr

mrq idc =

1 ( -g Cr vcrd + igq ) Gacr
igq = Tm 1.5 P f

(4-42)

(4-43)

87

vcid = vsd + Rs isd - s Ls isq vciq = vsq + Rs isq + s Ls isd mid idc =

(4-44) (4-45)

1 ( -Ci vciq + isd ) Gaci 1 (Ci vcid + isq ) Gaci

(4-46)

miq idc =

(4-47) (4-48)

Gacr mrd vcrd + Gacr mrq vcrq = Gaci mid vcid + Gaci miq vciq

The above equations can be used to calculate the steady-state values of the system variables according to an arbitrary set of system inputs. Among the system inputs stated in (4-37), vsd and
vsq represent the grid voltage. In the grid-voltage oriented synchronous frame, vsd equals to the

magnitude of the grid phase voltage whereas vsq is equal to zero. Tm is determined by the wind speed and generator speed. The value selection of the control variables, mrd , mrq , mid and miq , depends on the specific control algorithms employed. Especially, the selected dc-link current level will affect the magnitudes of all these four control variables. In the following subsections, the minimum dc-link current requirements from both the generator and grid sides are investigated and compared. A few assumptions are made in order to calculate the steady-state values: (a) The conduction and switching losses of the power devices are neglected since the MV power converters usually have 98% or higher efficiency. (b) The power factor at the grid side is controlled to be unity. (c) Maximum power point tracking is achieved in steady state. (d) At rated wind speed and zero pitch angle, the maximum power is achieved when the generator is operating at its rated value. Based on the above assumptions and the wind turbine characteristics described in Section 4.1.1, the steady-state wind generator rotational speed, mechanical torque and power can be calculated under various wind speeds and are given in Fig. 4-9.
88

 g , Teg , Pg ( pu )
1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8
vw ( pu )
3 Pg  vw

 g  vw

2 Teg  vw

Fig. 4-9 Generator operating speed, mechanical torque and power curves.

4.2.2 Generator-side minimum dc-link current requirement
The generator torque producing current igq can be calculated from (4-43). The magnetizing current igd is normally set to zero to minimize the generator current. In steady state, the electrical torque equals the mechanical torque and the power generated is the product of the torque and the mechanical angular speed. Therefore, the generator currents as a function of Pg and  g can be expressed as,
igd = 0  Pg Tm  igq = 1.5P = 1.5  f g f 

(4-49)

Based on the selected igd and igq , the generator-side capacitor voltages vcrd and vcrq can be calculated according to (4-39) and (4-40). Then, the capacitor currents can be derived as,
2 2  icrd = - g Cr vcrq =  g Ld Cr igd +  g Rg Cr igq -  g Cr f  2  icrq =  g Cr vcrd = - g Rg Cr igd +  g Lq Cr igq

(4-50)

89

The required converter currents in the dq synchronous frame are the differences of the generator currents and capacitor currents.
2 2 iwrd = igd - icrd = (1 - g Ld Cr ) igd - g Rg Cr igq +  g Cr f   2  iwrq = igq - icrq = g Rg Cr igd + (1 -  g Lq Cr ) igq

(4-51)

The generator-side dc-link current can thus be calculated by, idc _ gen = 1 2 2 iwrd + iwrq mr (4-52)

The minimum dc-link current requirement as idc _ gen _ min for generator-side operation is obtained by setting mr = 1 . Combining (4-49), (4-51) and (4-52), we have,

idc _ gen _ min = i

2 wrd

+i

2 wrq

 2   Lq Cr  Rg Cr  g Pg  Cr f - Pg  +  =  g    1.5  1.5 f f    

2

2

(4-53)

4.2.3 Grid-side minimum dc-link current requirement
With the aligned synchronous frame, the grid voltage vs has only a finite d-axis component vsd representing the magnitude of the phase voltage while q-axis component vsq is zero. The active and reactive power output to the grid can therefore be independently controlled by regulating the currents output to the grid, as shown in (4-54). Po  isd = 1.5v  sd  i = - Qo sq  1.5vsd 

(4-54)

The steady-state capacitor currents can be calculated based on capacitor voltage equations in (4-44) and (4-45).
2  icid = -s Ci vciq = -s Ci vsq - s Ls Ci isd - s Rs Ci isq  2  iciq = s Ci vcid = s Ci vsd + s Rs Ci isd - s Ls Ci isq

(4-55)

90

Similar to the generator side, grid-side converter currents can be constructed by adding the grid currents and capacitor currents together.
2  iwid = icid + isd = (1 - s Ls Ci )isd - s Rs Ci isq - s Ci vsq  2  iwiq = iciq + isq = s Rs Ci isd + (1 - s Ls Ci )isq + s Ci vsd

(4-56)

The relation between the dc-link current and converter output currents is, idc _ grid = 1 2 2 iwid + iwiq mi (4-57)

Equation (4-57) shows that the dc-link current required for a particular grid-side operating condition varies inversely with modulation index and reaches the lowest value when the modulation index is unity. Based on the assumption of a lossless system, the grid output power Po is equal to the generator power Pg in steady state. Because Qo is zero for unity power factor control, the minimum value of idc _ grid as a function of Pg is obtained in (4-58),

idc _ grid _ min =

(1 -  L C )
2 s
s i

2

Ro Pg   Pg  2 2   + s Ci  vds +  1.5vds   1.5vds  

2

2

(4-58)

The minimum dc-link current requirements for both generator- and grid-side operations under variable wind speed are summarized and plotted in Fig. 4-10. It can be found that in the full range of wind speed, the grid side demands higher dc-link current than the generator side. The is due to the large filter capacitor installed at the grid side, which generates a large amount of reactive power and needs to be fully compensated by the converter for unity power factor control. The selection of the steady-state dc-link current reference should follow the higher one of these two curves; that is idc _ gen _ min in this system.

91

idc _ gen _ min , idc _ grid _ min ( pu )

idc _ grid _ min

idc _ gen _ min

vw ( pu )

Fig. 4-10 dc-link current requirements as the wind speed changes.

4.3 System stability and controller design
The differential equations in (4-34) describe the dynamic behavior of a 10th-order nonlinear system, whose stability analysis and controller design are quite complex. The analytical methods for system stability evaluation and controller design are discussed in this section.

4.3.1 Small-signal model
Small-signal modeling performs linearization of a non-linear system by applying small perturbations on a quiescent operating point. Thus, the system can be treated as a linear system with regard to small disturbances. The linear system theories and analytical methods can therefore be applied to the small-signal model for transfer function derivation and system stability analysis. The small-signal model of the CSC-PMSG-WECS can be summarized as, d  x = A x + Bu dt where 92 (4-59)

 x = [igd

igq

vcrd vsd

vcrq vsq

 g mrd

isd

isq

vcid

vciq miq ]T

idc ]T

(4-60) (4-61)

u = [Tm

mrq

mid

The sign  followed by a variable represents the small-signal variation of the variable. A and B are the new matrices derived for the small-signal model, and the details are provided in Appendix B.1. The symbols given in A and B with capitalized letters are used to represent the quiescent values of the corresponding variables at the operating point where the small-signal model is derived.

4.3.2 Transfer function derivation
The small-signal model given in (4-59) describes a linear dynamic relation between the input
u and the system state variables  x in the time-domain. For a particular output y = C x + Du ,

the small-signal equation can be derived as,
 y = C  x + Du

(4-62)

To obtain the direct transfer function from the input to the output, Laplace transformation can be applied for both (4-59) and (4-62), and the two equations [62] are combined into,
G (s) =
U ( s ) Y ( s ) =

N (s) = C  sI - A D( s)

(

)

-1

B + D

(4-63)

where s is the Laplace operator; N ( s) and D( s ) are the equivalent numerator and denominator polynomials of the transfer function, respectively. The control plant transfer functions derived hereafter are all based on the small-signal model developed in Section 4.3.1. For the simplity of description, the small-signal sign  is neglected in the variable names. The poles of the system satisfy the equation, sI - A = 0
(4-64)

93

JJ K The values of the poles are only associated with the system matrix A in (4-59) and will not
be affected by the output variable selection in (4-62). On the other hand, the zeros of the transfer function change as the output variable selection varies.

JJ K Equation (4-64) is usually referred to as the characteristic equation of the system matrix A . JJ K The roots of the characteristic equation, namely eigenvalues of the matrix A , are the same as the
poles of the transfer functions. Eigenvalues of a system indicate the behavior of the system at a steady-state operating point. If all the real parts of the eigenvalues are negative, the system responses due to the initial conditions will decrease exponentially with time and hence the system is stable. One or more positive real part of the eigenvalues signifies that the system variables will increase in magnitude as time increases. If one or more conjugate pairs of the eigenvalues have zero real part, the system response will be undamped sinusoidal oscillations. The frequency of the resonance is defined by the imaginary part of the eigenvalue.

4.3.3 Control system stability analysis
The analysis of the open-loop transfer function provides insights into the system stability. A typical control loop is taken as an example and is shown in Fig. 4-11. x is the controlled variable.
x is the error between the reference value x* and the feedback x .
x* ( s )

x ( s )

Gc ( s )

u* ( s )

G (s)

x (s)

x ( s )

Compensator
H f ( s)

Control plant

Feedback Fig. 4-11 A typical control loop diagram.

The closed control loop includes three main blocks: compensator transfer function Gc ( s ) , control plant transfer function G ( s ) and feedback transfer function H f ( s) . The open-loop

transfer function is defined as,
x ( s ) k ( s - z1 )( s - z2 )" ( s - zn ) = Gc ( s ) G ( s ) H f ( s ) = x ( s ) ( s - p1 )( s - p2 )" ( s - pm )
94

(4-65)

where
z1 , z2 , p1 , p2 , zn are the zeros of the transfer function; pm are the poles of the transfer function.

And the corresponding close-loop transfer function is,
x (s) Gc ( s ) G ( s ) = x* ( s ) 1 + Gc ( s ) G ( s ) H f ( s ) (4-66)

The characteristic equation is obtained by setting the numerator of the close-loop transfer function to zero.
1 + Gc ( s ) G ( s ) H f ( s ) = 0

(4-67)

In this sense, the open-loop transfer function indicates the stability of the system. Two methods are commonly used to evaluate the system stability according to the open-loop transfer function: the Bode diagram approach and the root locus approach. In general, Bode diagram provides a straightforward method to study the controller performance, such as the controller bandwidth, dc gain, frequency response and gain/phase margin for stable operation. However, it's not suitable for the stability evaluation of a non-minimum phase system which has at least one zero located in the right half of the s-plane. Instead, the root locus analysis can be applied to both minimum and non-minimum phase systems. The method investigates the trajectories of the roots of the characteristic equations when a certain system parameter varies, and helps to select a proper value of that system parameter for stable operation.

4.3.4 Controller design procedure
Based on the previous discussions, a system controller design procedure is initiated. (1) Define the scope of the analyzed system and derive its dynamic and small-signal models. This work can be done based on the model derived in Section 4.1. (2) Calculate the steady-state values of the system variables at a defined operating point to perform small-signal modeling. (3) Define the control objectives and design the structure of the control loop.

95

(4) Obtain open-loop transfer function without compensator. The zeros and poles of the system can also be identified in this step. (5) Design the corner frequency and proportional gain of the control system using root locus or Bode diagram analysis. (6) Verify the design in different operating conditions.

4.4 Verification of the system model
In the above sections, a complete dynamic model and a small-signal model for the CSCPMSG-WECS are developed. Verification of the system models will be carried out in this section. Due to the complexity of the system, the verification is conducted separately for the generator-side model and the grid-side model. For each model, the following steps are taken: · Identify the system state space equation and small-signal model. · Design a control objective and the corresponding control loop. · Derive a step response according to the transfer function deduction. · Simulate the corresponding circuit and controller in Matlab/Simulink. · Obtain a step response from the simulation and compare it with the result in the third step.

4.4.1 Verification of the grid-side model
The grid-side circuit is composed of a dc voltage source vdcr , a dc-link inductance Ldc and the CSC connected to the grid. In the circuit, vdcr represents the average dc voltage applied by the generator-side converter. The dc-link current controller design and step response are evaluated in this section. A small amount of three-phase resistor Ridamp is connected in parallel with the output capacitor, providing damping to the LC resonances. Note that this resistor is only temporarily added to stabilize the circuit for model verification. In the final system simulations and experiments, advanced approaches are adopted to damp the resonance instead of the damping resistor.
4.4.1.1 Dynamic equations

96

The state-space equations of the grid-side model are obtained from the last five equations of (4-34). Only the dynamic equation of the dc-link current is partially modified to take vdcr as an input.

v 1.5 d idc = dcr - ( Gaci mid vcid + Gaci miq vciq ) dt Ldc Ldc Detailed state-space and small-signal equations are provided in the Appendix B.2.
4.4.1.2 Control loop design and system step responses

(4-68)

Grid voltage oriented control scheme is normally employed to adjust the real power and reactive power independently. The d-axis current isd determines the active current injected to the grid. Since the dc-link current can be controlled by the real power flow in the circuit, its regulator output gives the reference of the grid d-axis current. The structure of the dc-link current controller is shown in Fig. 4-12.
* idc (s)

idc ( s )

Gc _ i ( s )

* -isd (s)

Ki ( s )

* mid (s)

Gi ( s )

idc ( s )

 (s) idc

H f _i (s)

Fig. 4-12 Simplified diagram of the grid-side dc-link current control loop.

Gc _ i ( s ) is traditional PI compensator. In (4-69), k p _ i and ki _ i are the proportional and integral gains of the PI regulator, respectively. f c _ i designates the corner frequency defined by
ki _ i

( 2 k ) . The compensator output -i
p_i

* sd

is chosen to bear the minus sign such that the

proportional gain would be positive for stable system operation.
Gc _ i ( s ) = - idc ( s )
* isd (s)

= kp_i +

ki _ i

 2 f c _ i  = k p _ i × 1 +  s s  

(4-69)

* * is calculated from the compensator output -isd according In the controller, the reference mid

* * at the operating to mid to the steady-state equations. K i ( s ) is the transfer function from -isd

97

point where small-signal modeling is performed. Combining (4-17) and (4-56) and considering the coupled items as small disturbances to the system, we have,
Ki ( s ) = -
* mid (s) * isd (s)

= - (1 - s2 Ls Ci ) I dc

(4-70)

* to the dc-link current idc under rated The plant transfer function from the control input mid

operating condition is as follows. The system parameters are based on the simulation setup in Appendix A.
idc ( s ) 2.4 × 105 s 4 + 2.1× 108 s 3 + 1.4 × 1012 s 2 + 6.2 ×1014 s1 + 1.85 ×1018 Gi ( s ) = * =- 5 (4-71) mid ( s ) s + 150.8s 4 + 6.4 ×106 s 3 + 4.82 ×108 s 2 + 8.56 ×1012 s1 + 4.57 ×1012
H f _ i ( s ) is the transfer function of the feedback network. It is set to 1 in this section to

simplify the comparison.
* The final transfer function from the reference input idc to the output idc can now be deducted

based on the above equations.
Fi ( s ) = idc ( s ) i
* dc

(s)

=

1 + Gc _ i ( s ) K i ( s ) Gi ( s ) H f _ i ( s )

Gc _ i ( s ) K i ( s ) Gi ( s )

(4-72)

Step responses of the derived idc control loop according to the transfer function are plotted in Fig. 4-13. The choice of PI parameters significantly affects the system dynamic performance. The first set of the PI parameter gives a response with almost no overshoot. The feedback reaches the reference values in 20ms. Small error exists after 20ms, and is gradually reduced over the time. The second set of the parameters has a low proportional gain but a higher corner frequency. The system responds harshly to the reference change, and result in an overshoot of 59%. Detailed selection of PI parameters for the CSC-PMSG-WECS will be discussed in the next Chapter.

98

idc ( A)

almost no overshoot

(a) k p _ i = 0.41, f c _ i = 1Hz.

idc ( A)

overshoot 59%

(b) k p _ i = 0.041, f c _ i = 30 Hz.

Fig. 4-13 dc-link current step responses based on transfer function deduction.

4.4.1.3 Simulation model and system step responses

Matlab/Simulink models are constructed to simulate the dc-link transient performance. As discussed earlier in Section 4.1.2, the device switchings generate high-order harmonics in its ac output currents and cause high-frequency dc-link current ripple. The converter mathematical model derived above averages out the switching-frequency component and is thereby ripple free. The existence of large dc-link current ripples makes it difficult to compare the small step response of the generator. For the sake of better comparison, two simulink models were constructed. The first model involves all the switching devices and uses MS-SVM to generate gating signals for the devices. 99

The second model replaces the switching device block by an ideal mathematical model given in (4-11). The same PI parameters as in the transfer function deduction are applied in simulation. The small step responses of the dc-link current obtained in the simulation are plotted in Fig. 4-14. At 2s, a step-up of dc-link current reference by 30A is issued. The responses of the dc-link current as shown in the figure match well with those in Fig. 4-13. The simulation results verify the derived dynamic performance from transfer function deduction.
idc ( A )

520

490

460

Simulated with PWM switchings Simulated without PWM switchings 20ms

430 1.9
idc ( A )

2

2.1

2.2

2.3

2.4 Time (s)

(a) k p _ i = 0.41, f c _ i = 1Hz.

520

overshoot 58.3%

17.5 A

490

460

Simulated with PWM switchings Simulated without PWM switchings 44ms

430 1.9 2 2.1 2.2 2.3 2.4 Time (s)
(b) k p _ i = 0.041, f c _ i = 30 Hz.

Fig. 4-14 dc-link current step responses in simulation.

4.4.2 Verification of the generator-side model

100

Generator speed controller is evaluated in this section to verify the generator-side modeling and simulation. The system includes the generator and the generator-side CSC. The mechanical torque applied to the generator is assumed constant. The dc output of the converter supplies a dc current source.
4.4.2.1 Dynamic equations

Based on the defined system, the dynamic equations are composed of five differential equations which are exactly the same as the top five equations in (4-34). The derivation of the state-space and small-signal equations is straightforward. Similar to the grid-side system, a small damping resistor Rrdamp is used. Detailed state-space and small-signal equations are provided in the Appendix B.3.
4.4.2.2 Control loop design and system step responses

In a field oriented control system, the generator speed is changed by varying the torque producing current igq . Therefore, the generator-side converter q-axis equivalent modulation index mrq is selected as the control lever for speed regulation. The structure of the generator speed controller is shown in Fig. 4-15.
* g (s)

 g ( s )

Gc _  ( s )

* -igq (s)

K ( s )

* mrq (s)

G ( s )

g ( s )

 (s) g
H f _ (s)

Fig. 4-15 Simplified diagram of the generator-side speed control loop.

The transfer function of the PI compensator is,
Gc _  ( s ) = -

 g ( s )

* igq (s)

= k p _ +

ki _ 

 2 f c _   = k p _  × 1 +  s s  

(4-73)

where k p _  , ki _  and f c _  are the proportional coefficient, integral coefficient and corner frequency of the PI regulator, respectively.

101

G ( s ) is the transfer function of the control plant. The system parameters of the simulation setup in Appendix A are used.
G ( s ) =
* mrq (s)

g ( s )

=-

-3.97 × 10-13 s 4 + 2.79 ×10-9 s 3 + 2.2 × 108 s 2 + 2.98 ×1010 s1 + 2.3 ×1014 (4-74) s 5 + 270.2s 4 + 2.67 ×106 s 3 + 3.59 ×108 s 2 + 1.09 ×1012 s1 + 2.27 ×1011

H f _  ( s ) is set to 1 and K ( s ) is derived according to (4-21) and (4-51),
K ( s ) = -
* mrq (s) * igq (s) 2 = - (1 - g Lq Cr ) I dc

(4-75)

 g ( rad s )

almost no overshoot

(a) k p _  = 477, f c _  = 0.5Hz.

 g ( rad s )
overshoot 36%

(b) k p _  = 191, f c _  = 10 Hz.

Fig. 4-16 Generator speed step responses based on transfer function deduction.

102

* to  g can be deducted according to the following The final transfer function from  g

equation.
F ( s ) =

g ( s ) Gc _  ( s ) K ( s ) G ( s ) = * g ( s ) 1 + Gc _  ( s ) K ( s ) G ( s ) H  ( s )

(4-76)

Fig. 4-16 illustrates the system responses to speed reference step changes. Similarly, different responses are obtained as the PI parameters change.
4.4.2.3 Simulation model and system step responses
 g ( rad s )
2 1.5 1 0.5 0 -0.5 -1 -0.1 0 0.1 0.2 0.3 0.4 Time (s)
(a) k p _  = 477, f c _  = 0.5Hz.
* g

30ms

 g ( rad s )
378
overshoot 36.6%

36.6 rad s

377
* g

376 48ms 375 3.9 4 4.1 4.2 4.3 4.4 Time (s)
(b) k p _  = 191, f c _  = 10 Hz.

Fig. 4-17 Generator speed step responses in simulation.

103

A Matlab/Simulink model is constructed to simulate the generator performance. The switchings of the converter devices are included in the simulation. The harmonic components produced by the modulated currents are substantially filtered by the LC circuit and the mechanical system inertia, thus do not have a large impact on the speed profile. The generator speed step responses obtained in the simulation are provided in Fig. 4-17. It can be observed that the generator speed step responses in simulation are the same as those derived from the transfer function analysis, which validates the transfer function deduction as well as the simulation model.

4.5 Conclusions
In this chapter, the system model and analytical methods are developed for system stability evaluation and controller design.
· A 10th order dynamic model for CSC-PMSG-WECS is derived. Equations are established

in the synchronous reference frames defined on both sides. The dynamic equations form a 10th order non-linear system.
· The steady-state equations are obtained to calculate the steady-state values of the system

variables. The calculation provides the minimum dc-link current requirements for the selection of the dc-link current reference. In addition, it facilitates the calculation of the coefficients in small-signal model.
· Small-signal modeling of the system is performed to linearize the system at a particular

operating point. Linear system analytical approaches, such as transfer function analysis, root locus analysis, and Bode diagram analysis, are therefore applicable for stability investigation and control system design. In view of this, a controller design procedure is put forth.
· The system model is divided into two parts for verification of the theoretical derivation

and simulation results. The comparison of the results demonstrates consistency of the modeling and simulation. The outcome of this chapter provides the theoretical basis and simulation models for control system design in the following chapters. 104

Chapter 5 Control System Design for PWM CSC Based PMSG-WECS
This chapter designs the whole control system for the CSC-PMSG-WECS based on the developed system model in Chapter 4. A brief overview of the control system is presented first. A comparison of the two possible dc-link current control methods, one with the grid-side converter and the other with the generator-side converter, is then carried out to evaluate the system performance. After the dc-link current control method is determined, the control system structure and regulator design for the grid and generator sides are explained. Following that, a power feed-forward method is introduced into the system to improve the dynamic performance. Simulation and experimental verifications of the control system are provided at the end of this chapter.

5.1 Overview of the control system
Generator-side converter

vLdc
Ldc

Pg

idc

Grid-side converter

Po Qo
vs s

g
PMSG

ig vcr iwr

iwi
vdcr

vci is
ici Ci

vdci
Grid

icr Cr
mid miq

mrd

mrq

Fig. 5-1 Converter configuration and control variables in a CSC-PMSG-WECS.

Fig. 5-1 shows the configuration of a back-to-back PWM CSC based WECS. The generatorand grid-side CSCs both employ the MS-SVM scheme proposed in Chapter 3 for gating signal 105

generation, such that flexibility in control and excellent harmonic performance can be achieved. As an effort to reflect industrial practice in high-power medium-voltage CSCs, the switching frequency of the power devices is limited to be within 600Hz. This low device switching frequency reduces switching losses but significantly affects the design of the control system. The system has in total four control variables, namely, the equivalent dq-axis modulation indices in the generator- and grid- sides synchronous frames ( mrd , mrq , mid and miq ). As discussed in Chapter 4, field oriented control (FOC) is developed at the generator side while voltage oriented control (VOC) is employed for the grid side. In the state-space equations of the system, the four control variables are considered as the inputs. Among them, generator-side qaxis component mrq and grid-side d-axis component mid are mainly responsible for system real power control whereas generator-side d-axis component mrd and grid-side q-axis component miq are primarily related to the reactive power control of their respective side. The real power flow on both sides should be balanced in steady state, while the reactive power on each side, determined by their own specific requirements, can be different. The main control functions of the system are summarized as follows.
1) dc-link current control

The operation of a CSC requires a constant current source in the dc link which is shared by the generator- and grid-side converters. A fast and stable control of the dc-link current can decouple the controllers on the two sides. Therefore, the bandwidth of the dc-link current control loop should be as high as possible. The actual dc-link current is determined by the real power difference between the generatorand grid-side converters. Any variation in the real power on either side results in dc-link current fluctuation. In drive systems, the dc-link current is controlled by the grid-side converter because the grid is the energy source and can be assumed constant. In wind power generation systems, however, the generator supplies the converted wind power to the grid and both sides of the system can be assumed as energy supplies. The dc-link current control in this case can be done by both sides but concerns rise regarding the performance. It should also be mentioned that the grid is only assumed to be a stiff voltage source in normal operations; any fault leads to variations in its magnitude and frequency. 106

The minimum dc-link current requirements for both converters are discussed in Chapter 4. The dc-link current reference for its controller should always be equal to or greater than the minimum values. Although the dc-link current can be maintained at the highest level to obtain best dynamic response, the fastest response is usually not required for wind power generation because the power output to the grid is regulated to avoid fast transients. Additionally, in order to extract more energy from the wind, the system works in the variable-speed operation mode. It is therefore beneficial for a megawatt system to minimize the dc-link current so as to reduce losses if the wind speed is lower than rated. From another point of view, maintaining high dc-link current at lower wind speed requires a significant amount of shoot-through states in the CSC, which causes more conduction loss on the devices and reduces the system efficiency. Therefore, minimum dc-link current control for variable-speed operation is proposed to reduce the overall system loss and the thermal stress on switching devices.
2) Grid power factor control

For a large WECS, the capability of power factor (PF) control or voltage regulation on the grid side is demanded by the grid codes. In an industrial CSC based motor drive, selected harmonic elimination (SHE) is normally used at the grid side due to its capability of eliminating a number of unwanted low-order harmonics [63]. The grid reactive power in such a system is not fully controlled by reason of the limited control freedoms in SHE. In academic literature, several methods [45, 64-66] were developed to achieve PF control in a CSC. Unity PF is obtained in [64] by phase-shifting the modulating signals with respect to the converter operating point, which is not straightforward for grid-side active and reactive power control. Two PI regulators were proposed in [45] to adjust modulation index and phase angle directly. However, the coupling of modulation index and phase angle degrades the system performance. Nonlinear state variable approach in the rotating synchronous frame [65, 66] allows the independent control of grid-side d- and q-axis currents, but the performance based on input-output linearization is affected by the system parameters. With the added control freedom by the MS-SVM scheme, a simple conventional PI regulator is sufficient for grid PF control. The control is insensitive to system parameters.
3) Generator speed control

107

In a variable-speed WECS, the generator rotor speed needs to be adjusted to achieve maximum power extraction. The algorithms for maximum power point tracking (MPPT) is well studied in previous research [67-69] and can be summarized as turbine-generator speed control, torque control, direct power control and wind speed sensorless control. The MPPT algorithms provide references for wind turbine pitch control and generator speed control. This chapter mainly focuses on the converter control, and therefore, the wind turbine pitch control is not considered. In normal operation, the generator controller receives the speed reference from MPPT and regulates the rotor speed as well as the power factor. By analyzing the power flow of the whole system, it can be found that the rotor speed can be controlled through adjusting the active power flow from the turbine to the grid. Meanwhile, the reactive power requirements for generator- and grid-side are different. On the generator side, the reactive power control helps obtain desired generator terminal voltage and current; while on the grid side, reactive power control is to regulate the bus voltage or meet other grid operating requirements. The above three control tasks will be discussed separately in the following sections. The performance of the whole system will be analyzed at the end of this chapter.

5.2 dc-link current control
As mentioned earlier, the performance of the dc-link current control is crucial to the system dynamics. The dc-link dynamic equation is repeated below in (5-1).
vLdc = Ldc d idc = vdcr - vdci dt

(5-1)

Multiplying (5-1) by idc and assuming that the converters are lossless while all the passive components are ideal, we have (5-2). Pdc represents the power stored in the dc link, whereas Pg and Po are the generator output power and converter output power to the grid, respectively.
Pdc = vLdc idc = vdcr idc - vdci idc = Pg - Po

(5-2)

The above two equations indicate that either the generator- or grid-side converter can fulfill dc-link current regulation by adjusting vdcr or vdci . From another perspective, both converters are actually adjusting their corresponding real power flow to control the dc-link current. The control

108

variables of the generator-side q-axis component mrq or the grid-side d-axis component mid can therefore be employed to fulfill the task. The following subsections compare the controller performances with control from both sides of the converter. The derivation and simulation are based on the 1.56MW/3000V CSC-PMSGWECS in Appendix A.

5.2.1 dc-link current control by generator-side converter
Fig. 5-2 illustrates the system control diagram with dc-link current controlled by the generator-side converter. In this case, the grid-side control variable mid is responsible for adjusting the real power output to the grid, whose reference is the maximum power available from the wind turbine. In the meantime, the dc-link current control on the generator side ensures power balancing between both sides of the dc-link inductor and MPPT of the system is guaranteed. According to the grid reactive power requirement, the output reactive power is regulated by grid-side q-axis control variable miq . Generator d-axis control variable mrd is used for optimizing generator operation, such as to minimize generator current or to limit generator terminal voltage.

* mrq

* mrd

* mid

* miq

Fig. 5-2 Simplified control block diagram with dc-link current controlled by generator-side converter.

109

This control method can be used under normal operating conditions or circumstances when the grid-side converter loses its control capability. Specifically, in the case of temporary loss of grid voltage, the generation system is demanded by grid codes to stay online and remain operational until the voltage comes back after a short interval. During this period, only the generator-side converter can be employed to ensure proper regulation of the dc-link current and thus keep the system operational. It should be noted that under this control scheme, the source of power for dc-link current regulation comes from the generator and is dependent on the generator operating point. Therefore, the control performance relies highly on the source characteristics. In wind power applications, the mechanical torque and power vary with the generator speed. The curves of torque-speed and power-speed are highly non-linear. The performance derived from small-signal model analysis at various selected operating points may differ substantially from each other. In general, the control can be divided into three cases according to the slope of the power-speed curve at the selected operating point. (a) The selected operating point is on the left side of the maximum power point in the powerspeed curve. In this case, the mechanical power rises as the generator speed goes up. A step-up in the dc-link current reference necessitates an increase of the input power. The
* therefore should be reduced to allow the increase of the torque producing current igq

generator speed. (b) The selected operating point is on the right side of the maximum power point in the power-speed curve. The mechanical power decreases as the generator speed increases,
* should be in the direction opposite to that in (a) when and hence the variation of igq

facing a step-up of the dc-link current reference. (c) If the system reaches the maximum power point in transient or steady state, no excessive power is available to help increase the dc-link current. The variation of speed in either direction will eventually reduce the dc-link current. Detailed controller design and analysis are provided below under an assumption that the input mechanical torque is constant at the vicinity of the selected operating point. The

110

mechanical power thereby varies proportionally with the generator speed. This situation belongs to case (a).
* idc (s)

idc ( s )

Gc _ gen ( s )

* -igq (s)

K gen ( s )

* mrq (s)

Ggen ( s )

idc ( s )

 (s) idc
H f _ gen ( s )

Fig. 5-3 dc-link current control loop using generator-side converter.

The dc-link current control diagram using the generator-side converter is shown in Fig. 5-3, where
 2 f c _ gen Gc _ gen ( s ) is the PI compensator, and Gc _ gen ( s ) = k p _ gen × 1 + s   ; 

Ggen ( s ) is the control plant transfer function derived from the small-signal model, and

2.4 ×105 s 9 - 2.6 × 108 s 8 + 2 ×1012 s 7 - 1.9 × 1015 s 6 + 5.6 × 1018 s 5 Ggen ( s ) = idc ( s ) -4.0 × 1021 s 4 + 6.1× 1024 s 3 - 2.5 × 1027 s 2 + 2.1× 1030 s1 - 5.4 ×1029 ; = * mrq ( s ) s10 + 21s9 + 9.6 ×106 s8 + 1.7 ×108 s 7 + 3.1×1013 s 6 + 4.2 ×1014 s 5 +3.8 × 1019 s 4 + 3.5 × 1020 s 3 + 1.5 × 1025 s 2 + 4.5 × 1025 s1 + 2.5 × 1027
H f _ gen ( s ) represents the low pass filter in the feedback of idc , and H f _ gen ( s ) =

2 × 500 ; s + 2 × 500

* * to mrq derived at the steady-state operating point, and K gen ( s ) is the gain from -igq

2 K gen ( s ) = - (1 - g Lq Cr ) / I dc .

Root locus and Bode plots of the idc controller with compensator are illustrated in Fig. 5-4 to Fig. 5-6. For the sake of better visualization, only root loci above the real axis are shown in Fig. 5-4 since the whole figure is symmetrical about the real axis. The system is a non-minimum phase system, with poles located in the left half plane (LHP) while about half of the zeros in the right half plane (RHP). Five resonance modes can be observed from the magnitude plot in Fig. 5-5. Detailed eigenvalue analysis shows the lowest-frequency resonance mode is related to the 111

moment of inertia of the turbine and generator while the remaining four high-frequency resonance modes are caused by LC circuits on both ac sides of the converter. When transformed from abc-frame to dq-frame, the two LC resonance frequencies f res _ gen and f res _ grid , are modulated into four, which are around f res _ gen ± f syn _ gen and f res _ grid ± f syn _ grid , where f syn _ gen and
f syn _ grid are the synchronous frequencies of the generator and the grid, respectively.
Imaginary Axis 2500
f res _ grid + f syn _ grid

2000
f res _ gen + f syn _ gen

1500

f res _ grid - f syn _ grid

1000
f res _ gen - f syn _ gen

500

Critical root loci (inertia related)
0 -200 0 200 400 600 Real Axis

Fig. 5-4 Root locus plot of generator-side dc-link current controller with compensation.

Although all the poles are located in the LHP, they are very close to the j axis and are apt to move towards the RHP. This is because of the assumption of an ideal system model without any damping. As the proportional gain k p _ gen increases, the set of poles close to the origin approach much faster towards the j axis and become the critical root loci that prevent k p _ gen from further increase. This pair of root loci are related to the moment of inertia of the wind turbine and generator. Fig. 5-6 demonstrates three sets of the inertia-related root loci obtained with different values of inertia. It can be seen that the larger the inertia is, the lower the critical gain and dc-link current dynamic response will be. Under such circumstances, the system controller bandwidth is limited by the lowest-frequency resonance mode, which is not a desired 112

feature since the inertia constant of a wind turbine and generator system is normally about a few seconds. The controller bandwidth has to be substantially reduced to guarantee the stable operation of the system, as shown in Fig. 5-5, where the open-loop Bode plot is shown. Physically, the increase of the dc-link current relies on the increase of the generator speed to supply extra power to the dc link. The variation rate of the speed will be lowered down if a large inertia is involved, which leads to a sluggish response of the dc-link current control.
Magnitude (dB) 80 60 40 20 Frequency: 0.0206 Hz 0 -20 -40 -60 -80 -100 10-3 10-2 10-1 100 101 102 Frequency (Hz)

Fig. 5-5 Magnitude plot of open-loop transfer function Gc_genKgenGgenHf_gen.

If the selected operating point for analysis belongs to case (b), the controller structure is
* should be in the opposite direction of that in case similar to that in Fig. 5-3, but the change of igq

(a) as discussed earlier. The dc-link current regulation is more straightforward in case (b) because the increase of the electrical power output results in an increase of the mechanical power input which helps sustain the operation. In this case, the variation of the inertia value doesn't have much impact on the controller, and the dc-link current adjustment can be much faster than that of case (a). This makes the response comparable to the performance described in the following subsection where the grid-side converter is used for dc-link current control.

113

According to the analysis above, the performance of the dc-link current controller based on generator-side converter is case dependent. The preferred steady-state operating points should be located on the right-side of the maximum power point. However, complicated detection method and controller design should also be developed to ensure stable system operation once the operating point moves to the left side of the maximum power point, or, the operation in this region should be entirely avoided.
Imaginary Axis 15
J1 J3

Inertia: J1 < J 2 < J 3 Critical gain: k p1 > k p 2 > k p 3

10

J2

5

0
J3

-5

J2 J1

-10

-15 -4 -2 0 2 4 Real Axis

Fig. 5-6 Root loci variation with inertia in generator-side dc-link current controller.

5.2.2 dc-link current control by grid-side converter
The second method for dc-link current adjustment uses the control variable mid from the grid-side converter. The system control diagram is shown in Fig. 5-7. Compared with the previous method, the two variables responsible for real power control swap their functions. The output of the MPPT algorithm sets the reference of mrq . By controlling the dc-link current to be stable in the steady state, the real power output to the grid is equal to the power extracted from the generator. Grid voltage oriented control implies that the d-axis grid current is proportional to the real power output. Hence, the output of the dc-link current PI regulator sets the reference for isd . 114

* mrq

* mrd

* mid

* miq

Fig. 5-7 Simplified control block diagram with dc-link current controlled by grid-side converter.
* -isd (s)

* idc (s)

idc ( s )

Gc _ grid ( s )

K grid ( s )

* mid (s)

Ggrid ( s )

idc ( s )

 (s) idc
H f _ grid ( s )

Fig. 5-8 dc-link current control loop using grid-side converter.

The control loop diagram is depicted in Fig. 5-8, where
 2 f c _ grid Gc _ grid ( s ) is the PI compensator, and Gc _ grid ( s ) = k p _ grid × 1 + s   ; 

Ggrid ( s ) is the control plant transfer function obtained from small-signal model, and

-2.4 × 105 s 9 - 1.8 × 108 s 8 - 2.0 × 1012 s 7 - 1.0 ×1015 s 6 - 5.8 ×1018 s 5 Ggrid ( s ) =
* mid (s)

idc ( s )

=

-1.6 × 1021 s 4 - 6.4 ×1024 s 3 - 6.0 × 1026 s 2 - 2.0 ×1030 s1 - 2.7 ×1029 ; s10 + 21s 9 + 9.6 × 106 s 8 + 1.7 × 108 s 7 + 3.1× 1013 s 6 + 4.2 ×1014 s 5 +3.8 ×1019 s 4 + 3.5 × 1020 s 3 + 1.5 ×1025 s 2 + 4.5 × 1025 s1 + 2.5 ×1027

H f _ grid ( s ) represents the low pass filter in the feedback of idc , and H f _ grid ( s ) =

2 × 500 ; s + 2 × 500

115

* * to mid derived at the selected operating point, and K grid ( s ) is the gain from -isd

K grid ( s ) = -(1 - s2 Ls Ci ) / I dc .
Fig. 5-9 and Fig. 5-10 provide the root locus and Bode plots of the grid-side dc-link current controller. The poles and zeros in this case are all located in the LHP, but are also very close to the j axis. Similarly, five resonance modes can be observed from the magnitude plot in Fig. 5-9. However, the set of root loci most related to the inertia are now moved further to the left side of the j axis as the gain increases, and are no longer the critical root loci for system stable operation. Instead, LC resonance becomes the main factor that limits the controller bandwidth. In Fig. 5-9, the critical root locus is the circled one with a resonance frequency of f res _ grid - f syn _ grid . Due to the high magnitude at the resonance frequency, the controller bandwidth is confined to a few Hertz (4Hz in Fig. 5-10). Because of the stiff grid assumption, the grid-side dc-link current control can employ the same control structure and the controller performance is consistent in the full operating range. However, the dynamic performance is still not very satisfactory.
Imaginary Axis 0.18 2500 0.25 2000 0.34 1500 2e+003 1.5e+00 3
Critical root loci: f res _ grid - f syn _ grid 1e+003

0.12

0.075

0.035 2.5e+003

1000 0.5

500 0.75

500

0 -600 -500 -400 -300 -200 -100

0 Real Axis

Fig. 5-9 Root locus plot of grid-side dc-link current controller with compensation.

116

Magnitude (dB) 80 60 40 20 0 Frequency: 4 Hz -20 -40 -60 -80 -100 10-3 10-2 10-1 100 101 102 Frequency (Hz)

Fig. 5-10 Magnitude plot of open-loop transfer function Gc_gridKgridGgridHf_grid.

Even with a controller bandwidth of only 4Hz, the magnitude of the highest LC resonance is around 16dB in Fig. 5-10, which is still far above zero. Although the theoretical analysis indicates stable operation in this case, the real system may not be able to suppress this resonance effectively. Since the device switching frequency is around 540~600Hz and the sampling frequency is 1080Hz, the frequency range that the controller can operate properly is much lower than 1080Hz, which means some of the high-frequency resonances might be out of the control capability and should be damped by other methods. It was demonstrated that employing passive or active damping techniques [40, 70, 71] can lower the magnitudes of resonant peaks. The following subsection will discuss the use of damping to reduce the magnitudes at resonance frequencies and to further increase the bandwidth of the dc-link current controller.

5.2.3 Improvement of dc-link current control
To simplify the analysis, this section incorporates passive damping with adequate resistors parallel connected to ac capacitors on both sides. In practice, active damping can be implemented equivalently to realize a set of virtual resistors in parallel with the capacitors. Fig. 5-11 to Fig. 5-13 provide the corresponding controller design of the system with high resistance for passive damping. It is observed that all the root loci move further to the left side of the complex plane. 117

As a consequence, the high peaks at resonance frequencies are substantially reduced, as shown in Fig. 5-12. PI compensator parameters can be easily designed to obtain larger control loop bandwidth (around 22Hz in Fig. 5-13(b)) while maintaining enough attenuation of the resonances. The small-signal step response of idc from the rated value of 416A to 436.8A (5% step), as shown in Fig. 5-13, is essentially improved with the desired value reached in 0.05s and an overshoot around 20%. This step response waveform is obtained based on the control loop transfer function. Fig. 5-13 also provides the curve of a larger dc-link current step (25% of rated value) response for later comparison with the simulation and experiment waveforms. Since the system is not highly non-linear, both the large and small step responses deducted from the transfer function have the same shape.
Imaginary Axis 0.18 2500 0.25 2000 0.34 1500 2e+003 1.5e+00 3 1e+003

0.12

0.075

0.035 2.5e+00 3

1000 0.5

500 0.75

500

0 -600 -500 -400 -300 -200 -100

0 Real Axis

Fig. 5-11 Root locus plot of grid-side dc-link current controller with damping.

From the foregoing discussion, it can be concluded that the damping technique greatly improves the dynamic response of the grid-side dc-link current control. However, the conclusion does not hold true if similar damping is applied to case (a) described in Fig. 5-4 to Fig. 5-6 when generator-side dc-link current control is employed, because in this case, the low-frequency resonance mode related to moment of inertia is the primary factor that influences the controller bandwidth. In general, dc-link current controlled by the grid-side converter demonstrates simpler 118

controller design and better overall performance than that by the generator-side converter. Therefore, the grid-side dc-link current control is used for practical implementation.
Magnitude (dB) 80 60 40 20 0 Frequency: 22 Hz -20 -40 -60 -80 -100 10-3 10-2 10-1 100 101 102 Frequency (Hz)

Fig. 5-12 Magnitude plot of open-loop transfer function Gc_gridKgridGgridHf_grid with damping.

dc-link current step response (A) 600

550 520 A (25% step) 500

450 416A rated current 400

436.8 A (5% step)

350

-0.1

-0.05

0

0.05

0.1

0.15 Time (s)

Fig. 5-13 Step response of the dc-link current controlled by the grid-side converter with damping.

119

5.2.4 Simulation and experimental verification
To verify the theoretical analysis of the dc-link current dynamic performance, simulation of a 1.56MW/3000V WECS and experiment on a low-power prototype (Experimental Setup 1 in Appendix A) have been carried out with the dc-link current controlled by the grid-side converter. Both systems include the same amount of damping resistors. In addition, the simulation and experiment systems involve additional filters and top/bottom limits for system variables, which largely affect the waveforms and dynamic performances. In order to simulate the same step response as that derived from the transfer function, the dc-link current reference is set higher than its minimum required value so that the modulation index of the grid-side converter will not exceed the range of [0,1] during transients. Fig. 5-14 shows the simulated waveform of a dc-link current step response from 416A to 520A at 1.5s. Before the reference step-up, the system is running at the rated condition, same as the quiescent point selected for analysis in Fig. 5-13. A larger current step (25% of rated dc current) is chosen here to better demonstrate the result. It takes around 0.05s for the dc-link current to trace the new reference and the transient overshoot is about 20%, which verifies the step response waveform in Fig. 5-13.
dc-link current step response (A) 600

550 520 A 500

450 416 A 400 idc reference step from 416A to 520A

350

1.4

1.45

1.5

1.55

1.6

1.65 Time (s)

Fig. 5-14 Simulated waveform of dc-link current step response.

120

15A

12A idc reference step from 12A to 15A

Fig. 5-15 Experimental waveform of dc-link current step response.

Similar dynamic response can be observed from the experimental waveform shown in Fig. 5-15, in which a dc-link current reference step-up from 12A to 15A is commanded. The measured current waveform proves the fast response of the controller (around 20% overshoot and less than 0.05s to reach new steady-state value). In this section, dc-link current control methods by the generator- and grid-side converters are compared. It can be concluded that the generator-side controller design is highly dependent on the power-speed characteristics of the wind turbine, and the resultant controller performance at different operating points varies significantly from one to another. Certain restrictions and complex controller design need to be developed to ensure proper operation. Grid-side controller, on the contrary, exhibits better dynamic response and is able to achieve a more stable operation over a wide range. Passive damping is employed in the system to improve the bandwidth of the grid-side controller. With verification by simulation and experimental results, the grid-side approach is chosen to regulate the dc-link current.

5.3 Grid-side control
The control objectives of the grid-side converter are now established as to regulate the dclink current and to manipulate the reactive power output to the grid. With the grid assumed stiff,

121

the controller is developed based on grid voltage oriented control, such that the d-axis of the synchronous reference frame is aligned with the grid voltage vector. The control structure is shown in Fig. 5-16. Grid voltage phase-locked loop (PLL) is employed to obtain a noise free synchronous angle v and the angular frequency s . The controller is composed of two independent control loops for real power and reactive power regulation, respectively.
ig vg iwr

PMSG

ig

Cr

icr

Generator-side Converter

idc

Ldc
idc

Grid-side Converter

iwi vci is Ci
ici

Ls

vs

is

Grid

g

(5 - 4)

Pg
(5 - 3)

Gatings
* vdci

i

* dc

-1

Po*

(5 - 5)

* iwid

2 2 id + iq idc

mi

PLL

* Qo

(5 - 6)

i

* sq

i isq

* wiq

tan -1 (iq id )

i

CSC MS-SVM

v
vsd

abc dq

isd isq

s Ci vsd

Fig. 5-16 Block diagram of the grid-side converter control.

5.3.1 dc-link current control
For better dynamic performance, the dc-link current is controlled by the grid-side converter. The value of the dc-link current is affected by both generator- and grid-side LC parameters and the operating point of the system. Each side has its own minimum dc-link current requirement, and the larger one is chosen as the reference for the control system. According to the derivation in Chapter 4, grid-side operation generally requires larger dc-link current in order to supply reactive current to the ac capacitor and to maintain unity power factor at the grid connection point. The dc-link current can be calculated according to the grid-side active power output, which equals to the generator output power Pg* in steady state.

I =
* dc

(1 -  L C )
2 s s i

2

 Pg*   1.5v sd 

  Pg* Rs 2 2 + s Ci  vsd +    1.5vsd  

2

   

2

(5-3)

122

To derive the power information from the generator side, the generator terminal currents are measured. The corresponding generator output power can be calculated from estimated generator torque and measured speed.
* * Pg* = Teg g / P = 1.5 f igq g

(5-4)

* According to (5-1), the output of the dc-link current regulator gives the reference for vdci .
* This vdci , when multiplied by idc feedback, represents the real power reference Po* for the grid-

side converter. By substituting (4-69) into (4-75), the required d-axis current of the grid-side converter is, i
* wid

Po* = (1 -  Ls Ci ) vsd
2 s

(5-5)

Based on the controller diagram in Fig. 5-16, the dc-link current control loop can be summarized as shown in Fig. 5-17. The structure is similar to that given in Fig. 5-8, except that the dc-link current regulator outputs reference for vdci instead of isd . The change allows the same set of PI parameters to perform consistently over a wide range of load conditions. Combine the
* * * equations Po* = vdci idc , iwid = mid idc , and (5-5), we can derive K idc ( s ) = - (1 - s2 Ls Ci ) vsd , which

is a constant for a stiff grid. In summary, the transfer functions for Gidc ( s ) , K idc ( s ) , and

H

f _ idc

(s)

in Fig. 5-17 are,

  2 f c _ idc  Gc _ idc ( s ) = k p _ idc × 1 +  s     2  K idc ( s ) = - (1 - s Ls Ci ) vsd  2 × 500 H f _ idc ( s ) =  s + 2 × 500 

(5-6)

Gidc ( s ) and H f _ idc ( s ) are exactly the same as Ggrid ( s ) and H f _ grid ( s ) in Section 5.2.2. Therefore, the root locus plot of the controller should be the same as that in Fig. 5-11. It's a minimum phase system since no zero lies in the RHP. Bode plot can be employed to design the PI parameters.

123

* idc (s)

idc ( s )

Gc _ idc ( s )

* -vdci (s)

K idc ( s )

* mid (s)

Gidc ( s )

idc ( s )

 (s) idc
H f _ idc ( s )

Fig. 5-17 Block diagram of dc-link current control loop.

The Bode plot of the open-loop transfer function considering only K idc ( s ) , Gidc ( s ) and
H
f _ idc

(s)

is given in Fig. 5-18. Three operating points at rated, half and almost zero wind

speeds corresponding respectively to 1pu, 0.125pu and almost 0pu load are plotted. The frequency of the lowest-frequency resonance mode f res1 increases with the operating speed and load, and reaches about 2.35Hz at rated condition.

vwind = 0.01 pu

vwind = 0.5 pu

vwind = 1 pu

vwind = 1 pu
vwind = 0.01 pu

vwind = 0.5 pu

Fig. 5-18 Bode plot of dc-link current open-loop transfer function without compensation.

124

The desired bandwidth for the dc-link current regulator is set to around 20Hz for good dynamic performance while not magnifying the resonance-frequency components. The design of the PI regulator parameters should ensure enough gain to reduce the steady-state error and damp the lowest-frequency resonance mode. In view of this, the higher the corner frequency f c _ idc is, the better performance the response will have. In the meantime, the PI regulator results in -90º phase angle shift at frequencies lower than f c _ idc . The phase angle of K idc ( s ) Gidc ( s ) H f _ idc ( s ) at 20Hz is around -90º and should avoid large angle shifting to allow enough phase margin at the crossover frequency. From this point of view, f c _ idc should be lower than 20Hz. Based on the above considerations, f c _ idc is chosen to be 10Hz. The proportional gain k p _ idc is then selected such that the crossover frequency is around 20Hz.
Magnitude (dB)
vwind = 0.01 pu

200 150 100 50 0 -50 -100 -150

vwind = 0.5 pu

Bandwidth: 22~31Hz
vwind = 1 pu

Phase (deg) 90 45 v = 1 pu vwind = 0.5 pu wind 0 -45 -90 -135 vwind = 0.01 pu -180 -225 -270 -4 -2 0 10 10 10

Phase margin: >60o 10
2

Frequency (Hz)

Fig. 5-19 Bode plot of dc-link current open-loop transfer function with compensation.

Fig. 5-19 shows the Bode plot of the open loop transfer function with consideration of the PI regulator. Low frequency gain varies with the load, resulting in different steady-state errors. The magnitude plots at higher frequencies are similar and the bandwidths remain close for all the 125

three cases. Phase margins for all the three cases are above 60º. The selected PI regulator is able to ensure stable and fast dynamic performance in the full range. Note that both Bode plots in Fig. 5-18 and Fig. 5-19 incorporate small passive damping resistors in order to suppress the magnitudes of the LC resonances. In real application, this is not acceptable and the damping resistors should be replaced by active damping methods or other measures. In the following simulation and experiment, the magnitudes of the resonances are heavily damped by employing high-order low pass filter. However, the filter process will also affect the magnitude and phase angle of the operating-frequency component and lead to system instability. Magnitude and phase compensation of the operating-frequency components is also implemented in the controller to retain the system in stable operation.

5.3.2 Grid-side reactive power control
With the aligned synchronous frame, the grid voltage has only d-axis component vsd while qaxis component vsq equals to zero. The grid reactive power can be independently controlled by regulating the grid q-axis current,
* isq =- * Qo 1.5vsd

(5-7)

According to (4-74), the reference q-axis current of the grid-side converter is,
* * * iwiq = s Rs Ci isd + (1 - s2 Ls Ci )isq + s Ci vsd

(5-8)

In practice, Rs is unknown and there might be inaccuracy of other system parameters (e.g.
Ci or Li ). The reactive power regulator is therefore necessary to ensure desired PF control

insensitive to system parameters. The term s Ci vsd is added as a feed-forward item to directly compensate the capacitor current in the controller. The grid-side reactive current control loop is provided in Fig. 5-20. The transfer functions of
K isq ( s ) , Gisq ( s ) and H f _ isq ( s ) can be derived similarly to those in the dc-link current loop.

Hence,

126

  2 f c _ isq  Gc _ isq ( s ) = k p _ isq × 1 +  s    *  miq 1   K isq ( s ) = * = iwiq idc   2 × 500  H f _ isq ( s ) = s + 2 × 500  
* isq (s)

(5-9)

isq ( s )

Gc _ isq ( s )

* iwiq (s)

K isq ( s )

* miq (s)

Gisq ( s )

isq ( s )

 (s) isq
H f _ isq ( s )

Fig. 5-20 Block diagram of grid reactive current control loop.

vwind = 0.01 pu

vwind = 0.5 pu

vwind = 1 pu

vwind = 0.5 pu

vwind = 1 pu

vwind = 0.01 pu

Fig. 5-21 Bode plot of grid reactive current open-loop transfer function without compensation.

127

The grid-side reactive current controller design can also be evaluated through Bode plot since all the zeros and poles of Gisq ( s ) are in LHP. The Bode plot of the open-loop transfer function without PI compensator is given in Fig. 5-21. The bandwidth of the control loop is designed to be around 1/10 of that of the dc-link current loop, which is 2~3Hz. The phase angle of the open loop transfer function without compensator at the frequency of 2~3Hz is in the range of -40º to 0º and thereby has no concern regarding phase margin. The corner frequency is therefore designed as high as possible to obtain dc gain without amplifying the resonance components. The final design of the controller with compensation is shown in Fig. 5-22. The corner frequency and proportional gain of the PI regulator are chosen as 50Hz and 0.05, respectively. As a result, the controller bandwidth is 2.6Hz. The controller performance is consistent throughout the full range of wind speed and load.

vwind = 0.01 pu

vwind = 0.5 pu

vwind = 1 pu

vwind = 0.5 pu

vwind = 1 pu

vwind = 0.01 pu

Fig. 5-22 Bode plot of grid reactive current open-loop transfer function with compensation.

5.4 Generator-side control
The generator-side control scheme based on generator rotor flux oriented synchronous frame is shown in Fig. 5-23. Two control functions, one to extract maximum power available from the 128

wind turbine and the other to optimize generator operation, are implemented in the generatorside controller. The speed regulator receives speed commands from a top-level MPPT algorithm.
* * Its output gives reference to the torque producing current igq . d-axis generator current, igd , is set

according to the generator operation requirements. Capacitor currents are subtracted from the generator currents to obtain the converter current references. According to the steady-state calculation in Chapter 4, they are
* *2 * * * *2  icrd = g Ld Cr igd + g Rg Cr gq - g Cr f * * * *2 *  icrq = - g Rg Cr igd + g Lq Cr igq

(5-10)

ig

vg iwr
icr

idc
Ldc

iwi vci is

vs
Ls

g

Cr

Ci
idc
2 2 id + iq idc

ici

vwind



* g

g

i

* gq

i i i
* crq * crd

* wrq

mr

g

(5 - 10)
* igd

* iwrd

tan -1 (iq id )

r

Fig. 5-23 Block diagram of the generator-side converter control.

5.4.1 Generator speed control
The generator speed control loop is generally designed to be much slower than the dc-link current loop so that it can be decoupled from the grid-side converter control loops. In view of this, the design of the generator speed control loop does not take account of the grid-side dynamics based on the assumption that the dc-link current is well controlled by the grid-side converter. The structure of the speed control loop is exactly the same as that described in Section 4.4.2. Hence, only observations and conclusions for the design are discussed here. Calculation of the control plant transfer function indicates a large zero in the RHP. Therefore, Bode diagram analysis is not sufficient to validate the controller design. Root locus plot has to be incorporated for stability evaluation.

129

Imaginary axis (x 1010) 0.9 0.66 1 0.945

0.5

0.99

0 2.5e+010 1.5e+010 5e+009

-0.5

0.99

-1 0.945 0.9 -3 -2

0.66 -1 0 1 Real axis (x 1010)

Fig. 5-24 Root locus plot of generator speed control loop.

Magnitude (dB) 200 100 0 -100 -200 -300 Phase (deg) 270 180 90 0 -90 -180 -270 10
-4

vwind = 0.01 pu
vwind = 0.5 pu vwind = 1 pu

Bandwidth: 2.2 Hz

vwind = 0.01 pu

vwind = 1 pu

vwind = 0.5 pu

10

-2

10

0

10

2

Frequency (Hz)

Fig. 5-25 Bode plot of generator speed open-loop transfer function with compensation.

130

Fig. 5-24 and Fig. 5-25 show the root locus and Bode plots of the speed control loop, respectively. In Fig. 5-24, the critical root loci are the complex conjugate roots located near the origin of the s-plane. This pair of roots represents the transient performance of the system. The corner frequency and proportional gain of the PI regulator are selected to avoid large speed overshoot. The final bandwidth of the speed loop is selected to be around 2.2Hz, which is kept almost constant with different wind speeds, as can be seen in the magnitude plot in Fig. 5-25. Root locus analysis also verifies stable operations at the three different wind speeds.

5.4.2 Optimized generator operation
* The reactive component of the generator current igd can have options as stated in Chapter 2.

Among them, the zero d-axis current option offers the minimum generator and converter current ratings. Since the dc-link is normally decided by the grid-side operation requirement, the
* . Generator current is converter conduction loss will not be changed by the choice of igd * to zero and leaving only torque producing current in the windings. The minimized by setting igd * = 0 is option is simple and straightforward for control system design. As shown in Fig. 5-23, igd

given directly to the controller and used for calculation of the capacitor currents and converter PWM currents. No regulator is involved in this case.

5.5 Power feed-forward to improve dynamic performance
In the control system designed in the previous section, the dc-link current is regulated by the grid-side converter. The power disturbances of the generator output, mainly due to the fluctuations in the wind speed, are not simultaneously reflected in the grid-side converter control. Unlike VSC based WECS where a large dc-link capacitor (4pu or even higher) is normally used, the dc-link inductance in a high-power CSC based system is typically around 1pu or less and implies a smaller energy storage capability. Additionally, since the minimum operating dc-link current is one of the desired control objectives, the energy storage in the dc link is further reduced. It is therefore very likely that power fluctuations from the wind turbine and lag in gridside control reaction will cause significant variations in the dc-link current and, in worst cases, trigger the system over-current protection. In view of this situation, power feed-forward is adopted to improve the dc-link current control performance. The power feed-forward requires 131

the instantaneous generator output power be sensed and fed forward to the grid-side dc-link current controller. The power disturbance from the generator side will directly adjust the controller output of the grid-side converter, which can greatly improve the system dynamic performance and ensure stable dc-link current operation. Fig. 5-26 illustrates the power feed-forward strategy for compensating the power fluctuation from the input energy. In the conventional control system, the dc-link current regulator directly gives the reference of the grid-side real power. By using generator power feed-forward method, the reference of the grid-side real power is obtained by subtracting the required instantaneous power in the dc link from the generator power. The power difference between the two sides of
* the dc-link inductor is represented by Pdc , which comprises the energy stored in the dc link, dc-

link conduction loss and converter losses. The losses are treated as disturbances to the control system and can be compensated by the dc-link current regulator.
idc
* idc
* vLdc * Pdc

Po*

Pg

Fig. 5-26 dc-link current regulator with generator power feed-forward.

5.6 Simulation verification
5.6.1 Simulation system setup
The control strategies for the CSC-PMSG-WECS are simulated in Matlab/Simulink for a 1.56MW WECS. System parameters are listed in Appendix A. A wind turbine model is incorporated to simulate the aerodynamics of the wind turbine. The model takes the information of the wind speed and actual generator speed, and outputs the optimum generator speed reference for the converter system to track the maximum power point. Moreover, it also calculates the mechanical torque applied to the machine according to its power and torque curves. Note that the inertia constant of the turbine and generator in a large WECS is normally about a few seconds. In

132

this simulation, it is reduced to 1s to shorten the simulation time. Therefore, the speed response in the simulation is faster than that in the real system. The simulation results are provided in Fig. 5-27 to Fig. 5-31. In order to simulate the transient response of the proposed control system, a step-down from 12.5m/s to 10m/s at 2s and a step-up from 10m/s to 12.5m/s at 5s are applied to the wind speed.

5.6.2 Power flow control
The waveforms showing the power flow of the system are given in Fig. 5-27. At 2s, the wind speed step-down leads to reduced mechanical torque and generator speed reference. The waveforms show that the real generator speed reacts to the lowered speed reference while the controller increases the produced electrical torque. In the meantime, the reduced mechanical torque also helps to slow down the generator. Consequently, the real generator speed decreases rapidly. A slightly large overshoot can be seen. In order to avoid the large transients, a speed reference ramp function is applied. Similar process takes place when the wind speed steps up at 5s. After the transients, the real speed follows the reference speed well in steady state. The transient of grid-side real power is shown in the second subfigure in Fig. 5-27. At 2s when the wind speed steps down, the speed regulator gives the command for electrical torque to increase to slow down the generator. The increase of electrical torque leads to higher generator output power and hence higher dc-link current reference at the very beginning of the transient. Then, as the generator speed drops, the real power and dc-link current decrease as well. On the contrary, during wind speed step-up transient, the electrical torque is reduced first for faster speed regulation. The minimum torque reference is set to zero rather than negative to avoid motor operation mode in which converter will draw real power from the grid. As a result, the output real power drops to almost zero at the beginning of the generator speeding up period for obtaining the maximum speed rising rate. As the speed goes up, the output power rises accordingly and settles down to the steady-state value. The grid reactive power in Fig. 5-27 is maintained at zero all along and unity power factor is kept regardless of the amount of real power. In Fig. 5-27, speed regulation has the priority so as to track the maximum power point as fast as possible. The fast tracking of generator speed results in large variations in the electrical torque and thereby the output real power during transients, which is unfavorable for the grid side where 133

smooth output power is required. Several methods, such as speed ramp or power limit, can be applied to limit the power transients at the cost of slower speed regulation.
 g ( pu )
1.2 1 0.8 0.6 1 2
* g

g
3 4 5 6 7 Time(s)
Po × 106 (W )

2 1 0 -1 1 2 3 4 5 6 7 Time(s)
Qo × 106 (VA)

2 1 0 -1 1 2 3 4 5 6 7 Time(s)

Fig. 5-27 Power flow control response to wind speed step changes.

To demonstrate the capability of smooth output power control, Fig. 5-28 provides another set of waveforms by further decreasing the variation rate of the speed reference and slowing down the speed regulator. Consequently, during the same wind speed changes, the generator speed undershoot or overshoot and the grid power surges presented in Fig. 5-27 are substantially reduced in Fig. 5-28.

134

 g ( pu )
1.2 1 0.8 0.6 1
6
* g

g
2 3 4 5 6 7 Time(s)

Po × 10 (W )

2 1 0 -1 1 2 1 0 -1 1 2 3 4 5 6 7 Time(s) 2 3 4 5 6 7 Time(s)
Qo × 106 (VA)

Fig. 5-28 Generator speed and grid output power responses with slower speed regulation.

5.6.3 Minimum dc-link current control
The dc-link current controller responses to the wind speed step changes are shown in Fig. 5-29 for the same case as that of Fig. 5-27. The real power output curve in Fig. 5-27 indicates that the output power is reduced to almost half of rated when wind speed is only decreased by 1/5 (from 12.5m/s to 10m/s). The large power variation makes minimum dc-link current control significant for system efficiency improvement. As displayed in Fig. 5-29, the dc-link current is decreased from around 400A to 270A due to the change in system active power flow. The dclink current is minimized in steady state when the modulation index of grid-side converter is automatically tuned to 1. During transients, the modulation index can be lowered to ensure fast response. The delay angle of the grid-side converter in Fig. 5-29 is adjusted accordingly to maintain unity power factor operation. 135

idc ( A)

600 400 200 0 1
mi

2

3

4

5

6

7 Time(s)

1

0.5 0 1 2 3 4 5 6 7 Time(s)

 i (rad )
2 1.5 1 0.5 0 1 2 3 4 5 6 7 Time(s)

Fig. 5-29 Minimum dc-link current control at different wind speeds.

The transients in the dc-link current control can also be mitigated by the same method as applied to smooth active power in Fig. 5-28. As the speed regulator slows down its response to wind speed change, the variation rates of the generator electrical torque and power are lowered. Consequently, the dc-link current reference calculated based on the generated power is also smoothed. This is reflected in the moderate response of the grid-side control variables mi and  i , as shown in Fig. 5-30.

5.6.4 Grid voltage and current waveforms
The grid-side line voltage and current at the rated condition for unity power factor operation are provided in Fig. 5-31. The waveforms show that the grid-side current are controlled to be in phase with the voltage, which means unity power factor is achieved.

136

idc ( A)

mi

 i (rad )

Fig. 5-30 Minimum dc-link current and grid-side converter response with slower speed regulation.
vsa , isa ( pu )

2
vsa

1

0
isa

-1

-2 7.2 7.21 7.22 7.23 7.24 7.25 Time (s)

Fig. 5-31 Steady-state grid-side waveforms at rated condition for unity power factor operation.

137

5.7 Experimental verification
5.7.1 Experimental setup
Experimental verification for the control system of the CSC-PMSG-WECS is conducted on a GTO based low-power prototype setup. Detailed system parameters are listed as in the Experimental Setup 1 in Appendix A. All the control functions are implemented on a DSPFPGA based platform. The prime mover of the setup is a permanent magnet synchronous machine controlled in torque producing mode according to the given torque reference, regardless of the generator speed. This is different from the wind turbine model used in simulation, whose mechanical torque varies according to the wind speed and generator speed changes. The experimental results obtained from the prototype are shown in Fig. 5-32 to Fig. 5-34. In Fig. 5-32 and Fig. 5-33, t1 denotes the instant when the controller is given a speed reference step from 1800rpm to 1350rpm while the mechanical torque provided by the prime mover has a step down from 1pu to 0.65pu. t2 is the instant when the speed reference and mechanical torque step up back to the original levels.

5.7.2 Power flow control
The power flow control performance of the CSC-PMSG-WECS is demonstrated in Fig. 5-32. A speed reference ramp and a slow speed regulator are employed in the experiment to ensure smooth power output of the generator. The speed traces the speed reference in steady state and no large speed overshoot is observed. The active and reactive power outputs are displayed for different generator speeds. It is verified that zero reactive power is maintained in both operating conditions while the real power changes significantly with the step changes in the speed and mechanical torque references.

5.7.3 Minimum dc-link current control
Fig. 5-33 shows the responses of the dc-link current and the grid-side converter modulation index and delay angle. The modulation index of grid-side converter is, as expected, kept at almost unity in steady state to reduce the total system loss. As the active power decreases, the minimum dc-link current is obtained while the modulation index is still kept at almost unity. In

138

order to maintain grid-side unity power factor, the converter delay angle is changed accordingly to compensate the reactive power generated by the filter capacitors.
 g (rpm)
2000 1500 1000 500 0
t1

t2

Time: 1s/div

Po (W )

1500 1000 500 0
t1 t2

Time: 1s/div

Qo (VA)

1500 1000 500 0
t1

t2

Time: 1s/div

Fig. 5-32 Experimental waveforms of power flow control.

5.7.4 Grid voltage and current waveforms
The steady-state line-to-line voltage and line current waveforms of the grid are shown in Fig. 5-34. It can be observed that the grid-side line current ia lags line-to-line voltage vs _ ab by around 30º, which verifies the unity power factor operation.

139

idc ( A)

12 10 8 6
t1

t2

Time: 1s/div

mi

1

0.5 0
t1 t2

Time: 1s/div

 i (rad )
0.8 0.6 0.4 0.2 0
t1
t2

Time: 1s/div

Fig. 5-33 Experimental waveforms of minimum dc-link current control.

vs _ ab

ia

0

Fig. 5-34 Steady-state experimental waveforms of grid line-to-line voltage and line current.

140

5.7.5 Power feed-forward control performance
To validate the effect of the power feed-forward method on the control of dc-link current and system dynamics, a comparison of system control with and without power feed-forward is conducted in experiment. The results are shown in Fig. 5-35 and Fig. 5-36. The dc-link current is kept constant in the experiment for better demonstration of the effect. In Fig. 5-35, only mechanical torque steps are applied to the system. The torque steps down from 1pu to 0.65pu at t1 and steps up back to 1pu at t2 . It is shown in Channel 1 of Fig. 5-35 that during transients, the dc-link current varies accordingly as the torque changes when there is no power feed-forward. Channel 2 in Fig. 5-35 illustrates that the dc-link current is kept almost constant with power feed-forward being applied.

Ch1

0A

Ch2

0A
t1 t2

Fig. 5-35 Experimental waveforms of dc-link current response to mechanical torque step changes; Ch1- Without feed-forward; Ch2- With power feed-forward.

Fig. 5-36 shows a worse case when both speed reference and mechanical torque step down at t1 and step up at t2 . No speed ramp is used in this experiment for better demonstration of the power feed-forward effect. The step changes in the speed reference and mechanical torque are the same as those in Fig. 5-32 and Fig. 5-33. When the step-ups take place, the generator electrical torque is reduced first to allow the speed to be gradually increased. Once the speed 141

approaches the reference, the electrical torque will increase to match the mechanical torque for constant speed operation. It is evident in Channel 1 of Fig. 5-36 that, without power feed-forward, the fast speed regulation invokes large variations in the dc-link current during the period of references step-up. The large dc-link current variation triggers the system over-current protection shortly after t2 . With power feed-forward method used, the dc-link current exhibits a much better waveform during the transient, as can be seen from Channel 2 of Fig. 5-36.

t1

t2

Fig. 5-36 Experimental waveforms of dc-link current response to the step changes in both mechanical torque and generator speed; Ch1- Without feed-forward; Ch2- With power feed-forward.

5.8 Conclusions
In this chapter, the overall control system for the proposed CSC-PMSG-WECS is developed. The main conclusions are given as follows. The design of the dc-link current control is identified as the most critical element for system dynamic performance and stable operation. The study of two possible dc-link current control methods is carried out by comparing the control system design, controller bandwidth and limiting factors of the stability. Grid-side control method is chosen to obtain better overall performance. Improved methods by damping the resonance frequency components are

142

demonstrated to be able to increase the system dynamic performance. Simulation and experimental results are provided to support the analysis. The control structures for grid- and generator-side converter are summarized following the selection of dc-link current control method. Theoretical analysis and compensator design of the control loops for dc-link current, grid reactive current and generator speed are elaborated. The overall control strategy is developed in this chapter for independent active and reactive power control while maximum power is extracted from wind. The proposed control system decouples the active power and reactive power control through FOC and VOC for the generator and grid side, respectively. In particular, the dc-link current is minimized in steady state to reduce the device switching and conduction losses for maximizing the overall efficiency. Generator power feed-forward method is employed to ensure stable dc-link current regulation and therefore improves the system dynamic performance. The proposed control scheme is verified in simulation on a medium-voltage megawatt WECS and in experiment on a low-voltage prototype system. The main features of the power flow control, minimum dc-link current control, unity power factor control, and power feed-forward control are all verified by simulation and experimental results.

143

Chapter 6 Unified DC-Link Current Controller for Grid Low-Voltage Ride-Through
Due to increased wind energy penetration, utility operators are facing challenges to ensure the reliability and quality of the power system. Grid connection codes have been developed for distributed generators including wind power generators [72, 73]. The fault ride-through capability of a wind energy conversion system (WECS) is of particular concern because the disconnection of a large wind generator caused by network disturbances may lead to system instability and cascaded failures. Other typical requirements such as active and reactive power regulation based on the system voltage and frequency are also specified in the codes. All these requirements significantly affect the design of power converter and controller for a modern WECS. The main objective of this chapter is to address the grid integration issues, mainly lowvoltage ride-through (LVRT) requirement, for the CSC-PMSG-WECS developed in the previous chapters. Grid connection codes and major challenges for grid-tied large WECS are reviewed first. A unified dc-link current control scheme is then proposed to satisfy the LVRT requirements. Detailed implementation and functionality of the proposed control scheme are explained. The performance is verified with both simulation and experimental results.

6.1 Grid integration requirements for WECS
To date, power system operators in Denmark, Germany, USA, Canada and other countries have issued dedicated grid codes for wind turbines/farms connected to the transmission or distribution systems. Most of these connection codes focus on distributed generators including wind turbines and wind farms connected to distribution systems. The design of wind power systems to satisfy the grid codes, to some extent, is a comprehensive task at wind farm level. However, recent developments in wind energy industry reflect a strong trend towards designing 144

large wind turbine units to satisfy the grid codes independently, such that the requirements of additional components in the wind farm can be reduced. Moreover, direct connection of large wind turbines to the distribution/transmission system is thereby made possible.

6.1.1 General requirements
The existing grid codes vary in their defined scopes and detailed specifications, but focus in common on power controllability, power quality and fault ride-through (FRT) capability. The following summarizes a few typical items. Note that all the requirements are referred to the point of common coupling (PCC) located at the high voltage side of the grid interfaced transformer. 1) Active power control. This requirement refers to the ability of wind power generation systems to regulate their power outputs to any defined level within the maximum power that can be extracted from the wind. To avoid large power transients under normal operation and to ensure in-time reestablishment of generated power after a fault, the acceptable changing rate of wind power is normally defined in the codes by ramp-rate limitations. In addition, wind power generation systems are required to assist power system frequency regulation by adjusting their active power outputs. 2) Reactive power control. In general, the grid codes demand that the output power factor of the wind power generation system is limited to a certain range under normal operations. Furthermore, continuous voltage control as practiced by conventional synchronous generators is also required. This is achieved by feeding or absorbing reactive current during voltage sags and swells. 3) Voltage and frequency operating limits. Grid codes also specify voltage and frequency variation limits within which the wind power generation systems should remain continuous operation. If voltage and frequency excursions exceed the normal range, wind power generation system should remain in operation for a limited period and in some cases at a reduced output power level. Fast automatic disconnection of the system is demanded in extreme cases. 4) Fault ride-through capability. All existing grid codes require the wind turbines/farms to have FRT capability, specifically LVRT capability, to maintain the continuity and

145

security of the power system operation. The fault types include a variety of symmetrical or unsymmetrical cases with different voltage levels and different time durations. Variable-speed wind turbines with full-rating power converters can control their power outputs either by turbine pitch angle control or generator speed control. The ac/dc/ac converter decouples power and frequency control at each side. The feature enables flexible control of the system under the allowable voltage and current ratings of the converter. The above mentioned grid code requirements in 1) - 3) can be directly translated into proper commands and references in the control system of the WECS. However, the LVRT capability of a WECS is not as straightforward as the other requirements and has attracted a great amount of attention among researchers and designers. In the following subsections, the E. ON code [72] from German power system operator is taken to describe the details of LVRT requirement as well as the challenges presented to the CSC-PMSG-WECS.

6.1.2 Low-voltage ride-through in converter based WECS
Peak line to line voltage (U/UN)

100%

WECS should remain in operation above the curve Lower voltage band

Fault occurs

0 0 0.15 1.50 Time (s)

Fig. 6-1 Grid low-voltage ride-through requirement in E. ON grid code.

A typical LVRT requirement enforced by the E. ON code is presented in Fig. 6-1. The curve in the figure illustrates the scenario that grid voltage drops to zero for 150ms due to a short-

146

circuit fault and then recovers gradually back to its lower voltage band. Grid-connected WECSs are requested to remain in operation as long as the grid voltage envelop is above the curve.

(Iq / I N )

( U / U N )

Fig. 6-2 Reactive current compensation requirement in E. ON grid code.

Another grid code requirement related to LVRT is the reactive power compensation, as shown in Fig. 6-2. The E. ON code demands the generation systems to provide reactive current during voltage dip. As it specifies, the voltage control should start functioning in the event of voltage dip below 10%, and provide leading reactive current amounting to at least 2% of the rated current for each percent of the voltage dip. When grid voltage dips below 50% of the rated value, the reactive current is confined to 100% of the rated current. Most control schemes used in drive systems are based on the assumption of a stiff grid and therefore are not able to ride through grid faults. A short-circuit grid fault or other large grid disturbances may cause the grid-side converter to lose its control capability. Unbalanced power flow at the input and output during transients can cause over-current or over-voltage in the converters and trigger the system protection. Previous research mostly focused on fault ridethrough techniques in VSC based WECSs. One of the methods is to dump the excessive energy to external resistors or energy storage systems [32, 33]. Another solution is to allow the incoming wind energy to be temporarily stored in the moment of inertia of the turbine-generator system. New control methods are also proposed to ensure proper converter operation during fault 147

conditions. [23] and [74] introduced non-linear control methods to improve the conventional current control performance, but the implementations are complex and very sensitive to system parameters. In [75], voltage and current control methods are compared. However, the suggested current control method is not suitable for CSCs. Unlike VSC, the grid voltage fault ride-through of CSC in a WECS is rarely studied in the literature. The large inductance in the dc link of a CSC has the advantage of limiting current rising rate when grid short-circuit fault happens. However, proper coordinated control should be developed to maintain the desired stable operation during the fault period. CSC has a large three-phase capacitor at its ac output which generates leading reactive current. In a certain sense, it helps support the grid voltage. However, the amount of reactive current generated by the capacitor is defined by both the grid voltage magnitude and the capacitance. When the grid voltage drops to a very low level or even zero, the capacitor can no longer provide sufficient reactive current to support grid voltage recovery. Additionally, grid voltage provides the reference angle for defining the active or reactive currents. In the case of zero grid voltage, the control system may lose tracking of the grid voltage phase angle, making it impossible to inject the needed reactive current to the grid.

6.2 Grid-integrated CSC-WECS
Generator-side converter
Pg
vLdc idc

Grid-side converter

Po Qo

Ldc
ig vcr

g
PMSG

iwr

iwi

vci ici

is

Grid integration vs  s

vdcr
icr Cr

vdci

Ci

Wind turbine controller

Generator-side converter controller

Control system

Grid-side converter controller

Grid integration supervisory system

Fig. 6-3 Configuration of the grid-integrated current source converter based WECS.

148

Fig. 6-3 shows the grid-connected CSC-PMSG-WECS along with its control system. The WECS is driven by a pitch controlled wind turbine, and is connected to the grid via a step-up transformer. The whole control system can be divided into three major parts: wind turbine pitch controller, converter controller for both generator and grid sides, and grid integration supervisory system. The aerodynamic efficiency of the wind turbine is strongly influenced by the variation of the blade pitch with respect to the wind direction or the rotating plane [76]. Small changes in pitch angle can have a dramatic effect on the output power. Also, the maximum power available at a certain wind speed can only be acquired at a corresponding turbine-generator rotating speed. Therefore, the wind turbine controller measures the wind speed and provides references to the turbine pitch and generator speed controllers for MPPT and proper protection of the turbine. Under a wind speed within the rated value, the turbine-generator system tries to produce as much power as possible, and hence the pitch angle is always kept at its optimum value. If wind speed rises to be above the rated value, the pitch control scheme starts to operate and takes over the turbine control to limit output power. The grid integration supervisory system monitors the grid voltage frequency and magnitude to detect grid events such as loss of load or any type of fault. Based on the detected information and grid code requirements, corresponding control commands of such as active/reactive power or disconnection are issued to the converter controller. The converter controller receives commands from the above two blocks and operates the system to achieve desired objectives. The controller works as described in Chapter 5 in normal operations. When a grid fault occurs, its control objective becomes to protect the system from tripping and to supply sufficient reactive current to help grid voltage recovery. The control algorithm has to be modified accordingly.

6.3 Unified dc-link current controller
Grid faults may interrupt system power flow and result in dc-link current overshoot. The overshoot can trigger system protection if no proper measures are taken. Two major concerns exist for fault ride-through of power converters: the protection of the converters and the proper control of active/reactive current to support grid voltage recovery. In CSC, the instantaneous

149

current flowing through the switching devices is equal to the dc-link current. The converter overcurrent protection will not be invoked as long as the dc-link current is kept within limit. As for providing proper active/reactive current to the grid, the dc-link current has to be kept above a minimum required value. In light of these, proper control of dc-link current is crucial for fault ride-through.

6.3.1 dc-link current controller design
The dc-link current can be controlled by either grid- or generator-side converter. As discussed in Chapter 5, it is conventionally controlled by the grid-side converter for simplified control structure and better overall performance. When grid short-circuit faults happen, energy can be hardly transferred to the grid due to the voltage drop. Meanwhile, the input power from the wind turbine and generator keeps charging the dc link if the generator-side converter is still speed or torque regulation oriented. In view of this situation, a centralized regulator is proposed to distribute the dc-link current control task onto both the grid- and generator-side controllers which, in turn, will manage the active power flow and maintain proper dc-link current coordinately.

PMSG

Generator-side converter

Grid-side converter

Grid

Converter current calculation and SVM gating generation
* igq

Converter current calculation and SVM gating generation
* isd
* isq

* igd

MPPT controller

Optimized generator operation

dc-link current controller

Reactive power controller

Generator-side controller

Grid-side controller

Unified dc-link current controller

Fig. 6-4 Simplified block diagram of the control system with the unified dc-link current controller.

150

The simplified block diagram of the unified dc-link current controller is shown in Fig. 6-4. According to the dynamic equation in (4-32), the dc-link current can be regulated by the dc voltage difference between the grid- and generator-side converters. This relation correlates the
* two converters control by dividing the dc-link current regulator output vLdc into two portions:

* * and generator-side average dc voltage reference vdcr , grid-side average dc voltage reference vdci

and can be stated as,
* * * vLdc = vdcr - vdci

(6-1)

* upon these two parts depends on the specific grid voltage level, The distribution of vLdc

converter ratings and operating conditions. To avoid motoring operation mode, the lower limit of the grid-side reference, vdci ,min , is set to zero. Assuming the loss in the grid-side converter is neglected, the upper limit can be derived based on the power calculation in (6-2), where isd ,max and Po ,max are the maximum allowable active current and power on the grid side. vdci ,max = Po ,max / idc = 1.5vsd isd ,max / idc (6-2)

The grid-side converter provides the master control for the dc-link current in this unified scheme. If the dc-link current is within the grid-side converter control capability
* *  vdci ,max ), the system works exactly as described in Chapter 5 and thus vdcr ( 0  -vLdc = 0 and
* * . At the instant when grid voltage vsd drops and the resultant vdci ,max decreases to a vdci = -vLdc

* * * > vdci ,max ), the excessive portion of -vLdc level below -vLdc ( -vLdc will be transferred to the

generator-side converter to reduce the input power from the generator. The average dc voltage
* * * * * * = vdci ,max and vdcr . The selection of vdci and vdcr values is references are now vdci = vdci + vLdc
* * and vdcr are translated to the active summarized in Fig. 6-5. In the corresponding controllers, vdci

* * and igq current references isd 2 of the grid- and generator-side converters, as shown in (6-3) and

(6-4), respectively. The losses in the converters and dc link are neglected.
* * isd = Po* / (1.5vsd ) = vdci idc / (1.5vsd ) * * * igq  f  g ) = vdcr idc / (1.5 f  g ) 2 = P g / (1.5

(6-3) (6-4)

151

* * vdci = -vLdc * vdcr =0
* -vLdc  vdci ,max ?
* vdci = vdci ,max * * * vdcr = vLdc + vdci

Fig. 6-5 Selection of the reference values for grid- and generator-side converters.

vsd

isd ,max
idc
* idc

vdci limit

vdci rate limit vdci ,max
vdci ,min

calculation

* vLdc

* vdci selection

* vdci

* vdcr

dc-link current regulator

* igq

* igq 1

* g

* igq 2

igq 2 reference

g
* vdcr

Generator-side controller

calculation

Grid-side controller

* isd

isd reference

* vdci

calculation

Fig. 6-6 Block diagram of the unified dc-link current controller.

* The torque current reference of the generator-side controller, igq , is now the difference * * between the speed regulator output igq 1 and the calculated torque current reference igq 2 . During

152

grid fault periods, the speed feedback is set to be the same as the reference, and hence the generator speed regulator output remains the same as the pre-fault value. The generator speed
* will gradually increase because of the amount of igq 2 introduced from the unified controller. The

extra energy is stored as the kinetic energy of the turbine-generator system. This is a reasonable situation, since the fault duration is normally very short and if the fault lasts longer, the system will be shutdown. The typical moment of inertia of a MW wind turbine is around 4~6s. Considering the fault ride-through requirements in E. ON grid code, the increase of the generator speed during this period would be only around 2~3% even if the system was working under rated wind turbine mechanical torque right before the fault happens. After the fault is cleared and the grid voltage recovers, vdci ,max rises. The distribution of dc* * and vdcr changes along with the variation of vdci ,max and the output link regulator output on vdci

power requirements. In response to the variation, the grid-side controller regains the control capability and resumes to output active power. A rising rate limiter is employed to avoid rapid
* * increment of vdci and to help smooth the output power. As the amount of vdcr is gradually

withdrawn, the generator speed regulator again picks up the real speed feedback and becomes the dominant factor to determine the torque producing current. The speed regulation starts to trace the reference properly. All the transitions from normal operation to fault condition or reverse are managed automatically by the proposed controller in Fig. 6-6.

6.3.2 Reactive current compensation to support grid voltage
Generation systems are required to provide reactive current to support grid voltage recovery during dips and short-circuit faults. This requirement, when reflected on the unified dc-link current controller, demands the adjustment of the dc-link current reference according to the gridside active/reactive current references. Different system operators may require different reactive power compensation ratio. The E. ON code requires the generation system to provide 2% of reactive current compensation for each 1% of voltage dip up to a maximum of 100% of reactive current. As shown in Fig. 6-2, the reactive current in this case will vary as the grid voltage dip level increases. In the meantime, the active power is determined by the available wind power, the converter rating and also the maximum allowable current at the grid connection point. Assuming the maximum steady-state 153

operating current at the grid terminal is 1pu, the reference reactive current and maximum active current can be derived as follows,

k I (V - v ) / Vb * isq =  iv b b sd Ib 

(Vb kiv < vsd  Vb ) ( 0  vsd  Vb kiv )

(6-5)

*2 isd ,max = I b2 - isq

(6-6)

where the base values I b and Vb are the magnitudes of the rated phase current and voltage, respectively. kiv represents the ratio between the required per-unit reactive current and the perunit value of grid voltage drop. For E. ON grid code, kiv = 2 .
isd ,max ( pu )

1.2 0.8 0.4 0 0 0 -0.4 -0.8 -1.2 0 1.2 0.8 0.4 0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8
vsd ( pu )

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

vsd ( pu )

* isq ( pu )

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

vsd ( pu )

idc ,min ( pu )

Fig. 6-7 Grid currents and minimum dc-link current requirements as the grid voltage changes.

154

The dc-link current reference can be derived as follows,
* * * iwid = (1 - s2 Ls Ci )isd - s Rs Ci isq * * * iwiq = s Ci (vsd + Rs isd ) + (1 - s2 Ls Ci )isq

(6-7) (6-8) (6-9)

* *2 *2 idc = iwid + iwiq / mi

The minimum operational dc-link current is obtained by setting the grid-side converter modulation index, mi , to unity in (6-9). To provide the required reactive current, the reference current for the unified dc-link current controller should be kept above the curve in Fig. 6-7.

6.3.3 Addtional features and concerns
The grid codes also specify the real power changing rate of the wind power generation systems, which can be translated into the variation rate in transferring the generated power to the grid. This requirement, when taken into account by the converter controller, can be satisfied by
* limiting the vdci ramp rate. As a result, the output power is smoothed at the expense of a lower

generator speed regulation rate. Although the unified dc-link current control scheme and the method described in Section 5.2.1 both employ the generator-side converter for dc-link current regulation, the mechanisms behind them are different. The unified control scheme is only suitable for a short duration of grid fault. In that short period of time, the generator speed is not controlled, but only increases slightly due to the large inertia of the mechanical system. The generator back-EMF, in this case, can be considered as a voltage source. Under this assumption, the adjustment of the dc-link current is straighforward by varying the corresponding torque producing current. The control structure is similar to that of the grid-side controlled method in Section 5.3. The same dc-link current PI parameters can be used. As stated earlier, if the fault is not cleared within tolerance, the WECS must be disconnected from the power system. The fault-safe braking system of the WECS will be activated to reduce the energy input and finally bring the turbine-generator to a complete stop. The proposed system features simple topology, low cost and less device stress. It eliminates the need for electronic braking in the WECS. A typical electronic braking method uses dynamic 155

braking resistors connected to the dc link, where on and off control of the resistors causes large voltage and current ripples. Instead, the proposed control method generates lower dc-link current ripple, less voltage/current stress on the dc-link inductor and switching devices. In addition to helping ride through grid faults, the proposed method can also be utilized to smooth power output while maintaining fast dynamic performance of the dc-link current control.

6.4 Simulation verification
6.4.1 Simulation setup
The proposed control strategy are simulated in Matlab/Simulink for a 1.56MW WECS as given in Appendix A. In the simulation, the PMSG is mechanically driven by a wind turbine, which receives the wind speed and generator speed information and outputs the mechanical torque according to a typical mathematical turbine model. The system parameters are listed in Appendix A. In order to shorten the simulation time, the turbine-generator inertia constant is reduced to 1s.

6.4.2 Simulation results
In the simulation, a three-phase grid short-circuit fault at 2.5s forces the grid voltage to drop from 100% to 5%. The fault lasts for 10 cycles, and then the grid voltage recovers from 5% to 100% at a slope of 300% per second. The grid voltage magnitude vsd can be found in the first curve in Fig. 6-8. Fig. 6-8 to Fig. 6-11 also demonstrate the controlled system response to the grid short-circuit fault. The active and reactive current requirements in simulation are based on the derivation in Fig. 6-7. When the fault occurs, the voltage drops down to 0.05pu and isd ,max should be limited to zero
* is thereby according to Fig. 6-7. The dc-link current regulator output for grid-side controller vdci

limited to 0V as a result of reduced vsd and isd ,max , as shown in Fig. 6-8. The surplus portion of
* * vLdc is automatically transferred to the generator-side controller input vdcr to reduce the power

obtained from the wind turbine. In response to the controller, the measured active currents at the grid side (Fig. 6-9) decreases to almost zero while reactive current climbs up close to 1pu of the rated current. When the grid voltage recovers after the fault is cleared, vdci ,max gradually increases

156

as the voltage rises and the grid-side converter regains its control capability. The system starts to output active current as soon as the grid voltage rises to 50% of the rated value.
vsd (×103 V )

4 3 2 1 0 2
* -vLdc (×103 V )

3

4

5

6

Time (s)

6 4 2 0 -2 2
v (×10 V )
* dci 3

vdci ,max

vdci ,min = 0

3

4

5

6

Time (s)

6 4 2 0 -2 2
* -vdcr (×103 V )

3

4

5

6

Time (s)

6 4 2 0 -2 2 3 4 5 6 Time (s)

Fig. 6-8 Simulated grid voltage profile and responses of controller outputs to the grid fault.

157

idc (×103 A)

1 0.5 0 -0.5 2
isd (×10 A)
3

3

4

5

6

Time (s)

1 0.5 0 -0.5 2
isq (×10 A)
3

3

4

5

6

Time (s)

0.5 0 -0.5 -1 2 3 4 5 6 Time (s)

Fig. 6-9 Simulated fault ride-through waveforms of dc-link current and grid currents.

The generator speed and the active/reactive powers on the grid side are provided in Fig. 6-10. When the fault takes place, the grid output power is substantially reduced from rated to zero. As a result of the unified control, the power extracted from the wind is stored in the generator and causes it to speed up, as shown in Fig. 6-10. During this grid low-voltage period, positive reactive power is supplied to support grid voltage recovery. When the grid voltage climbs up to 50% of the rated value, the grid side gradually reduces the reactive power and starts to output real power. The generator speed is then controlled back to the reference point where MPPT can be achieved. Because the generator inertia constant in simulation is reduced to 1s, the generator speed increases by around 15% during the whole fault ride-through process. The speed increment will be only about 3% in a real system with 5s of inertial constant.

158

 g ( pu )
1.5 1 0.5 0 2
Po (×106 W )

3

4

5

6

Time (s)

3 2 1 0 -1 2
Qo (×106 VA)

3

4

5

6

Time (s)

3 2 1 0 -1 2 3 4 5 6 Time (s)

Fig. 6-10 Simulated fault ride-through waveforms of generator speed and grid output powers.

The grid voltage and current waveforms during the grid fault period are shown in Fig. 6-11. The grid-side power factor is regulated at unity before 2.5s. When the grid voltage drops, the discharging of the converter ac capacitors causes current transient at 2.5s, which is settled down within one cycle to the rated current and is 90o apart from the grid voltage. Notice that the current direction here is defined by the generator convention, as denoted in Fig. 6-3.

159

vsa , isa ( pu )
isa vsa

1 0.5 0 -0.5 -1 fault occurs 2.4
vsa , isa ( pu )
isa

2.5

2.6

grid voltage recovers gradually 2.7 Time (s)

1 0.5 0 -0.5 -1

vsa

rated grid voltage 2.8 2.9 3 3.1 Time (s)

Fig. 6-11 Simulated grid phase voltage and current waveforms during fault.

6.5 Experimental verification
A low-power prototype of CSC-PMSG-WECS using gate-turn-off thyristors (GTOs) is employed to experimentally verify the proposed controller, as shown in Fig. A-1. The system parameters are also provided as the experimental setup 2 in Appendix A. In order to simulate the voltage drop at the grid side, the converter is connected to the utility outlet through a fault simulator and a transformer. The control of the generator-converter system and fault simulator is implemented on a DSP-FPGA based platform.

6.5.1 Grid fault simulator setup
The configuration of the grid fault simulator is given in Fig. 6-12. It constitutes several sets of three-phase inductances, among which L1 is used to limit grid-side short-circuit current, L2 simulates the grounding impedance and L3 represents the line impedance of the current source converter. The switch S1 , employing a three-phase circuit breaker, is off in normal operation; it is turned on to create a grid voltage fault at the converter terminals. 160

i1

L1 L2 i2

L3

i3

S1

Fig. 6-12 Configuration of the grid fault simulator in experiment.

6.5.2 Grid voltage phase lock loop
The grid voltage phase lock loop (PLL) is implemented by a digital PLL (DPLL) [42]. The DPLL detects grid voltage zero-crossings and adjusts the output phase angle accordingly. Generally, the method works nicely during normal operating conditions when the grid voltage has a sufficiently high magnitude. When grid short-circuit faults take place, the grid voltage drops to almost zero. During this period, the voltage zero-crossing detection is no longer valid for tracking the phase angle of the real grid voltage. Experimental testing demonstrates that the DPLL can function properly and provides desired phase angle information for the controller when the grid voltage magnitude is still above 10% of the rated value (208V line-to-line RMS). The concern about the accuracy of the zero-crossing detection and phase angle generation arises when the grid voltage drops to an even lower level. In order to maintain proper operation of the DPLL during faults, as soon as the detected voltage is below 10% of the rated magnitude, the accumulator value in the DPLL which stands for the grid voltage period is frozen. After the fault recovers, the accumulator value picks up the DPLL output again after two cycles, allowing enough time for the DPLL to be synchronized with the grid voltage. Fig. 6-13 demonstrates the DPLL performance under the extreme case where the grid voltage drops to zero. The phase angle of the grid voltage is properly maintained during the fault period.

6.5.3 Experimental results
The experimental system consists of two mechanically coupled PMSGs: one functioning as as a generator controlled by the CSC while the other working as the prime mover to provide 161

required torque. It's worth mentioning that the inertia constant of the experimental setup is much smaller than that in the simulation. Therefore, the fault duration is reduced to around 75ms in experiment to avoid over-speed of the generator.

Fault occurs 1 Fault recovers

2

t1

t2

Fig. 6-13 Grid voltage DPLL performance when grid voltage drops to zero. Time: 20ms/div; Ch1- grid voltage, 250V/div; Ch2- grid voltage phase angle from DPLL, 180 degree/div.

The experimental waveforms are provided in Fig. 6-14 to Fig. 6-17. Given that the inductances in the fault simulator are fixed ( L1 = 5mH and L2 = 1mH ), the experimental setup can only create a grid voltage step change, from 100% to 17% and then back to 100%, as shown in Channel 1 of Fig. 6-14. The corresponding controller outputs are shown in Channels 2-4. Since the grid voltage drops to below 50%, 100% of reactive current compensation is demanded
* and thus no active current should be output to the grid. vdci is limited accordingly to 0V, and the

* is thereby transferred to the generator-side controller to maintain proper whole amount of vLdc

control of the dc-link current. In response to the controller, the measured active current at the grid side (Fig. 6-15) decreases to almost zero while reactive current climbs up to about 1pu of the rated current. The generator speed climbs up since no real power is output to the grid. It can be noted that the generator does not keep accelerating during the entire fault period in Fig. 6-16.

162

This is because the prime mover will reduce its torque to maintain the speed within its speed limit of 24Hz once the machine over-speed is detected.

1

2 3

4

t1

t2

Fig. 6-14 Experimental waveforms of grid voltage magnitude and controller outputs. Time: 100ms/div; Ch1* * * grid voltage magnitude vsd , 200V/div; Ch2- -vLdc , 200V/div; Ch3- vdci , 200V/div; Ch4- -vdcr , 200V/div.

1 2

3

t1

t2

Fig. 6-15 Experimental waveforms of dc-link current and grid currents. Time: 100ms/div; Ch1- dc-link current
idc , 10A/div; Ch2- grid active current ids , 10A/div; Ch3- grid reactive current iqs , 10A/div.

163

1 2

3

t1

t2

Fig. 6-16 Experimental waveforms of generator speed and grid output powers. Time: 100ms/div; Ch1generator speed  g , 10Hz/div; Ch2- grid active power Po , 2KW/div; Ch3- grid reactive power Qo , 2KVA/div.

isa

vs_ab

1 2

t1

t2

Fig. 6-17 Experimental waveforms of grid phase current and line-to-line voltage. Time: 40ms/div; Ch1- grid phase current isa , 20A/div; Ch2- grid line-to-line voltage vs_ab , 250V/div.

After the fault, the voltage recovers from 17% to 100%. The resultant vdci ,max has a step
* starts to increase but the increase from zero to almost the rated value. In the mean time, vdci

164

speed is constrained by the rate limiter to avoid power surge at the grid. This is also reflected in grid-side active current and active power as they gradually build up, which are shown in Fig. 6-15 and Fig. 6-16, respectively. The grid line-to-line voltage and current waveforms are displayed in Fig. 6-17. Prior to the fault at t1 , the grid phase current lags the line-to-line voltage by 30° , which means unity power factor is achieved. After t1 , the current is controlled to be pure reactive, lagging the line-to-line voltage by about 120° . With the grid voltage reestablished at t2 , the phase current is regulated again to provide active current, which gradually increases to the pre-fault value in 100ms.

6.6 Conclusions
This chapter first discusses grid integration issues of the CSC-PMSG-WECS. Major grid code requirements are reviewed based on which the challenges are identified. A unified dc-link current controller is proposed to assist the system to ride through grid low-voltage faults. The unified dc-link controller utilizes the power flow control capabilities of both generator- and gridside converters during fault. Transitions between normal and fault conditions are achieved automatically in the controller by real-time monitoring of the grid voltage. The grid-side active and reactive currents are regulated to satisfy grid code requirements. The proposed method is fully integrated into the existing system controller, eliminating the need for additional ridethrough hardware components. The coordinated control of the input and output powers can also be utilized to smooth power output while maintaining fast control response of the dc-link current. The proposed control scheme is verified in both simulation and experiment.

165

Chapter 7 Conclusions
Increasing demand for megawatt wind turbines is driving the wind power converter technology towards the medium-voltage range. At this power level, current source converters offer favorable advantages and are, therefore, potential topology candidates for megawatt wind energy conversion systems (WECSs). In this dissertation, the application of current source converters (CSCs) in megawatt permanent magnet synchronous generator (PMSG) based WECSs is proposed. A comprehensive study of the proposed CSC-PMSG-WECS has been carried out. The main topics covered include: power converter topology investigation, modulation scheme development, system modeling, control system design, and grid integration solution.

7.1 Conclusions
The main contributions and conclusions of this research work are summarized as follows.
1) Feasibility investigation on the combination of PMSG and diode rectifier for WECS has been conducted.

The characteristics of a PMSG connected to a three-phase diode rectifier have been studied. Calculations of the steady-state dc-link current/voltage for wind turbine maximum power tracking are formulized and verified by simulation. It is demonstrated that the combination of PMSG and diode rectifier for a CSC based WECS is superior to its counterpart with voltage source converters. Limitations of the CSC based topology are also identified. The generator flux and synchronous inductance are found to be the major factors that affect the operating range. Simulation results have verified that the CSI based topology is able to obtain maximum power in the full range, but unity grid power factor may not be achievable under low wind speeds.
2) Various CSC topologies have been studied and compared for WECS.

166

Different CSC topologies for generator- and grid-side converters in a WECS have been studied. Three possible converter configurations, including a diode rectifier with PWM CSC, a diode rectifier with PWM CSC through a dc chopper, and a back-to-back PWM CSC, are compared in terms of converter cost, control freedom, generator current THD, generator rating, converter rating, system operating range, and dynamic performance. Comparison results show that the back-to-back PWM CSC offers flexible control capability and provides satisfying generator performance. It is, therefore, selected for detailed investigation.
3) A Multi-sampling SVM scheme for CSC has been proposed.

A new multi-sampling space vector modulation (MS-SVM) scheme is proposed to modulate PWM CSCs with low switching frequencies. The MS-SVM evolves from the conventional SVM, but overcomes the drawback of high magnitudes of low-order harmonics. The MS-SVM has superior harmonic performance comparable to the selective harmonic elimination (SHE) scheme, while retains the flexibility of variable modulation index control from SVM. The scheme is well suited for the PWM converters in the proposed CSC based wind energy conversion systems.
4) Complete system models for the CSC-PMSG-WECS have been built.

· A 10th order dynamic model is established based on defined synchronous frames on the grid- and generator-side of the system. · Equations are obtained to calculate the steady-state values of the system variables and derive minimum dc-link current requirements. · Small-signal modeling is performed to linearize the high-order nonlinear wind energy system. · Two sub-models are obtained for verification of the theoretical derivation by simulation. The comparison of the simulation results demonstrates consistency between the modeling and simulation.
5) Two dc-link current control methods are compared.

Two dc-link current control methods, one with grid-side control and the other using generator-side control, are investigated and compared. The limiting factors for each method are identified. Between the two options, the grid-side control method demonstrates simpler control

167

and better overall. It is also verified that improved performance can be achieved by proper damping methods.
6) A complete control system for CSC-PMSG-WECS has been designed.

· A minimal dc-link current control is proposed to achieve maximum overall system efficiency. · A simple but practical PI regulator is used in the synchronous frame to control the grid power factor. Decoupled active and reactive power control is realized. · The speed of the wind generator is controlled for the maximum power point tracking (MPPT) of the wind turbine. · A power feed-forward method is incorporated into the controller to ensure stable dc-link current operation and thereby improves the system dynamic performance. · Systematic analysis and design are carried out for PI parameter selection.
7) A unified dc-link current control scheme is proposed for low-voltage right-through (LVRT) of the proposed wind energy conversion system.

Without additional hardware, the proposed controller coordinates the power flow control capabilities of the generator- and grid-side converters to ride through faults. Other features, such as reactive current compensation during low-voltage period, smooth transitions from/into fault conditions and controlled output power are obtained.
8) Simulation models have been developed for verification of system operation.

· Two separate models for grid- and generator-side converters are constructed to verify the dynamic model and controller design. The step responses derived from transfer function and simulation are compared and found identical. · A complete system model, including the wind turbine, PMSG, converters, and the grid, are developed. Control algorithms are implemented in simulation. · A system model including grid low-voltage faults and the unified dc-link current controller is developed.
9) Experimental verifications on a laboratory prototype have been conducted.

168

A low-voltage experimental platform is designed. The control algorithms are coded in DSP. All the proposed modulation scheme, control system design, fault ride-through scheme and simulation results are verified experimentally. The outcome of the research work presented in this dissertation has brought several major innovations contributing to the establishment and performance improvement of current source converter based wind energy conversion systems, including: a) a new multi-sampling SVM scheme for superior steady state (harmonics) and dynamic performance; b) new system control schemes for maximum energy efficiency, simplified system design and improved dynamic performance; and c) a new unified dc-link current control scheme for reliable lower-voltage ridethrough and reactive power compensation.

7.2 Future work
The following work is suggested for future research.
1) Control of CSC-PMSG-WECS under unbalanced grid fault conditions.

Under unbalanced conditions, the grid voltage and current consist of positive, negative and zero sequence components. Conventional control methods are normally developed only for positive sequence component. Investigation of the system behavior, enhancement of the developed models and controls under unbalanced cases are also important for safe grid integration.
2) Sensorless control of PMSG in CSC-PMSG-WECS.

The generator design for direct-drive or semi-direct-drive WECSs leads to a large rotor diameter, making it difficult to mount the encoder on the rotor shaft. A sensorless control algorithm for CSC-PMSG-WECS will bring great benefits to the system.
3) Evaluation of a WECS using electrically excited synchronous generator (EESG) connected with diode front end and PWM CSI.

Compared to the configuration in Fig. 2-12, the use of EESG offers an additional freedom of excitation control that may help to improve the grid power factor at low wind speeds. Practical design issues such as selection of generator flux, operating range limitation caused by synchronous inductance as well as coordinated control of flux and speed need to be evaluated. 169

References
[1] [2] "World Wind Energy Report 2008," World Wind Energy Association (WWEA), February 2009. G. W. E. Council, "Global Wind Energy Outlook 2008," Global Wind Energy Council, October, 2008. [3] F. Blaabjerg and Z. Chen, Power Electronics for Modern Wind Turbines: Morgan & Claypool Publishers, 2006. [4] F. Blaabjerg, Z. Chen, R. Teodorescu, and F. Iov, "Power Electronics in Wind Turbine Systems," in Power Electronics and Motion Control Conference, 2006. IPEMC '06. CES/IEEE 5th International, 2006, pp. 1-11. [5] A. R. Henderson, C. Morgan, B. Smith, H. C. Sørensen, R. J. Barthelmie, and B. Boesmans, "Offshore wind energy in Europe-A review of the state-of-the-art," Wind energy, vol. 6, pp. 35-52, 2003. [6] Y. Jun, L. Hui, L. Yong, and C. Zhe, "An Improved Control Strategy of Limiting the DC-Link Voltage Fluctuation for a Doubly Fed Induction Wind Generator," Power Electronics, IEEE Transactions on, vol. 23, pp. 1205-1213, 2008. [7] X. Lie and P. Cartwright, "Direct active and reactive power control of DFIG for wind energy generation," Energy Conversion, IEEE Transaction on, vol. 21, pp. 750-758, 2006. [8] M. R. Dubois, H. Polinder, and J. A. Ferreira, "Comparison of generator topologies for direct-drive wind turbines," in Proc. Nordic Countries Power Industrial Electronics Conf, pp. 22­26. [9] D. Bang, H. Polinder, G. Shrestha, and J. A. Ferreira, "Review of Generator Systems for DirectDrive Wind Turbines," in European Wind Energy Conference & Exhibition, Belgium, 2008. [10] A. Yazdani and R. Iravani, "A neutral-point clamped converter system for direct-drive variablespeed wind power unit," Energy Conversion, IEEE Transaction on, vol. 21, pp. 596-607, 2006. [11] M. Chinchilla, S. Arnaltes, and J. C. Burgos, "Control of permanent-magnet generators applied to variable-speed wind-energy systems connected to the grid," Energy Conversion, IEEE Transaction on, vol. 21, pp. 130-135, 2006.

170

[12]

S. Grabic, N. Celanovic, and V. A. Katic, "Permanent Magnet Synchronous Generator Cascade for Wind Turbine Application," Power Electronics, IEEE Transactions on, vol. 23, pp. 1136-1142, 2008.

[13]

J. K. Steinke and O. Apeldoorn, "Applying the experience of industrial high power converter design to windpower conversion," ABB Schweiz, Turgi, Switzerland, 2002.

[14]

A. Faulstich, J. K. Stinke, and F. Wittwer, "Medium voltage converter for permanent magnet wind power generators up to 5 MW," in European Conf. on Power Electro. and Appl., 2005, p. 9 pp.

[15] [16]

B. Wu, High-Power Converters and AC Drives: John Wiley & IEEE Press, 2006. C. H. Ng, M. A. Parker, R. Li, P. J. Tavner, J. R. Bumby, and E. Spooner, "A Multilevel Modular Converter for a Large, Light Weight Wind Turbine Generator," Power Electronics, IEEE Transactions on, vol. 23, pp. 1062-1074, 2008.

[17]

M. A. Perez, J. R. Espinoza, J. R. Rodriguez, and P. Lezana, "Regenerative medium-voltage AC drive based on a multicell arrangement with reduced energy storage requirements," Industrial Electronics, IEEE Transactions on, vol. 52, pp. 171-180, 2005.

[18]

M. Eichler, P. Maibach, A. Faulstich, and A. Ltd, "Full Size Voltage Converters for 5MW Offshore Wind Power Generators," pp. 1­10.

[19]

R. W. Erickson and O. A. Al-Naseem, "A new family of matrix converters," in Industrial Electronics Society, 2001. IECON '01. The 27th Annual Conference of the IEEE, 2001, pp. 15151520 vol.2.

[20]

O. A. Al-Naseem, "Modeling and space vector control of a novel multilevel matrix converter for variable-speed wind power generators," University of Colorado, 2001.

[21]

R. Erickson, S. Angkititrakul, O. Al-Naseem, and G. Lujan, "Novel Power electronics Systems for Wind Energy Applications," NREL/SR-500-33396 Oct. 2004.

[22]

S. Yong, Y. Xu, H. Qun, and W. Zhaoan, "Research on a novel capacitor clamped multilevel matrix converter," Power Electronics, IEEE Transactions on, vol. 20, pp. 1055-1065, 2005.

[23]

A. Mullane, G. Lightbody, and R. Yacamini, "Wind-Turbine Fault Ride-Through Enhancement," Power Systems, IEEE Transactions on, vol. 20, pp. 1929-1937, 2005.

171

[24]

J. Niiranen, "Experiences on voltage dip ride through factory testing of synchronous and doubly fed generator drives," in Power Electronics and Applications, 2005 European Conference on, 2005, pp. 11 pp.-P.11.

[25]

S. M. Muyeen, R. Takahashi, T. Murata, J. Tamura, M. H. Ali, Y. Matsumura, A. Kuwayama, and T. Matsumoto, "Low voltage ride through capability enhancement of wind turbine generator system during network disturbance," Renewable Power Generation, IET, vol. 3, pp. 65-74, 2009.

[26]

P. Flannery and G. Venkataramanan, "Unbalanced Voltage Sag Ride-Through of a Doubly Fed Induction Generator Wind Turbine with Series Grid Side Converter," in Industry Applications Society Annual Meeting, 2008. IAS '08. IEEE, 2008, pp. 1-8.

[27]

P. Ling, B. Francois, and L. Yongdong, "Improved Crowbar Control Strategy of DFIG Based Wind Turbines for Grid Fault Ride-Through," in Applied Power Electronics Conference and Exposition, 2009. APEC 2009. Twenty-Fourth Annual IEEE, 2009, pp. 1932-1938.

[28]

J. M. Carrasco, L. G. Franquelo, J. T. Bialasiewicz, E. Galvan, R. C. P. Guisado, M. A. M. Prats, J. I. Leon, and N. Moreno-Alfonso, "Power-Electronic Systems for the Grid Integration of Renewable Energy Sources: A Survey," Industrial Electronics, IEEE Transactions on, vol. 53, pp. 1002-1016, 2006.

[29]

P. S. Flannery and G. Venkataramanan, "A Fault Tolerant Doubly Fed Induction Generator Wind Turbine Using a Parallel Grid Side Rectifier and Series Grid Side Converter," Power Electronics, IEEE Transactions on, vol. 23, pp. 1126-1135, 2008.

[30]

J. Morneau, C. Abbey, and G. Joos, "Effect of Low Voltage Ride Through Technologies on Wind Farm," in Electrical Power Conference, 2007. EPC 2007. IEEE Canada, 2007, pp. 56-61.

[31]

C. Abbey, L. Wei, L. Owatta, and G. Joos, "Power Electronic Converter Control Techniques for Improved Low Voltage Ride Through Performance in WTGs," in Power Electronics Specialists Conference, 2006. PESC '06. 37th IEEE, 2006, pp. 1-6.

[32]

A. Causebrook, D. J. Atkinson, and A. G. Jack, "Fault Ride-Through of Large Wind Farms Using Series Dynamic Braking Resistors (March 2007)," Power Systems, IEEE Transactions on, vol. 22, pp. 966-975, 2007.

172

[33]

J. F. Conroy and R. Watson, "Low-voltage ride-through of a full converter wind turbine with permanent magnet generator," Renewable Power Generation, IET, vol. 1, pp. 182-189, 2007.

[34]

Z. Chen and E. Spooner, "Current source thyristor inverter and its active compensation system," Generation, Transmission and Distribution, IEE Proceedings-, vol. 150, pp. 447-454, 2003.

[35]

P. Tenca, A. A. Rockhill, and T. A. Lipo, "Wind Turbine Current-Source Converter Providing Reactive Power Control and Reduced Harmonics," Industry Applications, IEEE Transactions on, vol. 43, pp. 1050-1060, 2007.

[36]

P. Tenca, A. A. Rockhill, T. A. Lipo, and P. Tricoli, "Current Source Topology for Wind Turbines With Decreased Mains Current Harmonics, Further Reducible via Functional Minimization," Power Electronics, IEEE Transactions on, vol. 23, pp. 1143-1155, 2008.

[37]

N. Mohan, T. M. Undeland, and W. P. Robbins, Power electronics: Converters, applications, and design: Wiley, 2003.

[38]

N. R. Zargari, S. C. Rizzo, Y. Xiao, H. Iwamoto, K. Satoh, and J. F. Donlon, "A new currentsource converter using a symmetric gate-commutated thyristor (SGCT)," Industry Applications, IEEE Transactions on, vol. 37, pp. 896-903, 2001.

[39]

Y. Iwaji, T. Sukegawa, T. Okuyama, T. Ikimi, M. Shigyo, and M. Tobise, "A new PWM method to reduce beat phenomenon in large-capacity inverters with low switching frequency," Industry Applications, IEEE Transactions on, vol. 35, pp. 606-612, 1999.

[40]

Y. W. Li, B. Wu, N. R. Zargari, J. C. Wiseman, and D. Xu, "Damping of PWM Current-Source Rectifier Using a Hybrid Combination Approach," Power Electronics, IEEE Transactions on, vol. 22, pp. 1383-1393, 2007.

[41]

J. R. Wells, B. M. Nee, P. L. Chapman, and P. T. Krein, "Selective harmonic control: a general problem formulation and selected solutions," Power Electronics, IEEE Transactions on, vol. 20, pp. 1337-1345, 2005.

[42]

Y. W. Li, B. Wu, D. Xu, and N. R. Zargari, "Space Vector Sequence Investigation and Synchronization Methods for Active Front-End Rectifiers in High-Power Current-Source Drives," Industrial Electronics, IEEE Transactions on, vol. 55, pp. 1022-1034, 2008.

173

[43]

A. M. Qiu, Y. W. Li, B. Wu, N. Zargari, and Y. Liu, "High Performance Current Source Inverter Fed Induction Motor Drive with Minimal Harmonic Distortion," in Power Electronics Specialists Conference, 2007. PESC 2007. IEEE, 2007, pp. 79-85.

[44]

H. R. Karshenas, H. A. Kojori, and S. B. Dewan, "Generalized techniques of selective harmonic elimination and current control in current source inverters/converters," Power Electronics, IEEE Transactions on, vol. 10, pp. 566-573, 1995.

[45]

Y. Xiao, B. Wu, S. C. Rizzo, and R. Sotudeh, "A novel power factor control scheme for highpower GTO current-source converter," Industry Applications, IEEE Transactions on, vol. 34, pp. 1278-1283, 1998.

[46]

J. R. Espinoza, G. Joos, J. I. Guzman, L. A. Moran, and R. P. Burgos, "Selective harmonic elimination and current/voltage control in current/voltage-source topologies: a unified approach," Industrial Electronics, IEEE Transactions on, vol. 48, pp. 71-81, 2001.

[47]

B. Wu, S. B. Dewan, and G. R. Slemon, "PWM-CSI inverter for induction motor drives," Industry Applications, IEEE Transactions on, vol. 28, pp. 64-71, 1992.

[48]

M. Saeedifard, A. Bakhshai, and G. Joos, "Low switching frequency space vector modulators for high power multimodule converters," Power Electronics, IEEE Transactions on, vol. 20, pp. 13101318, 2005.

[49]

B. Abdul Rahiman, G. Narayanan, and V. T. Ranganathan, "Modified SVPWM Algorithm for Three Level VSI With Synchronized and Symmetrical Waveforms," Industrial Electronics, IEEE Transactions on, vol. 54, pp. 486-494, 2007.

[50]

D. G. Holmes, "A unified modulation algorithm for voltage and current source inverters based on AC-AC matrix converter theory," Industry Applications, IEEE Transactions on, vol. 28, pp. 31-40, 1992.

[51]

D. N. Zmood and D. G. Holmes, "A generalised approach to the modulation of current source inverters," in Power Electronics Specialists Conference, 1998. PESC 98 Record. 29th Annual IEEE, 1998, pp. 739-745 vol.1.

174

[52]

J. R. Espinoza and G. Joos, "Current-source converter on-line pattern generator switching frequency minimization," Industrial Electronics, IEEE Transactions on, vol. 44, pp. 198-206, 1997.

[53]

J. D. Ma, W. Bin, N. R. Zargari, and S. C. Rizzo, "A space vector modulated CSI-based AC drive for multimotor applications," Power Electronics, IEEE Transactions on, vol. 16, pp. 535-544, 2001.

[54]

J. R. Espinoza, G. Joos, L. A. Cea, and L. D. Salazar, "Space vector modulation techniques for current source rectifiers operating at switching frequencies up to 1 kHz," in Industrial Electronics Society, 1998. IECON '98. Proceedings of the 24th Annual Conference of the IEEE, 1998, pp. 542547 vol.1.

[55]

J. C. Wiseman and B. Wu, "Active damping control of a high-power PWM current-source rectifier for line-current THD reduction," Industrial Electronics, IEEE Transactions on, vol. 52, pp. 758764, 2005.

[56]

M. F. Naguib and L. A. C. Lopes, "Harmonics reduction in low switching frequency space vector modulated current source converters," in Power Electronics Specialists Conference, 2008. PESC 2008. IEEE, 2008, pp. 1434-1440.

[57]

"IEEE Recommended Practices and Requirements for Harmonic Control in Electrical Power Systems," IEEE Std 519-1992, Apr. 1993.

[58]

N. W. Miller, J. J. Sanchez-Gasca, W. W. Price, and R. W. Delmerico, "Dynamic modeling of GE 1.5 and 3.6 MW wind turbine-generators for stability simulations," in Power Engineering Society General Meeting, 2003, IEEE, 2003, pp. 1977-1983 Vol. 3.

[59]

A. Grauers, "Design of direct-driven permanent-magnet generators for wind turbines," School of Electrical and Computer Engineering, Chalmers University of Technology, 1996.

[60]

C. J. A. Versteegh, "Design of the Zephyros Z 72 Wind Turbine with Emphasis on the Direct Drive PM Generator," in Nordic Workshop on Power and Ind. Electro. (NORPIE), Trondheim, 2004, pp. 14-16.

[61]

E. Spooner and A. C. Williamson, "Direct coupled, permanent magnet generators for wind turbine applications," Electric Power Applications, IEE Proceedings -, vol. 143, pp. 1-8, 1996.

175

[62] [63]

B. C. Kuo, Automatic control systems: Prentice Hall PTR Upper Saddle River, NJ, USA, 1981. B. Wu, J. Pontt, J. Rodriguez, S. Bernet, and S. Kouro, "Current-Source Converter and Cycloconverter Topologies for Industrial Medium-Voltage Drives," Industrial Electronics, IEEE Transactions on, vol. 55, pp. 2786-2797, 2008.

[64]

N. R. Zargari and G. Joos, "A three-phase current-source type PWM rectifier with feed-forward compensation of input displacement factor," in Power Electronics Specialists Conference, PESC '94 Record., 25th Annual IEEE, 1994, pp. 363-368 vol.1.

[65]

R. P. Burgos, E. P. Wiechmann, and J. Holtz, "Complex state-space modeling and nonlinear control of active front-end converters," Industrial Electronics, IEEE Transactions on, vol. 52, pp. 363-377, 2005.

[66]

J. R. Espinoza and G. Joos, "State variable decoupling and power flow control in PWM currentsource rectifiers," Industrial Electronics, IEEE Transactions on, vol. 45, pp. 78-87, 1998.

[67]

W. Quincy and C. Liuchen, "An intelligent maximum power extraction algorithm for inverterbased variable speed wind turbine systems," Power Electronics, IEEE Transactions on, vol. 19, pp. 1242-1249, 2004.

[68]

S. Morimoto, H. Nakayama, M. Sanada, and Y. Takeda, "Sensorless output maximization control for variable-speed wind generation system using IPMSG," Industry Applications, IEEE Transactions on, vol. 41, pp. 60-67, 2005.

[69]

Q. Wei, Z. Wei, J. M. Aller, and R. G. Harley, "Wind Speed Estimation Based Sensorless Output Maximization Control for a Wind Turbine Driving a DFIG," Power Electronics, IEEE Transactions on, vol. 23, pp. 1156-1169, 2008.

[70]

J. D. Ma, B. Wu, and S. Rizzo, "Active damping control of PWM CSI high power induction motor drives," in Power Electronics Specialists Conference, 2000. PESC 00. 2000 IEEE 31st Annual, 2000, pp. 61-66 vol.1.

[71]

J. D. Ma, B. Wu, and S. Rizzo, "Stability improvement of CSI-fed multi-motor drives," in Industry Applications Conference, 2000. Conference Record of the 2000 IEEE, 2000, pp. 1454-1460 vol.3.

[72]

"Grid Code: High and extra high voltage," E. ON Netz GmbH Tech. Rep., 2006.

176

[73]

F. Iov, A. D. Hansen, P. E. Sørensen, and N. A. Cutululis, "Mapping of grid faults and grid codes," Risø National Laboratory 2007.

[74]

J. Matas, M. Castilla, J. M. Guerrero, L. Garcia de Vicuna, and J. Miret, "Feedback Linearization Of Direct-Drive Synchronous Wind-Turbines Via a Sliding Mode Approach," Power Electronics, IEEE Transactions on, vol. 23, pp. 1093-1103, 2008.

[75]

A. Abedini and A. Nasiri, "PMSG Wind Turbine Performance Analysis During Short Circuit Faults," in Electrical Power Conference, 2007. EPC 2007. IEEE Canada, 2007, pp. 160-165.

[76]

S. Tao, C. Zhe, and F. Blaabjerg, "Flicker study on variable speed wind turbines with doubly fed induction generators," Energy Conversion, IEEE Transaction on, vol. 20, pp. 896-905, 2005.

177

Appendix A System Parameters in Simulation and Experiment
Detailed system ratings, generator parameters and converter parameters for simulation and experiment are listed in the following table. The pictures of Experimental Setup 2 is given in Fig. A-1.
Table A-1 System parameters in simulation and experiment Parameters Simulation Experiment Setup 1 Experiment Setup 2

System Ratings Power Voltage Current Frequency 1.56MW 3200 V 300 A 60 Hz 2.08KW 170 V 7.5 A 60Hz 3.6KW 208 V 10 A 60Hz

Generator Parameters Frequency Synchronous Inductance Stator Resistance Number of Pole pairs 60 Hz 0.4 pu 0.01pu 32 Converter Parameters Generator-side Capacitor Grid-side Capacitor Grid-side Line Inductance DC Link Inductance Device Switching Frequency 0.3 pu 0.5 pu 0.1 pu 1 pu 540~600 Hz 0.3 pu 0.5 pu 0.1 pu 1 pu 540~600 Hz 0.3 pu 0.5 pu 0.1 pu 1 pu 540~600 Hz 60Hz 0.4 pu 0.014 pu 4 20Hz 0.2 pu 0.12 pu 8

178

179
Fig. A-1 Low-voltage experimental setup of a CSC-PMSG-WECS

Appendix B Small-Signal Models for CSC-PMSG-WECS
The details of the small-signal models derived in Chapter 4 are given in the following subsections.

B.1 Small-signal model of the whole CSC-PMSG-WECS
1) State-space equation

A simplified state space equation in a matrix form can be obtained according to (4-34). d x = Ax + Bu dt where x= igd igq vcrd vsd vcrq vsq (B-1)

g
mrd

isd

isq

vcid mid

vciq miq  
T

idc  

T

(B-2) (B-3)

u= Tm
 - Rg / Lg  - L / L  g d q  1 / Cr  0   0  A=  0  0   0   0  0  

mrq
0 0 0 0 0

-1 / Ld 0 0 - Rg / Lg 0 -1 / Lq  f / Lq 0 0 g 0 1 / Cr - g 0 0 -1.5P 2 [ f - ( Lq - Ld )  igd ] / J 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1.5Gacr mrd / Ldc 1.5Gacr mrq / Ldc 0

 g Lq / Ld

0 0 0 0 0 - Rs / Ls -s -1 / Ci 0 0

s
- Rs / Ls 0 -1 / Ci 0

0 0 0 0 0 1 / Ls 0 0 -s -1.5Gaci mid / Ldc

0 0 0 0 0 0 1 / Ls

s
0 -1.5Gaci miq / Ldc

0   0  -Gacr mrd / Cr   -Gacr mrq / Cr   0   0  0  Gaci mid / Ci   Gaci miq / Ci   0  

(B-4)

 0  0   0   0 P / J B=  0  0   0   0   0

0 0 0 0 0 -1 / Ls 0 0 0 0

0 0 0 0 0 0 -1 / Ls 0 0 0

0 0 0 0 0 0 0 0  0 0 0 0  0 0 0 0 0 0 0 0  0 0 0 0 0 0 0 0  0 0 0 0  0 0 0 0 0 0 0 0 

(B-5)

180

2) Small-signal equation

The small-signal model of the CSC-PMSG-WECS can be summarized as, d  x = A x + Bu dt where  x = [igd igq vcrd vsd vcrq vsq  g mrd isd isq vcid vciq miq ]T
0 0 0 0 0 1 / Ls 0 0 -s -1.5Gaci M id / Ldc 0 0 0 0 0 0 1 / Ls

(B-6)

idc ]T

(B-7) (B-8)
0   0  -Gacr M rd / Cr   -Gacr M rq / Cr   0   0  0  Gaci M id / Ci   Gaci M iq / Ci   0  

u = [Tm

mrq
0 0 0 0 0 - Rs / Ls -s -1 / Ci 0 0

mid
0 0 0 0 0

- Rg / Ld  g Lq / Ld -1 / Ld 0   - Rg / Lq 0 -1 / Lq  - g Ld / Lq  1 / Cr 0 0 g  0 1 / Cr -g 0  1.5 P 2 I ( L - L ) -1.5P 2 [ - ( L - L )  I ] / J 0 0 gq q d f q d gd A =   0 0 0 0  0 0 0 0   0 0 0 0   0 0 0 0  0 0 1.5Gacr M rd / Ldc 1.5Gacr M rq / Ldc  

I gq Lq / Ld ( f - I gd Ld ) / Lq Vcrq -Vcrd 0 0 0 0 0 0

s
- Rs / Ls 0 -1 / Ci 0

s
0 -1.5Gaci M iq / Ldc

(B-9)
 0  0   0   0 P / J B =   0  0   0   0  0  0 0 0 0 0 -1 / Li 0 0 0 0 0 0 0 0 0 0 -1 / Li 0 0 0 0 0 -Gacr I dc / Cr 0 0 0 0 0 0 0 0 0 -Gacr I dc / Cr 0 0 0 0 0 0 0 0 0 0 0 0 Gaci I dc / Ci 0 -1.5GaciVcid / Ldc     0  0   0  0   0  0   Gaci I dc / Ci   -1.5GaciVciq / Ldc  0 0

(B-10)

1.5GacrVcrd / Ldc 1.5GacrVcrq / Ldc

The sign  followed by a variable represents the small-signal variation of the variable. The symbols given in A and B with capitalized letters are used to represent the quiescent values of the corresponding variables at the operating point where the small-signal model is derived.

B.2 Grid-side small-signal model
1) State-space equation

181

d xi = Ai x i + B i u i dt where xi = [isd u i = [vdcr
 - Rs / Ls  - s  Ai =  -1/ Ci   0  0 

(B-11)

isq vsd
1/ Ls 0

vcid vsq

vciq mid

idc ]T miq ]T
0 1/ Ls 0 0 Gaci mid Gaci miq 0    / Ci   / Ci   

(B-12) (B-13)

s
- Rs / Ls 0 -1/ Ci 0

-1/ Ci / Ridamp -s -1.5Gaci mid / Ldc -1/ Ls 0 0 0 0

s
-1/ Ci / Ridamp -1.5Gaci miq / Ldc 0 -1/ Ls 0 0 0 0 0 0 0  0 0  0 0 0 0 

(B-14)

 0  0  Bi =  0   0  1/ Ldc

(B-15)

2) Small-signal equation

d  x i = Ai  x i + Bi u i dt where  x i = [ isd u i = [vdcr
 - Rs / Ls  - s  Ai =  -1/ Ci   0  0 

(B-16)

isq vsd

vcid vsq
1/ Ls 0

vciq mid

idc ]T miq ]T
0 1/ Ls 0 0 Gaci M id Gaci M iq 0    / Ci   / Ci   

(B-17) (B-18)

s
- Rs / Ls 0 -1/ Ci 0

-1/ Ci / Ridamp -s -1.5Gaci M id / Ldc

s
-1/ Ci / Ridamp -1.5Gaci M iq / Ldc

(B-19)

182

 0  0  Bi =  0   0 1/ Ldc 

-1/ Ls 0 0 0 0

0 -1/ Ls 0 0 0

0 0 Gaci I dc / Ci 0 -1.5GaciVcid / Ldc

  0   0  Gaci I dc / Ci  -1.5GaciVciq / Ldc   0

(B-20)

B.3 Generator-side small-signal model
1) State-space equation

d x r = Ar x r + B r u r dt where x r = [igd u r = [Tm
 - Rg Ld  - L L  g d q  1 Cr Ar =  0   0  

(B-21)

igq

vcrd

vcrq

 g ]T

(B-22) (B-23)
0 -1 Lq   f Lq   0  (B-24)  0   0   0

mrd

mrq

idc ]T
-1 Ld 0

 g Lq Ld
- Rg Lq 0  f - ( Lq - Ld ) igd  J -1.5P 2   1 Cr

-1 Cr Rrdamp - g 0

g
-1 Cr Rrdamp 0

 0  0  Br =  0   0  P J
2) Small-signal equation

0 0 -Gacr idc Cr 0 0

0 0 0 -Gacr idc Cr 0

0 0  0  0 0 

(B-25)

d  x r = Ar  x r + Br u r dt where  x r = [ igd igq vcrd 183 vcrq  g ]T

(B-26)

(B-27)

u r = [Tm
- Rg Ld   - g Ld / Lq   1 Cr Ar =   0  2 1.5P I gq ( Lq - Ld ) J 

mrd

mrq

idc ]T
-1 Ld 0 -1 Cr Rrdamp - g 0 0 -1 Lq

(B-28)
I gq Lq Ld
f

g Lq Ld
- Rg Lq 0  f - I gd ( Lq - Ld )  J -1.5P  
2

(

- I gd Ld ) Vcrq -Vcrd 0

g
-1 Cr Rrdamp 0

1 Cr

  Lq       

(B-29)  0  0  B r =  0   0  P J 0 0 -Gacr I dc Cr 0 0 0 0 0 -Gacr I dc Cr 0 0   0  -Gacr M rd Cr   -Gacr M rd Cr   0 

(B-30)

184


