Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2012

Probabilistic Optimal Power Flow Using Linear Fuzzy Relation
Inderdeep S. Arneja
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Electrical and Computer Engineering Commons Recommended Citation
Arneja, Inderdeep S., "Probabilistic Optimal Power Flow Using Linear Fuzzy Relation" (2012). Theses and dissertations. Paper 1242.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

PROBABILISTIC OPTIMAL POWER FLOW USING LINEAR FUZZY RELATION by Inderdeep Singh Arneja B.Eng, G.N.E College, Ludhiana 2003

A thesis presented to Ryerson University in partial fulfillment of the requirements for the degree of Master of Applied Science in the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2012 © Inderdeep Singh Arneja 2012

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A THESIS I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my thesis may be made electronically available to the public.

ii

PROBABILISTIC OPTIMAL POWER FLOW USING LINEAR FUZZY RELATION Master of Applied Science, 2012 Inderdeep Singh Arneja Electrical and Computer Engineering Ryerson University

ABSTRACT Optimal Power Flow (OPF) is a very important tool for planning and analysis of power systems. In the recent times, uncertain renewable energy is being integrated into power systems in a large scale. Appropriate modeling of renewables in optimal power flow requires using stochastic models. Using stochastic models of renewables in optimal power flow is numerically and algorithmically challenging due to the complexity of stochastic models and nonlinear nature of bus power balance equations. Hitherto, Monte Carlo simulation technique and Cumulant technique have been proposed, but they are not computationally viable for large systems. In this thesis, we propose the use of linear fuzzy relation technique to relate stochastic models of dependent variables of optimal power flow formulation in terms of control variables that include power output of renewables. This fuzzy relation uses Hessian matrix of the LaGrangian of the optimal power flow formulation at optimal solution point. The technique is tested on a six bus system and results are reported. One can intuitively see that this technique can be easily extended to larger systems.

iii

ACKNOWLEDGEMENTS

I would like to express my sincere appreciation to my supervisor, Prof. Bala Venkatesh for his continuous guidance, inspiring instruction, encouragement and huge support throughout this research. My deepest gratitude and love goes to my beloved family especially Mr. Surinderpal Singh & Mr. Kanwardeep Singh for their support and encouragement. I am also grateful to Dr. Daniel Cheng for his support during completion of this thesis. I would like to express my thankfulness to faculty members and staff of Electrical and Computer Engineering department of Ryerson University. I am thankful to my friends in the Power and Energy Analysis Research Laboratory especially Peng, Bhanu, Reza, Inderpreet, Amit & Inderjeet for their nice company during my study at Ryerson University.

iv

TABLE OF CONTENTS

1 1.1 1.2 1.3 2 2.1 2.2 2.3 3 3.1 3.2 3.2.1 3.2.2 3.2.3 3.3 3.4 4 4.1

INTRODUCTION ELECTRICAL POWER SYSTEM OBJECTIVE OF THESIS THESIS OUTLINE PROBABILISTIC OPTIMAL POWER FLOW-PROBLEM FORMULATION MODELING OF WIND GENERATOR PROBABILISTIC OPTIMAL POWER FLOW FORMULATION CONCLUSION PROBABILISTIC OPTIMAL POWER FLOW SOLUTION DETERMINISTIC OPTIMAL POWER FLOW (WITH MEAN VALUE OF  FUZZY PROBABILISTIC RELATIONS Linear Fuzzy Relation-Introduction Defining Fuzzy Variables Fuzzy Probabilistic Relations LINEAR FUZZY RELATION FLOW CHART CONCLUSION TEST CASE AND RESULTS COMPARISON OF RESULTS FOR POWER OUTPUT FOR LINEAR FUZZY RELATION AND MONTE CARLO SIMULATION METHOD

1 1 5 5 6 6 7 10 11 12 17 17 18 20 20 21 23

24

4.2

COMPARISON OF RESULTS FOR VOLTAGE AT BUSES FOR LINEAR FUZZY 27 RELATION AND MONTE CARLO SIMULATION METHOD

v

4.3 5

COMPARISON OF TIME REQUIRED TO OBTAIN SOLUTION FOR METHODS 29 CONCLUSION MODIFIED SIX BUS TEST SYSTEM DATA CALCULATION OF HESSIAN ELEMENTS OF LAGRANGIAN CALCULATION OF FIRST DERIVATIVE ELEMENTS OF LAGRANGIAN 31 33 36 41

APPENDIX A APPENDIX B APPENDIX C

APPENDIX D REFERENCES

MATLAB FUNCTION FILES WRITTEN TO SOLVE PROBLEM

42 65

vi

LIST OF FIGURES

1.1 1.2 2.1

GLOBAL ANNUAL INSTALLED WIND CAPACITY PROBABILISTIC OPTIMAL POWER FLOW (P-OPF) PROBABILITY DENSITY FUNCTION REPRESENTING WIND ELECTRIC POWER OUTPUT

2 3

7

2.2

CONCEPT OF WIND ELECTRIC GENERATOR OUTPUT IN TRANSMISSION SYSTEM 8 16

3.1 3.2

FLOW CHART OF NEWTON RAPHSON TECHNIQUE FUZZY PROBABILISTIC MODEL OF WIND ELECTRIC GENERATOR POWER OUTPUT

19

3.3

FLOW CHART USING LINEAR FUZZY RELATION FOR PROBABILISTIC OPTIMAL POWER FLOW 21

4.1

SINGLE LINE DIAGRAM OF WARD AND HALE MODIFIED SIX BUS SYSTEM 24

vii

LIST OF TABLES

4.1

STANDARD DEVIATION VALUES OF POWER OUTPUT OF GENERATORS USING LINEAR FUZZY RELATION APPROACH

25

4.2

STANDARD DEVIATION VALUES OF POWER OUTPUT OF GENERATORS USING MONTE CARLO SIMULATION METHOD

25

4.3 4.4 4.5 4.6 4.7

COMPARISON OF STANDARD DEVIATION VALUES OF POWER OUTPUT STANDARD DEVIATION VALUES OF VOLTAGES AT BUSES USING LFR STANDARD DEVIATION VALUES OF VOLTAGES AT BUSES USING MCS COMPARISON OF STANDARD DEVIATION VALUES VOLTAGES COMPARISON OF TIME REQUIRED TO SOLVE REAL POWER OPTIMAL POWER FLOW

26 27 28 29

29 33 34 34 35

A.1 GENERATOR COST DATA A.2 LOAD BUS DATA, SIX-BUS SYSTEM A.3 LINE DATA, SIX-BUS SYSTEM A.4 TRANSFORMER DATA, SIX-BUS SYSTEM

viii

LIST OF SYMBOLS
i Bus index Prefix denoting incremental change C L PGi QGi PDi QDi Pi(V,) Qi(V,) Objective function Lagrangian function Active power generated at bus i Reactive power generated at bus i Active power demand at bus i Reactive power demand at bus i Net real power flowing out from bus i into connected transmission system Net reactive power flowing out from bus i into connected transmission system Vi i Ti Magnitude of voltage at bus i Bus Phase Voltage angle at bus i Tap ratio of transformer Lagrange multiplier for equality constraints  Lagrange multiplier for inequality constraint  i NB Expected value of power output of WEG Standard deviation value for PDF of ith WEG Number of buses Extract of Hessian Matrix

ix

e       

Fuzzy satisfaction function Minimum value of voltage generated by generator Maximum value of voltage generated by generator Minimum value of active power generated by generator Maximum value of active power generated by generator Minimum value of reactive power generated by generator Maximum value of reactive power generated by generator Minimum value of voltage at load buses Maximum value of voltage at load buses R X Resistance of transmission line Reactance of transmission line

x

ABBREVIATIONS AND ACRONYMS

PDF MCS P-OPF WEG CEG

Probability Density Function Monte Carlo Simulation Probabilistic Optimal Power Flow Wind Electric Generator Conventional Electric Generator

xi

Chapter 1: Introduction

CHAPTER 1 INTRODUCTION
1.1 Electrical Power System Electrical power system is one of the largest and most complex systems in the world having its distinctive properties based on its geographical layout. It consists of three principal components namely generation, transmission and distribution. It is undergoing rapid changes since the last two decades with the integration of renewables. The power system should operate at optimal state at all times. To achieve this goal, optimal power flow in various forms is used by the system operator multiple times a day for realistic power system network conditions [1]. In the past two decades, world is increasing moving ahead towards clean energy generation technology as source of power generation. The wind energy generation among other renewable sources such as solar, geothermal, bioenergy, small hydro etc. is increasing at a rapid pace due to increase in electricity demand, environmental issues such as global warming, advancements in renewable technologies etc. The year 2010 marked an important milestone in the global wind energy industry as it was the first year that more new wind capacity was added in emerging markets than in traditional Organization for Economic Co-operation and Development (OECD) countries. In order to harness maximum green energy there is an increase in wind generation connected into the power system. Today, the total renewable generation in the world is more than 40 GW as reported by 2011 Global Wind Energy Council, Figure 1.1 [2].

1

Chapter 1: Introduction

MW

Year

Fig. 1.1 Global Annual Installed Capacity

With power output from wind electric generator being uncertain, their inclusion in optimal power flow renders the optimal solution with uncertainties. Therefore one must quantify and comprehend uncertainties in wind energy and the resulting optimal solution of optimal power flow. This task requires a probabilistic optimization technique in order to determine optimal solution values of different variables. With connection of wind electric generators in an electrical network, even with the most accurate wind forecasting techniques the prediction of wind at a particular instant of time is uncertain and so do output of wind electric generators [3]. This uncertainty is addressed by a probabilistic technique using probability density function of normal distribution representing output of wind electric generator [4]. It takes into account all possible uncertainties associated with wind electric generator power output.

2

Chapter 1: Introduction

Owing to the reason that power output of wind electric generator can deviate from their mean value, such deviation should be considered in finding the optimal voltage solution for the real power optimal power flow problem. As this deviation is represented by a normal probability density function, hence the voltage solution at a bus is not a deterministic value, but voltage value depends on deviation of power output of wind electric generator from its mean value. During the normal operation of a power system, voltage values at all buses in the network should be within limits of as set by regulatory authorities. So it becomes

important to study the effect of a wind electric generator on the voltage at buses in the network.

Bus i Probabilistic OPF

Probabilistic voltages at buses.

Fig. 1.2 Probabilistic Optimal Power Flow (P-OPF)

It is a challenge to find the voltage solution to this problem. In this work, a probabilistic optimal real power flow technique is proposed that takes into account the probabilistic nature of the wind power output while determining the optimal voltage solution at buses of a transmission system as shown in Figure 1.2.

3

Chapter 1: Introduction

Owing to probabilistic power output of wind electric generator in the electrical network, different techniques are used to find solution for optimal power flow problem. One traditional technique which is used to deal with such probabilistic problems is Monte Carlo simulation technique which finds solution for deviation of wind electric generator power output. It runs simulations, one by one for every deviation of wind power from the mean forecasted value, by solving a deterministic optimal power flow formulation and hence takes a lot of time to find the probabilistic solution. The situation gets even worse when the number of wind electric generators connected to the network is increased. In order to reduce solution time in solving probabilistic optimal power flow problem, the authors in one paper proposed real power optimal power flow using cumulant technique in which, the cumulants for unknown random variables are computed from known random variables, and probability density functions are reconstructed as bus loading is treated as random variables [5]. In another paper, system demand is taken as a random vector of correlated variables and FirstOrder Second Moment technique is used to find their statistical characteristics [6]. In another technique load demand and wind availability are taken as random variables and cumulants for output variables is calculated. Finally, probability density function of output variables is reconstructed by Gram-Charlier expansion theory [7]. The main idea behind all these techniques is to use approximate formulas for calculating the statistical moments of a random quantity that is a function of random variables.

This thesis briefly outlines the fundamentals of the Lagrangian technique, in which Kraush-Kuhn-Tucker conditions are solved using a Newton Raphson technique and its adaptation to solve real power optimal power flow problem to compute voltages in fuzzy
4

Chapter 1: Introduction

domain approximating the uncertainty of voltage due to wind electric generator output uncertainty [8].

1.2 Objective of this Thesis
In this thesis, we propose fuzzy relation technique to relate stochastic models of dependent variables of optimal power flow formulation in terms of control variables that include power output of renewables. This fuzzy relation uses the Hessian matrix of the LaGrangian of the optimal power flow formulation at optimal solution point. The stochastic models determined by the proposed technique are compared with those obtained from traditional accurate but time consuming Monte-Carlo simulation technique. The technique is tested on a six bus system and results are reported. One can intuitively see that this technique can be easily extended to larger systems.

1.3 Thesis Outline
This thesis is arranged as follows. Chapter 2 presents the probabilistic real power optimal power flow formulation. In Chapter 3 the general mathematical Lagrangian model, its deterministic solution and probabilistic optimal power flow using linear fuzzy relation technique are presented. Chapter 4 details results of a modified Ward and Hale six-bus system obtained using the proposed technique and its comparison with Monte Carlo simulation technique. Finally Chapter 5 concludes the thesis stating its advantages. Appendix A is provided at the end in order to present data of the modified Ward and Hale system.

5

Chapter 2: Probabilistic Optimal Power Flow- Problem Formulation

Chapter 2 Probabilistic Optimal Power Flow ­ Problem formulation

This chapter presents wind generator model and then formulates the probabilistic optimal power flow formulation. The model uses the probability theory in which a random variable is used to reflect the behavior of random processes. So uncertainty in the power output of wind electric generator is represented by a probability density function of a normal random variable. Once it is represented by probability density function it is used in problem formulation to find probabilistic characteristics of unknown variables.

2.1 Modeling of Wind Generator Output The power output of wind electric generator at bus i is modeled by a normal distribution with its respective mean ( )and standard deviation ( value. In order to include the

majority of deviation in wind electric generator power output from its mean value, a 99.73% confidence interval is taken which is equal to  shown in Figure 2.1 [4]. of mean value power output as

6

Chapter 2: Probabilistic Optimal Power Flow- Problem Formulation

f(PWi)

PWi   

Fig. 2.1 Probability density function of WEG power output

The Probability Density Function (PDF) of the normal distribution is given by:

( 



)

(2.1)

2.2 Probabilistic Optimal Power Flow ­ Formulation This section presents the probabilistic real power optimal power flow challenge for transmission system. Thereafter its solution technique by forming a Lagrangian function, Kraush-Kuhn-Tucker conditions and the solution is presented. Probabilistic real power optimal power flow concept is used when certain variables are modeled using random variables. It includes objective such as minimization of system operation cost while treating uncertainty of power system variables of interest. A single line representation of generic transmission system incorporating wind electric generator at bus i is shown in Figure 2.2.

7

Chapter 2: Probabilistic Optimal Power Flow- Problem Formulation

Bus i

CEG

Fig.2.2 Concept of wind electric generator output in Transmission system

Bus i has a wind electric generator connected to it that injects real power. The net real power demand at the bus is represented by and it is the difference between

the real power demand and real output power of wind electric generator at the bus. This is used to represent net power demand at the bus and is used in real power optimal power flow formulation. In the probabilistic real power optimal power flow study, the objective is to minimize the total active power generation cost:  where generation. subject to: Bus Power Balance Equality constraints: In real power probabilistic optimal power flow, the cost of generation is minimized while satisfying these equality constraints imposed by physical nature of the system. These are the cost coefficients of generator and (2.2) is the real power

8

Chapter 2: Probabilistic Optimal Power Flow- Problem Formulation

equality constraints use the power flow equations representing bus active and reactive power injections in terms of bus voltage magnitudes and bus phase angles.

(2.3) (2.4) where PG is a vector of real power output of conventional electric generators. QG is a vector of reactive power output of conventional electric generators. PD is a vector of real power demand at a bus. QD is a vector of reactive power demand at a bus. PW is a vector of probabilistic values of wind electric generator power output. is a vector function of real power flow from buses into connected lines. is a vector function of reactive power flow from buses into connected lines. Inequality constraints at generator buses: These constraints are imposed on relevant variables to ensure that they satisfy physical limits of the devices. (2.5) (2.6) (2.7) where are the vector of lower and upper limits of voltage at generators terminals. are the vector of lower and upper limits of real power generated by generators.

9

Chapter 2: Probabilistic Optimal Power Flow- Problem Formulation

are the vector of lower and upper limits of reactive power generated by generators. Inequality constraints at load buses: These constraints are included to ensure that the optimal solution is free from voltage violations at load buses (2.8) where are the lower and upper limits of voltages at load buses. The above is a probabilistic real power optimal power flow formulation with PWi being the probabilistic input. As a result, the solution comprising of power generated by generators (PG) and voltage at load buses (V) are probabilistic. Equations (2.2) to (2.8) construe the complete problem.

2.3 Conclusion This chapter presented a probabilistic real power optimal power flow challenge. Firstly probabilistic model of the wind electric generator is basically represented by probability density function of normal distribution which takes into account maximum deviation of power output from the forecasted mean value. The values from probability density function representing uncertainty is included in the problem formulated which is basically minimizing cost of all conventional electric generators subject to various constraints in regard to find optimal probabilistic solution of unknown system variables. The proposed solution technique will be presented in the next chapter.

10

Chapter 3: Probabilistic Optimal Power Flow Solution

CHAPTER 3 PROBABILISTIC OPTIMAL POWER FLOW ­ SOLUTION

The solution strategy for the probabilistic real power optimal power flow problem is detailed in this section. The goal of this solution technique is to determine the probabilistic behavior of the dependent variables which can be observed by their probabilistic distribution function values. Hence the first step is to formulate the deterministic real power optimal power flow problem. To solve the deterministic formulation, the Lagrangian formulation is used and is solved by satisfying the Kraush-Kuhn-Tucker (KKT) conditions. On obtaining the optimal solution for the deterministic real power optimal power flow problem, a Hessian matrix is determined that relates changes in problem variables at the optimal point. Thereafter, probabilistic variable are transformed to fuzzy variables using fuzzy triangles. Finally probabilistic behavior of real power and voltage variables is calculated using linear fuzzy relation and a Hessian matrix estimated at optimal point. The set of steps of the linear fuzzy relation based probabilistic optimal power flow technique are summarized below:

1.

The probabilistic real power optimal power flow challenge is reduced to a deterministic challenge by considering the mean value of power output of wind generator ( i).

2.

The deterministic formulation is solved by forming a Lagrangian function and solving Kraush-Kuhn-Tucker Conditions.

11

Chapter 3: Probabilistic Optimal Power Flow Solution

3.

The Hessian of the Lagrangian at the optimal solution is reduced to form a linear relation between changes in wind power output (PWi) and other optimal variables such as generator real power output (PG), bus voltage (V), etc.

4.

Fuzzy probabilistic variables are defined that represent approximations of probabilistic distribution functions of wind power output (  i).

5.

Linear Fuzzy Relation technique is used to determine fuzzy probabilistic variables of power output of conventional electric generator power (PG) and voltage at buses (V) in terms of fuzzy probabilistic variable of wind power output . Accordingly,

mean and standard deviation of probability density functions for PG and V are estimated.

These steps are now detailed in the following sections.

3.1

Deterministic Optimal Power Flow (with mean value of WEG power output i)

The step of finding the deterministic optimal power flow solution is to form a Lagrangian function of the problem by augmenting objective function with active & reactive power balance equations and other inequality constraints. In optimal power flow problem formulation there are basically three types of variables: independent, dependent and Lagrange multipliers. Independent variables are generator real powers outputs, generators terminal voltages, transformers tap ratios etc. which can be controlled to obtain optimal solution, dependent variables corresponds to both magnitude and angle of voltages at load

12

Chapter 3: Probabilistic Optimal Power Flow Solution

buses, reactive power output of generators and Lagrange multipliers that are coefficients corresponding to real and reactive power balance equations at buses.

The values of the unknowns and Lagrange multipliers corresponding to optimal power flow problem are determined from the Lagrangian formulation of the problem. In every step of the iterative algorithm, values of variables and Lagrange multipliers are computed simultaneously. At the optimal state, change in variables is less than the defined tolerance value.

The Lagrange multiplier technique augments the original objective function with a set of the equality constraints and inequality constraints. The problem defined in section (2.2) ­ (2.8) may be stated briefly as: (3.1)

(3.2) (3.3) A Lagrangian function for (3.1) ­ (3.3) may be defined as below: [ ] [ ] (3.4)

Once the probabilistic optimal power flow problem is formulated, an algorithm is developed to minimize the cost of conventional electric generators including resultant demand at a wind electric generator bus in power system network to meet overall load demand of the network. The basic idea is to determine the optimum values of the variables

13

Chapter 3: Probabilistic Optimal Power Flow Solution

such that value of cost function is the minimum. To solve this problem by deriving the Kraush-Kuhn-Tucker (KKT) conditions as below, one gets: (3.5) (3.6) (3.7) (3.8) By solving the above, we can determine the optimal values for X,  and  At the optimal solution, on identify binding inequality constraints , one gets:

 (3.10) (3.11) Using first order approximation, one may write:

where H(X) is the Hessian of the Lagrangian. is the gradient of the Lagrangian. is the value for change in variable at every iteration.

[

] [ ] [ ] (3.12)

[

]

14

Chapter 3: Probabilistic Optimal Power Flow Solution

Once the optimal solution is obtained, by manipulating (3.12), one may determine a linear relation between: PW and [PG, V] as below: [ ][ ] [ ]                              

where HPW is an extract of the Hessian matrix from (3.12). The procedure to obtain optimal solution uses the Newton Raphson technique. The Newton Raphson technique is basically solving simultaneously equations from (3.9) ­ (3.11) for unknown variables at each iteration till the solution converges to the optimal solution. In order to solve using Newton Raphson technique, it is required to calculate elements of Jacobian matrix of (3.9) to (3.11). The flow chart of Newton Raphson technique to determine the optimal solution of the real power optimal power flow problem is summarized in Fig 3.1 [8].

15

Chapter 3: Probabilistic Optimal Power Flow Solution

START Read Network Data

Form

for Network ]

Assume A = [ Initialize =[ Initialize =[

] ]

Write Lagrangian (3.4) & its KKT equations (3.5-3.7).

Solve KKT equations using Newton Raphson technique (see equation 3.12). ] [ [ ][ ]

If [

]

NO

Update [ ] [ ] [

]

YES

The optimum solution values of

are obtained.

STOP

Fig. 3.1 Flow Chart of Newton Raphson technique

16

Chapter 3: Probabilistic Optimal Power Flow Solution

3.2 Fuzzy Probabilistic Relations [9] This section details the proposed solution scheme that uses (3.13) relating changes in wind power (PW) with changes in real power output of generators (PG) and changes in bus voltages (V) using Linear Fuzzy Relation technique. 3.2.1 Linear Fuzzy Relation ­ Introduction Fuzziness describes the ambiguity and randomness in the occurrence of an event. Lofti Zadeh proposed the set membership idea to model vagueness, imprecision and lack of information when uncertainty occurs and formed fuzzy sets as the sets on the universe X which can accommodate degree of fuzziness. Fuzziness in a fuzzy set is characterized by its membership function. Membership functions are formed by assigning a specific membership value (degree of belongingness) to each of estimated value. Membership function for a set maps each element of the set to a membership value between 0 and 1. In this work triangular membership function is formed which is defined by its middle value and spread respectively. A generic fuzzy set may be defined as below:  { } (3.14)

The following equation defines a generic linear fuzzy relation:  In (3.15),     (3.15)  to the

are constants that relate fuzzy variables  

output variable  . Typically, knowing input and output fuzzy variables, one may determine the constants using regression analysis [8]

17

Chapter 3: Probabilistic Optimal Power Flow Solution

The next section defines probabilistic wind power output as a fuzzy variable. It then uses the linear relation in the optimal solution (3.13) and relates fuzzy variable of power output (  ) of wind electric generator to the fuzzy variables of power output of conventional electric generators (  ) and voltage ( ) at buses. These fuzzy variables then help determine probabilistic values of power output of conventional electric generators (PG) and voltages (V) at buses.

3.2.2 Defining Fuzzy Variables In this work, power output of wind generators is uncertain. Consider output of the wind

generator (PWi). Eq. (2.1) provides its forecast probabilistic distribution function. The mean for this PDF is  . The uncertainty of this PDF can then be modeled by  such that    . Accordingly,  is defined as a fuzzy variable using (2.1) while

capturing essential probabilistic features of the Probability Density Function (PDF) as below.  { } (3.16)

The following aspects were considered in this process: The width of fuzzy variable is defined using 99% confidence interval of the normal function. Therefore:  (3.17)

18

Chapter 3: Probabilistic Optimal Power Flow Solution

 The height of the triangle that helps define the satisfaction function

(3.18) is chosen as

a triangle with area of 1.0 such that it correlates with the PDF of the normal distribution function. The fuzzy variable  closely models the actual probabilistic distribution function of (2.1). The two are drawn and show in Fig. 3.2.
Normal PDF

Fuzzy Model







Fig. 3.2

Fuzzy Probabilistic Model of Wind Power Output

This fuzzy probabilistic model is used in the linear fuzzy relation to extract fuzzy probabilistic models of generator real power outputs and bus voltage magnitude at optimal solution using the linear relation extracted from the optimal solution in equation (3.13).

19

Chapter 3: Probabilistic Optimal Power Flow Solution

3.2.3 Fuzzy Probabilistic Relations Using the knowledge of linear fuzzy relation expressed in (3.15) and linear relation established in (3.13), the following can be written as below: [ ][  ]  []  are formed as below: (3.20) (3.21) (3.19)

Thereafter, probabilistic variables       

Summarizing, the steps of the proposed algorithm include: 1. Assume mean values of probabilistic variables and solve a deterministic formulation (2.1)(2.7) by forming Lagrangian function (3.4) and solving for the KKT conditions (3.5)(3.8). 2. At the optimal solution, determine the subset of the Hessian (3.13) that provides linear relations between PW and PG, V. 3. Using Linear Fuzzy Relations, (3.19)-(3.21), determine: Probabilistic variables  .

3.3 Linear Fuzzy Relation (LFR) Flow Chart The complete solution technique to solve real power probabilistic optimal power flow problem is summarized in linear fuzzy relation flow chart in shown in figure on next page.

20

Chapter 3: Probabilistic Optimal Power Flow Solution

Start

Solve Real Power OPF problem using Newton Raphson algorithm. Optimal values of variable PG & V are obtained.

Compute the Hessian matrix using optimal solution of ]for linear fuzzy OPF. Deduce subset of Hessian [ relation. Calculate using LFR equation (3.15) find values of probabilistic variables.
[ ][  ]  []

Compute final value of variables.      

END Fig. 3.3 Flow Chart using LFR for (P-OPF)

3.4 Conclusion In this chapter the proposed technique to solve probabilistic real power optimal power flow is presented. The formulation takes into account the uncertainty of power output of a wind electric generator and solution technique is divided into two steps. The first step uses Newton Raphson iterative technique to solve problem as deterministic problem. Using

21

Chapter 3: Probabilistic Optimal Power Flow Solution

optimal values of variables, fuzzy functions are defined to yield optimal probabilistic values of the power output of generators (PG) and voltages at buses (V).

22

Chapter 4: Test Case and Results

CHAPTER 4 TEST CASE AND RESULTS
The diagram of the modified Ward and Hale 6-bus system is shown in Fig. 4.1. The system has two conventional electric generators (CEG1) and (CEG 2) connected at electrical buses 1001 and 2003. One wind electric generator (WEG1) is connected at bus 2003. The total numbers of loads connected to the system are three. It has five transmission lines and two transformers (T/F1) & (T/F2). The wind electric generator (WEG1) is installed at load bus 2003. Remaining buses are 1004, 2005 & 1006 where no load or generation is connected. The mean power output of this wind electric generator (WEG1) is taken as 20 MW and its standard deviation is 10% of its mean value [10]. The six bus system data is taken from research paper which is modified in the present work [11]. The detailed system data is given in Appendix A.

23

Chapter 4: Test Case and Results

CEG1 1001 1004 2003

WEG1

T/F 1

T/F 2

1006

2005

2002 CEG2

Fig. 4.1 Modified Six-Bus System

The solution for the six bus system obtained using the proposed probabilistic optimal power flow using Linear Fuzzy Relation (LFR) technique is presented below. In order to contrast results from the proposed technique, results are elicited from Monte Carlo simulation technique applied to same data set using deterministic formulation (2.1-2.7) are detailed in the following sections. The effect of deviation in power output of wind electric generator is studied on power output of conventional generators and voltage at buses.

4.1 Comparison of results for power output for Linear Fuzzy Relation technique and Monte Carlo Simulation (MCS) technique First, results for deviation in power output of conventional electric generators due to deviation in wind electric generator power output are presented in Table 4.1& Table 4.2.

24

Chapter 4: Test Case and Results

Results shown in Table 4.1 are calculated using Linear Fuzzy Relation technique and standard deviation values are calculated for deviation in power output of generator.

Table 4.1 Calculation of standard deviation values of power output using LFR technique  Maximum probable value Minimum probable value 0.180834 0.253496 Standard Deviation of the probable value PG1 PG2 1001 2002 0.269766 0.289304 0.014822 0.005968

Generator Power Output

Bus No.

Similarly in Table 4.2 results are computed using Monte Carlo Simulation technique and standard deviation values are calculated for deviation in power output for each generator.

Table 4.2 Calculation of standard deviation values of power output using MCS technique  Maximum Probable value PG1 PG2 1001 2002 0.270032 0.289601 Minimum Probable value 0.181189 0.253345 0.014807 0.006043 Standard Deviation of the probable value

Generator Power Output

Bus No.

The results of standard deviation values for generator outputs (PG1 & PG2) for both Linear Fuzzy Relation & Monte Carlo Simulation techniques is small as shown in Table 4.1 & 4.2. This interprets the information that there is very small change on power output of generators due to deviation in wind electric generator power output.
25

Chapter 4: Test Case and Results

Finally to assess the accuracy of the Linear Fuzzy Relation technique in comparison to Monte Carlo technique (% error) is computed for both PG1 & PG2 values and results obtained are shown in Table 4.3. The % error values are small. This reflects that Linear Fuzzy Relation technique is an accurate technique.

Table 4.3 Comparison of standard deviation values of power output

Generator Power Output

Bus No.

Standard Deviation using Linear Fuzzy Relation technique

Standard Deviation using Monte Carlo Simulation Technique

Error (%)

PG1 PG2

1001 2002

0.014822 0.005968

0.014807 0.006043

0.1 1.2

26

Chapter 4: Test Case and Results

4.2 Comparison of results for voltages at buses for LFR and MCS technique Similarly in order to find the effect of deviation in wind electric generator power output on voltage of buses excluding slack and generator buses, Linear Fuzzy Relation technique is used and results are shown in Table 4.4. The values for standard deviations are calculated.

Table 4.4 Calculation of standard deviation values of voltages using LFR technique  Minimum Probable Value 2003 Voltage 1004 2005 1006 0.916486 0.966280 0.972948 0.943970 Maximum Probable Value 0.926314 0.974920 0.977052 0.948230 0.001638 0.001440 0.000684 0.000710 Standard Deviation

Bus Parameter No.

Results are shown in Table 4.4 for maximum deviation in voltages from their mean values due to deviation in power output of wind electric generator. The standard deviation values of voltages calculated for every bus indicate that there is very small effect on voltages due to deviation in power output of wind.

27

Chapter 4: Test Case and Results

Table 4.5 Calculation of standard deviation values using MCS technique  Parameter Bus No. Minimum Probable Value 2003 1004 Voltage 2005 1006 0.916342 0.966156 0.972940 0.943884 Maximum Probable Value 0.926165 0.974781 0.977092 0.948145 0.001637 0.001438 0.000692 0.000710 Standard Deviation

Similarly results are calculated from Monte Carlo Simulation technique and are shown in Table 4.5. The results for standard deviation values of voltages is small which also interprets the same information. In order to check the accuracy of the results of Linear Fuzzy Relation technique with Monte Carlo Simulation technique in case of voltage values, % error are calculated and tabulated in Table 4.6. The value of % error is very small which shows that the Linear Fuzzy Relation technique is an accurate technique.

28

Chapter 4: Test Case and Results

Table 4.6 Comparison of standard deviation values of voltages

Parameter Bus No. Standard Deviation using Linear Fuzzy Relation technique 2003 1004 Voltage 2005 1006 0.001638 0.001440 0.000684 0.000710

MCS

Standard Deviation using Monte Carlo Simulation Technique 0.001637 0.001438 0.000692 0.000710 0.05 0.17 1.13 0.04

4.3 Comparison of time required to obtain solution for both techniques The advantage of Linear Fuzzy Relation technique over Monte Carlo Simulation technique is its quick time in solving the probabilistic real power optimal power flow problem. The time is calculated for both techniques and shown in Table 4.7. Table 4.7 Comparison of time required to solve real power Real Power optimal power flow Technique Linear Fuzzy Relation (LFR) technique Monte Carlo Simulation (MCS) technique Execution time (Secs) 0.23 54.78

The real power optimal power flow problem is solved using the code written in Matlab software version 7.12.0.635 (R 2011 a). This comparison of results shows that time required to solve using Linear Fuzzy Relation technique is extremely less as compared to Monte Carlo Simulation technique.

29

Chapter 4: Test Case and Results

Hence the results shown in Tables 4.1 to 4.7 demonstrate that proposed Linear Fuzzy Relation technique is accurate, efficient and reliable technique to solve probabilistic real power optimal power flow problem. It accounts for the probabilistic information of uncertain wind generators.

30

Chapter 5: Conclusion

Chapter 5 Conclusion

This thesis proposes a probabilistic optimal power flow using linear fuzzy relation technique to find the deviation in the optimal bus voltage values and power output of generators due to uncertainty in power output of wind electric generator. The thesis models output of wind electric generators using a normal probabilistic distribution function. This model is transformed into a triangular fuzzy model which has an area equal to the normal probability distribution function. Thereafter, considering the mean forecast of wind power, the optimal solution is determined using a deterministic optimal power flow formulation. From the Lagrangian function, the hessian determined at the optimal solution is used to create the linear fuzzy relation. This relation relates the fuzzy variables of wind power deviation to fuzzy variables of power output of generators and bus voltage magnitudes. These fuzzy variables are translated into probabilistic variables by computing mean and standard deviation values. The computed deviation in voltages and power output of generators corresponding to uncertainties in WEG power output using the proposed technique is compared with those obtained using MCS technique. On comparison, the % error values of power output of conventional electric generators and voltage solution values of buses shows that the proposed solution technique is accurate. Further, the time taken by proposed technique is

31

Chapter 5: Conclusion

significantly less than Monte Carlo Simulation technique. The proposed method is shown to be computationally efficient, operationally flexible and numerically accurate.

32

Appendices

APPENDICES
Appendix A: Modified Ward and Hale 6-Bus System This appendix presents six bus Ward and Hale System data. This system possesses characteristics of a large power system. The data includes generators, loads, lines and transformers. The base MVA for this system is 100 MVA.

Table A.1 Generator cost data of six bus system Sr.No. Bus No. $ 1 2 1001 1002 400 200 $/MWh 36 34 $/MWh2 0.019 0.017

33

Appendices

Table A.2 Load data of six bus system Sr.No. Bus No. Real Power Load 1 2 3 4 5 6 1001 2002 2003 1004 2005 1006 0 0 0.275 0 0.15 0.25 Reactive Power Load 0 0 0.065 0 0.09 0.025

Table A.3 Line data of six bus system Sr. No. From Bus To Bus No. of circuits R (p.u.) X (p.u.)

1 2 3 4 5

1001 1001 2002 2002 1004

1004 1006 2003 2005 1006

01 01 01 01 01

0.08 0.123 0.723 0.282 0.097

0.37 0.518 1.05 0.64 0.407

34

Appendices

Table A.4 Transformer data of 6 six bus system Sr.No. From Bus To Bus No. of Circuits
1 2 2003 2005 1004 1006 01 01 0.0 0.0 0.133 0.3 1.05 0.95

R(p.u.)

X(p.u.)

(p.u.)

35

Appendices

Appendix B: Calculation of Hessian elements of Lagrangian. Appendix B contains a list of all the equations that make up Hessian matrix. These hessian terms are due to power flow equations.

B.1: Second order derivatives with respect to

.

These equations from (B 1.1 to B 1.10) corresponds to first line of Hessian matrix. (B.1.1) (B.1.2) (B.1.3) (B.1.4) (B.1.5) (B.1.6) (B.1.7) (B.1.8) (B.1.9) (B.1.10)

36

Appendices

B.2: Second derivatives with respect to

.

These equations from (B 2.1 to B 2.10) corresponds to first line of Hessian matrix. (B.2.1) (B.2.2)  ( ) 



( 

(

))

 (B.2.3)

(    

( ( )

))   ( ) 

 ( ) (B.2.4)

(B.2.5)

   ( )  )

 (B.2.6) (B.2.7)

(B.2.8) 

(B.2.9)

37

Appendices

(B.2.10) B.3: Second derivatives with respect to .

These equations from (B 3.1 to B 3.10) corresponds to third line of Hessian matrix. (B.3.1) (B.3.2)     

(B.3.3)

       

(

( (

)) ) (B.3.4) (B.3.5)

( (

) ) (B.3.6) (B.3.7)

( 

)

(B.3.8)

(B.3.9)

(B.3.10)

38

Appendices

B.4: Second derivatives with respect to These equations from (B 4.1 to B 4.10) corresponds to fourth line of Hessian matrix. (B.4.1) (B.4.2)  ( ) (B.4.3)

(

) 

(B.4.4) (B.4.5)

(

)

(B.4.6) (B.4.7) (B.4.8)

(B.4.9) (B.4.10)

39

Appendices

B.5: Second derivatives with respect to These equations from (B 5.1 to B 5.10) corresponds to fifth line of Hessian matrix.

(B.5.1) (B.5.2)  ( ) (B.5.3)



( 

)

(B.5.4) (B.5.5)

(

)

(B.5.6) (B.5.7) (B.5.8) (B.5.9) (B.5.10)

40

Appendices

Appendix C: Calculations of First Order elements of the Lagrangian. These equations (C.1 to C.10) form the gradient vector of the Lagrangian formulation solution. (C.1)









(C.2) ( )  





(C.3)   (C.4)

(C.5)

41

Appendices

Appendix D: Matlab code written for P-optimal power flow Solution

To solve for P-optimal power flow problem using Newton Raphson technique in Matlab, the following function files are written which also gives solution in general case.

Then run_file.m which consists of following function files is to be run first. It will ask for the data file. Then PMINDAT.TXT (file name) should be entered at the command prompt which is in the same folder. Once the data is read, YBUS matrix of the network is formed which is required in calculations. Then the iterative algorithm steps are solved using Hessian file to compute optimal solution.

The following are the function files used in solution. 1. DATA.m 2. YBUS.m 3. SIX_BUS_LAMPQ.m 4. HESSIAN.m These are .m files which run inside Hessian function file to compute Hessian matrix. DEL_all.m PG_all.m V_all.m Lamp_all.m Lamq_all.m 6. OUTPUT.m

42

Appendices

% Calculation of Optimal Power Flow using Newton Raphson technique. clc clear all format shortg global NB NBB NS NG NLB NTR NTRL NT NSHC NSVS NSHR NSH NREG global VSLACK TOLER PBASE VLMAX VLMIN ITMAX global BIND BSN BNAM PG QG PD QD V DEL QGMAX QGMIN VSH global FB TB NCKT YL ZL BL TAP RAT KV LEN TAPMAX TAPMIN TAPSTP global SNO SUS SUSMAX SUSMIN SUSSTP global YB global LAM global PGMAX PGMIN VGMAX VGMIN ap bp cp global ofp ifp global Y Theta global Lamp Lamq global HESSIAN_INV DEL_Degree tic DATA YBUS SIX_BUS_LAMPQ HESSIAN OUTPUT toc % Form Hessian Matrix. % Give details of Power Flow, Losses, etc. % Reads data from data file. % Form Y bus for electrical network.

43

Appendices

Data File function DATA global NB NBB NS NG NLB NTR NTRL NT NSHC NSVS NSHR NSH NREG global VSLACK TOLER PBASE VLMAX VLMIN ITMAX global BIND BSN BNAM PG QG PD QD V DEL QGMAX QGMIN VSH global FB TB NCKT YL ZL BL TAP RAT KV LEN TAPMAX TAPMIN TAPSTP global SNO SUS SUSMAX SUSMIN SUSSTP global YB global LAM global PGMAX PGMIN VGMAX VGMIN ap bp cp global ofp ifp global Y global Lamp Lamq PP = input('name of input data file:' ,'s') ofp = fopen('PMINOUT.TXT','w'); ifp = fopen(PP,'r'); fprintf(ofp,'INPUT FILE NAME: PP \n'); fprintf(ofp,'OUTPUT FILE NAME: PMINOUT.TXT \n'); temp = fscanf(ifp,'%s',[1]); fprintf(ofp,'SYSTEM: %s\n',temp); temp = fscanf(ifp,'%s',[1]); fprintf(ofp,'YEAR : %s\n',temp); temp = fscanf(ifp,'%s',[1]); fprintf(ofp,'CASE : %s\n',temp); temp = fscanf(ifp,'%s',[1]); fprintf(ofp,'NUMBER: %s\n',temp); ttt = fscanf(ifp,'%d %d %d %d %d %d %d %d %d %d %d %d %d',[1,13]); NB = ttt(1); NBB = ttt(2); NS = ttt(3); NG = ttt(4); temp = ttt(5); temp = ttt(6); NLB = ttt(7); NTR = ttt(8); NTRL = ttt(9); NSHC = ttt(10); NSVS = ttt(11); NSHR = ttt(12); NREG = ttt(13); NT = NTR + NTRL; NSH = NSHC + NSVS + NSHR; ttt = fscanf(ifp,'%f %f %f %f %f %d',[1,6]); VSLACK = ttt(1); TOLER = ttt(2); PBASE = ttt(3);
44

Appendices

VLMAX = ttt(4); VLMIN = ttt(5); ITMAX = ttt(6); fprintf(ofp,'NUMBER OF BUSES : %d\n', NB); fprintf(ofp,'SLACK BUS NUMBER : %d\n', NS); fprintf(ofp,'NUMBER OF GENERATORS : %d\n', NG); fprintf(ofp,'NUMBER OF LOAD BUSES : %d\n', NLB); fprintf(ofp,'NUMBER OF TRANSFORMERS : %d\n', NTR); fprintf(ofp,'NUMBER OF TRANSMISSION LINES : %d\n', NTRL); fprintf(ofp,'NUMBER OF SHUNT CAPACITORS : %d\n', NSHC); fprintf(ofp,'NUMBER OF SWITCHABLE CAPACITORS :%d\n',NSVS); fprintf(ofp,'NUMBER OF SHUNT REACTORS : %d\n', NSHR); fprintf(ofp,'SLACK BUS VOLATGE : %8.4f\n', VSLACK); fprintf(ofp,'TOLERANCE (MW) : %8.4f\n', TOLER*PBASE); fprintf(ofp,'BASE MVA \t60 : %8.4f\n', PBASE); fprintf(ofp,'MINIMUM LOAD BUS VOLTAGE : %8.4f\n', VLMIN); fprintf(ofp,'MAXIMUM LOAD BUS VOLTAGE : %8.4f\n', VLMAX); fprintf(ofp,'MAXIMUM NUMBER OF ITERATIONS : %d\n', ITMAX); ttt = fscanf(ifp,'%s',[1]); % region names BSN = zeros(NB,1); BNAM = cell (NB); PD = zeros(NB,1); QD = zeros(NB,1); PG = zeros(NB,1); QG = zeros(NB,1); QGMAX = zeros(NB,1); QGMIN = zeros(NB,1); VSH = zeros(NB,1); V = ones(NB,1); DEL = zeros(NB,1); fprintf(ofp,'DETAILED OUTPUT IN PER UNIT \n');

fprintf(ofp,'\t\tGENERATOR BUS DATA\n'); fprintf(ofp,'SNO R.NO B.NO BUS NAME ---PG--- ---PD--- ---QD--- --QGMX-- --QGMN- --V SH--\n'); BSNMAX=0; for k = 1:NG ttt = fscanf(ifp,'%d %d %d',[1,3]); BSN(k) = ttt(3); ttt = fscanf(ifp,'%s',[1]); BNAM(k)= cellstr(ttt); ttt = fscanf(ifp,'%f %f %f %f %f %f',[1,6]);
45

Appendices

PD(k) = ttt(1); QD(k) = ttt(2); PG(k) = ttt(3); QG(k) = 0; QGMAX(k) = ttt(4); QGMIN(k) = ttt(5); VSH(k) = ttt(6); V(k) = VSH(k); if ( BSNMAX < BSN(k) ) BSNMAX = BSN(k); end fprintf(ofp,'%3d %4d %4d %8s %8.4f %8.4f %8.4f %8.4f %8.4f %8.4f\n',k,k,BSN(k),char(BNAM(k)),PG(k),PD(k),QD(k),QGMAX(k),QGMIN(k),VSH(k)) ; PD(k) = PD(k) /PBASE; QD(k) = QD(k) /PBASE; PG(k) = PG(k) /PBASE; QG(k) = QG(k) /PBASE; QGMAX(k) = QGMAX(k)/PBASE; QGMIN(k) = QGMIN(k)/PBASE; end fprintf(ofp,'\t\tLOAD BUS DATA\n'); fprintf(ofp,'SNO R.NO B.NO BUS NAME ---PD--- ---QD---\n'); for k = NG+1:NB ttt = fscanf(ifp,'%d %d %d',[1,3]); BSN(k) = ttt(3); ttt = fscanf(ifp,'%s',[1]); BNAM(k)= cellstr(ttt); ttt = fscanf(ifp,'%f %f',[1,2]); PD(k) = ttt(1); QD(k) = ttt(2); if ( BSNMAX < BSN(k) ) BSNMAX = BSN(k); end fprintf(ofp,'%3d %4d %4d %8s %8.4f %8.4f\n',k,k,BSN(k),char(BNAM(k)),PD(k),QD(k)); PD(k) = PD(k)/PBASE; QD(k) = QD(k)/PBASE; end PD; QD; PG; QG; QGMAX; QGMIN; BIND = zeros(BSNMAX,1); for k = 1:NB BIND(BSN(k)) = k; end ZL = (0+j*0) * zeros(NT,1); YL = (0+j*0) * zeros(NT,1); BL = (0+j*0) * zeros(NT,1);

46

Appendices

FB = zeros(NT,1); TB = zeros(NT,1); NCKT=zeros(NT,1); TAP= ones (NT,1); RAT= zeros(NT,1); KV = zeros(NT,1); LEN= zeros(NT,1); TAPMAX= ones (NT,1); TAPMIN= ones (NT,1); TAPSTP= ones (NT,1);

fprintf(ofp,'\t\tTRANSFORMER DATA FOR TOTAL NOS OF CIRCUITS\n'); fprintf(ofp,'SNO F.NO T.NO NCKT --R PU-- --X PU-- ---AN--- --RAT---\n'); for k=1:NTR ttt = fscanf(ifp,'%d %d %d %d %f %f %f %f',[1,8]); FB(k) = ttt(2); TB(k) = ttt(3); NCKT(k)= ttt(4); ZL(k) = complex(ttt(5),ttt(6)); TAP(k) = ttt(7); BL(k) = complex(0,0); RAT(k) = ttt(8)/PBASE; LEN(k) = 0; KV(k) = 0; BL(k)= BL(k) * NCKT(k); ZL(k)= ZL(k) / NCKT(k); YL(k) = 1/ZL(k); ttt = fscanf(ifp,'%f %f %f',[1,3]); TAPMAX(k) = ttt(1); TAPMIN(k) = ttt(2); TAPSTP(k) = ttt(3); fprintf(ofp,'%3d %4d %4d %4d %8.4f %8.4f %8.4f %8.4f \n',k,FB(k),TB(k),NCKT(k),real(ZL(k)),imag(ZL(k)),TAP(k),RAT(k)); end fprintf(ofp,'\t\tLINE DATA FOR TOTAL NOS OF CIRCUITS\n'); fprintf(ofp,'SNO F.NO T.NO NCKT --R PU-- --X PU-- --HLC--- --RAT--- ---AN---\n'); for k=NTR+1:NT ttt = fscanf(ifp,'%d %d %d %d %f %f %f %f %f %f',[1,10]); FB(k) = ttt(2); TB(k) = ttt(3); NCKT(k)= ttt(4); ZL(k) = complex(ttt(5),ttt(6)); BL(k) = complex(0,ttt(7)); RAT(k) = ttt(8)/PBASE; LEN(k) = ttt(9); KV(k) = ttt(10); BL(k)= BL(k) * NCKT(k); ZL(k)= ZL(k) / NCKT(k); if LEN(k)>0 && KV(k)>0 % X by NCKT % / NCKT % Line length & KV
47

% X by NCKT % / NCKT

Appendices

ZBASE = KV(k) * KV(k) / PBASE; ZL(k) = ZL(k) * LEN(k) / ZBASE; BL(k) = BL(k) * LEN(k) * ZBASE; end

% KV*KV/PBASE

YL(k) = 1/ZL(k); fprintf(ofp,'%3d %4d %4d %4d %8.4f %8.4f %8.4f %8.4f %8.4f\n',k,FB(k),TB(k),NCKT(k),real(ZL(k)),imag(ZL(k)),BL(k),RAT(k),TAP(k)); end YL; SNO = zeros(NSH,1); SUS = zeros(NSH,1); SUSMAX = zeros(NSH,1); SUSMIN = zeros(NSH,1); SUSSTP = zeros(NSH,1); fprintf(ofp,'\t\tSHUNT CAPACITOR DATA\n'); fprintf(ofp,'SNO B.NO -MVAR-pu-\n'); for k = 1:NSHC % Fixed capacitors ttt = fscanf(ifp,'%d %d %f',[1,3]); SNO(k) = ttt(2); SUS(k) = ttt(3) / PBASE; fprintf(ofp,'%3d %4d %8.4f\n',k,SNO(k),SUS(k)); end fprintf(ofp,'\t\tSWITCHABLE CAPACITOR DATA\n'); fprintf(ofp,'SNO B.NO --MAX--- --MIN--- --STEP-- -ACTUAL-\n'); fprintf(ofp,' --MVAR-- --MVAR-- --MVAR-- --MVAR--\n'); for k = NSHC+1 : NSHC+NSVS ttt = fscanf(ifp,'%d %d %f %f %f %f',[1,6]); SNO(k) = ttt(2); SUSMAX(k) = ttt(3) / PBASE; SUSMIN(k) = ttt(4) / PBASE; SUSSTP(k) = ttt(5) / PBASE; SUS(k) = ttt(6) / PBASE; fprintf(ofp,'%3d %4d %8.4f %8.4f %8.4f %8.4f\n',k,SNO(k),SUSMAX(k),SUSMIN(k),SUSSTP(k),SUS(k)); end fprintf(ofp,'\t\tSHUNT REACTOR DATA\n'); fprintf(ofp,'SNO B.NO --MVAR--\n'); for k = NSHC+NSVS+1 : NSH ttt = fscanf(ifp,'%d %d %f',[1,3]); SNO(k) = ttt(2); SUS(k) = -ttt(3) / PBASE; fprintf(ofp,'%3d %4d %8.4f\n',k,SNO(k),SUS(k)); end
48

Appendices

PGMAX = zeros(NG,1); PGMIN = zeros(NG,1); ap = zeros(NG,1); bp = zeros(NG,1); cp = zeros(NG,1); fprintf(ofp,'\t\tOPTIMIZATION DATA\n'); fprintf(ofp,'SNO B.NO --PGMAX- --PGMIN- --AP---- -BP----- --CP----\n'); fprintf(ofp,' --MW-PU- --MW-PU- -------- -------- --------\n'); for k = 1 : NG ttt = fscanf(ifp,'%d %d %f %f %f %f %f',[1,7]); kk = BIND(ttt(2)); PGMIN(kk) = ttt(3) / PBASE; PGMAX(kk) = ttt(4) / PBASE; ap(kk) = ttt(5); bp(kk) = PBASE * ttt(6); cp(kk) = PBASE^2 * ttt(7); fprintf(ofp,'%3d %4d %8.4f %8.4f %8.4f %8.4f %8.4f\n',k,ttt(2),PGMAX(kk),PGMIN(kk),ap(kk),bp(kk),cp(kk)); end ap; bp; cp; function YBUS global NB NBB NS NG NLB NTR NTRL NT NSHC NSVS NSHR NSH NREG global VSLACK TOLER PBASE VLMAX VLMIN ITMAX global BIND BSN BNAM PG QG PD QD V DEL QGMAX QGMIN VSH global FB TB NCKT YL ZL BL TAP RAT KV LEN TAPMAX TAPMIN TAPSTP global SNO SUS SUSMAX SUSMIN SUSSTP global YB global LAM global PGMAX PGMIN VGMAX VGMIN ap bp cp global Y Theta global ofp ifp % output and input file pointers YB = (0+j*0) * zeros(NB,NB); for k=1:NT k1 = BIND(FB(k)); k2 = BIND(TB(k)); YB(k1,k2) = YB(k1,k2) - YL(k)/TAP(k); % Off Diagonal Elements
49

%% Creating an empty 6x6 matrix

Appendices

YB(k2,k1) = YB(k2,k1) - YL(k)/TAP(k); YB(k1,k1) = YB(k1,k1) + BL(k) + YL(k)/(TAP(k)^2); YB(k2,k2) = YB(k2,k2) + BL(k) + YL(k); end for k = 1:NSH k1 = BIND(SNO(k)); YB(k1,k1) = YB(k1,k1) + SUS(k); end % Converting to real and angle YB Y = abs(YB) Theta = angle(YB) % Diagonal Elements

function SIX_BUS_LAMPQ global Lamp Lamq % Assumptions of Lamp and Lamq Lamp = [200; 200; 0; 0; 0; 0]; Lamq = [0 ; 0; 100; 100; 100; 100];

function HESSIAN global PG QG PD QD DEL V NG NB PD Y global Lamp Lamq global PP AB global ap bp cp global Y Theta global HESSIAN_INV DEL_Degree % Forming vector for all variables. ALL_VAR = [PG; DEL; V; Lamp; Lamq]; % Retriving required variables required for calculation. PG_i = ALL_VAR(1 : NG); DEL_i = ALL_VAR(NB+1+1 : NB+NB); V_i = ALL_VAR(NB+NB+NG+1 : NB+NB+NB); Lamp_i = ALL_VAR(NB+NB+NB+1 : NB+NB+NB+NB); Lamq_i = ALL_VAR(NB+NB+NB+NB+NG+1 : NB+NB+NB+NB+NB); %--------------------checking-------------------------------50

Appendices

%------------------CALCULATION OF FUNCTION---------------F = zeros(NG,1); for i =1:NG F(i,1) = (ap(i)*PG(i,1)^2 + bp(i)*PG(i,1) + cp(i)); end F = sum(F,1); % Rename DEL as Del Del = DEL; %---Calculations of Initial Constraints for every bus (Real Power constraint) cons_p = zeros(NB,1); for i = 1:NB Deli(1:NB,1) = Del(i); Vi(1:NB,1) = V(i); cons_p(i,1) = PG(i)-PD(i)-V(i)*(sum(V.*Y(i,1:NB)'.*cos(Deli-Del(1:NB)Theta(i,1:NB)'))); end

%---Calculations of Initial Constraints for every bus (Real Power constraint) cons_q = zeros(NB,1); for i = 1:NB Deli(1:NB,1) = Del(i); Vi(1:NB,1) = V(i); cons_q(i,1) = QG(i)-QD(i)-V(i)*(sum(V.*Y(i,1:NB)'.*sin(Deli-Del(1:NB)Theta(i,1:NB)'))); end % Iterations to find solution------------------------for k=1:30 % .m files for calculating double derivatives wrt. variables. % Calculation of mismatch also. PG_all; % .m file for calculating double derivatives wrt. PG1...PGn. PG_ALL =[PG_PG,DEL_PG,VG_PG,LAMP_PG,LAMP_QG]; % Matrix values calculated. L_PG; % Mismatch dL/dPg. DEL_all; % .m file for calculating double derivatives wrt.DEL1...DELn. DEL_ALL = [PG_DEL,DEL_DEL,V_DEL,LAMP_DEL,LAMQ_DEL]; % Matrix values calculated. L_DEL; % Mismatch dL/dDel. V_all; % .m file for calculating double derivatives wrt.V1...Vn. V_ALL = [PG_V,DEL_V,V_V,LAMP_V,LAMQ_V]; calculated.
51

% Matrix values

Appendices

L_V; % Mismatch dL/dV. Lamp_all; % .m file for calculating double derivatives wrt.Lamp1...Lampn. LAMP_ALL = [PG_LAMP,DEL_LAMP,V_LAMP,LAMP_LAMP,LAMQ_LAMP]; % Matrix values calculated. L_LAMP; % Mismatch dL/dLamp Lamq_all;% .m file for calculating double derivatives wrt.Lamq1...Lamqn. LAMQ_ALL = [PG_LAMQ,DEL_LAMQ,V_LAMQ,LAMP_LAMQ,LAMQ_LAMQ]; % Matrix values calculated. L_LAMQ; % Mismatch dL/dLamq. % Hessian Matrix HESSIAN = [PG_PG, DEL_PG, VG_PG, LAMP_PG, LAMP_QG; PG_DEL, DEL_DEL, V_DEL, LAMP_DEL, LAMQ_DEL; PG_V, DEL_V, V_V, LAMP_V, LAMQ_V; PG_LAMP, DEL_LAMP, V_LAMP,LAMP_LAMP,LAMQ_LAMP; PG_LAMQ, DEL_LAMQ, V_LAMQ,LAMP_LAMQ,LAMQ_LAMQ];

% Inverse of Hessian matrix HESSIAN_INV = inv(HESSIAN) % Mismatch (RHS) RHS =[L_PG'; L_DEL'; L_V'; L_LAMP'; L_LAMQ']; % Computation of Error Values Error_values = (HESSIAN_INV)*RHS; % Naming the errors calculated for all variables. PG_e = Error_values(1 : NG); DEL_e = Error_values(NG+1 : NG+(NB-1)); V_e = Error_values(NG+(NB-1)+1 : NG+(NB-1)+(NB-NG)); Lamp_e = Error_values(NG+(NB-1)+(NB-NG)+1 : NG+(NB-1)+(NB-NG)+NB); Lamq_e = Error_values(NG+(NB-1)+(NB-NG)+NB+1 : NG+(NB-1)+(NB-NG)+NB+(NBNG)); %Lamq_e = Error_values(NG+(NB-1)+(NB-NG)+NB+1 : NG+(NB-1)+(NBNG)+NB+(NB-NG)); % Adding zero's to value's not computed to make vector symmetrical % with intial vector PG_e = [PG_e;zeros(NB-NG,1)]; DEL_e = [zeros(1,1);DEL_e]; V_e = [zeros(NG,1);V_e]; Lamp_e = Lamp_e; Lamq_e = [zeros(NG,1);Lamq_e];

52

Appendices

% Update of values of variables (intial values + error) PG = PG + PG_e; DEL = DEL + DEL_e; V = V + V_e; Lamp = Lamp + Lamp_e; Lamq = Lamq + Lamq_e; %Calculations of Intial Constraints for every bus (Real Power constraint) cons_p = zeros(NB,1); for i = 1:NB Deli(1:NB,1) = Del(i); Vi(1:NB,1) = V(i); cons_p(i,1) = PG(i)-PD(i)-V(i)*(sum(V.*Y(i,1:NB)'.*cos(Deli-Del(1:NB)Theta(i,1:NB)'))); end

%Calculations of Intial Constraints for every bus (Real Power constraint) cons_q = zeros(NB,1); for i = 1:NB Deli(1:NB,1) = Del(i); Vi(1:NB,1) = V(i); cons_q(i,1) = QG(i)-QD(i)-V(i)*(sum(V.*Y(i,1:NB)'.*sin(Deli-Del(1:NB)Theta(i,1:NB)'))); end end

% Optimum values of variables. PG = PG*100 V %DEL DEL_Degree = DEL*(180/3.14) % converting bus angle's into degree's % Final value of Optimum Cost System_Cost = (50*PG(1,1)^2 + 351*PG(1,1) + 44.4)+(50*PG(2,1)^2 + 389*PG(2,1) + 40.6); % ------------Calculation of FIRST ROW (PG) elements and RHS% Rename DEL as Del Del = DEL; % FIRST ROW_FIRST BLOCK (PG_PG) Checked
53

Appendices

PG_PG = zeros(NG,NG); for i = 1:NG for j = 1:NG if i == j PG_PG(i,j) = 2*ap(i); else PG_PG(i,j) = 0; end end end PG_PG; %FIRST ROW_SECOND BLOCK (DEL_PG) Checked DEL_PG = zeros(NG,NB-1); for i = 1:NG for j = 1:(NB-1) DEL_PG(i,j) = 0; end end DEL_PG; %FIRST ROW_THIRD BLOCK (VG_PG) Checked VG_PG = zeros(NG,NB-NG); for i = 1:NG for j =(NB-NG) VG_PG(i,j) = 0; end end VG_PG; %FIRST ROW_FOURTH BLOCK (LAMP_PG) Checked LAMP_PG = zeros(NG,NB); for i = 1:NG for j =1:NB if i == j LAMP_PG(i,j) = -1; else LAMP_PG(i,j) = 0; end end end LAMP_PG; %FIRST ROW_FIFTH BLOCK (LAMP_QG) Checked
54

Appendices

LAMP_QG = zeros(NG,NB-NG); for i =1:NG for j =1:NB-NG LAMP_QG(i,j) = 0; end end LAMP_QG; %PG ALL ROW PG_ALL =[PG_PG,DEL_PG,VG_PG,LAMP_PG,LAMP_QG]; %-------------------RHS (L_PG)------------------------------for i = 1:NG L_PG(i) = 2*ap(i)*PG(i)+ bp(i)-Lamp(i); end L_PG; L_PG = -L_PG; % Calculation of SECOND ROW (DEL) elements and RHS%--------------------------SECOND_ROW (DEL)-----------------% Rename DEL as Del Del = DEL; %SECOND ROW_FIRST BLOCK (PG_DEL) Checked PG_DEL = zeros(NB,NG); for i = 1:(NB) for j = 1:NB PG_DEL(i,j) = 0; end end PG_DEL; PG_DEL = PG_DEL(2:NB,[1:NG]); %SECOND ROW_SECOND BLOCK (DEL_DEL) CHECKED OK for i = 1:NB for j = 1:NB if i == j Deli(1:NB,1) = Del(i); Vi(1:NB,1) = V(i); DEL_DEL(i,j) = Lamp(i)*(V(i)*((sum(V.*Y(i,1:NB)'.*-cos(Deli-DelTheta(i,1:NB)'))-V(i)*Y(i,i)*-cos(Del(i)-Del(i)Theta(i,i)))))+sum(Lamp.*V.*Vi.*Y(1:NB,i).*-cos(Del-Deli-Theta(1:NB,i)))(Lamp(i)*V(i)*(V(i)*Y(i,i)*-cos(Del(i)-Del(i)Theta(i,i))))+Lamq(i)*(V(i)*((sum(V.*Y(i,1:NB)'.*-sin(Deli-Del- Theta(i,1:NB)'))55

Appendices

V(i)*Y(i,i)*-sin(Del(i)-Del(i)- Theta(i,i)))))+ sum(Lamq.*V.*Vi.*Y(1:NB,i).*-sin(Del-DeliTheta(1:NB,i)))-(Lamq(i)*V(i)*(V(i)*Y(i,i)*-sin(Del(i)-Del(i)-Theta(i,i)))); else DEL_DEL(i,j) = Lamp(i)*(V(i)*V(j)*Y(i,j)*cos(Del(i)-Del(j)Theta(i,j)))+Lamp(j)*V(j)*(V(i)*Y(j,i)*cos(Del(j)-Del(i)Theta(j,i)))+Lamq(i)*(V(i)*V(j)*Y(i,j)*sin(Del(i)-Del(j)Theta(i,j)))+Lamq(j)*V(j)*V(i)*Y(j,i)*sin(Del(j)-Del(i)-Theta(j,i)); end end end DEL_DEL; DEL_DEL = DEL_DEL(2:NB,[2:NB]); %SECOND ROW_THIRD BLOCK (V_DEL) CHECKED for i = 1:NB for j = 1:NB if i == j Deli(1:NB,1) = Del(i); Vi(1:NB,1) = V(i); V_DEL(i,j) = Lamp(i)*((sum((V.*Y(i,1:NB)'.*(-sin(Deli-Del- Theta(i,1:NB)'))))V(i)*Y(i,i)*(-sin(Del(i)-Del(i)Theta(i,i)))))+(sum(Lamp.*V.*Y(1:NB,i).*sin(Del-DeliTheta(1:NB,i)))-(Lamp(i)*V(i)*(Y(i,i)*sin(Del(i)-Del(i)-Theta(i,i)))))+ Lamq(i)*(sum((V.*Y(i,1:NB)'.*cos(Deli-DelTheta(i,1:NB)')))-V(i)*Y(i,i)*cos(Del(i)Del(i)- Theta(i,i))) + (sum(Lamq.*V.*Y(1:NB,i).*(-cos(Del-DeliTheta(1:NB,i))))-(Lamq(i)*V(i)*Y(i,i)*(-cos(Del(i)-Del(i)-Theta(i,i))))); else V_DEL(i,j) = Lamp(i)*V(i)*Y(i,j)*(-sin(Del(i)-Del(j)-Theta(i,j)))+ Lamp(j)*V(i)*Y(j,i)*sin(Del(j)-Del(i)-Theta(j,i))+ Lamq(i)*V(i)*Y(i,j)*cos(Del(i)-Del(j)Theta(i,j))+ Lamq(j)*V(i)*Y(j,i)*(-cos(Del(j)-Del(i)-Theta(j,i))); end end end V_DEL; V_DEL = V_DEL(2:NB,[NG+1:NB]); % Extra Step Added % V_DEL = zeros(NB,NB); % V_DEL = V_DEL(2:NB,[NG+1:NB]); %SECOND ROW_FOURTH BLOCK (LAMP_DEL) % CHECKED for i = 1: NB %(NB-1) for j = 1:NB if i == j Vi(1:NB,1) = V(i);
56

Appendices

Deli(1:NB,1) = Del(i); LAMP_DEL(i,j) = -V(i)*(sum((V.*Y(i,1:NB)'.*sin(Deli-Del- Theta(i,1:NB)')))... -V(i)*Y(i,i)*sin(Del(i)-Del(i)- Theta(i,i))); else Vi(1:NB,1) = V(i); Deli(1:NB,1) = Del(i); LAMP_DEL(i,j) = V(j)*(V(i)*Y(j,i)*sin(Del(j)-Del(i)-Theta(j,i))); end end end LAMP_DEL; LAMP_DEL = LAMP_DEL(2:NB,[1:NB]); %SECOND ROW_FIFTH BLOCK (LAMQ_DEL)CHECKED for i = 1:NB for j = 1:NB if i == j Vi(1:NB,1) = V(i); Deli(1:NB,1) = Del(i); LAMQ_DEL(i,j) = V(i)*(sum((V.*Y(i,1:NB)'.*cos(Deli-Del- Theta(i,1:NB)')))V(i)*Y(i,i)*cos(Del(i)-Del(i)- Theta(i,i))); else Vi(1:NB,1) = V(i); Deli(1:NB,1) = Del(i); LAMQ_DEL(i,j) = -V(j)*((V(i)*Y(j,i)*cos(Del(j)-Del(i)-Theta(j,i)))); end end end LAMQ_DEL; LAMQ_DEL = LAMQ_DEL(2:NB,[NG+1:NB]); % Extra Step Added % LAMQ_DEL = zeros(NB,NB); % LAMQ_DEL = LAMQ_DEL(2:NB,[NG+1:NB]); %DEL ALL ROW DEL_ALL = [PG_DEL,DEL_DEL,V_DEL,LAMP_DEL,LAMQ_DEL]; %------------------- RHS (L_DEL)----------------------------for i = 1:NB Deli(1:NB,1) = Del(i); Vi(1:NB,1) = V(i); L_DEL(i) = Lamp(i)*(V(i)*((sum(V.*Y(i,1:NB)'.*(-sin(Deli-Del- Theta(i,1:NB)'))))V(i)*Y(i,i)*(-sin(Theta(i,i)))))+ sum(Lamp.*V.*Vi.*Y(1:NB,i).*sin(Del-DeliTheta(1:NB,i)))-Lamp(i)*V(i)*V(i)*Y(i,i)*sin(57

Appendices

Theta(i,i))+Lamq(i)*(V(i)*(sum(V.*Y(i,1:NB)'.*cos(Deli-DelTheta(i,1:NB)'))V(i)*Y(i,i)*cos(- Theta(i,i)))) +sum(Lamq.*V.*Vi.*Y(1:NB,i).*(-cos(Del-DeliTheta(1:NB,i))))-Lamq(i)*V(i)*(V(i)*Y(i,i)*(-cos(-Theta(i,i)))); end L_DEL; %Extra Term Added L_DEL = -L_DEL(2:NB); %-----------------------THIRD ROW (V)-----------------------% Rename DEL as Del Del = DEL; %THIRD ROW_FIRST BLOCK (PG_V) Checked for i = 1:(NB) for j = 1:NB PG_V(i,j) = 0; end end PG_V; PG_V = PG_V(NG+1:NB,[1:NG]); %THIRD ROW_SECOND BLOCK (DEL_V) CHECKED for i = 1:(NB) for j = 1:(NB) if i == j Deli(1:3,1) = Del(i); Vi(1:3,1) = V(i); DEL_V (i,j) = Lamp(i)*(sum(V.*Y(i,1:NB)'.*(-sin(Deli-Del- Theta(i,1:NB)')))V(i)*Y(i,i)*(-sin(Del(i)-Del(i)Theta(i,i))))+(sum(Lamp.*V.*Y(1:NB,i).*sin(Del-DeliTheta(1:NB,i)))-(Lamp(i)*V(i)*Y(i,i)*sin(Del(i)-Del(i)Theta(i,i))))+Lamq(i)*(sum(V.*Y(i,1:NB)'.*cos(Deli-DelTheta(i,1:NB)'))(V(i)*Y(i,i)*cos(Del(i)-Del(i)-Theta(i,i))))+(sum(Lamq.*V.*Y(1:NB,i).*(-cos(Del-DeliTheta(1:NB,i))))-(Lamq(i)*V(i)*Y(i,i)*(-cos(Del(i)-Del(i)-Theta(i,i))))); else DEL_V(i,j) = Lamp(i)*V(j)*Y(i,j)*sin(Del(i)-Del(j)Theta(i,j))+Lamp(j)*V(j)*Y(j,i)*(-sin(Del(j)-Del(i)-Theta(j,i)))+Lamq(i)*V(j)*Y(i,j)*(cos(Del(i)-Del(j)-Theta(i,j)))+Lamq(j)*V(j)*Y(j,i)*cos(Del(j)-Del(i)-Theta(j,i)); end end end DEL_V; DEL_V = DEL_V(NG+1:NB,[2:NB]); % Extra Step Added % DEL_V = zeros(NB,NB);
58

Appendices

% DEL_V = DEL_V(NG+1:NB,[2:NB]); %THIRD ROW_THIRD BLOCK (V_V) CHECKED for i = 1:NB for j = 1:NB if i == j V_V(i,j) = Lamp(i)*(2*Y(i,i)*cos(-Theta(i,i))) +Lamq(i)*(2*Y(i,i)*sin(-Theta(i,i))); else V_V(i,j) = Lamp(i)*(Y(i,j)*cos(Del(i)-Del(j)-Theta(i,j)))+Lamp(j)*(Y(j,i)*cos(Del(j)Del(i)-Theta(j,i)))+Lamq(i)*(Y(i,j)*sin(Del(i)-Del(j)Theta(i,j)))+Lamq(j)*(Y(j,i)*sin(Del(j)-Del(i)-Theta(j,i))); end end end V_V; %Extra Step Added V_V = V_V(NG+1:NB,[NG+1:NB]); %THIRD ROW_FOURTH BLOCK (LAMP_V) CHECKED for i = 1:(NB) for j = 1:NB if i == j Deli(1:3,1) = Del(i); LAMP_V(i,j) = 2*V(i)*Y(i,i)*cos(-Theta(i,i)) +(sum(V.*Y(i,1:NB)'.*cos(Deli-DelTheta(i,1:NB)')))V(i)*Y(i,i)*cos(Del(i)-Del(i)- Theta(i,i)); %2*V(i)*Y(i,i)*cos(-Theta(i,i)) + sum((V.*Y(i,1:NB)'.*cos(Deli-Del- Theta(i,1:NB)'))-Y(i,i)*cos(Del(i)-Del(i)- Theta(i,i))); else LAMP_V(i,j) = V(j)*(Y(j,i)*cos(Del(j)-Del(i)-Theta(j,i))); end end end LAMP_V; LAMP_V = LAMP_V(NG+1:NB,[1:NB]); % Extra Step Added % LAMP_V = zeros(NB,NB); % LAMP_V = LAMP_V(NG+1:NB,[1:NB]); %THIRD ROW_FIFTH BLOCK (LAMQ_V) CHECKED for i = 1:(NB) for j = 1:(NB)
59

Appendices

if i ==j Deli(1:3,1) = Del(i); LAMQ_V(i,j) = 2*V(i)*Y(i,i)*sin(-Theta(i,i))... +(sum(V.*Y(i,1:NB)'.*sin(Deli-Del- Theta(i,1:NB)')-V(i)*Y(i,i)*sin(Del(i)Del(i)- Theta(i,i)); else LAMQ_V(i,j) = V(j)*Y(j,i)*sin(Del(j)-Del(i)-Theta(j,i)); end end end LAMQ_V; LAMQ_V = LAMQ_V(NG+1:NB,[NG+1:NB]); %VOLTAGE (V) ALL ROW V_ALL = [PG_V,DEL_V,V_V,LAMP_V,LAMQ_V]; %--------------------RHS (L_V)------------------------------for i = 1:NB Deli(1:NB,1) = Del(i); Vi(1:NB,1) = V(i); L_V(i) = Lamp(i)*(2*V(i)*Y(i,i)*cos(-Theta(i,i)))... +Lamp(i)*(sum(V.*Y(i,1:NB)'.*cos(Deli-DelTheta(i,1:NB)'))-(V(i)*Y(i,i)*cos(Theta(i,i))))... +sum(Lamp.*V.*Y(1:NB,i).*cos(Del-Deli-Theta(1:NB,i)))Lamp(i)*V(i)*Y(i,i)*cos(-Theta(i,i))... +Lamq(i)*(2*V(i)*Y(i,i)*sin(-Theta(i,i)))... +Lamq(i)*(sum(V.*Y(i,1:NB)'.*sin(Deli-DelTheta(i,1:NB)'))-(V(i)*Y(i,i)*sin(Theta(i,i))))... +sum(Lamq.*V.*Y(1:NB,i).*sin(Del-Deli-Theta(1:NB,i)))-Lamq(i)*V(i)*Y(i,i)*sin(Theta(i,i)); end L_V; %Addition term added L_V = -L_V(NG+1:NB); % Earlier [NG+1:NB] %-----------------------------FOURTH ROW (LAMP)-------------% Rename DEL as Del Del = DEL; %FOURTH ROW_FIRST BLOCK (PG_LAMP) Checked for i =1:NB for j =1:NB if i == j PG_LAMP(i,j) = -1; else
60

Appendices

PG_LAMP(i,j) = 0; end end end PG_LAMP; PG_LAMP = PG_LAMP(1:NB,[1:NG]); %FOURTH ROW_SECOND BLOCK (DEL_LAMP) CHECKED for i = 1:NB for j = 1:(NB) if i==j; Deli(1:NB,1) = Del(i); DEL_LAMP(i,j)= V(i)*(sum((V.*Y(i,1:NB)'.*-sin(Deli-DelV(i)*Y(i,i)*-sin(Del(i)-Del(i)- Theta(i,i))); else DEL_LAMP(i,j) = V(i)*V(j)*Y(i,j)*sin(Del(i)-Del(j)-Theta(i,j)); end end end DEL_LAMP; DEL_LAMP = DEL_LAMP(1:NB,[2:NB]);

Theta(i,1:NB)')))-

%FOURTH ROW_THIRD BLOCK (V_LAMP) CHECKED for i = 1:NB for j = 1:(NB) if i ==j Deli(1:3,1) = Del(i); V_LAMP(i,i) = 2*V(i)*Y(i,i)*cos(-Theta(i,i))+(sum(V.*Y(i,1:NB)'.*cos(Deli-DelTheta(i,1:NB)')))-V(i)*Y(i,i)*cos(Del(i)-Del(i)- Theta(i,i)); else V_LAMP(i,j) = V(i)*Y(i,j)*cos(Del(i)-Del(j)-Theta(i,j)); end end end V_LAMP; V_LAMP = V_LAMP(1:NB,[NG+1:NB]); % New Term Added % V_LAMP = zeros(NB,NB); % V_LAMP = V_LAMP(1:NB,[NG+1:NB]); %FOURTH ROW_FOURTH BLOCK (LAMP_LAMP) Checked for i = 1:NB for j =1:NB LAMP_LAMP(i,j) = 0;
61

Appendices

end end LAMP_LAMP; LAMP_LAMP = LAMP_LAMP(1:NB,[1:NB]); %FOURTH ROW_FIFTH BLOCK( LAMQ_LAMP) Checked for i = 1:NB for j =1:(NB) LAMQ_LAMP(i,j) = 0; end end LAMQ_LAMP; LAMQ_LAMP = LAMQ_LAMP(1:NB,[NG+1:NB]); %LAMP ROW LAMP_ALL = [PG_LAMP,DEL_LAMP,V_LAMP,LAMP_LAMP,LAMQ_LAMP]; %-rhs dl_lp

= V(1)*V(1)*Y(1,1)*cos(-Theta(1,1))... +V(1)*(... +V(2)*Y(1,2)*cos(Del(1)-Del(2)-Theta(1,2)) +v(2)*y(3,2)*cos(d(3)-d(2)-t(3,2)) +v(3)*y(4,3)*cos(d(4)-d(3)-t(4,3)) +V(4)*Y(1,4)*cos(Del(1)-Del(4)-Theta(1,4)) +V(5)*Y(1,5)*cos(Del(1)-Del(5)-Theta(1,5)) +v(6)*y(4,6)*cos(d(4)-d(6)-t(4,6)) +0) l_lp = - dl_lp %-------------------RHS (L_Lamp)----------------------------for i = 1:NB Deli(1:NB,1) = Del(i); Vi(1:NB,1) = V(i); L_LAMP(i) = V(i)*(sum(V.*Y(i,1:NB)'.*cos(Deli-Del- Theta(i,1:NB)')))-PG(i)+PD(i); end L_LAMP; % Addition term Added L_LAMP = -L_LAMP(1:NB); %----------------------FIFTH BLOCK (LAMQ)-----------------------------% Rename DEL as Del Del = DEL; %FIFTH ROW_FIRST BLOCK (PG_LAMQ) Checked for i = 1:(NB)
62

Appendices

for j =1:NB PG_LAMQ(i,j) = 0; end end PG_LAMQ; PG_LAMQ = PG_LAMQ(NG+1:NB,[1:NG]); %FIFTH ROW_SECOND BLOCK (DEL_LAMQ) CHECKED for i = 1:(NB) for j = 1:(NB) if i == j Deli(1:NB,1) = Del(i); DEL_LAMQ(i,j) = V(i)*(sum(V.*Y(i,1:NB)'.*cos(Deli-Del- Theta(i,1:NB)'))V(i)*Y(i,i)*cos(Del(i)-Del(i)- Theta(i,i))); else DEL_LAMQ(i,j) = V(i)*V(j)*Y(i,j)*-cos(Del(i)-Del(j)-Theta(i,j)); end end end DEL_LAMQ; DEL_LAMQ = DEL_LAMQ(NG+1:NB,[2:NB]); % Extra Added % DEL_LAMQ = zeros(NB,NB); % DEL_LAMQ = DEL_LAMQ(NG+1:NB,[2:NB]); %FIFTH ROW_THIRD BLOCK (V_LAMQ)CHECKED for i = 1:(NB) for j = 1:(NB) if i == j Deli(1:3,1) = Del(i); V_LAMQ(i,j) = 2*V(i)*Y(i,i)*sin(-Theta(i,i))+(sum(V.*Y(i,1:NB)'.*sin(Deli-DelTheta(i,1:NB)')))-V(i)*Y(i,i)*sin(Del(i)-Del(i)- Theta(i,i)); else V_LAMQ(i,j) = V(i)*Y(i,j)*sin(Del(i)-Del(j)-Theta(i,j)); end end end V_LAMQ; V_LAMQ = V_LAMQ(NG+1:NB,[NG+1:NB]); %FIFTH ROW_FOURTH BLOCK (LAMP_LAMQ) Checked for i = 1:(NB)
63

Appendices

for j = 1:(NB) LAMP_LAMQ(i,j) = 0; end end LAMP_LAMQ; LAMP_LAMQ = LAMP_LAMQ(NG+1:NB,[1:NB]); %FIFTH ROW_FIFTH BLOCK (LAMQ_LAMQ) Checked for i = 1:(NB) for j = 1:(NB) LAMQ_LAMQ(i,j) = 0; end end LAMQ_LAMQ; LAMQ_LAMQ = LAMQ_LAMQ(NG+1:NB,[NG+1:NB]); %LAMQ ROW LAMQ_ALL = [PG_LAMQ,DEL_LAMQ,V_LAMQ,LAMP_LAMQ,LAMQ_LAMQ]; %-------------------RHS (L_LAMQ)-----------------------------for i = 1:NB Deli(1:NB,1) = Del(i); Vi(1:NB,1) = V(i); L_LAMQ(i) = V(i)*sum(V.*Y(i,1:NB)'.*sin(Deli-Del-Theta(i,1:NB)'))-QG(i)+QD(i); end L_LAMQ; % Addition term Added L_LAMQ = -L_LAMQ(NG+1:NB);

64

References

REFERENCES
[1] Carpentier, "Optimal Power Flows", Electrical Power and Energy Systems, Vol. 1, April 1979, pp. 959-972. [2] The Global Wind Energy Council Annual Market Update Report 2011 [Online]. Available:http://www.gwec.net/index.php? id=13. Accessed on 2011-07-06 [3] G. Kariniotakis, I. Marti, I. H-P. Waldl, I. Marti, G. Giebel, T.S. Nielsen, J. Tambke, J. Usaola, "Next Generation forecasting tools for the optimal management of wind generation," 2006 International Conference on Probabilistic techniques Applied to power systems, pp. 1-6, June 2006. [4] A.Papoulis and S. Pillai, "Probability, Random Variables, and Stochastic Processes," (McGraw-Hill, Boston, 2002, 4th edition). [5] A. Schellenberg, W. Rosehart, et. al, "Cumulant-based probabilistic optimal power flow (P-OPF) with Gaussian and gamma distributions,'' IEEE Trans. Power Syst., vol. 20, no. 2, pp. 773-781, May 2005. [6] M. Madrigal, K. Ponnambalam, V. H. Quintana, "Probabilistic optimal power flow," in Proc. IEEE Can. Conf. Electrical Computer Engineering, Waterloo, ON, Canada, May 1998, pp. 385-388. [7] Maryam Dadkhah and B. Venkatesh, "Cumulant based Stochastic Reactive Power Planning technique for Distribution systems with Wind Generators", IEEE Transactions on Power Systems, 2012.

65

References

[8]

D. I. Sun, B. Ashley, B. Brewer, A. Hughes and W. F. Tinney, et. al, "Optimal Power Flow by Newton technique", IEEE Transaction on Power Apparatus and Systems, vol. PAS-103, no. 10, pp. 2864-2880, October 1984.

[9] H.-J. Zimmermann, "Fuzzy Set Theory and its Applications", Kluwer Academic Publishers, 2004.

Massachusetts:

[10] P. Yu and B. Venkatesh, "A Real-Time OPF technique using New Triangular Approximate Model of Wind Electric Generators", Approved in IEEE Transaction in Power Systems, 2012. [11] A.H. Mantawy, M.S. AI-Ghamdi, A new reactive power optimization algorithm, pp. 1 - 6, June 2003. [12] Mooney, Christopher Z, "Monte Carlo Simulation", California: Sage Publications, 1997.

66

