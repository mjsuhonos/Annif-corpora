INTEGRATION OF PRECISE POINT POSITIONING AND REDUCED INERTIAL SENSORS SYSTEM

By Hassan Elobeid Ibrahim BEng. Civil Engineering, Ryerson University, 2005 MASc Civil Engineering, Ryerson University, 2008

A dissertation presented to Ryerson University in partial fulfilment of the requirements for the degree of Doctor of Philosophy in the Program of Civil Engineering

Toronto, Ontario, Canada 2016 © (Hassan Elobeid Ibrahim) 2016

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A DISSERTATION
I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revision, as accepted by my examiners. I authorize Ryerson University to lend this dissertation to other institution or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this dissertation by photocopies or any other means, in total or part, at the request of other institution or individual for the purpose of scholarly research. I understand that my dissertation may be made electronically available to the public.

ii

ABSTRACT

INTEGRATION OF PRECISE POINT POSITIONING AND REDUCED INERTIAL SENSORS SYSTEM Hassan Elobeid Ibrahim PhD Civil Engineering, Ryerson University 2016

In Global Positioning System (GPS), Precise Point Positioning (PPP) achieves the highest accuracy in point positioning. It approaches centimetre-level accuracy in static mode and subdecimetre accuracy in kinematic mode. PPP is an alternative approach to carrier-phase-based Differential GPS (DGPS) and offers advantages over DGPS. PPP uses GPS observations from a single receiver for position estimation, which is simpler than using more than one GPS receiver. However, PPP needs rigorous modelling for all errors and biases, which are otherwise cancelled out or mitigated when using DGPS. PPP's popularity is on the rise, as it is ideal for land-vehicle positioning and navigation. However, in challenging environments, PPP suffers from a signal loss that prevent continuous navigation or a reduction in the number of visible satellites that causes accuracy degradation.

iii

This research integrates PPP with a Reduced Inertial Sensors System (RISS) -- a low-cost system that uses data from reduced MEMS-based inertial sensors and vehicle odometry -- to provide accurate and inexpensive land-vehicle navigation systems. The system is integrated in a tightly coupled mode through the use of an Extended Kalman Filter (EKF), which employs an improved error model for the RISS data. The system was tested using data from real driving routes with single-frequency code-based PPP/RISS (SF-code-PPP/RISS), dual-frequency code-based PPP (DF-code-PPP/RISS), smoothed dual-frequency code-based PPP (S-DF-code-PPP/RISS), and code- and carrier-phase-based PPP (code-carrier-PPP/RISS). The performance of the developed PPP/RISS was evaluated using position RMS and maximum errors during continuous GPS availability as well as during signal outages. The developed integrated algorithms were assessed using three real road tests that capture different navigational conditions. The results show that when five or more satellites are available, code-carrier-PPP/RISS solution is superior to that of SF- and DF-code-PP/RISS. For latitude, code-carrier-PPP/RISS solution was 47% and 20% more precise than the SF- and DF-codePP/RISS counterparts, respectively. For longitude, code-carrier-PPP/RISS solution was 65% and 31% more precise than the SF- and DF-Code-PP/RISS counterparts, respectively. Similarly, the altitude solution was improved by 46% and 25%, respectively. During GPS signal outages of 60 seconds, code-carrier-PPP/RISS's algorithms outperformed that of SF- and DF-code-PPP/RISS by about 35% when the satellite availability level was set to three satellites. For other satellite availability levels, the algorithms performed almost identically.

iv

AKNOWLEDGEMENTS
I would like to acknowledge and thank the NSERC and OGS, for granting me very precious scholarships. Also my appreciations goes to: Geodetic Survey Canada of Natural Resources Canada (NRCan) for providing the source code of the traditional un-differenced GPSPace PPP software, and NovAtel Inc. for providing for some time the NovAtel IMU-CPT unit. I would like to express my gratitude and appreciation to my long-term academic supervisor Dr. Ahmed El-Rabbany for his encouragement, guidance, and support throughout my undergraduate and graduate studies at Ryerson. The enthusiasm and knowledge conveyed in his teaching was one of the original reasons I choose Geomatics and pursued graduate studies. It was my great pleasure working under his supervision. I would like to express my thanks and gratitude to my academic co-supervisor, Dr. Abdelmageed Noureldin, for his supervision, encouragement, valuable suggestions, and guidance throughout my PhD research. His abundant cooperation and understanding deserve unbounded appreciation. I also would like to extend my thanks to Dr. Tashfeen Karamat, from Royal Military College for his kindness, support and guidance during data collection sessions. He was both available and extremely helpful answering questions I had regarding my research data. In addition, I wish to extend my appreciation and thanks to my PhD defense committee members, Dr. Mostafa Hefnawi, Dr. Bassam Jubran, Dr. Songinan LI, Dr. Ahmed Abdelrahman, and Dr. Julia Spaniol for dedicating their valuable times to review my thesis.

v

Finally in alphabetic order, many thanks to: Dr. Akram Afifi, Ashraf Elshorbagy, Dr. Imad Khalafalla, Kamil Faisal, Salem Morsy .and Dr. Wai Yeung Yan, my colleagues in the Department of Civil Engineering, for the nice moments, friendship, and support I received throughout the entire course of my study.

vi

DEDICATION
To my parents, Habiba, my wife, Daniyah, Elobeid, my sisters and brothers.

vii

TABLE OF CONTENTS
AUTHOR'S DECLARATION ..................................................................................................................... ii ABSTRACT ................................................................................................................................................. iii AKNOWLEDGEMENTS ............................................................................................................................. v LIST OF TABLES ......................................................................................................................................xiii LIST OF FIGURES ....................................................................................................................................xiv ABBREVIATIONS ................................................................................................................................... xvii 1 Introduction ........................................................................................................................................... 1 1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9 2 Literature Review.......................................................................................................................... 3 Developments in PPP Research .................................................................................................... 3 Integration of autonomous GPS with INS .................................................................................... 7 PPP Limitations and Challenges ................................................................................................. 10 Current State of the Art in the Area of GPS/INS Integration Techniques .................................. 10 Motivation ................................................................................................................................... 17 Objectives ................................................................................................................................... 18 Thesis Outline ............................................................................................................................. 19 Thesis Contribution ..................................................................................................................... 20

Global Positioning System .................................................................................................................. 22 2.1 2.2 2.3 2.4 2.5 2.6 GPS Overview ............................................................................................................................ 22 GPS Signal Structure .................................................................................................................. 23 Positioning Modes ...................................................................................................................... 23 Relative positioning .................................................................................................................... 23 Point positioning ......................................................................................................................... 24 PPP Mathematical Models .......................................................................................................... 26 viii

2.7 2.8 2.9 2.10 2.11

GPS Observables ........................................................................................................................ 26 Code-based PPP Model ............................................................................................................... 27 Code- and Carrier-based PPP Models ......................................................................................... 28 Doppler Measurements ............................................................................................................... 29 GPS Errors and Biases ................................................................................................................ 30 Satellite orbital errors .......................................................................................................... 31 Satellite clock errors............................................................................................................ 33 Ionospheric delay ................................................................................................................ 34 Ionosphere mitigation ......................................................................................................... 35 Tropospheric delay .............................................................................................................. 35 Receiver clock error ............................................................................................................ 36 Multipath ............................................................................................................................. 37 Satellite hardware delay estimation .................................................................................... 38 Satellite and receiver initial phase bias ............................................................................... 40 Periodic relativistic ......................................................................................................... 43 Sagnac Effect .................................................................................................................. 43 Satellites Geometry ......................................................................................................... 45

2.11.1 2.11.2 2.11.3 2.11.4 2.11.5 2.11.6 2.11.7 2.11.8 2.11.9 2.11.10 2.11.11 2.11.12 3

Inertial Navigation System.................................................................................................................. 46 3.1 3.2 INS Principle of Operation ......................................................................................................... 48 Inertial Sensors............................................................................................................................ 48 Accelerometer ..................................................................................................................... 48 Gyroscope ........................................................................................................................... 49 Inertial Sensors Classification ............................................................................................. 49

3.2.1 3.2.2 3.2.3 3.3

Microelectromechanical Systems ............................................................................................... 51 ix

3.4 3.5 3.6 3.7 3.8 4

Inertial Sensors Errors ................................................................................................................. 51 Inertial Sensors Systems ............................................................................................................. 52 Odometry Data ............................................................................................................................ 52 Reduced Inertial Sensors System ................................................................................................ 53 RISS Motion Equation ................................................................................................................ 55

GPS/INS Integration ........................................................................................................................... 59 4.1 4.2 4.3 Advantages of GPS/INS Integration ........................................................................................... 59 GPS/INS Integration Schemes .................................................................................................... 60 GPS/INS Integration Estimation Techniques.............................................................................. 64 Kalman Filter ...................................................................................................................... 64 Extended Kalman Filter (EKF) ........................................................................................... 65

4.3.1 4.3.2 4.4

Developed GPS PPP/RISS Integration System........................................................................... 67 Tightly-Coupled PPP/RISS Measurement Model ............................................................... 69 Tightly-Coupled PPP/RISS System Model ......................................................................... 69 Measurement Model ........................................................................................................... 76

4.4.1 4.4.2 4.4.3 5

Results and Analysis ........................................................................................................................... 86 5.1 5.2 5.3 5.4 5.5 RISS Configuration ..................................................................................................................... 87 Reference Solution ...................................................................................................................... 87 Time Synchronization ................................................................................................................. 88 Road Test Trajectories ................................................................................................................ 88 Trajectory 1 ................................................................................................................................. 89 Data Preprocessing .............................................................................................................. 91

5.5.1 5.6

Performance Evaluation .............................................................................................................. 95 Performance during GPS signal outages ........................................................................... 100 x

5.6.1

5.7

Trajectory 2 ............................................................................................................................... 103 Data Pre-processing .......................................................................................................... 104 Performance evaluation..................................................................................................... 109 Performance during outages.............................................................................................. 113

5.7.1 5.7.2 5.7.3 5.8

Trajectory 3 ............................................................................................................................... 116 Performance evaluation..................................................................................................... 120

5.8.1 5.9 6

Summary ................................................................................................................................... 120

Summary, Conclusions and Recommendations ................................................................................ 124 6.1 6.2 Summary and Conclusions........................................................................................................ 124 Recommendations ..................................................................................................................... 127

Appendix A ............................................................................................................................................... 129 Reference Coordinates Frames ................................................................................................................. 130 A.1 Earth-Centred Inertial Frame ......................................................................................................... 130 A.2 Earth-Centred Earth-fixed Frame ................................................................................................... 132 A.3 Geodetic Coordinate System .......................................................................................................... 132 A.4 Local Level Frame ......................................................................................................................... 133 A.5 Body Frame .................................................................................................................................... 134 A.6 Coordinates Transformation........................................................................................................... 135 A.6.1 ECI to ECEF ............................................................................................................................... 135 A.6.2 ECEF to ENU.............................................................................................................................. 136 A.6.3 Transformation of velocity from ECEF to ENU ......................................................................... 137 A.7 ENU to Body Frame ...................................................................................................................... 137 Appendix B ............................................................................................................................................... 139 Appendix C ............................................................................................................................................... 146 xi

C.1 Quality check Report of GPS Observations for Trajectory 1 ......................................................... 147 C.2 Quality check Report of GPS Observations for Trajectory 2 ......................................................... 154 C.3 Quality check Report of GPS Observations for Trajectory 3 ......................................................... 158 Bibliography ............................................................................................................................................. 165

xii

LIST OF TABLES
Table 2.1 Uncertainties of Satellite Ephemeris (Adapted from Hoffmann [2008]) .................................... 32 Table 3.2 Accuracy and Latency of GPS Precise Orbit/Clock Products .................................................... 33 Table 4.1 Comparison Between Gimballed and Strapdown Systems ......................................................... 47 Table 4.2 Classification of Inertial Navigation Systems, (Georgy, 2010) .................................................. 50 Table 5.1 Trajectories' Overall RMS (Meters) for Urban/Suburban Environment .................................. 121 Table 5.2 Summary of 2D position average maximum error (m) at different levels of satellites availability (Urban/Suburban) ..................................................................................................................................... 122 Table 5.3 Summary of 2D position average maximum error (m) at different levels of satellites availability (Urban) ................................................................................................................................... 123 Table B.1 Crossbow IMU 300CC Specifications ..................................................................................... 140 Table B.2 NovAtel SPAN CPT Specifications ......................................................................................... 141 Table B.3 Honeywell HG1700 IMU ......................................................................................................... 142 Table B.4 SPAN Reference System .......................................................................................................... 143 Table B.5 GPS error Budget (Misra and Enge, 2001; Abdelsalam, 2005; Du, 2010) .............................. 145

xiii

LIST OF FIGURES
Figure 2.1 Sagnac Effect ............................................................................................................................. 44 Figure 4.1 Sensor Bias Offset, Bias Drift and Noise .................................................................................. 52 Figure 4.2 RISS Flow Chart (Karamat, 2014) ............................................................................................ 54 Figure 4.1 GPS/INS Loosely-Coupled Integration (Gebre-Egziabher, 2007) ............................................ 61 Figure 4.2 GPS/INS Tightly-Coupled Integration (Gebre-Egziabher, 2007) ............................................. 62 Figure 4.3 GPS/INS Ultra-Tightly Coupled Integration (Gebre-Egziabher, 2007) .................................... 63 Figure 4.4 PPP/RISS Tightly Coupled Navigation System ........................................................................ 68 Figure 5.1 Part of the data collection equipment placed inside the van ...................................................... 86 Figure 5.2 Trajectory 1 ............................................................................................................................... 90 Figure 5.3 Vehicle Speed for Trajectory 1 .................................................................................................. 90 Figure 5.4 Satellites availability for trajectory 1 ......................................................................................... 92 Figure 5.5 GDOP during Trajectory 1 ........................................................................................................ 92 Figure 5.6 Sky View to Show Multipath MP1 ............................................................................................ 93 Figure 5.7 Sky View to Show Multipath MP2 ............................................................................................ 93 Figure 5.8 Sky View to Show L1 SNR ....................................................................................................... 94 Figure 5.9 Sky View to Show L2 SNR ....................................................................................................... 94 Figure 5.10 Altitude for trajectory 1 ........................................................................................................... 96 Figure 5.11 DF-code-PPP/RISS Altitude difference from reference .......................................................... 96 Figure 5.12 Comparison of different PPP based position solutions............................................................ 97 Figure 5.13 Position RMS for smoothed code and code and carrier PPP/RISS solutions .......................... 98 Figure 5.14 Convergence of Gyroscope Bias ............................................................................................. 99 Figure 5.15 Convergence of X Accelerometer ........................................................................................... 99 Figure 5.16 Convergence of Y Accelerometer ......................................................................................... 100 xiv

Figure 5.17 Average maximum positioning error for all models during outage of 60 seconds ................ 101 Figure 5.18 Performance of algorithms during complete GPS outage ..................................................... 102 Figure 5.19 Trajectory 2 ........................................................................................................................... 103 Figure 5.20 Vehicle Speed during Trajectory 2 ........................................................................................ 104 Figure 5.21 Satellites availability for trajectory 2 ..................................................................................... 105 Figure 5.22 GDOP Plot for Trajectory 2................................................................................................... 106 Figure 5.23 Sky view to show multipath MP12 during Trajectory 2 ........................................................ 107 Figure 5.24 Sky view to show multipath MP21 during Trajectory 2 ........................................................ 107 Figure 5.25 Sky view to show L1 SNR during Trajectory 2 .................................................................... 108 Figure 5.26 Sky view to show L2 SNR during Trajectory 2 .................................................................... 109 Figure 5.27 Comparison of different PPP-based position solutions ......................................................... 110 Figure 5.28 DF-Code PPP and DF-Code PPP/RISS altitude differences from reference ......................... 111 Figure 5.29 Code-carrier-PPP and Code-Carrier PPP/RISS altitude differences from reference ............. 111 Figure 5.30 Convergence of Gyroscope Bias ........................................................................................... 112 Figure 5.31 Convergence of X Accelerometer ......................................................................................... 113 Figure 5.32 Convergence of Y Accelerometer ......................................................................................... 113 Figure 5.33 Average maximum positioning error for all models during outage of 60 seconds ................ 114 Figure 5.34 Performance of algorithms during complete outage .............................................................. 115 Figure 5.35 Trajectory 3 ........................................................................................................................... 116 Figure 5.36 Vehicle's speed for trajectory 3 ............................................................................................. 117 Figure 5.37 Satellite Availability during Trajectory 3 .............................................................................. 118 Figure 5.38 GDOP for Trajectory 3 .......................................................................................................... 119 Figure 5.39 Repeated GPS signal outages ................................................................................................ 119 Figure 5.40 Two-dimensional position maximum error for natural outages during Trajectory 3 ............ 120

xv

Figure A.1 Earth-Centred Inertial and Earth-Centred Earth-Fixed Reference Frames ............................. 131 Figure A.2 Geodetic Coordinate System .................................................................................................. 133 Figure A.3 North-oriented Local Level Frame ......................................................................................... 134 Figure A.4 Body Frame ............................................................................................................................ 135

xvi

ABBREVIATIONS
AFS Atomic Frequency Standards AI Artificial Intelligence ANFIS Adaptive Neural Fuzzy Inference Systems ANN Artificial Neural Networks C/A code Coarse/ Acquisition Code-Carrier-PPP/RISS Code and Carrier PPP/RISS CODE Centre for Orbit Determination in Europe DD Double Difference DF-Code-PPP/RISS Dual-Frequency Code PPP/RISS DGPS Differential Global Positioning System DoD Department of Defence DOP Dilution of Precision DR Dead-reckoning ECEF Earth Centered Earth Fixed ECI Earth-Centered Inertial System EKF Extended Kalman Filter ENU East North Up FOG Fiber-optic Gyroscope GDOP Geometric Dilution of Precision GIM Global Ionosphere Maps
xvii

GLONASS Global Navigation Satellite System "GLObalnaya NAvigatsionnaya Sputnikovaya Sistema" GNSS Global Navigation Satellite Systems GPS Global Positioning System IE Inertial Explorer IF Ionospheric Free IGS International GNSS Service IMU Inertial Measurement Unit INS Inertial Navigation System IONEX IONosphere Exchange format ISA Inertial Sensor Assembly JPL Jet Propulsion Laboratory KF Kalman Filter LC Linear Combination LKF Linearized Kalman Filter LLF Local Level Frame MCS Master Control Station MEDLL Multipath Elimination Delay Lock loop MEMS Micro-Electro-Mechanical Systems MSE Mean Square Error NAVSTAR NAVigational System using Timing and R NMF Niell Mapping Function
xviii

NOAA National Oceanic and Atmospheric Admin NOAATrop NOAA Tropospheric Model NRCan Natural Resources Canada NWP Numerical Weather Prediction OBD On Board Diagnostics P-code Precise PDF Probability Density Function PDOP Position Dilution of Precision PF Particle Filter PPP Precise Point Positioning PRN Pseudo-random noise RBA Resonating Beam Accelerometers RINEX Receiver-Independent Exchange For RISS Reduced Inertial Sensor System RLG Ring Laser Gyroscopes RMS Root Mean Square RRSD Receiver-Receiver Single Difference RTK Real Time Kinematic SDF-Code-PPP/RISS Smoothed Dual-Frequency PPP/RISS SD Single Difference SF-Code-PPP/RISS Single-Frequency PPP/RISS SNR Signal to Noise ratio
xix

SPAN Synchronized Position Attitude Navigation SSD Satellite-Satellites Single Difference STEC Slant Total Electron Content TC Tightly-Coupled TEC Total Electron Content UKF Unscented Kalman Filter UNB University of New Brunswick US-TEC United States Total Electron Content UTC Ultra-Tightly Coupled VMF1 Vienna Mapping Function 1 VTEC Vertical Total Electron Content WL Wide-Lane

xx

Chapter 1 1 Introduction
The integration of Global Positioning System (GPS) and Inertial Navigation System (INS) often refers to the data fusion of measurements obtained from a GPS receiver and inertial sensors (accelerometers and gyroscopes). GPS/INS integration is formulated as a state-space estimation problem where the Kalman Filter (KF), or a modified version of it, is applied to obtain suboptimal solutions. In many applications, GPS provides positioning information with consistent and acceptable accuracy when a GPS receiver gets signals from four or more GPS satellites (Grewal et al., 2007). However, GPS suffers from problems such as signal outage and multipath, which degrades its accuracy or even makes the system useless. In order to look for a continuous positioning solution, integration of GPS and INS is one of the available viable solutions. INS is an autonomous system that is immune to external interference; however, its accuracy decreases in the long term because of the sensor's bias error drift, scale factor instability, and misalignment (Gleason and Gebre-Egziabher, 2009). Integrating GPS and INS benefits from each system's advantages such that the integration overcomes drawbacks of each individual system; the INS reaps the merits from the accuracy of GPS, while GPS benefits from the INS continuity. The most commonly used estimation technique for GPS/INS integration is KF. KF showed adequate performance in handling linear INS errors, especially when high-grade (IMU) is used. The use of micro-electromechanical system (MEMS)-based IMU reduced the GPS/INS solution cost significantly. However, this solution's performance degrades very quickly in contrast to
1

higher grades of IMUs. This fact negatively impacts the performance of the MEMS-based GPS/INS navigation solution during GPS outages where severe error growth in position occurs. The commonly used Linearized KF (LKF) and Extended KF (EKF) adopt linearized error-state models. According to Noureldin et al. (2009), KF techniques suffer from divergence during outages. This divergence is mainly due to approximations during linearization process and system "mis-modelling," especially when using MEMS-based IMUs. To enhance the performance of MEMS-based GPS/INS integration, non-linear estimation techniques that avoid models' linearization should be used. In this research, different advanced non-linear estimation techniques will be explored. In GPS/INS integration, Differential Global Positioning System (DGPS) is usually employed to obtain relatively high accuracy. However, DGPS is logistically complex and relatively expensive. An alternative to DGPS is precise point positioning (PPP). Besides proper modelling of the errors that cancel out when using DGPS, PPP requires precise satellite coordinates and clocks. PPP substitutes the burden of carrying out field procedures that are otherwise needed in DGPS to mitigate GPS errors (Héroux et al., 2004). The PPP technique can offer several significant advantages to applications, compared to DGPS. First, PPP requires only one GPS receiver and, therefore, it removes the need for GPS users to set local base stations. Thus, it overcomes the spatial operating range limit as well as the constraint of simultaneous observations on both rover and base receivers involved by DGPS. The major advantage of using PPP is that decimetre-level accuracy can be achieved without the use of a base station, while its major drawback is that its solution needs longer convergence time if compared to DGPS. Long convergence time is mainly caused by inadequate modelling of residual GPS errors and the
2

difficulty in fixing carrier-phase ambiguities to integer values. PPP has to account for all GPS errors. Some of these error's sources, such as code and phase biases, are not simple to handle and model, as they tend to merge with ambiguity parameters during the estimation process, which leads to unsuccessful ambiguity resolution. The major objectives of this research are to enhance the performance of single- and dualfrequency kinematic PPP and to investigate its suitability for uninterrupted land-vehicle navigation. To achieve these objectives, this research includes development of a new algorithm to integrate PPP and reduced low-cost inertial navigation sensors.

1.1 Literature Review 1.2 Developments in PPP Research
Witchayangkoon (2000) investigated PPP using dual- and single-frequency pseudorange and carrier phase observations. Both static and kinematic modes were investigated. For observation with low multipath, results show that single-frequency ionosphere-free PPP solutions are equivalent to the dual frequency solutions. Witchayangkoon (2000) reported that using tropospheric information does not appear to improve dual-frequency PPP solutions as compared to a case in which a tropospheric parameter is estimated to be an unknown. However, a priori tropospheric information seems to benefit single-frequency kinematic PPP. In terms of solutions accuracy, Witchayangkoon (2000) reported 10 cm when static solutions compared with published coordinates and around one metre in kinematic mode. In other research, Gao and Chen (2004) presented sub-decimetre levels of accuracy after using the real-time PPP method with online satellite orbit and clock products.
3

In order to separate satellite and receiver biases, Leando and Santos (2006) introduced an approach called wide area­based PPP. The main idea of this approach is to determine satellite's fractional biases using a network of receivers. They applied the estimated biases to a single receiver within the same network's area. Also, in order to separate fractional biases from other parameters -- such as ionospheric delays and ambiguities -- a de-correlation filter was used. In experiments carried out involving nearby stations, including stations sharing the same GPS antenna, the decorrelation filter was used to determine ionospheric delays. These delays were found to agree very well with each other. Data from seven consecutive days of observations taken from an IGS station were processed to determine the differential receiver-satellite fractional biases. Ambiguities and fractional biases were determined for each passage of PRN20 on L1/frequency. The results showed that, although the ambiguity values are different for each passage, with differences of several meteres, the fractional biases seemed to be stable with a mean and standard deviation of about ­ 0.6 cycle (3.9 cm) and 0.2 cycles, respectively. Wang and Gao (2007) investigated the existence, property and determination of the GPS receiver initial phase bias. They examined different GPS satellites and receiver conditions including receiver restart, satellite rise/fall, and signal full loss of lock. They also investigated the use of initial phase bias calibration to support the ambiguity resolution in PPP. They proposed a method that includes two major steps. The first step employed two GPS receivers in a zero-baseline configuration mode to eliminate satellite-related errors, including the satellite initial phase bias, so that the differential receiver initial phase bias could be estimated. The second step estimated the integer ambiguities on both L1 and L2 frequencies using the Geometry-Free (GF) phase combination and the resolved wide-lane ambiguity. In assessing the reliability of the proposed
4

method, the resolved ambiguity was validated by comparing the estimated ambiguities with the double difference ambiguity obtained from the rounding of the zero-baseline. Then, after the removal of the resolved integer ambiguity component from the GF observation, the inter-frequency receiver initial phase bias was determined. To improve bias determination, the GPS observation data was de-noised using the Wavelet technique. Their results from using GPS receivers from two different manufacturers confirmed the existence of the initial phase bias and also identified its instability in response to receiver restart and full loss of lock. The satellite initial phase bias can be calibrated since it is stable for the long term. Ge et al. (2008) showed that the Un-calibrated Phase Delays (UPDs) are fairly stable in time and position and can be estimated with high accuracy and reliability through a statistical analysis of the ambiguities estimated from reference network. They estimated the fractional parts of the Single-Difference (SD) UPDs between satellites in wide-lane and narrow-lane from a global reference network. By using the obtained SD UPDs as corrections, the SD ambiguities can be fixed to its integer values. With data from a dense network of 450 IGS stations, the efficiency of the ambiguity-fixing strategy was validated. They concluded that, on average, more that 80% of the independent ambiguities could be fixed reliably. The work done in Ge et al. (2008) is for static PPP; however, it can be applied in future kinematic PPP research. Banville et al. (2008) investigated satellite and receiver phase biases calibration for undifferenced ambiguity resolution. In this research, a receiver phase-bias calibration technique using a GPS simulator was proposed. A simulator was used to generate errorless signals, which are ideal to isolate biases inherent in the receiver. Results showed that this calibration technique is complex. This complexity is mainly due to the correlation between the receiver clock and
5

ambiguity parameters. As such, eliminating receiver phase biases through between-satellite single differencing still appears to be ideal. In regard to satellite phase bias calibration, a wide-lane phasebias calibration method was proposed. This proposed method was shown to be coherent with PPP's functional model. Colombo et al. (2004) used recursive KF and smoother estimator to process static and kinematic dual frequency GPS observations to obtain static and kinematic PPP solutions. To eliminate receiver clock, single-difference between-satellite was carried out. Precise satellite orbits and clocks from the IGS were used, while estimating receiver's coordinates ionosphere-free carrier phase LC biases and tropospheric refraction model errors, phase wind-up, relativity, satellite and receiver antenna corrections for Earth tides, ocean loading, and pole tides. In their conclusion, they reported that the convergence time in kinematic mode was typically 30-40 min and the accuracy in the order was less than 10 cm. In attempts to achieve undifferenced ambiguity resolution, Collins et al. (2010) developed a model known as the de-coupled clock model. This model allows for satellite hardware delays and satellite carrier-phase initial phase bias to be lumped to the GPS satellite clock corrections. In this work, only static PPP data was processed; however more work is required to investigate the impact of kinematic data. In attempts to shorten the PPP convergence time, Elsobeiey and El-Rabbany (2010a) used global cluster stations to estimate second-order ionospheric delay. Findings from this research showed that accounting for the second-order ionospheric delay and applying the National Oceanic and Atmospheric Administration (NOAA) tropospheric corrections can improve the final PPP coordinate solution by about 3 mm and improve the convergence time of the estimated parameters
6

by about 15%. In Elsobeiey and El-Rabbany (2010b), results showed stochastic modelling of GPS observables for specific GPS receiver type. A 40% reduction in the PPP solution convergence time was shown to be possible, especially for the horizontal component, by proper modelling of the stochastic characteristics of the modernized signal. Also, Ibrahim and El-Rabbany (2009) implemented the NOAA tropospheric corrections along with the Vienna mapping function 1 (VMF1). Both are based on weather prediction models, into PPP solution, findings of this research showed positive results in terms of reducing the convergence time and improving the position solution.

1.3 Integration of autonomous GPS with INS
The integration of autonomous GPS with INS has been extensively investigated in the last two decades as it has several benefits, such as improved cycle slip detection (Bisnath and Gao, 2009). At Applanix Corporation, Shin and Schenzinger (2009) investigated the effect of aiding PPP using high-grade INS on PPP convergence time during GNSS outages. They compared PPP/INS in both loosely and tightly coupled schemes. When the outage durations were within 30 seconds, the IAPPP in tightly coupled schemes was still able to meet decimeter-level accuracy. In the loosely coupled scheme, for outages longer than 10 seconds, the accuracy was at the meter level. In this research, data for both land vehicles and airborne vehicles were used. In Zhang and Gao (2008), a tightly coupled PPP/INS model was presented. To test the model performance, airborne data was used. Results of this research showed that position and attitude accuracies are comparable to those of DGPS/INS current systems. However, these results are based on one data set, and do not show details about accuracy during GPS outages.
7

El-Diasty (2015) used a PPP-based GPS/INS integration system in hydrographic surveys performed by multi-beam echo-sounder. In this work, El-Diasty claimed that the PPP-based GPS/INS integration solution accuracy for horizontal position, roll, pitch, heading and heave can fulfills the International Hydrographic Organization (IHO) standards at 95% confidence level. ElDiasty (2015) claimed that PPP-based GPS/INS integrated system can be alternative inexpensive navigation solution to RTK-based GPS/INS integrated system.
Kjørsvik et al. (2010) used a tightly-coupled PPP/INS integrated system in car navigation.

Results showed the difficulties of PPP in environments with frequent GNSS outages. GPS outages prevent proper convergence of the carrier phase bias estimates, and inaccuracies of code phase measurements significantly affects the INS navigation states. When a loosely coupled PPP/INS results shows no significant improvement over a pure PPP solution. Position accuracies for tightlycoupled is reported as a few decimeters with an improvement an improvement of 30­40%. Gao et al. (2015) used ionosphere constrained (IC) PPP model instead of ionosphere-free PPP in a tightly coupled integration of GPS and INS. The tightly-coupled integrated IC-PPP is tested by using data from an airborne and a vehicle-borne experiment. Gao et al. (2015) claimed that the results confirm that IC-PPP/INS could improve the performance of the LC-PPP/INS and IC-PPP in position and velocity, for land vehicle when GPS is available, as 10 cm and a few mm/s of RMS error respectively. During GPS outage on average, IC-PPP/INS could improve the accuracy of IC-PPP by 57%, 78% and 67% and that of LC-PPP/INS by 21%, 11% and 23% in the north, east and vertical components, respectively. In other words, IC-PPP/INS can significantly improve the position accuracy during the re-initialization process and reduce the re-convergence
8

time. In this work the authors also claim that IC-PPP/INS also shows a better initialization performance than that of LC-PPP/INS. Crespillo et al (2014) used a GNSS/IMU integrated system and a track map a precisions of less than a meter have been obtained and the track selection has been decided correctly all the time. Results also show that reliable position may still be reachable with only two or three visible GNSS satellites. When loosely-coupled and tightly-coupled integration are compared, result has shown that even in normal visibility scenarios, the tightly coupled integration is more robust to the existence of outlier satellite signals and to the non-modeled errors. In all the assessments conducted in this work, the satellite geometry was of high significance. Karamat et al (2014) examined the feasibility of integrating DGPS code and carrier measurements integrated with a reduced set of vehicle's sensors through an extended Kalman filter (EKF) employing tightly coupled integration scheme. The performance of the integrated system was compared, using carrier-phase based reference, with two similar integration schemes employing undifferenced GPS measurements, where atmospheric effects are corrected using either Klobuchar model or ionosphere-free linear combination. The performance of the system in real road tests showed in 2-D positioning, the integrated system (DD EKF-based) performed 46% superior than single-frequency code EKF-based and 21% better than IF EKF-based. In altitude, EKF-DD showed 66% improvement over single-frequency code EKF-based and 14% over IF EKF-based. In GPS outages, the overall performance of EKF-DD system was 21% and 10% better than single-frequency code EKF-based and IF EKF-based, respectively.

9

1.4 PPP Limitations and Challenges
Limitations and challenges of PPP include:   the convergence time after initialization or re-initialization right after a GPS signal outage. that the combined code and phase noise is amplified compared to the noise of isolated signals.  integer characteristics of the phase ambiguities get lost and ambiguity fixing is prevented.

1.5 Current State of the Art in the Area of GPS/INS Integration Techniques
There are three categories of estimation techniques used to integrate GPS and INS: KF, Artificial Intelligence (AI), and sampling-based filters. The sampling-based category includes Unscented Kalman filters (UKF) and Particle Filters (PF). KF is an optimal estimator that provides a sequential recursive algorithm suitable for linear systems. KF technique is still considered to be the benchmark for GPS/INS integration (Dissanyake and Sukkarieh, 2001; Oberdovic et al., 2007). However, it suffers divergence during GPS outages because of approximations, linearization and mis-modelling, especially when MEMS-based inertial sensors are used (Noureldin et al., 2009). KF is undermined because of the following inadequacies (Noureldin et al., 2009): 1) It requires stationary stochastic modelling of sensor errors, which may not be applicable to the environment of low-cost MEMS devices. In general, KF is ideal for estimating the error state of any linear system driven by white Gaussian noise (stationary random process with unit covariance). However, because of non-stationary random errors, it is usually difficult
10

to set a certain stochastic model for each inertial sensor that works efficiently and reflects the long-term behaviour of sensor errors in all environments (Brown and Hwang, 1992). 2) KF requires a priori information of the system and measurement covariance matrix for each new sensor. It takes a long design process to tune corresponding parameters. Furthermore, unstable error features of MEMS sensors make tuning parameters that best fit a priori information in one time may not keep up their performance at another time. 3) KF's accuracy depends on external aid. Therefore, it provides relatively poor performance during long GPS outages. 4) In KF, the weak observation of some error states may lead to unstable estimates. For instance, the weakly observable errors might be optimally estimated by KF in the long term only. This makes the convergence of their error covariance very slow, thus disturbing the stability of KF prediction of other correlated errors (Noureldin et al., 2002) 5) As a time domain recursive filter, KF highly depends on short-term statistical characteristics of data. A set of KF parameters that resulted in good estimation of error states for one data set may not result in good estimation of errors for another data set (Noureldin et al., 2007a). In other words, KF is so sensitive to local statistics that it may result in weak predictions if there is any short-term mis-modelling. In order to overcome KF limitations, non-linear techniques were investigated in the last few years by many researchers. These non-linear techniques are based on: (1) AI; (2) UKF; and (3) PF. For AI-based techniques, ANN has been widely used for GPS/INS integration. ANN is an interconnected assembly of simple processing elements, units, or nodes (known as neurons) whose
11

functionality is mimicking the human brain. The processing ability of the network is stored in the neuron connections weights, obtained by adapting to, or learning from, a set of training patterns (Gurney, 2003). ANN was developed and utilized in various schemes to totally replace KF and provide reliable navigation solutions for higher grade IMUs (Chiang and El-Sheimy, 2002; Shin, 2005; Chiang el al, 2006). There are different techniques for implementing ANN in GPS/INS. The Multi-Layer Perceptron (MLP) neural networks have been suggested for and applied to different types and grades of INS (Noureldin et al., 2004). A Position and Velocity Update Architecture (PVUA) utilizing two MLP networks can process the INS azimuth and velocity to provide the position components along both east and north directions (Chiang et al., 2006). In this research the parameters of the MLP networks were adapted using GPS position and velocity updates. However, the neural network model of PVUA dealt with the INS position components instead of their errors. As a result, no information about the accuracy of this system could be decided during the navigation task. Moreover, besides the fact that no sensitivity analysis was provided for changing the internal structure of the MLP networks on the system performance (i.e., the number of hidden layers and number of neurons in each layer), the real-time implementation and the accuracy of the system during this mode of operations was not addressed. Semenuik and Noureldin (2006) suggested an AI-based Segmented Forward Predictor (ASFP). ASFP was used to process segments of INS and GPS position and velocity data using Radial Basis Function Neural Network (RBFNN) to provide future prediction of INS errors. Although effective for both tactical and navigational grade INS, one limitation of the ASFP technique was the virtual extension of GPS outages due to the nature of GPS and INS data
12

segmentation. Moreover, the ASFP method exhibited inadequate performance when applied to MEMS-based INS/GPS. Different ANN and neuro-fuzzy methods for GPS/INS integration were introduced. However, these methods provided relatively poor positioning accuracy during long GPS outages. Moreover, the internal system parameters had to be tuned during the navigation mission to reach the desired positioning accuracy (Noureldin et al., 2007b). To overcome these limitations, Noureldin et al. (2007b) implemented the adaptive neuro-fuzzy inference system (ANFIS) with DGPS data for land vehicle applications. Also, real-time implementation issues of the ANN-based GPS/INS integration were addressed through, firstly, the AI-based segmented forward predictor (ASFP) (Semenuik and Noureldin, 2006), and secondly, the special weight update method (Chiang et al., 2004). However, despite these efforts, AI techniques still have limited capabilities when applied to low-cost navigation systems involving MEMS inertial sensors. In an attempt to augment KF with ANN, Perreault et al. (2008) proposed an augmented KF/ANN system for the integration of MEMS-based inertial sensors with GPS. In this system two KFs are used along with a RBFNN. During GPS availability, the first KF, the main filter, is used to correct the mechanization output to obtain the estimated position, velocity, and heading. The second KF is used in prediction mode and its output as well as the mechanization and GPS output are passed to train the RBFNN. The purpose of the RBFNN is to correct for the non-linear parts of residual inertial errors that KF cannot correct. During GPS outages, KF works in prediction mode and its output is passed to the RBFNN to further correct for non-linear parts of the residue. As Perreault et al. (2008) claim, the final estimated navigation states after these corrections are
13

better than those corrected by KF prediction alone. However, issues like the time needed for the training routine for the RBFNN and its application in real time were not discussed. As described in Sharaf and Noureldin (2007), the limitations of AI-based INS/GPS integration techniques are that: 1) Their input does not include any statistical information, nor do their output solutions include associated statistics. 2) They do not use well-developed mathematical models for vehicle motion and measurements. 3) Their performance is unacceptable if a vehicle experiences a dynamics range not included in the training set. Generally, AI-based GPS/INS integration techniques provide inadequate performance when lowcost MEMS-based inertial sensors are used. The reason for this is the existence of significant bias errors and scale factor instabilities in the sensor's raw data. Another limitation, because AI-based GPS/INS integration techniques lack the use of models for INS sensors' errors, is the INSsignificant non-linear and non-stationary types of errors. So, new advanced techniques are still need to improve the performance of error mitigation. In attempts to provide robust Positioning/Navigation (POS/NAV) solutions using low-cost MEMS-based inertial sensors, more advanced estimation techniques have been explored. Research has been conducted to overcome limitations -- i.e., the linearization of motion and linear stochastic models' equations that accompany the use of KF when it used to estimate MEMS-based sensors' errors. Techniques that avoid linearization have been investigated, which lead to the use of
14

sampling-based techniques such as UKF and PF. These techniques are different from KF, as they tend to provide a numerical approximate solution to an exact non-linear problem rather than providing the optimal solution for an approximate problem. These techniques are based on probable solutions that estimate the Probability Density Function (PDF) of the state conditioned on the set of measurements instead of providing a single best estimate. In KF, a Gaussian PDF is assumed and propagated in a parametric form using the mean and covariance, while in UKF and PF this PDF is approximated using a set of samples. UKF uses a fixed number of deterministically selected sample points called the sigma points (SP) to approximate the PDF (Shin, 2005). These SP capture the true mean and covariance of the PDF. When these SPT are propagated through the non-linear system, they capture the transformed mean and covariance accurately to the second order of any non-linearity, where, in the case of LKF and EKF, the mean and covariance are calculated accurately to the first order with all higher-order terms truncated (Shin, 2006). Unlike UKF, PF uses a set of random samples or particles. It is a universal density approximator. PF can be defined as a hypothesis tracker that approximates the filtered posterior distribution by a set of weighted particles. It weighs particles based on a likelihood score and then propagates these particles according to a motion model. PFs carry out sequential Monte Carlo (SMC) estimation based on particle representation of probability density (Yi and GrejnerBrzezinska, 2006a). There are two steps in PF design: (1) sequential importance sampling and (2) resampling. The major drawback of PF is that it is computationally expensive. With improvements in computer capabilities, PF gained popularity among researchers dealing with non-linear modelling and estimation.
15

In the area of GPS/INS integration, PF was used to include elements of non-linearity and non Gaussianality in motion dynamic and noise distributions. Carvalho et al. (1997), for a tightly coupled integration of simulated data, used non-linear modelling of GPS observations, while using a linearized INS error state and random walk for inertial sensor stochastic errors. In Garvalho et al. (1997), Yi (2007), and Aggarwal et al. (2007), the importance of density for PF was obtained using extended KF (EKF). The results for the combination of EKF and PF (EPH) did not show significant improvements over the EKF results. Furthermore, the results presented by Yi and Grejner-Brzezinska (2006a) were for high-grade IMU, not for MEMS-based IMU. In Yi and Grejner-Brzezinska (2006b), the MEMS-based IMU results for EPH were sometimes worth more than that for EKF alone. The results of the work presented by Aggarwal et al. (2007) using EKF and PF showed no considerable enhancement over results obtained by EKF. An adaptive scheme of EPH was developed by Aggarwal et al. (2008) and Aggarwal et al. (2009). It switches between EPF and EKF. It uses the EKF during stops and the EPF during relatively higher-dynamic environments. Also, results obtained for using this adaptive scheme showed small improvement over using EKF. In Georgy et al. (2009) and Georgy et al. (2010), mixture PF, as an enhanced version of PF, was used with INS measurements coming from reduced inertial sensor system (RISS) instead of full IMU. While the sampling/importance resampling (SIR) PF samples from the prior importance density and the likelihood PF samples from the observation likelihood, the mixture PF samples from both densities, then appropriate weighting is achieved followed by resampling. This mixture of importance densities leads to a better performance. The performance of this method is examined by road test trajectories in a land vehicle and compared with KF.
16

1.6 Motivation
Development in electronics makes it easy for consumers to have low-cost, powerful navigation equipment in a convenient weight and size. This type of navigation equipment, like GPS receivers and MEMS inertial sensors, is useful. In reducing the cost, precise positioning PPP is used instead of DGPS. Therefore, integrating autonomous GPS and INS can benefit many applications, such as: 1) Land vehicle navigation: Currently car navigation relies mainly on GPS; however, GPS suffers from signal blockage in downtown cores, which can make the service not continuous and not reliable. The alternative is to integrate GPS with INS. The high cost of navigation and tactical grade INS prevent their utilization in low-cost navigation applications. Nowadays, auto industry competition is pushing automobile manufacturers to implement reliable low-cost GPS/INS systems in land vehicles. 2) Machine control: To locate, control, and automate machines and equipment in a construction or mining site is needed as a positioning aid. Nowadays, GPS systems are integrated into the design of bulldozers, excavators, skiffs, pavers, and motor graders. The need for machine control in various applications that require more accuracy and efficiency makes machinery manufacturers search for low-cost and accurate positioning systems. 3) Precision farming: The use of GPS in farming enables good management of resources and time. GPS has enabled farmers to accurately direct their equipment's movement, providing precise positioning for all equipment actions and chemical applications. Therefore,

17

implementation of continuous, low-cost, accurate positioning systems will continue to enhance agricultural processes. 4) Cooperative Vehicle Safety System (CVSS): This is a system for locating vehicles and enabling them to exchange their position with surrounding vehicles. CVSS consists of three components, namely: positioning systems, communications protocols and embedded maps. The purpose of CVSS is to alarm drivers when vehicles are too close to them and also for those they cannot see in their blind spots, in order to reduce chances of car collisions, especially while changing lanes. Nowadays, automobile manufacturers are targeting implementation of CVSS with restricted specifications in terms of high accuracy and low cost.

1.7 Objectives
The major objectives of this research are, firstly, to develop methods and algorithms for reliable MEMS-based autonomous GPS-aided INS positioning modules that enhance overall system accuracy and enable robust and accurate positioning information during GPS signal outages; and, secondly, to implement techniques for PPP error mitigation in order to enhance the accuracy of PPP and reduce convergence time. The targeted applications of this research are low-cost navigation solutions appropriate to commercial land vehicles, unmanned autonomous vehicles, machine control, and precision farming. The research focuses on three issues, namely: (1) the use of EKF to account for system non-linearity, instead of using KF, (2) the use of single-frequency PPP, and (3) the use of dual-frequency PPP instead of DGPS in applications that require highaccuracy solutions.
18

To achieve the major objectives of this proposal, the following tasks are addressed:  investigating and implementing methods for reducing PPP convergence time, which includes proper modelling of hardware delay and initial phase bias  investigating and developing methods that benefit from the INS aid to maintain good accuracy during GPS signal blockage  investigating different non-linear estimation techniques to improve GPS/INS's overall accuracy  investigating how to exploit combinations of accelerometers, gyroscopes and speed odometers.

1.8 Thesis Outline
This thesis is organized as follows: Chapter 1 provides an introduction and discusses previous studies and limitations, the motivation for the thesis, its objectives and outline, and its research contributions. Chapter 2 reviews the GPS background necessary to support this research. It addresses GPS signal structure, observables, and positioning techniques with emphasis on PPP. In this chapter various GPS measurement errors and the ways to account for them are also discussed. Chapter 3 is devoted to an INS overview, including INS errors and ways to account for them. In this chapter emphasis is given to RISS. Chapter 4 deals with the developed PPP/RISS models. It presents single- and dual-frequency PPP/RISS. This chapter also covers the EKF technique for solving different PPP/RISS models.
19

Chapter 5 presents different results obtained through varying navigation conditions. Position results, from the developed PPP/RISS integrated system, are extensively studied in all cases, particularly when there is GPS outage. Chapter 6 presents the summary and conclusions of this research, as well as suggesting recommendations for future Chapter 7 presents the summary and conclusions of this research, as well as suggesting recommendations for future research. Appendix A devoted for review of different coordinate systems that are utilized in this thesis. It also discusses transformation methods between these coordinate systems. Appendix B gives a tabulated list of speculations of the major equipment, mainly IMUs and GPS devices, used for data acquisition for this research. Appendix C devoted to the presentation of quality check reports generated by TEQC software to examine the GPS data before integrating it with the INS data.

1.9 Thesis Contribution
Contributions from this thesis can be listed as:   Integrating GPS precise point positing and reduced inertial sensors system. Developing algorithms to integrate single-frequency code, dual-frequency code, smoothed dual-frequency code, code and carrier precise point positing and reduced inertial sensors.   Using extended Kalman filter in integrating PPP and RISS. Employing PPP/RISS integrated system into land-vehicle navigation
20



Testing the developed algorithms in urban and suburban navigation environments.

21

Chapter 2 2 Global Positioning System

This chapter presents an overview of the Global Positioning System (GPS) and its signal structure and positioning modes. The chapter focuses on Precise Point Positioning (PPP), with emphasis on its errors and how to mitigate them. PPP mathematical models are also presented.

2.1 GPS Overview
GPS is a satellite-based navigation system that was originally developed by the United States Department of Defense (DoD) in the early 1970s. GPS was initially developed as a military system to fulfil military requirements, but was later made available for civilian use and has since become a dual-use system that is accessible by both military and civilian users (El-Rabbany, 2006). GPS is capable of providing position, velocity, and time information for any user on or near the surface of the Earth, under all weather conditions where there is a direct line of sight between the user's receiver and four satellites or more. The minimal constellation of the system is 24 satellites distributed evenly on six orbits, each with an inclination of 55° on the equatorial plane, and an altitude of about 20,200 km above the surface of the Earth. GPS consists of three segments: the space segment, the control segment, and the user segment (Hofmann et al., 2001).

22

2.2 GPS Signal Structure
GPS satellites transmit a microwave radio signal centred on the L-band carrier frequency of the electromagnetic spectrum. The carrier frequencies are known as the L1 signal with a frequency of 1575.42 MHz and the L2 signal at a frequency of 1227.60 MHz, as well as the new L5 signal with a frequency of 1176.45 MHz. The satellite signal consists of the three L-band carrier frequencies, the ranging codes modulated on these carrier waves, and the navigation message. GPS signal is derived from the fundamental frequency f0=10.23 MHz, generated by the satellite atomic clock. Atomic clocks are the key to the GPS accuracy; they are based on atomic frequency standards (AFS) that produce reference frequency by stimulated radiation (Hofmann-Wellenhof et al., 2008). The L1 and L2 carrier frequencies are generated by multiplying the fundamental frequency by 154 and 120, respectively. Their corresponding wavelengths are approximately 19 cm and 24 cm, respectively. The signals contain codes that identify each satellite, time of the emitted signal, and satellite PRN number.

2.3 Positioning Modes
There are two general GPS modes to obtain position: relative or differential positioning and point positioning.

2.4 Relative positioning
Relative positioning is a more accurate positioning mode compared to point positioning. In Differential Positioning GPS (DGPS), two GPS receivers are employed to track the same satellites simultaneously. One of the two receivers, known as the base, is set at a reference point with
23

precisely known coordinates. The other receiver, known as the rover, is set at a point with unknown coordinates (El-Rabbany, 2006). In DGPS, mitigation of errors and biases is done through differencing measurements of the two receivers. The shorter the range between receivers is, the more similar the errors and biases. As such, for those receivers, a significant portion of the GPS error budget can simply be removed by combining their GPS observables. DGPS have been applied for precise positioning since they cancel out receiver and satellite clock errors and significantly reduce atmospheric delay (Héroux et al, 2004). Unfortunately, as the range between receivers increases, the errors and biases at the base and the rover receivers become less correlated; i.e., they do not cancel out sufficiently through differencing. This results in unsuccessful fixing of ambiguity parameters, which in turn degrades DGPS accuracy. Another major drawback of DGPS is its dependency on the measurements or corrections from a reference receiver or network, so errors in reference station coordinates can be propagated to newly established stations. In addition, DGPS has disadvantages such as limited applicability area and an increase in logistical complications.

2.5 Point positioning
Point or autonomous positioning is a technique that involves using a single GPS receiver to capture measurements from four or more satellites with which to compute the position of a point on or above the Earth's surface. In point positioning, error and bias mitigation methods are modelling and estimation. Point positioning can be classified into classical and precise point positioning. In classical point positioning, pseudo-ranges from four or more satellites are processed to compute the
24

receiver's antenna position. The broadcast ephemeris is used to compute the corresponding satellite coordinates, satellite clock corrections, and ionospheric delay. The expected accuracy of the classical point positioning is about 13 m at the 95% probability level (Hofmann-Wellenhof et al., 2008). Precise point positioning (PPP) is a stand-alone positioning approach that utilizes dual frequency pseudo-range and carrier phase observations along with precise satellite orbit and clock products. PPP is used to achieve the highest possible accuracy of point positioning; it refers to centimetre positioning accuracy in the static mode and sub-decimetre accuracy in kinematic mode (Leick, 2004). PPP is an alternative approach to DGPS. Using the PPP technique with undifferenced GPS observations, positions can be estimated logistically more simply than using the DGPS technique (Banville et al, 2008; Bisnath and Gao, 2009). PPP requires proper modelling of the errors that cancel out in the case of DGPS. The PPP technique can offer several significant advantages to applications compared to DGPS. First, PPP requires only one GPS receiver and, therefore, removes the need for GPS users to establish local base stations. As a result, it eliminates the spatial operating range limit as well as the constraint of simultaneous observations at both rover and base receivers involved in DGPS. The major drawback of PPP is that its solution needs a longer convergence time compared to DGPS.

25

2.6 PPP Mathematical Models
Depending on the GPS observables used, a number of models are derived for PPP from the main GPS observation equations. These models include code-based, code, and carrier-phase.

2.7 GPS Observables
There are three main GPS observables: pseudorange, carrier-phase, and Doppler measurements. Code and carrier-phase observations can be modelled as follows (Leick, 2004; Teunessen, 1998 and Elsobeiey, 2012):

C1    c(dT  dt )  T  I1  c(d rC1  d sC1 )  dmC1  eC1 C2    c(dT  dt )  T  I 2  c(d rC 2  d sC 2 )  dmC 2  eC 2 P 1    c(dT  dt )  T  I1  c(d rP1  d sP1 )  dmP1  eP1 P2    c(dT  dt )  T  I 2  c(d rP 2  d sP 2 )  dmP 2  eP 2 1    c(dT  dt )  T  I1  c( r1   s1 )  1[ N1  r1 (t0 )  s1 (t0 )]   m1  1  2    c(dT  dt )  T  I 2  c( r 2   s 2 )  2 [ N 2  r 2 (t0 )  s 2 (t0 )]   m2   2

(2.1) (2.2) (2.3) (2.4) (2.5) (2.6)

where P1, C1 are the pseudorange measurements on L1; P2 and C2 are the pseudorange measurements on L2; 1 and 2 are the carrier-phase measurements on L1 and L2, respectively;  is the geometric distance between the satellite antenna at the transmission time and the receiver antenna at the reception time; dT and dt are the receiver and satellite clock errors, respectively; dr and ds are frequency-dependent code delays for receivers and satellites, respectively; r and s are
26

frequency-dependent carrier phase delays for receiver and satellite, respectively; I1 and I2 are the ionospheric delays on L1 and L2 respectively; dm1 and dm2 are code multipath delays on L1 and L2, respectively; m1 and m2 are carrier-phase multipath delays on L1 and L2, respectively; 1 and 2 are wavelengths on L1 and L2, respectively; N1 and N2 are integer ambiguity for L1 and L2, respectively; c is the speed of light in vacuum; r(t0) and s(t0) are frequency-dependent initial phases fractions in the receiver and satellite, respectively; eC1, eC2, eP1, eP2, 1 and 2 are relevant noise and unmodelled errors.

2.8 Code-based PPP Model
By elimination of the first-order ionospheric delay error through the ionospheric-free linear combination, code-based PPP models can be formed as:
2 f12 P 1  f2 P 2  2.546P 1  1.546 P 2 2 2 f1  f 2

PIF 

(2.7)

PIF    c(dT  dt )  T 

f12 f 22 cd  cd rP 2  IF rP1 f12  f 22 f12  f 22

(2.8)

Here PIF is the pseudorange ionosphere-free linear combination; IF is the ionosphere-free linear combination noise, multipath, and other unmodelled errors like ocean loading, phase wind-up, and the Sagnac effect. Tropospheric delay is accounted for by using a suitable empirical model. f1 and f2 are the frequency of L1 and L2, respectively.

27

2.9 Code- and Carrier-based PPP Models
PPP with undifferenced dual frequency code and carrier-phase observations was proposed by Zumberge et al. (1997). Kouba and Héroux (2000) introduced the PPP technique using the traditional observation model, as follows:

PIF    c(dt  dT )  T   P
 IF    c(dt  dT )  T  N    P
Here

(2.9) (2.10)

PIF

is the ionosphere-free combination of

P 1 2

and

P2

pseudorange

(2.54 P 1  1.546 P 2 )  IF
; ;  is the

is the ionosphere-free combination of combination wavelength ( = 10.7 cm); including multipath.

1

and

pseudorange

(2.541  1.546 2 )

 P ,   are the relevant measurement noise components,

Another model first introduced by Teunissen and Kleusberg (1998) uses an averaged code and carrier phase observations. It is also used at the University of Calgary by Gao and Shen (2001) and is known as the "U of C" model. The U of C model allows for the estimation of two float ambiguities for each satellite in addition to station coordinates, a receiver clock, and atmosphere parameters. The model relies on ionosphere-free linear combination, and is written as:

28

PIF / L1  0.5( P 1  1 ) PIF / L2  0.5( P2  2 )
( f121  f 22 2 )  IF  f12  f 22

(2.11) (2.12)

(2.13)

2.10 Doppler Measurements
The GPS signal transmitted from a satellite to a GPS receiver is not exactly L1 or L2 frequency; however, the frequency of the signal shifts when received at the receiver (Hofmann-Wellenhof et al., 2007). This is called the Doppler shift and it is exists because of the relative motion between the satellite and the receiver. The Doppler observation can be expressed by differentiating the GPS pseudorange equation. In Parkinson and Spilker (1996), the Doppler shift of the mth satellite is defined as the projection of relative velocities of satellite and receiver onto the line of sight vector, multiplied by the transmitted frequency and divided by the speed of light -- as follows:

 =

[(  - )] 
    = [  ]   

(2.14)

 

(2.15)

    = [  ]  

(2.16)

29





=

[( -   ), ( -   ), ( -   )] ( -   )2 + ( -   )2 + ( -   )2 (2.17)

where   is the mth satellite velocity in ECEF frame; V is the receiver velocity also in ECEF frame; fi is the satellite transmitted frequency; 1m is the line of sight vector from the mth satellite to the receiver; and c is the speed of light. As mentioned above, Doppler observation can be expressed by differentiating the GPS pseudorange equation. So, when the measured Doppler shift  is given, the pseudorange rate   is calculated as follows:   = -   1

(2.18)

2.11 GPS Errors and Biases
The way to achieve high precision and accuracy positioning using GPS is with the resolution of the carrier-phase ambiguity to its integer values. Integer ambiguity resolution requires removing the correlation between the ambiguity parameters and all the other estimated parameters. To achieve high accuracy and short convergence time PPP, all GPS errors, GPS error residue, and biases -- including hardware delay, ionosphere, and phase bias -- must adequately modelled. According to El-Rabbany (2006), there are several types of random and systematic errors that affect the accuracy of GPS observations. These errors can be classified as errors related to the GPS satellite, errors related to the GPS receiver, and errors related to the atmosphere. The satellite30

related errors include satellite clock errors, ephemeris errors, and satellite hardware delays. Receiver-related errors include receiver clock errors, receiver noise, receiver hardware delays, and antenna phase centre variation and multipath. Atmospheric errors include the effect of the ionosphere and the troposphere on the GPS signal.

2.11.1 Satellite orbital errors
Satellite orbital errors or satellite ephemeris are errors in the satellite's coordinates. Satellite orbital errors exist as a result of imperfect modelling of the forces acting onto the satellite (El-Rabbany, 2006). There are three sources of data that can be used to determine position and velocity vectors of a satellite in terrestrial reference frame at any time: almanac data, broadcast ephemerides, and precise ephemeris (Hoffmann, 2008). The data availability and accuracy are different for each of the above mentioned data sources (see Table 2.1) (Hoffmann, 2008). Almanac data is aimed to provide the GPS user with adequate data to facilitate receiver satellite acquisition and for GPS surveying planning (Hoffmann, 2008). The broadcast ephemerides for a satellite are the predictions of the current satellite position and velocity as determined by the master control station (MCS). The broadcast orbital information is delivered in the form of Keplerian parameters along with their temporal variation (Hoffmann, 2008). These are uploaded to the GPS satellites, and transmitted to the user receiver in the navigation message. The precise ephemeris is the most accurate satellite orbit product. Precise ephemeris is comprised of post-processed values derived by, for example, the International GNSS Services (IGS), and is available to post-mission users via the Internet.

31

Ephemeris errors are a result of slight deviations in the actual orbital paths of the satellites from their predicted path. Broadcast errors are typically at the "few-metre" level while the precise ephemeris errors are at the decimetre-level. Ephemeris are largely mitigated by differential correction (in DGPS positioning) or in double differenced observables (formed from carrier phase measurements) when the surveyed baselines are not up to a few tens of kilometers. In very high precision applications and/or where the baseline lengths are hundreds or thousands of kilometres, residual ephemeris errors may limit the accuracy of the baseline solution. Table 2.1 Uncertainties of Satellite Ephemeris (Adapted from Hoffmann [2008]) Ephemerides Almanac Broadcast ephemerides Precise ephemerides Uncertainty Some kilometers ~ 1.0 m 0.05 ­ 0.20 m Remark Depending on the age of data Or even better Depending on the latency

In PPP, broadcast ephemeris must be excluded and precise ephemeris product must be used in the data processing instead. Precise ephemeris is produced by organizations such as the IGS, Jet Propulsion Laboratory (JPL), and Natural Resources Canada (NRCan). At present, precise ephemeris is available online with varied accuracy and latency. It is available as "rapid," "ultrarapid" and "find." Table 2.2 summarizes the present (May 13, 2016) accuracy of the broadcast ephemeris and the availability and accuracy of the IGS precise satellite orbit and clock corrections (IGS, 2016).

32

Table 3.2 Accuracy and Latency of GPS Precise Orbit/Clock Products (Adapted from IGS, 2016) GPS orbit/Clock Product Orbit accuracy Clock accuracy Broadcast ~ 100 cm ~ 5 ns (RMS) ~ 2.5 ns (STD) Ultra-rapid (Predicted) ~ 5cm ~ 3 ns (RMS) ~ 1.5 ns (STD) Ultra-rapid (Observed) ~ 3 cm ~ 150 ps (RMS) 3 ­ 9 hours ~ 50 ps (STD) Rapid ~ 2.5 cm ~ 75 ps (RMS) ~ 25 ps (STD) Final ~ 2.5 cm ~ 75 ps (RMS) ~ 20 ps (STD) 12 ­ 18 days 17 ­ 41 hours 15 min 5 min 15 min 30 s 15 min Real-time 15 min Latency Real-time Sample interval daily

2.11.2 Satellite clock errors
GPS signals are generated onboard a satellite and are controlled by atomic clocks (cesium and /or Rubidium clocks). GPS atomic clocks are carefully monitored by the GPS Master Control Station (MCS) -- however, these clocks are not perfect. The stability of these satellite atomic clocks, per day, is in the range of one to two parts in 1,013. According to the range of stability, satellite clock errors are in the range of 8.64 to 17.28 ns per day (El-Rabbany, 2006). Satellite clock errors can affect the range, between the satellite and the receiver, by 2.59 m to 5.18 m. In addition to clock errors, satellite clocks are also drifting over time. Satellite clock drifts are observed by ground stations and matched with master control systems that are combinations of more than 10 very
33

accurate atomic clocks. Satellite clock errors and drifts are modelled and transmitted as a part of the navigation message in the form of three coefficients of a second-order polynomial. The three coefficients are: satellite clock bias (a0), satellite clock drift (a1), and drift rate (a2). The equation for the satellite clock error is:   = 0 + 1 ( -  )+2 ( -  )2 Here t is the observation epoch time and tc is the satellite reference epoch time. In computing the distance to satellites, GPS receivers subtract the satellite clock errors from the reported transmit time to come up with the signal travel time. For precise positioning such as PPP, the above equation is not sufficient to count for satellite clock error. The IGS precise clock product is used.

(2.19)

2.11.3 Ionospheric delay
The ionosphere is part of the Earth atmosphere that extends between an altitude of about 50 km and 1,000 km or more above the Earth (Hofmann-Wellenhof et al., 2008). The ionosphere contains ionized particles that exist as a result the Sun's ultraviolet radiation activities. The density of the ionized particles is not constant; it varies with altitude and accordingly can be arranged in four layers: D, E, F1, and F2 (El-Rabbany, 2006). The largest electron density appears in layer F2. The ionosphere creates delays in the GPS signal that are proportional to the total electron content (TEC) along the signal path. The ionosphere delays the code while it speeds up the carrier phase beyond the speed of light. In general, the ionosphere can cause a range in error of the order between 5 m to 15 m, and up to 150 m under extreme solar activities (El-Rabbany, 2006).

34

2.11.4 Ionosphere mitigation
Ionospheric delay is a major GPS error that must be accounted for to achieve accurate GPS positioning. Ionospheric delay is the largest possible error following using precise ephemeris and clock errors. Techniques for ionosphere mitigation depend on the GPS mode. In DGPS, ionospheric delay cancels out if the baselines are relatively short (less than 10 km) because the ionospheric error is highly correlated at both ends. In PPP, users of dual frequency data dual can cancel out the first-order ionospheric delay using the first-order ionosphere-free linear combination. Single frequency users, however, have to account for ionospheric error using: (1) specific empirical models such as Klobuchar model, (2) regional ionospheric models (e.g., United States Total Electron Content [US-TEC] maps), or global ionospheric models (e.g., IGS ionospheric maps [IONEX]), and (3) real time corrections from regional network (El-Rabbany, 2006). The US-TEC grids include both Slant TEC (STEC) and Vertical TEC (VTEC) for different locations and directions. US-TEC represents an accurate source of STEC because its accuracy is one to three TEC units at a spatial resolution of 1°×1° and a temporal resolution of 15 min.

2.11.5 Tropospheric delay
According to El-Rabbany (2006) the troposphere is lower layer of the atmosphere that extends to altitude of about 50 km from the surface of the Earth. Unlike the ionosphere, the troposphere is electrically neutral (non-ionized) and is a non-dispersive medium for radio frequencies below 15 GHz (Hay and Wong, 2000). The effect of the tropospheric delay is frequency independent (Hoffman el. Al, 2008). As a result, it creates similar delays on GPS carriers and codes. Tropospheric delay may be divided into two portions: dry and wet. The dry portion represents about 90% of the delay and can be predicted to a high degree of accuracy using mathematical
35

models and metrological measurements (temperature, pressure, and humidity) (Leick, 2004). The wet portion of the tropospheric delay is highly correlated with the water vapour along the GPS signal path and weakly correlated with the surface metrological measurements. Unlike the dry portion, the wet portion is not easy to predict. Several models are available to compute dry and wet zenith tropospheric delays. These include the: Saastamoinen model, Hopfield model, Modefied Hopfield model, Davis et al. model, Baby et al. model, NOAA Tropospheric model (NOAATrop), and University of New Brunswick (UNB) model. To obtain the slant tropospheric delay, a mapping function is needed. A number of mapping function models are available, which include the Niell mapping function (NMF), Davis mapping function, Chao mapping function, and Vienna mapping function (VMF1).

2.11.6 Receiver clock error
A GPS signal travels the distance between the transmitter (satellite) and receiver in a tiny fraction of a second. So, the ideal for measuring the signal travel time is to use very accurate atomic clocks at both the satellite and the receiver. Atomic clocks are very expensive to use at the receiver. Alternatively, GPS receivers are normally equipped with cheap and inaccurate clocks (crystal clocks) compared to satellite clocks. Crystal clocks induce much larger errors compared to satellite clocks. There are two ways of mitigating the receiver's clock error. One is applying the technique of differencing between satellites. Another is considering the receiver's clock error as one of the estimation process unknowns (El-Rabbany, 2006). The latter is the way followed in dealing with receiver's clock error in the PPP technique.

36

2.11.7 Multipath
Multipath is one of the major sources of error for GPS positioning (Leick, 2004). Multipath can happen at the receiver and/or at the satellite. At the receiver, multipath happens when the signal from the satellite reaches the receiver antenna from a direct and a reflected or diffracted path after being reflected or diffracted by an object (El-Rabbany, 2006). The path travelled by the reflected signal is always longer than the direct path. At the satellite, multipath can be attributed to reflections, which are called satellite multipath (Hofmann-Wellenhof et al., 2008). Multipath is more severe at the receiver than the satellite and it is also more significant on the code measurements than on the carrier-phase measurements. Multipath is not like other GPS errors that can easily modelled or removed by differential positioning. Multipath is site-dependent, so modelling it is a very complicated task. However, there are various techniques and methodologies recommended for multipath mitigation, including careful site selection, using special antenna types (such as a choke-ring), and using receivers that employ mitigation algorithms at the receiver signal processing level (Elsobeiey, 2012). The Multipath Elimination Delay lock loop (MEDLL) is an example of a mitigation algorithm. However, antenna and receiver mitigation techniques are not significant in mitigating multipath caused by reflectors located within 30 m of the GPS antenna (Zhong et al., 2007). For kinematic mode positioning like in the case of land vehicle navigation, modelling multipath is a very complicated task. In this research, TEQC software (TEQC, 2016) was used to estimate multipath. The algorithm in TEQC is GNSS pre-processing software developed by University of Colorado (UNAVCO). Teqc uses the linear combination of L1 and L2 to obtain multipath on L1 and L2, as in the following (Louis and Charles, 1999):
37

1 = 1 - 1 + (

2  2 ( 12 2 - 1) ) 12 ) 22 )

1 +

2  2 ( 12  ( 2 - 1) ) 12 ) 22 )

2

(2.20)

2( 2 = 2 - 1 + (

2( 1 + (

 2 ( 12 - 1) 2

 2 ( 12 - 1) 2

2

(2.21)

Here MP1 and MP2 are the multipath on L1 and L2 linear combinations. P1 and P2 are the pseudorange measurements on L1 and L2, L1 and L2 are the carrier phase measurements on L1, and L2 and f1 and f2 are the frequencies of L1 and L2.

2.11.8 Satellite hardware delay estimation
According to El-Rabbany (2006), hardware delay is the time delay that happens in the satellite and the receiver. Satellite hardware delay is the difference between the time a signal is generated and the time it is transmitted by the satellite antenna. Receiver hardware delay is the difference between the time a signal is received by the receiver antenna and the time the signal is processed inside the receiver correlator. Hardware delays are frequency-dependent -- this is different for L1 and L2 carriers. Because hardware delays in the satellite and the receiver are different, they are also different for the code and the carrier, and also between L1 and L2 carriers. The differences between the delays on L1 and L2 are called "inter-frequency" or "differential bias." Hardware delay can be calibrated using GPS measurements collected at reference stations. Undifferenced code and carrier phase dual frequency observations can be written as:

38

r s C1    dT  dt  I1  1bC 1  1bC1   C1

(2.22) (2.23)

r s P 1    dT  dt  I1  1bP1  1bP1   P 1

f12 r s P2    dT  dt  2 I1  2bP  1bP   P2 2 2 f2
r s 1    dT  dt  I1  2b  2b  1 N1   1 1 1

(2.24)

(2.25)

2    dT  dt 

f12 r s I  2b  1b  2 N 2   2 2 1 2 2 f2

(2.26)

Here Ci is the measured C/A-code pseudorange on Li (m); Pi is the measured P-code pseudorange on Li (m);  is the true geometric range (m); dT is the receiver clock error (m); dt is the satellite clock error; I1 is the ionospheric delay on Li (m); fi is the frequency on Li (Hz); Ni is the integer ambiguity term in measured carrier phase on Li (cycle); measurement type * (cycle); and

b*r is the receiver hardware delay bias on

b*s is the satellite hardware delay bias on measurement type * (cycle);

 * is noise, including residual multipath (m).
When one receiver is used, the receiver hardware delay is the same for different satellites,

which means satellite-satellite single difference (SSSD) at the receiver could completely remove the receiver hardware delays. If a network of receivers is used, a certain satellite's hardware delay is the same for all receivers that observe this satellite. In this case, a receiver-receiver single difference (RRSD) could completely remove this satellite hardware delay.

39

2.11.9 Satellite and receiver initial phase bias
According to Wang and Gao (2007b), for dual-frequency GPS data, the undifferenced C/A code and phase observation equations can be written as:

C1    c(dT  dt )  dorb  dtrop  d ION / L1   (C1 ) 1    c(dT  dt )  dorb  dtrop  dION / L1  i [ Ni  r (t0 , Li )  s (t0 , Li )]   (i )

(2.27) (2.28)

here i = 1, 2 and C1 is the measured C/A pseudorange on L1 (m); i is the measured Li carrier phase (m);  is the true geometric range (m); c is the speed of light (m/s); dt is the satellite clock error (s); dT is the receiver clock error (s); dtrop is the troposheric delay m; dorb is the satellite orbit error; dion/Li is the ionospheric delay (m); i is the wavelength on Li (m/cycle); Ni is integer phase ambiguity on Li (cycle);

r (t0 , Li ) is the initial phase bias of receiver oscillator on Li (cycle);
i

s (t0 , Li ) is the initial phase bias of the satellite oscillator on Li (cycle); ( ) is the noise including
residual multipath (m).

40

The wide-lane (WL) and geometry-free (GF) combinations can be written as:
1 1 - 2 2 1 - 2

 =

(2.29)

 =  + ( - ) +  + /1 +  +  [1 +  (0 , 1 ) -  (0 , 1 )] -  [2 +  (0 , 1 ) -  (0 , 1 )] + ( )  = 1 - 2
2 12 - 2 /1 + 1 [1 +  (0 , 1 ) -  (0 , 1 )] 22 - 2 [2 +  (0 , 2 ) -  (0 , 2 )] + ( )

(2.30)

(2.31)

 =

(2.32)

2.11.9.1

Receiver initial phase bias determination

Zero-baseline RRSD observations can be used to eliminate all satellite related errors, including the satellite initial phase bias, and to estimate the receiver initial phase bias.

C1  cdT   (C1 )
WL  cdT  WL [N1  r (t0 , L1 )]  WL [N 2  r (t0 , L2 )]   (WL ) GF  GF [N1  r (t0 , L1 )]  GF [N 2  r (t0 , L2 )]   (GF )

(2.33)

(2.34)

(2.35)

Differencing between RRSD C/A code and WL carrier phase combinations will remove RRSD receiver clock errors.
41

NWL 

WL  C1  [N1  r (t0 , L1 )]  [N2  r (t0 , L2 )] WL

(2.36)

RRSD integer ambiguity can be estimated using the calculated hybrid RRSD WL ambiguity and GF observations:
1   N1   1 1   NWL      N   round     2    GF    2   1 

(2.37)

The estimated RRSD integer ambiguity from the above equation will be used to determine the receiver initial phase bias while its correctness will be validated according to the following procedures: 1. Calculate a derived DD ambiguity.

Ni j Nik  (Ni j  Niref )  (Nik  Niref )  Ni j  Nik
2. Obtain a calculated Double Difference (DD) ambiguity.

(2.38)

i  i Ni   (i )
  i  N i  round    i 

(2.39)

(2.40)

RRSD inter-frequency receiver initial phase bias can be written as:

1r (t0 , L1 )  2 r (t0 , L2 )  GF  (1 N1  2 N 2 )

(2.41)

42

2.11.10

Periodic relativistic

According to Conley et al. (2006), the relativistic periodic effect is a relativistic error that arises because of the slight eccentricity of satellite orbits. Orbit eccentricity causes changes in satellite speed and in the gravitational potential experienced by a satellite. These two changes contribute equally to periodic relativistic error. Exactly 50% of the periodic effect is caused by the periodic change in the speed of a satellite relative to the ECI frame; the other 50% is caused by the satellite's periodic change in its gravitational potential. The satellite experiences higher velocity and lower gravitational potential at perigee -- and both cause the satellite's clock to run more slowly. The satellite experiences lower velocity and higher gravitational potential at apogee -- and both cause the satellite's clock to run faster (Hatch, 1995; Ashby and Spilker, 1996). This effect can be compensated for in the following way (ARINC Research Corporation, 2004):  =  sin 

(2.42)

where F is -4.442807633 × 10-10s/m1/2; e is satellite orbital eccentricity;  is the semi major axis of the satellite orbit; and  is the eccentric anomaly of the satellite orbit Sagnac.

2.11.11

Sagnac Effect

According to Conley et al. (2006), the Sagnac effect is a relativistic error in the range between the satellite and the receiver. It occurs because of the rotation of the Earth during the time of signal transmission, when satellite coordinates are computed in an ECEF coordinate system. During the signal propagation time, if the receiver experiences a net rotation away from the satellite, the propagation time will increase, and vice versa (see Figure 2.1). The Sagnac effect can introduce

43

positioning errors on the order of 30 m (Ashby and Weiss, 1999). Corrections for the Sagnac effect are often referred to as Earth rotation corrections and can be computed as follows:   
 . 

 =




(2.43)

Here  is the instantaneous position vector between the receiver and the satellite,  is the  


instantaneous velocity vector between the receiver and the satellite, c is speed of light, and is the dot-product operator.

Figure 2.1 Sagnac Effect

44

2.11.12

Satellite Geometry

Satellite geometry is the geometric locations of GPS satellites with respect to the receiver's antenna the. Satellite geometry is described as good when the tracked satellites are spread out in the sky (El-Rabbany, 2006). A dilution of Precision (DOP) is a quantity that can be used to identify the quality of satellite geometry instantaneously (Hofmann-Wellenhof et al., 2008). Small DOP values are indicators to good satellite geometry and vice versa. The effect of satellite geometry on the three dimensional antenna's position (latitude, longitude, and height) is known as Position Dilution of Precision (PDOP). PDOP can be separated in into two parts: Horizontal DOP (HDOP) which represents the geometry effect on the horizontal 2D position, and Vertical DOP (VDOP) which represents the effect on the vertical position component. Another variant of DOP is Geometric DOP (GDOP). Generally, DOP variants can be computed from the 3D position and receiver's clock error variances PDOP and GDOP can be computed using the solution covariance matrix transformed to the local coordinates frame as:

 =  +  + 

(2.44)

 =  +  +  + 

(2.45)

where  ,  , and  are the variances of x-coordinate, y-coordinate, and z-coordinate of the receiver's antenna position respectively, and  is receiver's clock error

45

Chapter 3 3 Inertial Navigation System

An Inertial Navigation System (INS) is a navigation aid that measures acceleration and rotation rate to determine the navigation state of a moving object without the need for external references. It is used on vehicles such as ships, aircraft, submarines, guided missiles, and spacecraft. A typical INS is composed of an accelerometer and a gyroscope as well other electronics and a computer. Accelerometers sense and record acceleration and gyroscopes sense and measure angular rate changes. Acceleration and angular rate change measurements are used by INS to provide information about position, velocity, and attitude of a moving platform using the principle of Dead Reckoning (DR). DR is the process of generating the current position of a moving platform using knowledge of its previous position and inertial sensors measurements. Inertial sensors measure accelerations and angular rotations. Given initial conditions, acceleration is integrated to provide velocity and a second integration produces position. Angular rates are processed to give the attitude (pitch, roll, and yaw angles) of the moving platform and also to enable navigation parameter transformation from body frame to Local Level Frame (LLF). The accelerometer and gyroscopes constitute an Inertial Sensor Assembly (ISA), which output the raw data from the sensors. ISA and other related electronics are housed in a unit called the Inertial Measurement Unit (IMU). The output from the IMU is the sensors raw data corrected from errors such as scale factors and biases.

46

Any INS fall in one of two categories: (1) a grimballed system or stable system; (2) a strapdown system. In a grimballed system, inertial sensors are mounted in such a way that they are always aligned with the navigation frame. This system allows direct integration of the accelerations to obtain position right away in the navigation frame. The drawback of grimballed systems is that they are expensive and complex. Inertial sensors rigidly mounted to the body of the moving platform characterize strapdown systems. Unlike griballed systems, which mechanically transform between body and navigation frames, strapdown systems use processors that implement software's frame transformation. Therefore, the gyroscope measurement continuously updates the transformation between the body and navigation frames. This transformation is then applied to the accelerometer measurements to project the accelerations to the navigation frame. Strapdown systems have the advantage of being reliable, flexible, and light. They also consume low amounts of power, and are inexpensive when compared with gimballed systems. Table 4.1 highlights comparisons between grimballed and strapdown systems. Table 4.1 Comparison Between Gimballed and Strapdown Systems Size Grimballed System Strapdown System Small Heavy Big Weight Light Performance Superior accuracy High accuracy Robustness High reliability and low immunity to shock and vibration High reliability and immunity to shock and vibration

47

3.1 INS Principle of Operation
An INS is composed of an IMU and a navigation processor. An IMU includes a mutually orthogonal triad of accelerometers and a mutually orthogonal triad of gyroscopes. Nominally, the axes of both triads are parallel and the origin is defined as the origin of the accelerometer triad (Karamat, 2009; Georgy, 2010). In strapdown systems, the sensor axes are mounted inside the body of the IMU and are called the body axes. The navigation processor includes two modules: (1) a pre-processing module; (2) a mechanization module (Noureldin, 2007; Georgy, 2010). The pre-processing module is to filter out any unwanted disturbances in the signals produced by the IMU. The mechanization module processes these filtered signals and transforms them into position and attitude parameters. Figure 4.1 illustrates the three major modules of an INS.

3.2 Inertial Sensors
Inertial sensors are position, attitude, or motion sensors whose references are completely internal except possibly for initialization (Aggarwal, 2010). Two sensors re included in an IMU: the accelerometer and the gyroscope.

3.2.1 Accelerometer
An accelerometer is an inertial sensor that measures the linear acceleration of a body along the body sensitive axis (Aggarwal, 2010). Accelerometers measure the specific force in an inertial reference frame, which can be used to estimate the acceleration of the moving body. Therefore, the accelerometer in the direction of motion of a vehicle may be most important as it should contain

48

all the information. For three-dimensional motion, however, it is best to record the accelerations in all three directions to accurately model the motion.

3.2.2 Gyroscope
A gyroscope is an inertial sensor that measures the rate of rotation in an inertial fame about its sensitive axis (Aggarwal, 2010).

3.2.3 Inertial Sensors Classification
Many parameters can be used in inertial sensor classifications, such as accuracy, price, quality of components, applications, and so on. In the literature, there is no certain or one classification of inertial sensors. In general, the specifications of the gyroscope play a big role in determining the quality of an IMU. The gyroscope's quality depends mainly on the gyroscope's bias, which is given in the unit of deg per hr, and also on the gyroscope random walk, which is normally expressed in the unit of deg per square-root hr. Karamat (2009) and Georgy (2010) compare different inertial sensors and systems and their research is summarized in Table 4.2.

49

Table 4.2 Classification of Inertial Navigation Systems, (Georgy, 2010) Performance Strategic Grade Navigation Grade Position Error 30 ­ 100 m/hr 1 nm/hr or 0.5 m/sec Gyroscope Drift 0.0001 ­ 0.001
 

Tactical Grade

Commercial Grade

10 ­ 20 nm/hr

Large variation

< 0.01

 

1 ­ 10

 

0.1 ­ 1

 

Gyroscope Random Walk Accelerometer Bias Approximate Cost Application Submarines, intercontinental ballistic missiles  $100,000 0.1 ­ 1

< 0.002 /  < 100 mg

0.05 ­ 0.2 /  1 ­ 5 mg

Several /  10 ­ 1000 mg

$50,000 ­ $100,000 General navigation, high precision, georeferencing, mapping

$5,000 ­ $20,000 Integrated with GPS/GNSS for mapping, weapons (short time)

$200 ­ $2000

Research, lowcost navigation, pedometers, antilock braking, active suspension, airbags

50

3.3 Microelectromechanical Systems
Microelectromechanical Systems (MEMS) are the integration of mechanical elements, sensors, actuators, and electronics on a common substrate. MEMS bring together silicon-based microelectronics and micromachining technologies on a common platform.

3.4 Inertial Sensors Errors
According to Noureldin (2009), all INS sensors are subject to errors that limit the accuracy with which an observable can be measured. MEMS sensors are more affected with errors compared with mechanical sensors (Aggarwal, 2010). The performance characteristics of inertial sensors (either accelerometers or gyroscopes) are described in terms of sensor bias, sensor scale factor, and sensor noise. Figure 4.1 show the different errors that affect INS sensor measurements. Bias generally consists of two parts: the first part is deterministic and is called "bias offset," which refers to the offset in measurements provided by the inertial sensor. The second part is stochastic and is called "bias drift," which refers to the rate at which the error in an inertial sensor accumulates over time. The bias offset is deterministic in nature and can be determined by a sensor's calibration. The bias drift is random in nature and should be modeled stochastically. Scale factor is the relationship between the output signal of the sensor and the physical quantity being measured. Scale factor errors are deterministic and can be obtained by a sensor's calibration. Scale factor stability is the capability of the inertial sensor to accurately sense angular velocity or acceleration at different angular rates or accelerations, and is presumed to mean the variation of scale factor with temperature, as well as its repeatability.
51

Sensor noise is an additional signal that interferes with the inertial sensor output. Noise comes from the sensor itself or other electronic equipment. Noise in general is non-systematic and therefore cannot be removed from the measurements using deterministic models. It can only be modeled stochastically.

Figure 4.1 Sensor Bias Offset, Bias Drift and Noise

3.5 Inertial Sensors Systems 3.6 Odometry Data
Land vehicles or any moving objects that are equipped with motion sensors can provide useful data that can be used to obtain navigational information. The process of converting this data into navigational information is called odometry. The idea behind the odometer is that it integrates incremental motion information over time. In land vehicles, odometry data is extracted using sensors that measure the rotation of the vehicle wheel axes and the steer axes. Wheel rotation is translated into curvilinear distance. A disadvantage of odometry is that it is sensitive to errors because of the integration of velocity measurements over time to produce position estimates. In addition, orientation errors cause large errors in positioning that increase with the distance
52

travelled by the vehicle. A major cause of error in this process is wheel slippage. On the other hand, the advantages of odometry data are that they have short-term accuracy, are inexpensive, and allow high sampling rates. The integration of incremental motion information over time leads to another disadvantage: any small constant error increases after integration. Furthermore, orientation errors cause large position errors that increase with the distance travelled by the vehicle. To ensure effective use of odometry data, accurate data collection, equipment calibration, and processing are required.

3.7 Reduced Inertial Sensors System
The Reduced Inertial Sensors System (RISS) is a low-cost inertial sensor system that uses one gyroscope to sense rotation rate about the body frame vertical axis (Z-axis) and two accelerometers to sense acceleration along the body frame two horizontal axes (X- and Y- axis). The reasons for using three sensors instead of six is to reduce random errors and noise associated with low-cost MEMS and to cut the system cost. RISS compensates for the vertical accelerometer and the two horizontal gyroscopes by using the moving platform odometry data. In RISS, the relationship between the measurements and the desired navigation information can be summarized as in Figure 4.2 and highlighted as follows: The gyroscope's measurement is used to compute the azimuth.  The accelerometers' measurements, along with the vehicle speed, obtained from the odometry data, and reliable for the Earth gravity, are used to compute other attitude angles' pitch and roll.

53



The forward speed, obtained from the odometry data, along with the computed azimuth and pitch angles are used to compute the vehicle's local-level frame velocities (east, north, and up velocities).

The computed east and north velocities, along with ellipsoid parameters, are used to compute the three-dimensional position components (latitude, longitude, and height).

Figure 4.2 RISS Flow Chart (Karamat, 2014)

54

3.8 RISS Motion Equation
To ensure discussion and derivations, the LLF is based on east, north and up (ENU) directions and the X, Y, X axes of the body are aligned with traversal, forward, and vertically upward directions, respectively. The three-dimensional RISS navigation state vector is defined as x = [,,h,ve,vn,vu,r,p,A]T, where  is latitude,  is the longitude, h is altitude, ve is east velocity, vn is north velocity, vu is upward velocity, r is the roll, p is the pitch, and A is the azimuth (Karamat, 2014). Azimuth To obtain the azimuth (A), the gyroscope reading wz is -integrated. Before integrating wz, three corrections must be applied in order to get the actual azimuth rate of change. The first correction is for the gyroscope bias (bz). This bias must be subtracted from the gyroscope measurements. Then the unbiased gyroscope measurement is corrected for the rotation of the Earth and moving of the origin of the LLF with respect to the centre of the Earth. The azimuth rate of change in the LLF can be written as:   tan  ]]  - 

 = - [( -  ) -   cos  - [

(4.1)

where wz is the vertical gyroscope's measurement, bz is the estimated gyroscope bias, we is the Earth's rotation rate, h is the altitude of the vehicle, and RN is the normal radius of curvature of the Earth's ellipsoid. In equation (4.1) above the gyroscope's measurement wz is being compensated for the bias bz. This also affects its linearization, as we will see in chapter 5 of this thesis.

55

Pitch The idea behind the computation of pitch and roll angles is presented in Noureldin et al, (2002) and Noureldin et al, (2004). When a vehicle is moving, the vehicle's forward acceleration as well as the component of gravity due to pitch angle are measured by the longitudinal accelerometer. Hence, in computation of the pitch angle p, the vehicle acceleration (a0) derived from the vehicle's speed measurement is subtracted from the forward accelerometer measurement (fy). Mathematically, the computation of the pitch angle is expressed as:  - 0 ) 

 = sin-1 (

(4.2)

where g is the Earth's normal gravity. Roll Lateral component of vehicle acceleration during a vehicle's turn and the component of gravity as result of the roll angle are measured by the transversal accelerometer. Therefore, the computation of the roll angle r, requires compensation to the traversal accelerometer measurement (fx) by the lateral component of acceleration. The computation of the roll angle is therefore given as:  + 0 ( -  ) ]  cos 

 = - sin-1 [

(4.3)

56

in equation (4.3) v0 is the vehicle speed obtained from the wheel rotation sensor measurement, wz is the angular rate measured by the vertically aligned gyroscope, and v0wz is the lateral component of acceleration experienced during a turn. Velocities The computation of the vehicle velocities along east, north and up velocities (ve, vn, and vu, respectively) is a process of transformation of a vehicle's speed along a forward direction v0 along east, north and up axes. The transformation require the knowledge of azimuth and pitch angles and done according to the following expressions:  = 0 sin  cos   = 0 cos  cos   = 0 sin  Position Position is the product of the integration of velocity, so to obtain position in geodetic coordinates we must have the velocity in the geodetic coordinate system. In the case here, we have the velocities in LLF (East, North and U) and we need the position as geodetic coordinates. Then we must first transfer Eat and North velocities into geodetic coordinates and then integrated over the sample interval to obtain positions in latitude and longitude. The altitude h is obtained by directly integrate the Up velocity. The three position quantities are calculated using the following expressions:
57

(4.4) (4.5) (4.1)

 =

 ( + )

(4.2)

 =

 ( + ) cos   = 

(4.8)

(4.9)

where RM is the meridian radius of curvature and RN is the normal radius of curvature of the Earth's ellipsoid. A block diagram that illustrates RISS mechanization system is shown in Figure 4.3. A close look at equations 4.1 through 4.6 reveals that the major source of errors in the RISS system is errors in gyroscope measurements (gyroscope bias bz) because these measurements prorogate to azimuth, which in turn prorogates into an error in horizontal channel velocity and position. Since no integration is involved in roll and pitch calculation in equations 4.2 and 4.3, errors in accelerometer measurements have only a small effect and can be reduced using common sensor calibration techniques.

58

Chapter 4 4 GPS/INS Integration
GPS/INS integration is a form of sensor integration or fusion that involves combining the output or observations of different sensor systems to obtain a better estimation of their navigation state (Grewal et al., 2007).

4.1 Advantages of GPS/INS Integration
According to Grewal et al. (2007), to benefit from the opposite characteristics of GPS and INS, INS and GPS are integrated to obtain good positioning solutions. In the short term, INS produces accurate navigation parameters; however, its errors become greater in the long term because of intrinsic sensor errors. On the other hand, GPS's accuracy is more consistent in the long term and does not degrade over time. However, for short-term use, GPS is not as accurate as INS. In addition, GPS signals may suffer from outages due to signal blockages, interference, or jamming, while INS is immune to these effects. GPS outages may happen, for example, in urban canyons or tunnels. Thus, to have a continuous positioning solution with higher performance, INS and GPS are integrated. More advantages of INS/GPS integration are as follows:    INS enables continuous positioning by providing solutions during GPS outages. INS provides navigation solutions at a higher rate than that provided by GPS. INS can determine the full navigation state without differentiation, as with GPS. This has an advantage of low sensitivity to high noise.
59

 

Integrating GPS with INS reduces the effect of GPS errors. GPS aid is used for online calibration of IMU errors and online alignment of the IMU, as well as estimation and correction of errors in the INS state. Furthermore, GPS can be used to compensate for the long-term drift of INS readings. As a result, during GPS outages, INS error growth is less due to online calibration and alignment.



INS can supply accurate position and velocity information during short periods and subsequently reduce the PPP solution convergence time.

4.2 GPS/INS Integration Schemes
The GPS/INS integration scheme can simply be categorized as loosely coupled and tightly coupled (Grewal et al., 2007), and ultra-tightly coupled. In the loosely coupled integration (Figure 5.1), GPS and INS work as two independent navigators and the integrated system between them as a third navigator (Gebre-Egziabher, 2007). In this integration architecture, the derived position and velocity estimates of the GPS receiver are used to update the INS position and velocity estimates. KF utilizes a linearized model of INS errors and provides estimates of these errors based on the GPS updates. Therefore, in loosely coupled GPS/INS integration, GPS navigation solutions are essential. No GPS/INS solution can be obtained when less than four satellites are tracked.

60

Figure 4.1 GPS/INS Loosely-Coupled Integration (Gebre-Egziabher, 2007)

In the tightly coupled scheme (Figure 5.2), the GPS pseudorange, carrier phase, and pseudorange's rate of change (Doppler measurements) are used as observations to update the navigation filter. The INS estimated solution can continuously be updated by the GPS measurements, even if the number of tracked GPS satellites drops below four.

61

Figure 4.2 GPS/INS Tightly-Coupled Integration (Gebre-Egziabher, 2007)

Ultra-Tightly (UT) coupled integration is distinguished from loose and tight architecture integration by two features. Firstly, there is a fundamental difference in the architecture of the GNSS receiver: in the first two integration schemes, the receiver architecture consists of a bank of independent code and carrier-phase tracking loops, whereas in the ultra-tight scheme, the receiver architecture consists of a single Vector Delay Lock Loop (VDLL). Secondly, the use of INS data in the ultra-tight scheme is an integral part of the GNSS receiver, so the independence of GNSS and INS as navigators disappears. However, there is an advantage to ultra-tight integration -- the ultra-tight scheme improves the robustness of the GNSS to signal jamming and interference. Ultra62

tight integration involves a complex process of INS/GNSS data fusion inside the GNSS receiver. However, if this complexity resolved, ultra-tight architecture is considered an optimal INS/GNSS integration (Gebre-Egziabher, 2007).

Figure 4.3 GPS/INS Ultra-Tightly Coupled Integration (Gebre-Egziabher, 2007)

63

4.3 GPS/INS Integration Estimation Techniques
The purpose behind GPS/INS integration is the use of the complementary characteristics of the two systems in a mutual relation. The optimal benefit of this relation is more superior accuracy than any of the systems can offer when used alone. This accuracy also depends on the estimation's algorithm used. The primary algorithm for GPS/INS is KF: however, KF has limited capability in handling non-linear errors, which is the case with GPS and INS errors.

4.3.1 Kalman Filter
The Kalman filter (KF) is an optimal estimation tool that provides a sequential recursive algorithm to solve linear systems (Minkler and Minkler, 1993). KF's main advantage as an optimal estimator is its suitability for applications of quantitative error analysis that require real-time statistical information and estimation accuracy of the system states (Grewal and Andrews, 2001). KF produces its own error analysis as a projection of the error covariance matrix, which gives an indication of the estimation accuracy. In estimating system states, KF starts with a suitable approximation of the state and then follows a procedure that implements two groups of equations: prediction equations and measurement update or correction equations (Georgy, 2012). The time-update equations are used to predict forward in time current state and error covariance estimates to obtain the a priori estimates for the next step. Measurement update equations are used to include new measurement into the a priori estimate to obtain an improved a posteriori estimate (Welch and Bishop, 2001). According to (Ristic et al., 2004), in most practical situations optimal non-linear filters cannot be applied. Instead, suboptimal solutions are utilized. A number of approximate or suboptimal filters have been proposed. These proposed filters can be grouped into four broad
64

classes: (1) analytic approximations; (2) numerical approximations; (3) Gaussian sum or multiple model filters; (4) sampling approaches. The sampling approach is used to approximate the posterior density using a set of samples. The unscented Kalman filter (UKF) and the PF are filters of the last category. The UKF uses a small number of deterministically chosen samples, while the PF uses a large number of random samples. In order to accurately model the underlying dynamics of a physical system, it is important to include elements of non-linearity and non-Gaussian sums in many application areas. Particle filters (PF) can be used to achieve this. PF is a sequential Monte Carlo method based on pointmass representations of probability densities, which are applied to any state model. PF is concerned with the problem of tracking single and multiple objects. It is a hypothesis tracker that approximates the filtered posterior distribution using a set of weighted particles. It weights particles based on a likelihood score and then propagates these particles according to a motion model. The disadvantages of PFs include high computational complexity, difficulty in determining optimal number of particles, increases in number of particles with increasing model dimensions, as well as other potential problems, including degeneracy and loss of diversity.

4.3.2 Extended Kalman Filter (EKF)
EKF is a variant of KF, so in this regard discussing its background requires a review of KF's formation. There are a variety of resources in the literature that offer details about KF and its variants. Of these excellent resources, we refer to studies and books by Brown and Hwang (1997), Grewal and Andrews (2008), Simon (2006), and Gelb (1976). EKF is considered a suboptimal estimation technique that overcomes PF drawbacks. EKFs operate in the framework of Gaussian approximation for posterior density. While this gives them
65

the advantage to be simply implemented and executed, it also suffers from an inherent inability to model higher order moments of non-Gaussian posterior densities (Ristic et al., 2004). In the following, EKF is summarized, for which KF is based on the following system and measurement models. The system model can be represented as follows: +1 = ( , ) +    ~(0,  ) (4.1) (4.2)

where +1 is state vector,  is independent zero-mean white Gaussian noise process with covariance matrix  , ( , ) is a state transition matrix -- which is a non-linear function of states, and  is a system noise coupling matrix. The measurement model can be represented as: + = + (+ ,  + ) + +  ~(0,  ) (4.3) (4.4)

where +1 is the measurement vector,  is the independent zero-mean white Gaussian noise process with covariance matrix  , and +1 (+1 ,  + 1) is a non-linear measurement matrix. KF is initialized as follows:
+ 0  = (0 )

(4.5)

+ + + 0 0 0 =  [(0 -  )(0 -  ) ]



(4.6)

+ where 0 is the initial a posteriori error covariance matrix of the predicted state  .

State vector and its error covariance matrix are projected in time as:

66

- - +1   = ( , )

(4.7)

+  -  +1 =    +   

(4.8)

in this instance:  = (, ) | +     (4.9)

KF gain K is computed and used to weight external measurements to update the state vector X and its error covariance P as follows:
-  -  +1 = +1 +1 (+1 +1 +1 + +1 )-1 + - - +1 +1 +1  =  + +1 [+1 - ( ,  + 1)] + - +1 = ( - +1 +1 )+1

(4.10) (4.11) (4.12)

where:  = (, ) | -   (4.13)

In this research the developed integrated tightly coupled PPP/RISS system was built through EKF.

4.4 Developed GPS PPP/RISS Integration System
Integrating PPP and RISS formed the developed system in this research. This system is built to accommodate single-frequency and dual-frequency code pseudorange as well as dual-frequency code and carrier GPS measurements. In this research, single-frequency code PPP/RISS (SF-code67

PPP/RISS), dual-frequency code PPP/RISS (DF-code-PPP/RISS), smoothed dual-frequency code PPP/RISS (SDF-Code-PPP/RISS), and dual-frequency code and carrier-phase PPP/RISS (codecarrier-PPP/RISS) were considered. For all of these combinations, except for ionospheric delays, all other GPS errors and biases were rigorously corrected and treated as in GPS PPP before being used as an update source for the RISS. For single-frequency code measurements, the ionosphere was corrected using the NOAA ion grid files, while ionosphere-free linear combinations were applied to account for the ionosphere delay in other combinations. In the following section, a description of the model is provided. The integration architecture is tightly coupled and the estimation method is EKF. Figure 5.3 shows a flow chart of the developed tightly coupled PPP/RISS system.

Figure 4.4 PPP/RISS Tightly Coupled Navigation System

68

4.4.1 Tightly-Coupled PPP/RISS Measurement Model
The measurement is the relation between the measurements and system state. It is given at time k as follows:

 Z k  H k X k   k

(4.14)

where  is measurement,  is the system state,  is the design matrix, and  is system noise.

4.4.2 Tightly-Coupled PPP/RISS System Model
The state vector of the developed PPP/RISS model is:  = [, , h,  ,  ,  , A, r, p,  ,  ,  ,  ,  ,  ,  ] (4.15)

where , , h,  ,  ,  , A, r, p,  ,  ,  ,  ,  , and  are the errors in: latitude; longitude; altitude; east velocity; north velocity; upward velocity; azimuth; pitch; roll; acceleration derived from wheel rotation sensor measurements and gyroscope bias, respectively; X-axis accelerometer; Y-axis accelerometer; GPS receiver clock bias; and GPS receiver clock drift. To get the rate of change of the error states for the RISS system model, motion equations were linearized through Taylor's series expansion and only the first order terms were retained. For detail derivations of the linearization step, refer to Atia et al. (2014).

69

4.4.2.1 System Dynamic Matrix
The dynamic matrix is formed from the linearization of the motion's equations (Karamat, 2014). The elements of the system dynamic matrix are the coefficients of the elements of state vector. The following is a step-by-step formation of the system dynamic matrix.

4.4.2.2 Latitude
The time rate change of the latitude is given as:  =   + 

(4.16)

After applying Taylor's series the above and arranging the terms, we get:  = ( 1 )   + 

(4.17)

4.4.2.3 Longitude
The time rate of change of the longitude is given as:  =  ( + ) cos 

(4.18)

Again, applying Taylor's series for the rate of change of the longitude equation, and arranging the terms, we get:  = (   tan  )  + ( )  ( + ) cos  ( + ) cos 

(4.19)

4.4.2.4 Altitude
The rate of change of the altitude is directly related to the vertical velocity as:

70

 =  Linearization of the rate of change of the altitude results in:  = 

(4.20)

(4.21)

4.4.2.5 East velocity
East velocity is obtained from the forward velocity of the vehicle speed odometer. It is expressed as:  =  sin  cos  The linearization result for the above equation is written as:  = sin  cos   +  cos  cos   - ( -  -  sin  - +  ( cos  +  tan  )  +    +  (4.22)

(4.23)

 sec 2   tan  )  + ( )   +   + 

4.4.2.6 North velocity
Similarly to east velocity, north velocity is obtained from the forward velocity of the vehicle speed odometer, as in:  =  cos  cos  And the final arrangement of the linearization is presented as: (4.24)

71

 = cos  cos   -  sin  cos   + ( -  -  sin  - -  ( cos  +  tan  )  -    + 

(4.25)

 sec 2  )  +  + 

4.4.2.7 Up velocity
Up velocity is obtained as the vertical resolution of the forward velocity, and in this resolution the pitch angle is used as follows:  =  sin  (4.26)

After differentiating the above equation with respect to time and applying Taylor's series for linearization, we get:  = (sin )  (4.27)

4.4.2.8 Attitude
Azimuth is the only attitude component that is included in the state vector. Azimuth's time rate of change is expressed as:  = - [( -  ) -  sin  - (  tan  )]  + 

(4.28)

The linearization of the azimuth time rate of change leads to the following relationship:  =  + ( cos  +  sec 2  tan  )  + ( )   +   + 

(4.29)

72

4.4.2.9 Gyroscope stochastic errors
The gyroscope stochastic error is modelled by the first-order Gauss-Markov process and is presented as follows:
2  = -  + 2  ()

(4.30)

4.4.2.10

Wheel rotation sensor stochastic model

Similarly to the gyroscope wheel rotation sensor, random errors are also modelled as first-order Gauss-Markov processes, which are expressed as:
2 ()   = -  + 2 

(4.31)

In the above two equations,  and  are the reciprocal of the correlation time and the standard deviation, respectively. The system dynamic matrix for the developed PPP/RISS integrated system is created from the coefficients of equations (4.17), (4.19), (4.21), (4.23), (4.25), (4.27), (4.29), (4.30), and (4.31), so the no-zero element of the F matrix are populated as: (1,5) = ( 1 )  + 

(2,1) = (

 tan  ) ( + ) cos  1 ) ( + ) cos 

(2,4) = (

(3,6) = 1

73

 sec 2  (4,1) =  ( cos  + )  + 


(4,4) = (

 tan  )  +   tan  )  + 

(4,5) = - ( -  -  sin  - (4,7) =  cos  cos  (4,8) = sin  cos  (4,9) = 

 sec 2  (5,1) = - ( cos  + )  + 


(5,4) = ( -  -  sin  -

 tan  )  + 

(5,7) = - sin  cos  (5,8) = cos  cos  (5,9) = - (6,8) = (sin ) (7,9) = 1  sec 2  (7,1) = ( cos  + )  + 


(7,4) = (
74

tan  )  + 

(8,8) = -_ (9,9) = - (10,11) = 1 (11,11) = 0 (12,12) = - (13,13) = - (14,14) = - (15,15) = - (16,8) = 1 (16,16) = 0

75

4.4.2.11

System Noise

System noise is represented by the G (appears in equation 4.1) matrix shown below: G=
0 0  0  0 0  0 0  0  0  0   0  0  0  0   0  0   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
o

2



2 o

0 0 0 0 0 0 0 0 2

0 0 0 0 0 0 0 0
z

0 0 0 0 0 0 0 0 0
2

0 0 0 0 0 0 0 0 0 0
2

0 0 0 0 0 0 0 0 0 0 0

0 0 0 0 0 0 0 0 0 0 0 0

0 0 0 0 0 0 0 0 0 0 0 0 0
r

0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

0 0 0 0 0 0 0 0


0 0 0 0 0 0 0


2

0
z

2

T b T b 0 0 0 0 0 0

0 2 T d T d 0 0 0 0 0

0 2
o



2 o

0 2
p

0 0 0 0



2 p

0 2 0 0

0 0 0



2 r

0 2 f 0
x

f
2

x

2

             0    0   0    0   0   0   0   2   f fy y  0 0 0 0 0 0 0 0

where  is the reciprocal of the correlation time and  is the standard deviation. The subscripts o,  , Tb, Td, p,r, fx, and fz stand for: odometer acceleration; Z-gyroscope measurement; receiver clock bias; receiver clock drift; pitch angle; roll angle; X-accelerometer measurement; and Yaccelerometer measurement.

4.4.3 Measurement Model
The measurement model relates the measurement to the states which are derived by taking the design matrix. In the tightly coupled GPS/INS integration, the measurements for KF are the difference in RISS-computed and GPS-measured pseudorange and pseudorange rates. These

76

measurements are involved in the following linearized discrete measurement models in the time domain:  =  +  (4.44)

where z is the measurement vector, H is the measurement design matrix, x is the state vector (for this research, the size of state vector is 16×1), and  is the vector of random noise measurement with zero mean and covariance R. z is a vector that is formed as the difference between RISScomputed and GPS-measured pseudoranges  and pseudorange rate  , as follows:   -  ] [ ] = [   -  

(4.45)

where  is RISS-computed pseudorange,  is the GPS pseudorange,   is the RISScomputed pseudorange rate, and   is the GPS Doppler measurement. A full measurement vector tightly coupled PPP-RISS integration that involves M GPS satellites is written as:
1 1  -  2 2  -      -  = 1 1 1    -   2 2 2   -          -   [ ]  [ ]  1  2    

(4.46)

where:

77

   =  -    -  +  +  +  +  + 

(4.47)

where X and   are the receiver and satellite position vectors, respectively,  and  are the receiver and satellite clock biases, respectively,  and  are the tropospheric and ionospheric
 delays, respectively,  is the multipath error, and  is the total effect of residual errors produced

due to atmospheric delay, receiver noise, etc. In this research we instigated the use of single- and dual-frequency GPS measurements for PPP/RISS integration. For single-frequency only L1 code measurements are used, while for dualfrequency measurements both code as well as code carrier measurements.

4.4.3.1 GPS Dual-Frequency Measurements
The dual-frequency GPS code (1 and 2 ) and carrier-phase (1 and 2 ) measurements were used to generate ionosphere-free code and code and carrier pseudoranges, as follows: (12 1 ()1 - 22 2 ()2 ) 2 2  1 -  2

() =

(4.48)

( - 1) =

(12 1 ( - 1)1 - 22 2 ( - 1)2 ) 2 2  1 -  2

(4.49)

 () = () - ( - 1) (12 1 ()1 - 22 2 ()2 ) () = 2 2  1 -  2 (12 1 ( - 1)1 - 22 2 ( - 1)2 ) ( - 1) = 2 2  1 -  2

(4.50)

(4.51)

(4.52)

78

 () = () - ( - 1)  =  - 

(4.53) (4.54)

In this research, smoothed and unsmoothed ionosphere codes and code and carriers were used. The unsmoothed ionosphere-free code only pseudorange, () was computed in equation (4.48). The smoothed ionosphere-free code pseudorange,  , is expressed as:
=

 () = (1) +  +  () +  ()
=1

(4.55)

The filtered ionosphere-free code and carrier-phase range,  , is expressed as:
=

 () = (1) +  ()
=1

(4.56)

(= =1 () -  )  () = 
= =

(4.57)

 () =  ()
=1 = =1 =

(4.58)

  () =   ()
=1 =1

(4.59)

79

where  () is the last correction to the ambiguity, = =1 () is sum of ambiguities, and = =1  () is sum of ionospheric carrier/code difference from the initial epoch.

4.4.3.2 GPS Single-Frequency Measurement
In addition to the different combinations of the dual-frequency GPS measurement presented above, we also used single-frequency code data. The L1 C/A code was to obtain a correct GPS
 measurement ( ) for the measurements model vector, as follows:    = 1 -  +  +  +  +  +  +  +  + 

(4.60)

RISS-computed pseudorange is expressed as:
  =  -   

(4.61)

where  is the position in ECEF Cartesian coordinates of the IMU calculated from the RISS mechanization's position output. By applying Taylor's series to the difference between the RISS estimate and GPS pseudorange, a linear relation was established through which to relate the measurements to errors, as follows:
    =   ( -   ) -  +  + 

(4.62)

 where  is the line-of-sight unit vector from mth satellite to the receiver antenna base on the

output of RISS mechanization. This unit vector is expressed as:
  =

 -    -   

(4.63)

by using a matrix form and applying equation (5.62) for the M satellite, we get:
80

1 1 ,  1   2 = ,       [  ] [ ,

1 , 2 ,   ,

1 ,

   2   2 , [] - [  ] +          , ] [  ]

1

(4.64)

where  =  - ,  =  - , and  =  - . Positions are in geodetic coordinates, so, to transform them into ECEF Cartesian coordinates, the following relations were used: ( + ) cos  cos   [] = [ ( + ) cos  sin  ]  ( (1 -  2 ) + ) sin 

(4.65)

by applying Taylor's series for the above transformation relations and ignoring higher terms, we got: -( + ) sin  cos   [] = [ -( + ) sin  sin  ( (1 -  2 ) + ) cos   -( + ) cos  sin  ( + ) cos  cos  0 cos  cos   cos  sin  ] [  ]  sin 

(4.66)

GPS pseudorange rates or Doppler measurements are related to the relative velocity between the satellite and the receiver projected onto the direction of the unit vector from the satellite to the receiver, as in the following equation:
    = ( -   )    +  + 

(4.67)

where   is the mth satellite velocity in the ECEF frame,  is the true receiver velocity also in the
 ECF farme,  is the receiver clock drift,  is the error in observation, and   is the true line-

of-sight unit vector pointing from the mth satellite to the receiver, shown in:

81

  =

 -    -   

(4.68)

This equation can be rewritten in more detail:
          = (  -   )   + (  -   )   + (  -   )   +  + 

(4.69)

RISS-estimated pseudorange rate can be expressed as:
    = ( -   )  

(4.70)

where  is the RISS-estimated vehicle velocity referenced to ECEF Cartesian coordinates. Similarly to the GPS pseudorange rate equation (5.69), the RISS pseudorange rate equation can also be written as:
         = (, -   )   + (, -   )   + (, -   )    +  + 

(4.71)

where , , , , and , are the RISS-estimated velocities for the receiver referenced to ECEF system. The next step was to compute the pseudorange rate differences between RISS and GPS to further populate the system measurements vector:
        -  = (, -   )   + (, -   )   + (, -   )     +  + 

(4.72)

This equation (5.72) can be rewritten as:
82

      =    , +    , +    , +  + 

(4.73)

Now, writing (5.73) in matrix form:      , ] [  ] +  +   

 

 = [,

 ,

(4.74)

Staking the above equation for M GPS satellites, we got:
1  1 , 1 , 2 ,   , 1 , 1     2   2 , [ ] +   ] + [          , ] [ ]

2   2 = ,     [ ] [,

(4.75)

Now, we needed to include the velocity vector in the LLF in the above system. To do that, we needed to multiply the velocity vector in ECEF frame by the rotation matrix that transforms between the ECEF and LLF systems. The rotation matrix is as follows: - sin  = [ cos  0 - sin  cos  - sin  sin  cos  cos  cos  cos  sin  ] sin 

 

(4.76)

where  and  are the latitude and longitude of the receiver.

83

Next, the velocity vector in LLF is as follows:  - sin    [  ] = [ cos  0   - sin  cos  - sin  sin  cos  cos  cos    cos  sin  ] [  ] sin   

(4.77)

So the pseudorange rate measurements with velocities in LLF are:
1  2    [ ] 1 , 1 , 2 ,   , 1  2  1 ,

 2 = ,   [,

- sin  2 , [ cos   0  , ]

- sin  cos  - sin  sin  cos 

cos  cos    cos  sin  ] [  ] sin    (4.78)

  + [  ] +     [ ] The above system can be rewritten in matrix notations as:
     = ×3  3×1 + ,×1 + ,×1

(4.79)

and by introducing:
  ×3 = ×3  3×1 

(4.80)

    = ×3 3×1 + ,×1 + ,×1



(4.81)

84

Now, by combining the pseudorange and pseudorange rate differences and overall measurements, the model can be presented as:
  ×3 [  ] = [  0×3 

0×3 ×3


0×3 0×3

1×3 0×3

0×3 1×3

]+[

 ,×1 ]   ,×1

(4.82)

A summary of the developed EKF PPP/RISS model characteristics is as follows: 1) It is a closed-loop system in which the navigation state is measured by the estimated position, velocity, and attitude errors. 2) The gyroscope bias is contagiously corrected by the estimated bias error, which helps in maintaining good accuracy during GPS outage. 3) The system is based on EKF, which estimates errors to correct navigation. This ensures accurate navigation states -- and, consequently, linearization is executed around the correct state. 4) The system integration scheme is tightly coupled, which allow the system to benefit from any available satellites.

85

Chapter 5 5 Results and Analysis
The performance of the developed tightly coupled PPP/RISS algorithms was tested on real data collected through various road trajectories conducted under different navigational conditions in a van-type land vehicle. In this chapter, results of processing data from three trajectories are presented. Trajectories are name as: Trajectory 1, Trajectory 2, and Trajectory 3. The state vector of the developed integrated system includes position, velocity, attitude, sensor biases, and receiver's clock bias and drift; however, the results presentation is focused on the positioning results. Figure 5.1 shows a table installed in place of the rear seat of the van that used to travel the trajectories. Attached to the table is part of the equipment used to collect the data.

Figure 5.1 Part of the data collection equipment placed inside the van
86

In the following subsections, more details are given to help the reader understand the experimental setup details.

5.1 RISS Configuration
To target commercial land vehicle applications with low-cost sensors, the developed system was tested using an inexpensive MEMS-based IMU unit (Crossbow brand) that carries the number IMU300CC (Crossbow, 2007) along with odometry data that includes van speed measurements. The Crossbow IMU is a "six-degree-of-freedom" inertial system that uses solid-state devices to measure angular rates and linear accelerations. The Crossbow IMU300CC is capable of measuring X-, Y- and Z-axis accelerations and rate of change of rotations around any of these three axes. However, for RISS, data from only the vertical gyroscope and forward and lateral accelerometers was used. The speed measurements were obtained from the vehicle built-in wheel sensor and collected through an OBO II interface using a data logger called "CarChip" (CarChip, 2013).

5.2 Reference Solution
To assess and evaluate the results, the developed system performance was compared to a high-end tactical grade INS, which was integrated with GPS to serve as a reference solution. In Trajectory 1 and 3, the reference system was based on the Honeywell HG1700 AG17 high-end tactical-grade IMU integrated with the NovAtel OEM4 GPS receiver (NovAtel, 2005), using an off-the-shelf assembly: the OEM4-G2 ProPak_G2plus Synchronized Position Attitude Navigation (SPAN) unit developed by NovAtel (SPAN, 2005). The NovAtel units provide a tightly coupled INS/GPS navigation solution that was used as a reference to compare the performance and the effectiveness of the developed methods. Table B.1 lists the major specification of IMU300CC and HG1700
87

IMUs. In Trajectory 2, the reference system was based on the NovAtel IMU-CPT high-end, tactical-grade IMU integrated with the NovAtel OEM4 GPS receiver (NovAtel, 2005) using an off-the-shelf assembly: the OEM4-G2 ProPak_G2plus Synchronized Position Attitude Navigation (SPAN) unit developed by NovAtel (NovAtel, 2012). Detailed sensors' specifications are presented in appendix B of this thesis. The reference solution processed thorough NovAtel Inertial Explorer (IE), a powerful post-processing with various configuration for GPS/INS integration schemes and GPS mode. In this work, IE is used with tightly-coupled DGPS/INS configuration.

5.3 Time Synchronization
Both systems (the low-cost tightly coupled PPP/RISS developed system and the NovAtel highend reference system) were installed inside the van. The GPS time was used as the reference time, so data from all sensors, including IMU and speed measurements, was synchronized according to the GPS time tag. Also, in the processing stage, the GPS time tag was used to synchronize all measurements and apply the developed filtering algorithms.

5.4 Road Test Trajectories
Several real trajectories were carried out to collect data for testing the developed tightly coupled PPP/RISS integrated algorithm. Three trajectories were selected for this work to show the performance of the developed algorithm under different navigation conditions and compare it with earlier algorithms. These three trajectories are shown later in Figures 5.2, 5.20, and 5.30. The selection of these trajectories was based on the criteria that they should include driving conditions a driver might encounter when driving in urban and suburban areas and on highways. The selection

88

of the trajectories ensured speed variations from zero to 100 km per hr, so sudden stops, accelerations, and sharp as well as smooth turns were experienced during the trajectories.

5.5 Trajectory 1
The first trajectory was carried out in Kingston, Ontario, Canada. The trajectory route is an urban/suburban environment that included the center of the city. This road test was performed for a duration of about 30 minutes, during which a distance of 30 km was travelled while in continuous navigation. Figure 6.2 shows a plot of trajectory drawn on a google map. The main check for the developed integrated system's accuracy is during a GPS signal outage, which was intentionally introduced for a number of outages during the trajectory. Figure 6.2 also shows the locations of the outages in this trajectory, which almost covers a full level of the dynamics that could be encountered using this navigation equipment. Outages were selected to mimic conditions of a typical trip, such as during turns, straight portions, slopes, stops, and at different levels of speed.

89

4

3 5 2 1 1

Figure 5.2 Trajectory 1 The trajectory includes suburban roads (60 to 80 km per hr speed) as well as a highway (100 km per hr speed). Figure 5.3 depicts the change in the vehicle speed during the period of the trajectory.

120

Vehicle's speed (km/hr)

100 80 60 40 20 0 -20 0 500 1000 Time (second) 1500 2000

Figure 5.3 Vehicle Speed for Trajectory 1
90

5.5.1 Data Preprocessing
Data pre-processing is meant to examine and evaluate the quality of the GPS data. To preprocess data for trajectories in this thesis, TEQC, a quality check software developed by UNAVCO, is used to process the GPS observations and navigation data. Appendix B.1 includes a detailed

quality check report for the GPS data for this trajectory. Data checking includes checking dilution of precision (DOP) for the whole trajectory, multipath, and signal-to-noise ratio for each satellite. Figure 6.4 shows satellites availability during trajectory, Figure 5.5 shows DOP values. Figures 6.6 and 6.7 show sky views for multipath MP1 and MP2. Figures 5.8 and 5.9 show sky views for the SNR on L1 and L2, respectively. For this trajectory, GDOP values indicate good satellite geometry during the whole trajectory. Multipath plots show low multipath except for satellite G12; the value reached 1.5 m at the end of the trajectory for both MP1 and MP2, and, also, satellite G19 showed a high value of MP2 all over the trajectory. SNR values showed relatively good SNR for L1 and relatively bad SNR for L2. The variability of SNR was due to the receiver being in high dynamic during landvehicle navigation, which affects the strength of the GPS signal.

91

10

9
8

No of satellites

7 6 5 4 3

2
1 0 0 200 400 600 800 1000 1200 1400 1600 1800 2000

Time (second) Figure 5.4 Satellites availability for trajectory 1

3 2.5 2

GDOP

1.5 1 0.5 0 0 200 400 600 800 1000 1200 1400 1600 1800 2000

Time (second) Figure 5.5 GDOP during Trajectory 1

92

Figure 5.6 Sky View to Show Multipath MP1

Figure 5.7 Sky View to Show Multipath MP2

93

Figure 5.8 Sky View to Show L1 SNR

Figure 5.9 Sky View to Show L2 SNR

94

5.6 Performance Evaluation
The performance of the developed algorithm was tested during the whole trajectory against a reference integrated DGPS/INS solution. In addition, we also compared solutions from the developed algorithm to code-PPP and code- and carrier-PPP solutions. Evaluation of all the three algorithms positional accuracy was tested by means of the computed RMS errors for latitude, longitude, altitude, and two-dimensional and three-dimensional positions, which is shown in Figure 5.12. In all the cases, EKF-Code-Carrier-PPP/RISS had the best performance and EKF-SFCode-PPP/RISS had the worst performance. Also, among the three position components, the altitude showed the worst accuracy compared to the latitude and longitude in all solutions. This was expected because the RISS is missing the z-accelerometer so it has no measure for vertical displacement. This was clear when the travel experienced sudden change of altitude (during sharp uphill and downhill) as depicted in Figures 5.10 and 5.11.

95

90 80 70

Altitude (m)

60 50 40 30 20 10 0 0 500 1000 1500 2000

Time (second) Figure 5.10 Altitude for trajectory 1

10

Altitude difference (m)

8
6 4 2 0 -2 -4 0 200 400 600 800 1000 1200 1400 1600 1800 2000

Time (second)

Figure 5.11 DF-code-PPP/RISS Altitude difference from reference

96

According to RMS error values of the trajectory for two-dimensional positioning, as depicted in Figure 5.12, code and carrier EKF-PPP/RISS performance was 27% and 11% better than EKFSF_PPP/RISS and code EKF-PPP/RISS, respectively. For altitude, this improvement is 44% and 14% respectively during the complete trajectory.

5.00 4.50 4.00

RMS error (m)

3.50

3.00
2.50 2.00 1.50 1.00 0.50 0.00 Lat Long Alt 2D 3D

Code_PPP Code_Carrier_PPP

Code_SF_PPP/RISS Code_Carrier_PPP/RISS

Code_DF_PPP/RISS

Figure 5.12 Comparison of different PPP based position solutions

In Figure 5.13 we compared smoothed-code PPP and code- and carrier-PPP. As expected, code and carrier outperformed smoothed-code solutions; however, smoothed-code solutions showed superiority over code and carrier in longitude.

97

2.5

2

RMS error (m)

1.5

1

0.5

0 Lat Long Alt 2D position 3D position

Position Components IF Code and Carrier IF Smoothed Code

Figure 5.13 Position RMS for smoothed code and code and carrier PPP/RISS solutions

Solution convergence was measured as the time needed to converge the unchanged elements of the model state. From the 16 elements of the vector state, these unchanged elements during all trajectories are the gyroscope bias, as well as X and Y accelerometer biases. Figures 5.14, 5.15, and 5.16 depict the convergence of gyroscope bias, as well as X and Y accelerometer biases, respectively. Results showed that gyroscope bias, as well as X and Y accelerometer biases, needed 250, 60, and 150 seconds to converge, respectively.

98

4

Vertical gyroscope bias (deg/s)

3 2 1 0 -1 -2 -3 0 50 100 150 200 250 300 350

Time (second) Figure 5.14 Convergence of Gyroscope Bias
0.00

Traversal accelerometer bias (m/s2)

0.00 0.00 0.00 0 50 100 150 200 250

-0.01
-0.01 -0.01 -0.01

Time (second) Figure 5.15 Convergence of X Accelerometer

99

0.25

Longitudunal accelerometer bias (m/s2)

0.20 0.15 0.10 0.05 0.00 0 -0.05 50 100 150 200 250 300 350

Time (second)

Figure 5.16 Convergence of Y Accelerometer

5.6.1 Performance during GPS signal outages
During this trajectory there was no natural GPS signal blockage, because the trajectory was planned to have continuous GPS availability in order to help generate a reference solution to evaluate the developed PPP/RISS algorithms. However, to test the PPP/RISS model, five simulated GPS signal outages were introduced in the GPS measurements at different locations along the trajectory. These GPS outages range from complete outage, with no GPS satellites available, to partial outages with one, two, or three GPS satellites available. Figure 5.17 shows the average maximum positioning error of five simulated GPS signal outages for satellite availability of zero, one, two, and three satellites. The comparison of SF-code-PPP/RISS, DF-code-PPP/RISS, SDF-code-PPP/RISS, and code-carrier-PPP/RISS algorithms show that the SF-code-PPP/RISS produced the biggest error in all GPS outage levels. On the other hand, code-carrier-PPP/RISS showed the best accuracy with maximum error of about 3.5 m. The availability of more satellite
100

benefits SDF-code-PPP/RISS and code-carrier-PPP/RISS more than the other models. The availability of three satellites has a significant effect on all models. Overall the maximum error was limited by 9.8 m for two or less than two satellites, and the solution depends mainly on the RISS.

Average max error (m)

12 10 8 6 4 2 0 0 1 2 3

Number of satellites SF-Code-PPP/RISS SDF-code-PPP/RISS DF-Code-PPP/RISS Code-Carrier-PPP/RISS

Figure 5.17 Average maximum positioning error for all models during outage of 60 seconds

Figure 5.18 shows the average maximum positioning error of five simulated GPS signal outages each of 60 second duration. The comparison of SF-code-PPP/RISS, DF-code-PPP/RISS, SDF-code-PPP/RISS, and code-carrier-PPP/RISS algorithms show that the SF-code-PPP/RISS produced the biggest error in all GPS outage levels. On the other hand, code-carrier-PPP/RISS is superior to other counterparts with a maximum error of about 4.7, 1.1, 1.2, 2.1, and 3.0 m for outages number 1, 2, 3, 4, and 5 respectively.

101

Average maximum error (m)

14 12 10 8 6 4 2 0

1

2

3

4

5

Outage number SF-Code-PPP/RISS SDF-code-PPP/RISS DF-Code-PPP/RISS Code-Carrier-PPP/RISS

Figure 5.18 Performance of algorithms during complete GPS outage

102

5.7 Trajectory 2
The second trajectory was also done in Kingston, Ontario. The nature of this trajectory is an urban/suburban environment that includes the centre of the city. This road test was performed for a duration of about 50 minutes, during which a distance of 45 km was travelled while in continuous navigation. Figure 5.19 shows the route and location of trajectory 2. As with Trajectory 1, the main check for the developed system's accuracy was during GPS signal outage, intentionally introduced for a number of outages during the trajectory. Figure 5.19 also shows the locations of the outages in this trajectory, which almost covers a full level of the dynamics that could be encountered using this navigation equipment. Outages were selected to mimic conditions of a typical trip, such as during turns, straight portions, slopes, stops, and at different levels of speed.

6 7 5

8

9 3
10

4

1

2 1

Figure 5.19 Trajectory 2
103

The second trajectory also included in its route suburban roads (60 ­ 80 km per hr. speed) as well as a highway (100 km per hr. speed). Fig 5.20 depicts the change in the vehicle speed during the period of the trajectory.

90 80 70 60 50 40 30 20 10 0 -10 0 500 1000 1500 2000 Time (second) 2500 3000 3500

Vehicle's speed (Km/hr)

Figure 5.20 Vehicle Speed during Trajectory 2

5.7.1 Data Pre-processing
Similarly to Trajectory 1, the data pre-processing was conducted by processing the GPS observations and navigation data through TEQC software, appendix C.2 includes a detailed quality check report for the GPS data for this trajectory. Data preprocessing also included examining GDOP for the whole trajectory, multipath, and signal-to-noise ratio for each satellite. Figure 5.21 shows number of available satellites at each epoch during this trajectory. Figure 5.22 shows DOP

104

values. Figures 5.23 and 5.24 show sky views for multipath MP1 and MP2. Figures 5.25 and 5.26 show sky views for the SNR on L1 and L2, respectively. For this trajectory, GDOP values indicate relatively good satellite geometry during the first half of the trajectory, while the second half shows completely bad satellite geometry. As shown in Fig 5.18, the GDOP reached a maximum of 4 in a few epochs in the first half, and in the second half, GDOP showed severe sudden changes with a maximum of 7.

9 8

Number of satellites

7
6 5 4 3 2 1 0

0

500

1000

1500

2000

2500

3000

3500

Time (second) Figure 5.21 Satellites availability for trajectory 2

105

8 7 6 5 4 3 2 1 0 0 500 1000 1500 2000 Time (second) 2500 3000 3500

GDOP

Figure 5.22 GDOP Plot for Trajectory 2

The multipath plot in Figures 5.23 and 5.24 show low multipath except for satellite G02, which shows high severity for almost half of the trajectory duration for both MP1 and MP2. Also, satellites G10 and G08 have multipath of a number of epochs. These three satellites were in low elevations, which made them more exposed to multipath. The sky plots also show the bad geometry of the satellites during this trajectory.

106

Figure 5.23 Sky view to show multipath MP12 during Trajectory 2

Figure 5.24 Sky view to show multipath MP21 during Trajectory 2

107

Following the pre-processing of Trajectory 2 data, Figures 5.25 and 5.26 show L1 and L2 SNR, respectively. L1 SNR show relatively good signal strength and agrees with the SNR in Trajectory 1, in that L1 SNR is better that L2 SNR. Again, the variability of SNR is because of the high dynamic experienced by the GPS receiver and also the high rate of data collection.

Figure 5.25 Sky view to show L1 SNR during Trajectory 2

108

Figure 5.26 Sky view to show L2 SNR during Trajectory 2

5.7.2 Performance evaluation
The performance of the developed algorithm was tested during the whole trajectory against a reference-integrated DGPS/INS solution. In addition, we also compared solutions from the developed algorithm to code-PPP and code- and carrier-PPP solutions. Evaluation of all the three algorithm's positional accuracies was tested by means of the computed RMS errors for latitude, longitude, altitude, and two-dimensional and three-dimensional positions, which is shown in Figure 5.29. All the cases code and carrier EKF-PPP/RISS had the best performance and EKFSFPPP/RISS had the worst performance. According to RMS, the value of the trajectory for two-dimensional positioning as depicted in Fig 5.11 was as follows: code- and carrier-EKF-PPP/RISS performance was 27% and was 11% better than EKF-SF_PPP/RISS and code EKF-PPP/RISS, respectively. For altitude, this
109

improvement was 44% and 14%, respectively, during the complete trajectory. Similar to what we noticed in trajectory 1, the altitude showed the worst accuracy compared to latitude and longitude in all PPP/RISS solutions.

4 3.5 3

RMS error (m)

2.5
2 1.5 1 0.5 0 Lat Long Alt 2D 3D

Time (second) Code_PPP Code_DF_PPP/RISS Code_Carrier_PPP/RISS Figure 5.27 Comparison of different PPP-based position solutions Code_SF_PPP/RISS Code_Carrier_PPP

To highlight the contribution of the RISS to PPP. In figures 5.28 and 5.29 a comparison between the PPP only and PPP/RISS solutions is given. Figure 5.28 shows code-based solutions and Figure 5.29 shows code and carrier based solution. Both figure show clearly how the solution improved when PPP is integrated to RISS.

110

10 8 6 4 2 0 -2 -4 -6 -8 0 500 1000 1500 2000 2500 3000 3500

Altitude difference (m)

Time (second) Code PPP Code PPP/RISS

Figure 5.28 DF-Code PPP and DF-Code PPP/RISS altitude differences from reference

8

Altitude difference (m)

6 4 2 0 0 -2 -4 -6 500 1000 1500 2000 2500 3000 3500

Time (m) Code Carrier PPP Code-carrier PPP/RISS

Figure 5.29 Code-carrier-PPP and Code-Carrier PPP/RISS altitude differences from reference

111

The solution convergence was measured as the time needed to converge the unchanged elements of the model state. From the 16 elements of the model state, the unchanged elements during all trajectories were the gyroscope bias, as well as X and Y accelerometer biases. Figures 5.30, 5.31, and 5.32 depict the convergence of gyroscope bias, as well as X and Y accelerometer biases, respectively. Results for this trajectory show that gyroscope bias, X accelerometer bias, and Y accelerometer bias converged in 400, 8, and 5 seconds, respectively.
20

Vertical gyroscope bias (deg/s)

10 0 -10 -20 -30 -40

-50 0 200 400 600 800 1000 1200

Time (second) Figure 5.30 Convergence of Gyroscope Bias

112

0

Traversal accelerometer bias (m/s2)

-0.000002 -0.000004 -0.000006 -0.000008 -0.00001 -0.000012 -0.000014 -0.000016

0

10

20

30

40

50

60

Time (second)

Figure 5.31 Convergence of X Accelerometer
0

Forward accelerometer bias (m/s2)

-0.00005 -0.0001

0

10

20

30

40

50

60

-0.00015
-0.0002 -0.00025 -0.0003 -0.00035 -0.0004 Time (second)

Figure 5.32 Convergence of Y Accelerometer

5.7.3 Performance during outages
Similar to Trajectory 1, during this trajectory there was no natural GPS signal blockage; this was also meant to help generate a reference solution for evaluating the develped PPP/RISS algorithms.
113

However, to test the PPP/RISS model for this trajectory, ten simulated GPS signal outages were introduced in the GPS measurements at different locations along the trajectory. These GPS outages ranged from complete outage, with no GPS satellites available, to partial outages with one, two, or three GPS satellites available. Figure 5.33 shows the average maximum positioning error of five simulated GPS signal outages for satellite availabilities of zero, one, two, and three satellites. The comparison of SF-code-PPP/RISS, DF-code-PPP/RISS, SDF-code-PPP/RISS, and code-carrierPPP/RISS algorithms show that the SF-code-PPP/RISS produces the biggest error in all GPS outage levels. On the other hand, code-carrier-PPP/RISS shows the best accuracy with a maximum error of about 5.9 m. The availability of more satellite benefits SDF-code-PPP/RISS, and codecarrier-PPP/RISS more than the other models. The availability of three satellites has a significant effect on all models. Overall, the maximum error was limited by 9.8 m for two and less than two satellites, and the solution depends mainly on the RISS.

14 12 10 8 6 4 2 0 0 1 2 3

Average max error (m)

Time (second) SF-Code-PPP/RISS DF-Code-PPP/RISS

SDF-code-PPP/RISS

Code-Carrier-PPP/RISS

Figure 5.33 Average maximum positioning error for all models during outage of 60 seconds
114

Figure 5.34 shows the average maximum positioning error of five simulated GPS signal outages each of 60 second duration. The comparison of SF-code-PPP/RISS, DF-code-PPP/RISS, SDF-code-PPP/RISS, and code-carrier-PPP/RISS algorithms show that the SF-code-PPP/RISS produced the biggest error in all GPS outage levels. On the other hand, code-carrier-PPP/RISS is superior to other counterparts with a maximum error of about 3.4, 1.1, 1.2, 4.0, 4.0, 3.7, 1.9, 1.4, 4.9, and 6.0 m for outages number 1 to 10 respectively.

14 12 10 8 6 4 2 0
1 2 3 4 5 6 7 8 9 10

Average max error (m)

Time (second) SF-Code-PPP/RISS SDF-code-PPP/RISS DF-Code-PPP/RISS Code-Carrier-PPP/RISS

Figure 5.34 Performance of algorithms during complete outage

115

5.8 Trajectory 3
The third trajectory was carried out in Toronto, Ontario, Canada. Toronto is one of the largest and busiest cities in North America, having a downtown with small blocks and narrow roads, in addition to a large amount of high-rise buildings. For these reasons, this trajectory was very challenging. We were expecting to face frequent GPS signal blockage, low satellite availability, harsh multipath sharp turns, and overpass bridges. The total travelled distance in this trajectory was not long compared to about 1.5 hours of travel time. This was because of slow traffic at the time of the trajectory. Figure 5.35 shows the route for this trajectory, which includes the Don Valley Parkway (DVP) highway, Gardiner Express highway, and the busy urban routes of Spadina Street, Bloor Street, and Bay Street. Figure 5.36 depicts vehicle's speed.

Figure 5.35 Trajectory 3
116

120

Vehicle's speed (km/hr)

100

80
60 40 20 0 -20

0

1000

2000

3000 4000 Time (second)

5000

6000

7000

Figure 5.36 Vehicle's speed for trajectory 3

This trajectory show a real challenge for GPS and this is due to signal loss from time to time. Quality check report in appendix C.3 shows detailed analysis of the GPS observations for this trajectory. Figure 5.37 depicts the satellite availability, which shows very low satellites availability with zero satellites for varying periods of time, which creates natural GPS signal outages.

117

12 10

Number of satellites

8 6 4 2 0 -2 0 1000 2000 3000 4000 Time (second) 5000 6000 7000

Figure 5.37 Satellite Availability during Trajectory 3

In addition to satellite availability, Figure 5.38 depicts the GDOP values, which show high GDOP in the majority of the trajectory. This indicate how challenging this trajectory for PPP only. Figure 5.39 shows how the two-dimensional positioning PPP solution is affected by frequent GPS signal loss and severe multipath.

118

90 80 70 60 50 40 30 20 10 0 -10 0

GDOP

1000

2000 3000 Time (second)

4000

5000

Figure 5.38 GDOP for Trajectory 3

Figure 5.39 Repeated GPS signal outages
119

5.8.1 Performance evaluation
The performance of the developed PPP/RISS algorithms was tested in this trajectory during natural GPS signal outages. The positioning reference solution used here was obtained from the integrated tactical grade and GPS. Figure 5.40 shows nine natural outages as well as their time and durations. As the outages are natural, they have varying durations ranging from 18 to 450 seconds.

Maxx 2D position error (m)

60 50 40 30 20 10

0
(1, 350) (2, 95) (3, 172) (4, 65) (5, 44) (6, 36) (7, 425) (8, 100) (9, 18) Outage time ((second) ), duration ((second) ) SF-Code-PPP/RISS SF-Code-PPP/RISS Code-Carrier-PPP/RISS

Figure 5.40 Two-dimensional position maximum error for natural outages during Trajectory 3

5.9 Summary
In this section, we summarized the positioning results from four algorithms of EKF-based tightly coupled PPP/RISS integrated systems. The test data were from three trajectories that captured different urban and suburban navigation environments. Trajectories 1 and 2 captured the same environment which is classified as urban/suburban, while trajectory 3 is classified as urban. In
120

summarizing the results we separate between trajectory 1 and 2 in one group (urban/suburban) and trajectory 3 in another group (urban). The results show RMS values and their averages for all trajectories for latitude, longitude, and altitude, which are summarized in Table 5.1 for group 1. In this group, Trajectory 2 showed better accuracy in all models and for most three-dimensional positioning components, although Trajectory 1 shared the same navigation environment as Trajectory 2 and also had a shorter duration and shorter travelled distance -- so was less exposed to critical driving conditions. However, it showed larger RMS values than Trajectory 2 during most of the route. This is because the reference tactical grade used in Trajectory 2 has less gyroscope accuracy. The models results show that code-carrier-PPP/RISS was superior to SF- and DF-codePP/RISS. I latitude. Code-carrier-PPP/RISS improved the solution by 47% and 20% from SF- and DF-code-PP/RISS, respectively. In longitude, code-carrier-PPP/RISS was superior to SF- and DFcode-PP/RISS by 65% and 31%, respectively. Code-carrier-PPP/RISS continued its outperformance to SF- and DF-code-PP/RISS in altitude by 46% and 25%, respectively.

Table 5.1 Trajectories' Overall RMS (Meters) for Urban/Suburban Environment
SF-Code-PPP/RISS Lat Traj 1 Traj 2 Average 1.612 1.720 1.666 Long 1.762 1.580 1.671 Alt 2.545 2.014 2.280 DF-Code-PPP/RISS Lat 1.057 0.992 1.025 Long 0.953 0.780 0.867 Alt 1.741 1.804 1.773 Code-Carrier-PPP/RISS Lat 0.885 0.905 0.895 Long 0.560 0.641 0.601 Alt 1.383 1.257 1.32

121

Table 5.2 summarizes metrics for the algorithms' performance during GPS signal outages. In this table the average performance for all three algorithms in situations where the satellites' availability was zero, one, two, or three satellites is presented. The GPS signal outage duration is fixed to 60 seconds for two, and zero for 60 seconds. The number of outages is five, 10 and two for Trajectories 1, 2, and 3, respectively. Taking the average of all trajectories for all satellite cases as a performance measure, we find that code-carrier-PPP/RISS outperforms SF- and DF-codePPP/RISS by about 35% when the satellite availability level was set at three. For other satellite availability levels, all algorithms performed almost identically.

Table 5.2 Summary of 2D position average maximum error (m) at different levels of satellites availability (Urban/Suburban)
SF-Code-PPP/RISS
Satellite #

DF-Code-PPP/RISS 3 9.22 6.77 0 19.3 1 17.52 2 17.36 14.25 3 9.15 6.68

Code-Carrier-PPP/RISS 0 20.19 10.52 1 18.88 2 16.5 3 6.91 4.01 5.46

0 19.6 14.09 16.71

1 17.62 15.80 15.71

2 17.27 14.14 8.00

Traj 1 Traj 2 Average

13.95 15.75

10.51 16.55 16.33

16.63 16.64 15.81 15.81 7.92

15.36 14.7

Table 5.3 presents the performance of developed algorithms at different levels of satellites availability during trajectory 3.

122

Table 5.3 Summary of 2D position average maximum error (m) at different levels of satellites availability (Urban)
SF-Code-PPP/RISS DF-Code-PPP/RISS 3 0 1 2 3 Code-Carrier-PPP/RISS 0 1 2 3

Satellite #
Traj 3

0

1

2

16.40 17.84 16.12 15.45 16.30 16.75 16.15 15.51 14.79 14.45 14.94 12.83

It is worth mentioning here that performance during GPS signal outages depends on the estimation of gyroscope bias, which determines how algorithms are going to predict its course when limited or no help is available from GPS measurements. That is why the performance of code-carrierPPP/RISS over the other algorithms is not as significant during very low satellite availability compared to when enough satellites are available and RMS for the whole trajectory was computed.

123

Chapter 6 6 Summary, Conclusions and Recommendations
This chapter summarizes the work presented in this thesis and draws some conclusions from the theoretical development and results of this research. The second section of this chapter presents some recommendations for future research.

6.1 Summary and Conclusions
Currently, land vehicle navigation relies on single-frequency stand-alone GPS, which provides limited accuracy of 10 m to 15 m and requires the GPS receiver to be locked onto at a minimum of four GPS satellites to be able to generate a navigation solution. In urban canyons, however, high-rise buildings and other structures obstruct the GPS satellite signals, which present a challenge to have useful navigation solutions using GPS only. Also, road traffic safety is targeting vehicle-to-vehicle communication, which requires accurate positioning and navigation solutions of less than 2 m (e.g., this is being done through the Cooperative Vehicle Safety System [CVSS]). In the future, reliable, accurate, and low-cost navigation systems will be apriority for land-vehicle. There are existing technologies, which can be integrated with GPS in order to overcome GPS's low satellite availability and signal blockage. However, these technologies are costly. An alternative for expensive INS technologies is the MEMS-based inertial sensors. MEMS-based sensors offer low-cost solutions, but they produce measurements with complex errors. To adapt to

124

these errors, robust systems need to be designed and alternatives for removing and reducing errors' sources must be employed. In this research, the precise point positioning (PPP) technique is integrated with a reduced inertial sensors system (RISS) -- a low-cost system that uses data from reduced MEMS-based inertial sensors and vehicle odometry -- to provide accurate, reliable, and inexpensive landvehicle navigation system. The developed system is integrated in a tightly coupled mode through the use of an extended Kalman filter (EKF), which employs an improved error model for the RISS data. The developed system was tested by real trajectories' data with single-frequency code PPP/RISS (SF-code-PPP/RISS), dual-frequency code PPP (DF-code-PPP/RISS), smoothed dualfrequency code PPP (S-DF-code-PPP/RISS), and code- and carrier-Phase PPP (code-carrierPPP/RISS). The performance of the developed PPP/RISS model was evaluated by means of RMS and maximum error of position during continuous GPS availability and during GPS signal outages. The test data in this research was collected through three road trajectories that captured different urban and suburban navigational environments. Trajectories 1 and 2 were conducted in Kingston, Ontario, Canada and Trajectory 3 was performed in Toronto, Ontario, Canada. The developed algorithms were tested when four satellites were available and also when there was a GPS signal outage with variations between zero and three satellites available. The evaluation of the results was based on the RMS and maximum errors. Also, we evaluated individual coordinate components (latitude, longitude, and altitude) and the two- and three-dimensional positioning.

125

The results suggest that, during satellite availability, code-carrier-PPP/RISS is superior to SF- and DF-code-PP/RISS. In latitude, code-carrier-PPP/RISS improved the solution by 47% and 20% from SF- and DF-code-PP/RISS, respectively. In longitude, code-carrier-PPP/RISS is superior to SF- and DF-code-PP/RISS by 65%, and 31%, respectively. Code-carrier-PPP/RISS continues its outperformance to SF- and DF-code-PP/RISS in altitude by 46% and 25%, respectively. During GPS signal outages of 60 seconds in duration, we concluded the performance of the developed algorithms as: the code-carrier-PPP/RISS outperformed SF- and DF-codePPP/RISS by about 35% when the satellite availability level was at three satellites. At all other satellite availability levels, all algorithms performed almost identically. It should be pointed out that the system performance during GPS signal outages depends on the convergence of the gyroscope bias, which determines how algorithms are going to predict its course when limited or no GPS measurements are available. This explains why the performance of code-carrier-PPP/RISS is not as significant (close to or similar to the other algorithms) during very low satellite availability. Overall, this thesis shows that the integration of PPP and RISS eliminates the challenge of using kinematic PPP in land-vehicle navigation. The developed system employs RISS, which is in comparison to a full INS sensors, simplified the computation process, reduced the sources of error, and, in addition, saved the cost of two gyroscopes and one accelerometer.

126

6.2 Recommendations
This research explored the use of: (1) single-frequency code; (2) dual-frequency code-only; (3) code and carrier-phase PPP. In (1), ionospheric delay was corrected using the US total electron content (USTEC) model developed by the National Oceanic and Atmospheric Administration (NOAA), the International GNSS Service (IGS)'s final global ionospheric maps (GIM), and the Centre for Orbit Determination in Europe (CODE). In (2) and (3), ionosphere-free linear combinations were used to correct ionospheric delay. Other GPS errors commonly corrected in (1), (2) and (3) included tropospheric delay, satellite precise clock and orbit, Sagnac, relativity, satellite hardware delay, ocean loading, and signal windup (in [3]). Future improvements could be achieved through the following: 1) In this research, multipath error is only accounted for through the GPS measurements stochastic model. In future research, other techniques to mitigate multipath could be explored. 2) In future research, models for mitigating receiver hardware delay could be adopted. 3) In this research, the PPP/RISS system was based on EKF. In future research, other estimation techniques (e.g., using a particle filter) could be adopted to check for any accuracy improvement. 4) Results show that the developed PPP/RISS system works with less than four GPS satellites, so the overall efficiency of the system could be improved by including other GNSS systems -- e.g., GLONASS and Galileo. 5) In this research, the MEMS-based IMU used was the Crossbow IMU 300CC, which is considered a very low grade. The Crossbow IMU 300CC has a gyroscope bias of two
127

degree/s, which is very high bias. Since the market for the MEMS-based IMU indicates that its price will likely drop soon, a better accuracy MEMS IMU could be obtained for the same or less than the price of Crossbow IMU 300CC. Using a better-quality MEMS-grade is recommended for enhancing the PPP/RISS system's accuracy. 6) More data from challenging urban environment such as downtown Toronto is recommended to test the developed algorithms. 7) Algorithms to employ triple-frequency GPS data could be developed.

128

Appendix A

129

Reference Coordinates Frames

Reference frame definition is an important component of mathematical models that involve positioning and navigation. In navigation and positioning, quantities of interest -- such as position, velocity, acceleration, and angular rates -- must be expressed relative to a particular frame of reference. The work in this thesis employs different navigation sensors. Each of the sensors used produces results of position, velocity, and/or attitude that describe a certain reference frame. The literature defines several reference frames defined that have been used in positioning and navigation applications. Of these reference frames, five distinct frames of reference and a geodetic coordinate system are defined and used in this thesis. These reference systems include: EarthCentred Inertial (ECI), Earth-Centred Earth-Fixed (ECEF), geodetic coordinate system, local-level frame (LLF), and body frame (BF). In the following an overview is provided for these five frames as described in Noureldin (2007), Karamat (2009), and Georgy (2010).

A.1 Earth-Centred Inertial Frame
Any reference frame that obeys Newton's laws of motion and gravity is recognized as an inertial frame of reference (Farrell, 1998). Inertial frame is either stationary in space or moves with constant velocity. Measurements produced by inertial sensors along their sensitive axis are measured relative to a certain inertial frame. For platforms navigating near the Earth, it is convenient to use the Earth-Centred Inertial Frame (ECI). The axes of the ECI frame are depicted with superscripts (Xi, Yi, Zi), as in Figure A.1. According to the definition in Misra and Enge
130

(2006), ECI originated at the centre of Earth's mass. The Z-axis is directed towards a conventional terrestrial north pole. The X-axis lies in the equatorial plane and it points towards the vernal equinox. The Y-axis is defined such that it completes a right-handed system. For short periods of time, the previous definition of ECI is satisfactory, although the Earth does not orbit around the sun with fixed speed.

Figure A.1 Earth-Centred Inertial and Earth-Centred Earth-Fixed Reference Frames

131

A.2 Earth-Centred Earth-fixed Frame
ECEF is an Earth-fixed (rotating with the Earth) system of spatial Cartesian coordinates X, Y, Z. Its origin is at the Earth's centre of mass (geocentre). The three axes of ECEF are as follows. The Z-axis is directed towards a conventional terrestrial north pole. The equatorial plan is perpendicular to the Z-axis and it contains the X and Y axes. The X-axis passes through the intersection of the equatorial plane and the Greenwich meridian (prime meridian). The Y-axis is defined such as to complete a right-hand coordinate system. Figure A.1 shows an ECEF frame relative to an ECI frame.

A.3 Geodetic Coordinate System
The geodetic coordinate system is a polar representation of the ECEF reference frame. It is established by modelling the Earth with an ellipsoid in such a way that the vertical axis of the ellipsoid aligns with the ECEF Z-axis. The ellipsoid model of the Earth is used to relate geodetic latitude and longitude coordinates to ECEF coordinates. Figure A.2 shows the relationship between geodetic coordinate system and ECEF reference frame.

132

Figure A.2 Geodetic Coordinate System

A.4 Local Level Frame
A local level frame (also known as the navigation frame) originates at the centre of gravity of the moving platform. LLF is used to express the moving platform's attitude and velocity when operating on or near the Earth's surface. In this thesis, LLF axes are as follows. The X-axis points east. The Y-axis points north. The Z-axis points upward to the Earth's reference ellipsoid such as to complete a right-handed coordinate system. LLF is also referred to as ENU (east, north, and up).

133

There is also another commonly used version of LLF that has the X-axis pointing north, Y-axis pointing east, and Z-axis pointing down (normal to the Earth's reference ellipsoid) such as to complete a right-handed coordinate system. This frame is known as the NED frame. Figure A.3 illustrates the ENU.

Figure A.3 North-oriented Local Level Frame

A.5 Body Frame
Body frame is the moving-platform frame. Its origin coincides with the centre of mass of the moving platform. Body frame axes are oriented as follows. The Z-axis points towards the upward
134

vertical direction of the moving platform. The Y-axis points towards the forward direction. The X-axis points towards the transverse direction completing a right-handed coordinate system. In land vehicle navigation applications, the axis set defined by the sensitive axes of the accelerometer sensors aligned with the axes of the moving platform in which the sensors are mounted (i.e., aligned with the body frame). The body frame used in this thesis is shown in Figure A.4.

Figure A.4 Body Frame

A.6 Coordinates Transformation A.6.1 ECI to ECEF
ECI and ECEF have coincident origins and Z-axes. The transformation between ECI and ECEF can be implemented by applying a single rotation around the Z-axis, as follows:

135

  =  (, ) [ ] [ ]    

(A.3)

Here  is the Earth angular velocity ( =7.2921151467*10-5rad/sec), (t = t - t0) is the difference between the epoch at time (t) and the epoch when the two frames are coincide at initial time (t0), and  (. ) is the rotation matrix around the Z-axis, with the angle in parentheses measured counterclockwise.

A.6.2 ECEF to ENU
ECFE and ENU have different origins and axes orientation. The transformation between ECI and ECEF can be implemented by applying rotations a single to align both frames axes and then applying a shift to unify the origins of the systems, as follows (Farwell, 1998; 2008):

  =  (90° - ).  (90° + ). [ ] [ ]  NU  FC

(A.2)

0   - [ 0 ] [ ] = [ ] 0    

(A.3)

here  and  are the geodetic latitude and longitude of the origin of ENU, [0

0

0 ] is the

Cartesian coordinates of the origin of ENU system,  (. ) and  (. ). The rotation matrices around the X- and Z- axis, respectively, with the angle in parenthesis measured anticlockwise.

136

A.6.3 Transformation of velocity from ECEF to ENU
The velocity transformation from ECFC to ENU requires the rotations of the X- and Z- axis to align the ECEF fame with ENU. The mathematical formula is given as:

V V [V ] =  (90° - ).  (90° + ). [V ] V V EF

(A.4)

here [VE

VN

VU ]T is the velocity vector in ENU frame, and [VX

VY

VZ ]ECEF is the velocity

vector in ECEF frame.  (. ) and  (. ) are rotation matrices around the X- , Y-, and Z- axis, respectively, with the angle in parenthesis measured counterclockwise.

A.7 ENU to Body Frame
The transformation of ENU into body frame requires three consecutive rotations. It given in mathematical representations as:    = R  . [ ] [ ]  Body  ENU

(A.5)

  = R Y (r). R X (p). R Z (-A)

(A.6)

137

 

cos  =[ 0 sin 

0 - sin  1 1 0 ] [0 0 cos  0

0 cos  - sin 

0 cos - sin  ] [ sin - cos  0

sin - cos - 0

0 0] 1

(A.7)

 

cos  =[ 0 sin 

0 - sin  1 1 0 ] [0 0 cos  0

0 cos  - sin 

0 cos - sin  ] [ sin - cos  0

sin - cos - 0

0 0] 1

(A.8)

 

cos  cos  + sin  sin  sin  cos  sin  =[ sin  cos  - cos  sin  sin 

-cos  sin  + sin  sin  cos  cos  cos  -sin  cos  - cos  sin  sin 

- sin  cos  (A.9) sin  ] cos  cos 

here r, p, and A are the roll, pitch, and azimuth of the moving object, respectively.  (. ),  (. ) and  (. ) are rotation matrices around the X- , Y-, and Z- axis, respectively, with the angle in parenthesis measured counterclockwise.

138

Appendix B

139

A.1 Crossbow IMU 300CC Specifications

Table B.1 Crossbow IMU 300CC Specifications
Parameter Size Weight Power consumption Input voltage Gyro/accelerometer technology Update rate Start-up time Accelerometer Range Accelerometer Bias Accelerometer Scale factor Accelerometer Random Walk Gyroscope Range Gyroscope Bias Gyroscope Scale factor Gyroscope Random Walk Specification 7.62x9.53x8.13 cm 0.5 Kg <3 W +9 to +30 MEMS 200 Hz <1 S ±2g <±30 mg <1% <0.15m/shr ±100°/s 20°/S <1% <2.25°/hr

140

Table B.2 NovAtel SPAN CPT Specifications
Parameter Size Weight Power consumption Input voltage Gyro/accelerometer technology Update rate Start-up time Accelerometer Range Accelerometer Bias Accelerometer Bias Stability Accelerometer Scale factor Accelerometer Random Walk Accelerometer Linearity Gyroscope Range Gyroscope Bias Gyroscope Scale factor Gyroscope Random Walk Specification 15.2x16.8x8.9 cm 2.29 Kg 13 W +9 to +3018 Gyro: FOG; Accelerometer: MEMS 100 Hz N/A ± 10 g 50 mg ±0.75 mg 4000 ppm N/A N/A ±375°/s 20°/hr 1500 ppm <0.0667°/hr

141

Table B.3 Honeywell HG1700 IMU
Parameter Size Weight Power consumption Input voltage Gyro/accelerometer technology Update rate Start-up time Accelerometer Range Accelerometer Bias Accelerometer Bias Stability Accelerometer Scale factor Accelerometer Random Walk Gyroscope Range Gyroscope Bias Gyroscope Scale factor Gyroscope Random Walk Specification 16x16.8x10 cm 3.4 Kg 12 W + 12 to + 18 VDC Gyro: RLG; Accelerometer: RBA 100 Hz 0.8 s ± 50 g <± 1 mg ±0.75 mg 300 ppm < 0.198 m/shr ±1000°/s 1.0°/hr 150 ppm <0.125°/hr

142

Table B.4 SPAN Reference System
Parameter Size Weight Power consumption (typical) Input voltage Position accuracy (RMS) Single point L1 Single point L1/L2 SBAS DGPS CDGPS RT-20 RT-2 Velocity accuracy (RMS) Attitude accuracy (RMS) Pitch Roll Azimuth Time accuracy (RMS) Cold Start Hot Start GPS Measurement Precision (RMS) L1 C/A Code L2 P(Y) Code DGPS L1 Carrier Phase DGPS L2 Carrier Phase Signal reaquisition Accelerometer Scale factor Specification 20x24.8.8x7.8 cm 3.4 Kg Single antenna: 10 W; Dual antenna: 12 W + 9 to + 28 VDC 1.50 m 1.20 m 0.60 m 0.40 m 0.60 m 0.20 m 0.01 m + 1ppm 0.03 m/s 0.02° 0.02° 0.06° 60 s 35 s 0.06 m 0.08 m 0.50 mm 1.00 mm ±0.75 mg 300 ppm

143

Accelerometer Random Walk Gyroscope Range Gyroscope Bias Gyroscope Scale factor Gyroscope Random Walk

< 0.198 m/shr ±1000°/s 1.0°/hr 150 ppm <0.125°/hr

144

Table B.5 GPS error Budget (Misra and Enge, 2001; Abdelsalam, 2005; Du, 2010) Common Error Source Satellite orbit Satellite Clock Ionospheric Delay Tropospheric Delay Multipath Error Magnitude 2.0 m 2.0 m 2.0 ~ 10.0 m at zenith 2.3 ~ 2.5 m at zenith In clean environment Code: 0.5 ­ 1.0 m Carrier: 0.5 ­ 1.0 cm Receiver Noise Code: 0.25 ­ 0.5 m Carrier: 1.0 ­ 2.0 mm

145

Appendix C

146

C.1 Quality check Report of GPS Observations for Trajectory 1
Version: teqc 2015Nov6 SV+-----------|------------------------|-----------------------|-----------+ SV 19|+LLL+LL_LL_LL__LLL_L+_LLLLLLLLLLL_L+LL+_________________________| 19 27|oIooooooooooooooooooooooooooooooooooooooooooooooIooooooooooo-Loooooo-ooo| 27 21|oooooIIIII-I-II-I-IIIIIIooI--ooooooooooooo--ooooIo-oooIIoIooooo-II--oooo| 21 9|ooooooooooooooooooooooooooooooooooooooooooooooooIooooooooooooooooooooooo| 9 14|ooooooooooooooooooooooooooooooooooooooooooooooooIoooooooooooooIooooooooo| 14 22|ooooooooooooooooooooooooooooooooooooooooooooooooIooooooooooooooooooooooo| 22 12|o-II-III-I--IIIII-IIIIIIoooIIooooooooooooooIooooIoooooIoo-oI-LIooo-ooooo| 12 15|oIoooooooooooooooooooooIooooooooooIoooooooooooooIoooIoIo-Io-IIIIooooIooo| 15 18|ooooooooooooooooooooooooooooooooooooooooooooooooIooooooooooooooooooooooo| 18 25| _____________________________L+LLLL_LL+++LL+LLLLLLL+LLLLL+LLL+++| 25 S33| L LLLL L |S33 S38| L LL LL L L |S38 -dn| 1 1 + + + + |-dn +dn| 21112222222222222222223 22 1 12 8 1 1 3112 2312111212 |+dn +10|888888888888888888888888888888888888888888888888888888888888888888888888|+ 10 Pos|oooo o o o o oo ooooooooooo ooooo |Pos Clk| |Clk +-----------|------------------------|-----------------------|-----------+ 16:25:10.000 16:54:29.000 2011 Apr 22 2011 Apr 22 ********************* QC of RINEX file(s) : propakv3_apr_22_11.11o Input RnxNAV file(s) : propakv3_apr_22_11.11n ********************* 4-character ID Receiver type Antenna type : PAK3 : NovAtel GPSCard :

Time of start of window : 2011 Apr 22 16:25:10.000 Time of end of window : 2011 Apr 22 16:54:29.000 Time line window length : 29.32 minute(s), ticked every 10.0 minute(s) antenna WGS 84 (xyz) : 1079532.3544 -4441266.8419 4433859.4788 (m) antenna WGS 84 (geo) : N 44 deg 19' 20.75" W 76 deg 20' 17.31" antenna WGS 84 (geo) : 44.322430 deg 283.661857 deg (= -76.338143 deg)
147

WGS 84 height: 94.8606 m |qc - header| position : 581.0546 m Observation interval : 1.0000 seconds Total satellites w/ obs : 12 NAVSTAR GPS SVs w/o OBS : 1 2 3 4 5 6 7 8 10 11 13 16 17 20 23 24 26 28 29 30 31 32 NAVSTAR GPS SVs w/o NAV : SBAS SVs w/o OBS : 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 SBAS SVs w/o NAV : 33 38 Rx tracking capability : 12 SVs Poss. # of obs epochs : 1760 Epochs w/ observations : 1758 Epochs repeated : 0 (0.00%) Possible obs > 0.0 deg: 17564 Possible obs > 10.0 deg: 14080 Complete obs > 10.0 deg: 13314 Deleted obs > 10.0 deg: 7 Masked obs < 10.0 deg: 740 Obs w/ SV duplication : 0 (within non-repeated epochs) Moving average MP12 : 0.418634 m Moving average MP21 : 0.443385 m Points in MP moving avg : 50 Mean S1 : 47.80 (sd=2.53 n=16776) Mean S2 : 41.56 (sd=4.23 n=13314) No. of Rx clock offsets : 0 Total Rx clock drift : 0.000000 ms Rate of Rx clock drift : 0.000 ms/hr Avg time between resets : Inf minute(s) Freq no. and timecode : 2 11429 010000 Report gap > than : 10.00 minute(s) epochs w/ msec clk slip : 0 other msec mp events : 0 (: 118) {expect ~= 1:50} IOD signifying a slip : >400.0 cm/minute IOD slips < 10.0 deg* : 66 IOD slips > 10.0 deg : 92 IOD or MP slips < 10.0*: 66 IOD or MP slips > 10.0 : 92 * or unknown elevation first epoch last epoch hrs dt #expt #have % mp1 mp2 o/slps SUM 11 4 22 16:25 11 4 22 16:54 .4883 1 14080 13314 95 0.42 0.44

145

148

Processing parameters are: Receiver tracking capability : 12 SVs Maximum ionospheric rate (L1) : 400.00 cm/min Report data gap greater than : 10.00 min Expected rms of MP12 multipath : 65.00 cm Expected rms of MP21 multipath : 65.00 cm Multipath slip sigma threshold : 4.00 sigma % increase in MP rms for C/A | A/S : 100.00 % Points in MP moving averages : 50 Minimum signal to noise for L1 : 4 Minimum signal to noise for L2 : 4 Elevation mask (cutoff) : 10.00 degrees Elevation comparison threshold : 25.00 degrees Orbit path spline fit sample time : 10 min SVs w/ code data for position try : 5 Width of ASCII summary plot : 72 Data indicators on summary plot : yes Do ionospheric observable : yes Do ionospheric derivative : yes Do multipath observables : yes Do 1-ms receiver clock slips : yes Tolerance for 1-ms clock slips : 1.00e-002 ms Do receiver LLI slips : yes Do plot file(s) : no Observations start : 2011 Apr 22 16:25:10.000 Observations end : 2011 Apr 22 16:54:29.000 Observation interval : 1.0000 second(s) SV #+hor <ele> #+mask <ele> #reprt #compl L1 L2 P1 P2 C1 C2 --- ------ ----- ------ ----- ------ ------ ------ ------ ------ ------ ------ -----G14 1760 47.91 1760 47.91 1755 1755 1755 1755 1755 1755 0 0 G27 1760 35.07 1760 35.07 1744 1744 1744 1744 1744 1744 0 0 G21 1760 18.92 1760 18.92 1496 1493 1496 1493 1496 1493 0 0 G09 1760 51.90 1760 51.90 1756 1756 1756 1756 1756 1756 0 0 G19 1760 5.22 0 90.00 0 0 0 0 0 0 0 0 G22 1760 70.43 1760 70.43 1756 1756 1756 1756 1756 1756 0 0 G12 1760 17.53 1760 17.53 1395 1391 1395 1391 1395 1391 0 0 G15 1760 17.22 1760 17.22 1663 1663 1663 1663 1663 1663 0 0 G18 1760 73.39 1760 73.39 1756 1756 1756 1756 1756 1756 0 0 G25 1724 4.94 0 90.00 0 0 0 0 0 0 0 0 S33* 0 0.00 0 0.00 1739 0 1739 0 0 0 0 0 S38* 0 0.00 0 0.00 1716 0 1716 0 0 0 0 0 * = SV with no NAV info (or not being used)
149

Obs below mask ( 10.00 deg) : 4267 Obs reported w/ code | phase : 17588 Obs deleted (any reason) : 4274 Obs complete : 13314 | G | S | % Obs above mask w/ no L1 : 0.0 0.0 % Obs above mask w/ no L2 : 0.1 % Obs above mask w/ no P1 % Obs above mask w/ no P2 : 0.0 : 0.1 -

% Obs above mask w/ low L1 S/N: 0.0 0.1 % Obs above mask w/ low L2 S/N: 13.0 No. of Rx clock offsets : 0 Total Rx clock drift : 0.000000 ms Rate of Rx clock drift : 0.000000 ms/hr elev (deg) tot slps <ION rms, m> 5=% 1|m 15=% 85 - 90 0 0 0.000000 80 - 85 0 0 0.000000 75 - 80 939 0 0.000000 70 - 75 1320 2 0.000000 65 - 70 1099 0 0.000000 60 - 65 152 0 0.000000 55 - 60 348 0 0.000000 50 - 55 1364 2 0.000000 45 - 50 1409 1 0.000000 40 - 45 421 0 0.000000 35 - 40 854 1 0.000000 30 - 35 789 1 0.000000 25 - 30 129 0 0.000000 20 - 25 1220 31 0.000000 ===== 15 - 20 2333 24 0.000000 == 10 - 15 929 30 0.000000 ====== 5 - 10 790 65 0.000000 ================ 0- 5 10 1 0.000000 ==================== < 0 0 0 0.000000 2|m

MP12 RMS summary (per SV): slips L1 rx L2 rx slips L1 rx L2 rx SV obs>10 # del <elev> MP12 rms [m] < 25 < 25 < 25 > 25 > 25 > 25
150

G14 G27 G21 G09 G19 G22 G12 G15 G18 G25

1755 0 47.89 0.098894 0 0 0 1 2 2 1744 0 35.04 0.119038 0 0 0 1 4 4 1496 3 18.61 1.316790 6 46 46 0 0 0 1756 0 51.87 0.055945 0 0 0 1 1 1 0 0 0.00 0.000000 0 0 0 0 0 0 1756 0 70.42 0.055830 0 0 0 1 1 1 1395 4 18.12 1.376350 10 47 47 0 0 0 1663 0 17.34 0.619383 4 15 15 0 0 0 1756 0 73.38 0.049026 0 0 0 1 1 1 0 0 0.00 0.000000 0 0 0 0 0 0

mean MP12 rms : 0.418659 m total mean elevation : 42.85 degrees # MP12 obs > 10 : 13314 # qc MP12 slips < 25 : 20 # Rvr L1 slips < 25 : 108 # Rvr L2 slips < 25 : 108 # qc MP12 slips > 25 : 5 # Rvr L1 slips > 25 : 9 # Rvr L2 slips > 25 : 9 elev (deg) tot slps <MP12 rms, m> 5=% 1|m 15=% 85 - 90 0 0 0.000000 80 - 85 0 0 0.000000 75 - 80 939 0 0.045515 | 70 - 75 1320 2 0.060272 | 65 - 70 1099 0 0.048531 | 60 - 65 152 0 0.037130 | 55 - 60 348 0 0.034057 | 50 - 55 1364 1 0.099626 || 45 - 50 1409 1 0.075503 || 40 - 45 421 0 0.040224 | 35 - 40 854 1 0.063831 | 30 - 35 789 0 0.160885 ||| 25 - 30 129 0 0.043057 | 20 - 25 1220 4 1.273722 ||||||||||||||||||||||||| 15 - 20 2333 10 0.755336 ||||||||||||||| 10 - 15 929 6 1.638666 #|||||||||||||||||||||||||||||||| 5 - 10 790 29 2.650962 #######|||||||||||||||||||||||||||||||||||||||> 0- 5 10 1 0.070504 #=================== < 0 0 0 0.000000 MP21 RMS summary (per SV): slips L1 rx L2 rx slips L1 rx L2 rx
151

2|m

SV G14 G27 G21 G09 G19 G22 G12 G15 G18 G25

obs>10 1755 1744 1496 1756 0 1756 1395 1663 1756 0

# del <elev> MP21 rms [m] < 25 < 25 < 25 > 25 > 25 > 25 0 47.89 0.105457 0 0 0 1 2 2 0 35.04 0.093093 0 0 0 1 4 4 3 18.61 1.150643 14 46 45 0 0 0 0 51.87 0.040095 0 0 0 1 1 1 0 0.00 0.000000 0 0 0 0 0 0 0 70.42 0.034036 0 0 0 1 1 1 4 18.12 1.901072 13 47 46 0 0 0 0 17.34 0.609290 5 15 15 0 0 0 0 73.38 0.028751 0 0 0 1 1 1 0 0.00 0.000000 0 0 0 0 0 0

mean MP21 rms : 0.443416 m total mean elevation : 42.85 degrees # MP21 obs > 10 : 13314 # qc MP21 slips < 25 : 32 # Rvr L1 slips < 25 : 108 # Rvr L2 slips < 25 : 106 # qc MP21 slips > 25 : 5 # Rvr L1 slips > 25 : 9 # Rvr L2 slips > 25 : 9 elev (deg) tot slps <MP21 rms, m> 5=% 1|m 15=% 85 - 90 0 0 0.000000 80 - 85 0 0 0.000000 75 - 80 939 0 0.029223 | 70 - 75 1320 2 0.031829 | 65 - 70 1099 0 0.028958 | 60 - 65 152 0 0.052204 | 55 - 60 348 0 0.041002 | 50 - 55 1364 1 0.111141 || 45 - 50 1409 1 0.052742 | 40 - 45 421 0 0.043113 | 35 - 40 854 1 0.036216 | 30 - 35 789 0 0.128793 ||| 25 - 30 129 0 0.059211 | 20 - 25 1220 10 1.161950 #|||||||||||||||||||||| 15 - 20 2333 13 0.726238 #|||||||||||||| 10 - 15 929 9 2.276403 #||||||||||||||||||||||||||||||||||||||||||||| 5 - 10 790 25 3.689333 ######||||||||||||||||||||||||||||||||||||||||> 0 - 5 10 1 0.490100 ##########========== < 0 0 0 0.000000 S/N L1 summary (per elevation bin):
152

2|m

elev (deg) tot SN1 sig mean 2|0 4|0 85 - 90 0 0.000 0.000 80 - 85 0 0.000 0.000 75 - 80 940 1.763 50.077 #|||||||||||||||||||||||| 70 - 75 1320 1.445 50.657 #|||||||||||||||||||||||| 65 - 70 1099 1.566 50.871 #|||||||||||||||||||||||| 60 - 65 153 4.124 50.630 ##||||||||||||||||||||||| 55 - 60 349 2.738 50.842 #|||||||||||||||||||||||| 50 - 55 1364 1.514 50.295 #|||||||||||||||||||||||| 45 - 50 1409 1.470 49.865 #|||||||||||||||||||||||| 40 - 45 423 2.470 48.834 #||||||||||||||||||||||| 35 - 40 854 1.776 47.746 #||||||||||||||||||||||| 30 - 35 789 1.738 47.119 #||||||||||||||||||||||| 25 - 30 130 4.187 45.806 ##||||||||||||||||||||| 20 - 25 1224 2.044 45.499 #|||||||||||||||||||||| 15 - 20 2333 1.541 45.507 #|||||||||||||||||||||| 10 - 15 934 2.349 43.866 #||||||||||||||||||||| 5 - 10 797 2.825 42.662 #|||||||||||||||||||| 0 - 5 15 10.980 38.983 #####|||||||||||||| < 0 0 0.000 0.000 S/N L2 summary (per elevation bin): elev (deg) tot SN2 sig mean 2|0 4|0 85 - 90 0 0.000 0.000 80 - 85 0 0.000 0.000 75 - 80 940 1.808 46.208 #|||||||||||||||||||||| 70 - 75 1320 1.418 46.495 #|||||||||||||||||||||| 65 - 70 1099 1.537 46.014 #|||||||||||||||||||||| 60 - 65 153 3.740 45.489 ##||||||||||||||||||||| 55 - 60 349 2.538 45.302 #|||||||||||||||||||||| 50 - 55 1364 1.620 44.252 #||||||||||||||||||||| 45 - 50 1409 1.653 43.064 #||||||||||||||||||||| 40 - 45 423 2.133 41.305 #|||||||||||||||||||| 35 - 40 854 1.602 40.573 #||||||||||||||||||| 30 - 35 789 1.612 38.773 #|||||||||||||||||| 25 - 30 130 3.538 36.873 ##|||||||||||||||| 20 - 25 1221 3.017 37.134 ##||||||||||||||||| 15 - 20 2333 2.450 37.649 #|||||||||||||||||| 10 - 15 930 3.155 35.330 ##|||||||||||||||| 5 - 10 791 3.621 33.671 ##||||||||||||||| 0 - 5 11 10.191 29.257 #####|||||||||| < 0 0 0.000 0.000

6|0

8|0

6|0

8|0

153

C.2 Quality check Report of GPS Observations for Trajectory 2
version: teqc 2015Nov6 SV+---------|------------|------------|------------|-------------|---------+ SV 25|oooooo-ooooooIIL | 25 10|oooooo-ooooooooIooooIooooooooooooooIoIIIIIIIIoIoaI L | 10 7|oooooo-ooooooooIIIoIIIoooooooooooooIoIIoIIIIIIIIII LIIIIIIIoooIIIIIILII| 7 5|oooooo-oooooooooooooooooooooooooooooooooooooooooooomooooooooooooooooooo-| 5 21|oooooo-ooooooooooIooIoooooooooooooooooooIIIoIIIIIIIIIIIIIIIILIIoIIIIooo-| 21 29|oooooo-oooooooooooooooooooooooooooooooooooooooooooomooooooooooooooooooo-| 29 2|oooooo-ooooooooooooooooooooooooooooooooomoooLIoooIIIIIIoILoooIIIIoIoIIo-| 2 15|oooooo-oooooooooooooooooooooooooooooooooooIoIIoooIoooooooIooooooooooIoo-| 15 26|oooooo-oooooooooooooooooooooooooooooooooooooooooooomooooIoooooooooooooo-| 26 S35|aaaaaaaaaaaaaaaLaaaLaaaaaaaaaaaaaaaaaaaaLLLLaaaaLLLLLLaLaaaLLaaLLLLLLLL|S35 S33|aaaaaa-aaaaaaaaaaaaaLaaaaaaaaaaaaaaaaaaaaaLaLLaaaaaLaaLaLLaaaaaaaaaaLaaL|S33 8| Loooo-ooooooooIIIoIIIoooooooooooooIoIIoIIIIIooooII LIIooooooIoIIoIIoIL-| 8 18| LILII IL IIoIIooIIIoIIIIIIII| 18 Obs|bcccccccccccccccbbbbbbbbbbbbbbbbbbbbbbbbbbbabccccb999abbbbbbbbbbbabbbbbb|Obs Clk| ^ ^|Clk +---------|------------|------------|------------|-------------|---------+ 18:32:31.000 19:27:38.000 2012 Dec 12 2012 Dec 12 ********************* QC of RINEX file(s) : CPT_DEC12_1_31pm.12o ********************* 4-character ID Receiver type Antenna type : : NovAtel GPSCard :

Time of start of window : 2012 Dec 12 18:32:31.000 Time of end of window : 2012 Dec 12 19:27:38.000 Time line window length : 55.12 minute(s), ticked every 10.0 minute(s) Observation interval : 1.0000 seconds Total satellites w/ obs : 13 NAVSTAR GPS SVs w/o OBS : 1 3 4 6 9 11 12 13 14 16 17 19 20 22 23 24 27 28 30 31 32 SBAS SVs w/o OBS : 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 Rx tracking capability : 12 SVs Poss. # of obs epochs : 3308
154

Epochs w/ observations : 3306 Epochs repeated : 0 (0.00%) Complete observations : 33901 Deleted observations : 43 Obs w/ SV duplication : 0 (within non-repeated epochs) Moving average MP12 : 0.466840 m Moving average MP21 : 0.651641 m Points in MP moving avg : 50 Mean S1 : 47.03 (sd=3.46 n=33944) Mean S2 : 40.39 (sd=5.55 n=27800) No. of Rx clock offsets : 0 Total Rx clock drift : 0.000000 ms Rate of Rx clock drift : 0.000 ms/hr Avg time between resets : Inf minute(s) Freq no. and timecode : 2 12029 0c0000 Report gap > than : 10.00 minute(s) but < than : 90.00 minute(s) epochs w/ msec clk slip : 0 other msec mp events : 4 (: 223) {expect ~= 1:50} IOD signifying a slip : >400.0 cm/minute IOD slips : 260 IOD or MP slips : 260 first epoch last epoch hrs dt #expt #have % mp1 mp2 o/slps SUM 12 12 12 18:32 12 12 12 19:27 .9183 1 - 33901 - 0.47 0.65 130 Processing parameters are: Receiver tracking capability : 12 SVs Maximum ionospheric rate (L1) : 400.00 cm/min Report data gap greater than : 10.00 min Expected rms of MP12 multipath : 65.00 cm Expected rms of MP21 multipath : 65.00 cm Multipath slip sigma threshold : 4.00 sigma % increase in MP rms for C/A | A/S : 100.00 % Points in MP moving averages : 50 Minimum signal to noise for L1 : 4 Minimum signal to noise for L2 : 4 Width of ASCII summary plot : 72 Data indicators on summary plot : yes Do ionospheric observable : yes Do ionospheric derivative : yes Do multipath observables : yes Do 1-ms receiver clock slips : yes Tolerance for 1-ms clock slips : 1.00e-002 ms Do receiver LLI slips : yes Do plot file(s) : no
155

but less than

: 90.00 min

Observations start : 2012 Dec 12 18:32:31.000 Observations end : 2012 Dec 12 19:27:38.000 Observation interval : 1.0000 second(s) SV #+hor <ele> #+mask <ele> #reprt #compl L1 L2 P1 P2 C1 C2 --- ------ ----- ------ ----- ------ ------ ------ ------ ------ ------ ------ -----G02* 0 0.00 0 0.00 3119 3119 3119 3119 0 3119 3119 0 G10* 0 0.00 0 0.00 2109 2101 2109 2101 0 2101 2109 0 G15* 0 0.00 0 0.00 3261 3261 3261 3261 0 3261 3261 0 G05* 0 0.00 0 0.00 3301 3301 3301 3301 0 3301 3301 0 G21* 0 0.00 0 0.00 2978 2974 2978 2974 0 2974 2978 0 G29* 0 0.00 0 0.00 3300 3300 3300 3300 0 3300 3300 0 G25* 0 0.00 0 0.00 687 687 687 687 0 687 687 0 G07* 0 0.00 0 0.00 2401 2386 2401 2386 0 2386 2401 0 G26* 0 0.00 0 0.00 3300 3300 3300 3300 0 3300 3300 0 S35* 0 0.00 0 0.00 2871 2871 2871 0 0 0 2871 0 S33* 0 0.00 0 0.00 3230 3230 3230 0 0 0 3230 0 G08* 0 0.00 0 0.00 2736 2729 2736 2729 0 2729 2736 0 G18* 0 0.00 0 0.00 651 642 651 642 0 642 651 0 * = SV with no NAV info (or not being used) Obs reported w/ code | phase : 33944 Obs deleted (any reason) : 43 Obs complete : 33901 | G | S | w/ no L1 : 0.0 0.0 w/ no L2 : 0.2 w/ no P2 : 0.2 w/ no C1 : 0.0 0.0 w/ low L1 S/N: 0.3 0.1 w/ low L2 S/N: 31.0 -

% Obs % Obs % Obs % Obs % Obs % Obs

No. of Rx clock offsets : 0 Total Rx clock drift : 0.000000 ms Rate of Rx clock drift : 0.000000 ms/hr MP12 RMS summary (per SV): Slips L1 rx L2 rx SV obs # del <elev> MP12 rms [m] all all all G02* 3119 0 0.00 0.532853 3 31 31 G10* 2109 8 0.00 0.473746 13 31 31 G15* 3261 0 0.00 0.234317 1 11 11 G05* 3301 0 0.00 0.036847 1 1 1
156

G21* 2978 4 0.00 1.024433 7 55 55 G29* 3300 0 0.00 0.033013 1 1 1 G25* 687 0 0.00 0.322434 0 3 3 G07* 2401 15 0.00 1.283089 35 89 89 G26* 3300 0 0.00 0.063456 1 2 2 G08* 2736 7 0.00 0.632240 24 43 43 G18* 651 9 0.00 1.653790 21 45 45 * = SV with no NAV info (or not being used) mean MP12 rms # MP12 obs # MP12 slips # Rvr L1 slips # Rvr L2 slips : 0.466840 m 27800 107 312 312

: : : :

MP21 RMS summary (per SV): Slips L1 rx L2 rx SV obs # del <elev> MP21 rms [m] all all all G02* 3119 0 0.00 0.360978 5 31 31 G10* 2109 8 0.00 0.688594 14 31 30 G15* 3261 0 0.00 0.326418 1 11 11 G05* 3301 0 0.00 0.062317 1 1 1 G21* 2978 4 0.00 1.320900 8 55 54 G29* 3300 0 0.00 0.045425 1 1 1 G25* 687 0 0.00 0.534082 0 3 3 G07* 2401 15 0.00 2.670451 33 89 82 G26* 3300 0 0.00 0.083037 1 2 2 G08* 2736 7 0.00 0.837369 25 43 45 G18* 651 9 0.00 1.396857 27 45 43 * = SV with no NAV info (or not being used) mean MP21 rms # MP21 obs # MP21 slips # Rvr L1 slips # Rvr L2 slips : 0.651641 m 27800 116 312 303

: : : :

157

C.3 Quality check Report of GPS Observations for Trajectory 3
version: teqc 2015Nov6 SV+-----------------|--------------------|--------------------|------------+ SV 7|IIIIIIIIILLLLL___L____________ | 7 29|LLLLLIIIIIIII----IIIIIIIIIIII------III-III-I---I-___L___LLL___________ | 29 3|LIIIIIIIIIIII---IIIIIIII-I--------MI---2-I---------_L_L___LLLLLLLLLLLLL_| 3 21|LLLLLII-IIIII---IILLLLLLLLMLIIIIIIIIILLI-IL-IILL-LLIILL-IIII-IILIIIILLLL| 21 26|LLLLL-IIIIIII---IIIII-IIIIIIIIIIIMIIIIIIIIIIII-III-II-IIIIIIIIIIIILLLLLL| 26 18|LLLLLI-IIIIII---IIILLLLLLLLLLIIIILIILLLILILIIIL-ILLLLLLLIIII-IILIIIILLLL| 18 22|LLLLIIIIIIIII---IIIIIIIIIILIIIIIIIIIIIIIIII-IIIIIIIIIIIIIIIIIIIIIIIILLLL| 22 9|LLLI-II-IIIII--MIIIIILLLLLIIIIIIIIIIILLLLILMIIIIIIIII-ILIIIIIIILIIILLLLL| 9 24|LLLLIIIIIIII-I-IIIIIILLLLLIII-III-IIILLLLI-I-IIIIII-IILLIIIIIIIIILLL_LLL| 24 6|____LLLL_LL__________ | 6 14| ___________________-----I--I-I--II----------MIIIIIIIIIIIIIILLLL| 14 19| _________________________L_L______________-------IIIIIIIII-IIII| 19 12| ___________L| 12 -dn|+ ++ + 7761 1 1 11114452211221213253332233121121 + 1 + + ++ |-dn +dn| 2134cccc7cccccccc566444346658ccc7cc65575c6ccc7785667455cc5cccc4ccc51111|+dn +10|899999999888888888888888888899999999999999999999988888888888888887666666|+ 10 Pos|oooooooo oo |Pos Clk| ^^^^ ^^^^^^^^ ^^^ ^^ ^ ^^^ ^^ ^^^^ ^^^ |Clk +-----------------|--------------------|--------------------|------------+ 14:35:27.000 16:17:22.000 2007 Jun 15 2007 Jun 15 ********************* QC of RINEX file(s) : CDU_RAWIMUSB.07O input RnxNAV file(s) : CDU_RAWIMUSB.07N ********************* 4-character ID Receiver type Antenna type : : NovAtel GPSCard :

Time of start of window : 2007 Jun 15 14:35:27.000 Time of end of window : 2007 Jun 15 16:17:22.000 Time line window length : 101.92 minute(s), ticked every 30.0 minute(s) antenna WGS 84 (xyz) : 853098.5036 -4541209.4436 4382019.2201 (m) antenna WGS 84 (geo) : N 43 deg 40' 25.86" W 79 deg 21' 38.09" antenna WGS 84 (geo) : 43.673850 deg 280.639420 deg (= -79.360580 deg) WGS 84 height : 96.5472 m
158

|qc - header| position : 6744.3210 m Observation interval : 1.0000 seconds Total satellites w/ obs : 13 NAVSTAR GPS SVs w/o OBS : 1 2 4 5 8 10 11 13 15 16 17 20 23 25 27 28 30 31 32 NAVSTAR GPS SVs w/o NAV : Rx tracking capability : 12 SVs Poss. # of obs epochs : 6116 Epochs w/ observations : 5667 Epochs repeated : 0 (0.00%) Possible obs > 0.0 deg: 64617 Possible obs > 10.0 deg: 50035 Complete obs > 10.0 deg: 28953 Deleted obs > 10.0 deg: 859 Masked obs < 10.0 deg: 16513 Obs w/ SV duplication : 0 (within non-repeated epochs) Moving average MP12 : 1.202179 m Moving average MP21 : 1.234892 m Points in MP moving avg : 50 Mean S1 : 45.74 (sd=4.07 n=29812) Mean S2 : 39.07 (sd=4.71 n=28953) No. of Rx clock offsets : 0 Total Rx clock drift : 0.000000 ms Rate of Rx clock drift : 0.000 ms/hr Avg time between resets : Inf minute(s) Freq no. and timecode : 2 10022 01c000 Report gap > than : 10.00 minute(s) epochs w/ msec clk slip : 0 other msec mp events : 0 (: 1677) {expect ~= 1:50} IOD signifying a slip : >400.0 cm/minute IOD slips < 10.0 deg* : 125 IOD slips > 10.0 deg : 1054 IOD or MP slips < 10.0*: 131 IOD or MP slips > 10.0 : 1081 * or unknown elevation first epoch last epoch hrs dt #expt #have % mp1 mp2 o/slps SUM 07 6 15 14:35 07 6 15 16:17 1.574 1 50035 28953 58 1.20 1.23

27

Processing parameters are: Receiver tracking capability : 12 SVs Maximum ionospheric rate (L1) : 400.00 cm/min Report data gap greater than : 10.00 min
159

Expected rms of MP12 multipath : 65.00 cm Expected rms of MP21 multipath : 65.00 cm Multipath slip sigma threshold : 4.00 sigma % increase in MP rms for C/A | A/S : 100.00 % Points in MP moving averages : 50 Minimum signal to noise for L1 : 4 Minimum signal to noise for L2 : 4 Elevation mask (cutoff) : 10.00 degrees Elevation comparison threshold : 25.00 degrees Orbit path spline fit sample time : 10 min SVs w/ code data for position try : 5 Width of ASCII summary plot : 72 Data indicators on summary plot : yes Do ionospheric observable : yes Do ionospheric derivative : yes Do multipath observables : yes Do 1-ms receiver clock slips : yes Tolerance for 1-ms clock slips : 1.00e-002 ms Do receiver LLI slips : yes Do plot file(s) : yes Observations start : 2007 Jun 15 14:35:27.000 Observations end : 2007 Jun 15 16:17:22.000 Observation interval : 1.0000 second(s) SV #+hor <ele> #+mask <ele> #reprt #compl L1 L2 P1 P2 C1 --- ------ ----- ------ ----- ------ ------ ------ ------ ------ ------ ------ -----G09 6116 48.51 6116 48.51 4668 4573 4668 4573 0 4573 4668 G29 5877 17.39 4100 22.79 1540 1480 1540 1480 0 1480 1540 G24 6116 28.09 5513 30.29 3425 3352 3425 3352 0 3352 3425 G21 6116 59.61 6116 59.61 5034 4962 5034 4962 0 4962 5034 G26 6116 26.73 5597 28.42 2590 2465 2590 2465 0 2465 2590 G18 6116 69.95 6116 69.95 5337 5308 5337 5308 0 5308 5337 G22 6116 38.45 6116 38.45 3978 3860 3978 3860 0 3860 3978 G07 2532 7.05 742 12.19 442 247 442 247 0 247 442 0 G03 6116 10.40 4236 11.53 692 644 692 644 0 644 692 0 G06 1747 4.90 0 90.00 0 0 0 0 0 0 0 0 G14 5314 16.29 3682 21.30 1358 1335 1358 1335 0 1335 1358 G19 5321 7.37 1701 10.36 748 727 748 727 0 727 748 0 G12 1014 2.53 0 90.00 0 0 0 0 0 0 0 0 Obs below mask ( 10.00 deg) : 1524 Obs reported w/ code | phase : 31336 Obs deleted (any reason) : 2383
160

C2 0 0 0 0 0 0 0

0

Obs complete

: 28953

| G | % Obs above mask w/ no L1 % Obs above mask w/ no L2 % Obs above mask w/ no P2 % Obs above mask w/ no C1

: 0.0 : 2.9 : 2.9 : 0.0

% Obs above mask w/ low L1 S/N: 4.9 % Obs above mask w/ low L2 S/N: 22.5 No. of Rx clock offsets : 0 Total Rx clock drift : 0.000000 ms Rate of Rx clock drift : 0.000000 ms/hr elev (deg) tot slps <ION rms, m> 5=% 1|m 15=% 2|m 85 - 90 0 0 0.000000 80 - 85 0 0 0.000000 75 - 80 3127 52 0.000000 === 70 - 75 1322 11 0.000000 = 65 - 70 1439 12 0.000000 = 60 - 65 919 33 0.000000 ======= 55 - 60 3491 67 0.000000 === 50 - 55 2328 41 0.000000 === 45 - 50 2431 82 0.000000 ====== 40 - 45 2171 100 0.000000 ========= 35 - 40 2240 66 0.000000 ===== 30 - 35 2925 81 0.000000 ===== 25 - 30 1779 103 0.000000 =========== 20 - 25 1594 102 0.000000 ============ 15 - 20 728 38 0.000000 ========== 10 - 15 2450 266 0.000000 ===================== 5 - 10 1435 124 0.000000 ================= 0- 5 7 1 0.000000 ============================ < 0 0 0 0.000000 MP12 RMS summary (per SV): slips L1 rx L2 rx slips SV obs>10 # del <elev> MP12 rms [m] < 25 G09 4668 95 48.79 0.801163 0 0 G29 1540 60 28.56 3.920772 31 540 G24 3425 73 31.94 1.006811 28 1091 G21 5034 72 59.14 0.858058 0 0

L1 rx L2 rx < 25 < 25 > 25 > 25 > 25 0 77 4668 4668 540 8 1000 1000 1091 43 2334 2334 0 63 5034 5034

161

G26 G18 G22 G07 G03 G06 G14 G19 G12

2590 125 33.19 1.546442 46 698 5337 29 70.48 0.766362 0 0 3978 118 39.43 1.497777 14 748 442 195 12.41 1.640084 39 442 692 48 11.24 1.692441 59 692 0 0 0.00 0.000000 0 0 0 1358 23 27.19 1.093109 21 242 748 21 10.42 1.505426 33 748 0 0 0.00 0.000000 0 0 0

698 61 1892 1892 0 39 5337 5337 748 112 3230 3230 442 0 0 0 692 0 0 0 0 0 0 242 5 1116 1116 748 0 0 0 0 0 0

mean MP12 rms : 1.202259 m total mean elevation : 45.87 degrees # MP12 obs > 10 : 28953 # qc MP12 slips < 25 : 271 # Rvr L1 slips < 25 : 5201 # Rvr L2 slips < 25 : 5201 # qc MP12 slips > 25 : 408 # Rvr L1 slips > 25 : 24611 # Rvr L2 slips > 25 : 24611 elev (deg) tot slps <MP12 rms, m> 5=% 1|m 15=% 2|m 85 - 90 0 0 0.000000 80 - 85 0 0 0.000000 75 - 80 3127 22 0.760252 #|||||||||||||| 70 - 75 1322 7 0.568049 #|||||||||| 65 - 70 1439 13 0.404129 #||||||| 60 - 65 919 26 0.825984 #####|||||||||||| 55 - 60 3491 32 0.751374 #|||||||||||||| 50 - 55 2328 31 0.682548 ##|||||||||||| 45 - 50 2431 63 0.862933 #####|||||||||||| 40 - 45 2171 52 1.841568 ####||||||||||||||||||||||||||||||||| 35 - 40 2240 42 1.158089 ###|||||||||||||||||||| 30 - 35 2925 65 0.641181 ####||||||||| 25 - 30 1779 55 1.556587 ######||||||||||||||||||||||||| 20 - 25 1594 76 1.601689 #########||||||||||||||||||||||| 15 - 20 728 28 2.926426 #######|||||||||||||||||||||||||||||||||||||||> 10 - 15 2450 167 3.000081 #############|||||||||||||||||||||||||||||||||> 5 - 10 1435 78 3.950465 ##########||||||||||||||||||||||||||||||||||||> 0- 5 7 0 0.522894 |||||||||| < 0 0 0 0.000000 MP21 RMS summary (per SV): slips L1 rx L2 rx slips L1 rx L2 rx SV obs>10 # del <elev> MP21 rms [m] < 25 < 25 < 25 > 25 > 25 > 25
162

G09 G29 G24 G21 G26 G18 G22 G07 G03 G06 G14 G19 G12

4668 95 48.79 1.070876 0 0 1540 60 28.56 1.868957 53 540 3425 73 31.94 1.504211 36 1091 5034 72 59.14 0.858834 0 0 2590 125 33.19 1.584078 55 698 5337 29 70.48 0.769767 0 0 3978 118 39.43 1.309869 15 748 442 195 12.41 3.441053 37 442 692 48 11.24 2.814746 64 692 0 0 0.00 0.000000 0 0 0 1358 23 27.19 1.319152 25 242 748 21 10.42 1.814524 40 748 0 0 0.00 0.000000 0 0 0

0 98 4668 4573 489 9 1000 991 1075 49 2334 2277 0 74 5034 4962 623 65 1892 1842 0 55 5337 5308 748 140 3230 3112 247 0 0 0 644 0 0 0 0 0 0 222 8 1116 1113 727 0 0 0 0 0 0

mean MP21 rms : 1.234983 m total mean elevation : 45.87 degrees # MP21 obs > 10 : 28953 # qc MP21 slips < 25 : 325 # Rvr L1 slips < 25 : 5201 # Rvr L2 slips < 25 : 4775 # qc MP21 slips > 25 : 498 # Rvr L1 slips > 25 : 24611 # Rvr L2 slips > 25 : 24178 elev (deg) tot slps <MP21 rms, m> 5=% 1|m 15=% 2|m 85 - 90 0 0 0.000000 80 - 85 0 0 0.000000 75 - 80 3127 34 0.931987 ##||||||||||||||||| 70 - 75 1322 8 0.322927 #||||| 65 - 70 1439 13 0.263311 #|||| 60 - 65 919 29 0.928895 ######||||||||||||| 55 - 60 3491 46 0.740895 ##||||||||||||| 50 - 55 2328 38 0.873441 ###|||||||||||||| 45 - 50 2431 73 0.941436 ######||||||||||||| 40 - 45 2171 67 1.785984 ######|||||||||||||||||||||||||||||| 35 - 40 2240 52 0.977209 ####|||||||||||||||| 30 - 35 2925 79 0.693091 #####||||||||| 25 - 30 1779 59 2.084945 ######|||||||||||||||||||||||||||||||||||| 20 - 25 1594 92 1.441668 ###########|||||||||||||||||| 15 - 20 728 36 1.053253 #########|||||||||||| 10 - 15 2450 197 2.756957 ################||||||||||||||||||||||||||||||> 5 - 10 1435 97 3.583705 #############|||||||||||||||||||||||||||||||||> 0- 5 7 0 1.797734 |||||||||||||||||||||||||||||||||||| < 0 0 0 0.000000
163

S/N L1 summary (per elevation bin): elev (deg) tot SN1 sig mean 2|0 4|0 85 - 90 0 0.000 0.000 80 - 85 0 0.000 0.000 75 - 80 3146 2.441 47.776 #||||||||||||||||||||||| 70 - 75 1327 1.681 48.405 #||||||||||||||||||||||| 65 - 70 1442 2.373 48.431 #||||||||||||||||||||||| 60 - 65 943 3.428 47.907 ##|||||||||||||||||||||| 55 - 60 3543 2.651 48.549 #||||||||||||||||||||||| 50 - 55 2344 2.206 48.231 #||||||||||||||||||||||| 45 - 50 2505 3.314 46.887 ##||||||||||||||||||||| 40 - 45 2236 3.173 46.664 ##||||||||||||||||||||| 35 - 40 2298 2.637 45.866 #|||||||||||||||||||||| 30 - 35 2992 2.532 44.818 #||||||||||||||||||||| 25 - 30 1835 2.637 43.601 #||||||||||||||||||||| 20 - 25 1660 3.406 41.973 ##||||||||||||||||||| 15 - 20 796 3.256 40.773 ##|||||||||||||||||| 10 - 15 2745 3.188 38.274 ##||||||||||||||||| 5 - 10 1516 2.590 37.360 #|||||||||||||||||| 0- 5 8 12.944 31.875 ######|||||||||| < 0 0 0.000 0.000 S/N L2 summary (per elevation bin): elev (deg) tot SN2 sig mean 2|0 4|0 85 - 90 0 0.000 0.000 80 - 85 0 0.000 0.000 75 - 80 3128 2.687 43.411 #||||||||||||||||||||| 70 - 75 1322 2.236 43.120 #||||||||||||||||||||| 65 - 70 1439 2.352 42.470 #|||||||||||||||||||| 60 - 65 919 4.237 41.589 ##||||||||||||||||||| 55 - 60 3491 2.740 42.125 #|||||||||||||||||||| 50 - 55 2330 2.627 40.896 #||||||||||||||||||| 45 - 50 2432 3.894 39.869 ##|||||||||||||||||| 40 - 45 2171 3.537 38.914 ##||||||||||||||||| 35 - 40 2241 2.910 37.938 #|||||||||||||||||| 30 - 35 2926 2.707 37.300 #|||||||||||||||||| 25 - 30 1779 2.942 35.861 #||||||||||||||||| 20 - 25 1595 3.912 34.370 ##||||||||||||||| 15 - 20 728 3.784 32.780 ##|||||||||||||| 10 - 15 2452 4.286 31.816 ##|||||||||||||| 5 - 10 1438 4.570 29.429 ##||||||||||||| 0- 5 8 10.501 22.375 #####|||||| < 0 0 0.000 0.000
164

6|0

8|0

6|0

8|0

Bibliography
Abdel-salam, M. (2005). Precise Point Positioning Using Un-differenced Code and Carrier Phase Observations. PhD Thesis. Department of Geomatics Engineering, University of Calgary, Canada. Aggarwal, P., Gu, D., Nassar, S., Syed, Z., and El-Sheimy, N. (2007). Extended Particle Filter (EPF) for INS/GPS Land Vehicle Navigation Applications. Proceedings ION GNSS, 26192626. Fort Worth, TX. Aggarwal, P. Z-S. (2010). MEMS-based Integrated Navigation. Norwood: Archech House. Aggarwal, P., Syed, Z., and El-Sheimy, N. (2008). Hybrid Extended Particle Filter (HEPF) for Integrated Civilian Navigation System. Proceedings of IEEE/ION PLAN, 984-992. Monterey, CA. Ashby, N., and J. J. Spilker, Jr. (1996). Introduction to Relativity Effects on the Global Positioning System. In: Global Positioning System: Theory and Applications, Volume II, B. Parkinson and J. J. Spilker, Jr. (eds.). Washington, D.C.: American Institute of Aeronautics and Astronautics. Ashby, N., and M. Weiss (March 1999) Global Positioning System Receivers and Relativity: National Institute of Standards and Technology (NIST) Technical Note 1385. Boulder, CO. ARINC Research Corporation (2004). NAVSTAR GPS Space Segment/Navigation User Interfaces, Interface Specification, IS-GPS-200D (Public Release Version). ARINC Research Corporation: Fountain Valley, CA.

165

Banville, S., Santerre, R., Cocard, M., Langley, R. (2008). Satellite and Receiver Phase Bias Calibration for Undifferenced Ambiguity Resolution. Proceedings of ION NTM. San Diego, CA. Bisnath, S., and Gao, Y. (2009). Current State of Precise Point Positioning and Future Prospects and Limitations. International Association of Geodesy Symposia 133. Springer-Verlag: Berlin, Heidelberg. Brown, R. G. and Hwang, P. Y. C. (1992). Introduction to Random Signals. New York: Wiley. CarChip OBD II-based vehicle data logger and software (2013). Davis Instruments. Carvalho, H., Del Moral, P., Monin, A., and Salut, G. (1997). Optimal Nonlinear Filtering in GPS/INS integration. IEEE Transactions on Aerospace and Electronic Systems 33:3. 835-50. Chiang, K.-W., Noureldin, A., and El-Sheimy, N. (2004). A New Weights Updating Method for Neural Networks Based INS/GPS Integration. Measurement Science and Technology 15. 2053-61. Chiang, K.-W. and El-Sheimy, N. (2002). INS/GPS integration using neural networks for land vehicle navigation applications. Proceedings of the ION GPS. 535-44. Portland, OR. Chiang, K.-W., Noureldin, A., and El-Sheimy, N. (2006). The Utilization of Artificial Neural Networks for Multi-Sensor System Integration in Navigation and Positioning Instruments. IEEE Transactions on Instrumentation and Measurement 55. 1606-15.

166

Collins, P., S. Bisnath, F. Lahaye, and P. Heroux (2010). Undifferenced GPS Ambiguity Resolution Using the Decoupled Clock Model and Ambiguity Datum Fixing. Journal of Navigation 57:2. 123-35. Colombo, O.L., Sutter, A.W. and Evans, A.G. (2004). Evaluation of Precise, Kinematic GPS Point Positioning. Proceedings of ION GNSS. 2667-75. Long Beach, CA. Conley, R. et al. (2006). Performance of Stand-Alone GPS. Understanding GPS: Principles and Applications (second edition). Ed.: Kaplan, E.D. ArtechHouse Mobile Communications Series. Crespillo, O. G., Heirich O., and Lehner A. (2014). "Bayesian GNSS/IMU tight integration for precise railway navigation on track map" IEEE/ION Position, Location and Navigation Symposium - PLANS 2014, DOI: 10.1109/PLANS.2014.6851465 Crossbow (2007). IMU User's Manuals -- Models IMU300CC, IMU400CC, IMU400CD. Crossbow Technology Inc. Davis instruments (2013) CarChip OBDII-based vehicle data logger and software Dissanayake, G. and Sukkarieh, S. (2001). The aiding of a low-cost strapdown inertial measurement unit using vehicle model constraints for land vehicle applications. IEEE Trans. Robot. Autom. 17:5. 731-47.

167

El-Diasty, M. (2014). Development of Real-Time PPP-Based GPS/INS Integration System Using IGS Real-Time Service for Hydrographic Surveys., J. Surv. Eng., 10.1061/(ASCE)SU.19435428.0000150, 05015005 El-Rabbany, A. (2006). Introduction to GPS: The Global Positioning System. Artech House: Norwood, MA. El-Sheimy, N., Chiang, K.-W., and Noureldin, A. (2006). The utilization of artificial neural networks for multisensor system integration in navigation and positioning instruments. IEEE Transactions on Instrumentation and Measurement 55:5. 1606-15. Elsobeiey, M. and El-Rabbany, A. (2010a). Rigorous modeling of GPS residual errors for precise point positioning. Canadian Geomatics Conference and Symposium of Commission I, ISPRS. Elsobeiey, M. and El-Rabbany, A. (2010b). On stochastic modeling of the modernized global positioning system (GPS) L2C signal. Journal of Measurement Science and Technology. Elsobeiey, Mohamed E., (2012). An Improved Model for Precise Point Positioning with Modernized Global Positioning System. Ryerson University, Theses and dissertations. Paper 1324. Estey, L., H. and Meertens, C., M. (1999). TEQC: The Multi_Purpose Toolkit for GPS/GLONASS dat. Farrell, J. A. (2008). Aided Navigation: GPS with High Rate Sensors. McGraw-Hill Professional.

168

Farrell, J. A. (1998). The Global Positioning System & Inertial Navigation. New York, NY: McGraw-Hill. Gao, Y., Chen, K. (2004). Performance Analysis of Precise Point Positioning Using Real-Time Orbit and Clock Products. Journal of Global Positioning Systems 3:1-2. 95-100. Gao, Y., Shen, X. (2001). Improving Ambiguity Convergence in Carrier Phase-Based Precise Point Positioning. Proceedings of ION GPS. Salt Lake City, UT. Gao, Z., Zhang H., Ge M., Niu X., Shen W., Wickert J. and Schuh H. (2015). Tightly Coupled Integration of Ionosphere-Constrained Precise Point Positioning and Inertial Navigation Systems, Sensors 2015, 15, 5783-5802; doi:10.3390/s150305783 Ge, M., Gendt, G., Rothacher, Shi, M. C. and Liu, J. (2008). Resolution of GPS Carrier-phase Ambiguities in Precise Point Positioning (PPP) with Daily Observations. Journal of Geodesy 82. 389-399. Gelb, Ed., A. Applied Optimal Estimation. Cambridge, Mass.: M.I.T. Press. Georgy, J., F., W. (2010) Advanced Nonolinear Techniques for Low Cost Land Vehicle Navigation. PhD thesis, Electrical and Computer Engineering Department Queen's University, Kingston, ON. Georgy, J., Norueldin, A., Korenberg, M., and Bayoumi, M. (2010). Low-Cost Three Dimensional Navigation Solution for RISS/GPS Integration Using Mixture Particle Filter. IEEE Transaction On Vehicular Technology 59:2.
169

Georgy, J., Noureldin, A., and Bayoumi, M. (2009). Mixtture Particle Filter for Low Cost INS/Odometer/GPS Integration in Land Vehicles. IEEE. Gleason, S., Gebre-Egziabher, D. (2009). GNSS Applications and Methods. Artech House, Norwood, MA. Grewal, M. S., Weill, L. R., and Andrews, A. P. (2007). Global Positioning Systems, Inertial Navigation, and Integration (2nd Edition). John Wiley & Sons, Inc. Grewal, S., and Andrews, A., P. (2008). Kalman Filtering: Theory and Practice Using MATLAB. Oxford: Wiley. Gurney, K. (2003). An Introduction to Neural Networks. Taylor & Francis: London, UK. Hatch, R. (May-June 1995). Relativity and GPS-I. Galilean Electrodynamics 6:3. 52­7. Hay, C., and J. Wong (January 2000). Enhancing GPS: Tropospheric Delay Prediction at the Master Control Station. GPS World 11:1. 56-62. Héroux, P., .Gao, Y., Kouba, J., Lahaye, F.1, Mireault, Y. , Collins, P., Macleod, K., Tétreault, P. and Chen K. (2004). Products and Applications for Precise Point Positioning - Moving Towards Real-Time. ION GNSS 17th International Technical Meeting of the Satellite Division. Long Beach, CA. Hofmann-Wellenhof, B., Lichtenegger, H., and Collins, J. (2001). Global Positioning System: Theory and Practice. Springer-Verlag Wien, NY.

170

Ibrahim, H. E., and El-Rabbany, A. (2009) Assessment and Implementation of NOAA NWPBased Tropospheric Correction Model. Proceedings of the IEEE Toronto International Conference -- Science and Technology for Humanity. 316-21. (CD-ROM.) IGS (2016) International GNSS Service (http://www.igs.org/products), accessed May 13, 2016 Iqbal, U. and Noureldin, A. (2009). Integrated Reduced Inertial Sensor System/GPS for Vehicle Navigation: VDM verlag. Iqbal, U., Ukou, F. and Noureldin, A. (2008). An Integrated Reduced Inertial Sensor SystemRISS/GPS for Land Vehicles. In proceeding of IEEE/ION Position, Location and Navigation Symposium. Monterey, CA. 1014-21. Karamat, T. B. (2009). Implementation of a Tightly Coupled INS/GPS Integration for Land Vehicle Navigation. M.Sc. thesis, Electrical and Computer Engineering Department, Royal Military College of Canada. Kingston, ON. Karamat, T. B. (2014). Improved Land Vehicle Navigation and GPS Integer Ambiguity Resolution using Enhanced Reduced-IMU/GPS Integration. Queens University, Theses and dissertations, Karamat, T. B., Atia M. M., Noureldin A. (2014). "Performance Analysis of Code-Phase-Based Relative GPS Positioning and Its Integration with Land Vehicle's Motion Sensors" IEEE Sensors Journal, doi: 10.1109/JSEN.2014.2324535

171

Kjørsvik, N. S., Gjevestadb J. G., O., Brøstea E, Gadec K, Hagenc (2010). "Tightly coupled precise point positioning and inertial navigation systems." International calibration and orientation workshop EuroCOW. Kouba, J., Héroux, P. (2000). GPS Precsie Point Positioining Uisng IGS Orbit Products. GPS Solutions 5:2. Leandro, R.F. and Santos, M.C. (2006). Wide Area Based Precise Point Positioning. Proceedings of ION GNSS. Fort Worth, TX. Leick, F. (2004). GPS Satellite Surveying (3rd Edition). John Wiley & Sons: USA. Louis, H., E. and Charles, M., M. (1999). TEQC: The Multi-Purpose Toolkit for GPS/GLNASS data. GPS Solutions 3:1. 42-9. Misra, P. and Angie, P. (2001). Global Positioning System: Signal, Measurements and Performance. Ganga-Jumuna Press. Noureldin, A. (2007). EE523: Course Notes on Mobile Multi-Sensor Systems Integration. Kingston, ON, Canada: Royal Military College. 2007. Noureldin, A. (2009) EE 523 ­ Integrated Navigation Systems Course Lecture Notes, Electrical and Computer Engineering Department. Royal Military College of Canada. Noureldin, A., El-Shafie, A., and Taha, M. R. (2007b). Optimizing neuro-fuzzy modules for data fusion of vehicular navigation systems using temporal cross-validation. Engineering Applications of Artificial Intelligence 20. 49-61.
172

Noureldin, A., Irvine-Halliday, D. and Mintchev, M. (2002). Accuracy Limitations of FOG-Based Continuous Measurement-While-Drilling Surveying Instruments for Horizontal Wells. IEEE Trans, Instrument Measurement 51:6. 1177-91. Noureldin, A., McGaughey, D., Armstrong, J., and Johnston, C. (2007a). Accuracy Enhancement of Inertial Sensors Utilizing High Resolution Spectral Analysis. NavINST, Royal Military College of Canada, Kingston, ON. Noureldin, A. (2007) EE523: Course Notes on Mobile Multi-Sensor Systems Integration. Royal Military College, Kingston, ON. Noureldin, A., Osman, A., and El-Sheimy, N. (2004). A Neuro-Wavelet Method for Multi-Sensor System Integration for Vehicular navigation. Journal of Measurement Science and Technology 15:2. 404-12. Noureldin, A., Karamat, T. B., Eberts, M. D, El-Shafie, A. (2009). Performance Enhancement of MEMS Based INS/GPS Integration for Low Cost Navigation Applications. IEEE Transactions on Vehicular Technology 58:3. 1077-96. Novatel (2005), OEM4 Family User Manual OM-20000046 Vol-1 Rev 19. NovAtel Inc, vol. 1. Novatel (2005), SPAN Technology User Manual OM-20000062 Rev 7. NovAtel Inc, Obradovic, D., Lenz, H., and Schupfner, M. (2007). Fusion of sensor data in Siemens car navigation system. IEEE Trans. Veh. Technol. 56:1. 43-50.

173

Parkinson, B. W. and Spilker, J. J. (1996). Global Positioning System: Theory and Applications. 2: AIAA. Perreault, J. M. A., Iqbal, U., Okou, A. F., and Noureldin, A. (2008). RISS/GPS Integration Utilizing an Augumented KF/NN Module. European Journal of Navigation 6. 8-13. Ristic, B., Arulaoalam, S., and Gordon, N. (2004). Beyond the Kalman Filter: Particle Filters for Tracking Applications. Artech House: Boston, USA. Semeniuk, L. and Noureldin, A. (2006). Bridging GPS outages using neural networks estimates of INS position and velocity errors. Measurement Science and Technology 17. Sharaf, R. and Noureldin, A. (2007). Sensor integration for satellite-based vehicular navigation using neural networks. IEEE Transactions on Neural Networks 18:2. 589-94. Shin, E-H. (2005). Estimation Techniques for Low-Cost Inertial Navigation. Ph.D. Thesis, Department of Geomatics Engineering, University of Calgary. Calgary, AB. Shin, E-H., and Schenzinger, B. (2009). Initially Aided Precise Point Positioning. Proceedings of the ION GNSS 2009. Savannah, GA. Simon, D. (2006). Optimal State Estimation: Kalman, H Infinity, and Non-linear Approaches. Hoboken, N.J; Chichester: John Wiley & Sons, Inc. Teunissen, P. J. G., Kleusberg, A. (eds.) (1998). GPS for Geodesy (2nd Edition). New York: Springer-Verlag.

174

Wang, M. and Gao, Y. (2007). An Investigation on GPS Receiver Initial Phase Bias and Its Determination. Proceedings of ION NTM. San Diego, California. 873-80. Wang, M., and Gao, Y. (2007b). An Investigation on GPS Receiver Initial Phase Bias and Its Determination. Proceedings of ION NTM. San Diego, CA. Witchayangkoon, B. (2000). Elements of GPS Precise Point Positioning. PhD Thesis, Spatial Information Science and Engineering, University of Maine. 265. Yi, Y. and Grejner-Brzezinska, D.A. (2006a). Tightly-coupled GPS/INS integration using unscented Kalman filter and particle filter. Proceedings ION GNSS. Fort Worth, TX. 2182-91. Yi, Y. and Grejner-Brzezinska, D.A. (2006b). Performance comparison of the non-linear Bayesian filters supporting GPS/INS integration. Proceedings ION NTM. Monterey, CA. 977-83. Zhang, and Gao, Y., (2008). Integration of INS and Un-differenced GPS Measurements for Precise Positioning and Attitude Determination. Journal of Navigation 61:1, pp. 87-97. Zhong, P., X. Ding, D. Zheng and W. Chen (2007). Adaptive wavelet transform based on crossvalidation method and its application to GPS multipath mitigation. GPS Solution. SpringerVerlag 12:2. 109-17. Zumberge, J.F., Heflin, M.B., Jefferson, D.C., Watkins, M.M. and Webb, F.H. (1997). Precise Point Processing for the Efficient and Robust Analysis of GPS Data from Large Networks. Journal of Geophysical Research 102:B3. 5005-17.

175

