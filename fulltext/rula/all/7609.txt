MODEL PREDICTIVE CONTROL OF HIGH POWER CURRENT-SOURCE CONVERTER FOR MEDIUM-VOLTAGE INDUCTION MOTOR DRIVE

By

Hang Gao
B. Eng., Hefei University of Technology, Anhui, China, 2011 M. Sc., Hefei University of Technology, Anhui, China, 2014

A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of Doctor of Philosophy in the program of Electrical and Computer Engineering Toronto, Ontario, Canada, 2018 © Hang Gao, 2018

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A DISSERTATION

I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners.

I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

I understand that my dissertation may be made electronically available to the public.

ii

Model Predictive Control of High Power Current-Source Converter for Medium-Voltage Induction Motor Drive
Hang Gao
Doctor of Philosophy Electrical and Computer Engineering Ryerson University, Toronto, 2018

Abstract
As a crucial player in medium-voltage (MV) applications, high power current-source converters (CSCs) feature some distinct advantages in contrast to their voltage-source counterparts. However, the traditional control techniques, based on linear proportional-integral (PI) regulators and low band-width modulation, impose several technical issues during low switching frequency operation. In order to meet more and more stringent performance requirements on industrial drives, various high performance finite control-set model predictive control (FCS-MPC) schemes are proposed in this thesis to control CSCs employed in MV induction motor (IM) drives. The continuous-time and discrete-time dynamic models of high power CSC-fed MV IM drive are deduced, which are used to predict the evolution of state variables in the system. Issues related to MPC approach, such as prediction horizon, weighting factor selection, control delay compensation, accurate extrapolation of references, and nature of variable switching frequency are addressed as well. Model predictive power factor control (MPPFC) is proposed to accurately regulate the line power factor of CSR under various operating conditions. Meanwhile, an active damping function is incorporated into MPPFC to suppress the possible line-side LC resonance. Moreover, an online capacitance estimation method is designed in consideration on the perturbation of the filter parameters of CSR.

iii

In order to keep fixed switching frequency of CSC and improve its dynamic responses, model predictive switching pattern control (MPSPC) and model predictive space vector pattern control (MPSVPC) are proposed, in which MPC technique is combined with selective harmonic elimination (SHE) modulation and space vector modulation (SVM), respectively. In steady state, the PWM waveform of CSC follows the pattern of traditional modulation schemes, whereas during transients CSC is governed by MPC approach for the purpose on dynamic performance improvement. A common-mode voltage (CMV) reduced model predictive control (RCMV-MPC) is studied, with which the peak value of CMV in high power CSC-fed MV IM drive can be further reduced in comparison with the traditional RCMV modulation schemes. The dynamic responses of the motor drive system are further improved as well. The simulation on a megawatt motor drive system and experimental results on a low power prototype, validate the effectiveness of the proposed various control schemes.

iv

Acknowledgements
I would like to express my deep sense of gratitude to my supervisors, Drs. Bin Wu and Dewei Xu, for their invaluable guidance, patience, kindness and consistent encouragement throughout the course of this work. During the years in the Laboratory of Electrical Drive and Application Research (LEDAR) at Ryerson University, I was not only impressed by Dr. Wu's and Dr. Xu's profound professional knowledge, but also their perseverance and meticulous attitude in research work. Moreover, their gentle personalities will influence my future career as well as my personal life. I am very thankful to my good friends and fellow researchers, Drs. Huafeng Xiao (Southeast University, China), Chushan Li (Zhejiang Univerisity, China), and Zhijian Fang (Wuhan University, China), Sixing Du, Mr. Jahangir Afsharian (Murata Power Solution, Canada) for many interesting discussions and enjoyable time spent together. I am also grateful to Mr. George Cheng, and Drs. Yuan Xiao and Navid R. Zargari from Rockwell Automation Canada for their helpful information and suggestions during the early stage of my research work. I deliver my heart-felt thanks to Dr. Amir Yazdani for his kind suggestions and helpful tips during the course `Modeling and control of power converters' in the first year of my PhD study and my proposal defence examination. I would like to thank all my friends and collegues in the LEDAR, especially Drs. Qiang Wei, Shuai Wang, Apparao Dekka, Mehdi Narimani (Mcmaster University, Canada), Vankata Yaramasu (Northern Arizona University, USA), Sebastian Rivera, and Ms. Qingxin Guan for lots of memorable times and fruitful discussions. I express my intense gratitude to my supervisor during my master's studies, Dr. Jianhui Su (Hefei University of Technology, China), for his suggestions and recommendation, which led to the unique opportunity for me to pursue my PhD degree abroad at Ryerson University. I give special thanks and respect to my parents, especially my mother, Xiaoming Liu, who are the source of inspiration and support all through my life. My research would not have been possible without their help. Financial support from Dr. Bin Wu, Department of Electrical and Computer Engineering, Centre for Urban Energy, and Ryerson University are gratefully acknowledged. Hang Gao Toronto, Ontario, Canada 28th, December, 2017 v

Table of Contents
AUTHOR'S DECLARATION .................................................................................................................. ii Abstract...................................................................................................................................................... iii Acknowledgements .................................................................................................................................... v List of Figures............................................................................................................................................. x List of Tables ............................................................................................................................................ xv Glossary of Acronyms and Symbols ...................................................................................................... xvi 1 Introduction........................................................................................................................................... 1 1.1 1.2 Overview and Prospect of Medium-Voltage Motor Drive ............................................................. 1 Voltage-Source Inverter Topologies for Medium-Voltage Drives ................................................. 2 Two-level Voltage-Source Inverter ........................................................................................ 2 Neutral-Point Clamped Voltage-Source Inverter ................................................................... 3 Cascaded H-Bridge Multilevel Voltage-Source Inverter........................................................ 4

1.2.1 1.2.2 1.2.3 1.3

High Power Current-Source Converter-Fed Medium-Voltage Motor Drive .................................. 6 Load-Commutated Current-Source Inverter ........................................................................... 6 Pulse-Width Modulated Current-Source Inverter ................................................................... 7 Configuration of High Power Current-Source Converter-Fed Medium-Voltage Motor Drive ................................................................................................................................................ 9

1.3.1 1.3.2 1.3.3

1.3.4 1.4

Technical Challenges ............................................................................................................ 12

Review on Traditional Modulation and Control Schemes of High Power Current-Source Converter for Medium-Voltage Motor Drive ............................................................................... 15

1.4.1 1.4.2 1.4.3

Traditional Modulation Schemes .......................................................................................... 16 Traditional Control Schemes of High Power Current-Source Rectifier ............................... 21 Traditional Control Schemes of High Power Current-Source Inverter-Fed Induction Motor Drive ..................................................................................................................................... 27

1.4.4 1.4.5 1.5

Traditional Common-Mode Voltage Reduction Method...................................................... 29 Technical Challenges ............................................................................................................ 33

Review on Conventional Model Predictive Control for Current-Source Converter..................... 34 Principle of Operation........................................................................................................... 35 Conventional Model Predictive Control for High Power Current-Source Converter ........... 40

1.5.1 1.5.2

vi

1.5.3 1.6

Technical Challenges ............................................................................................................ 43

Objectives of Dissertation............................................................................................................. 44 Investigation of Challenges in High Power Current-Source Converter through Model Predictive Control ................................................................................................................. 45

1.6.1

1.6.2 1.7

Investigation of Challenges in Finite Control-Set Model Predictive Control....................... 46

Outline of Dissertation.................................................................................................................. 47

2 Modeling and Generalized Predictive Control Approach of High Power Current-Source Converter for Medium-Voltage Induction Motor Drive ................................................................. 50 2.1 Derivation of Prediction Model .................................................................................................... 50 Caley-Hamilton Theorem ..................................................................................................... 50 Euler's Method ..................................................................................................................... 51 Heun's Method ..................................................................................................................... 52 Correlation Between Discretization Methods ....................................................................... 52

2.1.1 2.1.2 2.1.3 2.1.4 2.2

Modeling of High Power Current-Source Converter for Medium-Voltage Induction Motor Drive ...................................................................................................................................................... 53

2.2.1 2.2.2 2.2.3

Modeling of High Power Current-Source Inverter with Resistive-Inductive load ............... 53 Modeling of High Power Current-Source Rectifier .............................................................. 56 Modeling of High Power Current-Source Inverter-Fed Medium Voltage Induction Motor Drive ..................................................................................................................................... 58

2.3

Generalized Predictive Control Approach of High Power Current-Source Converter ................. 60 Selection of Prediction Horizon............................................................................................ 60 Reference Extrapolation Methods ........................................................................................ 61 Cost Function Flexibility ...................................................................................................... 62 Delay Compensation............................................................................................................. 65

2.3.1 2.3.2 2.3.3 2.3.4 2.4

Conclusions .................................................................................................................................. 67

3 Model Predictive Power Factor Control With Active Damping Function for Current-Source Rectifier ............................................................................................................................................... 68 3.1 Line Power Factor Control ........................................................................................................... 69 Line Reactive Power Reference Estimator ........................................................................... 69 Predictive Line Current Control ........................................................................................... 74 Switching Frequency Reduction ........................................................................................... 75

3.1.1 3.1.2 3.1.3 3.2

Active Damping Function Associated With MPPFC ................................................................... 76

vii

3.2.1 3.2.2 3.3

Damping Current Calculation ............................................................................................... 77 Damping Current Associated into MPPFC........................................................................... 78

Simulation Validation ................................................................................................................... 80 Steady State Performance ..................................................................................................... 81 Dynamic Performance .......................................................................................................... 90

3.3.1 3.3.2 3.4

Experimental Validation ............................................................................................................... 93 Steady State Performance ..................................................................................................... 94 Dynamic Performance .......................................................................................................... 97

3.4.1 3.4.2 3.5

Conclusions .................................................................................................................................. 99

4 Model Predictive Pulse Pattern Control With Low Switching Frequency for High Power Current-Source Converter ............................................................................................................... 100 4.1 4.2 Selective Harmonic Elimination-Pulse Width Modulation for Current-Source Converter ........ 101 Space Vector Based Selective Harmonic Elimination................................................................ 109 Realization of Space Vector Based SHE ............................................................................ 113

4.2.2 4.3

Proposed Model Predictive Switching Pattern Control .............................................................. 116 Reference Calculation in Steady State ................................................................................ 118 Principle of Model Predictive Switching Pattern Control .................................................. 118

4.3.1 4.3.2 4.4

Simulation Validation ................................................................................................................. 123 Steady State Performance ................................................................................................... 123 Transient Responses ........................................................................................................... 124

4.4.1 4.4.2 4.5

Experimental Validation ............................................................................................................. 128 Steady-State Performance ................................................................................................... 128 Dynamic Performance ........................................................................................................ 129

4.5.1 4.5.2 4.6

Conclusions ................................................................................................................................ 131

5 Model Predictive Space Vector Pattern Control for High Power Current-Source Converter-Fed Medium-Voltage Induction Motor Drive ....................................................................................... 132 5.1 Model Predictive Space Vector Pattern Control ......................................................................... 132 Limitation of Traditional Modulation and Linear Control ................................................. 132 Model Predictive Space Vector Pattern Control ................................................................. 133 Overall Control Structure ................................................................................................... 138

5.1.1 5.1.2 5.1.3 5.2

Simulation Validation ................................................................................................................. 142 Steady State Performance ................................................................................................... 142

5.2.1

viii

5.2.2 5.3

Dynamic Performance ........................................................................................................ 143

Experimental Validation ............................................................................................................. 151 Steady State Performance ................................................................................................... 151 Dynamic Performance ........................................................................................................ 153

5.3.1 5.3.2 5.4

Conclusions ................................................................................................................................ 157

6 Common-Mode Voltage Reduced Model Predictive Control for High Power Current-Source Converter-Fed Medium-Voltage Induction Motor Drive ............................................................. 159 6.1 CMV in CSC-Fed IM Drives ...................................................................................................... 160 CMV Definition in CSC-Fed IM Drives ............................................................................ 160 Principle of CMV Reduction in RCMV-MPC ................................................................... 162

6.1.1 6.1.2 6.2

RCMV-MPC For High Power CSC-Fed MV IM Drive ............................................................. 165 MPC for CSR...................................................................................................................... 165 MPFOC for CSI-Fed IM Drive........................................................................................... 167 Unified Cost Function for CMV Reduction ....................................................................... 168 Overall Control Structure of RCMV-MPC......................................................................... 170

6.2.1 6.2.2 6.2.3 6.2.4 6.3

Simulation Validation ................................................................................................................. 172 Sampling Frequency Selection ........................................................................................... 173 Weighting Factor Selection ................................................................................................ 174 Steady State Performance ................................................................................................... 175 Transient Performance ........................................................................................................ 179

6.3.1 6.3.2 6.3.3 6.3.4 6.4

Experimental Verification .......................................................................................................... 181 Steady State Performance ................................................................................................... 182 Transient Performance ........................................................................................................ 185

6.4.1 6.4.2 6.5

Conclusion .................................................................................................................................. 187

7 Conclusions and Future Work......................................................................................................... 189 7.1 7.2 Conclusions ................................................................................................................................ 189 Future Work ................................................................................................................................ 191

Appendix A ............................................................................................................................................. 193 A.1 Base values for AC-side quantities ............................................................................................... 193 A.2 Base values for DC-side quantities ............................................................................................... 193 Bibliography ........................................................................................................................................... 195

ix

List of Figures
Fig. 1.1 General block diagram of high power MV drives. ······················································ 1 Fig. 1.2 Simplified two-level VSI for high-power applications. ················································ 3 Fig. 1.3 Three-level NPC inverter.·················································································· 4 Fig. 1.4 Seven-level CHB multilevel inverter-fed drive with an 18-pulse diode rectifier. ··················· 6 Fig. 1.5 LCI for synchronous motor drives. ······································································· 7 Fig. 1.6 Simplified SGCT based PWM CSI. ······································································ 8 Fig. 1.7 A typical 4160V CSI-fed drive with a PWM rectifier and inverter. ·································· 9 Fig. 1.8 4160V CSI-fed drive with dual-bridge PWM rectifier for sinusoidal inputs. ······················ 11 Fig. 1.9 A transformerless CSI-fed MV motor drive with an integrated DC choke. ························ 12 Fig. 1.10 Classification of control techniques used for power converters.···································· 15 Fig. 1.11 Trapezoidal PWM. ······················································································· 17 Fig. 1.12 Five-pulse SHE PWM pattern for CSC. ······························································· 18 Fig. 1.13 SVM scheme: (a) space vector location and (b) vector synthesis. ·································· 21 Fig. 1.14 Configuration of a CSR with a DC load resistor. ····················································· 21 Fig. 1.15 Modulation index control: (a) block diagram and (b) phasor diagram. ···························· 23 Fig. 1.16 Delay angle control: (a) block diagram and (b) phasor diagram. ··································· 24 Fig. 1.17 Series and parallel resonant modes in a CSR: (a) series resonant mode (b) parallel resonant mode. ······································································································ 25 Fig. 1.18 Block diagram of capacitor voltage feedback based active damping method. ···················· 26 Fig. 1.19 Block diagram of modulation index control with active damping method. ······················· 27 Fig. 1.20 Block diagram of FOC scheme for CSI-fed MV IM drive. ········································· 29 Fig. 1.21 Vector synthesis of the AZS modulation methods in Sector I.······································ 30 Fig. 1.22 Vector synthesis of the NTS modulation method in Sector B2. ···································· 31 Fig. 1.23 Selected zero-state vectors in zero-state vector selection SVM in each instant of one fundamental period. ······················································································ 32 Fig. 1.24 Flowing chart diagram of optimized sequence arrangement. ······································· 33 Fig. 1.25 Generalized control block diagram of MPC for power converters. ································ 36 Fig. 1.26 Receding horizon policy exemplified for the prediction horizon N p = 7 .························· 39 Fig. 1.27 Block diagram of MPC for CSR. ······································································· 41 Fig. 1.28 Block diagram of MPC schemes for a CSI. ··························································· 42 Fig. 1.29 Objectives of proposed research. ······································································· 45

x

Fig. 2.1 Topology of high power CSI with RL load. ···························································· 53 Fig. 2.2 Diagram of space vectors of a CSC. ····································································· 54 Fig. 2.3 Configuration of a CSR with a resistive load. ·························································· 56 Fig. 2.4 Configuration of high power CSC-fed MV IM drive. ················································· 58 Fig. 2.5 FCS-MPC strategy using one-step prediction horizon.················································ 60 Fig. 2.6 FCS-MPC strategy using two-step prediction horizon. ··············································· 61 Fig. 2.7 Overview of cost function definition with primary and secondary objectives in CSC. ··········· 63 Fig. 2.8 One-step prediction with calculation delay and without compensation. ···························· 66 Fig. 2.9 Delay compensation method with modified one-step prediction. ···································· 67 Fig. 3.1 Space vector diagram for line side of CSR: (a) line PF lagging and (b) line PF leading. ········· 72 Fig. 3.2 Profile of MAPF versus DC current: (a) with different capacitors and (b) with different filter inductors.···································································································· 73 Fig 3.3. Diagram of regulation method for estimated capacitance. ············································ 74 Fig. 3.4 Active damping methods for CSR: (a) traditional method and (b) proposed method.············· 79 Fig. 3.5 Block diagram of MPPFC with active damping function. ············································ 80 Fig. 3.6 Line power factor profile of three schemes. ···························································· 82 Fig. 3.7 Line current THD profile of three methods. ···························································· 83 Fig. 3.8 Line current TDD profile.················································································· 84 Fig. 3.9 Maximum TDD (Idc=1.0pu) versus size of capacitor. ················································· 85 Fig. 3.10 Maximum TDD (Idc=1.0pu) of MPPFC with different filter inductors.···························· 86 Fig. 3.11 Switching frequency profile of three schemes. ······················································· 87 Fig. 3.12 Performance of online capacitance estimation: (a) 1.5 times mismatched capacitance at 0.4pu DC current, and (b) 0.5 times mismatched capacitance at 0.3pu DC current. ···················· 89 Fig. 3.13 Dynamic responses when DC current suddenly changes: (a) Scheme I, (b) Scheme II, and (c) MPPFC. ··································································································· 92 Fig. 3.14 Effectiveness of active damping function in MPPFC: (a) without active damping function and (b) with active damping function. ······································································ 93 Fig. 3.15 Photograph of a low power CSR prototype: (A) three-phase power supply, (B) filter inductance, (C) capacitors, (D) CSR, (E) DC choke, (F) DC load resistor, and (G) oscilloscope. ··········· 94 Fig. 3.16 Steady state performance at 1pu (19.6A) DC current: (a) Scheme I, (b) Scheme II, and (c) MPPFC. ··································································································· 95 Fig. 3.17 Online capacitance estimation: (a) 1.5 times mismatched capacitance at 0.4pu DC current and (b) 0.5 times mismatched capacitance at 0.3pu DC current. ········································ 97

xi

Fig. 3.18 Dynamic responses under sudden changes of DC current: (a) Scheme I, (b) Scheme II, and (c) MPPFC. ··································································································· 98 Fig. 3.19 Effectiveness of active damping function in MPPFC during DC current drop: (a) without active damping function and (b) with active damping function. ··········································· 99 Fig. 4.1 SHE-PWM waveforms: (a) six pulses per half-cycle and (b) eight pulses per half-cycle. ······ 103 Fig. 4.2 Solutions to independent angles for SHE (a) six pulse per half cycle and (b) eight pulse per half cycle. ······································································································ 105 Fig. 4.3 Phase A gate signals for six-pulse waveform: (a) Case I and (b) Case II. ························ 106 Fig. 4.4 Phase A gating signals for eight-pulse waveform: (a) Case I, (b) Case II, (c) Case III, and (d) Case IV. ··································································································· 108 Fig. 4.5 Space vector sequence for six-pulse waveform: (a) case I and (b) case II. ······················· 111 Fig. 4.6 Space vector sequence for eight-pulse waveform: (a) case I, (b) case II, (c) case III, and (d) case IV. ········································································································· 112 Fig. 4.7 Space vectors during one sampling interval: (a) one vector, (b) two vectors, and (c) three vectors. ······················································································································· 116 Fig. 4.8 Block diagram of MPSPC for a CSC. ································································· 117 Fig. 4.9 Segment distribution on current vector domain. ····················································· 121 Fig. 4.10 Flowchart diagram of MPSPC. ······································································· 122 Fig. 4.11 Transient responses with six-pulse SHE waveform: (a) space vector based SHE and (b) MPSPC ······················································································································· 125 Fig. 4.12 Transient performance during the change of output frequency: (a) space vector based SHE and (b) MPSPC. ····························································································· 127 Fig. 4.13 Spectrum diagram of experimental output PWM currents: (a) six-pulse SHE-MPC, (b) eightpulse SHE-MPC, (c) six-pulse MPSPC, and (d) eight-pulse MPSPC. ··························· 129 Fig. 4.14 Experimental transient responses with six-pulse SHE waveform: (a) space vector based SHE and (b) MPSPC. ························································································ 130 Fig. 4.15 Experimental transient performance during the change of output frequency: (a) space vector based SHE and (b) MPSPC. ·········································································· 131 Fig. 5.1 Diagram of relation between sampling interval of MPSVPC and control period of traditional SVM: (a) traditional SVM, (b) MS-SVM, and (c) MPSVPC. ······································ 134 Fig. 5.2 Diagram of three situations of applied space vectors in one sampling interval with MPSVPC. 135 Fig. 5.3 Flowing chart diagram of optimal space vector selection process in MPSVPC. ················· 138

xii

Fig. 5.4 Control block diagram of MPSVPC: (a) overall control structure and (b) inside details of MPSVPC block.·························································································· 141 Fig. 5.5 Diagram of simulated whole start-up process: (a) MS-SVM and (b) MPSVPC.················· 144 Fig. 5.6 Diagram of beginning part of simulated start-up process: (a) MS-SVM and (b) MPSVPC. ··· 146 Fig. 5.7 Diagram of whole simulated speed reverse process: (a) MS-SVM and (b) MPSVPC.·········· 148 Fig. 5.8 Diagram of beginning part of simulated speed reverse process: (a) traditional SVM and (b) MPSVPC. ································································································· 150 Fig. 5.9 Diagram of experimental steady state performance at rated rotating speed and 0.8pu load torque: (a) MS-SVM and (b) MPSVPC. ······································································· 152 Fig. 5.10 Diagram of whole experimental start-up process: (a) MS-SVM and (b) MPSVPC. ··········· 154 Fig. 5.11 Diagram of beginning part of experimental start-up process: (a) MS-SVM and (b) MPSVPC. ······················································································································· 155 Fig. 5.12 Diagram of whole experimental speed reverse process: (a) MS-SVM and (b) MPSVPC. ···· 156 Fig. 5.13 Diagram of beginning part of experimental speed reverse process: (a) MS-SVM and (b) MPSVPC. ······························································································· 157 Fig. 6.1 Configuration of high power CSC-fed MV IM drive. ··············································· 160 Fig. 6.2 Space vector definition and corresponding CMV of a CSC. ······································· 162 Fig. 6.3 Principle of CMV peak value reduction: (a) zero-state vector selection based RCMV-SVM and (b) RCMV-MPC. ························································································ 164 Fig. 6.4 Phasor diagram of traditional modulation index control. ··········································· 166 Fig. 6.5 Block diagram of RCMV-MPC for CSC-fed IM drives.············································ 171 Fig. 6.6 Flowchart diagram of optimal switching states' combination selection. ·························· 172 Fig. 6.7 Profile of CMV peak value and THD versus wcmv at rated speed and 6000Nm condition. ····· 175 Fig. 6.8 Simulated results at rated speed and 6000Nm condition: (a) Method I, (b) Method II, and (c) RCMV-MPC.····························································································· 177 Fig. 6.9 Simulated results at 200rpm and 1000Nm condition: (a) Method I, (b) Method II, and (c) RCMV-MPC.····························································································· 178 Fig. 6.10 Zoomed CMV results at rated speed and 6000Nm condition: (a) Method II and (b) RCMVMPC. ····································································································· 179 Fig. 6.11 Simulation results during start-up process at no-load condition: (a) Method I, (b) Method II, and (c) RCMV-MPC. ······················································································· 180 Fig. 6.12 Simulation results during speed-reverse process at no-load condition: (a) Method I, (b) Method II, and (c) RCMV-MPC.··············································································· 181

xiii

Fig. 6.13 Photograph of a low power CSC-fed IM drive prototype: (A) three-phase power supply, (B) filter inductor, (C) CSR-side capacitor, (D) CSR and CSI, (E) DC-choke, (F) CSI-side capacitor, (G) induction motor, (H) DC motor, (I) DC load, and (J) oscilloscopes. ························ 182 Fig. 6.14 Experimental results at 1700rpm and 16.8Nm condition: (a) Method I, (b) Method II, and (c) RCMV-MPC. ··························································································· 184 Fig. 6.15 Experimental results at 180rpm and 2.1Nm condition: (a) Method I, (b) Method II, and (c) RCMV-MPC. ··························································································· 185 Fig. 6.16 Experimental results during start-up process at no-load condition: (a) Method I, (b) Method II, and (c) RCMV-MPC. ·················································································· 186 Fig. 6.17 Experimental results during speed reverse at no-load condition: (a) Method I, (b) Method II, and (c) RCMV-MPC. ·················································································· 187

xiv

List of Tables
Table 2.1 NUMBER OF COMMUTATIONS FOR EACH SWITCHING STATE TRANSITION ······ 64 Table 3.1 SIMULATION AND EXPERIMENTAL PARAMETERS ········································ 81 Table 3.2 STEADY STATE PERFORMANCE OF THREE METHODS FOR COMPARISON ········· 96 Table 4.1 SPACE VECTOR SEQUENCES FOR SIX-PULSE WAVEFORM ···························· 110 Table 4.2 SPACE VECTOR SEQUENCES FOR EIGHT-PULSE WAVEFORM························ 113 Table 4.3 PARAMETERS IN SIMULATION AND EXPERIMENTS ···································· 123 Table 4.4 SIMULATED STEADY STATE PERFORMANCE ············································· 124 Table 4.5 EXPERIMENTAL STEADY STATE PERFORMANCE ········································ 129 Table 5.1 SIMULATION PARAMETERS OF HIGH POWER CSC-FED MV IM DRIVE ············ 142 Table 5.2 SIMULATED STEADY STATE PERFORMANCE ············································· 143 Table 5.3 EXPERIMENTAL PARAMETERS OF LOW POWER PROTOTYPE ······················· 151 Table 5.4 EXPERIMENTAL STEADY STATE PERFORMANCE ········································ 153 Table 6.1 SYSTEM PARAMETERS IN SIMULATION ···················································· 173 Table 6.2 OUTPUT PERFORMANCE ALONG WITH SAMPLING FREQUENCY ··················· 174 Table 6.3 SIMULATION RESULTS OF THREE METHODS FOR COMPARISON ··················· 176 Table 6.4 SYSTEM PARAMETERS IN EXPERIMENTS ·················································· 182 Table 6.5 EXPERIMENTAL RESULTS OF THREE METHODS FOR COMPARISON··············· 183 Table 6.6 EXECUTION TIME OF THREE METHODS····················································· 185

xv

Glossary of Acronyms and Symbols
Acronyms
MV LCI SCR PWM VSI CSI NPC CHB SVM AFE CMV THD SGCT CSR RMS IM CSC TPWM SHE-PWM SVM LUT HPF FOC RCMV AZS NTS MPC FCS-MPC DSP MPPFC MPSPC MPSVPC RCMV-MPC ZOH PF MAPF LPF BSF PLL TDD Medium-Voltage Load Commutated Inverter Silicon Controlled Rectifier Pulse-Width Modulated Voltage-Source Inverter Current-Source Inverter Neutral-Point Clamped Cascaded H-Bridge Space Vector Modulation Active Front End Common-Mode Voltage Total Harmonic Distortion Symmetry Gate Commutated Thyristor Current-Source Rectifier Root Mean Square Induction Motor Current-Source Converter Trapezoidal PWM Selective Harmonic Elimination PWM Space Vector Modulation Look-Up Table High-Pass Filter Field-Oriented Control Reduced CMV Active-Zero-State Nearest Three-State Model Predictive Control Finite Control-Set Model Predictive Control Digital Signal Processor Model Predictive Power Factor Control Model Predictive Switching Pattern Control Model Predictive Space Vector Pattern Control Common-Mode Voltage Reduced Model Predictive Control Zero-Order Hold Power Factor Maximum Achievable Power Factor Low-Pass Filter Band-Stop Filter Phase-Lock-Loop Total Demand Distortion xvi

MPFOC MS-SVM RL LC

Model Predictive Field-Oriented Control Multi-Sampling SVM Load resistor and inductor Inductor and capacitor

Symbols
Voltage Quantities
V v  V  v

Magnitude of phase voltage or DC voltage (V) Instantaneous value of alternating voltage (V) Stationary voltage space vector (V) Rotating voltage space vector (V)

Current Quantities
I i  I  i
Magnitude of line current or DC current (A) Instantaneous value of alternating currnet (A) Stationary current space vector (A) Rotating current space vector (A)

Power Quantities
P Q
Qgp (k + 1)

Active power (W) Reactive power (VAr) Predicted line reactive power at (k+1)th sampling instant (VAr) Line active power (W) DC-side power (W) Line reactive power reference (VAr) Line active power reference (W)

Pg
Pdc
Q
P
* g
* g

RLC Quantities
C

L R


Capacitance ( F ) Inductance (mH) Resistance (  )

Frequency and Phase Angle Quantities
Angle of space vector (rad)  Phase angle difference (rad)  Independent phase angles used to generate selective harmonic elimination PWM waveform (rad) Angular frequency (rad/s)  f Frequency (Hz) xvii

T

Control period or sampling interval ( s )

r r Rs Rr Ls Lr Lm r P  kr R  r

Induction Motor Quantities 

Rotor flux vector (Wb) Magnitude of rotor flux vector (Wb) Stator resistance (  ) Rotor resistance (  ) Stator inductance (mH) Rotor inductance (mH) Magnetizing inductance (mH) Electrical angular frequency of induction motor (rad/s) Number of pole pairs Induction motor total leakage factor Coupling factor Coefficient Transient time constant (s) Rotor time constant (s)

Predictive Controller Quantities
x u

 x  u wcmv

A B   I

State vector Input vector System matrix Input matrix Prediction matrix Prediction matrix Identity matrix Space vector of state variable Space vector of input Weighting factor for common-mode voltage reduction term Weighting factor for average switching frequency reduction term Number of commutations between two switching states State of xth switching device (x = 1, 2, 3, ..., 6) Threshold value of cost function Output value of cost function

wCp Cp
Sx

J g

max

Miscellaneous
m

K



Modualting index Gain value used in active damping function The efficiency of power converter xviii

Superscripts
LP p (x) (y) * lim R op SHE init est ^ Value after a low-pass filter Predicted value Prediction corresponding to xth current space vector of a CSC Prediction corresponding to yth current space vector of a CSC Reference value Limitation value Rated value Optimally selected Following SHE modulation PWM pattern Initial value Primarily esitimated value Estimated value

Subscripts
r i C Lf g s dc cm z (1) (h) n Recitifier side quantities Inverter side quantities Voltage or current of Capacitor Votlage or current of Filter inductor Voltage or current of utility power supply Voltage or current of stator in an induction motor Voltage or current of DC side Common mode Neutral point Fundament frequency component High-order harmonic components nth current space vector of a CSC  -axis component  -axis component d-axis component q-axis component Quantities used for damping Quantities with respect to a sector in a space vector domain Mechanical rotor



 d q damp sec mr

xix

1 Introduction
1.1 Overview and Prospect of Medium-Voltage Motor Drive
The medium-voltage (MV) drives cover power ratings from 0.4MW to 40MW at the MV levels of 2.3kV to 13.8kV. The power rating can be extended to 100MW, where synchronous motor drives with load commutated inverters (LCIs) are often used [1-4]. However, the majority of the installed MV drives are in the 1- to 4MW range with voltage ratings from 3.3kV to 6.6kV [5]. The high power MV drives have found widespread applications in industry. They are used for pipeline pumps in the petrochemical industry [6], fans in the cement industry [7], pumps in water pumping station [8], traction applications in the transportation industry [9], steel rolling mills in the metals industry [10], and other applications [11, 12]. Fig. 1.1 shows a general block diagram of high power MV drives. Depending on the system requirements and the type of the converters employed, the line- and motor-side filters are optional. A phase shifting transformer with multiple secondary windings is often used mainly for the reduction of line current distortion.
L

Ldc

C
Optional Supply Line-side Filter Transformer
-

Cdc
-

Rectifier

DC filter

Fig. 1.1 General block diagram of high power MV drives. In Fig. 1.1, the rectifier converts the utility power supply voltage to a (direct-current) DC voltage with a fixed or adjustable magnitude. The commonly used rectifier topologies include multiphase diode rectifiers, multipulse silicon controlled rectifiers (SCRs), or pulse-width modulated (PWM) rectifiers. The DC filter can simply be a capacitor that provides a stiff DC voltage in voltage source drives or an inductor that smoothes the DC current in current source drives. 1

+

+

L

C
Optional Inverter Motor-side Filter

Motor

The inverter can be generally classified into voltage-source inverter (VSI) and current-source inverter (CSI). The VSI converts the DC voltage to a three-phase AC voltage with adjustable magnitude and frequency whereas the CSI converts the DC current to an adjustable three-phase AC current. A variety of VSI topologies have been developed for MV drives, including twolevel VSI, neutral-point clamped (NPC) inverter, and cascaded H-bridge (CHB) inverter.

1.2 Voltage-Source Inverter Topologies for Medium-Voltage Drives
The VSI-fed MV drives have found wide applications in industry. These drives come with a number of different configurations, each of which has some unique features.

1.2.1 Two-level Voltage-Source Inverter
It is well known that two-level VSI is a dominant converter topology for low-voltage (lower than 600V) drives. This technology has now been extended to MV drives, which are commercially available for the power rating up to a few megawatts [13]. Fig. 1.2 shows a typical two-level inverter topology for MV drives. There are three switching devices in series per inverter branch. The inverter can be controlled by either carrier-based modulation or space vector modulation (SVM) scheme. Two-level VSI has the features as follows. 1) Simple PWM scheme. The conventional carrier-based sinusoidal modulation or SVM scheme can be implemented for the inverter. Only six gate signals are required for the six groups of synchronous switches; 2) Ease of DC capacitor pre-charging. The DC capacitor in the two-level inverter needs only one pre-charging circuit; 3) Provision for four-quadrant operation and regenerative braking. An active front end (AFE) with the same configuration as the inverter can provide four-quadrant operation or regenerative braking. However, there are some drawbacks associated with two-level VSI, including the followings. 1) High dv/dt in the inverter output voltage. The dv/dt is particularly high for two-level inverter employing series connected switches in a synchronous manner, which causes a

2

number of problems such as premature failure of motor winding insulation, early bearing failure and wave reflections; 2) Motor harmonic losses. Two-level VSI in MV drives usually operates at low switching frequencies, typically lower than 1kHz, resulting in a high harmonic distortion in stator voltages and currents; 3) Common-mode voltages (CMVs). The switching action of the rectification and inversion normally generates CMVs [14]. If not mitigated, these voltages would appear on the motor, causing premature failure of its winding insulation.

P+

S1

S3

S5

vdc

A

ia
B

L

R

Cdc

ib

C
S4 S6 S2

ic

o
Load

N

-
Fig. 1.2 Simplified two-level VSI for high-power applications.

1.2.2 Neutral-Point Clamped Voltage-Source Inverter
Three-level neutral-point clamped (NPC) inverter, has found wide applications in high power MV drives [15-17], as Fig. 1.3 shows. On the DC side of the inverter, the DC bus capacitor is split into two capacitors, providing a neutral point Z. The diodes connected to the neutral point, 3

DZ 1 and DZ 2 , are the clamping diodes. When switches S 2 and S3 are turned on, the inverter output terminal A is connected to the neutral point through one of the clamping diodes. The main features of NPC inverter include reduced dv/dt and total harmonic distortion (THD) in its (alternating-current) AC output voltages in comparison with wo-level inverter discussed earlier. More importantly, the inverter can be used in MV drives to reach a certain voltage level without switching devices in series. However, there are still some limitations with NPC inverters, including the followings. 1) Complexity of PWM schemes. Due to the increased number of switching devices, the complexity of PWM scheme is increased, especially in the corresponding SVM scheme; 2) Neutral-point voltage deviation. With a finite value for Cdc1 and Cdc 2 , the capacitors can be charged or discharged by neutral current iz , causing neutral point voltage deviation issue.

P+

S1 S2

Cdc1

DZ 1
vdc
Z

A
B

ia ib ic

L

R

iz

o
Load

DZ 2 S 3
S4

C

Cdc 2

N

-
Fig. 1.3 Three-level NPC inverter.

1.2.3 Cascaded H-Bridge Multilevel Voltage-Source Inverter
Cascaded H-bridge (CHB) multilevel inverter is one of the popular converter topologies used in high power MV drives [18-20]. It is composed of a multiple units of single-phase H-bridge power cells. The H-bridge cells are normally connected in cascade on their AC side to achieve 4

MV operation and low harmonic distortion. In practice, the number of power cells in a CHB inverter is mainly determined by its operating voltage and manufacturing cost. A seven-level CHB multilevel inverter-fed MV drive is illustrated in Fig. 1.4. The phase-shifting transformer is an indispensable device for the CHB multilevel inverter, which provides isolated power supplies for the power cells and line current THD reduction. The CHB multilevel inverter has a number of features, as follows. 1) Modular structure. The CHB multilevel inverter is composed of multiple units of identical H-bridge power cells, which leads to a reduction in manufacturing cost; 2) Lower voltage THD and dv/dt. The inverter output voltage waveform is formed by several voltage levels with small voltage steps; 3) High-voltage operation without switching devices in series: The H-bridge power cells are connected in cascade to produce high AC voltages. There are several drawbacks for CHB multilevel inverter, as follows. 1) High cost of phase-shifting transformer. The multi-winding transformer is the most expensive device in the CHB multilevel inverter-fed drive; 2) High component count. CHB multilevel inverter uses a large number of IGBT modules.

5

N
Power Cell

 = -20

Utility Supply

 = 0
Fuse

Cdc

S BP
Bypass Switch Power Cell

 = 20
Phase-Shifting Transformer

A

B

C

Motor

Fig. 1.4 Seven-level CHB multilevel inverter-fed drive with an 18-pulse diode rectifier.

1.3 High Power Current-Source Converter-Fed Medium-Voltage Motor Drive
The current-source inverter (CSI) technology is well-suited for MV drives. The CSI-fed drive generally features simple converter structure, motor-friendly waveforms, inherent four-quadrant operation capability and reliable fuseless short-circuit protection. Two types of CSIs are commonly used in the MV drives, namely load-commutated inverter (LCI) and PWM inverters. The power rating of the PWM CSI-fed drives is normally in the range of 1-10MW. For a higher power rating up to 100MW, the LCI is a preferred choice.

1.3.1 Load-Commutated Current-Source Inverter
One of the well-known CSI topologies is load-commutated inverter (LCI) [21]. Fig. 1.5 shows the typical LCI configuration for synchronous motor drives. The inverter employs thyristors as switching devices which can just be naturally commutated by the load voltage with a leading power factor. Therefore, the ideal load for LCI is synchronous motors operating at a

6

leading power factor. On the DC side of the inverter, a DC choke, Ldc , is required to provide a smooth DC current, I dc . The LCI-fed motor drive features low manufacturing cost and high efficiency due to the use of low-cost thyristor devices and lack of PWM operation. LCI is a popular solution for very large drives, where the initial investment and operating efficiency are of great importance. The main drawback of LCI drive is its limited dynamic performance. In addition, the power losses in the motor are high due to the large amount of harmonics in stator currents [22].

+

I dc

Ld c 2

U

vdc

V

W

isu isv isw

Synchronous Motor

SM

If
Excitation Control

-

I dc
Ld c 2
Fig. 1.5 LCI for synchronous motor drives.

1.3.2 Pulse-Width Modulated Current-Source Inverter
An idealized PWM CSI is shown in Fig. 1.6. The inverter is composed of six symmetry gate commutated thyristor (SGCT) devices, with reverse voltage blocking capability. The inverter 7

produces a defined PWM current, iwx (x=a, b, c). The CSI normally requires a three-phase capacitor, C, at its output to assist the commutation of the switching devices. Besides, the capacitor also acts as a harmonic filter, improving the load current and voltage waveforms, of which value can be reduced accordingly with the increase of switching frequency.

1 +
S1

S3

S5 iwx ix
L R

A

I dc

vdc

B
C

o
iCx
C

+

( x = a , b, c )

- 2

S4

S6

S2

 -
o

vCx

Fig. 1.6 Simplified SGCT based PWM CSI. The DC current source can be generated by an SCR or PWM current-source rectifier (CSR) with a DC current feedback control. To make the DC current, I dc , smooth and continuous, a DC choke, Ldc , is an indispensable device for the CSR. The CSI-fed MV drive has the following features. 1) Simple converter topology with low component count. The converter topology is very simple. Both CSR and CSI use SGCT devices that do not require antiparallel freewheeling diodes, leading to a minimum component count; 2) Simple PWM schemes. Only six gate signals are required for the six groups of synchronous switches per converter; 3) Motor friendly waveforms. The motor voltage and current waveforms are close to sinusoidal and does not contain any voltage steps with high dv/dt;

8

4) Reliable fuseless short circuit protection. In case of short circuit at the inverter outputs, the rate of rise of the DC current is limited by the DC choke, providing sufficient time for the drive controller to react; 5) Long input and output cables. Due to near sinusoidal input and output waveforms, there are virtually no limit on the length of the cables connecting the transformer to the rectifier or connecting the inverter to the motor; 6) Four-quadrant operation and regenerative braking capability. The power flow in the CSI drive is bidirectional.

1.3.3 Configuration of High Power Current-Source Converter-Fed MediumVoltage Motor Drive
1.3.3.1 CSI-Fed MV Motor Drive with Single-Bridge PWM CSR Fig. 1.7 shows a typical CSI-fed drive using a single-bridge PWM CSR as the active front end. The rectifier and inverter have an identical topology using SGCTs. With the GCT voltage rating of 6000V and two GCTs connected in series in each of the converter branches, the drive is capable of operating at the utility power supply voltage of 4160V, which is line-to-line root mean square (rms) value.
1

I dc Ld c 2

3

S r1

Sr 3

Sr 5

Si1

Si 3

Si 5

vgx
Optional

Lf

igx

iwrx
A
B

iwiz
U V
C

isz

g
iCrx
Isolation Transformer
Cr
+

Motor
W

iCiz
Si 2

+

vCrx

-

Sr 4

Sr 6

Sr 2

Si 4

Si 6

Ci

vCiz

-

Standard AC Motor

( x = a , b, c )
PWM CSR

I dc
2

Ld c 2

4

( z = u , v, w)
PWM CSI

Fig. 1.7 A typical 4160V CSI-fed drive with a PWM rectifier and inverter. The illustrated configuration consists of an MV induction motor (IM), three-phase filter capacitors, and a full rating back-to-back PWM current-source converter (CSC). The PWM CSR 9

is connected with the PWM CSI through a DC choke. The DC choke, Ldc , is required to smooth the DC current. The choke usually has a magnetic core with two coils, one connected in the positive DC bus and the other in the negative bus. Such an arrangement is preferred in practice for CMV reduction [23]. To limit DC link current ripples to an acceptable level (lower than 15%), the size of the DC choke is normally around 1pu. The line side of the CSR can be equivalently represented by a line inductance, L f , which denotes the total inductance between the utility power supply and the rectifier, including the equivalent inductance of the utility power supply, the leakage inductance of an isolation transformer if any, and the inductance of a line reactor for line current THD reduction. The line inductance, L f , is normally in the range of 0.1 to 0.15pu. As shown in Fig. 1.7, a number of switching devices can be connected in series in each phase leg to meet the MV level requirements. The input and output three-phase AC capacitors, Cr and Ci , help the switching devices' commutations and filter out current harmonics. The capacitor size is mainly dependent on the rectifier and inverter's switching frequencies. The value of capacitor is normally in the range of 0.3 to 0.6pu for high power MV level applications with a switching frequency below 1kHz. Since the rectification and inversion processes in the CSC-fed drive generate CMVs. If not mitigated, the CMVs would appear on the motor, causing premature failure of its winding insulation. The problem can be effectively solved by introducing an isolation transformer and grounding the neutral of the inverter filter capacitor as shown in Fig. 1.7. In doing so, the motor is not subject to any CMVs. Therefore, this kind of CSI-fed drive is suitable for retrofit application, where standard AC motors are usually used. However, isolation transformer increases the total cost of the whole system. On the other hand, some CMV reduction schemes can be applied to reduce the peak value of CMV through appropriate deployment of the switching states at both CSR and CSI sides, which reduces the dependency on isolation transformer.

10

1.3.3.2 CSI-Fed MV Motor Drive with a Dual-Bridge PWM CSR Fig. 1.8 illustrates a 4160V CSI-fed drive with a dual-bridge PWM rectifier, in which a phase shifting transformer is utilized to cancel the 5th, 7th, 17th, and 19th harmonics. The rectifier uses selective harmonic elimination (SHE) modulation scheme to eliminate the 11th and 13th harmonics. The line current waveform is virtually sinusoidal [24, 25]. This drive is suitable for applications that require extremely low line current distortion. However, a bulky phase shifting transformer is indispensable in the system, which increases the footprint, and adds the initial cost.
I 1 dc
( x = a , b, c )

Ld c 2

3

Utility Grid

iwrx1
A1 B1

iCrx1
Cr 1

+

C1
U V

iwiz

isz

- vCrx 1 iwrx 2
A2 B2

Motor
W

iCiz

+

Ci
C2

v- Ciz

Standard AC Motor

iCrx 2

+

Phase Shifting Transformer

Cr 2

- vCrx 2

I dc
PWM CSR
2

Ld c 2

4

( z = u , v, w)

PWM CSI

Fig. 1.8 4160V CSI-fed drive with dual-bridge PWM rectifier for sinusoidal inputs. 1.3.3.3 Transformerless CSI-Fed MV Motor Drive Fig. 1.9 shows the configuration of a transformerless CSI-fed drive, where an integrated DC choke is used. The choke can provide two inductances, a differential inductance, Ldc , that is inherently required by the CSI-fed drive and a common-mode inductance, Lcm , that can block the CMV. The use of the integrated DC choke leads to the elimination of isolation transformer, resulting in a significant reduction in manufacturing and operating costs. To ensure that the motor is not subject to any CMVs, the neutral points of the line- and motor-side filter capacitors are connected together directly or through a small RL network. However, the use of the integrated DC choke increases the complexity of manufacturing.

11

1

I dc Ld c 2

Lcm

3

No Isolation Transformer
vgx
g

S r1

Sr 3

Sr 5

Lf

igx

( x = a , b, c ) iwrx

Si1

Si 3

Si 5 iwiz

( z = u , v, w) isz

Standard AC Motor

A
B

U V
C

Motor
W
iCiz Si 2
+

iCrx

+

Cr
g

- vCrx

Sr 4

Sr 6

Sr 2

Si 4

Si 6

Ci

- vCiz

o

I dc
PWM CSR
2

Ld c 2

4

PWM CSI

Fig. 1.9 A transformerless CSI-fed MV motor drive with an integrated DC choke.

1.3.4 Technical Challenges
The technical challenges for CSC-fed MV drives differ in many aspects from those for lowvoltage AC drives. These challenges can be generally divided into three groups: the challenges related to CSR, the challenges associated with CSI, and the general drive system requirements. 1.3.4.1 CSR-Side Challenges 1) Line current distortion. Though there are large capacitors in CSR to reduce line current THD, line current drawn by CSR is normally distorted, and it also causes notches in voltage waveforms. The distorted current and voltage waveforms can cause numerous problems such as nuisance tripping of computer-controlled industrial processes, overheating of transformers, equipment failure, computer data loss, and malfunction of communications equipment. Nuisance tripping of industrial assembly lines often leads to expensive downtime and ruined product. Hence, the quality of line current needs to be improved; 2) LC resonance suppression. The large capacitors in CSR form LC resonant circuits with the filter reactors. The LC resonant modes may be excited by the harmonic voltages in utility power supply or harmonic currents produced by CSR. Since the utility power supply at MV level normally has very low line resistance, the lightly damped LC

12

resonances may cause severe oscillations or over-voltages that may destroy the switching devices and other components in CSR; 3) Line power factor. High line power factor is a general requirement for all electric equipment, which is especially important for high-power MV drives. However, due to the large capacitors in CSR, it is always an issue to maintain a maximum possible power factor for CSR at different operating points. 1.3.4.2 CSI-Side Challenges 1) Limited dynamic performance. This is mainly due to the use of a DC choke and a threephase capacitor connected at the output of CSI. To smooth DC current, a DC choke is inevitable in CSI-fed drives. Since the magnitude of inverter output current is not directly regulated by modulation index instead of adjusting DC current through CSR, the DC choke will limit the changing rate of DC current. However, more advanced control schemes can be applied into CSR in order to improve the dynamic response of DC current regulation. On the other hand, the large capacitor (normally 0.3pu to 0.6pu) at the output of CSI also has significant influence on the transient process of CSI-fed drives. Since the stator currents are not directly controlled by the PWM currents of CSI, the transient process of capacitor currents will lead to large torque overshoot and stator current oscillation in CSI-fed drives. Unfortunately, traditional FOC for CSI-fed IM drive totally neglects the transient responses of the capacitor currents, which makes the regulation of the stator currents during transients more difficult; 2) Reduction of electromagnetic torque pulsations. Though the large capacitor at the outputs of CSI improves the waveforms of stator voltage and current, the reduction on torque pulsations is always a noteworthy issue. Torque pulsation may result in shaft failures, couplings and damage of other mechanical equipment, when the natural frequency of the mechanical system coincides with the frequency of the torque pulsations. Better control and modulation schemes, which achieve smaller distortion on stator current, can be developed and applied for CSI to realize smaller torque pulsations; 3) Potential LC resonances. Similar as CSR, the motor-side capacitors constitute resonant modes with the motor leakage inductors as well. Even though some damping effects can 13

be provided by motor winding resistance, the motor-side capacitors still need to be carefully sized, and modulation scheme with reduced low order harmonics is required to be considered at the design stage of CSI-fed drives. 1.3.4.3 General MV Motor Drive System Challenges 1) Common-mode voltage stress. The switching action of CSR and CSI normally generates CMVs. The CMVs are essentially zero-sequence voltages superimposed with switching noise. If not mitigated, they will appear on the neutral of the stator winding with respect to ground, which should be zero when the motor is powered by a three-phase balanced utility supply. Furthermore, the motor line-to-ground voltage, which should be equal to the motor line-to-neutral (phase) voltage, can be substantially increased due to the CMVs, leading to the premature failure of the motor winding insulation system. As a consequence, the motor life expectancy is short-ended; 2) Device switching frequency. The device switching loss accounts for a significant amount of the total power losses in MV drives. The switching loss minimization can lead to a reduction in the operating cost when the drive is commissioned. The physical size and manufacturing cost of the drive can also be reduced due to the reduced cooling requirements for the switching devices. In practice, the device switching frequency is normally around 500Hz for GCT devices. However, in order to fix switching frequency of SVM at a low value, a relatively long sampling period is normally used, which results in the inclusion of low-order harmonics in the PWM waveforms. In the case of SHE modulation, though low-order haromonics can be perfectly eliminated through precalculated switching angles, the flexibility of SHE modulation is very limited, since a new set of switching angles needs to be calculated correnponding to different output frequencies and modulation indexes.

14

1.4 Review on Traditional Modulation and Control Schemes of High Power Current-Source Converter for Medium-Voltage Motor Drive
The development of control techniques for power converters is an ongoing research topic [43-46]. A summary of the most established control techniques is summarized in Fig. 1.10. The classical control schemes include linear and hysteresis control, while the sliding-mode, intelligent and predictive control belong to the advanced control category.
Converter Control Techniques

Hysteresis Control

Linear Control

Sliding Mode Control

Intelligent Control

Predictive Control Deadbeat Control

Direct Torque Control (DTC)

Field Oriented Control (FOC)

Current Control

Fuzzy Logic Control
Artificial Neural Network Based Control (ANN)

Model Predictive Control (MPC)

Direct Power Control (DPC)

Voltage Oriented Control (VOC)

Voltage Control

Hysteresis Based Control

MPC With Continuous Control Set (CCS) MPC With Finite Control Set (FCS)

Fuzzy-ANN Control

Trajectory Based Control

Fig. 1.10 Classification of control techniques used for power converters. The classical control techniques are simple and widely accepted by various power converters. The classical control approach uses cascaded linear PI regulators PWM or SVM. The favorable approach to use classical control scheme with PWM or SVM is its fixed switching frequency. The lower switching frequency operation is an important requirement at MV level. This section mainly introduces the existing traditional control schemes for CSC-fed IM drive and the respective shortcomings of them. First, operating principle and modulation schemes of CSC are presented. Mathematical models of CSI-fed IM drive in stationary or dq-axis synchronous frames are analyzed. Then, the traditional control schemes of CSR and CSI-fed IM drive are classified and discussed. Finally, several methods tackling some special issues in CSI-fed IM drive are introduced. 15

1.4.1 Traditional Modulation Schemes
Various modulation techniques have been developed for PWM CSI, including trapezoidal PWM (TPWM), selective harmonic elimination PWM (SHE-PWM), and space vector modulation (SVM) [26-29]. In a back-to-back PWM CSC system, the CSR and CSI are similar in terms of modulation. Therefore, the above-mentioned modulation schemes can be applied to both of them. SHE-PWM scheme is considered the best in term of THD and therefore is usually used in CSRs with a fixed input frequency of 60Hz. However, in CSIs, due to variable frequency operation, various modulation schemes might be used for different operating frequencies. The simplified diagram of a PWM CSI is shown in Fig. 1.6. The inverter is composed of six SGCT devices. The inverter produces a defined PWM output current iw . At the DC side of the inverter is an ideal DC current source I dc . The switching pattern design for the CSI should generally satisfy two conditions. 1) The DC current should be continuous; 2) The inverter PWM current should be defined by the switching patterns for a CSC. The two conditions can be translated into a switching constraint, that is at any instant of time (excluding commutation intervals) there are only two switches conducting, one in the top half of the bridge and the other in the bottom half. 1.4.1.1 Trapezoidal PWM The principle of trapezoidal PWM for PWM CSI is shown in Fig. 1.10, where the trapezoidal modulation wave is represented by vm and the triangular carrier wave is represented by vcr . Similar to the carrier-based PWM schemes for VSI-fed drive, the gate signal is generated by comparing vm with vcr . However, trapezoidal PWM does not generate any gate signals in the center  3 interval of the positive half cycle and in the negative half cycle of the fundamental frequency. Such arrangements can satisfy switching constraints of CSC.

16

vcr

vm Vm

3 2 3

Vcr



2

t

iw I dc

3 2 3



2

t

Fig. 1.11 Trapezoidal PWM. 1.4.1.2 Selective Harmonic Elimination PWM SHE-PWM technique is an offline modulation scheme that can eliminate a number of unwanted low-order harmonics with a limited number of pulses. In this technique, the switching angles are precalculated and then imported into a digital controller for implementation. In order to achieve a better harmonic profile and to reduce the complexity in finding switching pattern solutions, the calculated pulses are normally arranged in such a way that the derived PWM waveform has a quarter-wave symmetrical shape. In high power applications, where SHE-PWM is usually preferable, low switching frequency is needed to reduce the switching losses. Therefore, five or seven switching angles per quarter of one cycle are preferred. In the case shown in Fig. 1.11, five pulses are employed per half cycle. This figure shows a typical SHEPWM pattern that satisfies the switching constraint of CSC. There are five pulses per half cycle with five switching angles in the first quarter. However, only two out of the five angles, 1 and

 2 , are independent. Given these two angles, all other switching angles can be derived.

17

iw

2


3

- 1

I dc

0

1


6


3

2 3



2

t


3

- 2

Fig. 1.12 Five-pulse SHE PWM pattern for CSC. The main disadvantage of SHE-PWM is a lack of flexibility due the offline calculated set of angles only valid at a certain modulation index. In practice, SHE-PWM is normally used with a fixed modulation index. If variation of the modulation index is needed, the solutions for all the required modulation indices have to be calculated offline and stored in a look-up table (LUT) with their set of angles. This adds more complexity to the modulation scheme implementation and it is not practical in real applications. Moreover, the calculation of SHE-PWM angles with a large number of pulses per fundamental cycle sometimes involves transcendental equations that have no solutions, which prevents SHE-PWM from being applied to a full frequency range. 1.4.1.3 Space Vector Modulation Similar to VSC, CSC can also be controlled by SVM scheme. A typical space vector diagram    for a CSC is shown in Fig. 1.12 (a), where I1 to I 6 are active-state vectors and I 0 is the zerostate vector. The active-state vectors form a regular hexagon with six equal sectors, whereas the  zero-state vector I 0 lies at the center of the hexagon.
* The desired three-phase output current of CSC can be expressed as a reference vector I w * can be rotating counter clockwise in the space-vector plane. For a given length and position, I w

synthesized by three nearby stationary vectors, based on which the switching states can be selected and gating signals for the switches can be generated. The inverter output frequency * corresponds to the rotating speed of I w , and the magnitude of the output current can be adjusted * * by the length of I w . The ratio between the magnitudes of I w and the DC link current I dc is the
* modulation index m of the inverter. The angle  w is defined as the phase displacement between

18

the reference vector and  -axis of the space vector plane. As shown in Fig. 1.12 (b), the * reference vector I w can be synthesized by the adjacent vectors based on the ampere-second * balance principle. With a sufficiently small sampling period Ts , the reference vector I w can be * considered constant during Ts . Under this assumption, the reference vector I w can be    synthesized by vectors I1 , I 2 and I 0 . The ampere-second balancing equation can be given by

*    Iw  Ts = I1  T1 + I 2  T2 + I 0  T0    Ts = T1 + T2 + T0
The vector dwelling time can be derived by solving (1.1)

(1.1)

T1 = m  sin ( 6 - sec )  Ts  m  sin ( 6 + sec )  Ts T2 = T = T - T - T  0 s 1 2

(1.2)

where sec is the displacement angle of the reference vector within a certain sector. Therefore, its value is in the range of - 6  sec <  6 . Once the vector dwelling time are calculated, the vector sequence in a sampling period needs to be determined for the generation of PWM pulses. Different sequence patterns can be generated, however, the selection of the sequences are associated with different switching frequencies and harmonic profiles. One of the most widelyused sequences is called a three-segment sequence. The switching pattern generated with this sequence has the advantage that the transition from one sector to another requires only one switching action. Hence, in each sampling period, three switch-on and three-switch-off actions happen, which is equivalent to three full device switching actions. Therefore, if the sampling frequency f s is equal to 1 Ts , the corresponding device switching frequency f sw is half of f s . Though SVM, as an online modulation scheme, possesses a lot of merits, its performance in high power CSC is limited by a relatively long sampling period, due to the requirement on low * switching frequency. Since it is inaccurate to consider that the location of I w is fixed during the whole sampling period, the resulting output PWM waveform contains low-order harmonics,

19

such as 5th and 7th order harmonics, which heavily influences on the distortion of load current, and is not easy to be elimintated. In order to cope with this issue, an improved SVM, called multi-sampling SVM (MS-SVM), * is presented in [30]. In MS-SVM, the angle and the magnitude of I w are updated several times during one sampling period, so the dwell time for each current vector can be adjusted more frequently. Finally, with MS-SVM, the low-order harmonic components in ouput PWM currents can be effectively mitigated. However, MS-SVM has two imperfections. First, MS-SVM involves more chanlleges on realization. When realizing SVM on a digital signal processor (DSP) based platform, only one interruption, normally PWM interruption, is enabled to execute the calculation of control scheme. For MS-SVM, since the calculation of control scheme needs * during one sampling period, more interruptions are to be executed several time to update I w required to be enabled, which on one hand requires DSP with higher performance, and on the other hand introduces the potential risk between several interruptions into realization. Moreover, though MS-SVM can fulfill satisfying steady state performance, its transient responses is still * restricted by the synthesis process. Since the effect of I w is applied through the synthesis * process, which is conducted over the whole sampling period, even if I w can be faster updated in * MS-SVM, I w cannot be directly taken into effect to manipulate the output PWM currents during transient conditions, and the dynamic performance of MS-SVM is still very limited.

20



I3 * Iw  I2


 I0

 I4

Sector III Sector II

* w

 I n0

T2 Ts

 In2
sec

* Iw

 In2

Sector IV

Sector I

 I5

Sector V Sector VI

 I1

 T1 I Ts n1

Sector n

 I n1

 I6
(a)
(b)
Fig. 1.13 SVM scheme: (a) space vector location and (b) vector synthesis.

1.4.2 Traditional Control Schemes of High Power Current-Source Rectifier
The simplified configuration of a CSR is shown in Fig. 1.13, where a CSR is connected to a DC load resistor Rdc through the DC link inductor.

I dc
( x = a , b, c ) igx iwrx

Ldc 2

S r1
A

Sr 3

Sr 5

vgx
g

Rf

Lf

DC Load Resistor

B

+

C

vCrx -
g

Cr

iCrx

Sr 4

Sr 6

Sr 2
Ldc 2

Fig. 1.14 Configuration of a CSR with a DC load resistor.

21

1.4.2.1 Modulation Index Control Fig. 1.14 (a) shows the control block diagram of modulation index control for CSR [31, 32]. The output of the DC current controller is the modulation index mr . Then, the modulation reference vector synchronized to the capacitor voltage angle Cr is generated and sent to PWM modulation stage for generation of switching signals. Since a variable modulation index is needed in the scheme, SVM is normally used in the modulation stage. Fig. 1.14 (b) shows the phasor diagram of the rectifier with modulation index control, where all the voltage and current phasors, such as I g (1) , I wr (1) , and VCr (1) , only represent their fundamental-frequency components. The PWM current I wr (1) is in phase with the filter capacitor voltage VCr (1) while the line current

I g (1) leads the utility supply voltage Vg (1) by the power factor angle  due to the capacitor
current I Cr (1) . However, the leading line-side power factor is a disadvantage of modulation index control.

CSR

vgx
( x = a , b, c )

Rf

Lf

igx

iwrx iCrx Cr

Ldc

I dc
DC Load

vCrx

+

-

Switching Signals

CSR System Control Part

PLL

Cr

GCT Gatings * I wr SVM
(a)

mr

- I dc
PI

+

* I dc

22

I g (1)

I Cr (1)
PF = cos 



Vg (1)
VLf (1)

r = 0

I wr (1)
(b)

VCr (1)

Fig. 1.15 Modulation index control: (a) block diagram and (b) phasor diagram. 1.4.2.2 Delay Angle Control The control block diagram and phasor diagram of delay angle control is shown in Fig. 1.15 [33, 34]. In delay angle control, modulation index is fixed, normally chosen as near unity. Due to a constant modulation index, both SVM and SHE-PWM schemes can be used in it. The delay angle between filter capacitor voltage and PWM current is adjusted to realize the DC current control. As Fig. 1.15 (a) shows, a feed-forward of load DC voltage is added to improve the dynamic performance of delay angle control. In Fig. 1.15 (b), the delay angel control provides a lagging current and improves the line-side power factor, which can compensate part of or even total the leading current imposed by the filter capacitor. However, since the lagging current is variable according to different operating state of CSR, accurate power factor control of CSR cannot be guaranteed with delay angle control.

23

CSR

vgx
( x = a , b, c )

Rf

Lf

igx

iwrx iCrx Cr

Ldc

I dc
DC Load

vCrx

+

-

Switching Signals

CSR System Control Part

LPF
LL VCr

GCT Gatings * I wr SVM

PLL

-
r
acos

+Cr

×

I dc mr
vdcr

3

2

mr  wr

3 LL VCr mr 2

÷
(a)

LPF +

+

-
PI

I dc
+

* I dc


r

I g (1)

I Cr (1)

Vg (1)
VLf (1) VCr (1)

I wr (1)
(b) Fig. 1.16 Delay angle control: (a) block diagram and (b) phasor diagram. 1.4.2.3 Active Damping Method In PWM CSR, the capacitor Cr forms an LC resonant circuit with the filter reactor L f . The LC circuit in a high power CSR is lightly damped due to a very low equivalent line resistance

R f , normally from 0.005pu to 0.01pu, which is the total resistance of the distribution line, filter
reactor and isolation transformer (if any). The LC resonant mode may be excited by the 24

harmonic voltages in the utility power supply and harmonic currents produced by the rectifier. The single-phase equivalent circuits of the two modes of resonance are shown in Fig. 1.16.

Rf
+

Lf

ig
+

Rf
iCr

Lf

ig
+

iCr

vg

res
-
(a)

vCr

vCr

-

Cr

-
(b)

res
Cr

iwr

Fig. 1.17 Series and parallel resonant modes in a CSR: (a) series resonant mode (b) parallel resonant mode. The transfer functions of these two resonant modes can be expressed as
G = s (s) Ig (s) sCr = Vg ( s ) Cr L f s 2 + Cr R f s + 1
Ig (s) 1 = 2 I wr ( s ) Cr L f s + Cr R f s + 1

(1.3)

G = p (s)

(1.4)

Neglecting R f , the resonant frequency of the series and parallel modes can be found as
1 Cr L f . With the capacitor in the range of 0.3 and 0.6pu and the filter reactor between 0.1 and

0.15pu, the resonant frequency is in the range of 3.3 to 5.8pu. With the switching frequency around 500Hz, no matter TPWM or SVM schemes contain 5th and 7th order harmonics, which would be very close to the resonant frequency. Though SHE-PWM can eliminate all the low order harmonics, it cannot suppress series mode resonance as an off-line modulation scheme. It is well known that an LC resonance can be suppressed by adding a physical damping resistor to the resonant circuit. For a CSR, a damping resistor Rdamp can be connected in parallel with the capacitor. However, adding a resistor to the system results in additional power losses and thus is not practical, especially in MV drives. The capacitor voltage feedback or virtual resistor based active damping method is to use the CSR to emulate a damping resistance [31, 32, 35]. The damping current idamp can be calculated as vCr Rdamp and generated by the CSR through 25

adjusting the modulating index dynamically. In fact, this method is essentially a capacitor voltage feedback process. The control block diagram is shown in Fig. 1.17.

I wr

Vg

+

-

1 R f + sL f

Ig + - -

1 sCr
K

VCr

Fig. 1.18 Block diagram of capacitor voltage feedback based active damping method. where the gain K is just equal to 1 Rdamp , which increases the damping ratio and suppresses both series and parallel mode resonances. This active damping method is normally associated with the modulation index control of CSR. The block diagram is shown in Fig. 1.18, which is conducted in dq-axis synchronous frame, respect to capacitor voltage. The fundamental component of vCr becomes a DC component in the synchronous frame, which is eliminated with a high-pass filter (HPF) to avoid influence on the DC current control. The remaining signal represents the high frequency harmonic voltages vCr ( h ) in the synchronous frame. The calculated damping current idamp is normalized to the DC current and converted into the damping modulation index mr' . The damping modulation index mr' is summed with the modulation index mr for DC current control in the SVM scheme. Due to variable modulation index required, SVM with switching frequency of several hundred Hz is preferred for this method. However, the virtual resistor based active damping method still suffers from some problems, which can be classified as modulation index saturation, virtual damping resistance selection and degraded transient response [35].

26

( x = a , b, c ) vgx Rf

CSR

Lf

igx
+

iwrx iCrx
Cr

Ldc

I dc
DC Load

vCrx

-

Switching Signals

CSR System Control Part

PLL

GCT Gatings

Cr
abc
vCr ( h )

dq

HPF

1 Rdamp

iR

÷

m'

* I wr
SVM

mr

-
PI

I dc +

* I dc

Stationary Frame

Synchronous Frame

Fig. 1.19 Block diagram of modulation index control with active damping method.

1.4.3 Traditional Control Schemes of High Power Current-Source Inverter-Fed Induction Motor Drive
The field-oriented control (FOC) is mostly applied control scheme for high power CSI-fed MV IM drive [36, 37]. The field orientation usually denotes the rotor flux orientation, which is extensively used in AC motor drives. The rotor flux orientation is achieved by aligning the d axis of the synchronous reference frame with the rotor flux vector r . In dq-axis synchronous frame, the stator current is resolved into two components along the dq-axes. The d-axis current, I sd , is referred to as flux-producing current while the q-axis current, I sq , is the torque-producing current. In the field-oriented control, I sd is normally kept at its rated value while I sq is controlled independently. The FOC scheme for high power CSI-fed IM drive is implemented with three feedback control loops, one for the rotor mechanical angular speed mr , one for the rotor flux magnitude

r , and another for the DC current I dc . The dq-axis inverter PWM current references can be
given by

27

* *  I Cid + I sd  I= wid  * * I Ciq + I sq  I= wiq 

(1.5)

where I Cid and I Ciq are the dq-axis capacitor currents, which are given by

dV  = I Cid Ci sd - eCiVsq   dt  dV I = Ci sq + eCiVsd Ciq  dt 

(1.6)

The first term on the right-hand side of the equation represents capacitor transient current, and the second term is the steady-state current. To reduce the sensitivity and noise caused by the derivative terms, the effect of the capacitor transient response on the drive dynamic performance may be neglected. (1.6) can be simplified as
* *  -eCiVsq + I sd  I wid =  * * =   I wiq eCiVsd + I sq

(1.7)

* Since the magnitude of CSI-side PWM current reference vector, I wi , is proportional to the

DC current, the DC current reference can be calculated as

* = I dc

(I ) + (I )
2 * wid

2 * wiq

mi

(1.8)

* The angle of CSI-side PWM current reference vector,  wi , is the sum of rotor flux angle,  Fr ,

and  i , where  Fr can be obtained from the rotor flux estimator, and  i can be determined by
* *  i = tan -1 ( I wiq I wid )

(1.9)

Normally, SVM scheme is used under low output frequency condition. Whereas, SHE-PWM scheme is selected at high output frequency condition.

28

Ldc 2 Ldc 2

I dc

CSI
+

iwiz
+

isz
-

( z = u , v, w)
M

vdci -
Ci
Switching Signals

vCiz

Speed Sensor
CSI-fed IM Drive
Control Part

vCiz
GCT Gatings
* I wi

mr
^Fr 
VCiq

abc/dq
VCid

I dc mi
I
* dc

SVM
*  wi

LPF LPF
^Fr 
LP VCid

+

+ i
* dc

LP VCiq

isz

mi I =
LP -eCiVCiq +

x2 + y 2 y  i tan -1 = mi x

^r  ^  Fr
LP

Current Model Rotor Flux Estimator

mr

e

+ eCiVCid
* + I sq

* + I sd

÷
PI

^r KT 

PI

^r - 

- mr
+
* mr

r* +

Fig. 1.20 Block diagram of FOC scheme for CSI-fed MV IM drive.

1.4.4 Traditional Common-Mode Voltage Reduction Method
To reduce the peak value of CMV, various reduced CMV (RCMV) PWM schemes have been proposed for CSC, which can mainly be categorized into three groups, nonzero-state SVM [38], zero-state selection SVM [39, 40], and coordinated SVM for both CSR and CSI [41].

29

1.4.4.1 Nonzero-state SVM Two types of nonzero-state SVM schemes has been proposed for CSC, namely active-zerostate (AZS) modulation and nearest three-state (NTS) modulation. AZS modulation maintains the sector divisions and active space vectors as in traditional SVM, but replaces the zero vectors by two opposing active vector. Fig. 1.20 shows the principle of AZS modulation in Sector I with the leading adjacent space vector and its opposite one used to produce zero-state vector effect.

j
T2 Ts

 I 2 [1, 2]

 I2

[3, 4]
T1 Ts

T0 2Ts

 I4
 I1



* Iw

T0 2Ts

 I1




* w

Sector I

 I1 [ 6, 1]
Fig. 1.21 Vector synthesis of the AZS modulation methods in Sector I. NTS modulation method employs the nearest three active space vectors to synthesize the current reference. The principle of NTS modulation method is shown in Fig. 1.21.

30

 I 3 [ 2, 3]
B3

j
 I2

B2

[1, 2]
 I2

T3 Ts

 I3

T2 Ts



 I*


T1 Ts


B1

 I1

[6, 1]
Fig. 1.22 Vector synthesis of the NTS modulation method in Sector B2. Although those nonzero-state modulation methods can effectively reduce CMV, they are all subject to some problems, such as the shrink of modulation index range, increased switching frequencies, and output performance deterioration. 1.4.4.2 Zero-State Vector Selection SVM Fig. 1.22 shows that at any given time there exists a zero-state vector, which generates the CMV peak value no larger than half of the capacitor phase voltage. The zero-state vector selection rule is that the zero-state vector producing the lowest CMV among the three zero-state vectors at any sampling period would be selected. Then, the CMVs produced by both activestate and zero-state vectors will be no larger than the half of the capacitor phase voltage. According to this rule, the selected zero-state vectors and the corresponding phase voltages in one fundamental period are also illustrated in Fig. 1.22.

 I1

31

C
VC 2

A

Ta

B

C

A

- VC 2

 I8

 I7

 I9

 I8

 I7

 I9

 I8

 I7

 I9

Fig. 1.23 Selected zero-state vectors in zero-state vector selection SVM in each instant of one fundamental period. Since the zero-state vectors are still used in this method, the issues in nonzero-state vector modulation can be avoided. However, the zero-state vector selection will increase the switching frequency as well. To maintain the switching frequency same as that in traditional SVM, the SVM sequence needs to be rearranged according to the phase displacement angle between filter capacitor voltage and PWM current, which is determined by the operating state of CSC-fed drives. This process increases the complexity of modulation stage design. 1.4.4.3 Coordinated SVM The coordinated SVM method associates the active-state and zero-state vectors of both CSR and CSI, instead of eliminating zero-state vectors or optimal selection of zero-state vector. Just three segment SVM scheme is used in this method. But during every sampling interval, the sequence of two active-state vectors and one zero-state vector will be rearranged according to the magnitude of corresponding CMVs. For instant, at both CSR and CSI sides, the sequences will be rearranged to make the CMVs from large to small order. Then, the largest CMV at CSR side will correspond to the largest one at CSI side and the smallest CMV at CSR side will 32

correspond to the smallest one at CSI side. Hence, the CMV of the whole system can be reduced. Fig. 1.23 shows the flowing chart of sequence determination with reference vector located in Sector I.
Calculation of dwell time (T1 , T2 , T7 ) for CSC
Determine space vector sequence

vcm1 < vcm 2 < vcm 7

vcm1 < vcm 7 < vcm 2

vcm 2 < vcm1 < vcm 7

vcm 2 < vcm 7 < vcm1

vcm 7 < vcm1 < vcm 2

vcm 7 < vcm 2 < vcm1

Vector arrangment    I1  I 2  I 7

Vector arrangment    I1  I 7  I 2

Vector arrangment    I 2  I1  I 7

Vector arrangment    I 2  I 7  I1

Vector arrangment    I 7  I1  I 2

Vector arrangment    I 7  I 2  I1

Fig. 1.24 Flowing chart diagram of optimized sequence arrangement. Though this method can reduce the CMV in the whole system, the sequence change will increase the switching frequency as well. Moreover, the performance of this method is only ensured at high switching frequency condition, even larger than 10kHz. Therefore, this method is not suitable for CSC-fed MV drives.

1.4.5 Technical Challenges
Traditional control techniques impose several technical, operational and implementation challenges as follows. 1) Switched nolinear system. Power electronic systems represent switched nolinear system. For different on-off position combinations of active and passive switching devices, different system dynamics arise. At the same time, Nonlinearities arise, for instance, when motor variables such as electromagnetic torque or stator flux magnitude are directly controlled, in which both quantities are nonlinear functions of currents and flux linkages. For grid-connected converter, real and reactive power are nonlinear in terms of currents and voltages. Besides, current constraints lead to additional nonlinearities, which exasperate the difficulties of designing traditional linear controllers; 2) Multi-input-multi-output (MIMO) system. Power electronics systems are typical MIMO systems. The decomposition of MIMO system control into multiple single-input-singleoutput (SISO) loops and the use of cascaded control loops simplifies the control design. 33

This approach works well when the time constants of the cascaded control loops differ by at least one order of magnitude and while operating at steady-state operating conditions. During transients and faults, however, the different loops often start interacting with each other in an adverse manner, limiting the achievable performance in terms of controller bandwidth and robustness, and complicating the tuning of the control loops; 3) Low control frequency. For low switching frequencies, low control frequencies are normally used in high power MV drives. On one hand, transient response becomes sluggish because of the low-bandwidth modulation stage [44, 47]; On the other hand, control performance degrades, even becomes unstable because of longer control delay [45]. 4) Difficulty of including nonlinear constraints. Including nonlinear constraints such as THD, common-mode voltage minimization, and switching frequency or loss reduction is not straight forward in the design of a traditional linear controller or a modulation stage.

1.5 Review on Conventional Model Predictive Control for CurrentSource Converter
The family of predictive control techniques includes deadbeat predictive control, hysteresis based predictive control, trajectory based predictive control and model predictive control (MPC) [43]. Generally, MPC can be categorized into two groups: MPC with continuous control set and MPC with finite control set. In MPC with continuous control set, the control variable is a continuous voltage or current vector which can be synthesized by a modulation stage using SPWM or SVM [48]. Contrary to MPC with continuous control set, finite control-set model predictive control (FCS-MPC), as an approach to implement MPC for power converters and drives, is to take advantage of the inherent discrete nature of power converters, which has appeared as a simple and promising alternative to control power converters [49]. Since power converters have a finite number of switching states, FCS-MPC optimization problem can be simplified and reduced to the prediction of the system behavior only for those possible switching states. Then, each prediction is used to evaluate a cost function, and consequently, the switching state leading to the minimum cost is selected and generated.

34

FCS-MPC eliminates the need for linear regulators and modulators, which is a nonlinear control method, and provides better suited approach to control power converters while mitigating the aforementioned disadvantages associated with classical control techniques. With an appropriate definition of cost function, several constraints and technical requirements can be incorporated straight forward into the design and operation of controller. One of the best features of MPC is that several control objectives can be fulfilled at the same time as long as they are mathematical functions of the converter switching states. With an appropriate definition of cost function, better control flexibility can be achieved with the optimization of several control objectives for power converters. The cost which is paid to use FCS-MPC is higher computational burden, but the modern digital signal processors (DSPs) can perform large amount of calculations at low cost. In fact, FCS-MPC has been extensively introduced into the control of power converters, especially VSCs. The two main applications are grid-connected rectifier or inverter [44, 50-54] and motor drives [55-58], respectively. Not only two-level VSCs, FCS-MPC schemes for three-phase four leg VSC [59-61] and different kinds of multilevel converters [62-71] have also been proposed. In the following chapters, FCS-MPC will be directly referred to as MPC for simplicity.

1.5.1 Principle of Operation
A simplified control block diagram of MPC applied to power converters and motor drives is presented in Fig. 1.25. The power converter can be of any topology and number of phases, while the generic load shown in the figure can represent an electrical machine, the utility power supply, or any other active or passive load. In this scheme, measured variables, x(k ) , are used in the model to calculate predictions, x p (k +1) , of the controlled variables for each of the n possible actuations, that is, switching states, voltage or current vectors. These predictions are evaluated using a cost function, which involves the reference values, x* (k ) , and restrictions. Finally, the optimal actuation is selected and applied to the converter. There are four key attributes of MPC, which can be summarized in the following.

35

x (k )

*

Cost function minimization for i = 1, 2,..., n

Switching signals

Load
Measurements

x(k )

x p ( i ) (k + 1) (i = 1  n)

Prediction model

n
Space Vectors

Fig. 1.25 Generalized control block diagram of MPC for power converters. 1.5.1.1 Dynamic Model MPC incorporate a dynamic model of the system to be controlled. Let x   nx denote the state vector of the system. Starting from the current state, the dynamic model enables MPC to predict the sequence of future system states and outputs for a given sequence of manipulated variables. The dynamic evolution of the system can be described in continuous-time domain by state-space representation

 (t ) Ax(t ) + Bu(t ) x =   y (t ) = Cx(t )
with the system matrix, A , input matrix, B , and output matrix, C .

(1.10)

Most MPC schemes are formulated in discrete-time domain, using a constant sampling interval, Ts . The manipulated variable is restricted to changing its values only at the discrete sampling instants, that is the time instants, t = kTs , where k   denotes the time steps. For the continuous-time state-space model (1.10), the discrete-time representation can easily be computed through different discretization methods. The discrete-time representation can be given as

= 1) x(k ) + u(k )  x( k +  y (k ) = Cx(k )
36

(1.11)

The matrices,  and  , can be computed from their continous-time counterparts; The output matrix, C , remains the same when deriving the discrete-time system representation. 1.5.1.2 Constraints In power electronics systems, the switch position of the converter constitutes the manipulated variable, which is constrained to a finite set of integers. A single-bridge CSC, for instance, has nine swithing states. This characteristic can be captured by the input constraint

u(k )  
 denotes a set of constrained inputs for a CSC.
1.5.1.3 Minimization of Cost Function

(1.12)

The control objectives are translated into the cost function, which maps the sequences of future states, outputs, and manipulated variables into a scalar cost value. The cost function facilitates the assessment and comparison of the predicted impact the different sequences of manipulated variables have on the system. This enables MPC to choose the most suitable scenario, which is the one that minimizes the value of the cost function. A general definition of the cost function is

J ( x(k ), U= (k ) )

k + N p -1 l =k

  ( x(l ), u(l ) )

(1.13)

which is the sum of the state costs (or weighting functions)  (, ) over the finite horizon of the time step, N p . The stage cost penalizes the predicted system behavior, such as the deviation of controlled variables from their references and the control effort, such as the switching frequency. The stage cost is required to be nonnegative. The cost function uses the current statevector, x(k ) , and the sequence of manipulated variables uT (k ) uT (k + 1) ... uT (k + N p - 1)   U(k )  =
T

(1.14)

The future states and controlled variables can be predicted over the prediction horizon and penalized accordingly. 37

Minimizing the cost function subject to both the evolution of the discrete-time dynamic system mode over the prediction horizon and the constraints gives rise to a constrained finitetime optimal control problem. The argument of the result is the optimal sequence of manipulated variables, U opt (k ) , which can be given by

U opt (k ) = arg minimize J ( x(k ), U(k ) ) subject to x(l += 1) Ax(l ) + Bu(l ) y (l + 1) = Cx(l + 1) u(l )   = l k ,..., k + N p - 1
(1.15)

Traditionally, the optimization problem has exclusively been solved online, requiring the solution to be available in real time. 1.5.1.4 Receding Horizon Policy The solution to the optimization problem (1.15) yields at time step k an open-loop optimal sequence of manipulated variables, U opt (k ) , from time step k to k + N p - 1 . This policy is referred to as receding horizon control, which is illustrated in Fig. 1.26. In summary, the principle of MPC is that at each sampling instant the manipulated variable is obtained by solving a constrained optimal control problem over a finite prediction horizon. A dynamic model of the system is used to predict future states and controlled variables, using the current state of the system as the initial state. The control objectives are captured by a cost function, which is mininmized subject to the evolution of the dynamic model and system constraints. The solution to the underlying optimization problem yields an optimal sequence of manipulated variables. A receding horizon policy is employed, that is, only the first element of this sequence is applied to the system, and the sequence of manipulated variables is recomputed at the next sampling instant over a shifted horizon. Hence, MPC combines constrained optimal control with the receding horizon policy that provides feedback and closes the control loop.

38

Past

Horizon

y (k )

y* (k )
u opt (k )

U opt (k )

k k +1
(a)

Time

k + Np

Past

Horizon

y (k )

y * (k )
u opt (k )

U opt (k )

k k +1
(b)

Time

k + Np

Fig. 1.26 Receding horizon policy exemplified for the prediction horizon N p = 7 .

39

1.5.2 Conventional Model Predictive Control for High Power Current-Source Converter
As mentioned above, MPC concept has been extensively introduced into the control of VSCs, no matter two-level or multilevel converters in grid-connected and motor drive applications. Up to now, there is not much literature on MPC for CSC. An MPC scheme for CSR, in which the DC current regulation and input power factor control are associated into one cost function, is presented in [72]. The model predictive output voltage control for CSI is proposed in [73], which follows the duality of output current control in VSCs. The model predictive current control for CSI with a simple three-phase RL load is proposed in [74]. However, the performance and characteristics of MPC for CSC have not been studied in detail yet. Besides, the performance of MPC for CSI-fed motor drives has not been covered yet. 1.5.2.1 Conventional MPC for CSR In [72], an MPC scheme for CSR is presented. The prediction model of CSR is calculated based on Caley-Hamilton theorem [75]. The proposed scheme uses the prediction of the line current and the DC current with a prediction horizon of one sampling interval to calculate the best suited switching state for the rectifier that accomplishes the dual purposes of controlling the line power factor and the DC current without any modulation stage. The block diagram of the scheme is illustrated in Fig. 1.26.

40

CSR

vgx

igx

Rf

Lf

iwrx iCrx

Ldc

I dc
DC Load

( x = a , b, c )

vCrx
Cr
Switching Signals CSR System Control Part

vCrx

GCT Gatings  I op

I dc

p p igx Line Current igx (k + 1) Minimization of I dc (k + 1) DC Current Prediction Prediction Cost Function

Fig. 1.27 Block diagram of MPC for CSR. The cost function used here is given by
* p g (k ) Qgp (k + 1) + Wdc  I dc (k + 1) = - I dc

(1.16)

where Qgp (k + 1) is the predicted line reactive power at (k+1)th sampling instant, which can be
 * p (k + 1) are the DC calculated based on the predicted line current vector, igp (k + 1) . I dc and I dc

current reference and the predicted DC current, respectively. Though this scheme can realize DC current regulation and reactive power control to an extent, it has two major shortcomings. The first is that the line power factor cannot be regulated accurately. Since the compromise between DC current regulation and reactive power control, it cannot ensure the maximum possible line power factor under various operating conditions of CSR. The second is that the LC resonance issue is not taken into consideration. In [72], a relatively large line resistor is physically connected to the line reactor in series, which provides some damping effect. However, in CSI-fed MV drives, the equivalent line resistance is just between 0.005pu and 0.01pu, which leads to a lightly damped LC circuit. Hence, an active damping method should be associated into MPC to mitigate the possible line-side resonance.

41

1.5.2.2 Conventional MPC for CSI [73, 74] present MPC schemes for CSI with a simple RL load. Two control objectives have been studied, one is output voltage control and the other is load current control. Both of schemes can be illustrated with the block diagram in Fig. 1.27.

iwz I dc

iz
+

L

R
( z = u , v, w)

o

 I op (k )

C
-

vCz
o

Minimization of Cost Function
 I3  I4  I5
 I 7,8,9
p vCx (k + 1) or

 I2  I1  I6

izp (k + 1)
Prediction

* ^Cz v (k + 1) or ^z* (k + 1) i

Extrapolation

vCz

iz

* * vCz or iz

Fig. 1.28 Block diagram of MPC schemes for a CSI. In Fig. 1.27, C is the filter capacitor at CSI side. R and L are the load resistor and inductor, respectively. Just using the Euler's forward method, the prediction model for output voltage and load current can be obtained based on the state-space model at CSI side. The fourth-order Lagrange method is used to estimate the future output voltage and load current reference at (k+1)th sampling instant, as ^ * (k + x = 1) 4 x* (k ) - 6 x* (k - 1) + 4 x* (k - 2) - x* (k - 3) (1.17)

where x* can represent either output voltage reference or load current reference. The cost function used for three-phase references tracking can be given by
g (k + 1) =
* * * p ^u ^v ^w ^w x (k + 1) - xup (k + 1) + x (k + 1) - xvp (k + 1) + x (k + 1) - x (k + 1)

(1.18)

42

* ^u where x , v , w ( k + 1) denote either three-phase output voltage references or load current references

at (k+1)th sampling instant; xup,v , w (k + 1) represent either three-phase predicted output voltages or load currents at (k+1)th sampling instant. Moreover, as one of nonlinear constraints, switching frequency reduction is also associated into the final cost function in [73, 74] with a term related to the number of commutations between two switching states introduced. So the final cost function can be obtained as
g ' (k ) = g (k ) + Wsw  C p (k , k - 1)

(1.19)

where Wsw is the weighting factor to involve number of commutations into the cost function; C p is the number of commutations between the possible switching state for kth sampling interval and the applied one at (k-1)th sampling instant. Though model predictive output voltage and load current controls have been proposed for CSI, they are only conducted with a three-phase RL load, not specified for motor drives. Hence, the performance and the characteristics of MPC for CSI-fed motor drives are deserved to be investigated and analyzed. In [73, 74], only simulation results are provided, in which there is no calculation delay. However, in practical implementation, the calculation delay always exists. So how to compensate the influence of calculation delay on control performance needs to be investigated further. In addition, only switching frequency reduction has been introduced into the cost function as a nonlinear constraint. But there are more other control constraints for CSIfed MV drives, such as CMV reduction and DC current minimization. Hence, how to solve these issues through MPC based approach is also a challenge to be coped with.

1.5.3 Technical Challenges
Despite the simple and attractive nature of MPC scheme, several technical challenges still exist in the state-of-the-art research, which includes, but not limited to, as follows. 1) Accurate modeling of power converters. The accurate continuous and discrete-time modeling of power converters is the foundation of achieving high performance control; 2) Appropriate selection of cost function and weighting factors. Different variables can be included in a single cost function. Since some variables have completely different values, 43

even different physical natures than others, mainly because they are expressed in different units, this can lead to coupling effects or changes in the relative importance of one variable over the other in the cost function. A simple way to address this issue is to include a coefficient or weight factor for each variable in the cost function. At the present state-of-theart, the coefficients of the cost function are determined by empirical procedure. There is no analytical or numerical solution proposed yet to obtain an optimal solution for weighting factor. This challenge is an open research topic for future contributions to MPC scheme; 3) Control delay compensation. In the real-time implementation of MPC scheme, the large number of online calculations introduce a considerable time delay in the actuation. The computational delay deteriorates the performance of the system if it is not considered in the design stage of the controller; 4) Variable switching frequency nature. Since there is no linear modulation stage and switching state is selected according to minimization of a cost function in MPC scheme, switching frequency is normally variable with the operating state of power converter. The variable switching frequency increases the complexity of output filter design. Hence, to keep switching frequency constant or limit it in a defined range is always a challenge for MPC scheme; 5) Enhancement of robustness. Like in all control theories, measurement noise and parameter uncertainty (or variability under operation) can degrade the control system performance and even affect system stability. This is also true for MPC scheme. A theoretical approach or analysis in relation to the robustness of MPC scheme of power converters and drives is still a possible field of research and development.

1.6 Objectives of Dissertation
The target application for this proposal is high power CSI-fed MV drives. As summarized in Fig 1.28, the objectives for this proposal are twofold: the first one is to investigate the challenges in high power CSC-fed MV drives through MPC approach for better performance; and the second one is to investigate the challenges of MPC scheme itself.

44

Objectives of proposed research

High power CSC-fed MV motor drives

Investigation of challenges in CSC-fed MV drives through FCS-MPC

Investigation of challenges in FCS-MPC

Fig 1.29. Objectives of proposed research.

1.6.1 Investigation of Challenges in High Power Current-Source Converter through Model Predictive Control
The first direction of the proposed research is to investigate the challenges in high power CSI-fed MV drives through MPC approach. The intention of this work is to introduce the advantages of MPC such as better dynamic performance, intuitive concept, and easy involvement of nonlinear constraints into control design of CSI-fed MV drives to obtain better output performance. Some sub-objectives can be summarized as follows. 1) Continuous- and discrete-time modeling of CSR and CSI-fed MV drives. The optimal control actions of MPC scheme are mainly based on the model of plant. A poor modeling of the plant will lead to an inferior control performance. The continuous-time models should be converted to discrete-time with a suitable method such that control delay and prediction horizon can be incorporated. Hence, accurate modeling of different control variables in terms of converter switching states is crucial; 2) Development of efficient MPC schemes for CSR. The CSRs in CSI-fed MV drives play a vital role in regulating DC currents and satisfying utility codes. This objective is specified to 45

design efficient MPC schemes such that the control requirements of CSRs such as DC current regulation, lower line-side current THD, maximum possible power factor, and mitigation of LC resonance can be fulfilled simultaneously; 3) Completion of motor-side MPC schemes for CSI-fed MV motor drives. The development of model predictive motor control methods for CSI-fed MV drives is set as an objective as well. This objective is specified to obtain better dynamic performance of CSI-fed MV drives with MPC schemes, especially better better stator current and electromagnetic torque responses during transients; 4) Investigation of MPC based CMV reduction method for CSI-fed MV drives. The reduction on CMV, as one of general requirements of CSI-fed MV drives, has been discussed in many academic works. But most of the existing methods realize the CMV reduction through the modification of SVM scheme and belong to linear control methods. Hence, this objective is defined to develop a MPC based CMV reduction method for CSI-fed MV drives to achieve better CMV mitigation performance; 5) Reduction on switching frequency. Switching frequency is always a big concern for high power MV motor drive. Conventional MPCs normally leads to a high switching frequency of power converter due to the use of high sampling frequency. Hence, in this study, some effort will also be paid on further reducing average switching frequency of MPC schemes, and makes the final switching frequency meet the requirement (normally lower than 1kHz) of high power MV motor drive.

1.6.2 Investigation of Challenges in Finite Control-Set Model Predictive Control
MPC scheme is anticipated to be one of next generation control tools, and thus considered as the secondary subject matter of this research. 6) Simiplification of calculation process. Both prediction process and minimization of cost function in MPC involve a bunch of calculation. Though some research results state that multi-step prediction process can improve output performance, and even reduce average switching frequency in comparison with conventional one-step prediction, multi-step prediction operation can result in exponential increase on calculation burden, which 46

complicates the realization of MPC. Hence, in this research, only one-tep prediction is used, but no matter output performance or switching frequency of MPC in this study will compete that of multi-step prediction; 7) Investigation on fixing switching frequency of CSC at a constant value in steady state. Conventional MPC usually results in variable switching frequency due to loss of modulation stage, which is not helpful for designing and sizing filters, especially at rectifier side. In this research, improvements on MPC will be conducted to fix the switching frequencies of CSC at a constant value in steady state operation, but still keep superior dynamic performance; 8) Weighting factor selection issue. So far, weighting factor selection is still an open topic in the filed of MPC research. In this research, depending on different proposed MPCs, the relationship between weighting factor value and output performance will be explicitly reveiled as a reference for weighting factor selection. Moreover, the final goal is to eliminate the existence of weighitng factor in MPC, and still achieve additional constraints, which are originally realized by weighting factor; 9) Improvement on robustness of MPC. Because of its dependence on model parameter, MPC can be easily influenced by the variation of parameters. In this research, inaccurate parameter or parameter variation issue need to be coped with in order to increase the robustness of proposed MPC.

1.7 Outline of Dissertation
The research presented in this dissertation is organized into seven chapters. The work carriedout in each chapter is summarized as follows. Chapter 1: The overview of high power CSC-fed MV motor drive is presented. The reviews on traditional control schemes and conventional MPC for CSC in MV motor drives are introduced. The technical challenges existing in high power CSC-fed MV motor drive and conventional MPC for CSC are discussed. Aiming at the technical challenges, the objectives of the proposed research are elaborated; Chapter 2: This chapter reviews commonly used discretization methods to obtain prediction model. The prediction models of CSI with three-phase RL load, CSR with DC resistor, and CSI47

fed IM drive are analyzed, respectively. Besides, generalized MPC approach for CSC is analyzed in this chapter; Chapter 3: Model predictive power factor control (MPPFC) with active damping function for high power CSR is presented in this chapter. The proposed scheme achieves accurate line power factor regulation, ensures CSR working at maximum achievable line power factor under various operating conditions, even with parameter mismatch of input capacitor. Moreover, in order to suppress possible LC resonance at line side, an active damping method is incorporated into this scheme, which effectively damps the possible resonance; Chapter 4: In this chapter, model predictive switching pattern control (MPSPC) for high power CSC is proposed. The proposed scheme combines SHE modulation and MPC together. In steady state operation, CSC follows the switching patterns based on SHE modulation, which keeps a fixed and relatively low switching frequency. On the other hand, during transient process, according to a criteria set in this scheme, the switching pattern of CSC can be governed through MPC approach to further improve its dynamic response, and after transients, the switching pattern will return to follow the waveform of SHE modulation; Chapter 5: Model predictive space vector pattern control (MPSVPC) for high power CSC-fed MV IM drive is presented in this chapter. This scheme can be viewed as an extension of MPSPC, and associated with SVM, which is more suitable for variable frequency application. Both CSR and CSI generate PWM waveforms imposed by SVM in steady state, which maintains a fixed switching frequency at both sides. During transients, through a judging process based on a threshold value, both CSR and CSI can be regulated through MPC approach, which improves dynamic responses, such as torque overshoot, stator, and line current oscillation, in contrast to traditional SVM; Chapter 6: In this chapter, common-mode voltage reduced model predictive control (RCMVMPC) is presented for high power CSC-fed MV IM drive. In comparison with traditional CMV reduction method, this scheme further reduces CMV peak values at various operating conditions. Moreover, since the proposed scheme inherits the essence of MPC, it achieves better dynamic responses as well in contrast to its traditional counterparts;

48

Chapter 7: The conclusions of the proposed research are drawn in this chapter, in which the main contribution of this research are highlighted, and the future work along with the topic of the proposed research is presented.

49

2 Modeling and Generalized Predictive Control Approach of High Power Current-Source Converter for MediumVoltage Induction Motor Drive
Prediction model is the foundation of conducting MPC to power converter. In this chapter, different discretization methods to derive discretized prediction model are presented, and compared with each other. Following the finally selected discretization method, the prediction models for high power current-source rectifier, high power current-source inverter with resistive-inductive load, and high power current-source converter-fed induction motor drive are derived based on their respective continuous dynamic models.

2.1 Derivation of Prediction Model
In order to derive prediction model, continuous dynamic model needs to be discretized first. There are mainly three kinds of discretization methods, namely first-order Euler method, CaleyHamilton method, and Heun's method. A continuous dynamic model in state-space form can be given by
 = Ax + Bu x

(2.1)

where x is the vector of state variables, u is the vector of inputs. An appropriate discretization method should be selected to discretize (2.1), and derive prediction model.

2.1.1 Caley-Hamilton Theorem
A discrete-time state-space equation can be derived when a zero-order hold (ZOH) input is applied to a continuous-time system, which is described in (2.1). Considering a sampling interval of Ts , the discrete-time state-space equation can be given by x p (k + = 1) x(k ) + u(k ) (2.2)

50

where x p (k + 1) is the predicted state variable vector at (k+1)th sampling instant, x(k ) and u(k ) are the state variable vector and the input vector at kth sampling instant, respectively;  and  are the prediction matrices, which can be given by

 = e ATs and  =



Ts

0

e

A (Ts - )

Bd A -1 (  - I ) B =

(2.3)

in which A -1 denotes the inverse of A , and I is an identity matrix.  can be calculated with Caley-Hamilton theorem [76]. Though the method based on Caley-Hamilton theorem is very accurate, the involved calculation is too complicated. For instance, Caley-Hamilton theorem needs to be used to calculate the exponentiation of matrix, in  . Besides, the calculation of  involves with the inverse of A . The elements in A are sometimes variable based on different applications, such as motor drive application in which some elements contain electrical angular speed of motor. The real-time update of  and  introduces too much burden, and occupies longer computational time.

2.1.2 Euler's Method
Euler's Method can be considered as the most direct and simple way to discretize derivative part in continuous dynamic equation [77]. Here forward Euler method is used to discretize (2.1), and the result can be given by

x p (k + 1) - x(k ) = Ax(k ) + Bu(k ) Ts

(2.4)

Based on (2.4) and according to state variable vector and input vector at kth sampling instant, state variable vector at (k+1)th sampling instant can be predicted by x p (k + = 1)  ' x(k ) +  'u(k ) where
' ' =I + Ts  A and = Ts  B

(2.5)

(2.6)

in which ' and  ' are the prediction matrices based on Euler's method. 51

2.1.3 Heun's Method
There is another discretization method called Heun's method, which may refer to the modified Euler's method [77], which can be given by

x c (k + 1) = x(k ) + Ts ( Ax(k ) + Bu(k ) )   p T = xc (k + 1) + s A ( xc (k + 1) - x(k ) ) x (k + 1) 2 

(2.7)

where x c (k + 1) is the predictor-corrector of state variable vector at (k+1)th sampling instant, and x p (k + 1) is still the predicted state variable vector at (k+1)th sampling instant. (2.7) can be rearranged and written in the form as x p (k = + 1) '' x(k ) + ''u(k ) where
'' =I + Ts  A +

(2.8)

  T2 Ts2 ''  A 2 and  =  Ts + s  A  B 2 2  

(2.9)

A and B can be substituted into (2.9), and prediction matrices can be obtained. Though the
calculation burden of this method is heavier than that of Euler method, prediction model can still be real-time updated.

2.1.4 Correlation Between Discretization Methods
The prediction matrix,  , based on Caylem-Hamilton Theorem can be extended as Taylor series, and given by
 = I + Ts  A + Ts2 Tn  A 2 + ... + s  A n + ... 2 n!

(2.10)

It can be found from (2.10) that ' based on Forward Euler method just keeps the first and the second terms of  . On the other hand, '' based on Heun's method keeps the first three terms of  . ' and '' can also be substituted into (2.3), then  ' and  '' can be obtained. From this point of view, it can be concluded that Euler method and Heun' method are both 52

approximations of Caley-Hamilton theorem based method, and Heun's method is more accurate than Euler's method.

2.2 Modeling of High Power Current-Source Converter for Medium-Voltage Induction Motor Drive
2.2.1 Modeling of High Power Current-Source Inverter with Resistive-Inductive load
A typical three-phase high power CSI with RL load is illustrated in Fig. 2.1. An ideal DC current source is connected to the DC side of the CSI for simplicity.

1 +
S1

S3

S5 iwx ix
L R

A

I dc

vdc

B
C

o
iCx
C

+

( x = a , b, c )

- 2

S4

S6

S2

 -
o

vCx

Fig. 2.1 Topology of high power CSI with RL load. 2.2.1.1 Continuous Dynamic Model Hereafter, space vector representation is preferred to being used, of which the definition is

2  j 2 j 4 x =x + jx = ( xa + e 3 xb + e 3 xc ) 3

(2.11)

 where x can represent the space vectors of capacitor voltage and load current; x and x are  the components of x in  -axis stationary frame, while xa , xb , and xc are the components in

three-phase stationary frame. 53

The AC side of the CSI can be expressed at space vector format, and given by

   di v L Ri = + C   dt   dvC   i C = +i w dt 

(2.12)

 where C is filter capacitance, L is reactor inductance, and R is load resistance; vC is the capacitor   voltage vector, iw is the output PWM current vector, and i is the load current vector. The output PWM current vector is defined by nine switching states of the CSI, including six active-state vectors and one zero-state vector, which can be generated by three different switching states. The six active-state vectors can be given by
 = In 2 - j ( ( n -1)  3 6) = I dc e for n 1, 2,..., 6 3

(2.13)

The space vectors of the CSI are illustrated in Fig. 2.2, in which zero-state vector corresponds to three switching states.


 I 4 ( S3 , S 4 )

I 3 ( S 2 , S3 )

 I 2 ( S1 , S2 ) Sector III Sector II  I 7 ( S1 , S4 )    I 8 ( S3 , S 6 )     Sector I I 9 ( S5 , S2 )  Sector IV   Sector V Sector VI I 5 ( S 4 , S5 ) I1 ( S6 , S1 )
 I 6 ( S5 , S 6 )

Fig. 2.2 Diagram of space vectors of a CSC. (2.12) can be written in state-space form, and given by
 = Ax + Bu x

(2.14)

54

 where x is the state variables, equal to  vC  input, equal to iw , A and B are given by

 T  denotes the differentiation of x, u is the i  , x

 0 A= 1  L
2.2.1.2 Prediction Model

-

1 1 C  and B =  C    R - 0 L 

(2.15)

In Section 2.1, three kinds of discretization methods are introduced, in which Euler method and Heun's method impose lighter calculation burden, and can be easily real-time updated. With Euler method, (2.15) can be substituted into (2.6), and the prediction model can be given by x p (k + = 1)  ' x(k ) +  'u(k ) (2.16)

T p  where x p (k + 1) is equal to vCp (k + 1) i (k + 1)  , x(k ) and u(k ) are the state variables and  

the input at kth sampling instant; the prediction matrices can be given by  ' ' 1   11 12 ' =  =  ' '  21 22   Ts L  Ts  ' 11  C   and =  ' = '  TR  21  1- s   L  -
 Ts  C    0

(2.17)

Based on  ' , it can be found that the impact of output current of CSI on load current is not reflected, since the element in the second row of  ' is equal to 0. However, in most applications, load current references are calculated and tracked, which makes the Euler method based prediction model not suitable for prediction control of CSI. On the other hand, with Heun's method, (2.15) can be substituted into (2.9), and the prediction model can be given by x p (k + = 1)  '' x(k ) +  ''u(k ) where the prediction matrices can be given by (2.18)

55

  Ts2 Ts2 R Ts - - 1   ''    11  2CL 2CL C ''    '' = = and =  =   ''  2 2     Ts - Ts R 1 - Ts R - ( L - CR)Ts  21    2 2 L 2CL  L 2L 
'' 11 '' 21 '' 12 '' 22

 Ts   C   2  (2.19)  Ts    2CL  

Based on (2.18) and (2.19), the capacitor voltage vector and the load current vector at (k+1)th sampling instant can be given by   p ''  '' ''  vC (k + 1) = 11  vC (k ) + 12  i (k ) + 11  iw (k )    p  '' '' ''  i (k + 1) = 21  vC (k ) + 22  i (k ) +  21  iw (k ) (2.20)

where the impact of the output current vector of CSI on the load current vector is reflected, and can be used for optimal switching state selection in CSI. Hereafter, Eeun's method is selected, and used to derive the prediction models of high power CSR and CSI-fed IM drive.

2.2.2 Modeling of High Power Current-Source Rectifier
A high power CSR with a resistive load connected at the DC side is shown in Fig. 2.3.
I dc
Ldc 2

 vg

Rf

Lf

 ig

S r1
 iwr

Sr 3

Sr 5

DC Load Resistor

g

+  vCr -
g

Cr  iCr

Sr 4

Sr 6

Sr 2
Ldc 2

Fig. 2.3 Configuration of a CSR with a resistive load. 2.2.2.1 Continuous Dynamic Model As shown in Fig. 2.3, the utility power supply is connected to the input of the CSR through a three-phase LC filter, of which each phase consists of a filter inductor, L f , and a capacitor, Cr . 56

R f denotes the equivalent line-side resistance. A resistive load is connected to the DC side of
the CSR through a DC choke, Ldc . The line side of a CSR can be expressed at state-space format as  r = A r xr + Br ur x
 where x r is the state variables, and equal to  vCr

(2.21)

 T ig   (CSR-side capacitor voltage vector and  T iwr   (utility power supply voltage

 line current vector); u r is the inputs, and equal to   vg

vector and input current vector); the matrices, A r and B r , are given by
  0 Ar =   1 -  Lf 1     0 Cr  and B =  r Rf  1 -  L Lf   f

-

1 Cr    0  

(2.22)

 The value of iwr is limited to six active-state vectors and one zero-state vector as well, as
illustrated in Fig. 2.2. 2.2.2.2 Prediction Model (2.22) can be substituted into (2.18), then, the prediction model for a high power CSR can be given by

x rp (k = + 1)  r x r (k ) +  r u r (k )
where  Ts2 1 - r11 r12   2Cr L f  r = =  T r 21 r 22    - s Lf     r11 r12   and  = = r  r 21 r 22  Ts2     1- 2Cr L f   Ts Cr  Ts2   2Cr L f  T  s   Lf

(2.23)

Ts   Cr  Ts2   2Cr L f   - (2.24)

57

where x r (k ) are the state variables at kth sampling instant; u r (k ) are the inputs at kth sampling instant; x rp (k + 1) are the predicted state variables at (k+1)th sampling instant, and equal to
p T p   + + v k i k ( 1) ( 1) Cr g   . Based on (2.23), the prediction of the line current vector can be

calculated, and used for optimal space vector or switching state selection.

2.2.3 Modeling of High Power Current-Source Inverter-Fed Medium Voltage Induction Motor Drive
The configuration of a high power CSC-fed MV IM drive is illustrated in Fig. 2.4, in which two DC chokes are connected at the DC side of the CSI, and the DC current is regulated by a CSR, which is connected to three-phase utility power supply.
I dc Ldc 2
 vg R f
g

Lf

 ig

 S r1 iwr

Sr 3

Sr 5

Si1

Si 3

Si 5

 iwi

 is

Motor
 iCr
+ vCr

Cr
g

Sr 4

Sr 6

Sr 2

Si 4

Si 6

Si 2

+ vCi
o

 iCi

Ci

Induction Motor

I dc Ldc 2

Fig. 2.4 Configuration of high power CSC-fed MV IM drive. 2.2.3.1 Continuous Dynamic Model The continuous dynamic model of CSI-fed IM drive can be given in state-space form by  i A i xi + Bi ui = x  where xi are the CSI-side state variables, and equal to  vCi (2.25)  T is   (CSI-side capacitor voltage
 T iwi   (rotor

 and stator current vectors); ui are the CSI-side input variables, and equal to    r

flux and output current vectors). The matrices, A i and Bi , are given by

58

  0 Ai =   1  R    in which

1  0   Ci  and B i =  1  kr (1  r - jr ) -       R  -

1 Ci    0 

(2.26)

L L L2 L  = 1 - m , R= Rs + Rr kr2 , kr = m ,   = s ,  r = r  Lr Rr R Ls Lr

(2.27)

where Rs and Rr are stator and rotor resistances; Ls , Lr , and Lm are stator, rotor, and mutual inductances; r is electrical rotor angular speed, and equal to the number of pole pairs, P, times mechanical rotor angular speed, mr . Ci is the capacitance of CSI-side capacitor, which is normally between 0.3pu to 0.6pu. 2.2.3.2 Discretized Prediction Model Substituting (2.26) to into (2.9), the discretized prediction model of CSI-fed IM drive can be given by xi (k= + 1) i xi (k ) + i ui (k ) in which
  Ts2 Ts (Ts - 2  ) - 1   2Ci r t 2Ci  i11 i12    and i = =   2 2    T (T - 2 ) Ts T T  i 21 i 22  - s + s2  - s s 2  1 - 2r   2Ci r t   2     

(2.28)

 Ts2 kr (1 /  r + jr )  - 2Ci r   i11 i12   = i =  i 21 i 22   Ts kr (Ts - 2  )(1 - j r r ) - 2 2r t  

   2  Ts  2Ci r     Ts Ci

(2.29)

where xi (k ) are the state variables at kth sampling instant; ui (k ) are the inputs at kth sampling instant; xip (k + 1) are the predicted state variables at (k+1)th sampling instant, which are equal to 59

p T p   ( 1) ( 1) v k + i k + Ci s   . Based on (2.28), optimal switching state for CSI can be selected

through the prediction process of stator current vector.

2.3 Generalized Predictive Control Approach of High Power Current-Source Converter
2.3.1 Selection of Prediction Horizon
In most existing literature and research, the prediction horizon is just chosen as 1, meaning one-step prediction. The operating principle for the prediction of variables using one-step prediction horizon is shown in Fig. 2.5, assuming that the converter possesses 3 kinds of switching states. The 3 possible switching states lead to 3 predictions for the variable to be controlled. Then, the switching state leading to minimum error between the corresponding prediction and reference is applied at kth instant.
u
Past Sample Ts

First step Ts

Second step Ts

1 1 2
u (k - 1)

u p (1) (k + 1)

u (k )

2

u p (2) (k + 1)

3 3
u p (3) (k + 1)

u*

t (k - 1)

t (k )

t (k + 1)

t (k + 2)

t

Fig. 2.5 FCS-MPC strategy using one-step prediction horizon. In fact, a longer prediction horizon can also be used, meaning multi-step prediction. For every future instant, an optimal switching state will be selected. But just the switching state selected at kth instant will be applied finally. The operating principle for the prediction of variables using two-step prediction horizon is shown in Fig. 2.6, assuming that the converter possesses 3 kinds of switching states, either. The 3 possible switching states lead to 3 60

predictions at (k+1)th instant. But the number of predictions at (k+2)th instant becomes 9 ( 32 ). For a CSC , since there are 9 possible switching states, the number of predictions at (k+2)th instant will be equal to 81 ( 92 ). The multistep or long horizon prediction is just suitable for converters having less number of switching states and will involve large number of calculations. Besides, to realize real time control, a high sampling frequency is usually used for FCS-MPC strategy, normally larger than 10kHz. Under such a sampling frequency, the nowadays digital signal processors are just enough to achieve one-step prediction operation. Hence, that is the reason why one-step prediction is selected by most existing research. In this proposal, the prediction horizon is also selected as 1.
u
Past Sample Ts

First step Ts

Second step Ts

u p (1,1) ( k + 2)
u p (1) (k + 1)

u p (1,2) (k + 2) u p (1,3) (k + 2)
p (2,1) up (k + 2) u (2,2) (k + 2) u p (2,3) ( k + 2) u p (3,1) (k + 2) u p (3,2) ( k + 2)

1 2

u (k )

u p (2) (k + 1)
u p (3) (k + 1)

u* u (k - 1)

3

u p (3,3) (k + 2)

t (k - 1)

t (k )

t (k + 1)

t (k + 2)

t

Fig. 2.6 FCS-MPC strategy using two-step prediction horizon.

2.3.2 Reference Extrapolation Methods
One of the important requirements in FCS-MPC strategy is reference tracking. In a CSC, the tracked reference would be output voltage or load current. When the sampling period Ts is sufficiently small ( <20s ), no extrapolation is required. This implies that the sampling frequency is much higher than the fundamental frequency of the variables to be controlled. When the FCSMPC strategy works with lower sampling frequencies, the references should be extrapolated to 61

(k+1)th instant to effectively minimize the tracking error. There are mainly two kinds of reference extrapolation methods, Lagrange method and vector angle method [45, 59-61]. 2.3.2.1 Lagrange Method A third-order Lagrange methods for one-step ahead extrapolation at (k+1)th instant is given as follows

u (k += 1) 3u (k ) - 3u (k - 1) + u (k - 2)

(2.30)

where the variable u represents either voltage, current or power. To increase the performance of FCS-MPC strategy, a higher-order extrapolation methods can be employed. A fourth-order Lagrange method for (k+1)th extrapolation is given as follow

u (k += 1) 4u (k ) - 6u (k - 1) + 4u (k - 2) - u (k - 3)
2.3.2.2 Vector Angle Method

(2.31)

The other possible approach for the extrapolation is vector angle method. This method is very suitable for the reference vector expressed at space vector format. In this method, during each sampling interval, the change in vector angle of the three-phase variables is considered as the basis for extrapolation. A nth order vector angle extrapolation is given as   u ( k + n) = u (k )e jnTs where  is angular frequency of three-phase variables. Since the better transient performance can be obtained with the vector angle method, this method will be used for reference extrapolation in the following research. (2.32)

2.3.3 Cost Function Flexibility
One of the best features of FCS-MPC strategy is that several control objectives can be fulfilled at the same time as long as they are mathematical function of the converter switching states. As demonstrated in Fig. 2.7, with an appropriate definition of cost function, a better control flexibility can be obtained with the optimization of several control for CSC. The control objectives can be broadly classified as primary and secondary goals. 62

(v
Primary objectives

* C

p (k + 1) - vC  ( k + 1)

) + (v
2

* C

p (k + 1) - vC  ( k + 1)

)

2

or

( i (k + 1) - i

*



p

(k + 1)

) + ( i (k + 1) - i
2



*



p

(k + 1)

)

2

Weighting factor

wcmv
Secondary objectives

wCp
Switching frequency reduction wCp  C p (k , k - 1)

CMV reduction wcmv  vcm (k )

Fig. 2.7 Overview of cost function definition with primary and secondary objectives in CSC. 2.3.3.1 Primary Control Goal For a CSC, there are mainly two kinds of primary control goals, output voltage reference tracking and load current tracking. Since the variables are expressed at space vector format in  -axis stationary frame, the cost function for output voltage reference tracking can be given as
g( = k)

(v

* C

p p * (k + 1) - vC  ( k + 1) ) + ( vC  ( k + 1) - vC  ( k + 1) ) 2

2

(2.33)

The cost function for load current reference tracking can be given as
g (k = )

(i



*

* (k + 1) - ip (k + 1) ) + ( i (k + 1) - ip (k + 1) ) 2

2

(2.34)

The cost functions used here are quadratic functions. Absolute minimization functions can also be used as cost function. But quadratic function can achieve over proportionate control action against the reference tracking [45]. So quadratic functions are chosen and utilized in the following research. 2.3.3.2 Secondary Control Goal To improve the performance of converter or to meet particular technical requirements, some secondary objectives such as common-mode voltage reduction and average switching frequency reduction can be easily included in the cost function as demonstrated in Fig. 2.7.The relative 63

importance of one objective over the other can be set through the weighting factors. Since the primary objective is essential to ensure the proper operation of power converter, the weighting factor for primary objective part is normally selected as 1. The CMV reduction objective is expressed as another cost function as g cmv = (k ) wcmv  vcm (k ) (2.35)

where wcmv is the weighting factor for CMV reduction. vcm (k ) is the possible common mode voltage at kth instant, which is just related to filter capacitor voltage and possible switching state at kth instant. The average switching frequency reduction can be achieved by penalizing the cost function as
gCp ( k ) = wCp  C p ( k , k - 1)

(2.36)

where wCp is the weighting factor for average switching frequency minimization. C p ( k , k - 1) denotes the total number of commutations between the switching state at (k-1)th instant and possible switching state at kth instant. In order to reduce the computational effort, the numbers of commutations have been calculated off-line and store in the digital signal processor, as listed in Table 2.1. Table 2.1 NUMBER TRANSITION OF
Cp
 I1  I2  I3  I4  I5  I6  I7  I8  I9

COMMUTATIONS
 I1  I2  I3  I4  I5

FOR
 I6  I7

EACH
 I8  I9

SWITCHING

STATE

0 2 4 4 4 2 2 2 4

2 0 2 4 4 4 2 4 2

4 2 0 2 4 4 4 2 2

4 4 2 0 2 4 2 2 4

4 4 4 2 0 2 2 4 2

2 4 4 4 2 0 4 2 2

2 2 4 2 2 4 0 4 4

2 4 2 2 4 2 4 0 4

4 2 2 4 2 2 4 4 0

64

2.3.3.3 Selection of Weighting Factor Since the control variables possess different physical nature, they lead to coupling effects and thus the selection of suitable weighting factors becomes tedious. The analytical or numerical procedure for the weighting factor selection is still an open topic for research. In [78], some guidelines are presented for the selection of the weighting factor.

2.3.4 Delay Compensation
The FCS-MPC strategy uses optimization algorithm and thus incurs large number of online calculations. The computer simulations represent ideal case where the time taken to compute these online calculations is zero [45]. According to this approach, the switching state which minimizes the error at (k+1)th instant is selected and applied at kth instant, as Fig. 2.5 shows. However, in the real-time implementation of FCS-MPC strategy, the large number of online calculations introduce considerable time delay in the actuation [45]. As Fig. 2.8 shows, the delay caused by calculation burden will degrade, or even deteriorate the reference tracking performance. Hence, it must be compensated for.

65

u
Past Sample Ts

First step Ts

Second step Ts

1

u* u (k - 1)

2

u p (1) (k + 1)

3

u (k )

u (k + 1) u p (2) (k + 1)
u p (3) (k + 1)

t
Status

Calculation

Calculation

t (k - 1)

t (k )

t (k + 1)

t (k + 2)

t

Fig. 2.8 One-step prediction with calculation delay and without compensation. This calculation delay can be compensated by calculating the cost function for two sampling intervals ahead at (k+2)th instant, and this approach allows one sampling period for the control delay compensation and another sampling period for the optimization algorithm. The selected optimal switching state can be applied at (k+1)th sampling instant. The principle of the delay compensation method is illustrated in Fig. 2.9.

66

u
Past Sample Ts

First step Ts

Second step Ts

u u (k - 1)

*

1 2
3

u p (1) (k + 1)

u (k )
^ (k + 1) u

u p (2) (k + 1)

u p (3) (k + 1)

t
Status

Calculation

Calculation

Calculation

t (k - 1)

t (k )

t (k + 1)

t (k + 2)

t

Fig. 2.9 Delay compensation method with modified one-step prediction. According to this method, the optimal switching state from the previous iteration xop (k ) is

^ (k + 1) ), and all the possible switching states used to estimate the variables at (k+1)th instant ( u
are used to predict the variables at (k+2)th instant. Then, the optimal switching state for (k+1)th instant xop (k + 1) is selected and will be applied at (k+1)th instant.

2.4 Conclusions
In this chapter, three different discretization methods are introduced, and compared with each other, Finally, Heun's method is finally chosen to be applied to derive prediction models of three typical configurations of CSC, which are the foundation of various MPCs presented in the following chapters. Besides, some general concerns on MPC for high power CSC have also been discussed including prediction horizon selection, reference extrapolation, flexibility of cost function, and calculation delay compensation.

67

3 Model Predictive Power Factor Control With Active Damping Function for Current-Source Rectifier
In this chapter, model predictive power factor control (MPPFC) with active damping function is proposed for high power CSR, which tackles LC resonance and line power factor (PF) control issues in CSR. For reference, the configuration of a CSR has been depicted in Fig. 1.13. LC resonance is an inherent issue in CSR, especially the case with small line-side resistance. The demerits of the existing active damping methods for traditional linear controls and the challenges on importing active damping function into MPC can be referred to Section 1.4.5. In aspect of line PF regulation, the drawbacks of the traditional linear controls and MPC can be found in Section 1.4.5 as well. The innovation of MPPFC with active damping function can be classified as · A line reactive power reference estimator with online capacitance correction, which is based on the line-side model of a CSR, is designed to modify the line reactive power reference based on operating states of a CSR for the purpose on maintaining unity PF or maximum achievable power factor (MAPF) at line side; · To mitigate LC resonance during transients, the calculated damping current is intuitively superposed on the line current reference to achieve active damping effect. A novel damping current calculation method, which avoids the use of low-pass filter (LPF) or band-stop filter (BSF) is also proposed. The merits offered by MPPFC with active damping function can be summarized as · In comparison with the traditional linear line PF control, MPPFC avoids simultaneous adjustments on coupled variables, such as modulating index and delay angle for CSR. Besides, the DC current is not intentionally increased in MPPFC; · Compared to the traditional linear controls with active damping function, MPPFC not only makes PF regulated, but also achieves better steady-state performance at line side. Moreover, there is no LPF and BSF used in MPPFC, which realizes better dynamic performance and simpler structure;

68

·

In contrast to conventional MPC for CSR, MPPFC provides accurate line PF control, which also involves active damping function inside, and makes itself more suitable for high power MV CSR with lightly damped LC circuit.

3.1 Line Power Factor Control
3.1.1 Line Reactive Power Reference Estimator
A line reactive power reference estimator is proposed to keep unity PF or MAPF for CSR under various operating conditions. Normally, unity PF between power supply voltage and line current is anticipated. However, this requirement is invalid under mainly two conditions 1) when the DC current is too small, CSR cannot compensate all the leading capacitor current, and three-phase power supply needs to absorb extra capacitive reactive power; 2) the average DC-side voltage is so close to its rated value that the phase angle of the fundamental component in the input current of CSR does not have enough room to be regulated.

 In dq-axis synchronous frame, with respect to the utility power supply voltage vector, vg , the   space vector diagram for the line side of CSR is shown in Fig. 3.1, in which vg and ig can be
given as  vg = Vgd   ig I gd + jI gq =  (3.1)

 where Vgd is the d-axis component of vg , which can be considered as a constant value, and   equal to the magnitude of vg ; I gd and I gq are the d- and q-axis components of ig , respectively.
Based on (3.1), the fundamental component in the voltage vector across the filter inductor can be given by
  vLf (1) = j g L f ig

(3.2)

where  g is the line-side angular frequency, which is equal to 377rad/s, and corresponding to 60Hz. 69

Then, the fundamental components in the capacitor voltage vector and the capacitor current vector can be given by    = vg - vLf (1)  vCr (1)    iCr (1) = j g Cr vCr (1)
 Finally, the fundamental component of the input current vector, iwr (1) , can be given by

(3.3)

   iwr (1) = ig - iCr (1)

(3.4)

Substituting (3.1) to (3.3) into (3.4), we have  iwr (1) = (1 - g2Cr L f ) I gd + j (1 - g2Cr L f ) I gq - g CrVgd

(

)

(3.5)

The modulus of both sides of (3.5) can be given by

 iwr (1) = (1 - g2Cr L f ) I gd + j (1 - g2Cr L f ) I gq - g CrVgd

(

)

= mr I dc

(3.6)

 where mr is the modulating index for CSR. When mr is unity, the modulus of iwr (1) is equal to

I dc , which indicates that the maximum compensation for the capacitor leading current can be achieved. With mr equal to 1, I gq can be calculated based on (3.6). After some arrangements, a quadratic equation can be established as (3.7) with the terms A and B expressed, respectively, by (3.8)
2 2 2 A 2  I gq - 2AB  I gq + B2 + A 2  I gd - I dc = 0 2 A = 1 - g Cr L f and B =  g CrVgd

(3.7) (3.8)

After substituting (3.8) into (3.7), the solutions to I gq can be given by

I gq =
where I gd can be further given by

2 2 B ± -A 2  I gd + I dc

A

(3.9)

70

= I gd

2 Pg Pdc  I dc Rdc  = = 1.5Vgd 1.5Vgd 1.5Vgd

(3.10)

in which Pg is the line active power,  is the efficiency of CSR, and Pdc is the DC-side active
2 Rdc . Based on (3.9) and (3.10), igq can be calculated with a specified DC power, equal to I dc

current and DC load resistor. There are two values obtained from (3.9). The positive symbol before the square root term in I gq represents no compensation for the capacitor leading current, and the negative symbol denotes the maximum compensation for the capacitor leading current. In order to achieve unity PF or MAPF, the second solution with negative symbol should be selected and given by

I gq =

2 2 B - -A 2  I gd + I dc

A

(3.11)

 If I gq is smaller than 0, iwr is enough to compensate all the capacitor leading current, even
* making the line PF lagging, as Fig. 3.1 (a) shows. Hence, Qg can be set to 0. In Fig. 3.1 (b), if  I gq is larger than 0, iwr , even with the maximum compensation, is still not enough to
* compensate all the capacitor leading current. Then, Qg should be calculated based on I gq .

* Therefore, Qg can be given by

,  0 * Qg =  -1.5Vgd I gq ,

I gq  0 I gq > 0

(3.12)

where Vgd is considered as a constant value.

71

q

q

g
 iCr

g
 iCr
 ig

I gq Vgd  vLf
d

I gd
 ig

Vgd I gq

I gd  vLf
d

 vCr

 iwr

 vCr

 iwr
(a)

(b)

Fig. 3.1 Space vector diagram for line side of CSR: (a) line PF lagging and (b) line PF leading. Based on (3.8) and (3.11), it can be found that I gq heavily depends on the parameters of CSR,
* * such as L f and Cr , so inaccurate system parameters have impacts on Qg . Based on Qg , MAPF

can be given by
MAPF= Pg
* 2 Pg2 + (Qg )

(3.13)

Fig. 3.2 (a) shows MAPF with different capacitors at various DC current conditions. The range, over which the line PF is equal to unity, shrinks with the increase of filter capacitance. For example, at 0.4pu DC current condition, MAPF with 0.4pu capacitor is 0.987, whereas, MAPF decreases to only 0.480 with 0.6pu capacitor. Similarly, at 0.3pu DC current condition, MAPF with 0.4pu capacitor is only 0.536, but that with 0.2pu capacitor can still be maintained at unity. MAPF with different filter inductances at various DC current conditions is shown in Fig. 3.2 (b). It can be found that with filter inductance varied from 0.05pu to 0.15pu there is no apparent influence on MAPF. Over the whole range of DC current, the three curves in Fig. 3.2 (b) closely align with each other. In contrast to filter inductor, the discrepancy between the real

72

capacitance and the value used in calculation has more significant impact on MAPF, especially at low DC current condition.
1.0 1 0.9 0.9 0.8 0.8 0.7 0.7 0.6 0.6 0.5 0.5 0.4 0.4 0.3 0.3 0.2 0.2 0.1 0.1 0 0 0.1 0.1 0.2 0.2 0.3 0.3 0.4 0.4 0.5 0.5
dc

Line Maximum Achievable Power Factor

Line Maximum Achievable Power Factor

1.0 1 0.9 0.9 0.8 0.8 0.7 0.7 0.6 0.6 0.5 0.5 0.4 0.4 0.3 0.3 0.2 0.2 0.1 0.1 0 0 0.1 0.1 0.2 0.2 0.3 0.3 0.4 0.4 0.5 0.5
dc

0.6 pu 0.6pu CC r r 0.4 pu 0.4pu CC r r 0.2 pu 0.2pu CC r r

0.15 pu 0.15pu Lf L f 0.1 puLL 0.10pu f f 0.05 pu 0.10pu Lf L f
0.6 0.6 0.7 0.7 0.8 0.8 0.9 0.9 1.0 1

0.6 0.6

0.7 0.7

0.8 0.8

0.9 0.9

1.0 1

(pu) I idc /(pu)

(pu) I idc /(pu)

(a)

(b)

Fig. 3.2 Profile of MAPF versus DC current: (a) with different capacitors and (b) with different filter inductors. In order to ensure the accuracy of the line reactive power reference estimator, an online capacitance estimation method is introduced into the line reactive power reference estimator to improve its performance under capacitance mismatch condition, in consideration of the impact of capacitance on MAPF. Based on (2.21), the derivative of the capacitor voltage vector can be given by

 dvCr   Cr = ig - iwr dt
(3.14) can be discretized with backward Euler method as

(3.14)

Cr

   vCr (k ) - vCr (k - 1)  = ig (k - 1) - iwr (k - 1) Ts

(3.15)

  where vCr (k ) and vCr (k - 1) represent the capacitor voltage vectors at kth and (k-1)th sampling   instants; ig (k - 1) and iwr (k - 1) represent the line current vector and the applied input current vector at (k-1)th sampling instant. Considering the  -axis components in (3.15), the estimated capacitance can be given by 73

^ = C r

Ts ( ig (k - 1) - iwr (k - 1) ) vCr (k ) - vCr (k - 1)

(3.16)

However, since (3.16) is derived from the discretization of a derivative operation, which is very sensitive to measurement noise, the estimated capacitance value fluctuates all the time, and cannot be directly used in the line reactive power reference estimator. Hence, a regulation method for stabilizing the estimated capacitance is proposed here, as Fig 3.3 shows, where Crinit is the initial capacitance; Crest is the finally estimated capacitance. After passing through a low^ is sent to a PI controller. C init is used as a feedforward in this regulation pass filter (LPF), C r r

method. There are two advantages offered by this method. First, there is no influence caused by the estimated capacitance regulation method on start-up process, due to the feedforward of Crinit ; Second, the PI controller also provides some filtering effect, which ensures Crest stabler.

Kp
^ C r
LPF

Crinit
+ + +

+

-

+

Crest

Ki s

Fig 3.3. Diagram of regulation method for estimated capacitance.

3.1.2 Predictive Line Current Control
In MPPFC, the line active power reference, Pg* , is obtained from a PI controller for DC
* current regulation. Then, substituting the d-axis line current reference, I gd , and the DC current

* * reference, I dc , into (3.11) and (3.12), the q-axis line current reference, I gq , and the line reactive
* power reference, Qg , can be calculated. Since MPPFC is realized in  -axis stationary frame,

the line current reference in  -axis can be expressed as

74

* = ig   i* =  g 

2 vg 2 vg  * Pg* + Qg 2 2 2 2 + 3 vg + vg  3 vg v  g 2 vg  2 vg * Pg* - Qg 2 2 2 2 3 vg + vg  3 vg + vg 

(3.17)

 Based on (2.23), the line current vector at (k+1)th sampling instant, ig (k + 1) , can be predicted.

In MPPFC, the active and reactive power control is realized by tracking the line current references, which is achieved by a cost function as
2  p ^ * (k + 1) - i g (k= k + ) i ( 1) g g

(3.18)

 ^ * (k + 1) is the estimated line current reference vector at (k+1)th sampling instant, which where i g can be calculated through vector extrapolation method, and given by   j T ^ * (k + 1) = i ig* (k )e g s g (3.19)

During each sampling interval, the optimal switching state leading to the minimum value of (3.18) is selected from the nine possible switching states, and applied during the entire sampling interval, in order to closely track the line current references.

3.1.3 Switching Frequency Reduction
A crucial issue in high power applications is the efficiency of power converters, to which switching losses are particularly relevant. With MPPFC, the average switching frequency, and consequently the switching losses, can be reduced by adding a switching commutation related term to the cost function (3.18). This new term penalizes those switching states producing larger number of switching commutations from one sampling interval to the next. The new cost function can be given by
g ' (k ) = g (k ) + wsw

x =1,2,...,6



S x (k ) - S x (k - 1)

(3.20)

where S x (k - 1) represents the optimally selected switching states of six switching devices in the CSR during (k-1)th sampling interval; S x (k ) represents the predicted switching states for kth 75

sampling interval; wsw is a weighting factor, which can be increased to give more priority to switching frequency reduction over line current regulation. In consideration of delay caused by calculation, with the two-step prediction method introduced in Section 1.5.2, (3.20) also needs to be shifted one-step ahead, and given by
2  p ^ * (k + 2) - i g ' (k + 1) = i g g ( k + 2) + wsw

x =1,2,...,6



S x (k + 1) - S x (k )

(3.21)

 p ^ * (k + 2) and i where i g g ( k + 2) are the estimated line current reference vector and the predicted line current vector at (k+2)th instant; S x (k ) represents the optimal switching state applied during kth sampling interval, and S x (k + 1) represents the predicted switching state for (k+1)th sampling interval.

3.2 Active Damping Function Associated With MPPFC
Due to optimal switching state selection process, the input PWM current of MPPFC features spread harmonic distribution. Therefore, severe resonance is possibly excited in a lightly damped LC circuit. Hence, an active damping method, which is suitable for MPPFC, is crucial to guarantee its performance. However, unlike traditional linear control, there is no modulation stage and input PWM current reference used in MPPFC, which makes it challenging to involve active damping function into MPPFC. The other thing is that in conventional active damping methods, high frequency components in capacitor voltage are usually extracted to be used for damping current calculation. Since MPPFC is realized in  -axis stationary frame, band-stop filters (BSFs) are needed to filter out fundament components in capacitor voltages, which further complicate the control design. To overcome the two hurdles, a novel realization method is proposed to involve active damping function into MPPFC. Moreover, an intuitive approach to calculating damping current is also designed, which avoids the use of BSFs, and simplifies the control structure.

76

3.2.1 Damping Current Calculation
As Fig. 3.4 (a) shows, in conventional linear control, active damping uses CSR to emulate a damping resistor, Rdamp , which is connected in parallel with capacitor. Then, damping current vector can be calculated by the division between harmonic components in capacitor voltage vector and Rdamp . In the proposed damping current calculation method, capacitor voltage vector and filter inductor voltage vector can be given by

 = vCr    vLf =  

  vCr (1) + vCr ( h )   vLf (1) + vLf ( h )

(3.22)

   where vCr (1) and vCr ( h ) represent the fundamental component and the harmonic component in vCr ;

   vLf (1) and vLf ( h ) represent the fundamental component and the harmonic component in vLf .
According to the line-side model of CSR, a voltage equation can be given by

   v = vLf + vCr g

(3.23)

Substituting (3.22) into (3.23), after some arrangements, the voltage equation can be modified into

     vg - vLf (1) - vCr (1) = vLf ( h ) + vCr ( h )

(3.24)

 Here it is assumed that power supply voltage vector, vg , only contains fundamental

 component. Hence, the left-hand side of (3.24) is equal to 0. Then, vCr ( h ) can be given by
     vCr ( h ) = -vLf ( h ) = vCr + vLf (1) - vg
(3.25)

  In MPPFC, vCr and vg have been measured. Since the objective of the cost function in
MPPFC is to track line current references, the fundamental component in filter inductor voltage,  vLf (1) , can be calculated by
  vLf (1) = j g L f ig*

(3.26)

 Finally, based on vCr ( h ) , damping current can be calculated as
77

    vCr + j g L f ig* - vg idamp = Rdamp

(3.27)

The equivalent circuit for the proposed damping current calculation is shown in Fig. 3.4 (b), the small-signal transfer function from input PWM current of CSR to line current can be given by

= G (s)

I g (s) 1 = 2 I wr ( s ) s Cr L f + ( L f Rdamp ) s + 1

(3.28)

It can be found from (3.28) that with the decrease of Rdamp larger damping effect can be obtained, but higher damping current, which contains high frequency components, has more influence on the performance on tracking line current references. Here the value of Rdamp is selected as 2pu, which makes a trade-off between damping effect and influence on tracking line current references.

3.2.2 Damping Current Associated into MPPFC
In MPPFC, the main challenge on involving damping current is that there are no modulating stage and reference vector used to generate input PWM current. Fortunately, according to Fig.  3.4 (b), the line current vector, ig , can be expressed by
    ig = iCr + iwr + idamp

(3.29)

 which reveals that ig also includes the emulated damping current vector. Hence, the damping

effect can also be achieved by introducing the damping current vector into the line current reference vector. Considering calculation delay compensation, the estimated damping current at (k+1)th sampling instant can be given by    ^* ^ (k + 1) + j L i ^  v Cr g f g ( k + 1) - vg ( k + 1) ^ idamp (k + 1) = Rdamp

(3.30)

78

   ^ * (k + 1) are the estimated capacitor voltage vector, power ^ (k + 1) , v ^ (k + 1) and i where v g Cr g supply voltage vector, and line current reference vector at (k+1)th sampling instant, in which
 ^ (k + 1) can be calculated with space vector angle compensation, as v g   j T ^ (k + 1) = v v g ( k )e g s g

(3.31)

In order to associate damping current into MPPFC, the cost function needs to be further modified into
2   p ^ (k + 1) - i ^ * (k + 2) + i g (k + 1) = i ( k + 2) + wsw g damp g

x =1,2,...,6



S x (k + 1) - S x (k )

(3.32)

where the damping current vector is introduced into the line current reference vector.
Lf

 ig
+

  iwr + idamp

CSR

+
-

 vg

 iCr

 idamp

 iwr

Lf

 ig
+
-

  iwr + idamp

CSR
 - j g L f ig*

 vCr

+
-

-

 vg

 iCr

 iwr

 vCr

Cr

Cr

 idamp

 vg

Rdamp

Rdamp

(a)

(b)

Fig. 3.4 Active damping methods for CSR: (a) traditional method and (b) proposed method. Finally, the block diagram of MPPFC with active damping function and one-step delay compensation is shown in Fig. 3.5, which can be realized step-by-step as follows 1) At kth sampling interval, measure the power supply voltages, the line currents, the capacitor voltages, and the DC current first; 2) Estimate the capacitance using (3.16), and calculate the line reactive power reference using (3.11) and (3.12); 3) Update the prediction model, and estimate the line current and the capacitor voltage vector at (k+1)th sampling instant based on (2.23) and the optimal input PWM current vector selected during last sampling interval;

79

4) Calculate the line current reference vector using (3.17), and estimate the damping current vector at (k+1)th sampling instant using (3.30); 5) Predict the line current vector at (k+2)th instant using (2.23) based on all the possible input PWM current vectors for a CSR. The predicted line current vector is compared with the summation of the line current reference vector and the damping current vector using (3.32). The input PWM current vector minimizing (3.32) is applied to the CSR at the beginning of (k+1)th sampling interval.
 vg
 ig
 iCr  iwr

CSR
Ldc
I dc

Lf

DC Load Resistor

 vCr

+

-

Cr

Switching Signals
Gatings Generation

CSR System Control Part

 I op (k )

z  I op (k + 1)

-1

 I4  I 5  I 7,8,9 I

 I3

Minimization of Cost Function (3.32)

 ^ (k + 1) i damp  + ig*

 I2  I1

 igp (k + 2)

+

Line Current Reference Calculation with (3.17)

Pg* I dc - I dc +
* Qg

* I dc

 ^g (k + 1) v

Line Current Prediction with (2.23)

Crest

6

 I op (k )  vg

 ^Cr (k + 1) v

 ^ (k + 1) i g

Delay Compensation with (2.23)

Crest

 ^Cr (k + 1) v  ig*  ^g (k + 1) v

 ^ (k + 1) i damp
Damping Current Calculation (3.30)

Reactive Power Reference Estimation with (3.11) and (3.12)

Crest
 vCr
Online Capacitance Estimation with (3.16)

 ig

 iwr

 vCr

 ig

Rdamp

Fig. 3.5 Block diagram of MPPFC with active damping function.

3.3 Simulation Validation
To verify the performance of MPPFC, simulation on a high power CSR is conducted. The parameters used in the simulation are listed in Table 3.1. Besides, the simulated results of conventional MPC and modulating index control with active damping are also provided. SVM 80

with switching frequency of 1080Hz is used in modulating index control. The sampling intervals in both conventional MPC and MPPFC are 100s . wsw is selected as 0.4 in MPPFC. For simplicity, afterwards conventional MPC and modulating index control with active damping are called Scheme I and Scheme II, respectively. To evaluate switching losses by different control schemes, the average switching frequencies of conventional MPC and MPPFC are measured, and can be given by

f sw =

x =1,2,...,6



f swx (3.33)

6

where f swx is the average switching frequency of each power device in CSR, which is calculated by measuring the number of switching commutations for each power device over 30 consecutive fundamental cycles, which is equal to 0.5s with fundamental frequency of 60Hz. Table 3.1 SIMULATION AND EXPERIMENTAL PARAMETERS
Variable Description Rated line-to-line voltage (L-L) Rated power Sampling interval Filter inductance Capacitance DC link inductance DC resistor load Simulation Experiment 4160V 1MVA 100s 0.1pu 0.4pu 1pu 0.8pu 208V 5kVA 100s 0.218pu 0.378pu 1.16pu 0.8pu

V

R gLL

PR Ts Lf Cr Ldc Rdc

3.3.1 Steady State Performance
Fig. 3.6 shows the profile of the line PF versus the DC current. Only fundamental component in line current is used to calculate line PF. The line PF of MPPFC can closely align with MAPF (the purple dot line) over the whole DC current range, which demonstrates the effectiveness of the proposed line reactive power reference estimator. In comparison with MPPFC, Scheme I cannot ensure the line PF equal to MAPF value, since the line reactive power is not accurately regulated in its cost function. Scheme II produces the lowest line PF over the entire DC current range, since the capacitor current is totally not compensated in modulating index control.

81

1.0 1 0.9 0.9 0.8 0.8
Line Power Factor

0.7 0.7 0.6 0.6 0.5 0.5 0.4 0.4 0.3 0.3 0.2 0.2 0.1 0.1 0 0 Line MAPF Line MAPF Conventional MPC Conventional Traditional MPC Index Control Index Control Proposed MPPFC Proposed MPPFC 0.1 0.2 0.2 0.3 0.3 0.4 0.4 0.5 0.5 0.6 0.6 0.7 0.7 0.8 0.8 0.9 0.9 0.1
I dc (pu)

0

1.0 1

Fig. 3.6 Line power factor profile of three schemes. Fig. 3.7 shows the THD profile of three schemes at various DC current conditions. Due to no active damping function involved and the distributed spectrum of the input PWM current, Scheme I produces very severe LC resonance with a lighted damped LC circuit, which results in deteriorating line current distortion and very high THD. In contrast to Scheme I, Scheme II and MPPFC generate much lower line current distortion. When compared to Method II at higher DC current conditions, MPPFC produces better performance on line current. On the other hand, the line current THD of Method II is smaller at lower DC current conditions, since the influence of input PWM current on the line current is weakened with lower modulating index. However, though Method II can guarantee very acceptable line current performance, it cannot achieve line PF regulation as that done with MPPFC.

82

400 400
THD of ig (%)

300 300 200 200 100 100 0 0 10 10 Scheme I I Scheme Method

THD of ig (%)

8 8 6 6 4 4 2 2 0 0 0 0 Scheme II II Scheme Method MPPFC MPPFC 0.1 0.2 0.2 0.3 0.3 0.4 0.4 0.5 0.5 0.6 0.7 0.8 0.8 0.9 0.9 0.6 0.7 0.1
I dc (pu)

1.0 1

Fig. 3.7 Line current THD profile of three methods. Fig. 3.8 shows the total demand distortion (TDD) profile of Scheme II and MPPFC at various DC current conditions. Since Scheme I leads to severe resonance and unacceptable distortion in the line current, hereby only the comparison between Scheme II and MPPFC is conducted. It can be found in Fig. 3.8 that with the DC current between 0.6 and 1.0pu, the TDD of MPPFC is smaller than that of Method II, and the maximum TDD appears when DC current is set to 1.0pu in both cases. Though the TDD of MPPFC becomes higher than that of Scheme II when the DC current is lower than 0.6pu, both of them have dropped into very insignificant range, specifically lower than 2%. On the other hand, the line-side performance of CSR should comply with the utility codes, especially IEEE standard 519-1992 [79]. Obviously, MPPFC can fulfill the requirement over the whole DC current range, whereas when the DC current is higher than 0.8pu, the TDD of Scheme II cannot meet the standard anymore, which implies that with MPPFC the volume of the LC filter in CSR has the potential to be further reduced, but in the case of Scheme II, the filter volume needs to be increased to meet the requirement over the whole operating range. 83

9 9
8 8 7 7
TDD of ig (%)

Scheme II Scheme Method IIII MPPFC MPPFC

6 6 5 5 4 4 3 3 2 2 1 1 0 0 0 1 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0 I dc (pu)

Fig. 3.8 Line current TDD profile. In a high power MV CSR, the sizes of the filter inductor and the capacitor are normally around 0.1pu and 0.4 to 0.6pu, respectively. In terms of pu system, the size of the capacitor is apparently larger than that of the filter inductor. Hence, with the filter inductor fixed at 0.1pu, the maximum TDDs, appearing when the DC current is set to 1.0pu, are illustrated in Fig. 3.9 with respect to various capacitor sizes. Fig. 3.9 shows that only if the capacitor, Cr , is larger than 0.6pu, the maximum TDD of Scheme II can be kept not higher than 5%, whereas when Cr is not lower than 0.3pu, the maximum TDD of MPPFC can always meet the grid code requirements. From this point of view, with the same parameters except the capacitor and under the same operating condition, MPPFC can help reduce Cr by up to 50% in contrast to that of Scheme II.

84

10 10 9 9 8 8
TDD of ig (%)

Scheme II II Scheme Method II MPPFC MPFFC

7 7 6 6 5 5 4 4 3 3 2 2 0.7 0.7

0.2 0.2

0.3 0.3

0.4 0.4
Cr (pu)

0.5 0.5

0.6 0.6

Fig. 3.9 Maximum TDD (Idc=1.0pu) versus size of capacitor. On the other hand, in order to justify the effect of reduced filter inductor on output performance, the maximum TDDs of MPPFC with different filter inductors, L f , are shown in Fig. 3.10. It can be found that with L f reduced to 0.08pu, the minimum requirement on Cr for MPPFC should be raised to 0.4pu. Based on the comparison between the two kinds of filter combinations, that are 0.1pu L f with 0.3pu Cr and 0.08pu L f with 0.4pu Cr , it can be found that 20% reduction on L f would lead to 33.3% increase on Cr . Hence, it is suggested that MPPFC is mainly used for capacitor reduction purpose, which is more functional and effective.

85

8 8 L Lf 0.1pu 0.1 pu
f

7 7

L Lff0.08pu 0.08 pu

6 6
TDD of ig (%)

5 5

4 4

3 3

2 2

0.2 0.2

0.3 0.3

0.4 0.4
Cr (pu)

0.5 0.5

0.6 0.6

0.7 0.7

Fig. 3.10 Maximum TDD (Idc=1.0pu) of MPPFC with different filter inductors. Fig. 3.11 shows the switching frequency profiles of three schemes at various DC current conditions. The average switching frequencies of Scheme I and MPPFC are a little higher than that of Scheme II, which is equal to 1080Hz. Due to the effect of the switching commutations related term in (3.32), the average switching frequency of MPPFC has been very close to that of Scheme II over the whole DC current range. The average switching frequencies of Scheme I and MPPFC are very similar between each other, MPPFC offers significant advantages in terms of the performance on line PF regulation and line current distortion.

86

1500 1500 1400 1400 1300 1300
f sw (Hz)

Scheme I II Scheme Method Scheme II II Scheme Method II MPPFC MPPFC

1200 1200 1100 1100 1000 1000 900 900 0 0 0.1 0.2 0.2 0.3 0.3 0.4 0.4 0.5 0.5 0.6 0.6 0.7 0.7 0.8 0.8 0.9 0.9 0.1
I dc (pu)

1.0 1

Fig. 3.11 Switching frequency profile of three schemes. Fig. 3.12 verifies the effectiveness of the online capacitance correction of the line reactive power estimator. The real value of the capacitor is 0.4pu. From top to bottom, the DC current, the estimated capacitance, and the line active and reactive power are presented. In Fig. 3.12 (a), the initial capacitance used in the line reactive power estimator is 1.5 times its real value. The DC current reference is set at 0.4pu. The online capacitance estimation isn't activated until time t of 0.5s. Before 0.5s, due to the mismatched capacitance, the line reactive power reference is approximately -220kVAr, which makes the line PF only equal to 0.470. With the capacitance online estimation introduced, it can be observed that the estimated capacitance gradually approaches the real value. During this process, with the estimated capacitance modified, the line reactive power reference gradually becomes close to 0, which eventually makes the line PF around 0.98. In Fig. 3.12 (b), the initial capacitance is 0.5 times its real value, and the DC current reference is set to 0.3pu. The online capacitance estimation is also activated after 0.5s. Before 0.5s, with the mismatched capacitance, the line reactive power reference is 0. However, the unity line PF is totally unachievable at 0.3pu DC current condition. It can be found that the 87

line reactive power cannot follow its reference, and the line PF cannot be fixed at unity before 0.5s. Besides, the large ripples can be found in both line active and reactive powers and even the DC current. With the online capacitance estimation introduced at 0.5s, the estimated capacitance gradually increases to 0.4pu, and the line reactive power reference decreases to around 120kVAr. The line PF is finally kept at 0.48. With the accurate capacitance value, the ripples in both line active and reactive powers are significantly reduced, and the fluctuation in the DC current becomes smaller as well.

88

* I dc , I dc (A)

120 120 80 80 40 40 90 90

* ref Iidc dc

i dc I

C C rr

est C Cr r

Cr (F)
Pg , Qg (kW,kVAr)

70 70 50 50 200 200 0 0

-200 -200 -400 -400
* ref P Pg g

P P g g

* Q Qgref g

Qg Q g

0.2 0.2

0.3 0.3

0.4 0.4

0.5 0.5

0.6 0.6

0.7 0.7

t s t/s

(a)
* I dc , I dc (A)

100 100

* ref Iidc dc

Iidc

60 20
70 70

Cr (F)

50 50 30 30 10 10
Cr C r
est Crest C r

Pg , Qg (kW,kVAr)

200 200

0
-200 -200 -400 -400 0.2 0.2
* ref P P g g

Pg P g

* ref Q Qg g

Qg Q g

0.3 0.3

0.4 0.4

0.5 0.5

0.6 0.6

0.7 0.7

t s t/s

(b) Fig. 3.12 Performance of online capacitance estimation: (a) 1.5 times mismatched capacitance at 0.4pu DC current, and (b) 0.5 times mismatched capacitance at 0.3pu DC current. 89

3.3.2 Dynamic Performance
Fig. 3.13 shows the dynamic performance at the sudden change of the DC current. At time t of 0.4s, the DC current reference jumps from 0.2pu to 1pu, then it drops to 0.2pu again at 0.7s. Fig. 3.13 (a) shows the results of Scheme I. Since the DC current is directly regulated through its cost function, very fast DC current response is achieved. However, due to the severe line-side LC resonance, the ripples in the line active and reactive powers are too large to be accepted, which leads to the large fluctuation in the DC current in turn. As Fig. 3.13 (b) shows, the overshoot can be observed in the DC current of Scheme II. Due to the nonlinear nature of power converter, the overshoot during the DC current jumping is different from that when the DC current drops. Besides, although active damping function has been involved into Scheme II, significant power ripples, caused by LC resonance, and the limitation imposed by linear control and LPF used for calculating damping current, can still be observed, especially when the DC current drops. The results of MPPFC are shown in Fig. 3.13 (c), where the overshoot in the DC current is effectively mitigated, and the line active and reactive powers can closely track their respective references. Moreover, the presented results further verify the effectiveness of the line reactive power reference estimator. When the DC current is only 0.2pu, the leading current produced by the capacitor cannot be totally compensated. Therefore, the line reactive power reference at 0.2pu DC current is -120kVAr, indicating that the unity line PF is unachievable. When the DC current jumps to 1pu, the line reactive power reference quickly turns into 0, meaning that the line PF can be kept at unity.

90

200 150 100 50 0 2000 1000 0

I dc,, iI dc / (A) iref (A)

* I dc

dc

I dc

*

P , Q / (kW,kVAr) (kW, kVAr) P g g , Qg g

dc

Pg

-1000

-2000 400
200 0 -200

Qg

iiga / (A) (A)

ga

-400 0.2

0.25

0.3

0.35 0.35

0.4 0.4

0.45 0.45

0.5 0.5

0.55 0.55

t s t/s

(a)
200 150 100 50 0 1500 1000 500 0 -500 -1000 200 100 0 -100 -200 0.2 0.25 0.3 0.35 0.35 0.4 0.45 0.5 0.55

,I ref dc , iI i dc /(A) (A)

* I dc

dc

*

dc

I dc

P Q /(kW,kVAr) (kW, kVAr) P ,, Q

DC Current Overshoot
Pg

g g

iiga / (A) (A)

ga

g g

Qg

t s t/s

(b)

91

200 150 100 50 0 1500 1000 500

ref dc,, I iI i dc /(A) (A)

* I dc

P Q /(kW,kVAr) (kW, kVAr) P ,, Q

dc

*

dc

I dc

Pg Qg
* Qg

Pg*

0 -500
-1000 200 100 0 -100 -200 0.2 0.25 0.3

iiga /(A) (A)

ga

g g

g g

0.35

0.4

0.45

0.5

0.55 0.55

t s t/s

(c) Fig. 3.13 Dynamic responses when DC current suddenly changes: (a) Scheme I, (b) Scheme II, and (c) MPPFC. Fig. 3.14 verifies the performance of the active damping function involved into MPPFC during transients. At time t of 0.25s, the DC current drops from 1pu to 0.2pu. Without the active damping function, LC resonance is induced, and significant oscillation can be observed in the waveform of the phase A line current. With the active damping function introduced, LC resonance during transients is effectively mitigated. Moreover, the ideally sinusoidal line current references in MPPFC can compel the line currents to be close to sinusoidal waveform in steady states, the introduction of the active damping function further reduces the distortions of the line current and the capacitor voltage, which can also be validated from Fig. 3.14.

92

* ref I idc ,, Ii dc / (A) (A) dc dc

200 150 100 50 0 5000

* ref I idc ,, Ii dc / (A) (A)

I

* dc

dc

dc

I dc

200 150 100 50 0 5000

* I dc

I dc

/ (V) cra vv Cra (V)

v (V) / (V) vCra cra
0.475 0.5 0.525

2500 0

2500
0

-2500 -5000
200 100 0 -100 -200 0.45

-2500 -5000 200 100 0 -100 -200
0.45 0.475 0.5 0.525 t/s t s

/ (A) (A) iiga ga

t s t/s

iga i (A) / (A) ga

(a)

(b)

Fig. 3.14 Effectiveness of active damping function in MPPFC: (a) without active damping function and (b) with active damping function.

3.4 Experimental Validation
Experiments are conducted on a low power CSR prototype, where the power devices are IGBTs (IRG7PH42U-ND from International Rectifier) in series with diodes (DSEP60-12A-ND from IXYS) and the controller design is based on DSP (TMS320F28335) and FPGA (EP4CE10E22C8). The control algorithm part is realized in the DSP, and the FPGA takes responsibility of measurement and gating signal generation. Fig. 3.15 shows a photograph of the experimental setup. The parameters of the experimental setup have been listed in Table 3.1. For comparison, the experimental results of Scheme I and Scheme II are also provided. The switching frequency of Scheme II is still 1080Hz. The sampling intervals for Scheme I and MPPFC are still selected as 100s . The average switching frequencies of Scheme I and MPPFC are still calculated based on (3.33).

93

Fig. 3.15 Photograph of a low power CSR prototype: (A) three-phase power supply, (B) filter inductance, (C) capacitors, (D) CSR, (E) DC choke, (F) DC load resistor, and (G) oscilloscope.

3.4.1 Steady State Performance
Fig. 3.16 shows the steady state performance at 1pu DC current. The DC current and the phase A line current are directly measured with current probes. The DC current reference, the phase A power supply voltage, the line active and reactive powers are obtained through D/A interfaces in the prototype. In Fig. 3.16 (a), Scheme I leads to severe resonance in the phase A line current, due to the spread spectrum distribution of the input PWM currents. Large ripples can be found in the line active and reactive powers of Scheme I. The unity PF cannot be maintained with Scheme I, which is indicated by the negative average line reactive power. Fig. 3.16 (b) shows the results of Scheme II. The distortion in the phase A line current, of which the THD is 6.72%, is suppressed by the active damping function involved into Scheme II. However, since modulating index control is used to regulate the DC current in Scheme II, unity PF still cannot be achieved, which can be verified from its nonzero and negative line reactive power. 94

The results of MPPFC are shown in Fig. 3.16 (c). the line reactive power reference is zero, and unity PF is achieved by the line reactive power closely tracking its reference. With the predictive line current controller and the proposed active damping method, the waveform of the phase A line current is close to sinusoidal waveform with the smallest THD of 5.92%. Due to the smaller distortion in the line currents, the fluctuation in the DC current, and the ripples in the line active and reactive powers are also effectively constricted with MPPFC.
* I dc (10A div)

I dc (10A div)
* I dc (10A div) THD(iga ) = 6.72%

I dc (10A div)
* (10A div) I dc THD(iga ) = 5.92%

I dc (10A div) THD(iga ) = 59.3%

iga (20A div)

iga (20A div)

iga (20A div)

10ms

vga ( 60V div ) Pg (1.5kW div)

10ms

vga (60V div)
Pg (1.5kW div)

10ms

vga (60V div)
Pg* (1.5kW div)

Pg (1.5kW div)
Q (1.5kVAr div)
Qg (1.5kVAr div)
Input PF = 0.981
* g

Qg (1.5kVAr div)

Qg (1.5kVAr div)
Input PF = 0.935

Input PF = 0.999

(a)

(b)

(c)

Fig. 3.16 Steady state performance at 1pu (19.6A) DC current: (a) Scheme I, (b) Scheme II, and (c) MPPFC. Table 3.2 lists the quantitative comparison of three schemes at different DC currents, including THD and TDD of line current, measure line PF (only fundamental component of line current considered), MAPF, and measured average switching frequency. At all the listed operating conditions, the line PF of MPPFC is the highest among three schemes, and very close to MAPF, in which the discrepancy between MAPF and the line PF is mainly caused by the losses of the prototype. Relying on the reactive power term in the cost function, Scheme I can also improve the line PF. However, the line PF cannot be accurately regulated to align with MAPF values. Scheme II results in the lowest line PF, since it totally neglects line PF regulation. With the active damping function involved, both Scheme II and MPPFC can suppress possible LC resonance, and achieve relatively low THD of line current. Since there is no active damping 95

function in Scheme I, severe LC resonance appears in the line current of Scheme I at all operating conditions. Besides, in terms of TDD, MPPFC offers the lowest TDDs at all the operating conditions, and it also verifies that in contract to Scheme II, MPPFC possesses the potential to reduce the volumes of LC filter, especially the capacitor, and meets the grid code requirements at the same time, which also aligns with the results shown in Fig. 3.16. Moreover, the three schemes share very similar switching frequencies, which means that MPPFC can achieve line PF regulation and active damping function with not so high switching frequency. Table 3.2 STEADY STATE PERFORMANCE OF THREE METHODS FOR COMPARISON
Conditions Methods THD of ig (%) TDD of ig (%) Scheme I 59.3 42.3 Idc = 19.6A Scheme II 6.72 6.06 MPPFC 5.92 5.22 Scheme I 193 72.7 Idc = 10A Scheme II 9.96 4.48 MPPFC 13.6 3.20 Scheme I 30.4 8.43 Idc = 4A Scheme II 11.96 4.90 MPPFC 11.2 2.64 PF MAPF fsw (Hz) 0.981 1054 0.935 1 1080 0.999 1175 0.681 1045 0.474 1 1080 0.998 1335 0.119 1031 0.071 0.175 1080 0.172 1219

Fig. 3.17 verifies the effectiveness of the online capacitance estimation method. The real capacitance and the estimated value are measured from the D/A interfaces in the prototype. In Fig. 3.17 (a), the CSR operates at 0.4pu DC current, and the mismatched capacitance is 1.5 times its real value, that is 0.378pu ( 116F ). First, since the capacitance online estimation is not activated, the mismatched capacitance makes the line reactive power reference and the line PF equal to -1240VAr and 0.465, respectively. With the capacitance online estimation introduced, the estimated capacitance gradually approaches its real value. The line reactive power reference is modified to -458VAr, and the line PF increases to 0.831. In Fig. 3.17 (b), the CSR operates at 0.3pu DC current, and the mismatched capacitance is 0.5 times its real value. First, the capacitance online estimation is not activated, either. The mismatched capacitance makes the line reactive power reference equal to 0. However, it can be found that the line reactive power is not equal to 0, and unity PF is unachievable at 0.3pu DC current. With the online capacitance estimation introduced, the estimated capacitance increases, and finally aligns with its real value. The reactive power and the line PF are changed to -992VAr and 0.267, respectively. The 96

reactive power follows its reference, and the active power ripples become smaller after the introduction of the capacitance online estimation.
I dc (10A div)
* I dc (10A div)

I dc (10A div)
* (10A div) I dc

Crest (58F div)

Crreal (58F div)
Crest (58F div)
100ms

Crreal (58F div)

100ms

Pg* (1.5kW div)

Pg (1.5kW div)

Pg* (1.5kW div)

Pg (1.5kW div)

* Qg (1.5kVAr div)

Qg (1.5kVAr div)

* Qg (1.5kVAr div)

Qg (1.5kVAr div)

(a)

(b)

Fig. 3.17 Online capacitance estimation: (a) 1.5 times mismatched capacitance at 0.4pu DC current and (b) 0.5 times mismatched capacitance at 0.3pu DC current.

3.4.2 Dynamic Performance
Fig. 3.18 shows the transient responses of three schemes. First, the DC current reference is 0.2pu (4A). Then, it steps to 1pu (19.6A). After 400ms, the DC current reference jumps back to 0.2pu. The dynamic response of Scheme I is shown in Fig. 3.18 (a). Since the DC current is directly regulated based on the DC-side prediction model of CSR, very fast DC current response can be obtained using Scheme I. Nevertheless, the ripples in the line active and reactive powers are inacceptable due to severe line current resonance, which is caused by the spread spectrum 97

distribution of the input PWM current by Scheme I. In Fig. 3.18 (b), the overshoots can be found in the DC current of Scheme II during transients, especially when the DC current drops. Due to the degraded active damping function during transients, significantly resonance can still be found in the line active and reactive powers during the sudden changes of the DC current. Fig. 3.18 (c) shows the results of MPPFC, in which the overshoot of the DC current is effectively mitigated. With the DC current changed from 0.2pu to 1pu, the line active and reactive powers are adjusted from 179W to 4665W and from -1005VAr to 0VAr, respectively, which validates the effectiveness of the reactive power reference estimator. The predictive line current controller realizes fast active and reactive power regulation, and better dynamic performance without resonance in the line active and reactive powers, which is achieved by the active damping function involved into MPPFC.
I dc (5A div) I dc (5A div) I dc (5A div)

* I dc (5A div)

* I dc (5A div)

* I dc (5A div)

100ms

Pg (1.5kW div)

DC Current Overshoot
100ms 100ms

Pg (1.5kW div)

Pg* (1.5kW div)

Pg (1.5kW div) * Qg (1.5kVAr div)

Qg (1.5kVAr div)

Qg (1.5kVAr div)

Qg (1.5kVAr div)

(a)

(b)

(c)

Fig. 3.18 Dynamic responses under sudden changes of DC current: (a) Scheme I, (b) Scheme II, and (c) MPPFC. Fig. 3.19 verifies the effectiveness of the active damping function in MPPFC, when the DC current reference drops from 1pu to 0.2pu. Without the active damping function, significant resonance can be observed in the phase A capacitor voltage and the phase A line current during transients. The large fluctuation in the DC current also appears. In Fig. 3.19 (b), with the active damping function introduced, LC resonance is effectively mitigated, and the transitions of the 98

capacitor voltage and the line current become more flexible. Besides, the fluctuation in the DC current also decreases. Moreover, the distortion in the capacitor voltage and the line current becomes lower in comparison with that without the active damping function.
I dc (10A div)
* I dc (10A div) * (10A div) I dc

I dc (10A div)

vCra (300V div)

10ms

vCra (300V div)

10ms

iga (20A div)

iga (20A div)

(a)

(b)

Fig. 3.19 Effectiveness of active damping function in MPPFC during DC current drop: (a) without active damping function and (b) with active damping function.

3.5 Conclusions
MPPFC with active damping function has been presented in this chapter. The merits of the proposed scheme can be classified into three folds as · First, in comparison with traditional linear control, MPPFC not only realizes input PF control, but also achieves better steady-state performance on meeting the grid code requirements, which implies that MPPFC has the potential to further reduce the volume of input LC filter; · Second, in contrast to conventional MPC, MPPFC provides more accurate input PF control, and involves active damping function into it. Consequently, MPPFC suppresses the LC resonance, which is caused by harmonics in the input currents of CSR, and extends the application of MPC to high power CSR with lightly damped LC circuit; · Last but not least, MPPFC offers better dynamic performance, especially smaller DC current overshoot and better active damping performance during transients when contrasted with the traditional linear counterpart. 99

4 Model Predictive Pulse Pattern Control With Low Switching Frequency for High Power Current-Source Converter
In Chapter 3, conventional model predictive control (MPC) approach has been imported into high power CSR to realize line power factor (PF) regulation with active damping function, and improved dynamic performance. However, based on the simulation and experimental results, the average switching frequencies of MPC are still relatively high, which are around 1kHz, even with switching frequency reduction term included in final cost functions, whereby some modifications on conventional MPC need to be applied in consideration of further reduction on switching frequency. In this chapter, model predictive switching pattern control (MPSPC) with space vector based selective harmonic elimination (SHE) is proposed for single-bridge CSC, which achieves superb low-order harmonics elimination performance in steady state, and improved dynamic responses compared to that of traditional linear control with SHE modulation. The innovation of the proposed scheme can be classified as · · · A representation of SHE-PWM pattern is designed, based on which MPSPC is realized; According to selected space vectors and calculated dwell time based on SHE-PWM pattern, load current at the end of each sampling interval can be predicted; The finally applied space vector will be optimally reselected if the error between load current reference vector and predicted load current vector is larger than a pre-defined threshold. The advantages of MPSPC in comparison with traditional linear control and conventional MPCs with low switching frequency can be summarized as · With a saw-tooth carrier based quasi-modulation process, there is no quantization error, as mentioned in [80], anymore, which totally maintains the performance on elimination of the selected low-order harmonics, and achieve better dynamic responses at the same time; 100

· ·

There is no weighting factor selection issue which exists in [80, 81]; MPSPC only uses a one-step prediction instead of multistep predictions in [81-83]. Onestep prediction leads to a simpler structure, and reduces the complexity of the required calculation.

4.1 Selective Harmonic Elimination-Pulse Width Modulation for Current-Source Converter
Normally, there are two commonly used SHE-PWM patterns for a single-bridge CSC, namely six pulses per half cycle for output frequency around 60Hz, and eight pulses per half cycle for output frequency around 50Hz. With these two kinds of PWM patterns , the switching frequencies of switching devices in a CSC are just about 360Hz or 400Hz [5]. Fig. 4.1 shows typical SHE-PWM waveforms for a CSC. In Fig. 4.1 (a), there are six switching angles in the first  2 period of the six-pulse waveform. Only three out of the six angles, 1 ,  2 , and  0 , are independent, which can be used to eliminate two harmonics, and provide adjustable modulation index in the meanwhile. Similarly, the waveform with eight pulses per half cycle is depicted in Fig. 4.1 (b), in which there are only four independent angles, 1 ,  2 , 3 , and  0 . With these four angles, three selected harmonics can be eliminated, and modulation index can be adjusted as well. The PWM current waveform in Fig. 4.1 can be expressed in Fourier series as

iw (t ) =  an sin(nt )
n =1



(4.1)

where
an =



4



2 0 w

i (t ) sin(nt )d (nt )

(4.2)

Here six-pulse waveform is used as an example. In order to eliminate two dominant loworder harmonics such as the 5th and 7th, and adjust modulation index, the following system of equations is defined as

101

= F1 cos(51 ) - cos(5 2 ) + cos ( 5( 6 +  0 ) ) - cos ( 5( 3 -  2 ) )  0 + cos ( 5( 3 - 1 ) ) - cos ( 5( 2 -  0 ) ) =  F2 cos(111 ) - cos(11 2 ) + cos (11( 6 +  0 ) ) - cos (11( 3 -  2 ) ) =   0 + cos (11( 3 - 1 ) ) - cos (11( 2 -  0 ) ) =  =  F3 (4  )[cos 1 - cos  2 + cos( 6 +  0 ) - cos( 3 -  2 ) + cos( 3 - 1 ) - cos( 2 -  0 )] - ma = 0  where ma is the modulation index, which is given by

(4.3)

ma =

I w(1) I dc

(4.4)

in which I w(1) is the magnitude of the fundamental-frequency component of PWM current, and I dc is the value of DC current. Similarly, for an eight-pulse waveform with four independent angles, four equations can also be established to eliminate three dominant harmonics, such as the 5th, 7th, and 11th, and adjust modulation index.

102

iw

0

1 2
0

 3 - 1 20  3 - 2  6 + 0  3  6  2
 3 - 3

2 3

5 6


(a)

7 6

4 3

3 2

5 4 11 6

2

iw 1

0

 2 3
0

 3 - 1  3 -  2 20  6 - 0  3  6  2

2 3

5 6


(b)

7 6

4 3

3 2

5 4 11 6

2

Fig. 4.1 SHE-PWM waveforms: (a) six pulses per half-cycle and (b) eight pulses per half-cycle. The nonlinear and transcendental equations of (4.3) can be solved by a number of numerical methods [84], one of which is the Newton-Raphson iteration algorithm. At various modulation indexes, independent angles for six- and eight-pulse waveforms have been calculated and the solutions are shown in Fig. 4.2. In Fig. 4.2, no matter for six-pulse or eight-pulse waveform, the maximum modulation index is around 1.02, at which  0 becomes zero, the notch locating in the center of half-cycle PWM waveforms disappears. For a set of 1 ,  2 , and  0 , the gate signals for the switching devices in a CSC can be arranged. As Fig. 4.2 (a) shows, for six-pulse waveform, when ma is lower than 0.83, 1 is smaller than 0, which means that there are two cases of gate signal arrangements for six-pulse waveform. In Fig. 4.3, g1 and g 4 are the gate signals for S1 and S4 in a CSC. g1 is composed of six pulses, of which one is the bypass pulse, defined between 3 2 -  0 and
3 2 +  0 . If 1 is larger than 0, there are only two bypass intervals, which are caused by

103

bypass pulses, as Fig. 4.3 (a) shows. If 1 is smaller than 0, there are four bypass intervals per cycle. The bypass intervals, BP2 and BP4, are created by bypass pulses while the other two, BP1 and BP3, are due to the overlapping of the gate signals. Similarly, as Fig. 4.3 (b) shows, for eight-pulse waveform, when ma is lower than 0.98, 1 is smaller than 0. When ma is lower than 0.98, 1 is smaller than 0. If ma is between 0.89 and 0.98, 1 is smaller than  2 . If ma is between 0.26 and 0.89, 1 is larger than  2 , but smaller than 3 . With ma smaller than 0.26, 1 is finally larger than 3 . These four situations lead to four cases of gate signal arrangements for eight-pulse waveform. As Fig. 4.4 shows, g1 is composed of eight pulses. Similarly, there is one bypass pulse, defined between 3 2 -  0 and 3 2 +  0 . If 1 is larger than 0, there are only two bypass intervals, which are generated by bypass pulses, as Fig. 4.4 (a) shows. If 1 is smaller than 0, and 1 is larger than 3 , there are eight bypass intervals per cycle. The bypass intervals, BP3 and BP7, are created by bypass pulses while the other six are due to the overlapping of the gate signals, as Fig. 4.4 (d) shows.

104

 8
 12

2 0

 24
0
-  24
-  12

1

- 8

1  1

2  2

0  0

0

0.1 0.2 0.2 0.3 0.3 0.4 0.4 0.5 0.5 0.6 0.6 0.7 0.7 0.8 0.8 0.9 0.9 1.0 1.0 m 0.1 (a)

 8
 12

3 0

 24
0
-  24
-  12

2

1

- 8

 1

1

 2

2

3 3

  0

0

0.4 0.5 0.5 0.6 0.6 0.7 0.7 0.8 0.8 0.9 0.9 1.0 1.0 m 0.1 0.2 0.2 0.3 0.3 0.4 0.1 (b)

Fig. 4.2 Solutions to independent angles for SHE (a) six pulse per half cycle and (b) eight pulse per half cycle. 105

g1
1

Case I: ma  0.83  1  0
BP1

BP2

0



t

g4
1

0



t

iwa
0

 3 - 1 1 2 20  3 - 2  6 + 0



t

(a)
g1
1

Case II: ma < 0.83  1 < 0
BP1

BP2

BP3

BP4

BP1

0



t

g4
1

0



t

iwa
0

 3 - 1 1  3 -  2 20 2  6 +  0



t

(b) Fig. 4.3 Phase A gate signals for six-pulse waveform: (a) Case I and (b) Case II.

106

g1
1
BP1

Case I: ma  0.98  1  0
BP2

0 0



t

g4
1

0


2
 3 - 3

t

iwa
0

1

3

 3 - 2


20

t

 6 -  0  3 - 1

(a)
g1
1

Case II: 0.89<ma < 0.98  1 < 0 and 1 <  2 <  3
BP1

BP2

BP3

BP3

0 0



t

g4
1

0


2
 3 - 1

t

iwa
0

1

 3 - 3  6 - 0  3 - 2

3

20



t

(b)

107

g1
1

Case III: 0.26<ma < 0.89  1 < 0 and  2  1 <  3
BP1

BP2

BP3

BP4

0



t

g4
1

0



t

iwa
2
0

3  3 - 1  6 - 0  3 -  1  3 - 3 2

20



t

(c)
g1
1

Case IV: ma < 0.26  1 < 0 and  2 <  3  1
BP2
BP3

BP1

BP4

BP5

BP6

BP7

BP8

0



t

g4
1

0


 6 - 0

t

iwa
0

 3 - 1

1  3 - 3

20



t

 2 3

 3 - 2

(d) Fig. 4.4 Phase A gating signals for eight-pulse waveform: (a) Case I, (b) Case II, (c) Case III, and (d) Case IV. 108

4.2 Space Vector Based Selective Harmonic Elimination
In traditional modulator, the switching angles for SHE are directly used to generate PWM waveform. However, a fixed sampling frequency, f s , is normally used in MPC. The sampling process introduces a quantization error on the pre-calculated switching angles, as discussed in [80]. As a consequence, the elimination of undesired low-order harmonics may be compromised since the quantized angles may differ from the pre-calculated ones. In order to ensure an acceptable low-order harmonic elimination performance, a high sampling frequency needs to be used, which increases the requirement on calculating capability of hardware platform. As the foundation of MPSPC, a space vector based SHE with a fixed sampling frequency, but without quantization error is proposed here. The space vector representation of SHE waveform will be introduced first, then the realization of space vector based SHE will be presented in details. 4.2.1.1 Space Vector Representation of SHE At any instant of time, SHE waveforms for a CSC satisfy the switching constraints, which means that one corresponding space vector is applied. The space vector diagram can be referred to Fig. 2.2. Hence, based on the switching signals for the six switching devices in a CSC, SHE waveforms can be represented in space vector form. Here the SHE waveforms during the time interval between 0 and  3 are selected as an example. For six-pulse waveforms, shown in Fig. 4.3, since there are two cases of gate signal arrangements based on modulation index value, the space vector sequence during the selected interval also has two kinds of patterns, as Fig. 4.5 shows. Similarly, as Fig. 4.4 shows, since there are four gate signal arrangements for eight-pulse waveforms based on different modulation indexes, the four kinds of space vector sequences are shown in Fig. 4.6. It can be found from Fig. 4.5 and Fig. 4.6 that with 1 decreasing from positive value to negative value, more zero-state vectors appear in the space vector sequence due to the overlapping operation. Besides, the dwell time for each space vector can be calculated based on the difference between the start and the end terminals of one space vector, which changes with respect to different calculated optimal angles. Another thing is that during the selected duration, 109

  I 6 and I1 mainly appear in the above sequences as active-state vectors, which indicates that the

reference vector for generating SHE waveform locates in Sector VI of the space vector domain in Fig. 2.2. Since the sequences in Sector VI has been analyzed, the principle and regulation can be extended to other sectors. The dwell time for each space vector in the same case can also be used for other sectors. All the sequences in different sectors for six-pulse and eight-pulse waveforms have been listed in Table 4.1 and Table 4.2, respectively. Table 4.1 SPACE VECTOR SEQUENCES FOR SIX-PULSE WAVEFORM
Sector No. Sector I Sector II Sector III Sector IV Sector V Sector VI Case I        I1  I 2  I1  I 7  I 2  I1  I 2        I 2  I3  I 2  I9  I3  I 2  I3        I3  I 4  I3  I8  I 4  I3  I 4        I 4  I5  I 4  I7  I5  I 4  I5
       I5  I6  I5  I9  I6  I5  I6        I 6  I1  I 6  I 8  I1  I 6  I1

Case II        I 9  I 2  I1  I 7  I 2  I1  I 8        I8  I3  I 2  I9  I3  I 2  I 7        I 7  I 4  I3  I8  I 4  I3  I9        I9  I5  I 4  I 7  I5  I 4  I8
       I8  I 6  I5  I9  I 6  I5  I 7
       I 7  I1  I 6  I 8  I1  I 6  I 9

110

iwa

Case I: m a  0.83  1  0

0 0

0

 I6

1

 I1

2

 I6

 6 - 0

 I8

 6 + 0

 I1

 3 -  2  3 - 1  3

 I6

 I1

 I1

 I 2 ...

t

...
SECTOR I

SECTOR VI

(a)
iwa
Case II: ma < 0.83  1 < 0

0

0

 I7

1

 I1

2

 6 - 0

 I6

 I8

 6 + 0

 3 - 2

 I1

 I6

 3 - 1

 I9

 3 t

 I9

... ...

SECTOR VI

SECTOR I

(b) Fig. 4.5 Space vector sequence for six-pulse waveform: (a) case I and (b) case II.

111

iwa

Case I: ma  0.98  1  0

0

 0 1  2  I6 I1

 I6

3

 6 + 0  6 - 0  3 - 3

 I1 I 8

 I6

 I1

t  3 3  +   3-  1 1    3 - 2 I I  3 + 2
1 I6
1  I2

 I1 ...

...
SECTOR VI

SECTOR I

(a)
iwa
Case II: 0.89<ma < 0.98  1 < 0 and 1 <  2 <  3

0

0 1  2

  I 7 I1

 I6

3

 6 - 0

 I1

 I8

 6 + 0

 I6

 3 - 3

 I1

 3 +  2 t  3 - 2  3 - 1  3  3 + 1

     I 6 I 9 I 9 I 2 I1 ...

...
SECTOR VI

SECTOR I

(b)
iwa
0

Case III: 0.26<ma < 0.89  1 < 0 and  2  1 <  3

t
2
1

0

 I7

 I5

 I6

3  6 -  0

 I1

 I8

 6 +  0  3 - 3

 I6

 I1

 3 - 2  3 + 2  3 - 1  3

 I2

 I9

 I9

 I 6 ...

...
SECTOR VI

SECTOR I

(c)
iwa
0

Case IV: ma < 0.26  1 < 0 and  2 <  3  1

t
 2 3 1
 6 - 0  6 + 0

0

 I7

   I 5 I 7 I1

 I8

 3 - 1  3 -  2  3 - 3

   I6 I9 I 2

 I9

 3

 I9

... ...

SECTOR VI

SECTOR I

(d) Fig. 4.6 Space vector sequence for eight-pulse waveform: (a) case I, (b) case II, (c) case III, and (d) case IV. 112

Table 4.2 SPACE VECTOR SEQUENCES FOR EIGHT-PULSE WAVEFORM
Sector No. Sector I Case I    I1  I 2  I1     I 2  I 7  I1     I 2  I1  I 2    I 2  I3  I 2     I3  I9  I 2     I3  I 2  I3    I3  I 4  I3     I 4  I8  I3     I 4  I3  I 4    I 4  I5  I 4     I5  I7  I 4     I5  I 4  I5    I5  I6  I5     I6  I9  I5     I6  I5  I6    I 6  I1  I 6     I1  I 8  I 6     I1  I 6  I1 Case II    I 9  I 2  I1     I 2  I 7  I1     I 2  I1  I 8    I8  I3  I 2     I3  I9  I 2     I3  I 2  I7    I3  I 4  I3     I 4  I8  I3     I 4  I3  I 4    I9  I5  I 4     I5  I7  I 4     I5  I 4  I8    I8  I 6  I5     I6  I9  I5     I6  I5  I7    I 7  I1  I 6     I1  I 8  I 6     I1  I 6  I 9 Case III    I 9  I 6  I1     I 2  I 7  I1     I 2  I3  I8    I 8  I1  I 2     I3  I9  I 2     I3  I 4  I7    I7  I 2  I3     I 4  I8  I3     I 4  I5  I9    I9  I3  I 4     I5  I7  I 4     I5  I 6  I8    I8  I 4  I5     I6  I9  I5     I 6  I1  I 7    I7  I5  I6     I1  I 8  I 6     I1  I 2  I 9 Case IV    I9  I6  I9     I 2  I 7  I1     I8  I3  I8    I 8  I1  I 8     I3  I9  I 2     I2  I4  I7    I7  I2  I7     I 4  I8  I3     I9  I5  I9    I9  I3  I9     I5  I7  I 4     I8  I 6  I8    I8  I 4  I8     I6  I9  I5     I 7  I1  I 7    I7  I5  I7     I1  I 8  I 6     I9  I 2  I9

Sector II

Sector III

Sector IV

Sector IV

Sector VI

4.2.2 Realization of Space Vector Based SHE
In most applications, load currents are directly regulated by power converters. For a CSC, its output PWM current reference can be calculated based on the summation of load current reference and low frequency components in capacitor current. The reference vector for generating output PWM currents can be given by
 * * j w iw* = I w e

(4.5)

* * where I w is the magnitude of the reference vector, and  w is the angle of the reference vector in

space vector domain. Based on (4.4), the modulation index can be obtained. Based on the angle,
* w , the sector number, in which the reference vector for output PWM current locates, can be

113

determined. Then, the angle of the reference vector, with respect to its corresponding sector, can be obtained. According to the modulation index, the optimal angles can be selected from the precalculated look-up table, then the space vector sequence, corresponding to the calculated modulation index and a specified sector, can be decided. Finally, based on the angle of the reference vector, with respect to the corresponding vector, the location of the start point of one sampling interval can be obtained in one sector sequence. Since a fixed sampling frequency is used here, the sampling interval is a constant value. Normally, for MPC, the sampling frequency is selected as high as 20kHz, even 50kHz in some cases. Here, taking into consideration of the calculation capability of most state-to-art DSPs, 10kHz sampling frequency is selected. With a constant sampling frequency and the information on the start point of one sampling interval, the location of the end point of the same sampling interval can also be calculated. Here the space vector sequence in Case I of six-pulse waveforms is selected as an example. During the sampling interval, there are possibly three scenarios of space vector combinations, as Fig. 4.7 shows. In Fig. 4.7 (a), only one vector is applied during the whole sampling interval. As Fig. 4.7 (b) shows, if the sampling interval locates between two vectors, the applied vector needs to be changed once during the interval. There is another situation in which the applied vector, during one sampling interval, needs to be changed twice, as Fig. 4.7 (c) depicts. Since 1 and

 0 can be very close to 0 at some specified modulation index, one sampling interval is possibly
divided into three parts belonging to three space vectors. In fact, there are only two start point locations of sampling interval, which possibly leads to this situation. When the sampling interval locates around the half center of the PWM waveform, there may be three vectors contained inside the sampling interval, as the red rectangular shown in Fig. 4.7 (c). When the start point of the sampling interval locates near the end of the sector, the end point of the sampling interval may locate in the next sector. With a tiny value of 1 , the sampling interval also possibly contains three space vectors, as the red dotted rectangular shows in Fig. 4.7 (c). For eight-pulse SHE waveform, the three situations also exist, when the values of 1 and  0 are very small. Moreover, with higher sampling frequency or smaller sampling interval, the above discussion still holds true.

114

Based on a specified space vector sequence and the locations of the start point and end point of one sampling interval, the space vectors and their respective dwell time during one sampling interval can be determined. With a saw-tooth carrier, of which the frequency is equal to the sampling frequency, the selected space vectors can be modulated with their corresponding dwell time during one sampling interval, as Fig. 4.7 shows. Since in one sampling interval, space vector can maximum be changed twice, the quasi-modulation method can be easily realized on DSP or FPGA platform. Moreover, with space vector based SHE, there is no quantization error introduced by a fixed sampling frequency, since there is no compromise on practically applied switching angles in contrast to pre-calculated ones.

115

Case I: ma  0.83  1  0

SECTOR VI
0

SECTOR I

 I6

1

 I1

2

 I6  I6
Ts

 6 - 0  6 + 0

 I8

 I1

 3 - 2

 3 - 1

 I6

 I1

 3

 I1

 I 2 ...

t

...

t

(a)
SECTOR VI
0

SECTOR I

 I6

1

 I1  I1

2

 I6  I6

 6 - 0  6 + 0

 I8

 I1

 3 - 2

 3 - 1

 I6

 I1

 3

 I1

 I 2 ...

t

...

t

Ts

(b)
SECTOR VI
0

SECTOR I

 I6

1

 I1

2

 I6

 6 - 0  6 + 0

 I8

 I1

 3 - 2

 3 - 1

 I6

 I1

 3

 I1

 I 2 ...  I2 t

t

...

 I6

 I8
Ts

 I1

 I6

 I1
Ts

(c) Fig. 4.7 Space vectors during one sampling interval: (a) one vector, (b) two vectors, and (c) three vectors.

4.3 Proposed Model Predictive Switching Pattern Control
With space vector based SHE, SHE waveform can be generated without quantization error, even with a fixed sampling frequency. However, SHE waveform generated by the method can 116

only ensure steady state performance. It is caused by two reasons, one is that when calculating the reference vector for generating output PWM currents for a CSC, capacitor current compensation only incorporates steady state capacitor currents with transient responses totally ignored, the other is that the essence of SHE modulation is an offline modulation method, which only guarantees steady state performance. In this section, MPSPC is proposed to improve the transient responses of space vector based SHE. In steady state, the output PWM waveforms of a CSC follow SHE-PWM pattern. During transients, the output PWM waveform will be naturally changed, and regulated by MPC approach in order to acquire better dynamic performance. Compared to the existing MPC schemes with low switching frequencies, there is no weighting factor selection issue, such as the one used to associate the predicted load currents and SHEbased output voltage states together in one cost function, as presented in [80]. Fig. 4.8 shows the  control block diagram of MPSPC for a CSC with a three-phase RL load. In Fig. 4.8, iwSHE represents the selected space vectors based on SHE-PWM pattern during one sampling interval. The selected space vectors and their respective dwell time based on SHE-PWM pattern are sent  into MPSPC stage, then the final output PWM current vector, iw , can be determined, and used to generate the gate signals for the switching devices in a CSC.
I dc Ldc 2

L
Ldc 2
+

 i

R
o

C
S1 to S6 Gating Signal

-

 vC

o

MPSPC

 iwSHE Vector based

 iw*

* * I wd + j  I wq

 vC  i I dc

Generation  iw

Space

e j  * I wdq ×

I

* wd

I Cd + * + Id

* I wq

SHE
* Id
* Iq e j

++ I Cq

* Iq

Fig. 4.8 Block diagram of MPSPC for a CSC. 117

4.3.1 Reference Calculation in Steady State
With load current references, the references for generating output PWM currents in dq-axis synchronous frame can be calculated as
LP * *  = Id + I Cd  I wd  * LP * = Iq + I Cq   I wq

(4.6)

in which
LP LP   I Cd = -CVCq  LP LP   I Cq = CVCd

(4.7)

LP LP LP LP , VCq , I Cd , and I Cq are the low frequency components of capacitor voltages and where VCd

capacitor current in dq-axis synchronous frame. It can be found from (4.7) that the transient responses of capacitor currents are totally ignored. Finally, the reference vector for generating output PWM currents in  -axis stationary frame can be given by
 iw* =

(I

* wd

* + jI wq ) e j

(4.8)

where  is the space angle of the synchronous frame, which has different definitions in different applications. In motor drives,  is equal to the angle of estimated rotor flux vector. On the other hand, grid-connected rectifier or inverter applications, a phase-lock-loop (PLL) is used to acquire the angle of power supply voltage vector, which is the angle of the synchronous frame in these cases.

4.3.2 Principle of Model Predictive Switching Pattern Control
Here, for simplicity, a CSC, which is connected to a three-phase RL load, is selected as an example. Hence, with space vector based SHE, the load current vector at (k+1)th sampling instant can be predicted based on output PWM current vector following SHE-PWM pattern and corresponding dwell time based on (2.18). Here, the case in Fig. 4.7 (b) is used as an example, in   which I 6 and I1 are applied during one sampling interval. Here it is assumed that the dwell time

118

 for I 6 is equal to T1 , then the effect of the output PWM current vector, which is also the input in

(2.18), during the sampling interval can be given by
  Ts u = T1 I 6 + (Ts - T1 ) I1

(4.9)

Based on (2.18) and (4.9), the load current vector at the end of the sampling interval can be predicted. A cost function is established here to evaluate the performance on tracking load current reference vector with SHE-PWM pattern, and given by
 p ^ * (k + 1) - i (k + 1) i J (k ) =  ^ * (k + 1) i

(4.10)

 p ^ * (k + 1) - i where i (k + 1) represents the Euclidean distance between the estimated load current
 ^ * (k + 1) is equal to reference vector and the predicted load current vector at (k+1)th instant, and i  i * (k )  e jTs . J (k ) represents a ratio between the Euclidean distance and modulus of the load

current reference vector, which can be directly used to evaluate the performance on tracking the load current reference vector. Since SHE-PWM pattern cannot guarantee satisfactory performance during transients, a maximum limitation of the cost function, J max , can be defined, which is used as a criteria for determining the transition between SHE-PWM pattern and MPC based approach. When the value of J (k ) is smaller than J max , the performance on tracking load current reference with SHE-PWM pattern is acceptable, and the output PWM current of the CSC will follow SHE  PWM pattern, which means that iw is equal to iwSHE . If J (k ) is larger than J max , the output PWM current of the CSC during this sampling interval will be regulated through MPC approach. Here a dead-beat concept is introduced into MPSPC. Based on (2.20) and load current reference vector, the optimal output PWM current vector for the CSC, which eliminates the error between the load current vector and its reference vector in just one sampling interval, can be given by

   ^ * (k + 1) -  v  op -  i k i ( ) 21 C 22 ( k ) iw (k ) =

21

(4.11)

119

where 21 , 22 , and 21 denote the elements in the prediction matrices,  and  , which have been given in (2.19). Taking delay compensation into consideration, the two-step prediction method, which is presented in Section 1.5.2, is also employed here, with which the load current reference vector should also be shifted one step forward. Finally, the cost function in (4.10) can be modified as
 p ^ * (k + 2) - i (k + 2) i J (k + 1) =  ^ * (k + 2) i
 ^ * (k + 2) is the load current reference vector at (k+2)th instant, and can be given by where i   ^ * (k + 2) i = i * (k )  e j 2Ts

(4.12)

(4.13)

in which  is the angular output frequency of the CSC. Hence, if J (k + 1) is larger than J max , the optimal output current vector for (k+1)th sampling interval, can be given by    ^ * (k + 2) -  v ^ ^  op i 21 C ( k + 1) - 22 i ( k + 1) iw (k + 1) = (4.14)

21

  ^ (k + 1) are the estimated capacitor voltage vector and load current vector ^ (k + 1) and i where v C

based on the space vector applied during kth sampling interval and the measured capacitor voltage vector and load current vector at kth sampling instant.

 Here, unlike in traditional dead-beat controls, iwop (k + 1) is not synthesized through SVM,
since a high sampling frequency in MPSPC would lead to a large number of commutations during transients, which is not suitable for high power applications. To reduce the number of  possible commutations, the space vector, which is the closet to iwop (k + 1) , would be selected and applied during the whole sampling interval, which is called low-complexity MPC in [50, 51], and preserves the advantage of conventional MPC with simpler realization. According to the six active-state space vectors, the space vector domain can be divided into six segments, and the 120

 segment, where iwop (k + 1) locates, just corresponds to the active-state space vector, that is the    op most adjacent to iwop (k + 1) , as Fig. 4.9 shows. For instance, both iwop 1 ( k + 1) and iw 2 ( k + 1) locate  in Segment II, which represent two possible situations appearing in one segment. For iwop 1 ( k + 1) ,   op   k + ( 1) ( 1) i k + since the length between iwop and is shorter than the modulus of , I I 1 w1 2 2 needs to  be selected and applied during the sampling interval. In contrast, the length between iwop 2 ( k + 1)   and I 2 is longer than the modulus of iwop 2 ( k + 1) , so zero-state vector should be chosen instead of  I 2 . Due to the redundancy of zero-state vectors, the finally applied zero-state vector should be     selected according to the last applied space vector, such as I 7 corresponding to I1 or I 2 , I 8      corresponding to I 3 or I 4 , and I 9 corresponding to I 5 or I 6 .


 I3

gm

 I7    I8   I9  

 I4

Segment III

 iwop 1

  iwop 1 - I2
 I2

IV

Se gm

ent

 iwop 2

Se

  iwop - I 2 2

ent II



gm

ent

Se gm ent

I

 I5

Segment VI

 I1

 I6

Fig. 4.9 Segment distribution on current vector domain. The optimally selected space vector can be applied instead of original SHE-PWM pattern during the sampling interval to realize fast and improved transient responses. After transient 121

Se

V

process, when J (k + 1) gradually decreases to the value smaller than J max , SHE-PWM will be retrieved and applied again. Fig. 4.10 shows the flowchart diagram of MPSPC. In comparison with the existing low switching frequency MPCs, there is no weighting factor tuning issue in the cost function. Though the maximum limitation, J max , is required to be selected, it has more significant physical meaning in contrast to a weighting factor associating two values with different units, since it directly represents the error between the predicted load current vector and its reference. Normally, J max can be selected as around 15% to satisfy requirements in most application.
 Calculate Output Current Reference iw*

Space Vector and Dwell Time during kth Sampling Interval Through Space Vector based SHE

Delay Compensation based on (2.18)
Load Current Prediction based on (2.18)

Cost Function Calculation based on (4.12)

J (k + 1)  J max

No
Optima l Output Current Vector Calculation Based On (4.14)

Yes
Apply Optimal Space Vector During kth Sampling Interval

Optimal Space Vector Selection

Fig. 4.10 Flowchart diagram of MPSPC. 122

4.4 Simulation Validation
The simulation results for a 1MW/4160V CSC are presented in this section. The parameters used in simulation are listed in Table 4.3. MPSPC with six-pulse and eight-pulse SHE-PWM pattern are both verified in simulation. The DC current is provided by an ideal DC current source, of which the value is kept at the rated DC current of 196A. The sampling frequency of 10kHz, meaning sampling interval of 100s is used for MPSPC. The value of J max is selected as 15%. Table 4.3 PARAMETERS IN SIMULATION AND EXPERIMENTS
Item Simulation Experiment Rated power 1MW 3kW Rated voltage 4160V 208V Capacitor 0.5pu 0.6304pu Filter inductor 0.3pu 0.2614pu Load resistor 0.3pu 0.3467pu

4.4.1 Steady State Performance
Table 4.4 lists the steady state performance of MPSPC at the operating condition of the daxis load current reference equal to 196A, and the q-axis load current reference equal to 0A. For comparison, the results of conventional SHE-MPC with quantization error are also provided, in which the sampling frequency is still 10kHz. It can be found that with conventional SHE-MPC, the unwanted low-order harmonics, no matter 5th and 7th for six-pulse waveform or 5th, 7th, and 11th for eight-pulse waveform, cannot be completely eliminated due to the effect of quantization errors. In contrast, MPSPC totally completes the objectives of low-order harmonic elimination. Though a constant sampling frequency is used in MPSPC, there is no compromise on finally applied switching angles, caused by quantization error, in comparison with pre-calculated optimal ones.

123

Table 4.4 SIMULATED STEADY STATE PERFORMANCE
SHE Harmonic order PATTERN 5th (%) 7th (%) 11th (%) 13th (%) Six-pulse 2.50 4.06 58.4 21.3 Traditional SHE-MPC Eight-pulse 1.66 1.98 3.06 36.3 Six-pulse 0.06 0.27 57.0 22.5 MPSPC Eight-pulse 0.28 0.06 0.16 36.8 Control scheme

4.4.2 Transient Responses
Compared to space vector based SHE without prediction process, MPSPC improves dynamic performance. For comparison, the transient responses with space vector based SHE are provided as well. In Fig. 4.11, the output frequency of the CSC is 60Hz, and six-pulse SHE waveform is used here. At time t of 0.1s, the d-axis load current reference drops from 196A to only 39.3A. The q-axis load current reference is kept at 0 during the whole process. During the transient process, the settling time, Tset , of the load current is measured with its response staying in a range of 5% of the rated value. It can be observed from Fig. 4.11 (a) that the transient responses of the load currents are very sluggish, and the settling time is equal to 23ms with space vector based SHE. Since the capacitor and the filter inductor in the CSC construct an LC resonance tank, obvious resonance can be observed in the load current, especially when transformed into dq-axis synchronous frame. On the other hand, during transients, with MPSPC, since the value of the cost function following SHE-PWM pattern can be easily higher than J max , the output PWM pattern of the CSC is naturally changed from SHE-PWM waveform to optimally selected space vectors by MPC approach, with which the load currents fast track their respective references, and the settling time is reduced to only 14ms. Moreover, LC resonance is suppressed, since the optimally selected space vector during the transients forces the load currents to follow their respective references. After the transients, it can be found that the output PWM pattern returns to SHE-PWM waveform due to the gradually reduced value of the cost function in the steady state. Hence, without weighting factor tuning issue, MPSPC can still keep SHE-PWM in steady state, and improves dynamic performance during transients.

124

200 200

/(A) (A)

iwa

ii

w a wa

0
-200 -200 200 200

/(A) (A)

ia

ib

ic

ii

abc abc

0 -200 -200

/(A) (A)

200 200 100 100

* , i iIref ,I

dq dq

Id

* Id

Tset = 23 ms

Iq

* Iq

dq dq

0
-100 -100 0.06 0.06 0.07 0.07 0.08 0.08 0.09 0.09 0.1 0.1 0.11 0.11 0.12 0.12 0.13 0.13
t s t/s

(a)
200 200

/(A) (A)

iwa

ii

w a wa

0
-200 -200 200 200

/(A) (A)

ia

ib

ic

ii

abc abc

0
-200 -200

/(A) (A)

200 200 100 100

* , i iIref ,I

dq dq

Id

* Id

Tset = 14 ms

Iq

* Iq

dq dq

0
-100 -100 0.06 0.06 0.07 0.07 0.08 0.08 0.09 0.09 0.1 0.1 0.11 0.11 0.12 0.12 0.13 0.13
t s t/s

(b) Fig. 4.11 Transient responses with six-pulse SHE waveform: (a) space vector based SHE and (b) MPSPC. Fig. 4.12 shows the transient response during the change between six-pulse and eight-pulse SHE-PWM waveform. At time t of 0.1s, the output frequency of the CSC decreases from 60Hz to 50Hz, which makes the SHE-PWM pattern change from six pulse to eight pulse. At the same 125

time, the d-axis load current reference decreases from 196A to 98A, and the q-axis load current reference is kept at 0. With space vector based SHE, the transient responses are slow, and resonance appears in the load currents. With MPSPC, the dynamic performance of the load current is improved with the decrease of the settling time from 19ms to 16ms, and LC resonance is suppressed during the transients as well.

126

200 200

/(A) (A)

iwa

ii

w a wa

0
-200 -200 200 200

/(A) (A)

ia

ib

ic

ii

abc abc

0 -200 -200

*, i iref / (A) I dq ,I dq dq dq (A)

200 200 100 100

Tset = 19ms

Id

I

* d

Iq

* Iq

0
-100 -100 0.06 0.06

0.07 0.07

0.08 0.08

0.09 0.09

0.1 0.1

0.11 0.11

0.12 0.12

0.13 0.13

t s t/s

(a)
200 200

/(A) (A)

iwa

ii

w a wa

0
-200 -200 200 200

ia

ib

ic

/(A) (A) ii
abc abc

0
-200 -200

/ (A) (A)

200 200 100 100

Tset = 16ms

Iq

* Iq

iref I * ,, iI

dq dq dq dq

Id

* Id

0
-100 -100 0.06 0.06 0.07 0.07 0.08 0.08 0.09 0.09 0.1 0.1 0.11 0.11 0.12 0.12 0.13 0.13
t s t/s

(b) Fig. 4.12 Transient performance during the change of output frequency: (a) space vector based SHE and (b) MPSPC.

127

4.5 Experimental Validation
The experimental validation of MPSPC with six-pulse and eight-pulse SHE-PWM patterns is also conducted. The parameters used in experiments have already been listed in Table 4.3. The sampling frequency is still 10kHz, meaning the sampling interval of 100s , and J max is still 15%. The DC current is kept at 11.8A, which is the rated value for a 3kW/208V CSC.

4.5.1 Steady-State Performance
The experimental results of conventional SHE-MPC and MPSPC are both presented at the operating condition of the d-axis load current reference equal to 11.8A and the q-axis load current reference equal to 0. Fig. 4.13 shows phase A load current, phase A output PWM current, and its spectrum diagram of conventional SHE-MPC and MPSPC. Due to quantization error, the output PWM current of conventional SHE-MPC contains obvious low-order harmonics. Moreover, as can be observed in Fig. 4.13 (b), the quantization effect makes some very small pulses missing from the eight-pulse waveform, which leads to only six or seven pulses per half cycle. On the other hand, MPSPC achieves better performance on low-order harmonic elimination than conventional SHE-MPC, no matter with six-pulse or eight-pulse SHE-PWM pattern. The details on the low-order harmonic contents are listed in Table 4.5. With MPSPC, the unwanted low-order harmonics can be mitigated to very small amounts. It can be found that the harmonic contents in Table 4.5 are higher than the results presented in Table 4.4. The reason is that the DC current used in experiments is not ideal, and contains some ripples, which leads to some compromises on low-order harmonic elimination.

128

iwa

iwa

Fun

5th

7th

11th

13th

Fun

5th

7th

11th

13th

ia

ia

CH2:10A/Div CH4:10A/Div

CH2:10A/Div CH4:10A/Div

(a)
iwa

(b)
iwa

Fun

5th

7th

11th

13th

Fun

5th

7th

11th

13th

ia

ia

10ms Div

CH2:10A/Div CH4:10A/Div

10ms Div

CH2:10A/Div CH4:10A/Div

(c)

(d)

Fig. 4.13 Spectrum diagram of experimental output PWM currents: (a) six-pulse SHE-MPC, (b) eight-pulse SHE-MPC, (c) six-pulse MPSPC, and (d) eight-pulse MPSPC. Table 4.5 EXPERIMENTAL STEADY STATE PERFORMANCE
Control scheme Traditional SHE-MPC MPSPC SHE PATTERN Six-pulse Eight-pulse Six-pulse Eight-pulse Harmonic order 5th (%) 7th (%) 11th (%) 13th (%) 6.36 2.73 60.0 20.0 2.63 5.26 2.61 42.1 0.91 0.91 61.8 20.0 0.45 0.91 1.81 50.9

4.5.2 Dynamic Performance
Fig. 4.14 shows the experimental transient responses with six-pulse SHE-PWM waveform. The output frequency is 60Hz, and the d-axis load current reference suddenly drops from 11.8A to 2.36A. From top to bottom, the phase A output PWM current, the phase A load current, the dq-axis load current components, and their respective references are shown. With space vector 129

based SHE, significant resonance can be observed in the waveforms of the dq-axis load currents, as Fig. 4.14 (a) shows. The settling time is equal to 21ms. Fig. 4.14 (b), with MPSPC, the d-axis load current changes from 11.8A to 2.36A faster, and resonance in the load currents is suppressed with the decrease of the settling time to 13ms. The transition from SHE-PWM pattern to MPC can be observed from the output PWM current waveform during the transient. After the transient, the output PWM current of the CSC is governed by SHE-PWM again.
iwa iwa

ia

ia
CHM:10A/Div CH2:10A/Div
10ms Div

CHM:10A/Div CH2:10A/Div
10ms Div

* Id

CH1:3A/Div CH2:3A/Div CH3:3A/Div CH4:3A/Div

* Id

CH1:3A/Div CH2:3A/Div CH3:3A/Div CH4:3A/Div

Id
Tset = 21ms
* Iq
10ms Div

Id
Tset = 13ms
* Iq
10ms Div

Iq
(a)

Iq

(b)

Fig. 4.14 Experimental transient responses with six-pulse SHE waveform: (a) space vector based SHE and (b) MPSPC. Fig. 4.15 shows the experimental results the change from six-pulse to eight-pulse SHE-PWM. The output frequency is initially 60Hz, then changes to 50Hz with SHE-PWM pattern modified from six-pulse to eight-pulse. At the same time, the d-axis load current reference drops from 11.8A to 4.72A. Similarly, with the transition from SHE-PWM pattern to MPC with MPSPC, LC resonance is suppressed, the response of the load currents becomes faster, and the settling time decreases from 20ms to 14ms, in comparison with the results of space vector based SHE, which also verifies the improvement on dynamic performance with MPSPC.

130

iwa

iwa

ia

ia

10ms Div

CHM:10A/Div CH2:10A/Div
* Id

10ms Div

CHM:10A/Div CH2:10A/Div
* Id

CH1:3A/Div CH2:3A/Div CH3:3A/Div CH4:3A/Div

CH1:3A/Div CH2:3A/Div CH3:3A/Div CH4:3A/Div

Id
Tset = 20ms
* Iq
10ms Div

Id
Tset = 14ms
* Iq
10ms Div

Iq
(a)

Iq

(b)

Fig. 4.15 Experimental transient performance during the change of output frequency: (a) space vector based SHE and (b) MPSPC.

4.6 Conclusions
In this chapter, MPSPC has been presented. In comparison with the state-of the-art schemes, MPSPC offers three major advantages · As the foundation of MPSPC, space vector based SHE eliminates the quantization effect introduced by constant sampling frequency of MPC. Without quantization error, loworder harmonics elimination based on pre-calculated optimal switching angles can be thoroughly completed; · Another benefit offered by MPSPC is that there is no weighting factor used in it. Though a maximum discrepancy limitation of regulating load currents needs to be selected to ensure transition between SHE-PWM pattern and optimal output current vector selected by MPC during transients, it owns more significant meaning in contrast to a weighting factor; · MPSPC only uses one-step or horizon-one prediction, which leads to a simpler structure, and reduces complexity, in comparison with existing multi-step schemes. 131

5 Model Predictive Space Vector Pattern Control for High Power Current-Source Converter-Fed Medium-Voltage Induction Motor Drive
MPSPC has been presented in Chapter 4. However, the optimal switching angles to generate SHE-PWM pattern still need to be pre-calculated and stored, which makes MPSPC not suitable for motor drive application with variable output frequency, either. The concept of MPSPC can be further expanded, and involved with space vector modulation (SVM). In this section, based on the core methodology of MPSPC, model predictive space vector pattern control (MPSVPC) is proposed for high power CSC-fed MV IM drives. The innovation of this scheme is very similar to that of MPSPC, but MPSVPC is involved with SVM, which is an online modulation method. The merits of MPSVPC can be classified as · · · In contrast to traditional SVM, MPSVPC preserves a fixed and very low switching frequency in steady state, and improves dynamic performance during transient processes; In comparison with MPSPC, there is no requirement on calculation of optimal switching angles in MPSVPC; Last but not least, MPSVPC is still totally based on one-step prediction, and there is no weighting factor selection issue in it.

5.1 Model Predictive Space Vector Pattern Control
5.1.1 Limitation of Traditional Modulation and Linear Control
The configuration of a high power CSC-fed MV IM drive has been illustrated in Fig. 2.4. The control block diagram of the traditional linear controls for high power CSC-fed MV IM drive has been presented in Section 1.4, in which delay angle control is used for CSR, and FOC is applied into CSI. Though traditional linear controls are widely adopted in high power CSC-fed MV IM drive, they still have some drawbacks especially in terms of transient responses. The reasons resulting in their relatively poor dynamic performance are mainly three folds as 132

1) First, in order to minimize switching losses, the switching frequency of CSC is normally kept at several hundred hertz in high power MV applications, which leads to a relatively long control period and sluggish tuning of controllers; 2) Second, only steady state components in capacitor currents are compensated at CSI side, which makes dynamic performance of stator current not guaranteed; 3) Finally, three-phase capacitors construct LC resonance tanks with line inductor at CSR side and leakage inductor at CSI side, which further deteriorates transient responses due to possible LC resonance. On the other hand, traditional SVM imposes some constraints on dynamic performance of CSC in high power MV IM drives as well. As an online modulation method, SVM can be flexibly used to generate output waveform with variable frequency. However, the output current reference vector is always synthesized over one relatively long control period, which weakens the speed and accuracy of responses during transient process.

5.1.2 Model Predictive Space Vector Pattern Control
Since the dynamic performance of traditional SVM is limited by its relatively long control period in order to keep low switching frequency, MPSVPC is proposed, which reserves fixed and low switching frequency as that of traditional SVM in steady state, and achieves improved dynamic performance. As Fig. 5.1 (a) shows, in traditional SVM, the dwell time for each current vector is only updated once during one control period of traditional SVM, Ts' . In contrast, Fig. 5.1 (b) illustrates that with MS-SVM, the dwell time for each current vector is updated several times during every control period. Furthermore, Fig. 5.1 (c) shows that in MPSVPC every control period can be evenly divided into several small sampling intervals. The space vectors applied during every sampling interval can be determined based on space vector sequence, that is deduced through traditional SVM. According to space vectors and respective dwell time of each space vector during every sampling interval, the values of state variables at the end of sampling interval can be predicted based on prediction model and information on state variables at the beginning of sampling interval. The core part of MPSVPC is that based on pre-defined criteria, if the evolution of state variables based on space vector pattern set by traditional SVM 133

can fulfill this criteria, the applied space vector will just follow traditional space vector modulation pattern, which keeps a relatively low and fixed switching frequency. On the other hand, especially during transient process, due to the constraints imposed by the relatively long control period of traditional SVM, space vector pattern based on traditional SVM would fail to meet the criteria, so a reselected space vector would be applied during the sampling interval instead of the space vector pattern based on traditional SVM in order to improve dynamic performance.
 I1
Ts' T + T2' T1 + T2
' 1

 I2

 I0

 I1

 I2

 I0
Ts'

 I1
Count Value

 I2

 I0

 I1

 I2

 I0

Count Value

......

T1 + T2

......

T1
T1'

T1

...... ......

0

T1

T2

T0

T1'

T2'

T0'

t

0

T1

T2

T0

T1'

T2

T0

t

(a)
 I1
Ts'
Count Value
...... ......

(b)
 I2  I0  I1  I2  I0

T1 + T2

T1

...... ......

0
Ts' / N

T1
Count Value

T2

T0

T1

T2

T0

t

...
0
Ts' / N

...
t

Ts

(c)

Fig. 5.1 Diagram of relation between sampling interval of MPSVPC and control period of traditional SVM: (a) traditional SVM, (b) MS-SVM, and (c) MPSVPC. Following the mechanism of MPSVPC, there are three situations of the applied space vector during one sampling interval, as Fig. 5.2 shows. In Fig. 5.2 (a), the sampling interval locates inside the range of one space vector, which makes one space vector conducted during the whole 134

sampling interval. Fig. 5.2 (b) shows the second case in which one transition between two space vectors are applied during the sampling interval. The last case, as shown in Fig. 5.2 (c), possibly happens when the dwell time for the second space vector based on tradition SVM is very short, and the sampling interval includes the entire dwell time of the second space vector inside it, which leads to that there are three space vectors conducted during one sampling interval.
 I1
Count Value

 I2

 I0
Count Value

 I1

 I2

 I0

Ts' / N

Ts

Ts' / N

Ts
 I2  I0
Ts' / N

0

 I1
Ts' / N
(a)
 I1
Count Value

t

0

t

(b)
 I2  I0

Ts' / N

Ts
 I1  I2
Ts' / N

 I0

0

t

(c)

Fig. 5.2 Diagram of three situations of applied space vectors in one sampling interval with MPSVPC. Based on the space vectors and the respective dwell time of them applied during one sampling interval, and the values of state variables at the beginning of the interval, the value of state variables at the end of the sampling interval can be predicted based on (2.21) and (2.28) for CSR and CSI in a high power CSC-fed MV IM drive.

135

A cost function can also be established here to assess the performance on tracking load current reference vector with traditional SVM pattern in one sampling interval, which is given by

J (k ) =

 p ^ * (k + 1) - i i (k + 1) IR
(5.1)

 ^ * (k + 1) denotes the estimated load current reference vector at (k+1)th sampling instant, where i   which is given by i * (k )  e jTs ; i p (k + 1) is the predicted load current vector at (k+1)th sampling

instant; I R is the magnitude of rated load current. The cost function represents a ratio between the predicted error on tracking load current reference vector with traditional SVM space vector pattern and rated load current magnitude, which is used to evaluate the performance on tracking reference. Since space vector pattern based on traditional SVM cannot guarantee satisfactory performance during transients, a maximum value of (5.1), J max , is defined, and used as an evaluation index to determine transition between traditional SVM and MPC approach. If J(k) is smaller than J max , the performance on tracking reference based on traditional SVM switching pattern is acceptable, and the output PWM current of CSC will follow traditional SVM space vector pattern. On the other hand, if J (k ) is larger than J max , the output PWM current of CSC during the sampling interval will be regulated by MPC approach, through which an optimal space vector is going to be selected, then conducted over the whole sampling interval. Similar as the selection process in MPSPC, based on load current reference vector and corresponding prediction model, an optimal output current vector, which eliminates the error between load current vector and its reference within only one sampling interval, can be given by

    ^ * (k + 1) -   v  op i C ( k ) - 22  i ( k ) -  21  u1 ( k ) 21 iw (k ) =

22

(5.2)

 where 21 , 22 , 21 , and 22 are the elements in prediction matrices,  and  ; u1 (k ) represents the first input vector, which is determined according to different applications. At CSR

136

 side, u1 (k ) is equal to power supply voltage space vector, whereas it is equal to rotor flux vector at CSI side. Taking delay compensation into consideration, based on the two-step prediction method, (5.1) should be shifted one step forward, and can be given by

 p ^ * (k + 2) - i i (k + 2) J (k + 1) = IR

(5.3)

 ^ * (k + 2) is the estimated load current reference vector at (k+2)th sampling instant, which where i   is equal to i * (k )  e j 2Ts , and i p (k + 2) is the predicted load current vector based on the space

vectors applied during (k+1)th sampling interval based on traditional SVM space pattern, and the estimated load current vector at (k+1)th sampling instant. If J (k + 1) is larger than J max , the optimal output current vector can be given by     ^ (k + 1) -   u ^ * (k + 2) -   v ^ (k + 1) -   i  op i C 21 22 21 1 ( k + 1) iw (k + 1) =

22

(5.4)

   ^ (k + 1) , and u ^ (k + 1) , i where v C 1 ( k + 1) are the estimated state variables and the first input at

(k+1)th sampling instant. Similarly as in MPSPC, in order to reduce the number of switching commutations, the space  vector, which is the most adjacent to iwop (k + 1) , would be selected and applied during the whole sampling interval. The selection process has been discussed in Section 4.3.2. Fig. 5.3 shows the flowing chart of optimal space vector selection process in MPSVPC. Normally, J max can be selected as 15% to satisfy requirements in most applications.

137

 Calculate PWM Current Reference iw*

Space Vector and Dwell Time during (k + 1)th Sampling Interval through MPSVPC
Delay Compensation based on (2.23) and (2.25)
Line or Stator Current Prediction based on (2.23) and (2.25)

Cost Function Evaluation based on (5.3)

J (k + 1)  J max

No
Optimal Output Current Vector Calculation based on (5.4)

Yes
Apply Optimal Space Vector during (k + 1)th Sampling Interval

Optimal Space Vector Selection

Fig. 5.3 Flowing chart diagram of optimal space vector selection process in MPSVPC.

5.1.3 Overall Control Structure
In contrast to the traditional control structure, discussed in Section 1.4, MPSVPC can be used to directly replace traditional SVM block. The calculated modulating index, input current reference angle,  wr , for CSR, and output current reference angle,  wi , for CSI, are still used to generate traditional SVM based space vector patterns, which are assessed with the pre-defined cost function (5.3). The main difference between the traditonal control scheme and MPSVPC focuses on that line current reference vector and stator current reference vector need to be calculated in MPSVPC. For CSR, since modulating index control is used to regulate DC current, 138

line current references in dq-axis synchronous frame with respect to CSR-side capacitor voltage can be given by
* LP  =  I gd mr I dc + I Crd  * LP   I gq = I Crq

(5.5)

where
LP LP   I Crd = - g CrVCrq  LP LP   I Crq =  g CrVCrd

(5.6)

LP LP in which  g is the angular frequency of power supply voltage; VCrd and VCrq are the filtered dq-

axis components of CSR-side capacitor voltages. Finally, line current reference vector can be given by

 * * )  e jCr ig* =( I gd + jI gq

(5.7)

where Cr is the angle of CSR-side capacitor voltage vector, which is obtained from a PLL stage. At CSI side, since the stator current references in dq-axis synchronous frame with respect to rotor flux vector have been calculated by outer control loops in traditional FOC, stator current reference vector in  -axis stationary frame can be given by

 * * )  e j Fr is* =( I sd + jI sq
where  Fr is the angle of estimated rotor flux vector.

(5.8)

Fig. 5.4 shows the control block diagram of MPSVPC. The overall control structure is shown in Fig. 5.4 (a), it can be observed that except the PWM generation stage, the remaining part of MPSVPC is similar to that of traditional control scheme, which has been shown in Section 1.4. The similarity of outer control parts between MPSVPC and traditional control scheme makes the application of MPSVPC much easier. Fig. 5.4 (b) shows the details on the inner structure of MPSVPC block when used for high power CSC-fed MV IM drive, in which delay compensation process has been included. In Fig. 5.4 (b), based on state variables at kth sampling instant, optimal space vector determined during (k-1)th sampling interval, and prediction model, state 139

  ^ (k + 1) , can be estimated. Based on ^ (k + 1) and i variables at (k+1)th sampling instant, namely v C

the space vector pattern for (k+1)th sampling interval determined by traditional SVM, predicted load current vector at (k+2)th sampling instant can be calculated, then substituted into (5.3) to be  ^ * (k + 2) . When the result of (5.3) is lower than the criteria, space vector pattern compared with i defined by traditional SVM will be conserved, and applied as the optimal space vector pattern, otherwise, the optimal space vector will be reselected based on (5.4), and applied during (k+1)th sampling interval.

140

 vg

Rf

Lf

 ig
+

 iwr

CSR

Ldc 2 I dc
vdci -
+

CSI

 iwi
+

 is

Cr -
PLL

 vCr
GCT Gatings

Ldc 2
Switching Signals Switching Signals

Ci
 v Ci is I dc

-

 vCi
 vCi
abc/dq
^Fr 
VCiq

M
Speed sensor
CSI-fed IM drive Control part

Cr

MPSVPC

mr
PI
I dc

 v Cr ig mi I dc

GCT Gatings MPSVPC

 wi

inv +
I dc = mi

+ ^

VCid LPF
LP VCid

LPF
LP VCiq

Fr

-
+
* I dc

x2 + y 2 y =  inv tan -1 I dc x y
x
* I wiq * sq

 is

-eC V

LP i Ciq

* + I wid * + I sd

I

+
÷

+  C V LP e i Cid
^r KT 
* e

^r  ^  Fr e

Current Modle Rotor Flux Estimator

mr

T
PI PI

^r - 

+ * r

* + mr

- mr

(a)  op I (k ) and T op (k )
 ^ * (k + 2) i  op op I (k + 1) and T (k + 1)

Z-1

Cost Function Evaluation and Optimal Space Vector Selection
 i p (k + 2)

 ^ (k + 1) v C  ^ i (k + 1)

I dc

Prediction Over One Sampling Interval
 ^ (k + 1) v C

 iwSVM (k + 1) T SVM (k + 1)

SVM
 ^ * (k + 2) i

w

m

 ^ (k + 1) i

I dc

Delay Compensation For One Sampling Interval

Load Current Reference Calculation

 vC

 i

I dc

(b) Fig. 5.4 Control block diagram of MPSVPC: (a) overall control structure and (b) inside details of MPSVPC block.

141

5.2 Simulation Validation
In order to assess the performance of MPSVPC, simulation is conducted on a high power CSC-fed MV IM drive (1MW/4160V/139A), of which the parameters are listed in Table 5.1. The control period for SVM is selected as 926s , which leads to control frequency of 1080Hz, and switching frequency of 540Hz. The sampling interval for MPSVPC, which is equal to

92.6s , is one tenth of the control period for traditional SVM. In order to keep a fair
comparison, the output performance with multi-sampling SVM (MS-SVM) is also presented, of which the control period of SVM and the sampling interval are 926s and 92.6s as well, meaning the PWM current reference vector is updated ten times during one control period of SVM. In this study, total demand distortion (TDD) is used as index to evaluate steady state performance of line current, stator current, torque, and DC current. Table 5.1 SIMULATION PARAMETERS OF HIGH POWER CSC-FED MV IM DRIVE
System Ratings Rated power Rated line-to-line voltage Rated line current 1MW 4160V 139A System Parameters filter reactor Lf 0.15pu DC chock Ldc 1pu Rectifier side capacitor Cr 0.4pu Inverter side capacitor Ci 0.4pu 926s Control period for SVM 92.6s Sampling interval for MPSVPC Induction Motor Parameters Stator resistance Rs 0.21 Rotor resistance Rr Stator leakage inductance Lls Rotor leakage inductance Llr Magnetizing inductance Lm Moment of inertia J 0.146 5.2mH 5.2mH 155mH
22kg  m 2

Induction Motor Ratings Rated output power 1260hp Rated line-to-line voltage Rated stator current Rated speed Rated torque Rated rotor flux linkage 4160V 150A 1189rpm 7490Nm 8.35Wb

5.2.1 Steady State Performance
The quantified steady state performance of MS-SVM and MPSVPC under various operating conditions is listed in Table 5.2. Over the speed range given in the table, the switching frequency of MPSVPC can be fixed at 540Hz in steady state, which is the same as that of MS-SVM. At the 142

same time, the steady state performance of MPSVPC, in terms of the TDDs of the line currents, the stator currents, the DC current, and the torque, is also similar as that of MS-SVM. Table 5.2 verifies that since there is no huge discrepancy between line or stator current reference and real line or stator current, MPSVPC just follows the space vector pattern generated by SVM. Table 5.2 SIMULATED STEADY STATE PERFORMANCE
Rotor speed (rpm) 1189 599 180 Load torque (pu) 0.8 0.8 0.8 Motor-side synchronous frequency (Hz) 60 30.3 9.44 Scheme MS-SVM MPSVPC MS-SVM MPSVPC MS-SVM MPSVPC
f sw (Hz)

TDD (%) CSI 3.01 3.00 6.92 7.14 3.22 3.32 6.83 5.50 6.02 5.54 1.35 1.35

TDD of DC current

CSR CSI CSR 540 540 540 540 540 540 540 540 540 540 540 540

(%) 1.85 1.68 3.65 3.65 2.10 2.10

TDD of torque (%) 3.55 3.57 7.69 7.53 3.66 3.65

5.2.2 Dynamic Performance
As mentioned above, due to the impact of LC resonance at both CSR and CSI sides, huge discrepancy between line or stator current reference and real line or stator current more probably appears during transient process, during which space vector pattern would be governed through MPC approach to improve dynamic performance. Two transient cases are investigated in this paper, namely start-up process and speed reverse process. Fig. 5.5 illustrates the whole start-up process of two schemes. From top to bottom, the DC current, three-phase line currents, torque, and three-phase stator currents of two schemes are presented. As Fig. 5.5 shows, before time t of 0.5s, the IM is in stand-still status. At time t of 0.5s, the rotor speed reference jumps to its rated value, which is 1189rpm in this case. The output of the rotor speed controller is limited between positive and negative rated torque, that is 7490Nm. When the torque stepped from 0 to its rated value, resonance appears in both line and stator currents with MS-SVM, which also introduces large overshoot and oscillation into the DC current and the torque, as Fig. 5.5 (a) shows. By contrast, with MPSVPC, it can be observed that resonance in the line and stator currents is mitigated when the output torque is suddenly changed, therefore the overshoot and oscillation in the DC current and the torque are also reduced and

143

weakened. It can also be found that except a short period of time after the torque step change, there is no obvious difference between the output performance of MS-SVM and MPSVPC.
350 350

/(A) Iidc (A) dc

300 300 250 250

/(A) iigabc gabc (A)

200 200
0

iga igb igc

-200 -200 10 10 7.49 7.49
0

i /(A) T T /(kN.m) i sabc ee (kNm) sabc (A)

300 300
0

isu

isv

isw

-300 -300
0.4 0.5

0.6 0.6

0.7 0.7

0.8 0.8

0.9 0.9

t s t/s

(a)
350 350

/(A) Iidc dc (A)

300 300 250 250

/(A) iigabc gabc (A)

200 200
0 -200 -200

iga igb igc

T /(kN.m) T ee (kNm)

10 10 7.49 7.49
0

i /(A) i sabc (A) sabc

300 300
0

isu

isv

isw

-300 -300 0.4 0.4
0.5

0.6 0.6

0.7 0.7

0.8 0.8

0.9 0.9

t s t/s

(b) Fig. 5.5 Diagram of simulated whole start-up process: (a) MS-SVM and (b) MPSVPC.

144

Fig. 5.6 provides a much closer look at the transient process after the torque step happens. The three-phase line currents, phase A input current of the CSR, three-phase stator currents, and phase U output current of the CSI. As shown in Fig. 5.6 (a), after time t of 0.5s, severe resonance appears in both line currents and stator currents due to the sudden change of the torque. The resonance is gradually attenuated until time t of 0.53s. On the other hand, with MPSVPC, resonance in the line currents and stator currents is restrained from the starting point of the start-up process. The reason is that when the torque is suddenly changed from 0 to the rated value, due to the limitation on dynamic performance imposed by MS-SVM, the discrepancy between the estimated line or stator current references at future sampling points and the predicted line or stator currents based on space vector pattern of SVM, becomes larger. When the difference is higher than the pre-defined criteria value, input or output current at the CSR or CSI side will be governed through MPC approach, which can be verified from Fig. 5.6 according to that the phase A input current of the CSR and the phase U output current of the CSI with MPSVPC are different from those with MS-SVM after time t of 0.5s. With the resonance during the transient process attenuated, the difference between the estimated current references and the predicted currents becomes smaller. When the difference drops into the range set by the criteria, the input currents of the CSR and the output currents of the CSI return to follow the space vector pattern set by SVM again. As Fig. 5.6 (b) shows, after time t of 0.53, MPSVPC generates the same PWM current pattern as that with traditional MPC.

145

/(A) iigabc gabc (A)

200 200
0

iga

igb

igc

-200 -200 300 300 0 -300 -300 300 300
0

/(A) iiwra w ra (A)

i /(A) i sabc sabc (A)

isu

isv isw

-300 -300 300 300 0 -300 -300 0.49 0.49
0.5

/(A) iiwia w ia (A)

0.51 0.51

0.52 0.52

0.53 0.53

0.54 0.54

t s t/s

(a)
/(A) iigabc gabc (A)
200 200
0

iga

igb

igc

-200 -200 300 300
0

/(A) iiwra w ra (A)

-300 -300 300 300
0

/(A) i i sabc sabc (A)

isu

isw

isv

-300 -300 300 300
0

/(A) iiwia w ia (A)

-300 -300 0.49 0.49
0.5

0.51 0.51

0.52 0.52

0.53 0.53

0.54 0.54

t s t/s

(b) Fig. 5.6 Diagram of beginning part of simulated start-up process: (a) MS-SVM and (b) MPSVPC. In order to further verify the effectiveness of MPSVPC, speed reverse process is also presented, as Fig. 5.7 shows. At time t of 1.2s, the rotor speed reference jumps from the positive 146

rated value to the negative rated value. Fig. 5.7 (a) shows the speed reverse process with MSSVM, in which LC resonance appears in the line currents and the stator currents right after the speed reverse process begins, and results in the overshoots and oscillation in the DC current and the torque. On the other hand, with MPSVPC, when the torque steps to the negative rated value, the severity of the resonance in the line currents and stator currents is weakened, and the overshoot and oscillation in the torque is effectively mitigated. Though the overshoot in the DC current is close to that with traditional SVM, the variation of the DC current is smoother than that with traditional SVM.

147

350 350

Iidc /(A) (A)

dc

300 300 250 250

/(A) iigabc gabc (A)

200 200
0

iga igb igc

-200 -200
0

T /(kN.m) i /(A) T i sabc ee (kNm) sabc (A)

-7.49 -7.49 -10 -10 300 300
0

isu

isv

isw

-300 -300 1 1 1.2 1.2 1.4 1.4 1.6 1.6 1.8 1.8
2

t s t/s

(a)
Iidc /(A) (A)
350 350 300 300 250 250

dc

/(A) iigabc gabc (A)

200 200 0 -200 -200
0

iga igb igc

T /(kN.m) T ee (kNm)

-7.49 -7.49 -10 -10 300 300 0 -300 -300
1

i /(A) i sabc sabc (A)

isu isv

isw

1.2 1.2

1.4 1.4

1.6 1.6

1.8 1.8

2

t s t/s

(b) Fig. 5.7 Diagram of whole simulated speed reverse process: (a) MS-SVM and (b) MPSVPC. Fig. 5.8 shows the details on the beginning of the speed reverse process. When MS-SVM is used, LC resonance is stimulated in the line currents and the stator currents after the torque is suddenly changed to the negative rated value. By contrast, since the input currents of the CSR 148

and the output currents of the CSI with MPSVPC are governed through MPC approach after the speed reverse process starts, the resonance in the line currents and stator currents is effectively suppressed, as Fig. 5.8 (b) depicts. With the resonance gradually mitigated, the CSR-side input currents and the CSI-side output currents return to follow the space vector pattern determined by SVM after time t of 1.22s, which fixes the switching frequencies at both CSR and CSI sides.

149

/(A) iigabc gabc (A)

200 200
0

iga

igb

igc

-200 -200 300 300
0

/(A) iiwra w ra (A)

-300 -300 300 300
0

i /(A) i sabc sabc (A)

isu

isv

isw

-300 -300 300 300
0

/(A) iiwia w ia (A)

-300 -300 1.19 1.19
1.2

1.21 1.21

1.22 1.22

1.23 1.23

1.24 1.24

t s t/s

(a)
/(A) igabc gabc (A)
200 200 0 0 -200 -200 300 300 0 0 -300 -300 300 300 0 0 -300 -300 300 300 0 0 -300 -300 1.19 1.19 1.2 1.2 1.21 1.21 1.22 1.22 1.23 1.23 1.24 1.24
t s t/s

iga

igb

igc

/(A) iwra w ra (A)

/(A) iiwia w ia (A)

/(A) isabc sabc (A)

isu

isv

isw

(b) Fig. 5.8 Diagram of beginning part of simulated speed reverse process: (a) traditional SVM and (b) MPSVPC.

150

5.3 Experimental Validation
The experiments on a low power prototype (5kW/208V/13.9A) are conducted to further validate the effectiveness of MPSVPC as well. The parameters of the low power prototype are given in Table 5.3. The control period of SVM is still selected as 926µs. For contrast, the steady state and dynamic performance with traditional SVM are also presented. The sampling intervals of MS-SVM and MPSVPC are both 92.6µs as well.
System Ratings

Table 5.3 EXPERIMENTAL PARAMETERS OF LOW POWER PROTOTYPE
System Parameters filter reactor Lf 0.22p.u. Rated power 5kW DC chock Ldc 1.16p.u. Rectifier side capacitor Cr 0.378p.u. Rated line-to-line voltage 208V Inverter side capacitor Ci 0.378p.u. 926s Control period for SVM Rated line current 13.9A 92.6s Sampling interval for MPSVPC Induction Motor Ratings Induction Motor Parameters Stator resistance Rs Rated output power 5hp 0.395 Rotor resistance Rr Rated line-to-line voltage 208V 0.737 Stator leakage inductance Lls Rated stator current 13.9A 1.95mH Rotor leakage inductance Llr Rated speed 1700rpm 49.1mH Magnetizing inductance Lm Rated torque 21Nm 49.1mH 0.103kg  m 2 Rated rotor flux linkage 0.433Wb Moment of inertia J

5.3.1 Steady State Performance
Fig. 5.9 shows the experimental steady state performance at rated rotating speed and 0.8pu load torque condition. From top to bottom, the phase A line current, the phase A input PWM current of the CSR, the phase U stator current, and the phase U output PWM current of the CSI are presented. It can be found that the steady state performance with MPSVPC is close to that with MS-SVM no matter in terms of the TDDs of line current and stator current or average switching frequencies. The main difference between the steady state performance of MS-SVM and MPSVPC focuses on the input PWM current waveform and the average switching frequency of the CSR. It can be observed that one more switching action is added into the input PWM current waveform of the CSR with MPSVPC, which makes the average switching 151

frequency of the CSR be equal to 570Hz, not 540Hz as that with MS-SVM. The reason is that at rated rotating speed and 0.8pu load torque condition the difference between the estimated line current references and the predicted line currents following the space vector pattern set by MSSVM is more easy to surpass the predefined maximum criteria value due to the higher magnitude of the line current.
CH1:10A/div CH3:10A/div M:12.25A/div TDD(ig )=7.21%

Time:2.5ms/div
TDD(ig )=8.01%

iga
f swr = 540Hz f swr = 570Hz

iga

iwra

iwra

TDD(is ) = 6.36%

isu

TDD(is )=6.80%

isu

f swi = 540Hz

iwiu

f swi = 540Hz

iwiu

(a)

(b)

Fig. 5.9 Diagram of experimental steady state performance at rated rotating speed and 0.8pu load torque: (a) MS-SVM and (b) MPSVPC. Table 5.4 illustrates a quantitative comparison of the experimental steady state performance between MS-SVM and MPSVPC at various operating conditions. Similar as the results shown in Table 5.4, the steady state output performance of MPSVPC is close to that of MS-SVM, which 152

is indicated by the TDD values of the line current, the stator current, the DC current, and the torque, and means that MPSVPC can generate a SVM-like PWM waveform with fixed switching frequency in steady state. However, in contrast to the values listed in Table 5.2, the TDD values in Table 5.4 are obviously higher, especially the TDDs of the line current and the DC current. The reason is that the utility power supply voltages in the experiments are not as ideally sinusoidal as that in simulation, and contain low-order harmonics, which further distort the line currents, and increase the fluctuation of the DC current through stimulating LC resonance at the CSR side. Table 5.4 EXPERIMENTAL STEADY STATE PERFORMANCE
Rotor speed (rpm) 1700 850 180 Load torque (pu) 0.8 0.8 0.8 Motor-side synchronous frequency (Hz) 60 31.5 9.5 Scheme MS-SVM MPSVPC MS-SVM MPSVPC MS-SVM MPSVPC
f sw (Hz)

TDD (%) CSI 6.36 6.80 5.96 6.38 6.38 6.71 7.21 8.01 4.13 4.26 4.44 4.56

CSR CSI CSR 540 570 540 540 540 540 540 540 540 540 540 540

TDD of DC current (%)

11.6 9.12 6.41 5.34 5.73 5.19

TDD of torque (%) 10.2 10.4 9.22 9.71 9.93 9.68

5.3.2 Dynamic Performance
In order to demonstrate the improvements on dynamic performance with MPSVPC, the startup process and the speed reverse process are experimentally conducted. Fig. 5.10 shows the whole start-up process, in which the DC current, the phase A line current, the torque, and the phase U stator current are depicted from top to bottom. The output of the rotor speed controller is limited between positive and negative rated torque. It can be observed that with MS-SVM, significant overshoots appear in both DC current and torque at the beginning of the start-up process due to the degraded dynamic performance of traditional SVM and transient LC resonance. On the other hand, with MPSVPC, the overshoots in the DC current and the torque are effectively mitigated, and the fluctuation on the DC current is also reduced at the same time.

153

CH1:25A/div CH2:21N.m/div CH3:25A/div CH4:5A/div I dc
DC current overshoot

I dc
iga

iga

Te
Torque overshoot

Te isu

isu

(a)

(b)

Fig. 5.10 Diagram of whole experimental start-up process: (a) MS-SVM and (b) MPSVPC. Fig. 5.11 shows the very beginning part of the start-up process, where the phase A line current, the phase A input current of the CSR, the phase U stator current, and the phase U output current of the CSI are presented. In Fig. 5.11 (b), with MPSVPC, due to the difference between the estimated line current or stator current reference and the predicted line or stator current regulated by SVM higher than the maximum criteria, the switching patterns at both CSR and CSI sides are governed through MPC approach during a short period after the start of the startup process, which can be verified by the rearranged PWM waveforms in contrast to that with MS-SVM, which are shown in Fig. 5.11 (a). Due to the PWM patterns regulated by MPC approach manipulating the line currents and the stator currents to follow their respective references more closely, better dynamic performance is achieved with MPSVPC, which can be validated by the mitigated resonance in the line current and the stator current after the start-up process begins. It can also be found that after a short period of time, the PWM waveforms with MPSVPC return to follow a SVM-defined pattern, which means that the calculated difference drops back into the ranges limited by the maximum criteria.

154

CH1:10A/div CH3:10A/div M:12.25A/div
iga

Time:5ms/div
iga
Start-up process begins

Start-up process begins

iwra

iwra

isu

iwiu

isu

iwiu

(a)

(b)

Fig. 5.11 Diagram of beginning part of experimental start-up process: (a) MS-SVM and (b) MPSVPC. Fig. 5.12 shows the whole experimental speed reverse process. In comparison with the results shown in Fig. 5.12 (a), MPSVPC can effectively mitigate the torque overshoot. Though the DC current overshoot is not obviously restrained by MPSVPC, the fluctuation on the DC current during the whole speed reverse process is reduced in contrast to that with MS-SVM.

155

CH1:25A/div CH2:21N.m/div CH3:25A/div CH4:5A/div I dc
iga

Time:250ms/div
I dc
iga

Te
Torque overshoot

Te isu

isu

(a)

(b)

Fig. 5.12 Diagram of whole experimental speed reverse process: (a) MS-SVM and (b) MPSVPC. Fig. 5.13 shows the beginning part of the experimental speed reverse process. As Fig. 5.13 (a) shows, after the beginning point of the speed reverse process, severe resonance appears in the line current and the stator current with MS-SVM. In Fig. 5.13 (b), with MPSVPC, during a short period after the beginning point of the speed reverse process, both line current and stator current are regulated by MPC approach, which can also be observed from the different PWM waveform patterns from that with traditional SVM, and the resonance in the line current and the stator current after the beginning of speed reverse process is effectively suppressed, which further verifies the effectiveness of MPSVPC on improving dynamic performance. After one fundamental period, which corresponds to 1/60s in this case, the PWM current waveforms return to follow the space vector pattern set by SVM again, which is just similar to the result shown in Fig. 5.8.

156

CH1:10A/div CH3:10A/div M:12.25A/div
iga

Time:5ms/div
iga

Speed reverse begins

Speed reverse begins

iwra iwra

isu isu

iwiu

iwiu

(a)

(b)

Fig. 5.13 Diagram of beginning part of experimental speed reverse process: (a) MS-SVM and (b) MPSVPC.

5.4 Conclusions
MPSVPC is presented in this chapter. In comparison with MS-SVM and the existing MPCs with relatively low switching frequency, the advantages of MPSVPC can be classified as follows · In contrast to MS-SVM, MPSVPC can improve dynamic performance of high power CSC-fed MV IM drive, and keeps fixed switching at both CSR and CSI sides in steady state; 157

·

In comparison with SHE-PWM or other SHE-PWM based schemes, there is no need to calculate optimal switching angles of SHE-PWM waveform in MPSVPC, which is totally an online method;

·

Compared to the existing MPCs achieving low switching frequency, MPSVPC not only requires just one step prediction, but also does not include the weighting factor selection issue, which reaches a simpler structure and the reduction on computation effort.

158

6 Common-Mode

Voltage

Reduced

Model

Predictive

Control for High Power Current-Source Converter-Fed Medium-Voltage Induction Motor Drive
In this Chapter, common-mode voltage reduced model predictive control (RCMV-MPC) is proposed for high power CSC-fed MV IM drives, which is illustrated in Fig. 6.1 again. The inherent feature of MPC, that is involving nonlinear constraints into control design, is used to realize CMV mitigation. The innovation in the proposed RCMV-MPC can be classified as · Since the control objective of RCMV-MPC is the CMV reduction in a whole CSC-fed IM drive, optimal switching states for CSR and CSI are selected synchronously during every sampling interval, for which a unified cost function is established to track references for both CSR and CSI, simultaneously; · During every sampling interval, only switching states fulfilling a pre-defined CMV limitation become candidates, from which optimal ones are finally selected to track references for both CSR and CSI. Moreover, a CMV related term is associated into the unified cost function to further reduce the CMV peak value in a CSC-fed IM drive. In comparison with the existing RCMV-SVMs, which are introduced in Chapter 0, the merits provided by RCMV-MPC can be summarized as · · First, unlike traditional RCMV-SVMs, the limitation of CMV peak value is clearly defined in RCMV-MPC; Then, with RCMV-MPC, the CMV peak value can be further reduced in contrast to that by traditional RCMV-SVMs, but the average switching frequency of RCMV-MPC can still be kept around 1kHz; · Last but not least, due to a relatively short sampling interval, the CMV mitigation effect during transients can also be guaranteed with RCMV-MPC.

159

1 I dc Ldc 2
 vg R f Lf

3
S i1 Si 3 Si 5
 iwi  is

 ig
 iCr

 S r1 iwr

Sr 3

Sr 5

g
+

o
-

Cr

vCr

Sr 4

Sr 6

Sr 2
2 I dc Ldc 2 vog

Si 4

Si 6

Si 2

+

 iCi

vCi

Ci

Induction Motor

g

4

o

Fig. 6.1 Configuration of high power CSC-fed MV IM drive.

6.1 CMV in CSC-Fed IM Drives
6.1.1 CMV Definition in CSC-Fed IM Drives
As Fig. 6.1 shows, the CMV produced in a CSC-fed IM drive, consists of the CMV at the CSR side, vcmr , and the CMV at the CSI side, vcmi , which can be defined, respectively, by
v= cmr

(v

1g

+ v2 g ) 2

(6.1) (6.2)

v= cmi

( v3o + v4o )

2

where v1g and v2 g are the voltages at point 1 and 2, with respect to the ground or the neutral of the rectifier-side three-phase capacitor; v3o and v4 o are the voltages at point 3 and 4, with respect to the neutral of the IM stator windings or the neutral of the inverter-side capacitor. If the differential inductance in the positive DC link is equal to that in the negative DC link, the CMV in a whole CSC-fed IM drive, vog , can be expressed as [23]

v = vcmr - vcmi og

(6.3)

It is important to note that the subtraction operation in (6.3) does not imply a reduction of the CMV in a whole CSC-fed IM drive. Since the CMV is bipolar, the maximum CMV in a whole CSC-fed IM drive is possibly higher than those at the CSR and the CSI sides. If PWM control is applied to CSC-fed IM drives, the CMV can be expressed as 160

vog = vcmr - vcmi

[ S + Sr 4 = r1

Sr 3 + Sr 6 2

vCra  S r 2 + S r 5 ]   [ S i1 + S i 4   vCrb  -   vCrc  

Si 3 + Si 6 2

vCia  Si 2 + Si 5 ]     vCib    vCic  

(6.4) where S r1 to S r 6 are the switching functions of CSR; Si1 to Si 6 are the switching functions of CSI; vCra , vCrb , and vCrc are the rectifier-side capacitor phase voltages; vCia , vCib , and vCic are the inverter-side capacitor phase voltages. Fig. 6.2 shows the definitions of the space vectors in a CSC, and the instantaneous CMVs associated with the space vectors are also indicated in Fig. 6.2, where vCa , vCb , and vCc represent instantaneous capacitor phase voltages at CSR or CSI side. The maximum CMV peak value is produced by zero-state vectors, which can be as high as the peak values of capacitor phase voltages. According to the principle of zero-state vector selection based RCMV-SVM in [39], due to the redundancy of zero-state vectors, there is always one zero-state vector generating CMV no higher than half peak value of capacitor phase voltage at any instant. Hence, the zero-state vector with the lowest CMV absolute value can be selected to ensure that the CMV peak value is not higher than half peak value of capacitor phase voltage, either. Moreover, since zero-state vector is not avoided in zero-state vector selection based RCMV-SVM, there is no influence on the output performance of the modulation. Hence, it is possible that the CMV peak value in a whole CSC-fed IM drive is reduced to no larger than 0.5(VCr + VCi ) , where VCr and VCi are the magnitudes of CSR and CSI-side capacitor phase voltages, without the tradeoff between output performance and CMV mitigation. 0.5(VCr + VCi ) will also be used as a CMV peak value limitation in RCMV-MPC.

161



 I 3 ( S 2 , S3 ), vcm 2 = -0.5vCb

 I 4 ( S3 , S 4 ), vcm 3 = -0.5vCa

Sector III

Sector II

 I 2 ( S1 , S 2 ), vcm1 = -0.5vCc

 I 7 ( S1 , S 4 ), vcm 7 = vCa     I 8 ( S3 , S6 ), vcm8 = vCb    I 9 ( S5 , S 2 ), vcm 9 = vCc  
 I 5 ( S 4 , S5 ), vcm 4 = -0.5vCc

Sector IV

Sector I


 I1 ( S6 , S1 ), vcm 6 = -0.5vCa

Sector V

Sector VI

 I 6 ( S5 , S6 ), vcm 5 = -0.5vCb

Fig. 6.2 Space vector definition and corresponding CMV of a CSC.

6.1.2 Principle of CMV Reduction in RCMV-MPC
(6.4) shows the relationship between instantaneous CMV in a CSC-fed IM drive and capacitor phase voltages. Hence, at every instant, CMV corresponding to every possible switching states' combination of CSR and CSI can be predicted. Due to a relatively short sampling interval, capacitor voltages can be considered constant during one sampling interval. For example, at kth sampling instant, CMVs at CSR and CSI sides can be given by

vcmr

[ S (k ) + Sr 4 (k ), ( k ) = r1

vCra (k )  S r 3 (k ) + S r 6 (k ), S r 5 (k ) + S r 2 (k )]  vCrb (k )    2  ( ) v k  Crc  

(6.5)

vcmi

[ S (k ) + Si 4 (k ), (k ) = i1

vCia (k )  Si 3 (k ) + Si 6 (k ), Si 5 (k ) + Si 2 (k )]  vCib (k )    2  vCic (k )   

(6.6)

where S r1 (k ) to S r 6 (k ) are the switching states of CSR at kth sampling instant; Si1 (k ) to Si 6 (k ) are the switching states of CSI at kth sampling instant; vCra (k ) , vCrb (k ) , and vCrc (k ) are the 162

CSR-side capacitor phase voltages at kth sampling instant; vCia (k ) , vCib (k ) , and vCic (k ) are the CSI-side capacitor phase voltages at kth sampling instant. Then, the CMV of a whole CSC-fed IM drive can be estimated as

v = vcmr (k ) - vcmi (k ) og ( k )

(6.7)

Since the CMV in a CSC-fed IM drive can be estimated, the switching states of CSR and CSI can be optimally selected synchronously to reduce CMV peak value. Fig. 6.3 shows the principle of RCMV-MPC, in comparison with traditional zero-state vector selection based RCMV-SVM. As Fig. 6.3 (a) shows, zero-state vectors are independently selected in CSR and CSI, which only ensures that the CSR- and CSI-side CMVs are no larger than half peak values of respective capacitor phase voltages, and the absolute CMV value in a whole CSC-fed IM drive does not exceed 0.5(VCr + VCi ) . However, due to the fixed sequence in SVM, it becomes hard to further mitigate the CMV peak value. Fig. 6.3 (b) shows the CMV mitigation process in RCMV-MPC. Since there is no restrictions introduced by modulating stage any more, the optimal space vectors need to be selected for CSR and CSI during every sampling interval. The primary control goal is still to track respective references for CSR and CSI. If the applied space vector for CSR and CSI can be selected synchronously, the CMV mitigation constraint can be considered during the selection of the optimal switching states for CSR and CSI, which provides the possibility of further mitigating the CMV peak value. In order to make sure that the CMV in a CSC-fed IM drive is restricted inside a predefined range, the CMV peak value limitation at kth sampling instant can be given by
lim = Vog (k ) 0.5 (VCr (k ) + VCi (k ) )

(6.8)

where VCr (k ) and VCi (k ) are the magnitudes of CSR- and CSI-side capacitor phase voltages at kth sampling instant. Since the CMV of a CSC-fed IM drive can be estimated at every sampling instant, the switching states' combinations for CSR and CSI leading to CMV higher than (6.8) will be abandoned. The optimal switching states' combination for CSR and CSI will be only searched in the tentative ones generating CMV no larger than the limitation. Since (6.8) only eliminates the zero-state vectors generating CMV absolute value larger than half peak value of capacitor phase voltage, it only ensures the same CMV mitigation performance as traditional 163

RCMV-SVM. Therefore, a CMV related term will be imported into the cost function to further reduce the CMV peak value inside the CMV peak value limitation range. Hence, there are mainly three control objectives in RCMV-MPC, as 1) Tracking references at both CSR and CSI sides. This objective can be realized based on a unified cost function, in which the objectives of tracking references at both CSR and CSI sides are associated together, and the optimal switching states for CSR and CSI are selected synchronously; 2) CMV peak value limitation. This objective can be realized through inserting a CMV peak value limitation, defined in (6.8), into the selection process of the optimal switching states for CSR and CSI; 3) Further CMV peak value reduction. This objective is achieved by a CMV related term added into the cost function to further reduce the CMV inside the CMV peak value limitation range at various operating conditions.
CSR-side Reference tracking

One sampling interval of MPC

Ts
CSR
One PWM counter period of SVM Optimal Space vector CMV peak reduction

CSR

 In  In  I n+1

 I n+1

Optimal Zero-state vector

Independent selection

Ts (k ) Ts (k + 1)
CSI
Optimal Space vector

t

CSI

Optimal Zero-state vector

Independent selection

CSI-side Reference tracking

(a)

(b)

Fig. 6.3 Principle of CMV peak value reduction: (a) zero-state vector selection based RCMVSVM and (b) RCMV-MPC.

164

6.2 RCMV-MPC For High Power CSC-Fed MV IM Drive
6.2.1 MPC for CSR
The proposed MPC for CSR is based on the traditional modulating index control [31]. Fig. 6.4 shows the phasor diagram of the traditional modulating index control, in which all the voltage and current phasors, such as I g (1) , I wr (1) , VCr (1) , and VLf (1) represent the magnitudes of fundamental-frequency components. I wr (1) aligns with VCr (1) , and I g (1) is just equal to the summation of I wr (1) and I Cr (1) . The reactive power generated by the three-phase capacitor can be given by

QCr = -3 g Cr (

VCr (1) 2

)2

(6.9)

The reactive power generated by voltage across filter reactor and line current can be given by

QLf = 3 g L f (

I g (1) 2

)2

(6.10)

Based on (6.9) and (6.10), the reactive power generated by utility power supply voltage and line current can be given by

Q = QCr + QLf g

(6.11)

The primary control objective of CSR is DC current regulation, since the DC current is usually variable according to the operating state of the IM in order to reduce conducting losses in a high power CSC-fed MV IM drive. The DC current regulation is realized through tracking the line current references, which are calculated based on the active and reactive power references. The active power reference can be obtained by a PI controller for DC current control. On the other hand, the reactive power reference can be given by
* Qg = Qg

(6.12)

165

* , is just set to be equal to the calculated reactive where the line reactive power reference, Qg

power generated by power supply voltage and line current with the phase angle of I wr (1) aligning with that of VCr (1) . The line current references in  -axis stationary frame can be given by
*  Re( i = g )    * Im(i = g )     Re(vg ) Im(vg ) 2 2 * *  2  2 Pg +  2  2 Qg 3 Re(vg ) + Im(vg ) 3 Re(vg ) + Im(vg )   Im(vg ) Re(vg ) 2 2 * *  2  2 Pg -  2  2 Qg 3 Re(vg ) + Im(vg ) 3 Re(vg ) + Im(vg )

(6.13)

 where Pg* is the active power reference; ig* is the line current reference vector; Re() and Im()
denote the  -axis and  -axis components of a space vector. The predicted line current vectors at (k+1)th sampling instant, corresponding to nine possible switching states of a CSR, are compared with line current reference vector in a cost function. The cost function to track line current reference vector at CSR side can be given by
2   p( x) ^ * (k + 1) - i g r( x ) (k= k + ) i ( 1) g g

x (=

1, 2,...,9 )

(6.14)

where operator |  | denotes the modulus of a space vector. (6.14) represents the square of the Euclidean distance between the line current reference vector and the predicted line current  vector. igp ( x ) (k + 1) and g r( x ) (k ) are the predicted line current vector and the cost function value corresponding to the xth switching state of a CSR.
I g (1)
I Cr (1)
PF = cos 


r = 0
I wr (1)

Vg (1)

VLf (1) VCr (1)

Fig. 6.4 Phasor diagram of traditional modulation index control.

166

6.2.2 MPFOC for CSI-Fed IM Drive
At the CSI side, model predictive field-oriented control (MPFOC) is introduced into the CSI to conduct IM control. Just similar as traditional FOC, there are two PI controllers to regulate the rotor speed and the rotor flux magnitude. The rotor flux magnitude reference is normally set to its rated value. In high power CSC-fed MV IM drives, the DC current reference is usually calculated at the CSI side based on the operating status of IM, then transmitted to the CSR for DC current regulation. At the CSI side, the produced stator current references in dq-axis synchronous frame, with respect to the rotor flux vector, can be transformed into  -axis stationary frame, as
 = is*

(I

* sd

* + jI sq ) e jFr ^

(6.15)

 * * where is* is the stator current reference vector; I sd and I sq are the stator current references in
dq-axis synchronous frame. As one of the inputs in the prediction model for CSI-fed IM drive, the rotor flux vector is estimated through a current-model flux estimator, which has good performance under low output frequency condition [85]. The estimated rotor flux vector can be given by
^ e j r =  r  ^
^
Fr

(6.16)

^ is the estimated rotor flux magnitude, and  ^ is the estimated rotor flux angle. where  r Fr
The predicted stator current vectors at (k+1)th instant, corresponding to nine possible switching states of a CSI, are compared with the stator current reference vector in a cost function. The cost function to track the stator current reference can be given by
2   p( y) ^ * (k + 1) - i gi( y ) (k= ) i ( k + 1) s s

y (=

1, 2,...,9 )

(6.17)

 ^ * (k + 1) is the estimated state current reference vector at (k+1)th sampling instant, equal where i s  to is* (k )e jeTs , in which e is the angular frequency of the estimated rotor flux vector;
 is p ( y ) (k + 1) and gi( y ) (k ) are the predicted stator current vector, and the cost function value

167

corresponding to the yth switching state of a CSI. (6.17) represents the square of the Euclidean distance between the stator current reference vector and the predicted stator current vector.

6.2.3 Unified Cost Function for CMV Reduction
As mentioned in Section 6.1.2, the CMV peak value reduction in RCMV-MPC is realized by two steps. The first step is to ensure the generated CMV peak value of a CSC-fed IM drive no higher than the defined CMV limitation in (6.8). The second step is to further mitigate the CMV peak value inside the CMV peak value limitations through synchronous selection of switching states for CSR and CSI, which means that the line current references and the stator current references need to be tracked instantaneously. For this reason, a unified cost function is designed here, and given by = g1( x , y ) (k )
2  ^ * (k + 1) i g

g r( x ) (k )

+

2  ^ * (k + 1) i s

gi( y ) (k )

(6.18)

where g1( x , y ) (k ) is the value of the cost function, which is determined by the xth switching state of the CSR and the yth space vector of the CSI. From a physical meaning point of view,
2  ^ * (k + 1) represents the square of the ratio of the difference of the Euclidean distance g r( x ) (k ) i g

between the line current reference vector and the predicted line current vector corresponding to the xth space vector of the CSR over the length of the line current reference vector. Similarly,
2  ^ * (k + 1) denotes the square of the ratio of the difference of the Euclidean distance gi( y ) (k ) i s

between the stator current reference vector and the predicted stator current vector corresponding to the yth space vector over the length of the stator current reference vector. Hence, the summation of these two terms can be considered as an overall ratio of error, which can be used to evaluate the performance on tracking references in a whole CSC-fed IM drive. In order to further mitigate the CMV peak value, a CMV related term is incorporated into the unified cost function, which can be given by
( x, y ) lim p ( x, y ) g2 = (k ) wcmv  ( vog (k ) / Vog (k ) ) 2

(6.19)

168

p ( x, y ) (k ) is the predicted where wcmv is the weighting factor for the CMV related term, and vog

CMV in the CSC-fed IM drive corresponding to the xth space vector of the CSR and the yth space vector of the CSI, which can be calculated based on (6.5) to (6.7). The CMV related term represents the square of the ratio of the predicted CMV over the CMV peak value limitation, which can be considered as the maximum possible CMV value. The term in ratio form is chosen here since it is easier to be combined with the terms for tracking references in (6.18), which simplifies the selection of the weighting factor. So the finally unified cost function can be given by
( x, y ) ( x, y ) g= (k ) g1( x , y ) (k ) + g 2 (k )

(6.20)

where tracking references and CMV peak value reduction are fulfilled by the unified cost function. Since both CSR and CSI have nine switching states, there are totally 81 switching states' combinations for CSR and CSI, which are needed to be evaluated based on (6.20) during every sampling interval. The two-step prediction method is also used here to compensate the delay caused by  ^ (k + 1) , calculation burden. With delay compensation method introduced in Section 2.3.4, i g
   ^ (k + 1) , and v ^ (k + 1) , i ^ (k + 1) need to be estimated according to the optimal switching v Cr Ci s

states' combination for kth sampling interval, and the state variables at kth instant. Then,   igp (k + 2) and is p (k + 2) need to be predicted in order to optimally select the switching states' combination for (k+1)th sampling interval. The predicted CMV should also be calculated based on the estimated capacitor voltages at (k+1)th instant. Finally, the cost function used to evaluate the predicted values at (k+2)th instant should be given by
( x, y ) g ( x , y ) (k = + 1) g1( x , y ) (k + 1) + g 2 (k + 1) 2 2   ^ * (k + 2) + g ( y ) (k + 1) i ^ * (k + 2) + w  v p ( x , y ) (k + 1) / V lim (k + 1) 2 = g r( x ) (k + 1) i ) g i s cmv ( og og         CMV further mitigation Reference tracks 2  p( x)  ^ * (k + 2) - i i (k + 2) g g 2   p( y) ^ * (k + 2) - i i (k + 2) s s

=

lim p ( x, y ) + + wcmv  ( vog (k + 1) / Vog (k + 1) ) 2 2       ^ ^ * * ig (k + 2) is (k + 2) CMV further mitigation  2 Reference tracks

169

(6.21)

6.2.4 Overall Control Structure of RCMV-MPC
Fig. 6.5 shows the control block diagram of RCMV-MPC, in which delay compensation has been considered. Fig. 6.6 shows the flowchart diagram of the selection process of optimal switching states' combination for both CSR and CSI. An additional judgment in the red block is inserted into the flowchart to restrict the CMV peak value of the whole CSC-fed IM drive no
lim (k + 1) , which abandons the zero-state vectors higher than the CMV peak value limitation, Vog

introducing too high CMV peak value, and has no influence on tracking references. Hence, the optimal switching states' combination leading to the minimum value of (6.21) will be only selected from the tentative combinations, which satisfy the CMV peak value limitation. In Fig. 6.6, two loops are nested together, one for selecting the optimal switching state for the CSR, and the other for selecting the optimal switching state for the CSI. Since both CSR and CSI have nine switching states, the loop needs to be totally repeated 81 times during every sampling interval, which results in very huge computation burden. For more
p( x) (k + 1) , the predicted line current vector, efficient computation, the CSR-side CMV, vcmr  igp ( x ) (k + 2) , the cost function to track line current references, g r( x ) (k + 1) , corresponding to xth

space vector of the CSR (x=1, 2, ..., 9), are calculated before entering the loop. Similarly, the  p( y) (k + 1) , the predicted stator current vector, is p ( y ) (k + 2) , and the cost CSI-side CMV, vcmi function to track stator current reference, gi( y ) (k + 1) , corresponding to yth space vector of the CSI (y=1, 2, ..., 9) are also calculated. All the calculations are completed in the `Preliminary Calculation' part in Fig. 6.6. Then, just some add operations and comparison operations need to be conducted in the 81 times loops. If the algorithm is not arranged in this manner, computation burden will dramatically increase. For instance, when x is equal to 1, all the CSI-side prediction values need to be calculated once, then, when x increases to 2, all the calculations at the CSI side need to be repeated, which introduces more computation burden.

170

 v
g

Rf

Lf

 ig

 iwr
I dc Ldc 2
CSR
dci -

 + vCr
-

v
CSI

+

 iwi
Ci
-

 is
+  vCi

M

Cr
Switching Signals Switching Signals

Ldc 2
GCT Gatings GCT Gatings

Speed sensor

CSI-Fed Drive

Control Part

v
I * dc - I dc +
PI +
Reactive Power Reference Calculation (6.9) to (6.12)
* Qg

dci LPF

I dc

z -1
-1

+

×
Reference Calculation (6.13)
* g

Pg*
Line Current

 i

 I xop (k )  I xop (k + 1)

 I yop (k ) z  I yop (k + 1)

Minimization of Unified Cost Function (6.21)

 i

^Fr 
* s

^r KT 
dq

I


* sq
* I sd

÷

Te*

mr
PI PI
 I2

-

+ mr

*

Pg*
 vCr
 I3  I4  I
7,8,9

+ r

*

-

 ig
 I2  I1  I6
CSR-side Prediction

 I5

 vg
based on

 I xop (k )

 ^Cr (k + 1) v

(2.16), (2.17), and (6.5)

 ^ (k +1) i g

 ^Cr (k + 1) v

based on (2.25), (2.26), and (6.6)

CSR-side Delay Compensation based on (2.16), (2.17)

CSI-side Delay Compensation based on (2.25), (2.26)

 I ^ I 7,8,9  6 i ^ g ( k + 1)  r Current Mode  Rotor Flux I yop (k ) Estimator



lim (k + 1) Vog

CMV Limitation

 is

mr
 ig
 is

Calculation (6.8)

  vCr vg

I dc

 vCi

171

  p( x)  lim vg i p x ( ) p ( y ) k + ( 2) (k + 1) is p ( y ) ( k + 2) vcmi vcmr (k + 1) Vog (k + 1) g  Iy

e
CSI-side Prediction

^r 
 I3  I4 
 I1  I6
* I dc

 Ix

DC Current Reference Calculation

 vCi * I sd * I sq  ^Cr (k + 1) v  ^Ci (k + 1) v

Fig. 6.5 Block diagram of RCMV-MPC for CSC-fed IM drives.

Preliminary Calculation
p( x) Calculation of g r( x ) (k + 1), vcmr (k + 1)
( x, y ) (k + 1) g ( x , y ) (k = + 1) g1( x , y ) (k + 1) + g 2

g ( x , y ) (k + 1) = 

( x = 1, 2, ... , 9) with (6.14), (6.5)

No
if g ( x , y ) (k + 1) < g op { = g op g
( x, y )

p( y) Calculation of g r( y ) (k + 1), vcmi (k + 1)

(

)

( y = 1, 2, ... , 9) with (6.17), (6.6)

(k + 1);

= xop x= , yop y. }

= x 0, = y 0; g op = 

y = 9?

Yes
x= x + 1

Yes
x = 9?

y= y + 1

Yes
p( x, y ) p( x) p( y) vog + 1) vcmr (k = (k + 1) - vcmi (k + 1)

Apply optimal space vectors   I xop (k + 1), I yop (k + 1) at CSR and CSI sides during (k +1)th period

p( x, y ) lim vog (k + 1)  Vog (k + 1)

No No

Fig. 6.6 Flowchart diagram of optimal switching states' combination selection.

6.3 Simulation Validation
In order to validate RCMV-MPC, simulation on a high power CSC-fed MV IM drive is conducted. The parameters used in the simulation are listed in Table 6.1. The simulation results of the CSC-fed IM drive with traditional control schemes are also provided, in which classic FOC and modulating index control are used in CSI and CSR, respectively. The modulating index for CSI is selected as 0.8. The conventional three-segment SVM is used in both CSR and CSI with switching frequency of 1080Hz, which indicates that the PWM counter period, which is used to generate gating signals, is 1/2160s. Besides, the simulation results of zero-state vector 172

selection based RCMV-SVM, presented in [39] are also provided, in which three-segment sequence is still used, and zero-state vector selection processes are separately conducted at CSR and CSI sides. In order to keep a fair competition, the same PI parameters are used in classic FOC and MPFOC. The PI parameters for traditional modulating index control and the proposed MPC for CSR have also been well tuned. Here, for simplicity, conventional SVM and zero-state vector selection based RCMV-SVM are called Method I and Method II, respectively. The average switching frequencies of CSR and CSI are updated based on (3.33) every 30 consecutive fundamental periods, meaning 0.5s in this case. Table 6.1 SYSTEM PARAMETERS IN SIMULATION
System Ratings Rated power Rated line-to-line voltage Rated line current 1MW 4160V 139A System Parameters filter reactor Lf 0.15pu DC chock Ldc 1pu Rectifier side capacitor Cr 0.4pu Inverter side capacitor Ci 0.4pu Induction Motor Parameters Stator resistance Rs 0.2 Rotor resistance Rr Stator leakage inductance Lls Rotor leakage inductance Llr Magnetizing inductance Lm Moment of inertia J 0.146 5.2mH 5.2mH 155mH

Induction Motor Ratings Rated output power 1260hp Rated line-to-line voltage Rated stator current Rated speed Rated torque Rated rotor flux linkage 4160V 150A 1189rpm 7490Nm 8.35Wb

22kg  m 2

6.3.1 Sampling Frequency Selection
Sampling frequency is always a crucial parameter in control realization, which directly affects output performance. For MPCs, high sampling frequencies, normally higher than 10kHz, are required to ensure the accuracy of prediction process. In this work, the sampling frequency for RCMV-MPC is selected as 10kHz, meaning the sampling interval equal to 100s . In order to keep a fair comparison between conventional methods and RCMV-MPC, a multi-sampling SVM (MS-SVM), presented in [30], is used in both Method I and Method II. With MS-SVM, the PWM counter period is still kept constant at 1/2160s, but there are multiple sampling points in one counter period. Here the sampling frequency of 8640Hz is selected for both Method I and 173

Method II, which means that there are four sampling points every PWM counter period. The main advantage of MS-SVM is the reduction of low-order harmonics in PWM currents through optimizing dwell time for active and zero-state vectors in one counter period. On the other hand, MS-SVM does not affect the CMV values. Table 6.2 presents the output performance of Method I and Method II along with different sampling frequencies. At the same operating condition of 6000Nm and rated speed, it can be found that the THDs of line current and stator current decrease with the increase of sampling frequency. Nevertheless, the CMV peak values are unchanged along with the increase of sampling frequency, which indicates that higher sampling frequencies in Method I and Method II cannot reduce the CMV stress. Table 6.2 OUTPUT PERFORMANCE ALONG WITH SAMPLING FREQUENCY
Sampling Frequency (Hz) 2160 4320 6480 8640 THD of ig (%) 9.68 6.29 4.24 3.78 Method I THD of is (%) 2.14 1.34 0.81 0.71 THD of ig (%) 9.85 6.38 4.29 3.79 Method II THD of is (%) 2.12 1.39 0.86 0.69

CMV Peak (V) 6920 6750 7200 7200

CMV Peak (V) 3975 3950 4000 4000

6.3.2 Weighting Factor Selection
In (6.21), tracking reference and CMV further reduction are associated together with the weighting factor,

wcmv , which has direct impact on output performance. Fig. 6.7 shows a profile

of the CMV peak value and the THDs of the line current and the stator current with respect to the weighting factor in RCMV-MPC at rated speed and 6000Nm condition. It can be observed that with the increase of the weighting factor, the distortion in the line current and the stator current becomes higher, and the CMV peak value becomes smaller. However, with the further increase of the weighting factor, the effect on the CMV peak value reduction becomes not that significant, and the distortion in the line current and the stator current continuously becomes heavier. In fact, there is an approximate optimal trade-off point between CMV peak value reduction and output performance, which is just around 0.004 of the weighting factor, as Fig. 6.7 shows. Therefore, the weighting factor value in simulation and experimental parts are kept at 0.004. 174

4000 14 CMV Peak Value Stator Current THD 12 10 8 6 2000 Line Current THD 4 2 1000 0 0 0.012

CMV Peak / (V)

3000

0.002

0.004

0.006

0.008

0.01

wcmv

Fig. 6.7 Profile of CMV peak value and THD versus wcmv at rated speed and 6000Nm condition.

6.3.3 Steady State Performance
Table 6.3 presents the quantitative steady state performance of three methods at various operating conditions. `NA' represents that there is no CMV peak limitation used. The largest CMV peak value appears with Method I, which is caused by the CSR-side and the CSI-side zero-state vectors with higher CMV values. Due to the use of conventional SVM, the switching frequencies at both CSR and CSI sides are kept at 1080Hz. With Method II, the CMV peak value is reduced to just around the summation of the half peak values of the CSR-side and CSIside capacitor phase voltages, which is also equal to the CMV limitation used in RCMV-MPC. Since optimal selection of zero-state vectors at both CSR and CSI sides will not have influence on output performance, it can be found that the THDs of the line current and the stator current are very close to those of Method I. Due to zero-state vector selection process, the switching frequencies of Method II become larger and variable with the operating conditions. The minimum CMV peak value is generated by RCMV-MPC all the time, with which the CMV peak value is approximately further reduced to only about 60% of that by Method II due to the
( x, y ) (k + 1) , in (6.21). The switching frequencies of penalty effect of the CMV related term, g 2

RCMV-MPC are also variable. At different operating conditions, the CSI-side average 175

THD / (%)

switching frequencies are around 1200Hz, which are even lower than that of Method II. On the other hand, the CSR-side switching frequencies, which become larger with the decrease of the rotating speed of the IM, are generally higher than that at the CSI side. In comparison with RCMV-MPC, Method I and Method II with very close switching frequencies and sampling frequencies can provide lower current distortion, especially on stator current, but the THD of stator current is not a crucial issue in motor drives. In terms of CMV, RCMV-MPC achieves the lowest CMV peak values all the time. Moreover, both Method II and RCMV-MPC are the methods aiming at CMV peak value reduction, and share very close switching frequencies no matter at CSR or CSI side. Though Method II realizes lower THDs of the line current and the stator current, RCMV-MPC achieves further CMV peak value reduction with respect to the results of Method II. Table 6.3 SIMULATION RESULTS OF THREE METHODS FOR COMPARISON
Rotor speed (rpm) 1189 Load torque (Nm) 6000 Motor-side synchronous frequency (Hz) 59.9 Scheme Method I Method II
RCMV-MPC

f sw (Hz)

THD (%) CSR 3.78 3.79 4.91 2.61 2.36 3.93 3.14 3.19 4.88 3.04 2.57 2.77 2.33 3.16 6.07 1.73 1.88 3.89 CSI 0.71 0.69 4.59 0.83 0.83 6.40 2.72 2.62 5.72 3.36 3.95 3.74 2.70 2.60 4.51 2.12 2.11 3.78

CSR 1080 1530 1527 1080 1530 1517 1080 1481 1969 1080 1440 1757 1080 1260 2235 1080 1170 1949

CSI 1080 1532 1179 1080 1502 1365 1080 1502 1210 1080 1500 1304 1080 1457 1209 1080 1301 1271

1189

1000

59.6

Method I Method II
RCMV-MPC

800

6000

40.5

Method I Method II
RCMV-MPC

800

1000

40.1

Method I Method II
RCMV-MPC

200

6000

10.5

Method I Method II
RCMV-MPC

200

1000

10.1

Method I Method II
RCMV-MPC

CMV limit (V) NA NA 3670 NA NA 3485 NA NA 2945 NA NA 2916 NA NA 2140 NA NA 2087

CMV peak (V) 7200 4000 2000 7100 3900 1650 6200 3300 1750 6100 3200 1500 4760 2800 1650 4450 2750 1400

Fig. 6.8 and Fig. 6.9 show the waveforms of two typical cases in Table 6.3, representing a high power MV CSC-fed IM drive with a fan-type load. Fig. 6.8 illustrates that the IM operates at the rated speed and 6000Nm condition. From top to bottom, the phase A line current, the 176

phase U stator current, and the CMV of the motor drive system are depicted. With RCMV-MPC, the CMV peak value, which is further reduced compared to that with Method II, is strictly limited inside the CMV limitations. Besides, the performance on tracking the references at both CSR and CSI sides can be guaranteed with RCMV-MPC. Fig. 6.9 shows the waveforms at 200rpm speed and 1000Nm condition, since the load decreases with the drop of the speed for a fan-type load. The CMV peak value of RCMV-MPC is reduced to only 52% of that with Method II. Since the DC current reference becomes small at low speed and light load condition, the larger switching frequency at the CSR side with RCMV-MPC will not lead to too much increase on switching losses. Since the CSR-side control schemes in the conventional methods and RCMV-MPC are both modulating index regulation, the line current magnitudes of three methods are kept the same even at low speed and light load condition, which ensures a fair comparison, as Fig. 6.9 shows.
THD=3.78%
200
200

THD=3.79%
200

THD=4.91%
iga (A)
100
0 -100 -200

iga (A)

0 -100 -200 1.4 1.41 1.42 1.43 1.44 1.45 1.46 1.47 1.48 1.49 t/s

iga (A)

100

100 0 -100 -200 1.4 1.41 1.42 1.43 1.44 1.45 1.46 1.47 1.48 1.49 t/s

* iga
1.41 1.42 1.43 1.44

iga
1.45 1.46 1.47 1.48 1.49 t/s

1.4

THD=0.71%
200 200

THD=0.69%
200

THD=4.59%
isu (A)
100 0 -100 -200

isu (A)

0 -100 -200 1.4 1.41 1.42 1.43 1.44 1.45 1.46 1.47 1.48 1.49 t/s

isu (A)

100

100 0 -100 -200

* isu
1.41 1.42 1.43

isu
1.44 1.45 1.46 1.47 1.48 1.49 t/s

CMV peak = 7200 V
6000 4000 2000 0 -2000 -4000 -6000 1.4 1.41 1.42 1.43 1.44 1.45 1.46 1.47 1.48 1.49 t/s

1.4

1.41

1.42

1.43

1.44

1.45

1.46

1.47

1.48

1.49

t/s

CMV peak = 4000 V
vog (V)

1.4

CMV peak = 2000 V
6000 4000 2000 0 -2000 -4000 -6000 1.4 1.41 1.42

6000 4000 2000 0 -2000 -4000 -6000 1.4 1.41 1.42 1.43 1.44 1.45 1.46 1.47 1.48 1.49 t/s

vog (V)

vog (V)

lim Vog

vog
1.43 1.44

lim -Vog
1.45 1.46 1.47 1.48 1.49 t/s

(a)

(b)

(c)

Fig. 6.8 Simulated results at rated speed and 6000Nm condition: (a) Method I, (b) Method II, and (c) RCMV-MPC.

177

THD=1.73%
100 100

THD=1.88%
100

THD=3.89%
iga (A)
50 0 -50 -100

iga (A)

0 -50 -100 1.4 1.41 1.42 1.43 1.44 1.45 1.46 1.47 1.48 1.49 t/s

iga (A)

50

50 0 -50 -100 1.4 1.41 1.42 1.43 1.44 1.45 1.46 1.47 1.48 1.49 t/s

* iga
1.41 1.42 1.43 1.44

iga
1.45 1.46 1.47 1.48 1.49 t/s

1.4

THD=2.12%
80 80

THD=2.11%
80

THD=3.78%
isu (A)
40 0 -40 -80

isu (A)

0 -40 -80 1.4 1.41 1.42 1.43 1.44 1.45 1.46 1.47 1.48 1.49 t/s

isu (A)

40

40 0 -40 -80 1.4 1.41 1.42 1.43 1.44 1.45 1.46 1.47 1.48 1.49 t/s

* isu

isu
1.41 1.42 1.43 1.44 1.45 1.46 1.47 1.48 1.49 t/s

1.4

CMV peak = 4450 V
4000 2000

CMV peak = 2750 V
2000

CMV peak = 1400 V
vog (V)
1000 0 -1000 -2000

vog (V)

2000 0 -2000 -4000 1.4 1.41 1.42 1.43 1.44 1.45 1.46 1.47 1.48 1.49 t/s

vog (V)

1000 0 -1000 -2000 1.4 1.41 1.42 1.43 1.44 1.45 1.46 1.47 1.48 1.49 t/s

lim Vog

vog
1.41 1.42 1.43 1.44 1.45 1.46

lim -Vog
1.47 1.48 1.49 t/s

1.4

(a)

(b)

(c)

Fig. 6.9 Simulated results at 200rpm and 1000Nm condition: (a) Method I, (b) Method II, and (c) RCMV-MPC. Fig. 6.10 shows a zoomed CMV diagram of Method II and RCMV-MPC at rated speed and 6000Nm condition to demonstrate the mechanism of CMV peak value further reduction in RCMV-MPC. The CMVs at the CSR and CSI side, and that of the whole system are illustrated from top to bottom. No matter with Method II or RCMV-MPC, the CMVs at the CSR and CSI sides can both be limited no larger than the half peak values of the respective capacitor phase voltages. As Fig. 6.10 shows, due to the further arrangement of the applied space vectors at both CSR and CSI sides, some peaks with Method II can be eliminated, which achieves the further reduction of the CMV peak values.

178

4000

vcmr (V)

2000 0 -2000 -4000 1.475 4000 1.48 1.485 1.49 1.495 t/s

vcmr (V)

CMV Peak

4000 2000 0 -2000 -4000 1.475 4000 1.48 1.485

CMV Peak Further Reduction

1.49

1.495

t/s

vcmi (V)

2000 0 -2000 -4000 1.475 4000 1.48 1.485 1.49 1.495 t/s

vcmi (V)

2000 0 -2000 -4000 1.475 4000 1.48 1.485 1.49 1.495 t/s

vog (V)

vog (V)

2000 0 -2000 -4000 1.475 1.48 1.485 1.49 1.495 t/s

2000 0 -2000 -4000 1.475 1.48 1.485 1.49 1.495 t/s

(a)

(b)

Fig. 6.10 Zoomed CMV results at rated speed and 6000Nm condition: (a) Method II and (b) RCMV-MPC.

6.3.4 Transient Performance
The start-up performance at no-load condition with Method I, Method II, and RCMV-MPC is illustrated in Fig. 6.11. From top to bottom, the DC current, the torque, and the CMV, are depicted. In RCMV-MPC, the CMV peak value limitations, are also shown. At time t of 0.4s, the speed reference jumps from 0 to 1189rpm. The output limitation of the speed controller is 1.5 times the rated torque. Since the dynamic responses of the CSR-side and CSI-side capacitors are not taken into consideration in Method I and Method II, which are based on traditional linear control schemes, large overshoots can be observed in the torque and the DC current during the start-up process. Due to the advantages offered by MPC approach based scheme, better dynamic performance is obtained by RCMV-MPC, with which the torque and DC current overshoots are effectively mitigated. Moreover, during the whole start-up process, the CMV with RCMV-MPC can be limited not surpassing the CMV peak value limitations. In contrast to Method II, further CMV peak value reduction can also be achieved during the start-up process with RCMV-MPC.

179

* I dc , I dc (A)

* I dc , I dc (A)

* I dc , I dc (A)

400 300 200 100 0 0.3 0.35 0.4 0.45 0.5 0.55

I dc
I
* dc

400 300 200 100 0 0.3 0.35 0.4 0.45 0.5 0.55

I dc
I
* dc

400 300 200 100 0 0.3 0.35 0.4 0.45 0.5 0.55 0.6

* I dc

I dc

0.6

0.65

0.7

0.75

t/s

0.6

0.65

0.7

0.75

t/s

0.65

0.7

0.75

t/s

Te* , Te (Nm)

Te* , Te (Nm)

Te* , Te (Nm)

12000 8000 4000 0 0.3

T
0.35 0.4 0.45

* e

Te
0.55 0.6 0.65 0.7 0.75 t/s

12000 8000 4000 0 0.3

12000 8000 4000 0 0.3

T
0.35 0.4 0.45

* e

Te
0.55 0.6 0.65 0.7 0.75 t/s

Te*
0.35 0.4 0.45 0.5 0.55 0.6 0.65

Te
0.7 0.75 t/s

0.5

0.5

6000 4000 2000 0 -2000 -4000 -6000 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75 t/s

6000 4000 2000 0 -2000 -4000 -6000 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75 t/s

6000 4000 2000 0 -2000 -4000 -6000 0.3 0.4 0.5

vog (V)

vog (V)

vog (V)

lim Vog

vog
0.6

lim -Vog
0.7 0.8 t/s

(a)

(b)

(c)

Fig. 6.11 Simulation results during start-up process at no-load condition: (a) Method I, (b) Method II, and (c) RCMV-MPC.
* , I dc (A) I dc * I dc , I dc (A)
500 400 300 200 100 0 0.8 0.9 1 500 400 300 200 100 0 0.8 0.9 1

* I dc , I dc (A)

* I dc

* I dc

500 400 300 200 100 0 0.8 0.9 1

* I dc

I dc
1.1 1.2 1.3 1.4 1.5 1.6 t/s

I dc
1.1 1.2 1.3 1.4 1.5 1.6 t/s

I dc
1.1 1.2 1.3 1.4 1.5 1.6 t/s

Te* , Te (Nm)

Te* , Te (Nm)

0 -5000 -10000 -15000 -20000 0.8 0.9 1

0 -5000 -10000 -15000 -20000 0.8 0.9 1

Te* , Te (Nm)

0 -5000 -10000 -15000 -20000 0.8 0.9 1

Te*

T

* e

Te*

Te
1.1 1.2 1.3 1.4 1.5 1.6 t/s

Te
1.1 1.2 1.3 1.4 1.5 1.6 t/s

Te
1.1 1.2 1.3 1.4 1.5 1.6 t/s

6000 4000 2000 0 -2000 -4000 -6000 0.8 0.9 1 1.1 1.2 1.3 1.4 1.5 1.6 t/s

6000 4000 2000 0 -2000 -4000 -6000 0.8 0.9 1 1.1 1.2 1.3 1.4 1.5 1.6 t/s

6000 4000 2000 0 -2000 -4000 -6000 0.8 0.9

vog (V)

vog (V)

vog (V)

lim Vog
lim -Vog
1.1 1.2 1.3 1.4 1.5 1.6 t/s

vog
1

(a)

(b)

(c)

Fig. 6.12 shows the simulation results during speed-reverse process at no-load condition. When the IM operates at rated speed, the speed reference changes from the positive to the negative rated value at time t of 1s. Similar as the results during start-up process, RCMV-MPC achieves the smallest CMV peak value, which is strictly restricted between the CMV peak value limitations during the process. Moreover, in comparison with two conventional counterparts, RCMV-MPC obtains better dynamic performance indicated by the smaller DC current overshoot and the mitigation on the torque overshoot.

180

* I dc , I dc (A)

500 400 300 200 100 0 0.8 0.9 1

* I dc , I dc (A)

500 400 300 200 100 0 0.8 0.9 1

* I dc , I dc (A)

* I dc

* I dc

500 400 300 200 100 0 0.8 0.9 1

* I dc

I dc
1.1 1.2 1.3 1.4 1.5 1.6 t/s

I dc
1.1 1.2 1.3 1.4 1.5 1.6 t/s

I dc
1.1 1.2 1.3 1.4 1.5 1.6 t/s

Te* , Te (Nm)

Te* , Te (Nm)

0 -5000 -10000 -15000 -20000 0.8 0.9 1

0 -5000 -10000 -15000 -20000 0.8 0.9 1

Te* , Te (Nm)

0 -5000 -10000 -15000 -20000 0.8 0.9 1

Te*

T

* e

Te*

Te
1.1 1.2 1.3 1.4 1.5 1.6 t/s

Te
1.1 1.2 1.3 1.4 1.5 1.6 t/s

Te
1.1 1.2 1.3 1.4 1.5 1.6 t/s

6000 4000 2000 0 -2000 -4000 -6000 0.8 0.9 1 1.1 1.2 1.3 1.4 1.5 1.6 t/s

6000 4000 2000 0 -2000 -4000 -6000 0.8 0.9 1 1.1 1.2 1.3 1.4 1.5 1.6 t/s

6000 4000 2000 0 -2000 -4000 -6000 0.8 0.9

vog (V)

vog (V)

vog (V)

lim Vog
lim -Vog
1.1 1.2 1.3 1.4 1.5 1.6 t/s

vog
1

(a)

(b)

(c)

Fig. 6.12 Simulation results during speed-reverse process at no-load condition: (a) Method I, (b) Method II, and (c) RCMV-MPC.

6.4 Experimental Verification
In order to further verify the effectiveness of RCMV-MPC, some experiments are conducted on a low power CSC-fed IM drive prototype. Fig. 6.13 shows the photograph of the low power prototype, of which the ratings and parameters are listed in Table 6.4. The prototype mainly consists of a back-to-back CSC, an IM, and a DC generator, which is used to provide load torque. The details on the low power prototype can be referred to Section 3.4. The experimental results of Method I and Method II are also provided for comparison. In order to keep a fair comparison, the PWM counter period of 1/1800s and MS-SVM with sampling frequency of 7200Hz are used in both Method I and Method II, which leads to a switching frequency of 900Hz in Method I. The sampling interval and weighting factor before CMV reduction term are still 100s and 0.004, respectively. The average switching frequency is calculated based on (3.33) as well.

181

Fig. 6.13 Photograph of a low power CSC-fed IM drive prototype: (A) three-phase power supply, (B) filter inductor, (C) CSR-side capacitor, (D) CSR and CSI, (E) DC-choke, (F) CSI-side capacitor, (G) induction motor, (H) DC motor, (I) DC load, and (J) oscilloscopes. Table 6.4 SYSTEM PARAMETERS IN EXPERIMENTS
System Ratings Rated power Rated line-to-line voltage Rated line current System Parameters Filter reactor L f 0.218pu DC chock Ldc Rectifier side capacitor Cr 1.16pu 0.378pu

5kW 208V 13.9A

Induction Motor Ratings Rated output power 5hp Rated line-to-line voltage Rated stator current Rated speed Rated torque Rated rotor flux linkage 208V 14.3A 1700rpm 21Nm 0.433Wb

Inverter side capacitor Ci 0.378pu Induction Motor Parameters Stator resistance Rs 0.395 Rotor resistance Rr Stator leakage inductance Lls Rotor leakage inductance Llr Magnetizing inductance Lm Moment of inertia J 0.737 1.95mH 1.95mH 47.1mH
0.08kg  m 2

6.4.1 Steady State Performance

182

Table 6.5 EXPERIMENTAL RESULTS OF THREE METHODS FOR COMPARISON
Rotor speed (rpm) 1700 Load torque (Nm) 16.8 Motor-side synchronous frequency (Hz) 60 Scheme Method I Method II
RCMV-MPC

f sw (Hz)

THD (%) CSR 6.99 8.02 7.64 8.97 8.98 7.79 5.69 5.87 7.12 8.72 8.75 8.44 9.25 10.3 7.59 9.98 10.1 7.04 CSI 3.30 4.88 13.8 4.12 4.79 12.9 3.12 3.34 9.82 4.01 4.38 9.49 4.39 5.11 8.10 4.96 5.13 7.15

CSR 900 1020 950 900 1007 960 900 993 1005 900 940 1010 900 931 1020 900 930 1020

CSI 900 1019 930 900 1016 950 900 992 980 900 928 1005 900 967 992 900 921 1020

1700

2.1

58

Method I Method II
RCMV-MPC

850

16.8

32

Method I Method II
RCMV-MPC

850

2.1

29

Method I Method II
RCMV-MPC

180

16.8

10

Method I Method II
RCMV-MPC

180

2.1

7

Method I Method II
RCMV-MPC

CMV limit (V) NA NA 190 NA NA 190 NA NA 173 NA NA 165 NA NA 148 NA NA 135

CMV peak (V) 360 240 150 350 210 140 280 200 140 260 185 130 240 170 130 230 160 120

Table 6.5 lists the experimental results of three methods at various steady-state operating conditions. The minimum CMV peak value, which is highlighted in Table 6.5, can be obtained with RCMV-MPC at all the listed operating conditions. The CMV peak values of RCMV-MPC are limited not surpassing the CMV peak limitations, and around 70% of that with Method II, which verifies the CMV further reduction achieved by RCMV-MPC. Besides, according to the THDs of the line current and the stator current, the balance between the control objectives on tracking the references at both CSR and CSI sides can be realized based on (6.21). The average switching frequencies of Method II and RCMV-MPC are both variable, and the switching frequencies of Method II are even higher than that of RCMV-MPC in some cases. Similar as the simulation results of RCMV-MPC, the average switching frequencies of CSR are higher than that of CSI, and increase with the decrease of the rotor speed. Though Method I and Method II can realize lower current distortion, RCMV-MPC achieves CMV peak value further reduction, even in contrast to Method II. It can be observed that the line current THDs of Method I and Method II with MS-SVM are not as satisfactory as those in Table 6.3. The consequence is caused by low-order harmonics contained in the real power supply voltage. Since MS-SVM can 183

just eliminate low-order harmonics in PWM currents, the effect of the distortion in the power supply voltage on the line current cannot be mitigated. Fig. 6.14 and Fig. 6.15 show the steady state responses at two typical operating conditions in Table 6.5 with a fan-type load. From top to bottom, the phase A line current, the phase U stator current, and the CMV of the whole system are presented. In Fig. 6.14, at 1700rpm and 16.8Nm condition, the CMV peak value of Method I is as high as 360V. Method II reduces the CMV peak value to 240V. The CMV peak value of RCMV-MPC is further reduced to only 150V, smaller than 70% of that with Method II. Fig. 6.15 shows the performance at 180rpm and 2.1Nm condition. The CMV peak values of Method I and Method II are 230Vand 160V, respectively. With RCMV-MPC, the CMV peak value is further reduced to only 120V.
iga (10A div) THD(iga ) = 6.99% iga (10A div)
THD(iga ) = 8.02%

iga (10A div) THD(iga ) = 7.64%

isu (10A div) THD(isu ) = 3.33%

isu (10A div) THD(isu ) = 4.88%

isu (10A div) THD(isu ) = 13.8%

10ms

peak vog (100V div) vog = 360V

10ms

10ms
peak vog = 240V

vog (100V div)

vog (100V div)

peak vog = 150V

(a)

(b)

(c)

Fig. 6.14 Experimental results at 1700rpm and 16.8Nm condition: (a) Method I, (b) Method II, and (c) RCMV-MPC.

184

iga (10A div) THD(iga ) = 9.98%

iga (10A div) THD(iga ) = 10.1%

iga (10A div) THD(iga ) = 7.04%

isu (10A div)

THD(isu ) = 4.96%

isu (10A div)

THD(isu ) = 5.13%

isu (10A div)

THD(isu ) = 7.15%

25ms

25ms
peak vog = 230V

25ms

vog (100V div)

vog (100V div)

peak vog = 160V

vog (100V div)

peak vog = 120V

(a)

(b)

(c)

Fig. 6.15 Experimental results at 180rpm and 2.1Nm condition: (a) Method I, (b) Method II, and (c) RCMV-MPC. Table 6.6 shows the execution time of three methods in every sampling interval. It can be found that RCMV-MPC requires the longest execution time. Fortunately, due to superb calculation capability of nowadays DSPs and the reduced calculation burden by preliminary calculation stage in Fig. 6.6, RCMV-MPC can still be realized inside a small sampling interval, such as 100s in this case. Table 6.6 EXECUTION TIME OF THREE METHODS
Method Execution time 40s Method I 46s Method II 75s RCMV-MPC

6.4.2 Transient Performance
Fig. 6.16 shows the start-up performance of three methods at no-load condition. The DC current, the torque, and the CMV are presented. The DC current reference, the torque and its reference are measured through the D/A interfaces in the prototype. The DC current is directly 185

measured through a current probe. The speed reference steps to the rated speed of 1700rpm. The output limitations of the speed controller is the rated torque of 21Nm. The CMV peak value of RCMV-MPC during start-up process can still be regulated and further reduced. Moreover, in comparison with Method I and Method II, the torque overshoot is significantly mitigated with RCMV-MPC.
* I dc (10A div) I dc (10A div) * I dc (10A div) I dc (10A div) * (10A div) I dc

I dc (10A div)

Te (7Nm div)

Te (7Nm div)

Te (7Nm div)

250ms

Te* (7Nm div)

vog (100V div)

250ms

Te* (7Nm div)

250ms

Te* (7Nm div)

vog (100V div)

vog (100V div)

(a)

(b)

(c)

Fig. 6.16 Experimental results during start-up process at no-load condition: (a) Method I, (b) Method II, and (c) RCMV-MPC. Fig. 6.17 shows the experimental results of three methods during speed-reverse process, in which the speed reference changes from the positive to the negative rated value at no-load condition. The CMV generated by RCMV-MPC is strictly restricted, and also the smallest among three methods during the whole process. Moreover, in contrast to Method I and Method II, RCMV-MPC presents better torque dynamic response with the reduction of the torque overshoot, which further verifies the effectiveness of RCMV-MPC as well.

186

I dc (10A div)
I (10A div)
* dc * I dc (10A div)

I dc (10A div)
I (10A div)
* dc

I dc (10A div)
Te (7Nm div)

Te (7Nm div)

Te (7Nm div)

500ms

Te* (7Nm div) vog (100V div)

500ms

Te* (7Nm div)

500ms

Te* (7Nm div)

vog (100V div) vog (100V div)

(a)

(b)

(c)

Fig. 6.17 Experimental results during speed reverse at no-load condition: (a) Method I, (b) Method II, and (c) RCMV-MPC.

6.5 Conclusion
In this chapter, RCMV-MPC for high power CSC-fed MV IM drive has been presented. Both simulation and experimental results are provided to validate the effectiveness of the two schemes, based on which some conclusions can be drawn as · In terms of performance on CMV peak value reduction, RCMV-MPC can reduce the CMV peak value to only around 40% of that by conventional SVM. Moreover, compared to zero-state vector selection based RCMV-SVM, nearly 40% reduction on CMV peak value can be achieved in different operating states of IM. Relying on the unified cost function, satisfactory performance on tracking references at both CSR and CSI sides can be achieved by RCMV-MPC; · Last but not least, thank to relatively high sampling frequency used in MPC, no matter MPPFC or RCMV-MPC can realize better dynamic performance in contrast to their traditional linear control counterparts. Especially for RCMV-MPC, constraint and

187

reduction on CMV peak value can still be kept during transient processes, which is not guaranteed by conventional methods.

188

7 Conclusions and Future Work
High power current-source converters (CSCs) have been more and more applied into medium-voltage (MV) motor drives, due to their specific features in contrast to their voltagesource counterparts. However, with more stringent requirements on control performance imposed on industrial drives, traditional control schemes cannot meet these stricter requirements. In this research, various model predictive control (MPC) schemes have been developed and validated aiming high power CSC-fed MV induction motor (IM) drives. The outcomes of the research work presented in this dissertation has brought several major innovations in the development of advanced control schemes for high power CSC-fed MV drives, which promotes MPC schemes as a simple, efficient, and versatile control technique for high power CSC-fed MV IM drives, normally operating at a very low (<1kHz) switching frequency to minimize converter power losses. Various control objectives such as line current control, DC current regulation, manipulation of switching commutations, and CMV peak reduction are incorporated straight forward in the design and operation of MPC schemes. The modeling and analysis presented in this dissertation can also be used in other power converters and energy conversion applications.

7.1 Conclusions
The major contributions and conclusions of this research are summarized as follows. 1) A review on high power CSC-fed MV motor drive, its traditional control schemes, and conventional MPC schemes is presented A review on the traditional control schemes and the conventional MPC schemes for high power CSC-fed MV motor drive is presented. Various control techniques for both CSR and CSIfed motor drive, their features and drawbacks are analyzed and summarized; 2) An appropriate discretiaztion method is selected for the second-order system in CSC In this research, various discretization methods are discussed and compared with each other, in which Henu's method is finally selected to discretize the continuous-time dynamic models of high power CSC-fed MV IM drive. The discrete-time models are suitable for second-order 189

systems as in CSR and CSI, and calculation friendly, which can be easily realtime updated, and used to predict various variables including line/stator currents, DC current, switching commutations, and CMVs, and to incorporate control delay compensation; 3) Model predictive power factor control (MPPFC) is proposed to control high power CSR With MPPFC, the line power factor of high power CSR can be accurately regulated to reach maximum achievable value under various operating conditions. In comparison with conventional MPC and traditional modulation index control, the line power factor increases from 0.681 and 0.474 to 0.998 under half rated DC current condition. Moreover, aiming at the possible line-side LC resonance, an active-damping method is incorporated into MPPFC, which further improves the active-dampling performance during transients; In consideration of the perturbation of the filter parameters in CSR, an online capacitance estimation method is proposed and incorporated into MPPFC. With the capacitance estimation method, the discrepancy between the real capacitance and the value used in control can be gradually mitigated, which enhances the robustness of MPPFC; 4) Model predictive switching pattern control (MPSPC) is proposed to achieve low switching frequency operation and improved dynamic performance for high power CSC MPSPC combines selective harmonic elimination (SHE) modulation with MPC approach. The final control objective is that in steady state, the output currents of CSC can follow the switching patterns of SHE modulation, which fixes the switching frequency at a very low value, and achieves low-order harmonic elimination, on the other hand, CSC is governed through MPC approach in order to achieve better dynamic responses during transients; In addition, the weighting factors in conventional MPC are normally selected through an experiential process. This process is avoided in MPSPC, which simplifies the complexity of control design; 5) Model predictive space vector pattern control (MPSVPC) is proposed for high power CSC-fed MV IM drive

190

MPSVPC can be viewed as an extension of MPSPC. Space vector modulation (SVM) takes the place of SHE modulation in MPSVPC, which makes it more suitable for variable-frequency application. In this research, MPSVPC is applied into high power CSC-fed MV IM drive, which achieves a fixed switching frequency with PWM waveform following space vector pattern of SVM, and improves dynamic response in contrast to traditional SVM scheme. The weighting factor selection issue is eliminated in MPSVPC as well as MPSPC; 6) Common-mode voltage reduced model predictive control (RCMV-MPC) scheme is proposed for high power CSC-fed MV IM drive CMV would lead to the premature failure of motor winding insulation system, and shorten the life expectancy of motor, so the magnitude of CMV needs to be mitigated. The proposed RCMV-MPC scheme uses the prediction model of the CMV in high power CSC-fed MV IM drive to reduce the peak value of CMV. RCMV-MPC reduces the CMV peak value to only around 40% of that by conventional SVM. Moreover, compared to zero-state vector selection based RCMV-SVM, nearly 40% reduction on CMV peak value can be achieved in different operating states of IM with RCMV-MPC; 7) Simulation and experimental studies are conducted to validate the performance of the proposed schemes All the simulations are carried out using MATLAB/Simulink software aiming a megawatt MV IM drive system. On the other hand, all the theory, control system design, and simulation have been validated through the tests on a low power CSC-fed IM drive.

7.2 Future Work
The following future research works are suggested as an extension to the knowledge presented in this dissertation. 1) Comparison of MPC schemes between VSC and CSC The thorough comparison can be carried out between MPC schemes for VSC and CSC. Some features based on output performance and individual special issues can be unveiled to distinguish the application of MPC on these two kinds of converters; 191

2) Operation of the proposed scheme under unbalanced utility supply fault condition Investigation of the proposed scheme for CSR under unbalanced utility supply fault condition and development of new control schemes denote a very good research direction to meet the emerging grid code requirements; 3) Application of MPC approach to multilevel current-source converter (MCSC) In order to increase the power rating of motor drive system, several CSCs are possibly connected in parallel, and operated as a MCSC. Hence, appropriate MPC scheme for MCSC is also deserved to be studied in terms of the increment on difficulty of designing modulation scheme for MCSC.

192

Appendix A
Per-Unit Values for CSC System A.1 Base values for AC-side quantities
The base values for a CSC system AC-side quantities are given in Table A.1. Table A.1 BASE VALUES FOR CSC-SIDE QUANTITIES
Quantity Apparent power Active power Voltage Current Impedance Frequency Inductance Capacitance Flux-linkage Torque Symbol and Expression 3 S B = VB I B 2
PB VB

IB =

2S B 3VB V ZB = B IB

Description The rated power of induction motor or power converter The rated induction motor mechanical output power or rated converter output power Amplitude of nominal line-toneutral voltage Amplitude of nominal line current

 B = 0
LB = CB =

Utility power supply nominal frequency

B

ZB

1 B Z B V B = B

B P TB = B B

A.2 Base values for DC-side quantities
The DC-side base values are determined based on those of the AC side. The base power is the same for both DC and AC sides. The DC-side base current is defined to be equal to the ACside base current. The base values for DC-side quantities are summarized in Table A.2. 193

Table A.2 BASE VALUES FOR CSC DC-SIDE QUANTITIES
Quantity Power Current Voltage Impedance Inductance Capacitance Symbol and expression = PB _ dc V= PB B _ dc I B _ dc
I B _ dc = I B 3 VB _ dc = VB 2 3 Z B _ dc = Z B 2 3 LB _ dc = LB 2 2 CB _ dc = CB 3

Description Same as AC-side base power

194

Bibliography
[1] S. Rizzo and N. Zargari, "Medium voltage drives: what does the future hold?," The 4th International Power Electronics and Motion Control Conference (IPEMC 2004), vol. 1, pp. 8289, 2004. R. Bhatia, H. U. Krattiger, A. Bonanini, D. Schafer, J. T. Inge, and G. H. Sydnor, "Adjustable speed drive with a single 100-MW synchronous motor," ABB Review, pp. 14-20, 1998. P. K. Steimer, H. Gruning, J. Werninger, E. Carroll, S. Klaka, and S. Linder, "IGCT-a new emerging technology for high power, low cost inverters," IEEE Industry Applications Magazine, vol. 5, pp. 12-18, 1999. H. Brunner, M. Hierholzer, T. Laska, and A. Porst, "Progress in development of the 3.5 kV high voltage IGBT/diode chipset and 1200 A module applications," 1997 IEEE International Symposium on Power Semiconductor Devices and IC's (ISPSD'97), pp. 225-228, 1997. B. Wu, High-power converters and AC drives: John Wiley & Sons, 2006. W. C. Rossmann and R. G. Ellis, "Retrofit of 22 pipeline pumping stations with 3000-hp motors and variable-frequency drives," IEEE Transactions on industry applications, vol. 34, pp. 178186, 1998. R. Menz and F. Opprecht, "Replacement of a wound rotor motor with an adjustable speed drive for a 1400 kW kiln exhaust gas fan," IEEE-IAS/PCA 44th Cement Industry Technical Confernece, pp. 85-93, 2002. B. Schmitt and R. Sommer, "Retrofit of fixed speed induction motors with medium voltage drive converters using NPC three-level inverter high-voltage IGBT based topology," IEEE International Symposium on Industrial Electronics (ISIE 2001), vol. 2, pp. 746-751, 2001. S. Bernet, "Recent developments of high power converters for industry and traction applications," IEEE Transactions on Power Electronics, vol. 15, pp. 1102-1117, 2000. H. Okayama, R. Uchida, M. Koyama, S. Mizoguchi, S. Tamai, H. Ogawa, et al., "Large capacity high performance 3-level GTO inverter system for steel main rolling mill drives," Thirty-First IAS Annual Meeting Industry Applications Conference (IAS'96), vol. 1, pp. 174-179, 1996. H. Akagi, "Large static converters for industry and utility applications," Proceedings of the IEEE, vol. 89, pp. 976-983, 2001. R. A. Hanna and S. W. Randall, "Medium-voltage adjustable-speed-drive retrofit of an existing eddy-current clutch extruder application," IEEE Transactions on Industry Applications, vol. 36, pp. 1750-1755, 2000. Y. Shakweh, "New breed of medium voltage converters," Power Engineering Journal, vol. 14, pp. 12-20, 2000. S. Wei, N. Zargari, B. Wu, and S. Rizzo, "Comparison and mitigation of common mode voltage in power converter topologies," 39th IAS Annual Meeting Industry Applications Conference, vol. 3, pp. 1852-1857, 2004. J. Shen and N. Butterworth, "Analysis and design of a three-level PWM converter system for railway-traction applications," IEE Proceedings-Electric Power Applications, vol. 144, pp. 357371, 1997. J. K. Steinke, R. Vuolle, H. Prenner, and J. Jarvinen, "New variable speed drive with proven motor friendly performance for medium voltage motors," International Conference Electric Machines and Drives (IEMD'99), pp. 235-239, 1999. J. Lyons, V. Vlatkovic, P. Espelage, F. Boettner, and E. Larsen, "Innovation IGCT main drives," in Industry Applications Conference, 1999. Thirty-Fourth IAS Annual Meeting. Conference Record of the 1999 IEEE, 1999, pp. 2655-2661.

[2] [3]

[4]

[5] [6]

[7]

[8]

[9] [10]

[11] [12]

[13] [14]

[15]

[16]

[17]

195

[18]

[19] [20]

[21]

[22] [23]

[24]

[25]

[26]

[27]

[28]

[29]

[30]

[31]

[32]

[33]

[34]

P. W. Hammond, "A new approach to enhance power quality for medium voltage drives," Industry Applications Society 42nd Annual Petroleum and Chemical Industry Conference, pp. 231-235, 1995. W. Hill and C. Harbourt, "Performance of medium voltage multi-level inverters," Thirty-Fourth IAS Annual Meeting Industry Applications Conference, vol. 2, pp. 1186-1192, 1999. R. H. Osman, "A medium-voltage drive utilizing series-cell multilevel topology for outstanding power quality," Thirty-Fourth IAS Annual Meeting Industry Applications Conference, vol. 4, pp. 2662-2669, 1999. J. P. McSharry, P. S. Hamer, D. Morrison, J. Nessa, and J. G. Rigsby, "Design, fabrication, backto-back test of 14200-hp two-pole cylindrical-rotor synchronous motor for ASD application," IEEE Transactions on Industry Applications, vol. 34, pp. 526-533, 1998. R. Emery and J. Eugene, "Harmonic losses in LCI-fed synchronous motors," IEEE Transactions on Industry Applications, vol. 38, pp. 948-954, 2002. J. Rodriguez, L. Moran, J. Pontt, R. Osorio, and S. Kouro, "Modeling and analysis of commonmode voltages generated in medium voltage PWM-CSI drives," IEEE Transactions on Power Electronics, vol. 18, pp. 873-879, 2003. G. F. Reed, B. M. Grainger, A. R. Sparacino, and Z. H. Mao, "Ship to Grid: Medium-Voltage DC Concepts in Theory and Practice," IEEE Power and Energy Magazine, vol. 10, pp. 70-79, 2012. Y. Xiao, B. Wu, F. A. Dewinter, and R. Sotudeh, "A dual GTO current-source converter topology with sinusoidal inputs for high-power applications," IEEE Transactions on Industry Applications, vol. 34, pp. 878-884, 1998. Y. Li, B. Wu, D. Xu, and N. R. Zargari, "Space Vector Sequence Investigation and Synchronization Methods for Active Front-End Rectifiers in High-Power Current-Source Drives," IEEE Transactions on Industrial Electronics, vol. 55, pp. 1022-1034, 2008. B. Wu, J. Pontt, J. Rodriguez, S. Bernet, and S. Kouro, "Current-Source Converter and Cycloconverter Topologies for Industrial Medium-Voltage Drives," IEEE Transactions on Industrial Electronics, vol. 55, pp. 2786-2797, 2008. B. Wu and F. Dewinter, "Elimination of harmonic resonance in high power GTO CSI induction motor drives," 25th Annual IEEE Power Electronics Specialists Conference (PESC '94), vol. 2, pp. 1011-1015, 1994. A. Hu, D. Xu, B. Wu, J. Wang, and J. Su, "Reference-Trajectory-Optimized SVM for HighPower Current-Source Converters to Improve Harmonic Performance and Reduce CommonMode Voltage," IEEE Transactions on Power Electronics, vol. PP, pp. 1-1, 2014. J. Dai, Y. Lang, B. Wu, D. Xu, and N. R. Zargari, "A Multisampling SVM Scheme for Current Source Converters With Superior Harmonic Performance," IEEE Transactions on Power Electronics, vol. 24, pp. 2436-2445, 2009. J. C. Wiseman and B. Wu, "Active damping control of a high-power PWM current-source rectifier for line-current THD reduction," IEEE Transactions on Industrial Electronics, vol. 52, pp. 758-764, 2005. F. Liu, B. Wu, N. R. Zargari, and M. Pande, "An Active Damping Method Using InductorCurrent Feedback Control for High-Power PWM Current-Source Rectifier," IEEE Transactions on Power Electronics, vol. 26, pp. 2580-2587, 2011. E. Al-nabi, B. Wu, N. R. Zargari, and V. Sood, "Input Power Factor Compensation for HighPower CSC Fed PMSM Drive Using d -Axis Stator Current Control," IEEE Transactions on Industrial Electronics, vol. 59, pp. 752-761, 2012. Z. Wang, B. Wu, D. Xu, and N. R. Zargari, "A Current-Source-Converter-Based High-Power High-Speed PMSM Drive With 420-Hz Switching Frequency," IEEE Transactions on Industrial Electronics, vol. 59, pp. 2970-2981, 2012.

196

[35]

[36]

[37]

[38]

[39]

[40]

[41]

[42]

[43]

[44]

[45] [46]

[47]

[48]

[49]

[50]

[51]

Y. Li, B. Wu, N. R. Zargari, J. C. Wiseman, and D. Xu, "Damping of PWM Current-Source Rectifier Using a Hybrid Combination Approach," IEEE Transactions on Power Electronics, vol. 22, pp. 1383-1393, 2007. J. D. Ma, B. Wu, N. R. Zargari, and S. C. Rizzo, "A space vector modulated CSI-based AC drive for multimotor applications," IEEE Transactions on Power Electronics, vol. 16, pp. 535-544, 2001. Z. Wang, B. Wu, D. Xu, and N. R. Zargari, "Hybrid PWM for High-Power Current-SourceInverter-Fed Drives With Low Switching Frequency," IEEE Transactions on Power Electronics, vol. 26, pp. 1754-1764, 2011. N. Zhu, D. Xu, B. Wu, N. R. Zargari, M. Kazerani, and L. Fangrui, "Common-Mode Voltage Reduction Methods for Current-Source Converters in Medium-Voltage Drives," IEEE Transactions on Power Electronics, vol. 28, pp. 995-1006, 2013. J. Shang and Y. Li, "A Space-Vector Modulation Method for Common-Mode Voltage Reduction in Current-Source Converters," IEEE Transactions on Power Electronics, vol. 29, pp. 374-385, 2014. J. Shang, Y. Li, N. R. Zargari, and Z. Cheng, "PWM Strategies for Common-Mode Voltage Reduction in Current Source Drives," IEEE Transactions on Power Electronics, vol. 29, pp. 5431-5445, 2014. X. Guo, D. Xu, and B. Wu, "Common Mode Voltage Mitigation for Back-To-Back Current Source Converter with Optimal Space Vector Modulation," IEEE Transactions on Power Electronics, vol. PP, pp. 1-1, 2015. M. P. Akter, S. Mekhilef, N. M. L. Tan, and H. Akagi, "Modified Model Predictive Control of a Bidirectional AC-DC Converter Based on Lyapunov Function for Energy Storage Systems," IEEE Transactions on Industrial Electronics, vol. 63, pp. 704-715, 2016. P. Cortes, M. P. Kazmierkowski, R. M. Kennel, D. E. Quevedo, and J. Rodriguez, "Predictive Control in Power Electronics and Drives," IEEE Transactions on Industrial Electronics, vol. 55, pp. 4312-4324, 2008. S. Kouro, P. Cortes, R. Vargas, U. Ammann, and J. Rodriguez, "Model Predictive Control - A Simple and Powerful Method to Control Power Converters," IEEE Transactions on Industrial Electronics, vol. 56, pp. 1826-1838, 2009. J. Rodriguez and P. Cortes, Predictive control of power converters and electrical drives vol. 40: John Wiley & Sons, 2012. S. Vazquez, J. I. Leon, L. G. Franquelo, J. Rodriguez, H. A. Young, A. Marquez, et al., "Model Predictive Control: A Review of Its Applications in Power Electronics," IEEE Industrial Electronics Magazine, vol. 8, pp. 16-31, 2014. T. Geyer, "A Comparison of Control and Modulation Schemes for Medium-Voltage Drives: Emerging Predictive Control Concepts Versus PWM-Based Schemes," IEEE Transactions on Industry Applications, vol. 47, pp. 1380-1389, 2011. S. Vazquez, J. Rodriguez, M. Rivera, L. G. Franquelo, and M. Norambuena, "Model Predictive Control for Power Converters and Drives: Advances and Trends," IEEE Transactions on Industrial Electronics, vol. PP, pp. 1-1, 2016. S. Kouro, M. A. Perez, J. Rodriguez, A. M. Llor, and H. A. Young, "Model Predictive Control: MPC's Role in the Evolution of Power Electronics," IEEE Industrial Electronics Magazine, vol. 9, pp. 8-21, 2015. Y. Zhang, W. Xie, Z. Li, and Y. Zhang, "Low-Complexity Model Predictive Power Control: Double-Vector-Based Approach," IEEE Transactions on Industrial Electronics, vol. 61, pp. 5871-5880, 2014. Y. Zhang and W. Xie, "Low Complexity Model Predictive Control - Single Vector-Based Approach," IEEE Transactions on Power Electronics, vol. 29, pp. 5532-5541, 2014.

197

[52] [53]

[54]

[55]

[56]

[57]

[58]

[59]

[60]

[61]

[62]

[63]

[64]

[65]

[66]

[67]

Z. Song, Y. Tian, W. Chen, Z. Zou, and Z. Chen, "Predictive Duty Cycle Control of Three-Phase Active-Front-End Rectifiers," IEEE Transactions on Power Electronics, vol. PP, pp. 1-1, 2015. Y. Zhang, Y. Peng, and H. Yang, "Performance Improvement of Two-Vectors-Based Model Predictive Control of PWM Rectifier," IEEE Transactions on Power Electronics, vol. PP, pp. 11, 2015. Y. Zhang, W. Xie, Li, Z. Li, and Y. Zhang, "Model Predictive Direct Power Control of a PWM Rectifier With Duty Cycle Optimization," IEEE Transactions on Power Electronics, vol. 28, pp. 5343-5351, 2013. Y. Zhang and H. Yang, "Model Predictive Torque Control of Induction Motor Drives With Optimal Duty Cycle Control," IEEE Transactions on Power Electronics, vol. 29, pp. 6593-6603, 2014. Y. Zhang and H. Yang, "Model-Predictive Flux Control of Induction Motor Drives With Switching Instant Optimization," IEEE Transactions on Energy Conversion, vol. 30, pp. 11131122, 2015. Y. Zhang and H. Yang, "Generalized Two-Vector-Based Model-Predictive Torque Control of Induction Motor Drives," IEEE Transactions on Power Electronics, vol. 30, pp. 3818-3829, 2015. Y. Zhang and H. Yang, "Two-Vector-Based Model Predictive Torque Control Without Weighting Factors for Induction Motor Drives," IEEE Transactions on Power Electronics, vol. 31, pp. 1381-1390, 2016. V. Yaramasu, M. Rivera, B. Wu, and J. Rodriguez, "Model Predictive Current Control of TwoLevel Four-Leg Inverter -- Part I: Concept, Algorithm, and Simulation Analysis," IEEE Transactions on Power Electronics, vol. 28, pp. 3459-3468, 2013. M. Rivera, V. Yaramasu, J. Rodriguez, and B. Wu, "Model Predictive Current Control of TwoLevel Four-Leg Inverters - Part II: Experimental Implementation and Validation," IEEE Transactions on Power Electronics, vol. 28, pp. 3469-3478, 2013. M. Rivera, V. Yaramasu, A. Llor, J. Rodriguez, B. Wu, and M. Fadel, "Digital Predictive Current Control of a Three-Phase Four-Leg Inverter," IEEE Transactions on Industrial Electronics, vol. 60, pp. 4903-4912, 2013. V. Yaramasu, M. Rivera, M. Narimani, B. Wu, and J. Rodriguez, "Model Predictive Approach for a Simple and Effective Load Voltage Control of Four-Leg Inverter With an Output LC Filter," IEEE Transactions on Industrial Electronics, vol. 61, pp. 5259-5270, 2014. V. Yaramasu, B. Wu, M. Rivera, and J. Rodriguez, "A New Power Conversion System for Megawatt PMSG Wind Turbines Using Four-Level Converters and a Simple Control Scheme Based on Two-Step Model Predictive Strategy -- Part I: Modeling and Theoretical Analysis," IEEE Journal of Emerging and Selected Topics in Power Electronics, vol. 2, pp. 3-13, 2014. V. Yaramasu, B. Wu, M. Rivera, and J. Rodriguez, "A New Power Conversion System for Megawatt PMSG Wind Turbines Using Four-Level Converters and a Simple Control Scheme Based on Two-Step Model Predictive Strategy -- Part II: Simulation and Experimental Analysis," IEEE Journal of Emerging and Selected Topics in Power Electronics, vol. 2, pp. 1425, 2014. V. Yaramasu, B. Wu, and J. Chen, "Model-Predictive Control of Grid-Tied Four-Level DiodeClamped Inverters for High-Power Wind Energy Conversion Systems," IEEE Transactions on Power Electronics, vol. 29, pp. 2861-2873, 2014. V. Yaramasu, B. Wu, S. Alepuz, and S. Kouro, "Predictive Control for Low-Voltage RideThrough Enhancement of Three-Level-Boost and NPC-Converter-Based PMSG Wind Turbine," IEEE Transactions on Industrial Electronics, vol. 61, pp. 6832-6843, 2014. V. Yaramasu and B. Wu, "Predictive Control of a Three-Level Boost Converter and an NPC Inverter for High-Power PMSG-Based Medium Voltage Wind Energy Conversion Systems," IEEE Transactions on Power Electronics, vol. 29, pp. 5308-5322, 2014.

198

[68]

[69]

[70]

[71]

[72] [73]

[74]

[75]

[76] [77] [78]

[79] [80]

[81]

[82] [83] [84]

[85]

M. Narimani, V. Yaramasu, B. Wu, G. Cheng, and N. Zargari, "Model predictive control of nested neutral point clamped (NNPC) converter," 2014 IEEE Energy Conversion Congress and Exposition (ECCE), pp. 1174-1179, 2014. T. Geyer and S. Mastellone, "Model Predictive Direct Torque Control of a Five-Level ANPC Converter Drive System," IEEE Transactions on Industry Applications, vol. 48, pp. 1565-1575, 2012. T. Geyer, R. P. Aguilera, and D. E. Quevedo, "On the stability and robustness of model predictive direct current control," 2013 IEEE International Conference on Industrial Technology (ICIT), pp. 374-379, 2013. T. Geyer, "Model Predictive Direct Torque Control: Derivation and Analysis of the StateFeedback Control Law," IEEE Transactions on Industry Applications, vol. 49, pp. 2146-2157, 2013. P. Correa, J. Rodriguez, I. Lizama, and D. Andler, "A Predictive Control Scheme for CurrentSource Rectifiers," IEEE Transactions on Industrial Electronics, vol. 56, pp. 1813-1815, 2009. M. Rivera, S. Kouro, J. Rodriguez, B. Wu, and J. Espinoza, "Predictive control of a current source converter operating with low switching frequency," IECON 2012 - 38th Annual Conference on IEEE Industrial Electronics Society, pp. 674-679, 2012. M. Rivera, S. Kouro, J. Rodriguez, B. Wu, V. Yaramasu, J. Espinoza, et al., "Predictive current control in a current source inverter operating with low switching frequency," 2013 Fourth International Conference on Power Engineering, Energy and Electrical Drives (POWERENG), pp. 334-339, 2013. H. Miranda, P. Cortes, J. I. Yuz, and J. Rodriguez, "Predictive Torque Control of Induction Machines Based on State-Space Models," IEEE Transactions on Industrial Electronics, vol. 56, pp. 1916-1924, 2009. D. C. Lay, Linear algebra and its applications: Addison Wesley, Boston. S. C. Chapra and R. P. Canale, Numerical methods for engineers vol. 2: McGraw-Hill, 2012. P. Cortes, S. Kouro, B. La Rocca, R. Vargas, J. Rodriguez, J. I. Leon, et al., "Guidelines for weighting factors design in Model Predictive Control of power converters and drives," IEEE International Conference on Industrial Technology (ICIT 2009), pp. 1-7, 2009. I. F II, "IEEE recommended practices and requirements for harmonic control in electrical power systems," 1993. R. P. Aguilera, P. Acuña, P. Lezana, G. Konstantinou, B. Wu, S. Bernet, et al., "Selective Harmonic Elimination Model Predictive Control for Multilevel Power Converters," IEEE Transactions on Power Electronics, vol. 32, pp. 2416-2426, 2017. T. Geyer, G. Papafotiou, and M. Morari, "Model Predictive Direct Torque Control-Part I: Concept, Algorithm, and Analysis," IEEE Transactions on Industrial Electronics, vol. 56, pp. 1894-1905, 2009. T. Geyer, N. Oikonomou, G. Papafotiou, and F. Kieferndorf, "Model predictive pulse pattern control," Energy Conversion Congress and Exposition (ECCE), pp. 3306-3313, 2011. T. Geyer and D. E. Quevedo, "Multistep Finite Control Set Model Predictive Control for Power Electronics," IEEE Transactions on Power Electronics, vol. 29, pp. 6836-6846, 2014. J. Napoles, J. I. Leon, R. Portillo, L. G. Franquelo, and M. A. Aguirre, "Selective Harmonic Mitigation Technique for High-Power Converters," IEEE Transactions on Industrial Electronics, vol. 57, pp. 2315-2323, 2010. C. Lascu, I. Boldea, and F. Blaabjerg, "A modified direct torque control for induction motor sensorless drive," IEEE Transactions on Industry Applications, vol. 36, pp. 122-130, 2000.

199


