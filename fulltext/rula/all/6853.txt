FAULT DETECTION, ISOLATION AND PROGNOSIS FOR CONTROL MOMENT GYROS ONBOARD SATELLITES

by

Venkatesh Muthusamy Bachelor of Technology, SRM University (2012)

A thesis presented to Ryerson University in partial fulfilment of the requirements for the degree of Master of Applied Science in the program of Aerospace Engineering

Toronto, Ontario, Canada, 2017 ©Venkatesh Muthusamy 2017

i

AUTHOR'S DECLARATION

I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners.

I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

I understand that my thesis may be made electronically available to the public.

__________________________ Venkatesh Muthusamy

ii

FAULT DETECTION, ISOLATION AND PROGNOSIS FOR CONTROL MOMENT GYROS ONBOARD SATELLITES Venkatesh Muthusamy Master of Applied Science, Aerospace Engineering, Ryerson University, Toronto (2017)

Abstract Developing a Diagnosis, Prognosis and Health Monitoring (DPHM) framework for a small satellite is a challenging task due to the limited availability of onboard health monitoring sensors and computational budget. This thesis deals with the problem of developing DPHM framework for a satellite attitude actuator system that uses a single gimballed Control Moment Gyro (CMG) in pyramid configuration as an actuator. This includes the development of computationally light data-driven model, fault detection, isolation and prognosis algorithms that works only using the attitude rate measurements from the satellite. A novel scheme is proposed for developing a data-driven model which fuses the symmetric property of the data and the system orientation property of actuators that reduces the need for historical data by 93.75%. The data is trained using Chebyshev Neural Network. A threshold based fault detection algorithm is used to detect the faults of spin motor and gimbal motor used in a CMG. A novel optimization based fault isolation formulation is developed and simulated for given uniformly distributed system parameters. The algorithm has a success rate of 93.5% in isolating faults of 8 motors (4 gimbal and 4 spin) that can fail in 254 different ways. For Fault Prognosis, an error based scheme is developed as a measure of degradation. General path model with Bayesian updating is used for predicting the remaining useful life of the spin motor. It performs with 96.25% accuracy when 30% of data is available. Overall, the proposed algorithms can be regarded as a promising DPHM tool for similar non-linear systems. iii

Acknowledgements
I am extremely grateful to my supervisor, Dr. Krishna Dev Kumar for providing me with two years of guidance and support during my master's program. The projects that I have completed in the last two years would have never been accomplished without the motivation he gave me and the belief he had in me. He always inspired me to come up with new ideas and pushed me beyond my limits. I am thankful to him for providing me with the opportunities to work in different domains and for being kind and considerate towards me. I would like to thank the department of Aerospace Engineering at Ryerson University for providing me with training and opportunities to grow personally and professionally and explore new possibilities, otherwise impossible. In addition, the funding I received from school helped me with my finances during my stay in Canada. I came across talented research scholars at SSDC lab: Afshin, Michael, Sobhan, Alex, Min and Mike from whom I learned a lot towards my coursework, projects, and thesis. Additionally, I would like to thank Afshin, Min, Lubna, Sudhakar, Joash, Chris Singh and members of RUSLSA: Sujeet, Karthik, Madhavi, Sanju, Isuru, Pasindu and Jeff for their friendship and moral support as if they are my family. You were and will always be my best friends. The staff at International Student Support helped me with a smooth transition to the Canadian culture especially Priscila and Lisa who teamed up with me in the Glocal Links program. Special thanks to Norman Esch Committee and Centre for Urban energy for providing me with the awards along with ample entrepreneurship and research opportunities to extend my knowledge, expertise, hands-on and soft skills beyond my master's thesis. Thanks to my sisters Anitha and Nithya who were nothing but caring, loving parents and close friends to me, my in-laws and nephews who showed me a great amount of love and support. Special thanks to my cousin Aswini and aunt Bhavani who provided me with a home away from home during vacations when I felt homesick. Last but not least, I would like to express my immense appreciation to my parents, Parvathi and Muthusamy, who gave me unconditional support and love. I will always be indebted to them for their selfless attitude and they will always be my inspiration for moving forward in life. I hope that accomplishing this research and graduating from this program makes them feel content and proud of the son they dedicated their lives to raise to this point.

iv

For my loving Mom, Dad, Siblings, In-laws, Nephews and Loved ones

v

Table of Contents
Abstract ......................................................................................................................................... iii Acknowledgements ...................................................................................................................... iv List of Tables ................................................................................................................................ ix List of Figures ................................................................................................................................ x Abbreviations .............................................................................................................................. xii Nomenclature ............................................................................................................................. xiii 1. Introduction ......................................................................................................................... 1 1.1 Motivation ......................................................................................................................... 2 Why Small Satellites? .............................................................................................. 2 Why AOCS? ............................................................................................................ 4

1.1.1 1.1.2 1.2 1.3 1.4

History of Faults and Failures of Spacecraft AOCS Actuators ........................................ 7 DPHM for Satellite AOCS actuators ................................................................................ 8 Faults in a CMG ................................................................................................................ 9 Faults in a Gimbal Motor......................................................................................... 9 Faults in a Spin Motor ........................................................................................... 10

1.4.1 1.4.2 1.5

Literature Review............................................................................................................ 11 Fault Diagnosis ...................................................................................................... 11 Fault Prognosis ...................................................................................................... 15

1.5.1 1.5.2 1.6 1.7 1.8 1.9

Attributes of Data ............................................................................................................ 18 Problem Statement .......................................................................................................... 19 Research Objectives ........................................................................................................ 19 Main Contributions ......................................................................................................... 20

1.10 Thesis Outline ................................................................................................................. 22 2. Satellite and Actuator Dynamics ...................................................................................... 23 2.1 2.2 2.3 Reference Frames............................................................................................................ 23 Satellite Attitude Dynamics ............................................................................................ 25 Satellite Attitude kinematics ........................................................................................... 25 vi

2.4 2.5

External Disturbances Torques ....................................................................................... 27 CMG Dynamics .............................................................................................................. 28 Gimbal Motor Dynamics ....................................................................................... 32 Spin Motor Dynamics ............................................................................................ 33

2.5.1 2.5.2 2.6 3.

Summary ......................................................................................................................... 36

Data Driven Model Development ..................................................................................... 37 3.1 3.2 Proposed Data Driven FDI Algorithm ............................................................................ 37 Stage 1 - Data Acquisition and Feature Extraction ......................................................... 38 Noise Considerations ............................................................................................. 40 Data Acquisition .................................................................................................... 40 Feature Extraction.................................................................................................. 41

3.2.1 3.2.2 3.2.3 3.3

Stage 2 - Data Driven Model Component Level ............................................................ 45 Model Selection ..................................................................................................... 45 Chebyshev Neural Network................................................................................... 47 Data Normalization................................................................................................ 48 Model Training ...................................................................................................... 48 Training Results ..................................................................................................... 49 Component Level Model ....................................................................................... 52

3.3.1 3.3.2 3.3.3 3.3.4 3.3.5 3.3.6 3.4 3.5 4.

Stage 3 - Data Driven Model for AOCS Subsystem....................................................... 55 Conclusion ...................................................................................................................... 58

Fault Detection and Isolation............................................................................................ 59 4.1 Fault Detection ................................................................................................................ 60 Fault Detection Algorithm ..................................................................................... 60

4.1.1 4.2

Fault Detection Simulation Results ................................................................................ 61 Gimbal Motor - Stall fault ..................................................................................... 63 Spin Motor ­ Abrupt fault ..................................................................................... 63 Spin Motor ­ Transient fault ................................................................................. 64 Spin Motor ­ Intermittent fault .............................................................................. 64 Spin Motor ­ Incipient fault .................................................................................. 65

4.2.1 4.2.2 4.2.3 4.2.4 4.2.5 4.3

Fault Isolation ................................................................................................................. 71 vii

4.3.1 4.4

Hierarchical Methodology ..................................................................................... 72

Optimization Problem Formulation: ............................................................................... 72 Vector Decomposition Model for Spin Motors ..................................................... 74

4.4.1 4.5

Optimization Algorithm Selection .................................................................................. 76 Genetic Algorithm ................................................................................................. 76 Initial Population and Cost function ...................................................................... 77 Reproduction, Crossover and Mutation ................................................................. 77 Iteration and Stopping Criterion ............................................................................ 78

4.5.1 4.5.2 4.5.3 4.5.4 4.6 4.7 5.

Fault Isolation Simulation Results .................................................................................. 78 Summary ......................................................................................................................... 84

Fault Prognosis .................................................................................................................. 85 5.1 5.2 5.3 5.4 Data Driven Prognosis .................................................................................................... 86 Failure Degradation Model ............................................................................................. 87 Data Acquisition ............................................................................................................. 88 General Path Model ........................................................................................................ 90 Criterion for using General Path Model ................................................................ 90 Function used for GPM ......................................................................................... 92

5.4.1 5.4.2 5.5 5.6

Curve Fit Results............................................................................................................. 93 Bayesian Updating .......................................................................................................... 94 Stopping Criterion ................................................................................................. 96

5.6.1 5.7 5.8 6.

RUL prediction and Results ............................................................................................ 96 Summary ......................................................................................................................... 97

Conclusion ........................................................................................................................ 101 6.1 Summary of Contributions ............................................................................................ 101 Data-Driven Model Development ....................................................................... 101 Fault Detection .................................................................................................... 102 Fault Isolation ...................................................................................................... 102 Fault Prognosis .................................................................................................... 103

6.1.1 6.1.2 6.1.3 6.1.4 6.2

Future Work .................................................................................................................. 103

References .................................................................................................................................. 105 viii

List of Tables
Table 1.1 Classification of Satellites based on Mass ...................................................................... 2 Table 1.2 Launch Costs of Spaceflight ........................................................................................... 2 Table 2.1 Parameters for Gimbal Motor (Lyshevski 2014) .......................................................... 33 Table 2.2 Parameters of Spin Motor (ITHACO Type `A' Motor) ............................................... 35 Table 3.1 Simulation Parameters for Data Acquisition (Only CMG 1 is operated) ..................... 39 Table 3.2 Parameters of CNN ....................................................................................................... 50 Table 3.3 Effect of Gimbal Motor Operational Region on 1,  .......................................... 52 Table 3.4 Simulation Parameters for Data Driven Model, Subsystem Level. .............................. 56 Table 4.1 Simulation Parameters for fault detection .................................................................... 62 Table 4.2 Gimbal Motor - Stall fault profile and detection .......................................................... 63 Table 4.3 Spin Motor - Abrupt fault profile and detection ........................................................... 63 Table 4.4 Spin Motor - Transient fault profile and detection ....................................................... 64 Table 4.5 Spin Motor - Intermittent fault profile and detection ................................................... 65 Table 4.6 Spin Motor - Incipient fault profile and detection ........................................................ 65 Table 4.7 Simulation Parameters for Fault Isolation Algorithm................................................... 79 Table 4.8 Performance of Isolation Algorithm ............................................................................. 81 Table 4.9 Confusion Matrix: Any 1 Motor becomes faulty.......................................................... 82 Table 4.10 Confusion Matrix: Any 2 Motors becomes faulty ...................................................... 82 Table 4.11 Confusion Matrix: Any 3 Motors becomes faulty ...................................................... 82 Table 4.12 Confusion Matrix: Any 4 Motors becomes faulty ...................................................... 83 Table 4.13 Confusion Matrix: Any 5 Motors becomes faulty ...................................................... 83 Table 4.14 Confusion Matrix: Any 6 Motors becomes faulty ...................................................... 83 Table 4.15 Confusion Matrix: Any 7 Motors becomes faulty ...................................................... 84 Table 4.16 Confusion Matrix: All 8 Motors becomes faulty ........................................................ 84 Table 5.1 Simulation Parameters for Prognosis Data Collection ................................................. 89 Table 5.2 Curve fit Results/Apriori Parameters ............................................................................ 93 Table 5.3 RUL Prediction Results for different levels of available data ...................................... 97

ix

List of Figures
Figure 1.1 Subsystems in a Satellite ............................................................................................... 1 Figure 1.2 History and Projection of Small Satellite Launches from 1-50kg (Doncaste 2017) ..... 3 Figure 1.3 Subsystem wise Failure of Spacecraft from years 1980-2005 (Tafazoli 2009) ........... 5 Figure 1.4 AOCS Time to failure after launch from years 1980-2005 (Tafazoli 2009) ................ 5 Figure 1.5 Component wise Failure for AOCS for the year 1980-2005 (Tafazoli 2009) .............. 7 Figure 1.6 DPHM Module in AOCS Subsystem of Satellite ......................................................... 9 Figure 1.7 Types of Faults (Godard 2010).................................................................................... 10 Figure 1.8 Major Fault Diagnosis Methods .................................................................................. 12 Figure 1.9 Major Fault Prognosis Methods .................................................................................. 15 Figure 2.1 Reference Frames (Godard 2010) ............................................................................... 24 Figure 2.2 Single Gimballed CMGs in Pyramid Configuration ................................................... 29 Figure 2.3 High Fidelity Model for Spin Motor (Bialke 1998; Rahimi et al. 2015) .................. 36 Figure 3.1 Placement of Data-Driven Model in a Data Driven DPHM system ........................... 37 Figure 3.2 Stages of Data Driven Model Development ................................................................ 38 Figure 3.3 Data Acquisition and Feature Extraction Scheme ....................................................... 39 Figure 3.4 Data Acquisition by operating CMG 1 ........................................................................ 41 Figure 3.5 Feature Extraction from 1......................................................................................... 43 Figure 3.6 Feature Extraction from 2......................................................................................... 43 Figure 3.7 Feature Extraction from 3......................................................................................... 44 Figure 3.8 Scheme for Developing Data Driven Model - Component Level ............................... 44 Figure 3.9 A Single Perceptron Model used in ANN ................................................................... 45 Figure 3.10 Chebyshev Neural Network (CNN) Architecture ..................................................... 47 Figure 3.11 Results: CNN Training using GD-BP ...................................................................... 51 Figure 3.12 CNN estimation expanded from region I to all regions ............................................ 53 Figure 3.13 CNN estimation expanded from region I to all regions ............................................ 54 Figure 3.14 CNN estimation expanded from region I to all regions ............................................ 54 Figure 3.15 Schematic for Developing Data Driven Model: Component Level .......................... 55 Figure 3.16 Performance of the Data Driven Model, Subsystem Level ....................................... 57 Figure 4.1 Placement of FDI module in a data Driven DPHM system ........................................ 59 x

Figure 4.2 Fault Detection Scheme ............................................................................................... 60 Figure 4.3 Comparison of Adaptive and Constant Threshold ...................................................... 62 Figure 4.4 Simulation Results: Stall Fault of Gimbal Motor ........................................................ 66 Figure 4.5 Simulation Results: Abrupt Fault of Spin Motor ........................................................ 67 Figure 4.6 Simulation Results: Transient Fault of Spin Motor..................................................... 68 Figure 4.7 Simulation Results: Intermittent Fault of Spin Motor ................................................. 69 Figure 4.8 Simulation Results: Incipient Fault of Spin Motor...................................................... 70 Figure 4.9 Proposed Fault Isolation Scheme ................................................................................ 71 Figure 4.10 Hierarchical Scheme .................................................................................................. 72 Figure 4.11 Effect of Spin Motor Fault in Angular Momentum................................................... 74 Figure 4.12 Genetic Algorithm Optimization Scheme ................................................................. 77 Figure 4.13 Genetic Algorithm Optimization Convergence ......................................................... 80 Figure 5.1 Placement of Fault Prognosis Module in a data Driven DPHM system ..................... 85 Figure 5.2 Fault Prognosis Scheme .............................................................................................. 86 Figure 5.3 Statistics of Momentum Wheel Faults ........................................................................ 87 Figure 5.4 Degradation Model ...................................................................................................... 88 Figure 5.5 Run to Failure Data for two cases ............................................................................... 89 Figure 5.6 GPM fit : Case 1 .......................................................................................................... 93 Figure 5.7 GPM fit : Case 2 .......................................................................................................... 94 Figure 5.8 Prediction Without Bayesian Update .......................................................................... 95 Figure 5.9 Prediction With Bayesian Update ............................................................................... 95 Figure 5.10 Performance of GPM Model with 20% of available data ......................................... 98 Figure 5.11 Performance of GPM Model with 30% of available data ......................................... 99 Figure 5.12 Performance of GPM Model with 50% of available data ....................................... 100

xi

Abbreviations
AI ANN AOCS ARMA ARW BU C&DH CBM CMG CNN DPHM ECEF ECI GA GD-BP GM GPM HMM HMS ICA ISS LVLH MEMS MW NSAB PCA PHM PI PLS Artificial Intelligence Artificial Neural Network Attitude and Orbit Determination and Control Subsystem Auto-regressive moving average Angle Random Walk Bayesian Updating Command and Data Handling Subsystem Condition-Based Maintenance Control Moment Gyroscope Chebyshev Neural Network Diagnosis and Prognosis Health Management Earth Centered Earth Fixed Frame Earth Centered Inertial Frame Genetic Algorithm Gradient Descent Back Propagation Algorithm Gimbal Motor of a CMG General Path Model Hidden Markov Models Health Monitoring Systems Independent component analysis International Space Station Local Vertical Local Horizontal Frame Microelectromechanical systems Momentum Wheel Nonstatistical-Analysis-Based Principal Component Analysis Prognostics and Health Management Prediction Interval Partial least squares xii

QTA RNN RW SAB SBF SM SPC SVM WAFT

Quality Trend Analysis Recurrent Neural Network Reaction Wheel Statistical-Analysis-Based Satellite Body Frame Spin Motor of a CMG Statistical Pattern Classifiers Support Vector Machines Weight Application to Exponential Parameters

Nomenclature
           
 

Earth Centered Inertial Frame Earth Centered Earth Fixed Frame Local Vertical Local Horizontal Frame Satellite Body Frame Total angular momentum of satellite Angular velocity of the satellite External torque disturbances Total Inertia of the satellite Total angular moentum of actuators CMG mapping matrix Identity matrix Quaternion representation of satellite attitude,  = 1,2,3,4 Orientation transformation matrix from body frame to orbital frame Orbital velocity of satellite Earth's gravitational constant Distance of satellite from centre of earth Disturbance torque due to the gravity Atmospheric drag torque xiii

    

         l        ,  ,              

Solar radiation torque Unknown disturbance torque Inertia of Flywheels,  = 1,2,3,4 Rotational velocity of spin motors,  = 1,2,3,4 Angular momentum of Flywheels,  = 1,2,3,4 Angular momentum of CMG due to gimballing,  = 1,2,3,4 Total angular momentum of CMG system Gimbal angle of CMG,  = 1,2,3,4 Pyramid inclination angle for CMG Viscous friction of gimbal motor Coulomb friction of gimbal motor Winding resistance of gimbal motor Winding inductance of gimbal motor No. of rotor pole pairs of gimbal motor Maximum Flux Linkage of gimbal motor Phase emf of gimbal motor,  = ,  Phase current of gimbal motor,  = ,  Angular velocity of gimbal motor Torque produced by the gimbal motor Coulomb friction of spin motor Viscous friction of spin motor Drive Gain time constant of spin motor Ripple Torque of spin motor Temperature of spin motor Cogging Torque of spin motor Torque Noise Frequency of spin motor Jitter Angle of spin motor BEMF Nominal of spin motor

xiv

           


Motor Torque Constant of spin motor Bus Voltage Nominal of spin motor Bridge Resistance of spin motor Driver Gain of spin motor Number of Motor Poles of spin motor Input Filter Resistance of spin motor Quiescent Bus Power of spin motor Driver Bandwidth of spin motor Voltage Feedback Gain of spin motor Over-speed Circuit Gain of spin motor Maximum Wheel Speed of spin motor Motor disturbance term of spin motor Motor disturbance term of spin motor Electromotive torque limiting term of spin motor Coulomb friction approximation term of spin motor Speed limiter term of spin motor Bus current of spin motor Bus voltage of spin motor Angular velocity of spin motor Command voltage for spin motor Feature matrix of CMG system at timestamp  , ,  = 1,2,3,4 Chebyshev polynomials,  = 0   Data Normalization factor for CNN training Weights of CNN network,  = 0   Learning rate of CNN Momentum rate of CNN Effect of gimbal motor operational region on 1 , at timestamp  Data driven model performance prediction of each CMGs at timestamp   = 1,2,3,4 xv

   1 2 3 4 5      ,      ,   ,

           ,   1,   2     _ _      y     y

Data driven model performance prediction of all CMGs at timestamp  Data driven model performance prediction of each GM at timestamp  in a matrix form Data driven model performance prediction of each SM at timestamp  in a matrix form Data driven model performance prediction of each GM at timestamp  ,  = 1,2,3,4 Data driven model performance prediction of each SM at timestamp  ,  = 1,2,3,4 Optimized fault factor matrix for GM Optimized fault factor matrix for SM Scaling factor to convert the unit vector to actual magnitude for SM Window size Mean error for adaptive threshold calulation at timestamp  Mean standard deviation for adaptive threshold calulation at timestamp  Adaptive threshold at timestamp  Motor Torque Constant degradation model for SM Bus Volatege degradation model for SM Apriori parameters of GPM,  = 1,2,3 Data output matrix for prognosis history data set training Estimated parameter matrix for prognosis history data set training Data input matrix for prognosis history data set training Variance-covariance noise matrix for prognosis history data set training Data output matrix for prognosis history data training with BU Estimated parameter matrix for prognosis history data set training with BU Data input matrix for prognosis history data set training with BU Variance-covariance noise matrix for prognosis history data training with BU

xvi

CHAPTER 1

1.

Introduction
Due to the recent advancements in computer hardware such as microprocessors, applications of computationally intensive Artificial Intelligence (AI) algorithms in complex engineering systems have been increasing. Most of the Engineering systems are rapidly shifting from manually controlled to autonomous systems. As humans are no more operating the system and monitoring its sensors data, looking for anomalies, there has to be a framework in place to ensure nominal operation. Another reason for health monitoring is to avoid expenses due to unexpected downtimes and irreversible failures, which inspired researchers to develop Health Monitoring Systems (HMS) such as Condition-based Maintenance (CBM) and Prognostics and Health Management (PHM) Systems (Vachtsevanos 2006). The goal of this framework is to predict system's faults and failures as early as possible so that necessary actions can be taken as a preventive measure. In a system like spacecraft, which operates in outer space it is difficult to carry out maintenance activities. Hence, the fault has to be identified, isolated and the control system has to be reconfigured appropriately to prevent the spacecraft from going to an uncontrollable state. Figure 1.1 shows the different subsystems in a spacecraft that are prone to faults and failures. In this thesis, the Fault Detection & Isolation FDI and Prognosis for Attitude and Orbit Determination and Control System (AOCS) for a satellite is studied.

Satellite Subsystems

Structure

Thermal

AOCS

C&DH

Power

Communication

Payload

Attitude and Orbit Command & Determination and Data Handling Control

Figure 1.1 Subsystems in a Satellite

1

Chapter 1 Introduction

1.1 Motivation
The goal of this thesis is to develop a Diagnosis and Prognostics Health Management (DPHM) algorithm which includes Fault Detection & Isolation (FDI) and Prognosis for Actuators used in AOCS. Also, the main focus is on small satellites. The reason for choosing AOCS and small satellites is given as follows. 1.1.1 Why Small Satellites? In general, a satellite that is less than 180 kg are termed as small satellites (NASA 2015). Satellites can be classified into seven categories based on its mass as shown in Table 1.1 (Konecny 2004). In the Nano satellite category, CubeSats are quite popular for cost effective science investigations, constellation missions, Student Satellites, etc. CubeSat come in different configurations such as 1U, 1.5U, 2U, 3U, 6U and 12U. 1U CubeSat measures 10×10×10 cm.

Table 1.1 Classification of Satellites based on Mass

Satellite Class Large satellites Medium satellites Mini satellites Micro satellites Nano satellites Pico satellites Femto satellites

Mass >1000 Kg 500 to 1000 Kg 100 to 500 Kg 10 to 100 kg 1 to 10 Kg 0.1 to 1 Kg < 100 g

Table 1.2 Launch Costs of Spaceflight
Class Mass (kg) Price LEO X 103 Nanosatellite 5 $295 10 $545 20 $995 Microsatellite 50 $1,750 100 $3,950 150 $4,950 Mini Satellite 200 $5,950 300 $7,950 450 $17,500 Microsatellite 750 $22,000 1000 $28,000

Due to latest developments in electronics and MEMS (Microelectromechanical systems) it is possible to manufacture a small satellite that meets complex mission requirements. The launch costs of a satellite is directly proportional to its mass. Table 1.2 shows the cost of launch for a 2

1.1 Motivation

satellite (Spaceflight 2017). It is evident from this cost table that launch costs increases as the mass of the spacecraft increases. One of the major reasons for the boom in small satellites industry is its lower development and launch costs. Also, for the cost of manufacturing and launching heavier satellites, multiple small satellites can be launched that can achieve the almost the same mission requirements as large ones. Also multiple small satellites launched in formation can obtain survey multiple regions at a time. But a single large satellite can survey only one region at a time. Also small satellites are used for experimentation purposes to demonstrate new technologies at a lower cost and also used for student projects. It is estimated by Allied Market Research that the Small Satellite Market is expected to reach around $7 Billion by the year 2022 (AlliedMarketResearch 2017). Also a report from SpaceWorks projects that 2400 small satellites in the mass category of 1-50 kg will be launched from 2017 to 2023. The history and projection of launch from 2010-2023 is given in (Doncaste 2017). 600 500 Historical Launches SpaceWorks Forecast Full Market Potential

Number of Satellites

400 300 200 100 0 2010 2011 2012 2013 2014 2015 2016 2017 2018 2019 2020 2021 2022 Calendar Year
Figure 1.2 History and Projection of Small Satellite Launches from 1-50kg (Doncaste 2017)

Small satellites always has a constraint in terms of in terms of space, mass, power and computing budget. Hence sensors may not be installed for measuring the health of the individual components. This makes the development of DPHM for small satellites more challenging. The main requirements for a DPHM framework in small satellites are it shall work with minimal measurement information and computational power. 3

Chapter 1 Introduction 1.1.2 Why AOCS? AOCS subsystem in a satellite is responsible for determining and controlling the orientation/attitude. When the satellite is released from the launch vehicle, the disturbance torques from the launcher interface will be imparted on the satellite. This torque affects the initial attitude angular velocity of the satellite, which is also known as tumbling. AOCS de-tumbles the spacecraft using algorithms such as b-dot (Aerospaziali 2015) and stabilizes the satellite. After the satellite is stabilized, it has to constantly reorient it selves based on mission requirements or to overcome any attitude changes due to the disturbance torques. The relationship between AOCS and other subsystems in a satellite are highlighted below 1. Payload - Remote Sensing: Remote sensing satellites that survey the surface of the earth uses payloads such as camera, spectrometer, etc. These payloads absorb the reflected light from the earth for data acquisition. These sensors must constantly be aligned to focus on the surface of the earth during data acquisition mode. AOCS system aligns the spacecraft so that payloads can focus on the surface of the earth. 2. Payload - Telescopes & Observatory: The performance of astrophysical observatories in earth are affected by atmospheric dust. Hence spacecraft based observatories like Hubble space telescope helps in observing the deep space by eliminating the noise due to atmospheric dust. These telescopes has to be oriented appropriately based on the target location. Each time when a new target body is selected, spacecraft has to be re-oriented by AOCS to focus the telescope to that particular target object. 3. Communication Subsystem: In general, there will be three antennas in spacecraft. The Uplink antenna, Downlink Antenna and Beacon Antenna. The uplink and downlink antenna is responsible for communication from ground to spacecraft and vice versa. Sometimes high gain antennas are used for downlink which sends signals only in particular directions. These type of antennas must be pointed towards earth for proper communication link. AOCS helps in orienting the communication system of the spacecraft. 4. Power Subsystem: Almost all the satellites use solar panel for power generation in sunlit phase of the orbit and battery as energy storage to be used later in the dark phase of the orbit. The power subsystem is the key for electricity supply for all the electronics in a satellite. To generate maximum power, solar panels has to be perpendicular to the sunrays. Hence the orientation of the spacecraft helps the designers in sizing and placement of solar 4

1.1 Motivation

panels. While on-orbit, AOCS can orient the spacecraft to get maximum power generation. 5. Thermal Subsystem: The electronic components inside the spacecraft typically has an operating range of -20o C to 60o C. But the typical temperature in sunlit phase would be around 200 o C and around -150 o C in dark phase. Based on the planned AOCS operations, thermal management systems in satellite would be designed to manage the internal temperatures as desired. Intelligent thermal management systems requires the orientation information of the spacecraft to operate nominally.

Other, 14% AOCS, 32%

TTC, 12% C&DH, 15%

Power, 27%

Figure 1.3 Subsystem wise Failure of Spacecraft from years 1980-2005 (Tafazoli 2009)

8-25 years 12%

0-1 year 22%

5-8 years 22% 3-5 years 24%

1-3 years 20%

Figure 1.4 AOCS Time to failure after launch from years 1980-2005 (Tafazoli 2009)

Due to the dependencies of almost all the other subsystems with the AOCS subsystem, any 5

Chapter 1 Introduction faults or failure in AOCS, if not recovered promptly may result in a complete mission failure. From the years 1980 ­ 2005, AOCS contributed for up to 32% of the total failures in the spacecraft (Tafazoli 2009). Figure 1.3 shows the percentages of subsystem wise failure from the year 19802005. Also from Figure 1.4, it is evident that AOCS system failed more than 40% of the time within 3 years of on-orbit operation. AOCS system in a spacecraft consists of several sensors and actuators. Sensors are used for measuring the attitude of the spacecraft. Some of the absolute measurement sensors include Sun Sensor, Magnetometer, Star sensor, horizon sensor, etc. These sensors provide the absolute attitude measurement of the spacecraft with respect to Sun, earth's magnetic field, stars, earth horizon respectively. On the other hand, relative attitude sensors provide the measurement relative to the previous state. Gyroscope is one of the widely used relative measurement sensors that measures the satellites attitude angular velocity which can be processed to provide with the attitude angular position. For the absolute measurement sensors to work, orbital position of the spacecraft is essential which can be measured using GPS sensor. Usually two or more sensors work in combination to determine attitude of satellite. Actuators in AOCS system provides the torques required for de-tumbling and reorienting the spacecraft. Micro thrusters are used as attitude control actuators in large satellites which works on the same principle as a rocket engine. In small satellites, actuators like Reaction Wheels (RW), Control Moment Gyros (CMG) and Magnetorquers are quite common. Reaction wheels are flywheels connected to a motor which creates reaction torques by accelerating or decelerating the flywheel. The counter torque is created in a direction opposite to the direction of acceleration. Control Moment gyros has a momentum wheel which rotates a flywheel at a constant speed, and a gimbal motor which gimbals the momentum wheel in the required direction to create control torques. Magnetorquer creates a magnetic field that interacts with earth's magnetic field which creates required control torques. Magnetorquer can only be used in Low Earth Orbit (LEO) satellites as the magnetic field of earth becomes weaker above altitudes of around 1000 km. Depending on the attitude accuracy and other mission requirements, the actuators are selected. Sometimes one or more actuators are used in conjunction. Control Moment gyros provide a highly accurate attitude accuracy with low power consumption. Also the constantly rotating momentum wheels resists the spacecraft from attitude drifts due to gyroscopic stabilization effect. Reaction wheels and momentum wheels also provide a better accuracy for attitude control. 6

1.2 History of Faults and Failures of Spacecraft AOCS Actuators

Magnetorquers provides very low accuracy and also they are unable to produce three axis control. Also the magnetic fields of earth constantly changes for a satellite in orbit and hence the control system has to dynamically find the control inputs required for actuating the The failures in AOCS system can be due to any of the sensors, actuators or the electronic modules. The list of component wise failure for ADCS is given in Figure 1.5 (Tafazoli 2009). Almost 30% of all failures is caused by actuators out of which two-thirds are caused to Control Moment Gyros, Reaction Wheels and Momentum Wheels.

Failure Percentage

20%

15%
10% 5% 0%

Component
Figure 1.5 Component wise Failure for AOCS for the year 1980-2005 (Tafazoli 2009)

1.2 History of Faults and Failures of Spacecraft AOCS Actuators
The actuators such as CMG, RW and MW are rotating electro-mechanical components which are prone to faults and failures while in constant operation. Some of the examples of previous failures related to these actuators are listed as follows. International space station (ISS) used four 4.7 KNm double gimballed CMGs with 360 degrees gimbal rotation for both the axes. This provided ISS with attitude control capabilities without the use of a thruster system. Their life expectancy was approximately 10 years. These CMGs consisted of a flywheel spinning at 6600 rpm which can produce an output of 258 Nm of torque. One of the CMG's failed after 1.3 years of operation and the next one developed fault after 6 years of operation (Gurrisi 2010). Since this was a human mission, there were for CMG's used 7

Chapter 1 Introduction for redundancy and also thrusters were available as a backup for attitude control. There have been repair activities carried out previously in ISS for CMGs (Malik 2005). It has to be noted that the current, temperature and vibrations were measured from for the CMG. NASA's Kepler space telescope used four RWs as attitude control actuators. It was launched on 2009. After 3 years of operation, during July 2012 one of the reaction wheels failed (Johnson 2017). As three wheels were sufficient for a complete three axis attitude control, one failure did not compromise the mission. Later in May 2012, second wheel failed leaving the spacecraft with only two working reaction wheels (Johnson 2017). This led to under actuation in attitude control. NASA engineers tried to recover at least one of the failed reaction wheels to get the spacecraft back on control but were unsuccessful. The primary objective of any telescope is to observe different celestial bodies by reorienting the spacecraft towards the target object. Since reorientation was not possible without attitude control, Kepler mission was compromised. Other notable reaction wheel failure would be from the Dawn mission of NASA where two of the reaction wheels stopped functioning on April 23, 2017 (NASA 2017). In Hubble space telescope, already two service missions have been carried out to fix the RWs. Also, Hayabusa spacecraft from Japan Aerospace Exploration Agency had two RW failures.

1.3 DPHM for Satellite AOCS actuators
AOCS module in satellite constantly calculates the current attitude position based on the sensor measurements. If there is any difference between the required attitude and the current attitude, the control system calculates the torque requirements to bring back the satellite to the required state. The calculated torque is converted into control inputs such as voltage or current for the actuators to deliver the torque. The placement of a DPHM module in an AOCS of a satellite is shown in Figure 1.6. After the onset of fault in attitude actuators, the performance will be affected. This creates a difference between the expected and actual performance which will then be declared as fault by the FDI algorithm. After fault is detected, the algorithm must also locate the source of fault. Finally the DPHM should estimate the remaining useful life of the faulty component called as prognosis. DPHM algorithm that detects, isolates and finds the remaining useful life of a faulty component is essential for the AOCS system for preventive maintenance activities. The information DPHM algorithm will then be used for developing a reconfigured control scheme to continue maintaining the full attitude control of satellite. 8

1.4 Faults in a CMG

Attitude Requirements

Calculate Control Torque Requirements Reconfigure Control Schemes

Control Inputs Calculations

Actuation (Actuators)

Expected Measurements

FDI and Prognosis (DPHM Module)

Actual Measurement (Sensors)

Figure 1.6 DPHM Module in AOCS Subsystem of Satellite

1.4 Faults in a CMG
Each CMG has a Gimbal Motor (GM), Spin Motor (SM) and a Flywheel. Any faults in CMG are either associated with a gimbal motor or a spin motor. The faults that are associated with gimbal motor and spin motor are discussed below. 1.4.1 Faults in a Gimbal Motor Stepper motor is a brushless DC electric motor that rotates by dividing one full rotation into several steps. Each command voltage input to a stepper motor completes one step. Unlike servomotors, the main advantage of stepper motor is that it reaches the expected angular position precisely without the need for a closed loop control. For the CMG system in the thesis, stepper motor is used as the gimballing actuator due to its precision without the need for feedback (Abreu 2010; Choi et al. 2015). Companies such as Micromo manufactures space grade permanent magnet stepper motors in small sizes which can be installed in small satellite applications (Abreu 2010). 9

Chapter 1 Introduction Some of the main faults that occur in the stepper motor are stalling and speed reversals (Bodson et al. 2006). In an experimental study done by (Bodson et al. 2006), permanent magnet stepper motors was analyzed for stall faults and speed reversals. Both the problems occur due to resonance condition in stepper motors. Stalling may also occur due to high torque loads and constant change in the direction of rotation. In stalling, the motor comes to a complete stop even though commanded to rotate. In speed reversal motion, the motor will constantly try to rotate back and forth around a single position and appear as if the motor is stalling (Bodson et al. 2006). In this thesis, stalling of the stepper motor is considered and called as stall fault of gimbal motor. This is due to the fact that the gimbal motor in satellite may constantly rotate back and forth for attitude control. 1.4.2 Faults in a Spin Motor Brushless DC motor is one of the common motors used for reaction wheels and momentum wheels in a spacecraft. The faults in these type of motor can be classified as (1) additive fault (2) multiplicative fault based on how the faults are modelled in the system. In a reaction wheel or a momentum wheel control system, additive faults are typically observed (Godard 2010). Changes in friction between stator and rotor due to aging and temperature could lead to discrepancies between expected and actual performance. Also, malfunctioning may lead to continuous generation of unexpected torques which can be modeled as an abrupt change and classified as multiplicative faults.

Figure 1.7 Types of Faults (Godard 2010)

10

1.5 Literature Review

Based on the form of fault, i.e. the fault behaviour with respect to time, Faults can be classified as (1) Abrupt, (2) Transient (3) Intermittent and (4) Incipient. Abrupt faults occur instantaneously due to hardware damage. These faults prevails until the faulty unit is repaired or replaced. Transient faults represents any temporary malfunctions which will recover by it selves after a certain time. Repeated occurrences of transient faults is termed as intermittent faults. Both transient faults and intermittent faults may or may not affect the AOCS performance based on the time of onset and severity. Incipient faults represent degradation of the motor due to wear and tear which increases with respect to aging. Incipient faults are crucial in AOCS subsystem, where the fault gets worse over time and lead to complete failure. All types of faults can be represented as shown in Figure 1.7.

1.5 Literature Review
The literature review is divided into two sections, (1) Fault Diagnosis and (2) Fault Prognosis. A general review is done for each section followed by CMG specific literature review for each section. 1.5.1 Fault Diagnosis Fault diagnosis system performs two main tasks namely, Fault Detection and Isolation (FDI). The fault detection algorithm finds faults at a plant/system level and isolation scheme locates the fault at a component level. Fault diagnosis methods can be divided into three approaches namely Model-Based, Signal Based and Knowledge Based (Gao et al. 2013). Major fault diagnosis methods based on review paper from (Gao, C Cecati, et al. 2015) are shown in Figure 1.8. Model-based approaches requires the model of the plant to be available. In this approach, the relation between the measured and estimated outcomes are mathematically formulated and are used to detect and isolate faults. A review of model based approaches are available in (Marzat et al. 2012; Gao, C Cecati, et al. 2015). The model based approaches can be subdivided into two types, Stochastic and Deterministic methods. Stochastic methods make use of filter based approaches such as Kalman filters. Some of the Kalman filter based fault detection schemes used in various applications can be found in (Pourbabaee et al. 2016; Sidhu et al. 2015; Nadarajan et al. 2016) and also unscented Kalman filter based fault detection schemes are available in (Sunil Nag P.V., Gowtham kumar Silla, Venkata Harsha Vardhan Gummadi, Harishankar C B & Kumar Ray 11

Chapter 1 Introduction 2016; Rahimi et al. 2015; Xiong et al. 2007). Deterministic methods make use of observer based approach or parity relations approach. An extensive literature review of deterministic methods is available in (Gao, C Cecati, et al. 2015).

Fault Diagnosis Methods

Model-Based Detereministic Stochastic

Signal-Based Time Domain Time frequency

Knowledge Based (Data-Driven) Quantitative Expert System QTA

Hybrid Methods

Qualitative SAB NSAB

Frequncy Domain

Figure 1.8 Major Fault Diagnosis Methods

Signal-based approaches does not require explicitly require a model of the system but works based on processing the measurement signals. As the faults occurred in the plant would be reflected in the measurement signals, they can be processed to perform the fault detection. The processing of signals includes feature extraction as a time-domain signal or frequency-domain signal or both (Gao, C Cecati, et al. 2015). Vibration measurements use frequency-domain signals and are applicable to rotating components such as gear trains (Feng & Zuo 2013) and bearings. Acoustic based frequency-domain fault diagnosis method also come under vibration signal measurement and the scheme is given in (Pan et al. n.d.). Time-domain signal-based fault diagnosis approaches are applied for electric motors (Bouzid & Champenois 2013; Shahriar et al. 2013). The time-frequency signal-based approaches discussed in (Feng et al. 2013). CMG system is also a rotating component which consists of electric motors which makes it a good candidate for Signalbased methods if signals from each CMG is measured individually. But the main focus on this thesis is to come up with an algorithm that can work without any component level measurements. Both the Model-based and signal based approaches require apriori knowledge of the system model or the signal patterns for different faults. But data-driven approaches require large historical dataset of the system to be available. Using the data, system model can be developed for residual 12

1.5 Literature Review

based fault diagnosis or feature extraction, classification models, etc. can be developed to detect and isolate fault. One of the main advantages for the data driven approach is that it can be applicable to complex systems where the plant model is unavailable. Data Driven fault diagnosis can be categorized as Qualitative Knowledge-based and Quantitative Knowledge-based as mentioned in the review paper from (Gao, Carlo Cecati, et al. 2015). Qualitative Knowledge-based methods work based on the specific set of rules developed using the history of data from the system or using experience information documented by human experts. An object oriented expert system based framework for fault diagnosis is given in (Kodavade 2012). Since the faults over time may leave a specific trends in the measured data, it can also be analysed for any fault trends. This method is called as Qualitative Trend Analysis (QTA). Some of the applications of fault diagnosis based on QTA may be found in (Maurya et al. 2007; Gao et al. 2010). Review of other applications of Qualitative-Knowledge based methods are provided in (Venkatasubramanian et al. 2003a; Gao, Carlo Cecati, et al. 2015). Quantitative-Knowledge based can be sub divided into Statistical-Analysis-Based (SAB), Nonstatistical-Analysis-Based (NSAB) and fusion of both SAB with NSAB. (1) For SAB approach, popular methods include Principal Component Analysis (PCA), Partial least squares (PLS), Independent component analysis (ICA), Statistical Pattern Classifiers (SPC) and Support Vector Machines (SVM). Recent applications of these methods can be can be found in: ICA (Guo et al. 2014) ,PCA (Zhang et al. 2013), PLS (Zhao et al. 2014) and SVM (Namdari et al. 2014). These approaches are mainly used where there is a need for data dimensionality reduction or extracting features from data. (2) Nonstatistical approach involves using nonlinear approximation models for learning the behaviour of an Input-Output system. These trained models will then be used as a reference system and checked against the performance of the actual system to find faults. Artificial Neural networks (ANN) are one of the widely used tools non-linear approximations and can be found in (Elnokity et al. 2012; Shatnawi & Al-khassaweneh 2014). (3) SAB and NSAB approaches are fused together and used in some literature. SAB helps in extracting distinct features or dimensionality reduction of data and NSAB approaches learn the non-linear input-output system. Extensive literature review for such methods is available in (Gao, Carlo Cecati, et al. 2015) Hybrid approaches involve the combination of two or more approaches from any of the 13

Chapter 1 Introduction model-based, signal-based or knowledge-based approaches. Since each approach has its own limitations, combining them together can help in overcoming some of the disadvantages of each methods when used individually. An extensive review of hybrid approaches for fault diagnosis is given in (Venkatasubramanian et al. 2003b). Fault Diagnosis of CMGs in Satellites: In the thesis, the main focus is on data-driven FDI scheme. Even though reaction wheel and momentum wheel operate differently, the components used in both the system are same and hence reaction wheels are also considered for this literature survey. A dynamic neural network based approach is used for RW fault detection in (Al-zyoud & Khorasani 2006). This method trains the ANN model with the RW torque data as outputs for voltage command inputs. They use 20,000 data samples for model training. This model is compared with system measurements to generate residues which are then evaluated for reaction wheel faults based on a thresholds. Since torque measurements from individual reaction wheels may not be available in small satellites and training 20,000 samples of data requires high computational budget, this method may not be desirable for small satellites. Another work by (Joshi et al. 2007) used RADARSAT Telemetry data from Attitude Control System to train ANN as an input-output system to detect actuator faults. But the details of the data regarding what type of sensor information is used is not provided. A hierarchical fuzzy rule-based fault diagnosis for formation flying is provided in (Barua & Khorasani 2011). In this work, faults due to RWs are considered but not as a CMG system. In the work done by (Cheng et al. 2016), a hybrid approach that uses both model based methods and ANN is used for fault detection. This work is limited by its use of a simple actuator dynamics model. Another dynamic neural network based work is available in (Tafazoli 2005) where highfidelity model of reaction wheel is used. A diagnostic tree approach is provided in (Barua & Khorasani 2007) for reaction wheel fault diagnosis. But the proposed approach requires several attributes of the reaction wheel such as Motor Torque, Motor Current, wheel speed, etc. which means this algorithm is limited by its need for component level sensor measurements. A dynamic neural network based approach is given for fault diagnosis of reaction wheels in satellites in (Mousavi & Khorasani 2014). It uses 50,000 training samples for neural network training and it is not clear if orthogonal configuration or pyramid configuration is used. A Kernel Fuzzy C-Means approach for fault diagnosis for satellite reaction wheels is given in (Hu et al. 2012) but did not consider the dynamics of the RW motor. 14

1.5 Literature Review To the author's best of knowledge, there are only two available literature for fault diagnosis for a CMG system. In the first work by (Abreu 2010), the motors dynamics in CMG is not considered for fault detection algorithm. In this work CMG is also considered as a single motor component. But a single gimballed CMG system consist of two motors, one gimbal motor and one spin motor. In the second work by (Choi et al. 2015) published recently, a fuzzy Q-learning algorithm for fault detection is provided. Here the dynamics of both Gimbal Motor as well as spin motor for all four CMGs are considered with high-fidelity MW models. But this work is limited by the fact that, the fuzzy algorithm needs the measurements of Angular Velocity and Current of both gimbal and spin motor and also requires the torque measurement of spin motor. 1.5.2 Fault Prognosis Fault prognosis is estimating the degradation of the system so as to find the remaining useful life. In a DPHM framework, fault prognosis come after fault diagnosis. Based on the literature review, prognostics methods can be classified as Physical-model based, Knowledge based and Data-Driven based (Peng et al. 2010). Major fault prognosis methods are shown in Figure 1.9. An extensive review of fault prognosis methods is available in (Kothamasu et al. 2009) and machinery based prognosis is available in (Jardine et al. 2006; Peng et al. 2010).

Fault Prognosis Methods

Physical Model Based

Knowledge Based Fuzzy Logic Expert System

Data-Driven Based
Reliability Based

Hybrid Methods Artificial Intelligence methods
ANN SVM

Statistical Based HMM

ARMA Weibull Weibul Model Distribution RNN

Figure 1.9 Major Fault Prognosis Methods

Physical Model based methods are approaches that requires the mathematical model of the degradation of the system. Crack propagation models are one such example. These type of models 15

Chapter 1 Introduction are applied on residuals which is a measure of degradation of the system. A physics based prognostics approach for bearings is given by (QIU et al. 2002) and for aircraft actuators is given by (Byington & Stoelting 2004). Some of the other physics based prognostics approach can be found in (Oppenheimer & Loparo 2002; Jianhui Luo et al. 2003). Knowledge based methods are based on the human expertise in the domain which are documented as "If-then" rules which will then be converted into a computer algorithm as if experts would predict the prognosis. These type of algorithms are termed as expert systems and some of the works using expert based system for fault prognosis can be found in (Garga et al. 2001; Biagetti & Sciubba 2004). Fuzzy logic is another algorithm that falls under the category of a knowledge based method where it provides a way to arrive at the fault prognosis by processing various noisy attributes and operate it based on a Boolean logic. Prognosis algorithms developed based on Fuzzy logic is reviewed in (Majidian & Saidi 2007). Both the knowledge based method and physics based method require apriori knowledge of the system. Data-Driven methods are purely based on the history of run to failure data obtained from the system. A survey of data driven prognosis is provided in literature by NASA Ames Research Center (Schwabacher 2005). Data-driven model can be categorized into statistical methods, reliability methods and artificial intelligence methods (Liao & Köttig 2014). Statistical methods make use of Hidden Markov Models (HMM) (Peng & Dong 2011), Auto-regressive moving average (ARMA) Models (Liu et al. 2012; Yan et al. 2004), etc. Reliability methods make use of Weibull models or Weibull distribution models for prognosis estimation (Guo et al. 2009; H. Sutherland, T. Repoff, M. House 2003). In artificial intelligence based approaches, the history of data is trained using algorithms like Recurrent Neural Network (RNN), Support Vector Machines (SVM), etc. and later used to predict the remaining useful life of the system. An extensive review on artificial intelligence based prognosis is given in (Peng et al. 2010; Liao & Köttig 2014). A review paper examining the pros and cons of selecting between data-driven method and a physical-model based method is given by (An et al. 2015). There are also hybrid methods as reviewed in (Liao & Köttig 2014) where two or more of different methods are used in combination to predict the remaining useful life of the system. Fault Prognosis of CMGs in Satellites: Regarding the fault prognosis of CMGs, to the best of author's knowledge there has been 16

1.5 Literature Review

no work done for gimbal motors. Since CMG system has a spin motor any failure prognosis work provided related to momentum wheel, reaction wheel or electric motors are reviewed here. An experimentally verified study for momentum wheel prognosis for satellites in given in (Jin et al. 2012). In this work, an extensive experimentation has been done for several months to analyze the failure rate of bearings used in momentum wheels. Different on-orbit conditions such as vacuum, high temperature and microgravity effects on the remaining useful life of the bearing system were studied. This work mainly focussed on studying the degradation of lubricant's physical and chemical properties used in bearings as well as the degradation of contact surfaces due to abnormal friction. Using the same measurement parameters a Wiener degradation model based life estimation algorithm is provided in (Li et al. 2015). But in terms of small satellites, measuring the parameters of the lubricant and surface properties is impractical. A prognostic work for momentum wheels using similitude method is given in (Wang et al. 2016). In this work neural networks are used to develop a data-driven model using the telemetry data that has the rotational speed and temperature measurements of the bearings. Later, a Weight Application to Exponential Parameters (WAFT) method is used to forecast the RUL of the momentum wheel. It is clearly seen from the plots provided in this paper that the wheel rotational speed decreases as the momentum wheel degrades. For small satellites, measuring the individual bearing rotational speeds of all the motors/bearings requires speed sensors for each wheel. Two of the works published by same group of authors (Q. Liu, J. Zhou 2009; Q. Liu, G. Jin 2007) dealt with the momentum wheel RUL prediction using Bayesian Reliability techniques but the paper is unavailable online and hence no comments can be made about this work. A data plot of the thermal subsystem anomalies in thermal system of ISS is given in (Iverson et al. 2012). This is due to the degradation of spin motor in CMG used in ISS causing temperature and vibrational anomalies. This report discusses the need for developing a data-driven algorithms for a spacecraft. A fault prognosis approach for attitude control system is given in (Hua et al. 2013) but this work did not used the dynamics of actuators. An electric motor prognosis scheme given by (Rocchi et al. 2014) uses accelerometer signals for measuring the degradation. Recent works on bearing fault prognosis given by (Zhang et al. 2011; Kim et al. 2012) also uses the accelerometer measurements.

17

Chapter 1 Introduction

1.6 Attributes of Data
Since the thesis deals with the data driven approach, it would be noteworthy to mention some of the attributes related to big data. The first one is called Gartner's Interpretation ­ 3Vs which were given around the year 2004. Later, IBM added one more attribute to the original 3Vs and Microsoft added three more attributes to the original 3Vs for maximizing the value of its business. The attributes are given as follows (Kaufmann 2016). (1) Gartner's 3Vs: Volume, Velocity, Variety (2) IBM's 4Vs: Volume, Velocity, Variety, Veracity (3) Microsoft's 6Vs: Volume, Velocity, Variety, Veracity, Variability, Visibility The definitions for these attributes as given in (Kaufmann 2016; Gupta 2014) are as follows: · Volume represents the amount of historical data that is available. The amount of data available increases every year due to Internet of Things (IOT). Currently there are around 10.5 ZB (Zettabytes) of data and is expected to reach around 35 ZB by the year 2020. · · Velocity represents the speed with which the data is accessible. In other words it can be defined as the frequency of the incoming data that has to be processed Variety of data can be of two types: structured and unstructured. Structured data are well defined with the rules. Numbers, text, image are some examples of structured data. Unstructured data on the other hand has no rules and can be a mixture of variety of data types. · · Veracity of the data represents the accuracy of the data. Sometimes the available data may contain noise and false information which makes it unreliable. Variability refers to the change in meaning of the data. The same data may mean something entirely different that it was in the past. This is mostly the case for speech and text data. · Visibility of data represents the insights that the data can offer. This provides the foresight to the problem at hand. The volume attribute of data is critical in data-driven model development. More the volume of historical data, more information can be extracted from the data. This also adds complexity in model training that it requires more computational effort to train a huge volume of data. For quicker training of the data-driven model, the volume of data that has to be reduced without any loss of information. 18

1.7 Problem Statement

1.7 Problem Statement
Based on the literature survey, the shortcomings of the existing work in the literature has been addressed as the problem statements below. [PROBLEM 1] ­ For developing an Input-Output based data-driven model for attitude actuators in satellites, dataset with more than 20000 data points are used for training ANN (Al-zyoud & Khorasani 2006; Mousavi & Khorasani 2014). But more computational power is required for training such a huge volume of dataset onboard satellite or the training has to be done in the ground station. Also for a newly launched satellite, such huge volume of historical data may not be available. [PROBLEM 2] ­ For the fault detection, the algorithms proposed in the literature are limited by (1) use of simple system dynamics that did not consider the motor dynamics of the actuators (Cheng et al. 2016; Abreu 2010) (2) use of component level measurements such as current, torque etc. (Barua & Khorasani 2007; Choi et al. 2015). In small satellites, installing additional sensors for component level measurements may not be possible due to space and mass constraints. [PROBLEM 3] ­ To the best of author's knowledge there is not much literature available on fault isolation of a CMG actuator system for satellites. One of the works available (Choi et al. 2015), is a model based approach and requires several component level measurement information from the motors used in the CMG. [PROBLEM 4] ­ Based on the literature review, the existing fault prognosis methods used for momentum wheel prognosis uses component level measurements or lubricant and surface property measurements (Jin et al. 2012). The measurements used are vibration signals, temperature, lubricant property etc. Installing one or more of these sensors for each of the motors used in a small satellite is not practical due to space and mass constraints. Also other studies available on bearings and rotating electric components fault prognosis needs vibration measurement from individual rotating shafts.

1.8 Research Objectives
To address the problems formulated above, the following are the objectives that are set for the thesis. [OBJECTIVE 1] - To address the Problem 1, the need for large volume of historical dataset 19

Chapter 1 Introduction has to be reduced. A framework has to be developed that reduces the volume of historical data for developing a data driven model. This can be done using one of the following two ways. (1) To find a property associated with the data that can reduce the volume of dataset required, (2) To find the mapping function that converts the input-output data from one CMG to other CMGs. This ensures that the data from one CMG is sufficient for developing a model for the entire CMG system. Also in terms of data-driven model training, a computationally light data-driven model has to be used so that training may be done onboard spacecraft. [OBJECTIVE 2] - To address the Problem 2, a fault detection scheme has to be developed that can work only with the attitude measurements. Some of the attitude measurement sensors available onboard satellites include gyroscope, magnetometer, sun sensor etc. This will eliminate the need for performance measurements at a component level. Also the complete dynamics of the actuator system has to be used (including satellite and CMG motor dynamics model) for developing and verifying the fault detection algorithm. This ensures that the dynamics used may closely match with the actual satellite. [OBJECTIVE 3] - To address the Problem 3, a data driven fault isolation algorithm for a single gimballed CMG actuator system has to be developed. A single gimballed CMG installed in pyramid configuration has 4 gimbal motors and 4 spin motors. The Isolation algorithm shall isolate faults with respect to each of the 8 motors used. Like mentioned in the Objective 2, the fault isolation algorithm shall work only with the attitude level measurements form the satellite. This algorithm shall be developed and verified by using complete actuator dynamics. [OBJECTIVE 4] - To overcome problem 3, a prognostics algorithm to find the remaining useful life of a spin motor has to be developed. This algorithm shall (1) work only with the spacecraft attitude rate measurements and does not require any other additional information. (2) use a computationally light training model so that the prognosis algorithm can be run onboard satellite.

1.9 Main Contributions
[CONTRIBUTION 1] - To address the Objective 1, a novel framework for reducing the need for a large volume of historical data is provided. This framework fuses data driven model with two properties. (1) Symmetric property of data is used for mapping the input-output 20

1.9 Main Contributions

function when a single CMG is operated, (2) System orientation property of the pyramid configured CMG actuator system is used where the data from a single CMG is mapped to other three CMGs. A simple feature extraction technique is provided, which reduces noise to a certain level and the dependency of data on initial state of the spacecraft. Also the data is trained using Chebyshev Neural Network (CNN) which is computationally light algorithm in terms of training (Lee & Jeng 1998) when compared to other ANNs. The proposed framework reduces the need for the volume of historical data by 93.5%. [CONTRIBUTION 2] - To address Objective 2, an adaptive threshold based fault detection algorithm is used for fault detection in CMG. As stated in Objective 1, complete attitude and actuator dynamics is used for development and verification of the algorithm. Also the proposed algorithm uses only attitude rate measurements from the spacecraft which can be easily obtained using an onboard gyroscope. The proposed algorithm works for all types of spin motor faults such as abrupt, transient, intermittent faults and the stall fault of the gimbal motor. [CONTRIBUTION 3] - To address Objective 3, a novel optimization based fault isolation formulation is proposed that isolates the fault of all 8 motors used in the CMGs. The proposed formulation works only with the attitude rate measurement of the satellite and the data-driven model. Complete attitude dynamics is used for the satellite as well as all the 8 motors to develop and verify the algorithm. Since there are 8 motors, it may fail in 28 = 256 different ways. Extensive simulations have been performed inducing faults in random to verify the accuracy of the algorithm. The proposed algorithm performed with an overall accuracy of 93.5% for different cases of fault. [CONTRIBUTION 4] - To address Objective 4, an error/residual based scheme for fault prognosis is provided which works using the attitude rate measurement and the data-driven model. General Path Model (GPM) which is one of the computationally light algorithms (Coble & Hines 2008), is used to estimate the Remaining Useful Life (RUL) of the spin motor. Based on simulation from different cases, it can be concluded the algorithm estimates the RUL of spin motor with an overall accuracy of 96.17% when 30% prior data is available. Complete attitude and actuator dynamics is used for simulating this algorithm.

21

Chapter 1 Introduction

1.10 Thesis Outline
The derivations of satellite attitude kinematics and dynamics equations along with the dynamics of motors are provided in Chapter 2. Along with that, the derivation with respect to actuator configuration is also provided. In Chapter 3, the proposed data driven model for fault detection, feature extraction scheme are outlined and the performance plots are provided. In the first part of chapter 4, fault detection algorithm is provided using which all the fault cases of gimbal motor and spin motor are simulated. The results are discussed for all cases with the information on the speed with which the algorithm detects fault. In the second part of Chapter 4, fault isolation algorithm is derived and simulations results for several cases are provided. In Chapter 5, prognosis algorithm is given and simulated. The prediction accuracy of the algorithm is provided with sample plots. Chapter 4 to 5 follows the DPHM's order of fault detection, isolation and prognosis. Finally in Chapter 6, the summary of contributions and results of the thesis are provided and some of the directions for future work are outlined.

22

CHAPTER 2

2. Satellite and Actuator Dynamics
Since the history of attitude data for satellites that is appropriate for development of a data
driven FDI and prognosis is unavailable in literature, data has to be generated using the attitude dynamics model of the satellite. To explain the derivations of the dynamic model, the coordinate frames such as the inertial frame, orbital frame, and body frame are defined first. This is followed by providing the derivations of the dynamics and kinematics. The dynamics model is given as three sections in this chapter for the ease of understanding of reader. First is the derivation of attitude kinematics and dynamics for a satellite that uses a momentum exchange device. Secondly the derivation of the angular momentum dynamics specific to the actuator and its configuration is provided. In this thesis, single gimballed control moment gyro (CMG) is used in a pyramid configuration. Thirdly the derivation of dynamics and kinematics of the motors used for the CMG is given. Two types of motor used here. One is the gimbal motor and other is the momentum wheel motor/spin motor. Combining all these dynamics equations provides with the complete satellite attitude dynamics model.

2.1 Reference Frames
To derive the attitude dynamics of the spacecraft, the following four reference frames are required: Earth Centered Inertial Frame (ECI), Earth Centered Earth Fixed Frame (ECEF), Local Vertical Local Horizontal Frame (LVLH) also called as orbital frame and Satellite Body Frame (SBF) (Kumar 2012). All the frames used here are orthogonal, three axis right hand Cartesian coordinate system. The spacecraft is considered as a rigid body and the SBF coincides with the centre of mass of the spacecraft. (1) Earth Centered Inertial Frame (ECI): The frame  -    as mentioned in Figure 2.1 is the inertial frame where   plane lies in the equator,  points towards the vernal equinox,  points the earth's Geographic North Pole and  completes the right hand triad. (2) Earth Centered Earth Fixed Frame (ECEF): This body frame of Earth represented as  -    where the   plane lies in the equator,  passes through the prime 23

Chapter 2 Satellite and Actuator Dynamics meridian,  passes through the Geographic North Pole and  completes the right hand triad. (3) Local Vertical Local Horizontal (LVLH)/Orbital Frame: The frame  -    in Figure 2.1 represents the orbital frame or LVLH frame which lies on the body centre of spacecraft.  and points towards earth,  points along the orbital velocity vector of the  is along  spacecraft and  completes the right handed triad. The angle  is used for circular orbits and true anomaly is used for eccentric orbits. (4) Spacecraft Body Frame (SBF): Spacecraft body frame  -    coincides with the LVLH frame when the attitude angles, pitch, roll and yaw are zero. The orientation of SBF frame with respect to LVLH frame represents the attitude of the spacecraft.

Figure 2.1 Reference Frames (Godard 2010)

24

2.2 Satellite Attitude Dynamics

2.2 Satellite Attitude Dynamics
The rotational dynamics of a satellite that uses momentum exchange devices like Control Moment Gyro, Momentum Wheels or Reaction wheels can be given as follows (Tsiotras 2001).
    +  ×  = 

(2.1)

  where   3×1 is the total angular momentum of the satellite including the actuator and  

3×1 is the angular velocity of the satellite with respect to inertial frame expressed in the body frame and   3×1 is the external torque disturbances. The total angular momentum of the satellite can also be given by,
   =  +        =  +   + 

(2.2) (2.3)

where   3×3 is the total inertia of the satellite including the actuator and   3×1 is the angular momentum imparted by the actuator on to the satellite. Substituting equations (2.2) and (2.3) in (2.1), the following equation is obtained. Satellite (Including Actuator Inertia) Component Actuator Component (2.4)

        +   +  ×  +  +  ×  = 

The above equation captures the attitude dynamics of spacecraft with respect to inertial frame  represented in body frame . The change in total satellite inertia due to the actuator dynamics is considered to be negligible and hence   = 0. Also for the actuators such as CMG, the inertia along the rotation axis is considered while the rotational inertia about other axes are assumed to be negligible. Also when the actuators such as CMG are rotating. The equation (2.4) can be rewritten as follows to obtain the attitude rate/velocity of the satellite.
      = -1 ( -  ×  -  -  ×  )

(2.5)

2.3 Satellite Attitude kinematics
Attitude kinematics provides the relationship between the angular positions with respect to the angular velocities obtained from the satellite dynamics equations. The kinematic equations provides the actual angular position of the satellite based on the velocity dynamics. To formulate attitude kinematics, Quaternion representation is used for its simplicity.

25

Chapter 2 Satellite and Actuator Dynamics 1   +  ×   [  ] = [ 4   ]   4 - 2   ( )  2   = [ ] = [ ]  4 ( ) 2

(2.6)

(2.7)

where   3×3 represents a identity matrix,    4×1 represents unit quaternion (Wie 1998), 
2 2 2 ] represents the principal angle and   3×1 = [1 2 3 denotes the principal axis related to

Euler's theorem. The vector   3×1 = [1

2

3 ] denote the quaternion parameters that

represent the attitude of the spacecraft body frame  with respect to the orbital frame .
× Quaternion parameter 4  1×1 is constrained by the equation (2.8) and   3×3 is a skew

symmetric matrix given by equation (2.9)
2  4 = 1 -   × 

(2.8) 2 -1 ] 0 (2.9)

0 = [ 3 -2

-3 0 1

The angular velocity of the satellite with respect to the Inertial frame expressed in spacecraft body frame can also be represented as
    =  + 

(2.10)

 where   3×1 the attitude angular velocity of the satellite with respect to orbital frame   expressed in body frame  and   3×1 is the satellite's orbital angular velocity with respect

to inertial frame  expressed in body frame . The spacecraft dynamics equation from section 2.2 provides the attitude rate of spacecraft with respect to inertial frame and it has to be mapped with respect to orbital frame so that it is compatible with the quaternion kinematics equations. The
 direction cosine matrix   3×3 that maps the rotation of the spacecraft body frame with respect

to the orbital frame is given by
 2   ×  = (4 -   ) + 2  - 24 

(2.11)

 The orbital angular velocity of the spacecraft with respect to inertial frame,  can be

obtained by mapping the magnitude of orbital velocity, 0 to the inertial frame using the mapping
 matrix  .   [0   =  0

0]

(2.12) (2.13)

0 =  26

2.4 External Disturbances Torques
3 For circular orbits, the orbital velocity is given by  =  / , where  represents the

earth's gravitational constant which is equal to 398600 3 / 2 and  represents the distance of satellite from the center of the earth which is equal to 6878  (including the radius of earth 6378  and the altitude of satellite 500 ) .

2.4 External Disturbances Torques
A spacecraft in Low Earth Orbit is exposed to various disturbances, it generates undesired torques affecting the attitude. Some of the disturbances are due to earth's gravitational field gradient, aerodynamic drag and solar radiation pressure. There may also be some unknown disturbances affecting the spacecraft attitude which must be considered. The total disturbance torque vector can be given by (Godard et al. 2013)  =  +  +  +  (2.14)

Due to the uneven gravitational field on earth, the satellite will be experiencing uneven gravitational pull along its length, breadth and height. Also, uneven mass distribution in the satellite can cause variations in gravitational forces across its geometry. But, for a small satellite the forces due to uneven gravity gradient is assumed to be negligible and only the forces due to the uneven mass distribution is considered. The disturbance due to the gravity is given by (Wie 1998).
2 ×  = 3  0 3 3  [ 3 =  0 0 1]

(2.15) (2.16)

The electromagnetic radiation from the sun, imparts a radiation force on any surface that is exposed to the sunrays. This causes both orbital and attitude perturbations in a satellite. Small satellites are more prone to solar perturbations because of its low rotational inertia. The solar radiation pressure for small satellites are given by (Kaplan 1976). 2 -5 (1 - 2 sin(0 ))  =  [ 1 -3 (cos(0 )) ] -5 -5 (cos(0 )) radiation pressure is given by  = 1.7 -6 (Godard et al. 2013). In Low Earth orbits, there will be a few air molecules floating around the space which causes an aerodynamic drag on the satellites orbiting in high velocities. The aerodynamic drag force depends on the surface of the spacecraft that is along the orbital velocity vector. Due to the 27 (2.17)

Based on the worst expected disturbances for a small satellite, the scaling factor for solar

Chapter 2 Satellite and Actuator Dynamics difference in the drag forces along the surface, a torque is imparted on the spacecraft creating attitude perturbations. The atmospheric drag torque for small satellites is given by (Wie 1998). 1 1 + sin(0 ) + sin(20 ) 2 1  = 1.36  -5 -2 (4 + 2 sin(0 ) + sin(20 )) 2 1 [ -(1 + sin(0 ) + 2 sin(20 )) ]

(2.18)

Based on the worst expected disturbances for a small satellite, the scaling factor for aerodynamic drag is given by  = 1 -11 (Godard et al. 2013). The unknown disturbance torque for small satellites is given by sin(0 ) 1  2  = ( + || || ) [cos(0 )] 2 cos(0 ) (2.19)

2.5 CMG Dynamics
The placement of single gimballed CMG in pyramid configuration on a satellite body frame is shown in the Figure 2.2. Each CMG component has a gimbal motor, a spin motor and a flywheel/momentum wheel. The CMG produces control torques by gimballing the momentum wheel to create a change in the angular momentum of the satellite. The control torques are equal to the change in angular momentum. The inclination angle  = 54.73° is the inclination angle for each CMG as shown in Figure 2.2. This angle provides with the near spherical momentum envelope for the satellite (Wie et al. 2001) and desirable for a complete attitude control. The angles  ,  = 1  4 represents the gimbal angle of each gimbal motor. The angular momentum of each spin wheel in the gimbals is given by   1×1 ,  = 1  4.  =   (2.20)

where,   1×1 and   1×1 are the inertia and the RPM of each of the flywheels due to the spin motors. The momentum generated by each gimbal can be mapped on the spacecraft body frame  using the Euler angle direction cosine matrices. The rotation matrices  ,  represents the rotation about the  and  axes respectively and can be given as follows. 1  () = [0 0 0 cos  sin  0 - sin  ] cos  28 (2.21)

2.5 CMG Dynamics

zB

SM 3

yB
SM 2 GM 3 GM 2

SM 4

GM 4
SM ­ Spin Motor GM ­ Gimbal Motor

GM 1

SM 1

xB

zB

GM

3

h 2

GM

2

h 3
GM

yB
h 1

GM

1

4

h 4

90  



xB

Figure 2.2 Single Gimballed CMGs in Pyramid Configuration

29

Chapter 2 Satellite and Actuator Dynamics cos  0 - sin  0 - sin  1 0 ] 0 cos  (2.22)

 () = [

Using the rotation matrices, the angular momentum imparted by the momentum wheel 1 on spacecraft body frame  is given by 0 1 =  (-(90 - )) (1 ) [1 ] 0 - cos  sin 1 cos 1 1 = [ ] 1 sin  sin 1 (2.23)

(2.24)

where 1  3×1 is the angular momentum of the CMG 1 on the satellite, 1 is the gimbal angle due to the actuation of GM 1. Similarly, the angular momentum imparted by other CMGs on satellite is given by -2 2 =  (90 - ) (2 ) [ 0 ] 0 - cos 2 2 = [- cos  sin 2 ] 2 sin  sin 2 0 3 =  (90 - 3 ) (-3 ) [-3 ] 0 cos  sin 3 3 = [ - cos 3 ] 3 sin  sin 3 4 4 =  (-(90 - )) (-4 ) [ 0 ] 0 cos 4 4 = [cos  sin 4 ] 4 sin  sin 4 (2.25)

(2.26)

(2.27)

(2.28)

(2.29)

(2.30)

where   3×1   ,  = 1 to 4 corresponds to the CMG 1 to 4. The total angular momentum of the CMG configuration on the satellite is the vector sum of the individual CMG momentum. The total angular momentum vector is given by (Wie et al. 2001).  = 1 + 2 + 3 + 4 30 (2.31)

2.5 CMG Dynamics - cos  sin 1 - cos 2 cos 1 = [ ] 1 + [- cos  sin 2 ] 2 sin  sin 1 sin  sin 2



cos  sin 3 cos 4 + [ - cos 3 ] 3 + [cos  sin 4 ] 4 sin  sin 3 sin  sin 4

(2.32)

where   3×1 is the total angular momentum of the satellite imparted by CMGs. The above equation can be rewritten in matrix form as  =  - cos  sin 1 - cos 2 cos  sin 3 cos 4 cos 1 - cos  sin 2 - cos 3 cos  sin 4 ] A=[ sin  sin 1 sin  sin 2 sin  sin 3 sin  sin 4 1 1 2 2  = 3 3 [ 4 4 ] (2.33) (2.34)

(2.35)

where   3×4 is the mapping matrix that transforms the momentum from each of the momentum wheels to the spacecraft body frame . The rate of change of momentum has to be solved for applying it to the dynamics equation of spacecraft. The rate of change of angular momentum is given by  =  +  cos  cos 3 - cos  cos 1 - sin 2 sin 4 2 sin 1 - cos  cos 2 - sin 3 cos  cos 4 ]  = [  sin  cos 1 sin  cos 2 sin  cos 3 sin  cos 4 3  ] [ 4 1 1   3 3 [   ]
4 4 2 2

(2.36)   1  

(2.37)

 =

(2.38)

Here the inclination angle  is a constant and the gimbal angles are variable. The momentum wheel spin rate is considered as a constant for the CMG system used in this thesis. But the rate of change of wheel speed is also considered in the equations as it is required when the spin motor becomes faulty. In case of variable CMGs, the speed of the momentum wheel is variable and not constant. 31

Chapter 2 Satellite and Actuator Dynamics 2.5.1 Gimbal Motor Dynamics Stepper motor can work without any feedback sensors unlike servomotors with high precision (Rivas 2005) and are available is small sizes. This makes the stepper motor a good option for a CMG (Abreu 2010). The dynamics equations for a two phase and four phase stepper motors is given in literature (Krause P 1989; Lyshevski 2008). The rotational load on the stepper motors are due to the Frictional Torque  , Dynamic load Torque  , and the inertia of the load  . The rotational dynamics of the stepper motor can be given by   = 1 ( -  -  ) ( +  )   =   (2.39) (2.40)

Where,  is the torque produced by the stepper motor,  is the rotational inertia of the stepper motor,  is the angular position of the rotor and   is the angular velocity of the stepper motor. The frictional torque is given by the equation,  =   +  ( ) (2.41) The terms    correspond to the viscous and coulomb friction constants of the stepper motor respectively. The mechanical dynamics of the motor is given from the equations (2.39) to (2.41). Now the electrical dynamics of the motor, such as current and voltage are given below.  , = 
1


(, - ,  - , )

(2.42)

where , is the motor current for each phase,  is the winding resistance of the coil,  is the winding inductance of the coil and , is the back emf induced by each phase of the stepper motor due to the rotation of the rotor. For a two phase stepper motor with the phases A and B, the back emf voltage can be calculated as follows. , = -  sin(  )  , =   sin(  )  (2.43) (2.44)

where  is the number of rotor pole pairs and  is the maximum flux linkage. The linkage between the mechanical dynamics and the electrical dynamics of the motor can be given as follows.  =   [-, sin(  ) + , sin(  )] (2.45) For a stepper motor, , is the input voltage/control parameter for the motor. The current of the motor is not controllable and the stepper motor withdraws the required current based on the load. Two phase stepper motor is considered for the study here where , and , are 32

2.5 CMG Dynamics the input phase voltages for the phase A and B respectively. The voltage input scheme for a stepper motor is given by the following formula. ,, = sin(, + 90°) ,, = sin( , ) (2.46) (2.47)

Where , is the required gimbal angle from the stepper motor at time  . The parameters used for the stepper motor model is given in the following table

Table 2.1 Parameters for Gimbal Motor (Lyshevski 2014)

Parameter Viscous friction,  Coulomb friction,  Winding resistance,  Winding inductance,  No. of rotor pole pairs,  Maximum Flux Linkage,  Inertia,  + 

Value 9.2  10-4   -1 10-4  0.58  6.9  10-4  50 4.9  10-3  -1 8.1  10-5  2

2.5.2 Spin Motor Dynamics Momentum wheels are mounted on a spin motor which spins at a constant speed in a CMG system. A high-fidelity model for a spin motor available in literature is used here. This high fidelity motor model considers the non-linearities and all the parameters such as back electro motive force (BEMF), cogging torque, ripple torque etc. One of the space grade motor parameters, ITHACO type A by Goodrich is used for this study as given in Table 2.2 (Bialke 1998). There are several sub-models in the high-fidelity model of the spin motor. Each of the sub-models are shown in the dashed boxes in Figure 2.3. Each of the sub-model loops are formulated as follows (a) The EMF torque sub-model is given by  = (
1
 -1)

2 (  + 0.04| | +  +    )  

(2.48)

where the  &  are the bus voltage & current,   is the motor current,   is the back electro motive force (BEMF) voltage gain,  is the spin motor angular velocity. 33

Chapter 2 Satellite and Actuator Dynamics (b) The negative feedback viscous friction generated in the bearings can be given by  = (0.049 - 0.002( + 30)) (c) The coulomb friction is from the rotation of the bearings (d) The negative feedback speed limiter sub-model is to limit the spin motor speed to avoid saturation. (e) The torque control of the motor is given by the torque gain   which delivers torque proportional to the current driver. (f) The noise due to variation in the lubrication dynamics is given as follows
2  =    sin(  ) 

(2.49)

(2.50)

The non-linear high-fidelity model of the spin motor that includes the discontinuous function approximations using the sigmoidal functions is given as follows (Sobhani-Tehrani & Khorasani 2008).   =   [3 - 5 ] -   +        = 1  {1 +   [2 + 1] -   -  4 +  } (2.51) (2.52)

The approximated functions are given by,    ) 2

1 ( ) =   (

(2.53) (2.54) (2.55) (2.56) (2.57)

2 ( ) =  (3   ) 3 ( ,   ,  ) = 4 ( ) = 5 ( ) = exp(-  )  1 + exp(-  ) 

1 - exp(-  ) 1 + exp(-  )

k s ( -  4 ) 1 { 2 1 + exp[- ( -  )] + 1 1 + exp[ ( +  )] 34 }

2.5 CMG Dynamics  ( ,   ,  ) =  [ - 6 - - 1 1 + exp(-  )] (1 +   ) (2.58)

1 - exp(-   ) 1 + exp(-   )

   ]

In the given functions, 1 and 2 accounts for motor disturbances, 3 accounts for the EMF torque limiting sub-model, 4 accounts for the coulomb friction sub-model which is obtained by analytical approximation, 5 accounts for speed limiter sub-model and the    indicates the command voltage. The sigmoidal parameter  is taken as 10 based on literature (Sobhani-Tehrani & Khorasani 2008) and the sampling time is taken as  = 0.001.
Table 2.2 Parameters of Spin Motor (ITHACO Type `A' Motor)
Parameter Coulomb friction,  Viscous friction,  Drive Gain time constant,   Ripple Torque,  Temperature,  Cogging Torque,  Torque Noise Frequency,   Jitter Angle,  BEMF Nominal,   Motor Torque Constant,  Bus Voltage Nominal,  Bridge Resistance,   Driver Gain,   Number of Motor Poles,  Input Filter Resistance,  Quiescent Bus Power,  Driver Bandwidth,   Voltage Feedback Gain, 


Value 0.002  3.84  10-4 //s 0.245 0.22 23 ° 0 0.2 / 0.05  0.029 // 0.029 / 8  2 0.19 / 36 2 3  9 / 0.5 / 95 680 /

Over-speed Circuit Gain,   Maximum Wheel Speed, 

35

Chapter 2 Satellite and Actuator Dynamics

Figure 2.3 High Fidelity Model for Spin Motor (Bialke 1998; Rahimi et al. 2015)

2.6 Summary
The attitude kinematics and dynamics derivations of a satellite, CMGs in pyramid configuration and the spin motor & gimbal motors used in CMGs are provided in this chapter. These equations are combined together to get a complete attitude kinematics and dynamics of satellite.

36

CHAPTER 3 3. Data Driven Model Development
In this chapter, a Nonstatistical based (NSAB) approach is used for developing the data driven model of the system. In this approach, the data-driven model has to capture the input-output dynamics of the plant/system from the historical data. This data-driven model will then be compared with the actual performance of the system to generate residuals. The data-driven model placement in a DPHM scheme shown in Figure 3.1. Based on literature research, the main challenges for developing and training a data-driven model is the need for a large set of historical data. Large set of data from satellites may not be available at the initial stages after launch and also training a large dataset requires lot of computational power. In this chapter, these two challenges are tackled by developing a novel scheme for reducing the need for a large historical data set. The formulations for the data driven model and the performance of the same is provided in this chapter. A single gimballed CMG in a pyramid configuration is used as the actuator.
FDI ­ Fault Diagnosis Prognosis

Plant

Inputs
Data-Driven Model

Residuals

Fault Detection

Fault Isolation

Fault Prognosis/ RUL Estimation

Figure 3.1 Placement of Data-Driven Model in a Data Driven DPHM system

3.1 Proposed Data Driven FDI Algorithm
The schematic of the proposed data-driven algorithm is shown in Figure 3.2. The model development is divided into three stages. The first stage is the data acquisition, second stage is developing a data-driven model at the component level (1 CMG), and the third stage is developing a data-driven model by mapping the component level model to the entire CMG system in pyramid configuration. A feature extraction scheme is also used which is discussed in stage 1. For each stage, the formulations and the result plots are provided.

37

Chapter 3 Data Driven Model Development
Stage 1 Data Acqusition [Component 1, Nominal case]
f

Stage 2 Develop Data Driven Model for Component 1 Stage 3 Generate Data Driven Model for AOCS Subsystem

Figure 3.2 Stages of Data Driven Model Development

3.2 Stage 1 - Data Acquisition and Feature Extraction
The first step in developing a data driven model is to acquire the historical data from the system. For the attitude data acquisition, satellites use two classes of sensors. First type is the absolute measurement which provides the absolute attitude position of the spacecraft. Sun Sensor, Magnetometer and Star sensor are certain examples of absolute measurement sensors. Absolute measurement sensors also requires orbital position of the satellite to determine the attitude position. Second type is the relative measurement where the sensor provides the rate of change of attitude which will then be utilized to estimate attitude position. For the proposed FDI and Prognosis scheme, the attitude rate information is used to develop an input-output data-driven model. Attitude rates can be measured onboard satellites using gyroscope which is one of the widely used sensors. The Data acquisition and feature extraction scheme is provided in Figure 3.3. The attitude actuator system discussed in the thesis consists of 4 CMGs in pyramid configuration. Each CMG has 1 gimbal motor and 1 spin motor. Hence there is a total of 4 gimbal motors and 4 Spin Motors in a pyramid CMG system. As discussed in the introduction of this chapter, the objective of the proposed data acquisition scheme is to work with minimal amount of historical data. If the volume of data is minimal, it will greatly reduce the training time in developing a data driven model and in turn reduce the computational budget. Due to the unavailability of the historical data from the literature, the data is generated from the Dynamics model of the spacecraft with added sensor noise as if it were acquired from the actual satellite. The simulation parameters used are mentioned in Table 3.1. The simulation for data generation is carried out using Simulink. 38

3.2 Stage 1 - Data Acquisition and Feature Extraction

Satellite/Plant
AOCS Subsystem Subsytem 2 .... Subsytem n

CMG 1 Run CMG 1 in the operating region

CMG 2

CMG 3

CMG 4

Generated gyroscope data acquisition
f

Feature extraction

Tag the data as Nominal Operation, CMG 1

Figure 3.3 Data Acquisition and Feature Extraction Scheme Table 3.1 Simulation Parameters for Data Acquisition (Only CMG 1 is operated)
Parameter Spin Motor Voltage [,1 Spin Motor Bus Voltage, [,1 ,2 ,2 ,2 ,2 ,3 ,4 ] ,4 ] ,4 ] [0.029 [5 [8 [2.4 ,3 ,3 ,3 Value 5 8 0 5 8 0 5]  8]  0.029]  0] V

Spin Motor Current Constant, [,1 Gimbal Motor Voltage, [,1

0.029

0.029

,4 ]

Process Noise Standard Deviation,  (for 1 , 2 , 3 and 1 , 2 , 3 ) Measurement Noise Standard Deviation,  (for 1 , 2 , 3 measurements) Satellite Moment of Inertia,  Flywheel Moment of Inertia,  Initial Conditions: [1 0 Initial Conditions: [1 0 Initial Conditions: [1 0 2 0 2 0 3 0 ] 3 0 ] 4 0 ] 0.015 [ 0 0

10-4 10-3 / 0 0.017 0 [1 [0.01 [0 0 0 ]  2 0.020 0] -0.03] 0]

10-5  2 0.25 0.05 0 0

2 0

3 0

39

Chapter 3 Data Driven Model Development 3.2.1 Noise Considerations There are several sensors that are used in satellites for attitude determination. Some of the popular angular position sensors are magnetometer, sun sensor, star tracker, horizon sensor, etc. and angular rate sensor is gyroscope. Each sensor has its own accuracy and limitations. The accuracy levels for traditional attitude determination sensors are given in (Griffin 2004). The only measurement used throughout the thesis is the attitude rate or attitude angular velocity measurements which can be obtained from a MEMS gyroscope. Hence the noise pertaining to the gyroscope is considered as measurement noise. There are mainly two noises in a gyroscope such as Bias and White Noise as given by gyroscope sensor manufacturers (Vectornav 2017). Bias is the output from the gyroscope even when it is kept stationary. It is a constant noise and can be determined by acquiring the data when the gyroscope is stationary. Then the data is averaged over time to find the bias. Once the value of bias noise is identified, it can be constantly subtracted from the real-time gyroscope measurement to eliminate the bias error. If not removed, it adds a linearly increasing error while determining attitude position from the gyroscope. There is also another term called bias stability which is a measure of the average change in bias value over a period of time. Since this is a constant error, it is not considered in this thesis and is assumed to be already removed from the measurements. White noise, also known as Angular Random Walk (ARW) is a high frequency noise caused by thermo-mechanical events (Vectornav 2017). This is an additive Gaussian noise from the gyroscope measurements which has a mean of zero and the magnitude of noise denoted by the standard deviation. The worst case values for white noise is taken as  = 1 × 10-3 / based on the experimental results of attitude determination using MEMS gyroscope given by (Carrasco 2016). The error in (Carrasco 2016) were calculated by applying Allan variance methods to the experimental data from a low cost IMU. Hence, for a space grade sensor used in satellites, the noise will be lesser than what is considered in the thesis. The process noise is nothing but the errors due to the unknown change in the state of the system. For the study, the process noise is assumed to be  = 1 × 10-4 /. 3.2.2 Data Acquisition The gimbal motor 1 is commanded with angles ranging between -81°  81° based on the literature review (Lappas et al. 2005; Abreu 2010). This given range can be categorized into four

40

3.2 Stage 1 - Data Acquisition and Feature Extraction regions namely (i) 0°  81° (ii) 81°  0°, (iii) 0°  - 81° (iv) -81°  0°. These four categories are based on the influence of the command angle on the direction of the attitude angular acceleration. The direction of angular acceleration may be either clockwise or counter-clockwise with respect to each of the satellite body frame    depending on the region of operation. The results of the simulation on operating CMG 1 is shown in Figure 3.4. The next step is to extract feature from the raw data that would be useful for developing a data driven model.

Figure 3.4 Data Acquisition by operating CMG 1

3.2.3 Feature Extraction The generated gyroscope measurement data is noisy and the values of angular velocity is dependant on the initial angular velocity of the satellite. Hence, it adds a complexity that the data driven model has to be developed for all possible intial velocity conditions. The dependancy of the data with respect to the intial conditions has to be removed for reducing this complexity. Feature extraction has to be performed to make the data independent of the initial conditions as well as 41

Chapter 3 Data Driven Model Development remove some level of noise. One of the ways to remove the dependancy of the initial conditions is to obtain the derivative of the dataset. If the data driven model is developed with respect to the derivative of the data, it removes the dependancy from the initial conditions. The derivative also is the angular acceleration which is a direct measure of performance of momentum based attitude actuators. Calculating the derivative of angular velocity of the satellite may increase the effect of noise on the data. To reduce the noise, the sum of the angular velocity is calculated for a time window which can be called as feature extraction. The time window is selected as 0.025  based on the time taken for gimbal motor to rotate one step. Equation (3.1) shows the formulation for this feature extraction. The elements of matrix 1 , represents the feature extracted from 1 , 2 and 3 respectively and  represents step count and  represents the time window.
 -

 1, -
=- 


=-2 -

1, 2, 3,

1 , (1 , ) =

 2, -
=- 


=-2 -

(3.1)

[=-

 3, -


=-2

]

The feature values for 1 , 2 and 3 are shown in Figure 3.5, Figure 3.6 and Figure 3.7 respectively. This extracted feature is independant of initial angular velocity and also the noise is reduced to a certain level. Based on the graph obtained from the feature extraction, it is visually evident that the data is symmetric about the x and y axes in the graph. The symmetricity can also be proven mathematically using the skewness formula. Skewness is used as a measure of assymmetry of data (Doane & Seward 2011). Skewness is given by  =  -    (3.2)

For an ideal symmetric data, the skewness must be equal to zero. If the data is noisy, getting a value of zero is not possible. For the given case of data here, the skewness values are obtained in the ranges from -0.2  0.2 about mean value. Negative skeness means the mean lies on the left side of the data and positve skewness means the mean lies on the right side of the data.

42

3.2 Stage 1 - Data Acquisition and Feature Extraction

Region IV 1 , = -81°  0° 1, > 1,-1

Region I 1, = 0°  81° 1 , > 1 ,-1

Region III 1, = 0°  - 81° 1 , < 1,-1

Region II 1, = 81°  0° 1, < 1,-1

Figure 3.5 Feature Extraction from 
Region III 1, = 0°  - 81° 1 , < 1 ,-1 Region I 1, = 0°  81° 1 , > 1 ,-1

Region II Region IV 1, = -81°  0° 1, = 81°  0° 1, < 1,-1 1, > 1,-1

Figure 3.6 Feature Extraction from 

43

Chapter 3 Data Driven Model Development

Region III 1, = 0°  - 81° 1 , < 1,-1

Region II 1, = 81°  0° 1, < 1,-1

Region IV 1, = -81°  0° 1, > 1,-1

Region I 1, = 0°  81° 1 , > 1 ,-1

Figure 3.7 Feature Extraction from 
Data of Nominal Case, Component 1

Parse Data into Symmetric Sets

Data Set `Region I'

Data Set `Region II'

Data Set `Region III'

Data Set `Region IV'

Develop Data Driven Model for Region I Using Symmetric Property Develop Data Driven Model for all Regions

Figure 3.8 Scheme for Developing Data Driven Model - Component Level

44

3.3 Stage 2 - Data Driven Model Component Level

3.3 Stage 2 - Data Driven Model Component Level
The schematic for developing a data driven model for 1 operation (compoent level) is shown in Figure 3.8. Since the data is symmetric about both  = 0 and  = 0, it can be parsed into four regions with each data set representing a region of the graph in the Figure 3.4 to Figure 3.7. Once the data is parsed into symmetric regions, it is sufficeint to train the data driven model for only one of the regions and other three regions can be derived using the symmetric property. The data from region I is chosen to be trained with the data driven model for all the features extracted from 1 , 2 and 3 respectively. By training only for one region, the need for data is reduced onefourth. Neural Network models are used to train the data. 3.3.1 Model Selection Artificial Neural Network (ANN) which are inspired from the biological neural networks has evolved into many forms involving single to several layer of perceptrons. ANN can approximate nonlinear functions accurately if appropriate architecture is used. In developing a data driven model, ANNs can be used as an input-output mapping function. A detailed structure of a single perception in a neural network is shown in Figure 3.9. Each perceptron will take a set of inputs 1   that is amplified by its corresponding weights 1   . All the amplified inputs are summed together and passed through activation function to get the final output from a perceptron. Activation function gives a non-linearity to the output. Some of the activation functions typically used are Unit Step, Signum, Sigmoid, hyperbolic tangent etc. Generally sigmoid functions are used for positive data outputs and hyperbolic tangent function is used for both positive and negative outputs.

w1 X1

×


Activation function

Y = f(xiwi)

wn Xn

×
Figure 3.9 A Single Perceptron Model used in ANN

45

Chapter 3 Data Driven Model Development Combination of several perceptrons in different patterns and layers provides with different types of neural network architectures. Two major types of neural networks that are seen in literatures for input-output mapping are Feed Forward Neural Networks and Recurrent Neural Networks (RNN). In feedforward network, the information moves from the input layer to the hidden layers and finally to the output layer. In RNNs data propagates both in the forward and backward direction based on the network architecture. RNNs are generally popular in time series training. A Multilayer Feedforward neural network can approximate nonlinear functions accurately but the computational time for data training increases with the number of perceptrons used. A single perceptron can only capture linear functions. For non-linear functions or functions with many input and output dimensions, single perceptron may not be sufficient to capture the dynamics. Adding more layers with several perceptrons between input(s) and output(s) improves the nonlinear mapping ability of the ANNs. However, finding the required network structure for a particular application is a laborious task. Also increasing the number of perceptrons increases the computational time to train the ANN and may also increase the possibility of overfitting. Reducing the number of perceptrons may be a computationally efficient choice but it may not approximate the function properly. Lots of trial and error has to be done before obtaining a structure that works appropriately for the given data. Trial and error can be done by changing the number of perceptrons in each layer, changing the layer or changing the connections among the neural network architecture. To avoid the problem of more computational time on training several layers of ANN, the hidden layers may be replaced with higher order inputs so that the non-linear dynamics may be captured before the input stage of neural networks. According to Hornik's theorem, the inputs converted to the higher order will be able to capture the non-linear function more effectively just with a single layer. These type of ANNs use a function to add higher order dimensionality to the input data before feeding it to the neural networks and called as Functional Link Neural Network (FLNN). This avoids the need for a complex ANN to capture the non-linearity. For the developing a data driven model from the satellite data developed from feature extraction, a type of FLNN called Chebyshev Neural Network is used (CNN). The functional link used in CNN are called as Chebyshev polynomials. CNNs are used in many areas of function approximation problems (Singh et al. 2017) & (Purwar et al. 2007) and classification problems (Vyas et al. 2016). 46

3.3 Stage 2 - Data Driven Model Component Level 3.3.2 Chebyshev Neural Network The CNN structure used in this thesis is a single hidden layer network and are explained as follows. The first two orders of Chebyshev polynomials can be given as follows 0 = 1 1 =  (3.3) (3.4)

Where 0 and 1 is the zeroth order and first order Chebyshev polynomial and  is the input data. The higher orders of the Chebyshev polynomials can be given as follows (Lee & Jeng 1998). +1 = 2 - -1 (3.5) Where x is the input and  represents the Chebyshev polynomial  . They are sets of orthogonal polynomials that are defined as a solutions to Chebyshev differential equation. According to best approximation theory, Chebyshev functional expansion is advantageous over other functional expansions (Lee & Jeng 1998). Hyperbolic tangent is used as the activation function as the outputs contain both positive and negative numbers. The architecture of CNN used for training is shown in Figure 3.10. The CNN used here is a single input single output (SISO) architecture. Mathematically, the CNN can be represented using the following equation


 =   
=0

(3.6) (3.7)

,  = tanh()

Chebyshev Polynomials

T0

w1
Input

T1

w2 Tiwi wn Tanh (Tiwi)
Output

x

Tn

Figure 3.10 Chebyshev Neural Network (CNN) Architecture

47

Chapter 3 Data Driven Model Development 3.3.3 Data Normalization The inputs used here are the commanded gimbal angles |1 | which ranges from 0°  81°. When these inputs are converted into Chebyshev polynomials, it becomes huge numbers. Hence the data is normalized/scaled between -1 and 1. To normalize the Chebyshev polynomials, the following formula is used.  = max( ) - min( ) ( ) =   (3.8) (3.9)

Each of the Chebyshev polynomial are normalized before multiplying with the weights. The Normalization factor  has to be stored to be used later with the prediction model. 3.3.4 Model Training The most common form of training ANN is supervised learning. In supervised learning, Inputs with known outputs are fed into the neural networks. In the first epoch of training, the neural networks are initialized with random weights which produces random output. This random output will not match with the desired outputs as the network has not be trained yet. Hence the weights of the neural network has to be adjusted so that the network output match with the required output. To adjust the weight vectors, a learning algorithm has to be developed that can change the values of weights at each iteration so that the difference between the output from the network and expected output reduces iteratively. Mathematically, the objective is to minimize the error between the actual outputs from the neural network with the expected output and can be formulated as error function. The error function can be defined as follows.
2 1  (3.10)  ,  = (1,  -  ) 1,  2  is the estimated output from Where 1 is the expected output from the CNN and  1

the CNN. The most commonly used algorithm for ANN training is the Gradient Descent Back Propagation Algorithm (GD-BP). In GD-BP the error from the objective function is propagated backwards from output layer to the input layer. While the error is propagating the weights are adjusted proportional to its contribution to the error so that the error is reduced at each iteration. The formula for gradient calculation using chain rule is given by (LeCun et al. 2015).     =-     48 (3.11)

3.3 Stage 2 - Data Driven Model Component Level The Equation (5.11) provides with the information on the contribution of each weight to the error. For the CNN used in the thesis, Equation (5.11) after differentiation of can be given as  = -   ()    the weights. The formula for updating weights is given by (Schmidhuber 2015). , =   , (3.13) (3.14) (3.12)

The error gradient for all the weights has to be calculated. This can then be used to update

,+1 = , + ,

where  is the learning rate. The learning rate is the important parameter as it scales the rate of change of the weights from GD-BP algorithm and this parameter directly affects the convergence rate. If the learning rate is too small, several iterations are required to converge to the required solution. On the other hand if the learning rate is too large, it may lead to the error oscillating around the optimal solution leading to a non-optimal solution (Riedmiller & Braun 1993). This problem may be avoided by adding another factor called momentum rate as shown in equation (5.12) ,+1 = , +   +  ,-1 , (3.15)

where  is the momentum rate. Momentum parameter scales the influence of the previous error gradient to the current iteration. This term may reduce the oscillations and make the learning procedure more stable and also quicken the convergence of error function in steep regions. However for the current data driven fitting the momentum parameter is not used. Since the momentum parameter is also equally dependant on learning rate improvements may not be accomplished in some cases (Riedmiller & Braun 1993). 3.3.5 Training Results Chebyshev neural network of 3rd order is trained using GD-BP algorithm with region I data. The inputs are the absolute values of gimbal angles |1 | and the outputs are the extracted features from 1 , 2  3 respectively. Online training method is employed in which each epoch will have one iteration for each data point. Random numbers from 0 to 1 are used for initial population of weights. Training is done in MATLAB software using Dell Precision T3400 computer with Intel® CoreTM 2 Quad 2.39 GHz CPU with 6GB 800MHz, DDR2 ECC SDR AM. 49

Chapter 3 Data Driven Model Development Training for each feature took about 0.38 seconds for 50 epochs and a total of around 1.14 seconds for a total of all three features with 50 epochs. The result of the training and the error convergence plots are shown in Figure 3.11. For all the three features, the error convergence happens within 20 epochs. The author tried with higher order CNNs which seemed to over fit with the data. Since the data is containing a certain level of noise, it is better to avoid overfitting the CNN with the noise dynamics. The CNN with 3 rd order polynomial, captures the underlying nonlinearity from the data eliminating the noise. The weights,  and the errors are shown in the table below.

Table 3.2 Parameters of CNN
Feature For feature extracted from 1  0 1 2 3 0 For feature extracted from 2 2 3 0 For feature extracted from 3 1 2 3 1  0 81 13.122 × 10 2.126 × 10 0 81 1.312 × 104 2.126 × 106 0 81 1.312 × 104 2.126 × 106
3 6

 0.1040 -0.1047 -0.0389 -0.0331 0.0031 0.2190 -0.0179 -0.0483 -0.1119 0.0300 0.0503 0.0118

Error Metric, E

1.8 × 10-3

1.8 × 10-3

2.3 × 10-3

The errors from the CNN as mentioned in Table 3.2 are in the orders of 10-3. This error may be due to the noise from the generated data that is transferred onto the extracted feature. The next step is to use the estimated output from neural network and expand it to other regions.

50

3.3 Stage 2 - Data Driven Model Component Level

Figure 3.11 Results: CNN Training using GD-BP

51

Chapter 3 Data Driven Model Development 3.3.6 Component Level Model In the previous section, the CNN model is developed for the data set from region I. But this has to be expanded to other regions to make it as a component level (CMG 1) model. From the feature extraction as shown in Figure 3.4 to Figure 3.7, the following conclusion can be made about the feature 1 . Each of the features has positive or negative value that is dependent on the region of operation. This the reason for categorizing  1 into four regions. The values of  1 on different regions for operation are shown in Table 3.3.
Table 3.3 Effect of Gimbal Motor Operational Region on  ,
Command
,

angle

Value of , extracted from  Positive (1 increases)

Value of , extracted from  Positive (2 increases)

Value of , extracted from  Negative (3 decreases)

Region I 0°  81°
1, > 1,-1

Region II 81°  0°
1, < 1,-1

Negative (1 decreases)

Negative (2 decreases)

Positive (3 increases)

Region III 0°  - 81°
1, < 1,-1

Negative (1 decreases)

Positive (2 increases)

Positive (3 increases)

Region IV -81°  0°
1, > 1,-1

Positive (1 increases)

Negative (2 decreases)

Negative (3 decreases)

Effect converted as mathemetial formulations for all regions (1, - 1,-1 ) (|1 , | - |1,-1 |) (1 , - 1 ,-1 )

The effect of Gimbal motor operation can also be conveted into mathematical formulation as shown in Table 3.3. This formulation is a single equation that can be used to represent the sign (positive or negative) of 1 for all the regions. The sign formulation can be represented in a matrix from as represented in Equation (3.16). This matrix has to be multiplied with 52

3.3 Stage 2 - Data Driven Model Component Level  ( ), to get the estimate   , for all the regions as mentioned in Equation (3.17).  1 1 , (1 , , 1 ,-1 )
(1 , - 1 ,-1 )

0
(| , | - |
1

= [

0 0

0

1 ,-1

|)

0 0
(1 , - 1 ,-1 )

]

(3.16)

 , = fE,i ( , ,  ,-1 )    (1 , ) 1 1 1 1( ) ,

(3.17)

The results after expansion are shown in Figure 3.12 to Figure 3.14. The estimation from the CNN for the first region is expanded to all the other regions. From the results it can be concluded that it matches with the data from other regions. Also it does not matter which region is taken for training. Any region may be used for training as the data is symmetric with respect to both x axis and y axis and the model can be expanded from one region to other thereby using only one fourth of the data.

Figure 3.12 CNN estimation expanded from region I to all regions

53

Chapter 3 Data Driven Model Development

Figure 3.13 CNN estimation expanded from region I to all regions

Figure 3.14 CNN estimation expanded from region I to all regions

54

3.4 Stage 3 - Data Driven Model for AOCS Subsystem

3.4 Stage 3 - Data Driven Model for AOCS Subsystem
The scheme for developing data driven model from one CMG to all the other CMGs is shown in Figure 3.15. A total of two system properties are used 1. Orientation of CMG's 2. Vector Addition Property of Angular Velocity The CMG system used in spacecraft consists of 4 CMG's comprising of same type of gimbal motors, spin motors and flywheels. Hence the performance of all the CMG's would be same as CMG1. But on the satellite level, the effect of CMG's performance on attitude are affected by the orientation of the CMG's on satellite. By using the rotation matrices for mapping orientation, the data driven model developed for CMG1 can be extended to the other CMG's using the orientation and vector addition property.

Data Driven Model for fCMG1

Using System Property Data Driven Model for fCMG2

Using System Property Data Driven Model for fCMG3
... +

Using System Property
Data Driven Model for fCMG4

Data Driven model for AOCS Subsystem Actuators

Figure 3.15 Schematic for Developing Data Driven Model: Component Level

Each CMG is rotated about the spacecraft body  axis with respect to CMG1. The CMG2, CMG3 and CMG4 are rotated about  axis with the angles of 90°, 180°  270° respectively with respect to CMG1. The rotation matrix about z axis for a right hand orthogonal Cartesian coordinate system is given by 55

Chapter 3 Data Driven Model Development cos   () = [ sin  0 - sin  cos  0 0 0] 1

(3.18)

The rotation matrix from equation (3.18) can be used to arrive at the formulations for the effect of other CMGs on spacecraft from the model of CMG1. The formulations can be given as follows.  , =  (90°)  ,  2 1  , =  (180°)   ,  3 1  , =  (270°)   ,  4 1 (3.19) (3.20) (3.21)

One of the properties of angular velocity is that the angular velocity vector is additive. The angular velocity vector of a system can be given by the vector sum of individual angular velocity vectors. Since the feature that is used here is also a measure of angular velocity, the additive property of the angular velocity holds true. Hence the data driven model for each CMG can be added together in a vector form to get the combined effect of all CMG's on satellite attitude. The final data driven model including all CMG's are given as follows.  =   +   +   +    1 2 3 4 (3.22)

This single Equation (3.22) represents the performance of all CMG's combined. This can be used to predict the performance of all the actuators on the spacecraft. Simulation is done to check the performance of Equation (3.22) in mimicking the actual performance of the spacecraft. The parameters mentioned in Table 3.1 and Table 3.4 are used for simulation. In this simulation all the four CMGs are operated with different initial conditions so as to showcase the robustness of the extracted feature with respect to the initial coditions. Since the model from CMG 1 is mapped to other three CMGs, it is clear that only one fourth of the data is used here.

Table 3.4 Simulation Parameters for Data Driven Model, Subsystem Level.
Parameter Gimbal Motor Voltage, [,1 Initial Conditions: [1 0 Initial Conditions: [1 0 Initial Conditions: [1 0 ,2 2 0 2 0 ,3 3 0 ] 3 0 ] 4 0 ] [0.01 ,4 ] [2.4 [1 [-1.8 Value 0 0 0] V 0] -36]°

0.25 45 18

0.05

-0.03] /

2 0

3 0

56

3.4 Stage 3 - Data Driven Model for AOCS Subsystem

3

2

Figure 3.16 Performance of the Data Driven Model, Subsystem Level

57

Chapter 3 Data Driven Model Development The results are shown in Figure 3.16. The entire region of operation of gimbal angles for all CMGs are verified in this simulation. As seen from the Figure 3.16, there are slight differences with the actual feature and the CNN estimation. This may be due to two reasons. One due to the unknown meausurement errors which are not accounted while developing the data driven model and other due to the inaccuracies of the model. As long this slight difference in performance does not affect the perfomance of the FDI and Prognosis, this difference is acceptable.

3.5 Conclusion
The data driven model is developed for the CMG system using the CNN. At stage 1 of development, it is clear that only one-fourth of the data is used for developing a component level model. At stage 3 of the model development, the model from one CMG is mapped to other CMGs. This means that 75% data requirement is eliminated. When combining stage 2 and stage 3 together, it is clear that the data-driven model for 4 CMGs can be developed only using one-fourth data from one CMG. Hence stage 2 and stage 3 in combination reduces the need for historical data by 93.75%.

58

CHAPTER 4 4. Fault Detection and Isolation
In a FDI algorithm of DPHM framework, Fault Detection precedes Fault Isolation. The placement of FDI scheme in a DPHM framework is shown in Figure 4.1. There are gimbal motors and spin motors in a CMG system, which are rotating electromechanical components and are prone to faults and failures. After the onset of fault or failure of an actuator, if controller reconfiguration is not made promptly, the satellite may reach an uncontrollable state leading to total loss of mission. FDI algorithms must detect and locate the faults in actuator system as soon as it has occurred so that it can demand the need for satellite control reconfiguration in a timely manner.

Fault Diagnosis

Prognosis

Plant

Inputs
Data-Driven Model

Residuals

Fault Detection

Fault Isolation

Fault Prognosis/ RUL Estimation

Figure 4.1 Placement of FDI module in a data Driven DPHM system

In first part of this chapter, fault detection scheme is discussed and simulation results are provided. An adaptive threshold based fault detection scheme is used to detect fault. In the second part of this chapter, a novel optimization based Fault Isolation scheme is provided. The novelty lies on the isolation problem formulation where the data driven model and system orientation property equations are derived and fused together to arrive at the required equations. From the literature, it is observed that one of the main challenges for a small satellite FDI algorithm is that it requires component level measurements such as rotation speed, current, torque etc. from the motor. But the small satellites may have a restricted space, mass and data handling budget to install and acquire individual measurement data. This problem is addressed in this chapter by developing the Fault Detection and Isolation algorithms in such a way that it works only using the satellite attitude rate measurements and any other component level measurements are not required. 59

Chapter 4 Fault Detection and Isolation

4.1 Fault Detection
The fault detection scheme used in the study is shown in Figure 4.2. The data driven model developed in the previous chapter predicts the performance of the system. To predict the feature, the data driven model requires the information of the gimbal command angle and the last commanded gimbal angle, i.e. ,  ,-1 for all the gimbal motors. Simultaneously, the actual performance is measured from the system and compared with data-driven model prediction to generate residuals. The residuals are evaluated to detect faults.

System Performance Measurement Error
f

System Performance Prediction (Data Driven Model)

+/f

Online Feature Extraction

Error>threshold

Fault Detection

Activate Fault Isolation
Figure 4.2 Fault Detection Scheme

4.1.1 Fault Detection Algorithm To find out how close the system performs with respect to expected performance form data driven model, the residuals are calculated as the difference between the actual performance and model performance. Mathematically, the absolute difference between the actual feature, ,  ,   3×1 is calculated. The absolute difference value 3×1 and the model predicted feature  is a  3×1 matrix and each element in the matrix provides the difference in the values from the 60

4.2 Fault Detection Simulation Results features of 1 , 2  3 respectively. The elements in this matrix is summed to find the error. The equation (4.1) represents the error calculation formulation at the timestamp  and the summation symbol  denotes the summation of the elements in the matrix.  = 


, | +  |, - 

(4.1)

In an ideal scenario when the system is under nominal operation, error must be equal to zero. But due to the random sensor noise and small errors in the data driven model, there will always be some magnitude of errors. Hence a threshold has to be used to detect fault in which if the error is below threshold then the system is considered to be in nominal operation and considered faulty otherwise. The threshold can be constant or adaptive. For a constant threshold factor, history of data is required. Constant threshold has to be kept a bit higher than the error values obtained in the nominal condition. Since this value is needs historical data, a variable threshold factor called adaptive threshold can be used. The adaptive threshold does not require historical data and is based on the fact that, for a normally distributed dataset 99.73% of the data falls within the standard deviation ±3 (Grafarend 2006) from the mean. The formulation for adaptive threshold is given as follows (Shi et al. 2005). 1  =   
=- 

(4.2)

1  =   ( -  )2 
=-



(4.3)

 =  + 6

(4.4)

where  is the adaptive window,  is the mean and  is the standard deviation of the error data. The threshold and standard deviation is calculated for every time stamp for detecting fault.

4.2 Fault Detection Simulation Results
To evaluate the performance of the fault detection algorithm, simulation is performed for examining stall fault of the gimbal motor and abrupt, transient, intermittent and incipient faults of the spin motor. The simulations were performed using the Dell Precision T3400 computer with Intel® CoreTM 2 Quad (Q6600) 2.39 GHz CPU with 6GB 800MHz, DDR2 ECC SDRAM. The simulation parameters are shown in Table 4.1. Simulation has been performed with a 61

Chapter 4 Fault Detection and Isolation fault induced in one of the gimbal motors at  = 35 to show the difference between constant and adaptive threshold. The constant threshold is selected as 0.2 based on the historical data and the adaptive threshold is calculated based on equation (4.4). The results are shown in Figure 4.3. It can be seen from the results that the adaptive threshold changes constantly based on the standard deviation and mean values of the previous errors. Both the adaptive and constant threshold detects the fault at 35.

Table 4.1 Simulation Parameters for fault detection
Parameter Spin Motor Voltage [,1 Spin Motor Bus Voltage, [,1 ,2 ,2 ,2 ,2 ,3 ,4 ] ,4 ] ,4 ] [0.029 [5 [8 [2.4 ,3 ,3 ,3 Value 5 8 2.4 5 8 2.4 5]  8]  0.029]  2.4] V

Spin Motor Current Constant, [,1 Gimbal Motor Voltage, [,1

0.029

0.029

,4 ]

Process Noise Standard Deviation (for  and ) ,  Measurement Noise Standard Deviation (for  and ),  Satellite Moment of Inertia,  Flywheel Moment of Inertia,  Initial Conditions: [1 0 Initial Conditions: [1 0 Initial Conditions: [1 0 2 0 2 0 3 0 ] 3 0 ] 4 0 ] 0.015 [ 0 0

10-3 10-4 0 0.017 0 [1 [0.01 [0 0 0 ]  2 0.020 0] -0.03] 0]

10-5  2 0.25 0.05 0 0

2 0

3 0

Figure 4.3 Comparison of Adaptive and Constant Threshold

62

4.2 Fault Detection Simulation Results 4.2.1 Gimbal Motor - Stall fault The stalling of the gimbal motor is considered in this case. Stalling occurs when the motor completely stops rotating/stepping even when it is commanded to rotate. In this simulation stalling is simulated by cutting off the command voltage to the gimbal motor. The fault profile used for the simulation and the fault detection time is shown in Table 4.2. In this case, Gimbal Motor 2 is considered as faulty and the fault is induced at time 12 . The adaptive threshold algorithm detects the fault at 12.02 . Since this is a software simulation the fault is detected almost immediately after the fault has occurred. But on the real hardware, there may be delay due to the measurement speeds, command and data handling speed.

Table 4.2 Gimbal Motor - Stall fault profile and detection
Time (s) t < 12 t > 12 , (V) (Command Voltage) 2.4 0 Change/Fault Detection Time (s) 12.02

The gimbal angle input commands and the results obtained are shown in Figure 4.4. Form the results, it is clear that, as soon as the fault is induced, the system deviates from the nominal performance region. Hence, the total error and adaptive threshold suddenly peaks after the onset of fault. The adaptive thresholds was able to capture this sudden change in the system as the fault goes beyond the 6 operating zone. 4.2.2 Spin Motor ­ Abrupt fault Spin motor is considered to be in abrupt fault scenario when the parameter of the spin motor system changes its value from one to another at a certain point of time. In this simulation case, abrupt fault due to a change in bus voltage of the spin motor 2, ,2 is considered. The fault is induced at time 12 .
Table 4.3 Spin Motor - Abrupt fault profile and detection
Time (s) t < 12 t > 12 , (V) 8 5 Change/Fault Detection Time (s) 0 12.1

63

Chapter 4 Fault Detection and Isolation In this case the fault is identified at 12.1  as shown in Figure 4.5. Even though the fault is identified quicker in this case, it is not as quick as the detection of stall fault of the gimbal motor. This may be due to the fact that, the fault considered here is not 100% and just a partial fault. Hence the error increases gradually and takes slightly more time to detect fault. 4.2.3 Spin Motor ­ Transient fault Spin motor is considered to be in transient fault scenario when the parameter of the spin motor system changes its value from one to another at a certain point of time then coming back to nominal state afterwards. In this simulation case, abrupt fault due to change in bus voltage of the spin motor 1, ,1 is considered. The fault is induced at time 12   15 .
Table 4.4 Spin Motor - Transient fault profile and detection
Time (s) t < 12 12 > t > 15 t > 15 , (V) 8 5 8 Change/Fault Detection Time (s) 12.1 15.1

Both the onset of fault and the time it takes to recover from the fault is detected at 0.1 . The results are shown in Figure 4.6. Visually, it can be noted from the figure that the average error between the time 12   15  is higher than the error in nominal condition due to the ongoing fault in that time. 4.2.4 Spin Motor ­ Intermittent fault Spin motor is considered to be in intermittent fault scenario when the parameter of the spin motor system changes its value from one to another from time to time. In this simulation case, abrupt fault due to change in bus voltage of the spin motor 3, ,3 and ,3 is considered. The faults are induced at time 7   10 , 12   14   16   18  . The results are shown in Figure 4.7. In this scenario the onset of faults are detected at 0.5 and 0.7 respectively after the occurrence of fault. This is quicker than the detection of previous fault cases of spin motors. This is may be due the fact that in this case both the faults, ,3 and
,3

are considered together which increases the magnitude of fault. Hence the fault detection is

quicker in this case. Visually, it can be noted from the figure that the error between the 64

4.2 Fault Detection Simulation Results time 7   11 , 12   14  and 16   18 is higher than the average error in nominal condition due the ongoing faults in that time.

Table 4.5 Spin Motor - Intermittent fault profile and detection
Time (s) t <7 7 > t > 11 11> t > 12 12 > t >14 14> t > 16 16 > t > 18 18 > t > 20 , (V) 8 5 8 3 8 5 8 , () 0.029 0.020 0.029 0.020 0.029 0.020 0.029 Change/Fault Detection Time (s) 7.05 11.07 12.05 14.1 16.05 18.07

4.2.5 Spin Motor ­ Incipient fault Spin motor is considered to be in incipient fault scenario when the parameter of the spin motor system changes its value incrementally over time. In this simulation case, abrupt fault due to change in bus voltage of the spin motor 4, ,4 is considered. The fault is induced as an incremental function as shown in the table below.

Table 4.6 Spin Motor - Incipient fault profile and detection
Time (s) t < 13 13 > t > 20 , (V) 8 8-0.3(t-13) Change/Fault Detection Time (s) 13.8s

The results are shown in Figure 4.8. In this scenario the onset of fault is detected at 0.8  after the occurrence of the fault. This fault detection time is the slowest when compared to the all the other cases of faults. This was expected as the fault ramps up slowly to create an effect in the error in the same rate. Also, from the error plot, it is visually visible that the error increases with respect to time after the onset of fault.

65

Chapter 4 Fault Detection and Isolation

Figure 4.4 Simulation Results: Stall Fault of Gimbal Motor

66

4.2 Fault Detection Simulation Results

Figure 4.5 Simulation Results: Abrupt Fault of Spin Motor

67

Chapter 4 Fault Detection and Isolation

Figure 4.6 Simulation Results: Transient Fault of Spin Motor

68

4.2 Fault Detection Simulation Results

Figure 4.7 Simulation Results: Intermittent Fault of Spin Motor

69

Chapter 4 Fault Detection and Isolation

Figure 4.8 Simulation Results: Incipient Fault of Spin Motor

70

4.3 Fault Isolation

4.3 Fault Isolation
Once the fault is detected, it is necessary to locate/isolate the fault to identify which motor has failed and assist the controller reconfiguration algorithms appropriately. For a complex engineering system with several sub-systems and components, each component has to be monitored for fault. Using measurement data from individual components, fault isolation can be done by detecting faults at the component level. But in a system like small satellites, it is not always possible to measure the performance all the components (motors) individually as it requires lots of sensors, data handling and power.

Data Driven Model Gimbal motor 1 model Gimbal motor 3 model Gimbal motor 2 model Gimbal motor 4 model System Performance Measurement

Vector Model Spin motor 1 model Spin motor 3 model Spin motor 2 model Spin motor 4 model

f

-

+
Error

-

Minimize Error (Optimization) Obtain Fault Factors

Fault Isolation
Figure 4.9 Proposed Fault Isolation Scheme

Developing Fault Isolation algorithms that can work with satellite level measurements to isolate faults at a component level is quite challenging task but is ideal for small satellites. The system under consideration, i.e., CMG consists a total of 8 components (4 gimbal motors, 4 spin

71

Chapter 4 Fault Detection and Isolation motors). Fault isolation scheme is developed in such a way that it can isolate faults of 8 motors only with the attitude rate measurement data and no other additional measurement is required. 4.3.1 Hierarchical Methodology The proposed fault isolation algorithm in this thesis uses a hierarchical approach. This is to execute the proposed isolation algorithm only after the fault is detected and not run all the time so as to save computational power. The hierarchical scheme is shown in figure. First at a satellite level, fault is detected at AOCS subsystem and later the isolation algorithms will be executed to detect fault at component level. This hierarchical scheme is shown in Figure 4.10.

Satellite Subsystems

Structure

Thermal

AOCS

C&DH

Power

Communication

Payload

Fault Detection

GM 1

GM 2

GM 3

GM 4

SM 1

SM 2

SM 3

SM 4

Fault Isolation

Figure 4.10 Hierarchical Scheme

4.4 Optimization Problem Formulation:
A novel optimization based fault isolation algorithm is provided in this thesis which works by fusing data driven model with vector decomposition model. The novelty of the algorithm lies in the problem formulation. The objective function for the optimization is given by
  

  +   =  
=- =-

, | |, - 

(4.5)

, can be where , is the feature is extracted from the sensor measurement of the system,  called as the expected output,  is the summation of the elements of the matrix , |,  is the summation window and  is the sum of measurement and process |, -  noise. Each of the motors, whether it is a gimbal motor or a spin motor has an effect on angular

72

4.4 Optimization Problem Formulation: velocity. Hence expected output must be affected by all the motors used in CMG. Since angular velocity is additive, the angular velocity of the satellite is a sum of individual angular velocities imparted by motors on the satellite. It is noteworthy to mention here that the feature used here is also a measure of angular velocity and hence the vector properties of angular velocities would be preserved. At a high level, the expected output is given as a sum of effect of gimbal motors and spin motors. This can be written in equation form as follows.
  , , , =   +  

(4.6)

  3×4 is the matrix consisting the effect of all gimbal motors with each column where    3×4 is the matrix representing the expected feature from each gimbal motors and  consisting of the effect of all spin motors with each column representing the expected feature from each of the spin motors. The fault factor parameters for gimbal motors and spin motors are given by   1×4 and   1×4 respectively and these are the variables to be optimized. The gimbal motor components of Equation (4.6) can be expanded as follows.   = [  1,   = [1   2, 2   3, 3  ]  4, 4 ] (4.7) (4.8)

Each of the factors in 1  4 represents the fault factor for the gimbal motors from 1 to 4 respectively. Since gimbal motor is considered to undergo stall fault, i.e., stops performing 100%, the effect of gimbal motor would be either present if there is no fault (factor 1) or absent if there is a fault (factor 0). Since the fault effect for gimbal motor is 100%, the data driven model  ,     can be used as developed in chapter 3 for all the CMG systems,  ,    1, 2, 3, 4, a gimbal motor model for the equation (4.8). Once optimization finds the fault factors, the following logic is used to find if the gimbal motor is faulty or not. If  = 0  =  Else If  = 1  =    For spin motors, each of the factors in 1  4 represents the fault factor of spin motors from 1 to 4 respectively. Spin motor does not undergo 100% stop at once. When the fault occurs at spin motors, the wheel decelerates over time and hence it creates a change in the angular 73

Chapter 4 Fault Detection and Isolation velocity of the satellite. This change happens independent of the gimbal motor fault. Hence the effect of spin motor fault can be modelled separately and has to be added as another variable as  formulated in equation (4.6). Developing the model for expected output of the spin motors   is discussed below. 4.4.1 Vector Decomposition Model for Spin Motors Spin Motor operates the flywheel at a constant angular velocity that generates angular momentum due to gyroscopic effect. This effect has to be formulated mathematically to capture the spin motor model.

zB
Angular Momentum Vector Angular for Nominal Momentum Condition Vector for fault h 1 Condition

yB
w

h 1

GM


Change in Magnitude of Angular Momentum after onset of fault
1

Spin Motor 1

xB

Figure 4.11 Effect of Spin Motor Fault in Angular Momentum

Any spinning wheel produces an angular momentum based on the right hand thumb rule as shown in Figure 4.11. The magnitude of angular momentum depends on the inertia and the angular velocity of the wheel. As soon as the fault occurs in the spin motor, it reduces the angular velocity of the wheel which alters the angular momentum, thereby creating an unintended torque on the satellite. This unintended torque can be measured as a change in attitude angular velocity of the satellite and also in the extracted feature. This unintended change in angular velocity of the spacecraft due to the change in angular momentum of spin motor 1 as shown in Figure 4.11 can 74

4.4 Optimization Problem Formulation: be modelled as a unit vector given by the following equation. - cos 1 sin 1 0  cos 1 1, =  (-(90 - 1 )) (1 ) [1] 1 = [ ] 1 sin 1 sin 1 0 (4.9)

where    are the standard ,  rotation matrices for a right hand orthogonal reference frame that maps the vector from the frame of reference of flywheel to the satellite body frame. The scaling factor, 1 is to scale the unit vector into the actual fault magnitude. The scaling factor is considered as 1 = 1 in this thesis based on simulation results. From the equation (4.9) it is clear that the input for this model is only the gimbal command angle. The vector models for other spin motors can be given as follows. - cos 2 -1  2, = =  (90 - 2 ) (2 ) [ 0 ] 2 = [- cos 2 sin 2 ] 2 sin 2 sin 2 0 cos 3 sin 3 0  3, =  (90 - 3 ) (-3 ) [-1] 3 = [ - cos 3 ] 3 sin 3 sin 3 0 cos 4 1  =  (-(90 - 4 )) (-4 ) [0] 4 = [cos 4 sin 4 ] 4  4, sin 4 sin 4 0 The faults due to spin motors, can be written in a matrix form as follows.    1,  = [  = [1   2, 2   3, 3   4, ] 4 ] (4.13) (4.14) (4.10)

(4.11)

(4.12)

  3×4 is the matrix consisting of the effect of all spin motors with each column  representing the vector output feature of each of the spin motors and ,1  ,4 represents the fault factors for each of the spin motors from 1 to 4 respectively. The fault factors can be either 0 or 1. The logic based algorithm to isolate fault is shown below. If  = 1  =  Else If  = 0  =    If the spin motor is faulty it adds to the effect of angular velocity (fault factor 1) and if the spin motor is operating nominally, then there is no effect in angular velocity (fault factor 0). From 75

Chapter 4 Fault Detection and Isolation the equation (4.5)-(4.11), the objective function, and all the necessary models and equations to setup an optimization algorithm is derived. The next step is to select an optimization algorithm to find the faulty parameters and isolate fault based on the logic algorithms for the gimbal motors and the spin motors in a CMG.

4.5 Optimization Algorithm Selection
There are two categories in optimization methods such as deterministic methods and stochastic methods. Deterministic methods include gradient descent method, Newton's method, brute force search etc. (Horst, Reiner 2013). Stochastic methods include genetic algorithms, particle swarm optimization, simulated annealing etc. (Schneider 2006). Since deterministic methods move along a least cost path to find the optimal solution, there is a possibility that it may get stuck in the local minimum. Stochastic methods on the other hand search for the optimal solution in the entire search bounds. The stochastic methods, assures to find global optimal solution if iterated enough (Horst, Reiner 2013). Due to the robustness of stochastic methods to local minimum, it is decided to use one of the most commonly used stochastic methods, Genetic Algorithm. 4.5.1 Genetic Algorithm Genetic Algorithm (GA), is a stochastic optimization method that was first published in 1975 (Holland 1992). This is based on Darwin's Evolution theory which states that evolution is based on the natural selection and the fittest genetic pool that suits the environment survives for the next generation. This concept is mathematically formulated in an iterative way such that the fittest optimization parameters for a given objective function survives. The GA formulation creates a new set of optimization population (parameters) for every iteration based on the previous population and their fitness levels. New population generation from previous population involves biology based schemes such as the selection (selection of the best population for the next generation), crossover of chromosomes (breeding the current population to get a new set of population) and mutations of genes (altering the genes in a chromosome after breeding to get more diversity). The schematic of working of genetic algorithm is shown in Figure 4.12

76

4.5 Optimization Algorithm Selection
Generate Initial Population (Parameters to be Optimized)

Calculate Cost Function (for each Chromosome of population)
Selection of best Chromosomes (based on cost) Crossover/Mating of Chromosomes (To obtain next generation of population) Mutation of Chromosomes (To induce diversity in generated population) Stopping Criteria

Next iteration

End of Optimization
Figure 4.12 Genetic Algorithm Optimization Scheme

4.5.2 Initial Population and Cost function A population in an iteration/generation is a set of chromosomes in that generation. The total number of variables in a chromosome is equal to the total number of variables to be optimized. Each of the variables in a chromosome is called as gene. Initial population has to be generated so as to start the first iteration/generation of genetic algorithm. Generally the initial population are generated at random that lies within the operating bounds of the optimization parameters.  = [1  = [1 2 ...  ] ...  ] 2

Each set of chromosome from the initial population is evaluated for its performance based on the objective/cost function. Appropriate fitness function is very critical for the genetic algorithm optimization and its success. 4.5.3 Reproduction, Crossover and Mutation The main process of evolution happens at this stage of genetic algorithm where the survival of the fittest principle from Darwin's evolution is used. Each iteration in a genetic algorithm is called generation. Based on the evolution schemes, the population has to evolve in the best interests 77

Chapter 4 Fault Detection and Isolation of the cost function. This evolved parameters are the new set of population for the next iteration. There are three models for evolution such as reproduction, crossover and mutation. The idea behind each evolution is formulated in such a way that the population moves one step closer towards an optimal chromosome. Reproduction or selection is the method of choosing the best cost chromosome for the next generation. The best chromosomes are selected based on the cost performance. The selection of best chromosomes ensures that, in the next generation of population the cost will either improve or in worst case will remain the same. The new generation of best set of chromosomes that are selected after reproduction are also called as elite individuals. The crossover or mating is creation of new generation of chromosomes based on reproduction with two chromosomes from the previous generation. This method reproduces by mating one or more selected gene(s) of one chromosome with rest of the genes of other chromosome thereby generating a new generation of chromosome. Mutation is the last step in the evolution. After each generation of population is derived from the previous steps, mutation randomly changes the values of one or more randomly selected gene(s) of a chromosome. This random change ensures that the newly generated gene pool is as diverse as possible so that the entire sample space of the variable is considered. Mutation reduces fast convergence by ensuring the exploration of more range of optimization variables which is otherwise eliminated at reproduction and crossover stages. 4.5.4 Iteration and Stopping Criterion At each iteration/generation, the processes of reproduction, crossover and mutation are repeated. Since the best gene pool is generated at each iteration, the entire population shifts towards the fittest gene pool to satisfy the given cost function. The iteration has to be repeated until the stopping criterion is reached. Stopping criterion may be one of the three: Whether the set number of iterations have been reached, the cost function has reached to a required value, the average change in cost function is constant or very less than the previous change.

4.6 Fault Isolation Simulation Results
Based on the optimization formulation in section 4.4, fault isolation algorithm is executed using the genetic algorithm function available in MATLAB. The simulations were performed using the Dell Precision T3400 computer with Intel® CoreTM 2 Quad (Q6600) 2.39 GHz CPU with 78

4.6 Fault Isolation Simulation Results 6GB 800MHz, DDR2 ECC SDRAM. As an example, the simulation is performed considering both the Gimbal Motor 1 and Spin Motor 1 is faulty. The convergence of genetic algorithm is quick where the optimization algorithm converges to the optimal solution within 5 generations as shown in Figure 4.13. Algorithm run time is approximately 0.4 seconds for 30 generations. The stopping criterion for this algorithm is provided as 30 generations.

Table 4.7 Simulation Parameters for Fault Isolation Algorithm
Parameter Spin Motor Voltage [,1 Spin Motor Bus Voltage, [,1 Spin Motor Bus Voltage, [,1 ,2 ,2 ,2 ,2 ,2 ,2 ,2 ,3 ,4 ] ,4 ] ,4 ] ,4 ] ,4 ] [5 [8 [3 [0.029 [0.02 [2.4 [0 ,3 ,3 ,3 ,3 Value 5 8 3 5 8 3 5]  8]  3]  0.029]  0.02]  2.4] V 0] V

(Nominal Condition)

(Fault Condition) Spin Motor Current Constant, [,1 Spin Motor Current Constant, [,1 Gimbal Motor Voltage, [,1 Gimbal Motor Voltage, [,1

(Nominal Condition)

0.029 0.02 2.4 0

0.029 0.02 2.4 0

(Fault Condition) ,3 ,3 ,4 ] ,4 ]

(Nominal Condition)

(Fault Condition) Process Noise Standard Deviation (for  and ) ,  Measurement Noise Standard Deviation (for  and ),  Satellite Moment of Inertia,  Flywheel Moment of Inertia,  Initial Conditions: [1 0 Initial Conditions: [1 0 Initial Conditions: [1 0 2 0 2 0 3 0 ] 3 0 ] 4 0 ] 0.015 [ 0 0

10-4 10-3 0 0.017 0 [0  = [±0.04  = [±81 0 0 0 ]  2 0.020 0] ±0.04] rad/s ±81 ±81] °

10-5  2

Uniform Distribution: Range, ±0.04 ±81

2 0

3 0

Uniform Distribution: Range,

Time of fault

Uniform Distribution: Range,  = 3s to 8s

79

Chapter 4 Fault Detection and Isolation The simulation parameters are shown in the Table 4.7. All the conditions for nominal and faulty conditions that are used for the motor are provided. Since the simulation has to be performed for different conditions, a uniform random distribution is used. The range of values for gimbal command angles are given as ±81° to simulate the entire sample space of gimbal motor operation. The quaternions are not varied as the attitude position information is not an input variable for the isolation algorithm and not affected by the attitude position. The time of fault and other values are given in Table 4.7. As shown in Figure 4.13, the GA optimization converges close to zero after removing the average noise value. This can be calculated from the history of data as  =-  = 0.8. Ideally the convergence must be equal to zero, but due to the uncertainties in noise and small errors in the data driven model of Gimbal motor, the cost function for an optimal solution may never be equal to zero.

Figure 4.13 Genetic Algorithm Optimization Convergence

As there are a total of 8 motors, the total number of fault cases would be 28 = 256. In fault isolation algorithm, the main challenge is to locate the faulty motor correctly. The results of isolation can be shown in the form of a confusion matrix. For ease of displaying results, the fault cases are divided as shown in Table 4.8. The cases are divided based on the number of motors that becomes faulty at a time. Simulations were performed using the simulation parameters as given in Table 4.8 considering any 1 motor becomes faulty, any 2 motors becomes faulty and so on. Each case is simulated for 200 random simulation parameters and the performance of the 80

4.6 Fault Isolation Simulation Results isolation algorithm is shown in Table 4.8. The accuracy for each case is based on the confusion matrix from Table 4.9 to Table 4.16. The algorithm isolates fault with 93.25% accuracy for a total of 1600 simulations cases performed with random simulation conditions. It has to be noted that the simulation has been performed only for the conditions given in the Table 4.7. The accuracy of the algorithm shown in Table 4.8 pertains to the range of the uniformly distributed system parameters. Furthermore, if the parameters such as measurement noise, process noise, initial attitude angular velocity, number of Monte Carlo simulations, etc., are changed the accuracy of the algorithm as presented in Table 4.8 may change. From the results in Table 4.8, it can be seen that the proposed algorithm performs with better accuracy when the number of motors that becomes faulty increases. This may be due to the fact that the increase in faulty motors reduces the redundancy in performance. From the confusion matrix it is clear that the algorithm clearly distinguishes between the gimbal motor fault and the spin motor fault. This may be due to the fact that the performance of the faulty gimbal motor and the performance of the faulty spin motor are different and may not be redundant. The algorithm were able to isolate faults in the spin motor more accurately than the gimbal motor faults. In terms of GM faults there are cases where the algorithm confuses the fault of GM 2 with GM 4, etc. This may be due to the fact that, CMG is pyramid configuration is a redundant actuator system where in some cases, the fault in one of the motor produces the same change in angular momentum in a satellite as if the other motor has become faulty. The confusion in isolation occurs in case of redundancy.
Table 4.8 Performance of Isolation Algorithm
No. of faulty Motors 1 2 3 4 5 6 7 8 No. of Cases 81 = 8 82 = 28 83 = 56 84 = 70 85 = 56 86 = 28 87 = 8 88 = 1 Accuracy 87.63 % 85.5 % 88 % 93.5 % 93.5 % 98.75 % 98.75 % 100 %

Total Cases Overall Accuracy 256 93.25 % Note:  represents the combination formula of n objects taken r at a time

81

Chapter 4 Fault Detection and Isolation
Table 4.9 Confusion Matrix: Any 1 Motor becomes faulty
Actual
Identified GM 1 GM 2 GM 3 GM 4 SM 1 SM 2 SM 3 SM 4 GM 1 100 9 3 8 0 0 0 0 GM 2 0 91 3 17 0 0 0 0 GM 3 0 0 94 0 0 0 0 0 GM 4 0 0 0 75 0 0 0 0 SM 1 0 0 0 0 92 18 0 3 SM 2 0 0 0 0 8 82 25 6 SM 3 0 0 0 0 0 0 75 0 SM 4 0 0 0 0 0 0 0 91

Table 4.10 Confusion Matrix: Any 2 Motors becomes faulty
Actual
Identified GM 1 GM 2 GM 3 GM 4 SM 1 SM 2 SM 3 SM 4 GM 1 89 0 10 16 0 0 0 0 GM 2 11 67 0 8 0 0 0 0 GM 3 0 0 90 8 0 0 0 0 GM 4 0 33 0 68 0 0 0 0 SM 1 0 0 0 0 100 5 4 2 SM 2 0 0 0 0 0 95 17 1 SM 3 0 0 0 0 0 0 79 1 SM 4 0 0 0 0 0 0 0 96

Table 4.11 Confusion Matrix: Any 3 Motors becomes faulty
Actual
Identified GM 1 GM 2 GM 3 GM 4 SM 1 SM 2 SM 3 SM 4 GM 1 92 36 18 13 0 0 0 0 GM 2 8 64 0 0 0 0 0 0 GM 3 0 0 73 13 0 0 0 0 GM 4 0 0 9 75 0 0 0 0 SM 1 0 0 0 0 100 0 0 0 SM 2 0 0 0 0 0 100 0 0 SM 3 0 0 0 0 0 0 100 0 SM 4 0 0 0 0 0 0 0 100

82

4.6 Fault Isolation Simulation Results
Table 4.12 Confusion Matrix: Any 4 Motors becomes faulty
Actual
Identified GM 1 GM 2 GM 3 GM 4 SM 1 SM 2 SM 3 SM 4 GM 1 100 3 0 0 0 0 0 0 GM 2 0 93 0 0 0 0 0 0 GM 3 0 3 93 0 0 0 0 0 GM 4 0 0 7 93 0 0 0 0 SM 1 0 0 0 0 90 7 0 0 SM 2 0 0 0 0 10 93 0 0 SM 3 0 0 0 0 0 0 95 9 SM 4 0 0 0 0 0 0 5 91

Table 4.13 Confusion Matrix: Any 5 Motors becomes faulty
Actual
Identified GM 1 GM 2 GM 3 GM 4 SM 1 SM 2 SM 3 SM 4 GM 1 97 8 0 0 0 0 0 0 GM 2 3 84 3 0 0 0 0 0 GM 3 0 8 84 5 0 0 0 0 GM 4 0 0 14 95 0 0 0 0 SM 1 0 0 0 0 97 2 0 0 SM 2 0 0 0 0 3 98 0 0 SM 3 0 0 0 0 0 0 98 3 SM 4 0 0 0 0 0 0 2 95

Table 4.14 Confusion Matrix: Any 6 Motors becomes faulty
Actual
Identified GM 1 GM 1 GM 2 GM 3 GM 4 SM 1 SM 2 SM 3 SM 4 100 4 0 0 0 0 0 0 GM 2 0 96 0 0 0 0 0 0 GM 3 0 0 100 0 0 0 0 0 GM 4 0 0 0 100 0 0 0 0 SM 1 0 0 0 0 100 2 0 0 SM 2 0 0 0 0 0 98 0 0 SM 3 0 0 0 0 0 0 100 4 SM 4 0 0 0 0 0 0 0 96

83

Chapter 4 Fault Detection and Isolation
Table 4.15 Confusion Matrix: Any 7 Motors becomes faulty
Actual
Identified GM 1 GM 1 GM 2 GM 3 GM 4 SM 1 SM 2 SM 3 SM 4 100 4 0 0 0 0 0 0 GM 2 0 96 0 0 0 0 0 0 GM 3 0 0 100 0 0 0 0 0 GM 4 0 0 0 100 0 0 0 0 SM 1 0 0 0 0 100 2 0 0 SM 2 0 0 0 0 0 98 0 0 SM 3 0 0 0 0 0 0 100 4 SM 4 0 0 0 0 0 0 0 96

Table 4.16 Confusion Matrix: All 8 Motors becomes faulty
Actual
Identified GM 1 GM 1 GM 2 GM 3 GM 4 SM 1 SM 2 SM 3 SM 4 100 0 0 0 0 0 0 0 GM 2 0 100 0 0 0 0 0 0 GM 3 0 0 100 0 0 0 0 0 GM 4 0 0 0 100 0 0 0 0 SM 1 0 0 0 0 100 0 0 0 SM 2 0 0 0 0 0 100 0 0 SM 3 0 0 0 0 0 0 100 0 SM 4 0 0 0 0 0 0 0 100

4.7 Summary
In first part of this chapter, the data driven model developed in chapter 3 was utilized to develop a threshold based fault detection algorithm. The time of fault detection for all types of faults were given in the simulation results. The plots for all cases of fault has been provided. In the second part of the chapter, a novel optimization based fault isolation algorithm was proposed and the formulations were derived. From extensive simulation results, it was concluded that the proposed isolation algorithm performs with 93.25% accuracy for the given random simulation conditions.

84

CHAPTER 5 5. Fault Prognosis
Prognosis is estimating the remaining useful life of the system. A system is considered to be failed if it completely stops performing the required task or the performance is degraded in such a way that it is no longer useful for the system. System may degrade due to wear and tear or after the onset of fault. In both the cases predicting the degradation/remaining useful life is essential to plan the preventive maintenance tasks on time. In satellites, prediction of remaining useful life of attitude actuators assists engineers in control reconfiguration and/or other maintenance planning promptly. This eliminates the possibility of total loss of mission due to actuator failures. In this thesis, degradation of the actuator is considered to occur after the onset of fault and hence the placement of prognosis algorithm comes after the FDI module as shown in Figure 5.1.

Fault Diagnosis

Prognositics

Plant

Inputs
Data-Driven Model

Residuals

Fault Detection

Fault Isolation

Fault Prognosis/ RUL Estimation

Figure 5.1 Placement of Fault Prognosis Module in a data Driven DPHM system

In terms of satellite CMG actuator system, most of the failures happened in the past cases are related to momentum/spin wheel motors (Malik 2005). Normally, the space grade spin motors are expected to work for the total mission of the satellite or at least 10 ­ 20 years without any reliability issues (Gurrisi 2010). Based on literature review, the works that have been done in the past on the prognosis of spin motors are based on component level measurements such as temperature, vibration, lubricant properties, etc. Since component level sensors may not be available in small satellites, an error based prognosis scheme is developed in this chapter that can estimate the remaining useful life of momentum wheel only based on attitude rate measurements of the satellite. 85

Chapter 5 Fault Prognosis

5.1 Data Driven Prognosis
As discussed in literature survey of chapter 1, data driven prognosis models are developed based on history of run to failure data. In this chapter, the run to failure data is generated manually using the dynamic equations from chapter 2 and data-driven model from chapter 3. The scheme for data-driven prognosis used in this chapter is shown in Figure 5.2. The history of run to failure data is obtained at the first step. Then the feature is extracted from the data as mentioned in Equation (3.1) so as to eliminate the dependancy of data on the intial conditions and also to eliminate the noise upto a certain level. General path model is used to obtain the apriori model parameters for the historical data. Based on the apriori knowledge, any new measurement oncoming to General path model will predict the remaining useful life of the spin motor. Each stage of the prognosis scheme is explained in the following sections of this chapter.

History of Run to Failure (RUL) Data Data Driven Model (Expected Output) f

Measurement data from System/Plant f Data Driven Model (Expected Output)

f

Feature Extraction Error

+/- Error

+/-

Apriori knowledge for model parameters

General Path Model

Fault Prognosis/ Remaining Useful Life Estimation

Figure 5.2 Fault Prognosis Scheme

86

5.2 Failure Degradation Model

5.2 Failure Degradation Model
The spin motor consists of the motor assembly, bearings, shell etc. The list of failures in momentum wheels are shown in Figure 5.3 (Wang et al. 2016). Based on the statistics of history of failures in a momentum wheel by (Wang et al. 2016), the highest number of failures have occurred due to bearings. It is critical to understand the health of the bearings to understand the health of the momentum wheel components. The main causes of bearing wheel assembly failures are due to excessive/insufficient lubrication, insufficient/excessive preloading, etc. This affects the friction properties of the bearing and thereby creating an undesired frictional torque. 40

Faults Number

30

20
10 0

Body Shell Motor Bearing Assembly Assembly Assembly Assembly Assembly Type

Control Circuit

Other

Figure 5.3 Statistics of Momentum Wheel Faults

The indicators of these faults will be evident in the performance of the spin motor in terms of speed, current and the temperature (Wang et al. 2016). The faults due to change in speed and current can be modelled using the Spin motor bus voltage  and the torque gain  . The degradation of these two parameters denote the failure degradation of the spin motors. Hence, to generate the history of run to failure data, the degradation of the  and  has to modelled (Sobhani-Tehrani & Khorasani 2008). Based on the literature survey on electric motors, rotating bodies (Ciandrini et al. 2010; Rocchi et al. 2014; Hacker et al. 2015) and the degradation models used (Nguyen et al. 2017), the degradation of the spin motor is modelled as an exponential function. The exponential degradation model for the bus voltage  and the torque gain  is given by _ = 1 - 1 ×  1 _ = 2 - 2 ×  2  (5.1) (5.2)

where  represents the timestamp. In this study, the timestamp is the number of days. The 87

Chapter 5 Fault Prognosis parameters 1 , 2 , 1  2 represents the parameters of the exponential model which controls the effect of degradation. The parameters 1  2 represent the onset of fault and are selected as 0.02   3  respectively from chapter 4. The motor is assumed to reach end of life if either the _ = 2.25  or _ = 0.01 , whichever is earlier. A sample plot for one of the cases of _   _ degradation model is shown in Figure 5.4.

Figure 5.4 Degradation Model

As seen in the Figure 5.4, the _ reaches the failure point after 550 days, _ reaches the failure point around 475 days. In this case, the end of life the spin motor would be 475 days.

5.3 Data Acquisition
Any degradation in the performance of the spin motor affects its rotational velocity thereby affecting the momentum capacity of the CMG. This affects the attitude angular velocity of the satellite that can be measured as error between the expected performance and the actual performance. The error will be proportional to the level of degradation. Using the simulation parameters mentioned in the Table 5.1, simulations were performed to collect run to failure data of satellite for different cases of exponential model parameters 1  2 to understand various levels of degradation.

88

5.3 Data Acquisition
Table 5.1 Simulation Parameters for Prognosis Data Collection
Parameter Spin Motor Voltage [,1 Spin Motor Bus Voltage, [,1 ,2 ,2 ,2 ,2 ,3 ,4 ] ,4 ] ,4 ] [5 [  [2.4 ,3 ,3 ,3 Value 5 5 5]  8 8 8]  0.029]  0.029 2.4] V [  0.029 2.4 2.4

Spin Motor Current Constant, [,1 Gimbal Motor Voltage, [,1

,4 ]

  parameters [1 1 ]   parameter 1   parameters [2 2 ]   parameter 2
Process Noise Standard Deviation (for  and ) ,   Measurement Noise Standard Deviation (for  and ),  Satellite Moment of Inertia,  Flywheel Moment of Inertia,  Initial Conditions: [1 0 Initial Conditions: [1 0 Initial Conditions: [1 0 2 0 2 0 3 0 ] 3 0 ] 4 0 ] 0.015 [ 0 0

[0.02 

0.6]

2 × 10-4 to 10 × 10-4 [3  0.6]

3.08 × 10-2 to 15.4 × 10-2 10-3 10-4 0 0.017 0 [0 [0.04 [0 0 0 0 0 0 ]  2 0.020 0] 0] 0]

10-5  2

0.02

2 0

3 0

Figure 5.5 Run to Failure Data for two cases

89

Chapter 5 Fault Prognosis

Feature is extracted from the data based on the Equation (3.1) and the errors are obtained using Equation (4.1). Few cases of error measurement due to the degradation of the spin motor 1 is given in Figure 5.5. As shown in the Figure 5.5, the system reaches end of life at around 275 days and 475 days for two different cases. Similarly several cases of error values are generated as and are collected as history of run to failure data.

5.4 General Path Model
General Path Model (GPM) was first proposed for degradation modelling to shift the reliability analysis from the time-of-failure analysis to the process-of-failure analysis (Lu et al. 1993). Generally the reliability estimation is based on the time of failure from accelerated testing data. But the general path model estimates the distribution of time of failure for identical components. The general path model for degradation of a unit  at a time  is given by , = (, ,  ) + , (5.3) Where  is a vector of effects due to fixed population and  is the effect due to random population for the   component and , is the standard error term due to measurement. The variable,  is the degradation function. In order to use the GPM model the following conditions must be met (Coble & Hines 2008). 1. There must be a function/model that could capture the degradation dynamics (, ,  ) of a system under study. This function may be a data-driven model or physics based model. 2. The history of degradation data must be available and must be from an identical component or system. 3. The historical data must have almost all the data for the entire range of variations of individual components and also the data must be collected under similar use. 4. There must be a specific failure criterion available for the marking the end of life of the system. The failure criteria may be obtained using the history of run to failure data or may be from the engineering experience. 5.4.1 Criterion for using General Path Model A data containing run to failure information of a system must have the following three characteristics to be used with general path model: (1) Monotonicity, (2) Prognosability and (3) 90

5.4 General Path Model Trendability (Coble 2010). Monotonicity characterizes the trend of the data. The data must have an upward/downward trend throughout the degradation time. This means that if the system starts degrading, it should not recover from the current degradation level by itself. Recovery is acceptable up to a certain extent but may disrupt the GPM prediction. For example, crack propagation in a material is not recoverable and is an ideal example for using GPM. But in case of some batteries, they self-heal if not used for a certain period of time in which GPM may not work properly. The formula for monotonicity is given by (Coble 2010).  =  ( () () - )  - 1  - 1 (5.4)

where  is the total number of data points and  () and  () represents the number of positive values and negative values in the data respectively. The monotonicity also explains the shape of the curve up to a certain extent. The higher the monotonicity value, the higher the discipline of the degradation data in terms of following the upward/downward trend. Prognosability is related to the measure of the spread of end/failure values across all the run to failure datasets. It is calculated as the ratio of standard deviation of failure values to the mean of the difference between failure values with start values. It is given by the following formula (Coble 2010).   Prognosability = exp ( )  (  -  ) (5.5)

The exponential given in the above equation scales the calculated values between 0 and 1. The higher the prognosability value, the lower the spread of stopping/failure values and there will be no ambiguity for selecting a single stopping criterion value. Trendability finds the trend of the data. Monotonicity just finds out if the dataset is following an upward trend or lower trend. But trendability calculates the correlation of data with respect to time. Monotonicity parameter won't give a clear picture regarding the noise of the data. If the data is noisy, linear correlation is not possible indicating that the slope of data is almost 0. The formulation for trendability is given by (Coble 2010) Trendability = min(() ),  = 1   (5.6) Where  represents the total datasets available and  represents the correlation coefficient of each dataset. The minimum correlation gives the worst possible correlation value among the entire dataset. The examples for a dataset with good GPM parameters and bad GPM 91

Chapter 5 Fault Prognosis

parameters are given in (Coble 2010). For the best possible results from the general path model, the values of Monotonicity, Prognosability and Trendability must be close to 1. Generally, for a 80% noisy dataset, the acceptable values are close to 0.7 (Coble 2010). In the history of run to failure datasets obtained for satellite, the values of Monotonicity, Prognosability and Trendability were above 0.7. 5.4.2 Function used for GPM Since the degradation model used for data generation is an exponential model, it is natural to assume that the same function can be utilized as a general path model function. But as mentioned in literature (Coble & Hines 2008), the exponential model is not very robust to noise as compared to polynomial models. Hence a quadratic polynomial is used as a function for fitting the run to failure data. A general polynomial function is given by the equation  = 1  0 + 2 1 +  +   -1 (5.7) where  is the predicted output and  is the input and  is the parameter of the function which has to be determined after curve fitting/training. The above equation can be written in matrix form for the entire dataset as follows  =   = [1 2 ...  ]
  = [1 2 ...  ] 11 12 ... 1 21 22 ... 2  = [     ] 1 2  

(5.8) (5.9) (5.10)

(5.11)

where m represents the number of datasets and n represents the number of polynomials used. To curve fit a data by using the function given in equation (5.8), the parameters matrix  has to be obtained. Using the least squares error method, parameter can be obtained as
-1 -1 -1  = (  y  )   y  2 1 0 y =  0 [

(5.12)

0 2 2  0

... 0 ... 0   2   ]

(5.13)

 is the estimated parameter matrix after curve fitting and the y variance-covariance noise where 

92

5.5 Curve Fit Results matrix that gives the noise information for each entry in the  matrix. The variance for each entry in y can be calculated using the historical run to failure dataset.

5.5 Curve Fit Results
Based on the formulations provided in section 5.4.2, the dataset was fit and the parameters obtained are given in Table 5.2. Since this is a quadratic fit, there will be three parameters. The parameter 1 is a constant term in the polynomial function. This parameter is a representative of the average starting value of the dataset or in other words the initial level of degradation. Since the variance is very low for parameter 1, this means that the initial fault level for all the data are almost equal. This was expected since the dataset used here all start with same level of initial fault. This table of parameters are the apriori information for the prognostic GPM model. The fit results for few cases are shown in Figure 5.6 and Figure 5.7.
Table 5.2 Curve fit Results/Apriori Parameters
Parameter 1 2 3 Mean(Parameter), 0.1057 -3.1227 × 10-5 3.8692 × 10-7
2 Variance, 

1.1085 × 10-5 4.9156 × 10-10 2.8676 × 10-14

Figure 5.6 GPM fit : Case 1

93

Chapter 5 Fault Prognosis

Figure 5.7 GPM fit : Case 2

5.6 Bayesian Updating
In a real-time system, only partial data will be available as the system just started degrading. The Online Prediction results using the partial data is shown in Figure 5.8. This is not predicting the RUL appropriately as the few data points does have a particular trend to follow. Bayesian updating technique will be helpful in these cases. Bayesian updating scheme allows the GPM model to use the apriori parameter information from Table 5.2 and use them for the online prediction. The formulation for using Bayesian update procedure in a quadratic function is given in (Coble 2010). Additional information on Bayesian statistics can be found in literature (LOUIS 2000; Gelman, A., J. Carlin, H. Stern 2004). The formulation for Bayesian updating is given below. The matrix   represents the output matrix with Bayesian updating,   is the input matrix with bayesian
 updating and y is the variance covariance noise matrix with bayesian updating.

  = [1

2





1

2





]

(5.14) (5.15)

  = [
 y = [

× ] ×
2 2

y

0×

×

0× Var×

], = [2 1

 2  ]

(5.16)

94

5.6 Bayesian Updating

Timestamp (Day) Figure 5.8 Prediction Without Bayesian Update

Timestamp (Day) Figure 5.9 Prediction With Bayesian Update

95

Chapter 5 Fault Prognosis

Apriori parameters must be added on the output matrix as shown in the equation (5.14). The variance of the apriori parameters must be added in the variance-covariance noise matrix as shown in the equation (5.16). And finally an identity matrix is added to the Input matrix as shown in equation (5.15). This type of formulation ensures that the apriori parameters are utilized whenever less data is available for real-time prediction. Figure 5.9 shows the prediction of RUL of spin motor with Bayesian updating. 5.6.1 Stopping Criterion The failure/stopping criterion determines the end point of failure while prediction. The failure criterion of the general path model is selected based on the history of failure data. If the failure criterion is high, the prediction model may predict the end of life higher than the actual value and it is not desirable. A threshold of 0.14 is taken based on the average of upper 90% distribution of failure values. This will give a better reliability and may avoid overestimation of RUL (Coble 2010).   = 0.14 (5.17)

5.7 RUL prediction and Results
The RUL prediction is run for three sample cases and the results are tabulated in Table 5.3. It is clear from the table that, the performance accuracy increases with the increase in available data. This is due to the fact that as more data becomes available, the prediction algorithm gets more information on the current degradation dynamics to predict the performance. When 20% of data is available the accuracy is around 87% but when 30% data is available, the accuracy suddenly increases to 96%. When available data is 20%, the current degradation dynamics would be difficult to comprehend by the GPM model and the prediction is mostly based on the apriori information. If 30% data is available, the performance accuracy improves to 96.17% as more information on degradation is available for the GPM to comprehend. The more the data, the prediction accuracy is better. The plots of RUL prediction for few sample cases are shown from Figure 5.10 to Figure 5.12. The prediction was performed using MATLAB tool using the Dell Precision T3400 computer with Intel® CoreTM 2 Quad (Q6600) 2.39 GHz CPU with 6GB 800MHz, DDR2 ECC SDRAM. The computational time for one prediction from initialization to results calculation takes around 0.3s. 96

5.8 Summary
Table 5.3 RUL Prediction Results for different levels of available data
TRUE RUL 382 306 292 GPM + Bayesian Estimated RUL With 20% available data 299 278 268 87 % With 30% available data 364 302 276 96.25% With 50% available data 396 311 298 98.5%

Random Cases

1 2 3 Accuracy %

In a statistical perspective of prediction, there is a measure called Prediction Interval (PI) which is a measure of upper and lower bounds of confidence intervals for prediction. These values provide with the estimate of confidence intervals for future observations based on the required confidence. The formula for prediction interval is given by  =  ±     (5.18) where  is the normal distribution curve value for the required confidence interval. In this case, 90% confidence interval value is used which means the value of  = 1.64. The values of mean and standard deviation are based on the historical data points for that particular timestamp under study. The PI bounds are given for all the cases of prediction results from Figure 5.10 to Figure 5.12. It can be seen from the figure that the confidence interval increases with respect to increase in prediction timestamp.

5.8 Summary
The run to failure data collection methodology for the prognosis of a spin motor in a CMG system was provided. A quadratic model was used for curve fitting the data. Using the curve fitted model parameters as apriori information, Bayesian updating technique is used to predicting remaining useful life of a system in real time. The algorithm performs with 96.25% accuracy when 30% of data is available for online prediction. The results were also tabulated and few result plots were provided.

97

Chapter 5 Fault Prognosis

Timestamp (Day)

Timestamp (Day) Figure 5.10 Performance of GPM Model with 20% of available data

98

5.8 Summary

Timestamp (Day)

Timestamp (Day) Figure 5.11 Performance of GPM Model with 30% of available data

99

Chapter 5 Fault Prognosis

Timestamp (Day)

Timestamp (Day)

Figure 5.12 Performance of GPM Model with 50% of available data 100

CHAPTER 6 6. Conclusion
For an AOCS of a satellite, timely discovery of faults and failures are essential for an autonomous fault tolerant control system. The DPHM framework inspired from literature were discussed which consists of fault detection, fault isolation and prognosis. The fault detection module of DPHM framework must detect anomalies in the system based on the measurement plant parameters. Fault isolation module must locate the fault in the plant based on the available state measurements of the system. The fault detection and isolation module in combination is called fault diagnosis. Various fault diagnosis methods that are available in literature were discussed in Chapter 1. Next module of the DPHM would be fault prognosis. This module estimates the remaining useful life of the system after the onset of fault. Types of fault prognosis methods are discussed in chapter 1. These three modules in DPHM is essential for engineers to take corrective action and avoid downtime or the total loss of system due to faults and failures. The problem of fault detection, isolation and prognosis for a satellite actuator subsystem that uses single gimballed CMG in a pyramid configuration is dealt from chapters 3 to 5. For all of the three modules, algorithms were provided that can successfully diagnose and estimate RUL of the components after onset of fault. Based on literature survey and considering a satellite with limited space and computation budget, an algorithm that can work with limited measurement information and also with minimum computational power is essential for onboard DPHM framework. The proposed algorithms for all three modules of DPHM framework were developed such that it can work with limited information and less computational power.

6.1 Summary of Contributions
The contributions in the thesis in terms of data-driven model development and all the three modules of DPHM framework such as fault detection, isolation and prognosis are given as follows. 6.1.1 Data-Driven Model Development For developing a data driven model, an extensive historical dataset is essential. This means that for training the dataset, a lot of computational power is required which may not be available in a small satellite. 101

Chapter 6 Conclusion

To tackle this problem, a novel framework for data acquisition is provided in Chapter 3 which reduces the need for extensive history of data. The framework fuses data driven model with two properties. (1) Symmetric property at component level (Single CMG) is utilized which reduces the need for component level data by three-fourth, (2) System orientation property of the pyramid configured CMG actuator system is utilized where the data of a single CMG can be mapped to other three CMGs. This reduces the need for data by three-fourth at a system level. The proposed framework after fusing the two properties, reduces the need for data by 93.75%. A simple feature extraction technique is provided, which reduces noise and the dependency of data on the initial state of the spacecraft. Also the data is trained using Chebyshev Neural Network (CNN) which is computationally light for training when compared to other ANNs. 6.1.2 Fault Detection For fault detection of CMGs a threshold based fault detection algorithm is used in chapter 4. The problems observed in literature review were addressed in this chapter. The algorithms proposed in literature either needs component level measurements which may not be available in small satellites or did not consider the complete actuator dynamics of the satellite. To address this problem, fault detection algorithm is developed in such a way that it only requires the attitude rate information at the satellite level and considers the complete satellite and actuator dynamics including the gimbal motor and the spin motor dynamics. The algorithm works for all types of spin motor faults such as abrupt, transient, intermittent faults and stall fault of the gimbal motor. 6.1.3 Fault Isolation Based on literature survey, it can be inferred that there are no fault isolation algorithms for CMG's that considers the complete actuator dynamics and can work only with satellite level measurements. To address this problem, a novel optimization based fault isolation formulation is proposed in chapter 4 which can work with attitude rate measurements considering complete attitude dynamics of the satellite. The proposed isolation algorithm can isolate faults of all 8 motors used in the CMG system. Since there are 8 motors, it may fail in 28 = 256 different ways. Extensive simulations have been performed inducing faults in random to verify the accuracy of the algorithm. The proposed optimization based isolation method has an overall accuracy of 93.5% for different cases of fault simulated.

102

6.2 Future Work 6.1.4 Fault Prognosis The fault prognosis algorithms available in literature requires the rotational and vibrational measurements from the motors used in satellites. But as mentioned earlier, component level measurements may not be available small satellites. In chapter 5, an error/residual based scheme for fault prognosis is provided that works only using the attitude rate measurements from the satellite. General Path Model (GPM) which is one of the computationally light algorithms, is used to develop a tool for estimating the Remaining Useful Life (RUL) of the spin motor. Apriori knowledge is applied to the GPM using Bayesian updating technique. Based on simulation of different cases, it can be concluded the algorithm estimates the RUL with an overall accuracy of 96.25% when 30% data is available. Complete attitude and actuator dynamics is used for development of this algorithm.

6.2 Future Work
Considering the demand for autonomous DPHM algorithms onboard machinery/plant, a range of research can be executed as an addition or improvement from the contributions provided in the thesis. A few of them are outlined below. (1) Performing Hardware-In-Loop (HIL) / Process-In-Loop (PIL) Simulations: The proposed algorithm performs well in MATLAB simulations performed in a desktop computer. But for the satellite in orbit, the algorithm has to perform on the Onboard Computer (OBC). Hence the algorithm has to be tested on different processors using HIL/PIL Simulations to investigate its performance real-time. (2) Expanding form single to dual/three axis gimbal & variable CMGs: The proposed algorithms work for a single gimballed CMG in pyramid configuration. But it would be interesting to extending the proposed framework for a dual or three axis gimballed system. This will increase the redundancies in the satellite level measurements which may affect the performance of fault isolation algorithm. In the thesis, a constant spinning momentum wheel is considered. But it would be interesting to explore the proposed framework to variable speed momentum wheels (also called as Variable CMGs). (3) Expanding from small satellites to large satellites: The process noise and disturbance torques considered in this thesis pertains to small satellites where their magnitudes may not be quite high as large satellites like ISS. If the noise and disturbances are quite high, use of filters or hybrid approaches along with the proposed algorithm is recommended. 103

Chapter 6 Conclusion

(4) Satellites in Formation Flying / Multi-agent Systems: Intuitively, the proposed algorithm must work for a decentralized formation flying satellite as each satellite in this type of formation will have its own AOCS system measurements and OBC. But in terms of centralized formation flying, the satellite may only have relative attitude measurements. It would be interesting to explore the modifications required in the proposed framework for applying them to centralized and semi-centralized formation flying. (5) Implementation in other similar systems: Although, the algorithm developed here is implemented for a CMG actuator in satellite, the author believes that it can be implanted in similar systems with minimal or no modifications. Some of the examples of similar systems include AOCS with Reaction Wheels, AOCS with Magnetorquers, attitude control in Quadcopters, attitude control of aircrafts, direction control system in autonomous automobiles, etc.

104

References
Abreu, N., 2010. Fault Diagnosis with Adaptive Kalman Filters and CMG Design for Picosatellite ACS. Master's Thesis, Department of Aerospace Engineering, Ryerson University. Available at: http://digital.library.ryerson.ca/islandora/object/RULA:1148. Aerospaziali, P. d. M.D. di S. e T., 2015. Magnetic satellite detumbling: The b-dot algorithm revisited. In American Control Conference (ACC). Chicago. Al-zyoud, I.A. & Khorasani, K., 2006. Neural Network-based Actuator Fault Diagnosis for Attitude Control Subsystem of a a Satellite. In Automation Congress. IEEE. AlliedMarketResearch, 2017. Small Satellite Market by Type, Application, End User - Global Opportunity Analysis and Industry Forecast, 2014 - 2022, An, D., Kim, N.H. & Choi, J.H., 2015. Practical options for selecting data-driven or physics-based prognostics algorithms with reviews. Reliability Engineering and System Safety, 133, pp.223­ 236. Available at: http://dx.doi.org/10.1016/j.ress.2014.09.014. Barua, A. & Khorasani, K., 2011. Hierarchical fault diagnosis and fuzzy rule-based reasoning for satellites formation flight. IEEE Transactions on Aerospace and Electronic Systems, 47(4), pp.2435­2456. Barua, A. & Khorasani, K., 2007. Intelligent model-based hierarchical fault diagnosis for satellite formations. Conference Proceedings - IEEE International Conference on Systems, Man and Cybernetics, pp.3191­3196. Biagetti, T. & Sciubba, E., 2004. Automatic diagnostics and prognostics of energy conversion processes via knowledge-based systems. Energy, 29(12­15 SPEC. ISS.), pp.2553­2572. Bialke, B., 1998. High Fidelity Mathematical Modeling of Reaction Wheel Performance. In Annual AAS Rocky Mountain Guidance and Control Conference, Advances in the Astronautical Sciences, pp. 483­496. Bodson, M., Sato, J.S. & Silver, S.R., 2006. Spontaneous speed reversals in stepper motors. IEEE Transactions on Control Systems Technology, 14(2), pp.369­373. Bouzid, M.B.K. & Champenois, G., 2013. New expressions of symmetrical components of the induction motor under stator faults. IEEE Transactions on Industrial Electronics, 60(9), pp.4093­4102. Byington, C. & Stoelting, P., 2004. A Model-Based Approach to Prognostics and Health Management for Flight Control Actuators". IEEE Aerospace conference, pp.3551­3562. Carrasco, M.M., 2016. Attitude Determination for Low Cost IMU and Processor Board using the Methods of TRIAD , Kalman Filter and Allan Variance. , pp.26­41. 105

Conclusion Cheng, Y., Wang, R. & Xu, M., 2016. A Combined Model-Based and Intelligent Method for Small Fault Detection and Isolation of Actuators. IEEE Transactions on Industrial Electronics, 63(4), pp.2403­2413. Choi, Y.C., Son, J.H. & Ahn, H.S., 2015. Fault detection and isolation for a small CMG-based satellite: A fuzzy Q-learning approach. Aerospace Science and Technology, 47, pp.340­355. Available at: http://dx.doi.org/10.1016/j.ast.2015.10.006. Ciandrini, C. et al., 2010. Fault detection and prognosis methods for a monitoring system of rotating electrical machines. IEEE International Symposium on Industrial Electronics, pp.2085­2090. Coble, J.B., 2010. Merging data sources to predict remaining useful life--an automated method to identify prognostic parameters. , pp.1­223. Available at: http://trace.tennessee.edu/utk_graddiss/683. Coble, J.B. & Hines, J.W., 2008. Prognostic algorithm categorization with PHM challenge application. 2008 International Conference on Prognostics and Health Management, PHM 2008. Doane, D.P. & Seward, L.E., 2011. Measuring Skewness: A Forgotten Statistic? Journal of Statistics Education, 19(2), pp.1­18. Doncaste, 2017. 2017 Nano/Microsatellite Market Forecast, Elnokity, O. et al., 2012. ANN based Sensor Faults Detection, Isolation, and Reading Estimates SFDIRE: Applied in a nuclear process. Annals of Nuclear Energy, 49, pp.131­142. Available at: http://dx.doi.org/10.1016/j.anucene.2012.06.003. Feng, Z., Liang, M. & Chu, F., 2013. Recent advances in time-frequency analysis methods for machinery fault diagnosis: A review with application examples. Mechanical Systems and Signal Processing, 38(1), pp.165­205. Available at: http://dx.doi.org/10.1016/j.ymssp.2013.01.017. Feng, Z. & Zuo, M.J., 2013. Fault diagnosis of planetary gearboxes via torsional vibration signal analysis. Mechanical Systems and Signal Processing, 36(2), pp.401­421. Available at: http://dx.doi.org/10.1016/j.ymssp.2012.11.004. Gao, C., Zhao, Q. & Duan, G., 2013. Robust actuator fault diagnosis scheme for satellite attitude control systems. Journal of the Franklin Institute, 350(9), pp.2560­2580. Available at: http://dx.doi.org/10.1016/j.jfranklin.2013.02.021. Gao, D. et al., 2010. Signed directed graph and qualitative trend analysis based fault diagnosis in chemical industry. Chinese Journal of Chemical Engineering, 18(2), pp.265­276. Available at: http://dx.doi.org/10.1016/S1004-9541(08)60352-3. Gao, Z., Cecati, C. & Ding, S.X., 2015. A survey of fault diagnosis and fault-tolerant techniquespart II: Fault diagnosis with knowledge-based and hybrid/active approaches. IEEE 106

Conclusion Transactions on Industrial Electronics, 62(6), pp.3768­3774. Gao, Z., Cecati, C. & Ding, S.X., 2015. A Survey of Fault Diagnosis and Fault-Tolerant Techniques Part I: Fault Diagnosis. IEEE Transactions On Industrial Electronics, 62(6), pp.3768­3774. Garga, A.K. et al., 2001. Hybrid reasoning for prognostic learning in CBM systems. IEEE Aerospace Conference Proceedings, 6, pp.62957­62969. Gelman, A., J. Carlin, H. Stern, and D.R., 2004. Bayesian Data Analysis 2nd ed., Baco Raton: Chapman and Hall/CRC. Godard, 2010. Fault Tolerant Control of Spacecraft. Ryerson University. Godard, Kumar, K.D. & Zou, A.M., 2013. A novel single thruster control strategy for spacecraft attitude stabilization. , 86, pp.55­67. Grafarend, E.W., 2006. Linear and Nonlinear Models: Fixed Effects, Random Effects, and Mixed Models, Walter de Gruyter. Griffin, M., 2004. Space Vehicle Design Second., Reston, VA: American Institute of Aeronautics and Astronautics, Inc. Guo, H. et al., 2009. Reliability analysis for wind turbines with incomplete failure data collected from after the date of initial installation. Reliability Engineering and System Safety, 94(6), pp.1057­1063. Guo, Y. et al., 2014. Envelope extraction based dimension reduction for independent component analysis in fault diagnosis of rolling element bearing. Journal of Sound and Vibration, 333(13), pp.2983­2994. Available at: http://www.sciencedirect.com/science/article/pii/S0022460X14001795. Gupta, M.A.K.M.F.U.N., 2014. Seven V's of Big Data Understanding Big Data to extract Value. In Proceedings of the 2014 Zone 1 Conference of the American Society for Engineering Education. Bridgeport, CT, pp. 1­5. Gurrisi, C., 2010. Space Station Control Moment Gyroscope Lessons Learned. In Aerospace Mechanisms Symposium. NASA Kennedy Space Centre. H. Sutherland, T. Repoff, M. House, and G.F., 2003. Prognostics, A new look at statistical life prediction for condition-based maintenance. In IEEE Aerospace conference. pp. 3131­3136. Hacker, J.M., Ying, J. & Lai, P.C., 2015. Reaction wheel friction telemetry data processing methodology and on-orbit experience. Journal of the Astronautical Sciences, 62(3), pp.254­ 269. Holland, J.H., 1992. daptation in natural and artificial systems: an introductory analysis with applications to biology, control, and artificial intelligence, MIT press. Horst, Reiner, and H.T., 2013. Global optimization: Deterministic approaches, Springer Science 107

Conclusion & Business Media. Hu, D., Sarosh, A. & Dong, Y.F., 2012. A novel KFCM based fault diagnosis method for unknown faults in satellite reaction wheels. ISA Transactions, 51(2), pp.309­316. Hua, S. et al., 2013. Fault Prognosis Approach for Satellite Attitude Control System Based on TS Model and Time Series Analysis. Iverson, D., Spirkovska, L. & Schwabacher, M., 2012. General Purpose Data-Driven Online System Health Monitoring with Applications to Space Operations. Journal of Aerospace Computing, Information, and Communication, 9(2), pp.26­44. Jardine, A.K.S., Lin, D. & Banjevic, D., 2006. A review on machinery diagnostics and prognostics implementing condition-based maintenance. Mechanical Systems and Signal Processing, 20(7), pp.1483­1510. Jianhui Luo et al., 2003. An interacting multiple model approach to model-based prognostics. Systems, Man and Cybernetics, 2003. IEEE International Conference on, 1, pp.189­194 vol.1. Jin, G. et al., 2012. RePofe: Reliability physics of failure estimation based on stochastic performance degradation for the momentum wheel. Engineering Failure Analysis, 22, pp.50­ 63. Available at: http://dx.doi.org/10.1016/j.engfailanal.2011.12.004. Johnson, M., 2017. NASA Ends Attempts to Fully Recover Kepler Spacecraft, Potential New Missions Considered. Available at: https://www.nasa.gov/feature/ames/kepler/nasa-endsattempts-to-fully-recover-kepler-spacecraft-potential-new-missions-considered [Accessed July 7, 2017]. Joshi, A. et al., 2007. Intelligent and learning-based approaches for health monitoring and fault diagnosis of RADARSAT-1 attitude control system. 2007 IEEE International Conference on Systems, Man and Cybernetics, pp.3177­3183. Available at: http://ieeexplore.ieee.org/document/4414081/. Kaplan, M., 1976. Modern Spacecraft Dynamics and Control, New York, NY: John Wiley and Sons. Kaufmann, M., 2016. Big Data: Principles and Paradigms and A. V. D. Buyya, Rajkumar, Rodrigo N. Calheiros, ed., Kim, H.E. et al., 2012. Bearing fault prognosis based on health state probability estimation. Expert Systems with Applications, 39(5), pp.5200­5213. Available at: http://dx.doi.org/10.1016/j.eswa.2011.11.019. Kodavade, D.V., 2012. A Universal Object Oriented Expert System Frame Work for Fault Diagnosis. International Journal of Intelligence Science, 2(3), pp.63­70. Konecny, G., 2004. Small Satellites ­ A Tool for Earth Observation? In XXth ISPRS Congress Commission. 108

Conclusion Kothamasu, R., Huang, S.H. & Verduin, W.H., 2009. System health monitoring and prognostics A review of current paradigms and practices. Handbook of Maintenance Management and Engineering, pp.337­362. Krause P, W.O., 1989. Electromechanical motion devices, McGraw-Hill Book Company. Kumar, K.D., 2012. Fundamental of Dynamics and control of space systems, CreateSpace Independent Publishing Platform. Lappas, V.J., Steyn, W.H. & Underwood, C., 2005. Design and Testing of a Control Moment Gyroscope Cluster for Small Satellites. Journal of Spacecraft and Rockets, 42(4), pp.729­ 739. LeCun, Y., Yoshua, B. & Geoffrey, H., 2015. Deep learning. Nature, 521(7553), pp.436­444. Available at: http://www.nature.com/nature/journal/v521/n7553/pdf/nature14539.pdf. Lee, T.-T. & Jeng, J.-T., 1998. The Chebyshev-Polynomials-Based Unified Model Neural Network for Function Approximation. IEEE Transaction on Systems, Man, and CyberneticsPart B, 28(6), pp.925­935. Li, H., Pan, D. & Chen, C.L.P., 2015. Reliability modeling and life estimation using an expectation maximization based wiener degradation model for momentum wheels. IEEE Transactions on Cybernetics, 45(5), pp.955­963. Liao, L. & Köttig, F., 2014. Review of hybrid prognostics approaches for remaining useful life prediction of engineered systems, and an application to battery life prediction. IEEE Transactions on Reliability, 63(1), pp.191­207. Liu, D. et al., 2012. Lithium-ion Battery Remaining Useful Life Estimation Based on Nonlinear AR Model Combined with Degradation Feature. Annual Conference of the Prognostics and Health Management Society 2012, pp.1­7. LOUIS, B.P.C. and T.A., 2000. Bayes and Empirical Bayes Methds for Data Analysis 2nd ed., Boca Raton: Chapman and Hall/CRC. Lu, C.J., Meeker, W.Q. & Meeker, Q., 1993. Measures to Estimate Using Degradation a Distribution. Technometrics, 35(2), pp.161­174. Available at: http://www.tandfonline.com/doi/abs/10.1080/00401706.1993.10485038%5Cnpapers3://pub lication/doi/10.1080/00401706.1993.10485038. Lyshevski, 2008. Electromechanical systems and devices, Boca Raton: FL: CRC Press. Lyshevski, S.E., 2014. Microstepping and high-performance control of permanent-magnet stepper motors. Energy Conversion and Management, 85, pp.245­253. Available at: http://dx.doi.org/10.1016/j.enconman.2014.05.078. Majidian, A. & Saidi, M.H., 2007. Comparison of Fuzzy logic and Neural Network in life prediction of boiler tubes. International Journal of Fatigue, 29(3), pp.489­498. 109

Conclusion Malik, T., 2005. Shuttle Astronauts Repair ISS Gyroscope in Second Spacewalk," Space.com, 1 August 2005. www.space.co. Available at: https://www.space.com/1353-shuttle-astronautsrepair-iss-gyroscope-spacewalk.html [Accessed July 10, 2017]. Marzat, J. et al., 2012. Model-based fault diagnosis for aerospace systems: a survey. Proceedings of the Institution of Mechanical Engineers, Part G: Journal of aerospace engineering, 226(10), pp.1329­1360. Maurya, M.R., Rengaswamy, R. & Venkatasubramanian, V., 2007. A signed directed graph and qualitative trend analysis-based framework for incipient fault diagnosis. Chemical Engineering Research and Design, 85(10 A), pp.1407­1422. Mousavi, S. & Khorasani, K., 2014. Fault detection of reaction wheels in attitude control subsystem of formation flying satellites: A dynamic neural network-based approach. International Journal of Intelligent Unmanned Systems, 2(1), pp.2­26. Available at: http://www.emeraldinsight.com/10.1108/IJIUS-02-2013-0011. Nadarajan, S. et al., 2016. Online Model-Based Condition Monitoring for Brushless Wound-Field Synchronous Generator to Detect and Diagnose Stator Windings Turn-to-Turn Shorts Using Extended Kalman Filter. IEEE Transactions on Industrial Electronics, 63(5), pp.3228­3241. Namdari, M., Jazayeri-rad, H. & Hashemi, S., 2014. Process Fault Diagnosis Using Support Vector Machines with a Genetic Algorithm based Parameter Tuning. Journal of Automation and Control, 2(1), pp.1­7. NASA, 2017. Dawn Observing Ceres; 3rd Reaction Wheel Malfunctions. Jet Propulsion Laboratory, NASA. Available at: https://solarsystem.nasa.gov/news/2017/04/26/dawnobserving-ceres-3rd-reaction-wheel-malfunctions [Accessed July 10, 2017]. NASA, 2015. What are SmallSats and CubeSats. Available at: https://www.nasa.gov/content/what-are-smallsats-and-cubesats [Accessed July 7, 2017]. Nguyen, V. et al., 2017. Model-Based Diagnosis and RUL Estimation of Induction Machines under Inter-Turn Fault. IEEE Transactions on Industry Applications, 9994(c), pp.1­1. Available at: http://ieeexplore.ieee.org/document/7855775/. Oppenheimer, C. & Loparo, K., 2002. Physically based diagnosis and prognosis of cracked rotor shafts. AeroSense 2002, 4733, pp.122­132. Available at: http://proceedings.spiedigitallibrary.org/proceeding.aspx?articleid=887501. Pan, N. et al., Combined failure acoustical diagnosis based on improved frequency domain blind deconvolution. , 12078. Peng, Y. & Dong, M., 2011. A hybrid approach of HMM and grey model for age-dependent health prediction of engineering assets. Expert Systems with Applications, 38(10), pp.12946­12953. Available at: http://dx.doi.org/10.1016/j.eswa.2011.04.091. Peng, Y., Dong, M. & Zuo, M.J., 2010. Current status of machine prognostics in condition-based 110

Conclusion maintenance: A review. International Journal of Advanced Manufacturing Technology, 50(1­4), pp.297­313. Pourbabaee, B., Meskin, N. & Khorasani, K., 2016. Sensor Fault Detection, Isolation, and Identification Using Multiple-Model-Based Hybrid Kalman Filter for Gas Turbine Engines. IEEE Transactions on Control Systems Technology, 24(4), pp.1184­1200. Purwar, S., Kar, I.N. & Jha, A.N., 2007. On-line system identification of complex systems using Chebyshev neural networks. Applied Soft Computing, 7(1), pp.364­372. Q. Liu, G. Jin, J.Z., 2007. A Modeling method of performance reliability of momentum wheel based on EMD. Computer Simulation, 24(11), pp.32­34. Q. Liu, J. Zhou, G.J., 2009. Bayesian reliability estimation for momentum wheel based on credibility. Journal of Astronantics, (30(1)), pp.382­386. QIU, J. et al., 2002. Damage Mechanics Approach for Bearing Lifetime Prognostics. Mechanical Systems and Signal Processing, 16(5), pp.817­829. Available at: http://www.sciencedirect.com/science/article/pii/S0888327002914834. Rahimi, A., Kumar, K.D. & Alighanbari, H., 2015. Enhanced adaptive unscented Kalman filter for reaction wheels. IEEE Transactions on Aerospace and Electronic Systems, 51(2), pp.1568­1575. Riedmiller, M. & Braun, H., 1993. A direct adaptive method for faster backpropagation learning: The RPROP algorithm. IEEE International Conference on Neural Networks - Conference Proceedings, 1993­Janua, pp.586­591. Rivas, A., 2005. Predicting the dynamic behaviour of Stepper Motors. National Conference on Machines and Mechanisms, 12, pp.91­107. Rocchi, M. et al., 2014. Fault prognosis for rotating electrical machines monitoring using recursive least square. EDERC 2014 - Proceedings of the 6th European Embedded Design in Education and Research Conference, pp.269­273. Schmidhuber, J., 2015. Deep Learning in neural networks: An overview. Neural Networks, 61, pp.85­117. Available at: http://dx.doi.org/10.1016/j.neunet.2014.09.003. Schneider, J.J., 2006. Stochastic Optmization, Heidelberg: SpringerVerlag: Berlin. Schwabacher, M.A., 2005. A Survey of Data-Driven Prognostics. , (September), pp.1­5. Shahriar, M., Ahsan, T. & Chong, U., 2013. Fault diagnosis of induction motors utilizing local binary pattern-based texture analysis. EURASIP Journal on Image and Video Processing, 2013(1), p.29. Available at: http://jivp.eurasipjournals.com/content/2013/1/29. Shatnawi, Y. & Al-khassaweneh, M., 2014. Fault Diagnosis in Internal Combustion Engines Using Extension Neural Network. IEEE Transactions on Industry Applications, 61(3), pp.1434­ 1443. 111

Conclusion Shi, Z. et al., 2005. The development of an adaptive threshold for model-based fault detection of a nonlinear electro-hydraulic system. Control Engineering Practice, 13, pp.1357­1367. Available at: http://www.sciencedirect.com/science/article/pii/S0967066104002655. Sidhu, A., Izadian, A. & Anwar, S., 2015. Adaptive Nonlinear Model-Based Fault Diagnosis of Li-Ion Batteries. Industrial Electronics, IEEE Transactions on, 62(2), pp.1002­1011. Singh, P. et al., 2017. Sliding Mode Control of Uncertain Nonlinear Discrete Delayed Time System Using Chebyshev Neural Network. In S. K. Bhatia et al., eds. Advances in Computer and Computational Sciences: Proceedings of ICCCCS 2016, Volume 1. Singapore: Springer Singapore, pp. 527­540. Available at: https://doi.org/10.1007/978-981-10-3770-2_49. Sobhani-Tehrani, E. & Khorasani, K., 2008. Identification For Nonlinear Systems Using Hybrid Approach. Concordia University. Spaceflight, 2017. SCHEDULE & PRICING. Spaceflight. Sunil Nag P.V., Gowtham kumar Silla, Venkata Harsha Vardhan Gummadi, Harishankar C B, V. & Kumar Ray, C.S.K., 2016. Model Based Fault Diagnosis of Low Earth Orbiting (LEO) Satellite using Spherical Unscented Kalman Filter. IFAC-PapersOnLine, 49(1), pp.1­4. Available at: http://dx.doi.org/10.1016/j.ifacol.2016.03.127. Tafazoli, E.S.T.; K.K.; S., 2005. Dynamic neural network-based estimator for fault diagnosis in reaction wheel actuator of satellite attitude control system. In 2005 IEEE International Joint Conference on Neural Networks. Montreal, Quebec, pp. 2347­2352. Tafazoli, M., 2009. A study of on-orbit spacecraft failures. Acta Astronautica, 64(2­3), pp.195­ 205. Tsiotras, P., 2001. Satellite attitude control and power tracking with energy/momentum wheels. Journal of Guidance Control and Dynamics, 24(1), pp.23­34. Vachtsevanos, 2006. Intelligent Fault Diagnosis and Prognosis for Engineering Systems, Hoboken, New Jersey: John Wiley & Sons, Inc. Vectornav, 2017. Gyroscope. Available at: https://www.vectornav.com/support/library/gyroscope [Accessed July 20, 2009]. Venkatasubramanian, V. et al., 2003a. A review of process fault detection and diagnosis part I: Quantitative model-based methods. Computers and Chemical Engineering, 27(3), pp.293­ 311. Venkatasubramanian, V. et al., 2003b. A review of process fault detection and diagnosis part III: Quantitative model-based methods. Computers and Chemical Engineering, 27(3), pp.293­ 311. Vyas, B.Y., Das, B. & Maheshwari, R.P., 2016. Improved Fault Classification in Series Compensated Transmission Line: Comparative Evaluation of Chebyshev Neural Network Training Algorithms. IEEE Transactions on Neural Networks and Learning Systems, 27(8), 112

Conclusion pp.1631­1642. Wang, J. et al., 2016. Prognostic for on-orbit satellite momentum wheel based on the similitude method. Proceedings of 2015 Prognostics and System Health Management Conference, PHM 2015. Wie, B., 1998. Space Vehicle Dynamics and Control, Reston, VA: AIAA Inc. Wie, B., Bailey, D. & Heiberg, C., 2001. Singularity robust steering logic for redundant singlegimbal control moment gyros. Journal of Guidance, Control, and Dynamics, 24(5), pp.865­ 872. Available at: http://arc.aiaa.org/doi/abs/10.2514/2.4799. Xiong, K., Chan, C.W. & Zhang, H.Y., 2007. Detection of satellite attitude sensor faults using the UKF. IEEE Transactions on Aerospace and Electronic Systems, 43(2), pp.480­491. Yan, J., Koç, M. & Lee, J., 2004. A prognostic algorithm for machine performance assessment and its application. Production Planning & Control, 15(8), pp.796­801. Available at: http://www.tandfonline.com/loi/tppc20%5Cnhttp://dx.doi.org/10.1080/09537280412331309 208%5Cnhttp://%5Cnwww.tandfonline.com/. Zhang, B. et al., 2011. A probabilistic fault detection approach: Application to bearing fault detection. IEEE Transactions on Industrial Electronics, 58(5), pp.2011­2018. Zhang, Y., Bingham, C. & Gallimore, M., 2013. Fault detection and diagnosis based on extensions of PCA. Advances in Military Technology, 8(2), pp.1­15. Available at: http://eprints.lincoln.ac.uk/12956. Zhao, X., Xue, Y. & Wang, T., 2014. Fault detection of batch process based on multi-way kernel t-pls. Journal of Chemical and Pharmaceutical Research, 6(7), pp.338­346.

113

