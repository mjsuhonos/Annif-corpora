Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2012

Sensitivity Analysis for Stochastic Continuous Models of Biochemical Systems
Samaneh Gholami
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Applied Mathematics Commons Recommended Citation
Gholami, Samaneh, "Sensitivity Analysis for Stochastic Continuous Models of Biochemical Systems" (2012). Theses and dissertations. Paper 1376.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

Sensitivity Analysis for Stochastic Continuous Models of Biochemical Systems

by

Samaneh Gholami Bachlor of Science, Amirkabir University, 2000

A thesis presented to Ryerson University

in partial fulfillment of the requirements for the degree of Master of Science in the Program of Applied Mathematics

Toronto, Ontario, Canada, 2012 c Samaneh Gholami 2012

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A THESIS

I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my thesis may be made electronically available to the public.

ii

Sensitivity Analysis for Stochastic Continuous Models of Biochemical Systems Master of Science 2012 Samaneh Gholami Applied Mathematics Ryerson University

Modeling and simulation of biochemical systems are some of the important research areas in the rapid rise of Systems Biology. Often biochemical kinetic models represent cellular processes as systems of chemical reactions. The dynamics of these systems is typically described by using stochastic models. We introduce a method for an accurate sensitivity analysis of continuous such models of well-stirred biochemical systems. Sensitivity analysis plays a central role in the study of biochemical systems, being an important tool in their model construction, investigation and validation. In particular, it enables the identification of the key reaction rate parameters and it gives insight on how to effectively reduce the system while maintaining its overall behavior. The efficiency and accuracy of the method discussed are tested on several examples of practical interest.

iii

Acknowledgements
I would like to gratefully acknowledge the enthusiastic supervision of Dr. Silvana Ilie during this work. I would like to thank her for offering me invaluable assistance, support and guidance. She proposed me an exciting and challenging problem and introduced me to the subject of sensitivity analysis for stochastic systems. Deepest gratitude is also due to the members of the examining committee, Dr. Kunquan Lan, Dr. Katrin Rohlf and Dr. Dejan Delic for dedicating their time for reading my thesis and for all their help. I wish to express my love and gratitude to my beloved families; my father for raising my love for mathematics and my mother for encouraging along the way and for her endless love. Through the duration of my studies, I thank the generous support given to me by my husband Majid Mirjani and my son Amir Parsa, words cannot describe your patience.

iv

Contents
1 Introduction 2 Background 2.1 2.2 Deterministic vs stochastic approaches . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Stochastic Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.2.1 2.2.2 2.2.3 2.2.4 2.2.5 Chemical Master Equation (CME) . . . . . . . . . . . . . . . . . . . . . . . . . . . Gillespie Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Improvements: Next Reaction Method and Tau-Leaping Method . . . . . . . . . . 1 4 4 6 7 8 9

Chemical Langevin Equation (CLE) . . . . . . . . . . . . . . . . . . . . . . . . . . 11 Reaction Rate Equation (RRE) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13 14

3 Sensitivity Analysis 3.1 3.2 3.3 3.4 3.5

Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14 Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15 Sensitivity Analysis of CME . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19 Sensitivity Analysis of RRE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20 Sensitivity Analysis of CLE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21 22 25 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25

4 Numerical Methods 5 Numerical Results 5.1 5.2 5.3 Lotka-Volterra Model

Michaelis-Menten Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 A system of stiff, nonlinear CLEs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37 44 59

6 Conclusion References

v

List of Tables
2.1 5.1 5.2 5.3 Comparison of the performance of different stochastic algorithms . . . . . . . . . . . . . . 10 Lotka-Volterra chemical reaction model . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26 The Michaelis-Menten chemical reaction system . . . . . . . . . . . . . . . . . . . . . . . . 31 A stiff, nonlinear Chemical reaction model. . . . . . . . . . . . . . . . . . . . . . . . . . . 37

vi

List of Figures
2.1 2.2 3.1 5.1 5.2 5.3 5.4 5.5 5.6 5.7 Deterministic plot in contrast to stochastic plot . . . . . . . . . . . . . . . . . . . . . . . . 5 Gillespie in comparison to Langevin approaches . . . . . . . . . . . . . . . . . . . . . . . . 12 Monte Carlo approaches for sensitivity analysis of stochastic models of chemical kinetics Evolution in time of the number of molecules (top) and of the sensitivities for k1 for RRE and of the mean of sensitivities for CLE (bottom) . . . . . . . . . . . . . . . . . . . . . . . 29 Evolution in time of the number of molecules (top) and of the sensitivities for k1 for RRE and of the std of sensitivities for k1 for CLE (bottom) . . . . . . . . . . . . . . . . . . . . 30 The Michaelis-Menten mechanism of enzyme action . . . . . . . . . . . . . . . . . . . . . 32 The evolution in time of the number of molecules (top) and of the sensitivities for k2 for the RRE, and of the mean of sensitivities for the CLE (bottom) . . . . . . . . . . . . . . . 35 The evolution in time of the number of molecules (top) and of the std of the sensitivities for k2 for the CLE (bottom) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36 The evolution in time of the numbers of molecules of the species S1 , S2 and S3 , and of the sensitivities for the RRE and of the mean of sensitivities for the CLE. . . . . . . . . . 41 The standard deviation (std) of the sensitivities with respect to c4 for the Chemical Langevin Equation(CLE) on the third model. . . . . . . . . . . . . . . . . . . . . . . . . . 43 18

vii

List of Appendices
A Convergence in probability B Matlab code 45 46

viii

Chapter 1

Introduction
In recent years, modeling and simulation of biochemical systems have been widely used to study important biological processes [29]. The experimental data is enormous in Molecular and Cellular Biology and these data require to be simulated and analyzed. Therefore, the need for finding accurate models of these biological processes and efficient tools for simulating and studying them is essential. The traditional mathematical modeling of the biochemical systems uses the continuous deterministic model of the reaction rate equations. However, often key biological processes involve some species with low population numbers. Then the deterministic model fails to accurately describe the system dynamics. For example, in a single cell only few regulatory molecules are available, so a continuous model fails to correctly describe the system dynamics and the random fluctuations which are inherent to such a system [26; 48; 51]. In this case, stochastic systems are required to accurately capture the system behaviour rather than deterministic models [33; 3; 34; 6; 11; 12; 13; 39; 45]. In deterministic models, concentrations of biochemical species are continuous variables and the standard theory of chemical kinetics uses the reaction rate equations, which is a set of ordinary differential equations, to model the dynamics of a chemical system. In stochastic models, species may have an integer or a real number of molecules and the reactions are treated as discrete and random events. Biological processes taking place at the level of a single cell can be analyzed by studying systems of biochemical reactions which exhibit random fluctuations. Some of these fluctuations are not negligible. In such cases, it is very important to use the stochastic models for an accurate description. The most refined model of biochemical reactions is that of Molecular Dynamics. This model is very complex and expensive to simulate as it keeps track of all positions and velocities of the molecules in the system. However, under a mild assumption that the system is well-stirred, a great simplification of the model is obtained. The simplified stochastic chemical kinetics model is the Chemical Master Equation (CME) which was introduced by Gillespie [18]. Also, Gillespie developed an exact method to numerically simulate the CME. The CME has been successfully applied to model many biochemical systems, also when the system is not well mixed, such as systems in the cell. The first remarkable application of Gillespie's algorithm for biological systems was described by McAdams and Arkin [33]. They demonstrated that the noise arising in the stochastic system affects the lysis decision of the bacteria -phage. 1

CHAPTER 1. INTRODUCTION Stochastic modeling approaches are more difficult to analyze than their deterministic counterparts. Cellular processes are one important application of stochastic modeling. The simulation of stochastic models is expensive. When cellular processes include large numbers of species and large number of chemical reactions, the exact method developed by Gillespie becomes extremely expensive. In addition to their computational cost, stochastic models are complicated and difficult to analyze. Tools for decreasing the computational cost, for an easier understanding of the models are highly desirable. Generally, stochasticity divides into two groups: intrinsic and extrinsic noise. Intrinsic noise is a property of the system. Extrinsic noise is external to the system, for example environmental factors constitute extrinsic noise. Determining the boundary between intrinsic and extrinsic effects is related to the size of the modeled system [10; 45]. Gibson and Bruck [16] proposed an improved exact algorithm. In Gibson and Bruck's algorithm, the computational cost has been reduced by avoiding the repetition of the iteration. Several algorithms have been developed for obtaining improved speed with reduced loss of accuracy [29]. Gillespie proposed the tau-leaping method in 2001 [20]. This strategy reduces the computational cost of Gillespie's algorithm but it is an approximate method. Several studies were done for further developing the tau-leaping method by Rathinam et al . [41], Cao et al . [8], Tian and Burrage [46], Chatterjee et al . [9]. Li developed higherorder tau-leaping methods [32], Anderson proposed an adaptive time-stepping [1] in tau-leaping methods. However, all these methods are expensive on many realistic applications, which include a large number of molecular species and many reactions. A simplification of the CME model can be obtained when the biochemical species have relatively large molecular populations. Under this assumption, the continuous stochastic model of biochemical kinetics, the Chemical Langevin Equation, (CLE) is valid. Langevin Equations in biochemical kinetics are systems of stochastic differential equations (SDE) of dimension equal to the number of reacting species. In recent years, several studies have been conducted on the numerical solution of stochastic differential equations [28; 31]. The CLE constitute a set of SDEs among the most difficult: they are non-linear, of relatively large dimension, typically stiff and with non-commutative noise. Therefore, there are many open problems regarding their numerical solution. A further simplification of the CLE can be obtained when all molecular species are very abundant. Then, the deterministic model of the reaction rate equations applies. In [50; 2] other modeling approaches are being developed with consideration of spatial information in cells. Also many approaches have been proposed for simplifying the deterministic models of the chemical reactions but there are limitations for applying these approaches to the reduction of stochastic biochemical models. Sensitivity analysis is a critical tool for studying the dependence of a system on its external parameters. Sensitivity shows how a change in the solution depends on a change in the parameter. If a small change in the parameter leads to a large change in the solution, then the system is sensitive with respect to that parameter. Then, that parameter should be very accurately estimated. Otherwise, the system is robust with respect to the parameter, and thus the parameter is not important for the dynamics. Its accurate estimation is not essential. Sensitivity analysis is thus a key tool for model construction, model analysis and model reduction. 2

CHAPTER 1. INTRODUCTION In particular, if a biochemical system is not sensitive with respect to one parameter, that parameter may be set constant or even eliminated, and thus the model is reduced without changing its dynamics. A reduced model which maintains the correct dynamics is easier to analyze and simulate. Sensitivity analysis of the reaction rate equation model has been studied in great detail [27]. However, much less is known regarding the sensitivity analysis of stochastic biochemical models. For the CME model, a weak approach to sensitivity analysis was developed in [4; 24]. This technique gives the sensitivity of the mean trajectory, that is a sensitivity with respect to a parameter of the expected value. In this thesis, we develop a pathwise sensitivity for the Chemical Langevin Equation. Our method gives a sensitivity in a strong sense, that is a sensitivity of each path of the solution for the CLE. This result gives, in particular, the sensitivity of the expectation, if that is desired. In addition, it gives the possibility of studying individual trajectories, rather than averages of trajectories. This thesis is organized as follows. In Chapter 2, we give an introduction to the existing mathematical models and simulation tools of well-stirred biochemical systems and Chapter 3 discusses the sensitivity analysis of biochemical systems and proposes a pathwise sensitivity method of the Chemical Langevin Equation. In Chapter 4, we present numerical methods for stochastic differential equations. Finally, in Chapter 5, we test our proposed sensitivity technique on several key models of biochemical systems. We show that a sensitivity analysis of the deterministic models of biochemical systems is not accurate in estimating the sensitivities of the more general, stochastic models. Our method accomplishes this goal, that is, gives accurate estimates for a sensitivity analysis.

3

Chapter 2

Background
Recently, stochastic models have been used in biology to study many important biological processes, such as the cellular dynamics. Scientists are interested in understanding the effect of the noise on the dynamics of a biochemical system. For example, due to their intrinsic noise some biochemical systems change their qualitative behaviour compared to when the noise is absent. In such cases, a deterministic approach to modeling gives an inaccurate description of the system dynamics [14; 37; 49; 18].

2.1

Deterministic vs stochastic approaches

Deterministic models have been widely used for analyzing biological processes. These models are typically systems of ordinary differential equations (ODE). In deterministic modeling, the evolution of a biochemically reacting system is obtained in a predictable manner. Probabilistic views are considered in stochastic models. Because of that, the behavior of the model is not predictable. However, in biochemical reaction systems where large numbers of molecules are present the deterministic model has been successfully applied, as the average of fluctuations are considered. On the other hand, stochastic influences become important in cellular systems where only few molecules of DNA or RNA are available [38]. We note that, while in deterministic models it is convenient to work with concentrations, in stochastic models it is suitable to keep track of the number of molecules of each species. An important tool in stochastic modeling is a Markov process, which is described below. The set of {X(t), t = 0, 1, 2, ...} is a discrete time stochastic process. S is a state space such that X(t)  S for all t. The state space may be discrete or continuous. Definition: A Markov process is a stochastic process for which if the present state is known, the future states don't have any dependence on the past states. Mathematically, if A is a subset of S and n = 0, 1, 2, 3, ... we have for a discrete time Markov process P X(n + 1)  A|X(n) = = x, X(n - 1) = xn-1 , ..., X(0) = x0 P (X(n + 1)  A|X(n) = x), 4 x, xn-1 , , ..., x0  S

CHAPTER 2. BACKGROUND

2.1. DETERMINISTIC VS STOCHASTIC APPROACHES

Figure 2.1: Deterministic plot in contrast to stochastic plot (A,B) Evolution in time for steady state.(C,D) Stable oscillation [23]

5

2.2. STOCHASTIC MODELS

CHAPTER 2. BACKGROUND

In other words, the past states don't give any information about the future state, given the present state. P (X(n + 1)  A|X(n) = x) defines the operation of the chain. If it doesn't have any dependence to n, then we have P (X(n + 1)  A|X(n) = x) = p(x, A), n

Consider now that {X(t), t  [0, )} is a continuous time stochastic process with the state space S discrete or continuous. Then X is a Markov process if P X(t + dt) = y |X( ) = x( ) for all   [0, t] = P (X(t + dt) = y |X(t) = x(t)) and y  S . A continuous time Markov process is called a diffusion process.

2.2

Stochastic Models

Molecular Dynamics (MD) is the most general model of biochemical systems. However, this model is often too expensive to solve as it keeps track of all velocities and all positions. Instead, we assume that the system is well-stirred, at thermal equilibrium and its volume is constant. Suppose that S1 , ..., SN are the molecular species in the system, participating in M types of reaction, R1 , ..., RM . Then dynamical state, X(t) = (X1 (t), X2 (t), ..., XN (t)), where Xi (t) is the number of Si molecules at time t, describes the system. We note that X(t) is a Markov process with a discrete space. In well-stirred systems, a reaction channel Rj is described by two characterizing quantities. One is its state change vector, defined by j = (1j , ..., N j )T where ij = change in number of Si molecules caused by one Rj . The array {ij } is known as the stoichiometric matrix. The other quantity for Rj is its propensity function aj which is defined as: Given X(t) = x, then aj (x)dt is the probability that one Rj event will occur in the next time interval [t, t + dt]. The propensity functions are obtained from kinetic theory principles. The propensity function is related to the size of the system. If a system has more molecules, their probability of reacting becomes higher [23]. If Rj is a unimolecular reaction Sn -something, based on kinetic theory arguments, the propensity function is aj (x) = cj xn where cj for a unimolecular reaction is equal to the reaction rate constant kj . If Rj is a bimolecular reaction Sn + Sm -something, kinetic theory arguments and the well-stirred condition give the propensity function aj (x) = cj xn xm if n = m, or aj (x) =
1 2 cj xn (xn

- 1) if n = m. Here cj , the corresponding reaction rate constant for
kj nA vol

bimolecular reactions, is equal to

if the reactants are different, or

2kj nA vol

if they are the same,

where nA is the Avogadro number and vol is the volume of the system. We assume that the reactions are instantaneous, thus no more than one reaction occurs in an infinitesimal time interval. Below we explain the foundations of the stochastic chemical kinetic modeling. ----------6

CHAPTER 2. BACKGROUND

2.2. STOCHASTIC MODELS

2.2.1

Chemical Master Equation (CME)

The Chemical Master Equation is the finest model of well-stirred biochemical systems, and it gives the variation of the probability with time for all the possible states of the system. This equation describes the system dynamics, being a system of ordinary differential equations in probabilities to be in certain states. This equation is applied in many areas such as physics, chemistry, biology, population dynamics and economy. Application to genetics and molecular networks has been studied in [35; 48; 47]. When the well-stirred assumption applies, the state of the system, X(t), is a stochastic (Markov) process. We define the following probability P (x, t|x0 , t0 ) = P rob{X(t) = x, given X(t0 ) = x0 } (2.1)

We wish to derive a time-evolution equation for the probability function (2.1) of the system's state, using the laws of probability. If we know the probability of the system being in any possible state at time t, we can find the probability of being at state x at time t + dt as: P (x, t0 + dt|x0 , t0 ) = +
j =1

P (x, t|x0 , t0 )P (no change over dt)
M

P (x - j , t|x0 , t0 )P (one reaction Rj over dt)

(2.2)

where j is a stoichiometric vector. Obviously, we can say that P (no change over dt) = P (no reaction occurs over dt)
M

=

1-
j =1

(aj (x)dt)

(2.3)

P (one reaction Rj over dt)

=

(aj (x - j )dt)

(2.4)

where aj is the propensity function. Using (2.3,2.4), we can write the equation (2.2) as
M

P (x, t + dt|x0 , t0 )

= +

P (x, t|x0 , t0 ) × {1 -
j =1 M

(aj (x)dt)}

P (x - j , t|x0 , t0 ) × (aj (x - j )dt)
j =1

By rearranging the equation, dividing by dt and taking the limit as dt  0, we obtain P (x, t|x0 , t0 ) = t
M

{aj (x - j )P (x - j , t|x0 , t0 ) - aj (x)P (x, t|x0 , t0 )}
j =1

(2.5)

The equation (2.5) is known as the Chemical Master Equation (CME) or the forward Kolmogorov Equation. The CME is a set of coupled ordinary differential equations (ODE) and there is one ODE 7

2.2. STOCHASTIC MODELS

CHAPTER 2. BACKGROUND

for each possible state. As the number of state values can be very large, the CME is often a very large system of ODEs. Then, its solution is very difficult to compute except for some simple problems. The Chemical Master Equation is the most general model of well-stirred biochemical systems. This model is particularly useful when some species have small molecular numbers.

2.2.2

Gillespie Algorithm

Since the CME can only rarely be solved directly, other methods to approximate its solution are important. Such a method is a Monte-Carlo type scheme which was propsed by Gillespie in [17; 18]. To derive Gillespie's algorithm, we consider a new probability function P (, j |x, t) which is defined as follows: Given x(t) = x , P (, j |x, t)d is the probability that the next reaction 1. will occur in the time interval [t + , t +  + d ) and 2. will be an Rj reaction Also, we make the notation P0 ( |x, t) is the probability that no reaction takes place in [t, t +  ) given x(t) = x0 . The event that no reaction occurs in [t, t +  ) is independent of the event that one reaction Rj takes place in [t + , t +  + d ). The probability density function of the former is P0 ( |x, t) and that of the latter is aj (x)d . Therefore, their joint probability density function is P (, j |x, t)d = P0 ( |x, t) × aj (x)d We need to determine P0 ( |x, t), let us find P0 ( + d |x, t) which is the probability that no reaction occurs in [t, t +  + d ). This means that 1. there is no reaction in [t, t +  ) and 2. no reaction occurs in [t + , t +  + d ). The above two events are independent, thus their joint probability is the product of the two probabilities. The probability of the former event is P0 ( |x, t) while of the latter is P0 ( + d |x, t) = P0 ( |x, t) × 1 - Taking d  0 we get dP0 ( |x, t) =- d and thus P0 ( |x, t) = exp(-
l=1 M M l=1

1-

M l=1

al (x)d . Thus,

al (x)d .

al (x)
l=1 M

al (x) ).

Since P (, j |x, t) = P0 ( |x, t) × aj (x) = exp(-a0 (x) ) × aj (x) 8

CHAPTER 2. BACKGROUND where a0 (x) =
M l=1

2.2. STOCHASTIC MODELS

al (x).

Consequently, we can write P (, j |x, t) = a0 (x)exp(-a0 (x) ) × aj (x) . a0 (x)

We can express this joint density function as the product of two density functions. 1. The density function of,  , the time to the next reaction, given by [a0 (x)exp(-a0 (x) )]. 2. The density function of j , the index of the next reaction, given by
aj (x) a0 (x) .

This theoretical justification of this Monte Carlo method was given by Gillespie in [18]. Gillespie's algorithm is also known as the Stochastic Simulation Algorithm (SSA) [17]. The algorithm is based on a Monte Carlo approach and indirectly simulates the CME by producing many trajectories. Provided that many trajectories are computed, the statistics on these trajectories are in agreement with the statistics given by the CME. The algorithm can be summarized as follows:. 1. With the system in state x at time t, evaluate a0 (x) =
M j =1 (aj

(x))

2. Draw two unit-interval uniform random numbers r1 and r2 , and compute the time to the next reaction,  , and the index of the next reaction, j , according to (i).  =
1 a0 (x)

ln r1 1
j j =1

(ii). j =the smallest integer satisfying

aj (x) > r2 a0 (x)

3. Replace t +  instead of t and x + j instead of x. 4. Record (x, t). Return to Step 1, or else stop. In fact, the algorithm simulates one reaction at a time so it's prohibitively expensive for large population numbers. Gillespie algorithm is statistically in exact accordance with the CME.

2.2.3

Improvements: Next Reaction Method and Tau-Leaping Method

In 2000, Gibson and Bruck proposed the Next Reaction Method which is an improvement of Gillespie algorithm. In Gibson and Bruck's algorithm, the computational cost has been reduced by avoiding the repetition of the iteration. In fact they improve the time-complexity of the algorithm [16]. Gibson and Bruck's algorithm is an exact method for the CME. Gillespie proposed the tau-leaping method in 2001 [20]. This strategy reduces the computational cost of Gillespie's algorithm and obtains a higher speed without significant loss of accuracy. Gillespie's algorithm simulates the CME exactly. But often this is too expensive, and thus not useful in practice. Instead, in some cases, it is sufficient to know how many reactions happen in a certain time interval. 9

2.2. STOCHASTIC MODELS Algorithm Gillespie Tau-leap Gibson & Bruck Accuracy very high medium very high

CHAPTER 2. BACKGROUND Computational Cost very high low high Speed slow medium moderate

Table 2.1: Comparison of the performance of different stochastic algorithms [35]

tau-leaping provides this property. In this method the length of the time interval is fixed and the algorithm advances with the given time step,  , so it often steps over more than one reaction. However,  is limited by the Leap Condition:  should be small enough such that the propensity functions change very little during one step. Also,  should be large enough to step over many reactions, to make this algorithm faster than the SSA. In the literature, there were reported 100 times speed-ups of the tau-leaping method over Gillespie's algorithm for systems arising in applications. Note that the tau-leaping method is not as generally applicable as the Gillespie Algorithm, since it is an approximate algorithm. We recall that the Poisson random variable P (a,  ) is the number of events that will occur in the time  given that the probability of an event occurring in any dt is adt. Given X(t) = x, if  is such that aj (x) is constant in [t, t +  ], then the number of reactions Rj that fire in the interval [t, t +  ] has a Poisson distribution with parameter aj (X(t)) . Under the Leap Condition assumption, we approximate
M

X(t +  ) = x +
j =1

Pj (aj (x),  )j

(2.6)

It requires M Poisson random numbers for each leap, one for each different type of reaction. Equation (2.6) is the basic tau-leaping formula. Below, we discuss how it can be used to create a faster simulation algorithm under some assumptions. As we know, the Poisson distribution P (a,  ) has mean and variance a . When the mean and variance a 1, the Poisson distribution can be approximated by a normal distribution with the same mean  and variance: P (a,  )  N (a, a )  a + a N (0, 1),

where N (0, 1) is a real valued normal random variable with mean 0 and variance 1. Given X(t) = x, suppose we can choose  to satisfy the Leap Condition and the conditions aj (x) 1, j . Then we can further approximate the equation (2.6) as
M

X(t +  )

= =

x+
j =1 M

j Nj (aj (x), aj (x) )
M

(2.7) j aj (x) Nj (0, 1)

x+
j =1

j aj (x) +
j =1

10

CHAPTER 2. BACKGROUND

2.2. STOCHASTIC MODELS

This equation is valid if  is chosen small enough to satisfy the Leap Condition, and large enough such that every reaction fires many more than once in  (a 1) . Such  exists if all the reactant populations are sufficiently large. The further reduction of tau-leaping is faster than tau-leaping [29].

2.2.4

Chemical Langevin Equation (CLE)

Before presenting another stochastic model of well-stirred biochemical systems, we need to introduce the concept of a Wiener process, which is an important modeling tool. Definition: A Wiener process W (t) is a random variable that depends on t  [0, T ] and has the following properties: · W(0)=0 with probability 1. · If 0  s < t  T , then the Wiener increments, generated by W (t) - W (s) are normally distributed  with mean zero and variance t - s; Correspondingly, we can write W (t) - W (s)  t - sN (0, 1), where N (0, 1) is normal distribution with mean zero and variance 1. · If 0  s < t <u <v  T , then the increments W (t) - W (s) and W (v ) - W (u) are independent. Now we introduce an alternative stochastic model of well-stirred biochemical systems. While the CME is the most refined model of well-stirred biochemical systems, often it is very expensive to simulate and very hard to analyze. In a large class of applications, the reacting species have large molecular populations. Then, some propensities become very large, and thus the time-step in Gillespie's algorithm is extremely small. Fortunately, under these circumstances, the CME model can be reduced further, leading to the model of the Chemical Langevin Equation (CLE). While the CME had a very large dimension, the CLE has dimension equal to the number of species in the system. In Figure 2.2 we show the differences between the Gillespie and the Langevin simulation for a simple model [23]. Langevin Equation model has received considerable attention, not only in Systems Biology, but also in physics, chemistry and biology [30; 15; 49]. In the biochemical kinetic theory, it is known as the Chemical Langevin Equation (CLE) and it is a stochastic differential equation system of the form: dX(t) = dt
M M

j aj (X(t)) +
j =1 j =1

j

aj (X(t))j (t)

(2.8)

where j 's are "Gaussian white noises". The system can be written, equivalently, as
M M

dX(t) =
j =1

j aj (X(t))dt +
j =1

j

aj (X(t))dWj (t)

(2.9)

where Wj , 1  j  M are independent Wiener processes. This equation can be obtained from (2.7) by taking the limit   0. We note that (2.7) is, in fact, the Euler-Maruyama method for stochastic differential equations and applies for approximating the solution of the CLE. We remark that the discrete space Markov process satisfying the CME (2.5) is approximated by a continuous space Markov process in the CLE (2.9). 11

2.2. STOCHASTIC MODELS

CHAPTER 2. BACKGROUND

The CLE model is continuous and stochastic and it is valid if all the molecular populations are sufficiently large. The model was introduced by Gillespie in [19]. We mention that many biochemical systems in applications can be accurately modeled with the Chemical Langevin Equation. In the literature, it was reported that biochemical systems with molecular populations as low as 10 molecules for a species are well modeled by the CLE. In the next section, we present a further reduction of the Chemical Master Equation, via the Chemical Langevin Equation.

Figure 2.2: Gillespie in comparison to Langevin approaches In the plots we remark that the noise becomes significant when the number of molecules decreases. The level of noise is similar in the Gillespie and Langevin approaches.

12

CHAPTER 2. BACKGROUND

2.2. STOCHASTIC MODELS

2.2.5

Reaction Rate Equation (RRE)

The thermodynamic limit is defined as the limit in which the population numbers and the system volume are very large, or all approach infinity, but the concentrations of species remain constant. Therefore, as the thermodynamic limit is approached, the stochastic model of the CLE often reduces to the deterministic model of the reaction rate equation [21]. For systems with all molecular populations in very large numbers, the noise becomes negligible, therefore the CLE (2.9) can be reduced to a system of ordinary differential equations, called the reaction rate equations (RRE): dX(t) = dt
M

j aj (X(t))
j =1

(2.10)

The RRE model is valid under the assumption of very large molecular populations. The RRE model has dimension equal to the number of biochemical species in the system. This system of equations has been successfully used to model the behaviour of chemical reactions for decades. However, noise may be significant if some populations have small molecular numbers, and then stochastic models are required. More precisely, the reduction of the CLE to the RRE is obtained as follows. Let us apply the expectation to the Chemical Langevin Equation (2.9). We obtain
M M

d(E(X))

=
j =1 M

j E(aj (X(t)))dt + E
j =1 M

j j E

aj (X(t))dWj (t) aj (X(t))dWj (t)

=
j =1 M

j E(aj (X(t)))dt +
j =1

=
j =1

j E(aj (X(t)))dt

Dividing by dt we derive d (E(X)) dt
M

=
j =1

j E(aj (X(t)))

If a reaction is at most of first order, that is its propensity aj (X) = cj Xk or aj (X) = cj then E(aj (X)) = aj (E(X)). However, if a reaction is of second order, that is its propensity is either aj (X) = cj Xk Xc or aj (X) =
cj Xk (Xk -1) , 2

then, in general E(aj (X)) = aj (E(X)).

Thus, the reaction rate equation can be exactly derived from the Chemical Langevin Equations, by averaging over each species, in the case when the reactions are of first or zero-order.

13

Chapter 3

Sensitivity Analysis
3.1 Background

The development of experiment design and the need for complicated simulation techniques for studying different subjects such as industrial engineering, operation research, economics and biological and health sciences have led to the creation of advanced computational methodologies. One important tool in the development of refined models is sensitivity analysis, that is the study of the sensitivity of models to variation or uncertainty in model parameters. If a small change in a parameter causes large changes in the outcomes, it is said that the model is sensitive with respect to that parameter. This implies that the corresponding parameter has to be measured very accurately. Parameters which have small sensitivity don't need to be measured very accurately. Also, they are not good control parameters of the system behavior. On the other hand, the parameters with large sensitivity are good control points in the system behavior. Chemical reaction models depend on many parameters such as kinetic parameters, initial amounts for each species and an uncertain environment. Some small changes in the parameters may significantly affect the output of the system, so it is important to determine the influences of such changes. The sensitivity analysis studies the change of system outputs with respect to kinetic parameters or initial conditions and it is an essential analysis technique in kinetic modeling. Describing the sensitivity with respect to small perturbations in parameters is a powerful device for the analysis, modeling, and design of chemical reaction networks. Also, the sensitivity is used to help make decisions on which parts of the model are actively contributing. Therefore, it plays an important role in a number of situations, assessing the accuracy of a model, in model development and in model reduction. The effect of uncertainty or variability in the values of input parameters can be explored by using sensitivity analysis. The methods used for estimating sensitivities can be divided into two categories: finite perturbation and infinitesimal perturbation. In finite perturbation the parameter is changed a small amount but not vanishingly, has finite perturbation. In the other category of sensitivity, the parameter is perturbed 14

CHAPTER 3. SENSITIVITY ANALYSIS

3.2. METHODS

infinitesimally, by a vanishingly small amount. Thus, the partial derivative with respect to a given parameter is the main concern. In fact, the infinitesimal sensitivity is a limit of the finite sensitivity [4].

3.2

Methods

1. Finite Difference approximations This is a wide class of numerical methods, to estimate the derivative dy/dx. This method consists of: increase x by a very small quantity to x1 , re-calculate the function value y1 for x1 , and then estimate the sensitivity as (y - y1 )/(x - x1 ). Thus this method needs to evaluate the function at least twice and also requires the calculations three times for the central difference method, and therefore it is challenging when we have to do many simulations [25]. Finite difference approximations have the disadvantage that sometimes they produce biased estimates. A simple example of a finite-difference approximation of sensitivities is the following. If  is a parameter and Y () is a random variable depending on  then one can compute the independent simulations Y1 (), Y2 (),..., Yk () as well as Y1 ( + ), Y2 ( + ),..., Yk ( + ) for a small perturbation  of ¯ ¯ . If Y k ( ) is the mean of the first set of values and Yk ( +  ) is the mean of the second set of values, then the forward-difference estimator is F (k, ) = ¯ ¯ Y k ( +  ) - Yk ( ) . 

2. Pathwise derivative estimate In the context of stochastic systems, there are two main approaches for calculating the Monte Carlo infinitesimal sensitivity. The first one is known as the Likelihood Ratios. The second one is the pathwise differentiation, also known as the infinitesimal perturbation analysis. Suppose that a model, with  as a parameter, is defined on a time interval [0, T ]. Also consider a random variable Y () which is generated by a method, depending on . Indeed Y () is the output of the method. We wish to compute, if possible, Y () = lim Y ( + ) - Y ()  (3.1)

  0

For obtaining our goal, we need a collection of random variables: let {Y (),   } be a set of random variables in the probability space (, F , P ) (see also Appendix A). Thus Y () is a stochastic process with parameter   . Assume that  is a subset of real numbers (  R) and    is a random number held fixed. We consider the mapping   Y (,  ) as a random function which shows the output of a simulation algorithm at a parameter  when the random number is fixed. Therefore, we can explain
  Y

() =

  Y

(,  ) as the derivative of the random function with respect to  while  is fixed. We
  Y

assume that the derivative exists with probability 1 at each   . The quantity 15

() is known as

3.2. METHODS

CHAPTER 3. SENSITIVITY ANALYSIS

the pathwise derivative of Y at . We now interpret equation (3.1) as follows: the computation of Y () and Y ( + ) is done using common random numbers. If
Y 

exists then a natural question is when the following exists lim E ( Y ( +   ) - Y ( ) Y ( +   ) - Y ( ) ) = E ( lim ( )),  0   (3.2)

 0

that is, when the pathwise derivative estimator is unbiased. The equation (3.2) is true if and only if the sequence obtain this if we apply the theorem below. We Theorem(Vitali): Let (, F , P ) be a probability space. Assume Yn -  Y . Then, the sequence {Yn }n is uniformly integrable if and only if Yn is integrable for all n and lim E (Yn ) = E (Y ).
p Y ( + )-Y ( ) is uniformly integrable. Indeed we  p denote Yn -  Y the convergence in probability of the

sequence of random variables Yn to a random variable Y . (see also Appendix A).

n

As opposed to the finite difference approximation, in pathwise derivative (PD), the derivation is estimated directly, without simulating multiple times. By using this method, we obtain additional information about the dynamics of the system. The pathwise derivative method differentiates each simulation outcome with respect to the parameter to produce sensitivity estimates. The pathwise derivative method estimates the first order sensitivities [25], and produces unbiased estimates. Numerical methods are, in general, tailored to classes of problems. This is valid also for the PD method. There are some restrictions on using the pathwise derivative method, when studying stochastic chemical and biochemical networks. In this thesis, we employed the PD method for the continuous stochastic models of biochemical systems. This method applies to a large class of biochemical networks, and has important practical applications. Sheppard, Rathinam and Khammash [43] very recently presented a regularized pathwise derivative (RPD) method which estimates parameters sensitivities for discrete stochastic chemical reaction networks based on a modified form of the PD. 3. The Likelihood Ratio Method The likelihood ratio method (LRM) combines both the sensitivity and the specificity, which are statistical measurements. This technique allows to calculate all the sensitivities simultaneously in a single Monte Carlo simulation. In addition, the variance properties of LRM estimators are not affected by discontinuities in the system. In fact, the likelihood ratio method is an approach for estimating a derivative which requires no smoothness. By contrast, for the pathwise method the continuity in the function of the parameter of interest is an essential factor. A disadvantage of the likelihood ratio compared to the pathwise derivative, is that it has a significantly large variance [22]. The main drawback is that the statistical uncertainties of LRM estimators are difficult to predict, and can be sometimes large. In some cases such uncertainties cause divergence thus making the Monte Carlo simulation very time consuming [40]. 16

CHAPTER 3. SENSITIVITY ANALYSIS

3.2. METHODS

Plyasunov and Arkin [4] developed a likelihood ratio by using the Girsanov measure transformation for the sensitivity analysis of discrete stochastic chemical reaction networks. They applied their method using stochastic weights and the Girsanov measure transformation [4]. In the next section, we define the sensitivity of the state vector with respect to a parameter. If p is a parameter of the system and x = (x1 , x2 , ..., xN )T is the state vector, then the sensitivity of x with respect to the parameter p is x X1 XN T =( , ..., ) p p p

17

3.2. METHODS

CHAPTER 3. SENSITIVITY ANALYSIS

Monte Carlo Sensitivity Approaches

Finite perturbation

Infinitesimal perturbation

Independent Samples

Correlated Samples

Likelihood ih Ratio (LR)

Pathwise h Differentiation (PD)

Common Reaction Path (CRP)

SSA with common random numbers (CRN)

Other

Figure 3.1: Monte Carlo approaches for sensitivity analysis of stochastic models of chemical kinetics [43] 18

CHAPTER 3. SENSITIVITY ANALYSIS

3.3. SENSITIVITY ANALYSIS OF CME

3.3

Sensitivity Analysis of CME

As we know, the discrete stochastic model of well-stirred biochemical systems is the Chemical Master Equation [18]. The sensitivity of CME can be obtained by taking the derivative of the equation of CME (2.5) with respect to the parameters d P (x, t) ( ) dt p
M

=
k=1 M

ak (x - k ) {
k=1 M

P (x - k , t|x0 , t0 ) p (3.3)

- ×

P (x, t|x0 , t0 ) ak (x - k ) + } p p ak (x) P (x, t|x0 , t0 )} p

{P (x - k , t|x0 , t0 ) -
k=1

where P (x, t|x0 , t0 ) is the conditional probability of the system to be at state x at time t, given the initial condition x0 at time t0 . We denoted by k the stoichiometric change produced by one k -th reaction. M is the total number of reactions and ak (x) is the propensity function of the k -th reaction. To obtain the sensitivity, the equation (3.3) should be solved together with the CME (2.5). As the CME has a very large dimension, then the sensitivity together with the CME system consists of a differential equation system which is very large and thus very expensive to solve. As the SSA cannot be applied to solve the sensitivity equation, the stochastic sensitivity can be estimated by using the finite difference method. Thus, the density function sensitivity can be computed with P (x, p + p) - P (x, p - p) P = p 2p The p should be small enough to minimize error, but it should be large enough to avoiding the simulation error [24]. We remark that this method is very expensive for most models arising in applications.

19

3.4. SENSITIVITY ANALYSIS OF RRE

CHAPTER 3. SENSITIVITY ANALYSIS

3.4

Sensitivity Analysis of RRE

Consider a dynamical system described by a system of ordinary differential equations of the form dz = g(t, z, p) dt z(0) = c where dz/dt denotes the time derivative of the state z, with z(0) being the given initial condition. After differentiating (3.4) with respect to the parameter p, we obtain [5]: d z g z g  (dz/dt) = = + p dt p  z p p z (0) = 0 p This is the sensitivity system which depends on z. In order to estimate the solution z and the dimension of the system (3.4) is not too large. In a similar way, the sensitivity for the RRE is obtained by taking derivative of the reaction equation rate (2.10) with respect to one of the kinetic parameters, p: d x = dt p
M z p ,

(3.4)

(3.5)

we

solve the system (3.5) together with (3.4). The combined system can be solved efficiently provided that

k
k=1

ak (x(t))  x ak (x(t)) + x p p

(3.6)

The vector change  k is independent of the parameter p, therefore we need to take a derivative only from the density function ak (x(t)) with respect to p. The system (3.6) and (2.10) is known as the forward sensitivity analysis (FSA). It works for any RRE model. In order to estimate the sensitivity, we solve the equation (3.6) together with the RRE (2.10) for
x finding (x,  p ). Therefore, we have a system with M + M = 2M equations. Typically, the biochemical

systems arising in applications are stiff, and therefore stiff ode solvers are required.

20

CHAPTER 3. SENSITIVITY ANALYSIS

3.5. SENSITIVITY ANALYSIS OF CLE

3.5

Sensitivity Analysis of CLE

As discussed before, many biochemical systems arising in applications can be modeled by the continuous stochastic model of the Chemical Langevin equations. Below we propose a numerical method for estimating pathwise sensitivities with respect to kinetic parameters for the Chemical Langevin Equation model. Our proposed method is applicable to a wide class of biochemical networks arising in applications. Our method is a Monte Carlo-type scheme and typically it requires 10,000 trajectories. Let us employ the pathwise differentiation of the Chemical Langevin Equation to obtain the sensix tivities. If x is differentiable with respect to p (kinetic parameter) then we can estimate (  p ) using the

following formula obtained by differentiating the equation (2.9) with respect to p X ) p
M

d(

=
k=1 M

k k
k=1

ak (X(t))  (X) ak (X)(t) + dt  (X) p p  2 ak (X(t)) 1 ak (X(t))  X ak (X(t)) + X p p dWk

(3.7)

+

where Wk are independent Wiener processes. Hence k is the stoichiometric change in state vector x when one k th reaction occurs. The dimension of the stoichiometric matrix is N × M where N is number of state vectors and M is the total number of reactions. The initial conditions for sensitivities are x (0) = 0 p

since p is a kinetic parameter and the initial amount of molecules does not depend on a kinetic constant. In order to estimate the sensitivities, we solve the equation (3.7) together with the Chemical Langevin
x Equations (2.9) with respect to (x,  p ). Thus, we have a system with 2M equations and 2M unknowns.

We note that the combined system (2.9) and (3.7), having double numbers of equations compared to the Chemical Langevin Equation, it is generally almost twice as expensive to solve numerically as the CLE. We note that the pathwise sensitivity analysis uses the exact derivative with respect to a parameter instead of numerical differentiation, as does the finite-difference method. The pathwise sensitivity gives unbiased estimates of sensitivities. While this method has been successfully used in finance, it was not available in the literature for biochemical system modeling. One very important observation is that often in applications, and in particular in cellular dynamics, some kinetic parameters are not available. Then, it is quite important to know their influence on the system. If the system is robust with respect to that parameter, then its accurate estimation is not critical. In the next section, we discuss the numerical method to simulate the solution of the system in sensitivities described above.

21

Chapter 4

Numerical Methods
Stochastic differential equations (SDE) constitute an important class of models in sciences and engineering. However, the exact solution of SDEs can seldom be computed directly. For most stochastic systems, the numerical solution is the only tool available to study the problem. We give below a brief introduction to the numerical solution of SDEs. Given functions f , gj and initial value X0 , the stochastic process X(t) is a solution of the integral equation:
t M t

X(t) = X0 +
0

f (X(s))ds +
j =1 0

gj (X(s))dWj (s),

0<t<T

(4.1)

The integral on the right hand side is to be taken with respect to the Wiener process Wj . Here Wj are independent Wiener processes for 1  j  M . The solution X(t) is a random variable for each t. We can rewrite (4.1) in differential equation form as
M

dX = f (t, X)dt +
j =1

gj (t, X)dWj

(4.2)

where X(0) = X0 , 0  t  T . We consider the SDE form (4.2) instead of the integral form (4.1). If g  0 and X0 is constant, the problem is deterministic, that is (4.2) becomes the ordinary differential equation dX = f (t, X) dt X(0) = X0 In order to approximate the exact solution of (4.2) over the time-interval [0, T ], we choose a discretization grid. Suppose t = T /L for some positive integer L, and denote by j = j t for 0  j  L. The numerical approximation of the exact solution X(j ) is Xj . Among the many numerical methods to approximate the solution of SDEs, we discuss below one of the 22

CHAPTER 4. NUMERICAL METHODS most popular due to its easy implementation, the Euler-Maruyama (EM) method. The Euler-Maruyama method applied to the SDE (4.2) can be written as:
M

Xj = Xj -1 + f (Xj -1 )t +
j =1

gj (Xj -1 )(W (j ) - W (j -1 ))

or X(t + t) X(t) + f (t, X(t))t +

M

gj (t, X(t))Wj
j =1

Depending on the goal of the numerical simulation, numerical methods for SDEs can be classified in two categories: strong methods and weak methods. We are interested in using strongly convergent methods when we require the numerical solution to follow accurately the exact solution on each individual path. By contrast, we employ weakly convergent methods when we only require an accurate approximation of the moments of the exact solution. Definition: Let X be the solution of (4.2) on the interval [0, T ] and j = j t with t =
T L

for

some integer L and 0  j  L be some discretization grid. The numerical method is said to have strong numerical order of approximation  > 0 if there exists a constant C such that for any discretization (j ) 0  j  L, with t < (t)0 , the numerical solution Xj of X(j ) satisfies E |XL - X (T )|  C t The inequality (4.3) holds for  = order of approximation
1 2 1 2

(4.3)

for the Euler-Maruyama method thus this method has strong

[28].
T L

In the above definition E (.) denotes the expectation of the random variable. Definition: Let X be the solution of (4.2) on the interval [0, T ] and j = j t with t = for some integer L and 0  j  L be some discretization grid. The numerical method is said to have weak numerical order of approximation  > 0 if there exists a constant C > 0 such that for any discretization (j ) 0  j  L, with t < (t)0 , the numerical solution Xj of X(j ) satisfies |Ep (XL ) - Ep (X (T ))|  C t , for any polynomial p. (4.4)

The inequality (4.4) holds for  = 1 for the Euler-Maruyama Method, thus this method has weak order of approximation 1 [28]. We remark that numerical methods of strong order 1 or higher exist (see [28] and references thesis). One such example is the Milstein method, which has strong order of convergence 1. However, for SDEs with non-commutative noise, as is the case of the Chemical Langevin Equation, numerical methods of strong order higher or equal to 1 require the simulation of the double It^ o integrals
t+t s1

Iij =
t t

dWi (s2 )dWj (s1 ) for 1  i, j  M .

(4.5)

These integrals are computationally very expensive, as they can not be generated in terms of only 23

CHAPTER 4. NUMERICAL METHODS Wiener increments. They are simulated using truncated Fourier series. Thus we employ the Euler-Maruyama method for the CLE (2.9) and we obtain
M M

X(t +  t)

X(t) +
j =1

j aj (X)t +
j =1

j

 aj (x) t.Nj (0, 1)

(4.6)

where j denotes the state change vector when the j -th reaction occurs, aj (X) denotes the propensity functions of the j -th reaction, Nj (0, 1) is a normal distribution of mean 0 and variance 1 and M is the total number of reactions. By applying the Euler-Maruyama method to the stochastic differential equation for sensitivities (3.7) we obtain  X (t +  t) p = +
k=1

 X(t) + p
M

M

k
k=1

ak (X)(t))  (X) ak (X)(t)) + t  (X) p p ak (X)(t)  X ak (X)(t))  t.Nk (0, 1) + X p p

(4.7)

k  2 ak (X)(t)

1

The equations (4.6) and (4.7) generate the numerical solution of the system of the CLE (2.9) and of the pathwise sensitivities (3.7). The numerical results on several applications, for estimating sensitivities, are presented in the next chapter.

24

Chapter 5

Numerical Results
In this section we apply the sensitivity analysis discussed above to some relevant models in applications. The models we consider are the Lotka-Volterra model, the Michaelis-Menten model and a system of stiff, nonlinear CLE. The numerical results are also presented. We shall notice that the sensitivity analysis of the RRE doesn't give accurate results for the models under conditions, and thus a stochastic sensitivity analysis is required for an accurate estimate of the sensitivities. Our method has the advantage that it computes the sensitivity of each individual trajectory. To achieve this, we use common random numbers for estimating the dependence on a parameter of one trajectory. This common number procedure is critical for the accurate computation of sensitivities.

5.1

Lotka-Volterra Model

The Lotka-Volterra model describes the interaction between two species in any ecosystem. The model was developed independently by Alfred Lotka, an American biophysicist (1925), and Vito Volterra, an Italian mathematician (1926), see also [42]. The Lotka-Volterra model is the simplest model of predator-prey interactions. The interacting species are: · a prey Y1 · a predator Y2 The reactions are given in Table 5.1, where we also give the propensities corresponding to each reaction and the values of the reaction rate parameters.

The reaction R1 represents the prey reproduction, the reaction R2 is the predator-prey interaction and the reaction R3 is the predator death. 25

5.1. LOTKA-VOLTERRA MODEL

CHAPTER 5. NUMERICAL RESULTS

Reaction channel
1 Y1 - 2Y1

Reaction propensity

Reaction rate

R1 R2 R3

k

a1 = k1 Y1 a2 = k2 Y1 Y2 a3 = k3 Y2

k1 = 1 k2 = 0.005 k3 =0.6

2 Y1 + Y2 - 2Y2

k

3 Y2 - 

k

Table 5.1: Lotka-Volterra chemical reaction model

We use the initial conditions for the species Y1 (0) = Y2 (0) = 100 and integrate the system on the time interval [0, 50]. Since we have two species, the model will involve two equations, one which describes the evolution of the prey population and the second which describes the evolution of the predator population. If reaction R1 takes place, then Y1 decreases by one and increases by two (-1 + 2 = 1), and Y2 is unchanged, so  1 becomes 1 = 1 0

Similarly, we can compute the state change vectors for reactions R2 and R3 . Therefore the stoichiometric matrix of the model is 1 0 -1 1 0 -1

=

The deterministic model of the reaction rate equations for the Lotka-Volterra model is: dY1 (t)/dt = k1 Y1 (t) - k2 Y1 (t)Y2 (t),

dY2 (t)/dt

= k2 Y1 (t)Y2 (t) - k3 Y2 (t),

The reaction rate k1 is the intrinsic rate of prey population increase, k2 is the predation rate coefficient and k3 is the predator mortality rate. The Chemical Langevin equations for the Lotka-Volterra model are written as: dY1 (t) = {k1 Y1 (t) - k2 Y1 (t)Y2 (t)}dt + 26 k1 Y1 (t)dW1 - k2 Y1 (t)Y2 (t)dW2 ,

CHAPTER 5. NUMERICAL RESULTS

5.1. LOTKA-VOLTERRA MODEL

dY2 (t)

=

{k2 Y1 (t)Y2 (t) - k3 Y2 (t)}dt +

k2 Y1 (t)Y2 (t)dW2 -

k3 Y2 (t)dW3 ,

We analyze the sensitivity of the Lotka-Volterra system with respect to the parameter k1 . The sensitivity equations for the prey Y1 are: d( Y1 ) k1
3

=
k=1 3

 1k  1k
k=1

ak (Y(t))  (Y) ak (Y(t)) dt +  (Y) k1 k1 2 ak (Y(t))  (Y) ak (Y(t)) + dWk (t)  (Y ) k1 k1 ak (Y(t)) 1 Y1 Y1 Y2 - k2 Y2 - k2 Y1 }dt k1 k1 k1

+

= {Y1 + k1

+

Y1 1  (Y1 + k1 )dW1 k1 2 k1 Y1 1 Y1 Y2  (k2 Y2 + k2 Y1 )dW2 k1 k1 2 k2 Y1 Y2

-

The sensitivity equations for the predator Y2 can be written as: Y2 d( ) k1
3

=
k=1 3

 2k  2k
k=1

ak (Y(t))  (Y) ak (Y(t)) + dt  (Y) k1 k1 1 2 ak (Y(t)) ak (Y(t))  (Y) ak (Y(t)) + dWk (t)  (Y ) k1 k1

+

=

{k2 Y2

Y1 Y2 Y2 + k2 Y1 - k3 }dt k1 k1 k1

+

1 Y1 Y2  (k2 Y2 + k2 Y1 )dW2 k1 k1 2 k2 Y1 Y2 1 Y2 k3 dW3 2 k3 Y2 k1 
 Y1 k1 |t=0

-

These equations are integrated with the initial conditions

= 0 and

 Y2 k1 |t=0

= 0 since the

initial amount of Y1 and Y2 do not depend on the kinetic parameter k1 .

27

5.1. LOTKA-VOLTERRA MODEL

CHAPTER 5. NUMERICAL RESULTS

The equations have periodic solutions as one can observe from Figure 5.1. In order to accurately approximate the probability distribution of the sensitivities we need a large number of trajectories. Here we run our simulations for 10,000 trajectories. We evaluate the mean of the sensitivities of the Chemical Langevin Equations with the fixed step size 20 × 10-4 . For this problem, the mean sensitivities for CLE are well approximated by the sensitivity for RRE. Figure 5.1 shows the sensitivity with respect to k1 for the deterministic model (RRE) and the mean of the sensitivity with respect to parameter k1 for the CLE. As we can see, the stochastic and deterministic plots have a good agreement. Therefore, on this model, the mean of pathwise sensitivities approximates well the sensitivity in the RRE. In Figure 5.1, we plotted the standard deviation of the sensitivity with respect to parameter k1 for the CLE of the Lotka-Volterra system. We see that the standard deviation is not negligible on this model, while it is zero for the RRE model. This plot gives an information about the spread of the values for sensitivities compared to the mean value (as given by the RRE). Moreover, our sensitivity analysis estimates the sensitivity on each individual trajectory. Thus, the sensitivity analysis of the RRE model fails to capture the variability in sensitivities for models of biochemical systems which have some molecular species in low population numbers.

28

CHAPTER 5. NUMERICAL RESULTS
400 350

5.1. LOTKA-VOLTERRA MODEL
Y1 Y2

Number of Molecules of Y1 & Y2

300 250 200 150 100 50 0

0

2

4

6

8

10 12 Time(sec)

14

16

18

20

2000 Y1stoch 1500 Y2stoch Y1det Y2det

Sensitivity for CLE & RRE

1000

500

0

-500

-1000 0

2

4

6

8

10 12 Time(sec)

14

16

18

20

Figure 5.1: Evolution in time of the number of molecules (top) and of the sensitivities for k1 for RRE and of the mean of sensitivities for CLE (bottom) Y 1stoch and Y 2stoch : the mean of the sensitivity of the CLE for Y1 and Y2 (stochastic plots) Y 1det and Y 2det : the sensitivity for RRE for the species Y1 and Y2 (deterministic plots)

29

5.1. LOTKA-VOLTERRA MODEL
400 350

CHAPTER 5. NUMERICAL RESULTS

Y1 Y2

Number of Molecules of Y1 & Y2

300 250 200 150 100 50 0

0

2

4

6

8

10 12 Time(sec)

14

16

18

20

700 stdY1 600 stdY2

std of sensitivity for CLE

500

400

300

200

100

0

0

2

4

6

8

10 12 Time(sec)

14

16

18

20

Figure 5.2: Evolution in time of the number of molecules (top) and of the sensitivities for k1 for RRE and of the std of sensitivities for k1 for CLE (bottom) stdY 1 and stdY 2 : the standard deviation of sensitivities with respect to the parameter k1 for CLE

30

CHAPTER 5. NUMERICAL RESULTS

5.2. MICHAELIS-MENTEN MODEL

5.2

Michaelis-Menten Model

Next, we analyze a key model of biochemical systems, the Michaelis-Menten model which is a system with four species: · a substrate Y1 · an enzyme Y2 · a complex Y3 · a product Y4 Many biochemical reactions utilize enzymes. An enzymatic reaction that transforms the substrate Y1 into a product Y4 requires the formation of a complex Y3 between the substrate Y1 and the enzyme Y2 . In fact, the enzyme acts as a catalyst for the reaction. After the formation of the product Y4 , the enzyme Y2 is released. This is summarized in the system of reactions in Table 5.2.

Reaction channel
1 Y1 + Y2 - Y3

Reaction propensity

Reaction rate k1 = 106 /(nA vol) k2 = 10-4 k3 = 10-1

R1 R2 R3

k

a1 = k1 Y1 Y2 a2 = k2 Y3 a3 = k3 Y3

2 Y3 - Y1 + Y2

k

3 Y3 - Y4 + Y2

k

Table 5.2: The Michaelis-Menten chemical reaction system

We assume that the reaction between the substrate and the enzyme, which produces the substrate/enzyme complex occurs at rate k1 and the reverse reaction at rate k2 . The reaction between the substrate/enzyme complex which results in the product and the enzyme occurs at rate k3 . The models for this reaction were first studied by Michaelis and Menten [36] under some assumptions. A more realistic model was developed by Briggs and Haldane [7]. We use the initial conditions Y1 (0) = 5 × 10-7 nA vol , Y2 (0) = 2 × 10-7 nA vol and Y3 (0) = Y4 (0) = 1 and we integrate on the time interval [0, 50]. We denote by nA = 6.023 × 1023 the Avagadro's number and by vol = 10-15 the volume of the system. The Chemical Langevin equations for the Michaelis-Menten model are written as: dY1 (t) = {-k1 Y1 (t)Y2 (t) + k2 Y3 (t)}dt - 31 k1 Y1 (t)Y2 (t)dW1 + k2 Y3 (t)dW2

5.2. MICHAELIS-MENTEN MODEL

CHAPTER 5. NUMERICAL RESULTS

Figure 5.3: The Michaelis-Menten mechanism of enzyme action

dY2 (t)

= +

{-k1 Y1 (t)Y2 (t) + (k2 + k3 )Y3 (t)}dt - k2 Y3 (t)dW2 + k3 Y3 (t)dW3

k1 Y1 (t)Y2 (t)dW1

dY3 (t)

= {k1 Y1 (t)Y2 (t) - (k2 + k3 )Y3 (t)}dt + - k2 Y3 (t)dW2 - dY4 (t) k3 Y3 (t)dW3

k1 Y1 (t)Y2 (t)dW1

= {k3 Y3 (t)}dt +

k3 Y3 (t)dW3

Since the system has four species, it has dimension four, one equation for each different molecular species. The deterministic model of the RRE is obtained by neglecting the stochastic terms:

dY1 (t)/dt dY2 (t)/dt dY3 (t)/dt dY4 (t)/dt

= -k1 Y1 (t)Y2 (t) + k2 Y3 (t), = -k1 Y1 (t)Y2 (t) + (k2 + k3 )Y3 (t) = k1 Y1 (t)Y2 (t) - (k2 + k3 )Y3 (t) = k3 Y3 (t).

Below, we study the sensitivity of the Michaelis-Menten system with respect to the parameter k2 . The sensitivity system is: 32

CHAPTER 5. NUMERICAL RESULTS

5.2. MICHAELIS-MENTEN MODEL

d(

Y1 ) k2

3

=
k=1 3

 1k  1k
k=1

ak (Y(t))  (Y) ak (Y(t)) dt +  (Y) k2 k2 2 ak (Y(t))  (Y) ak (Y(t)) dWk (t) +  (Y ) k2 k2 ak (Y(t)) 1

+

=

{-k1 Y2

Y1 Y2 Y3 - k1 Y1 + k2 + Y3 }dt k2 k2 k2

-

Y1 Y2 1  (k1 Y2 + k1 Y1 )dW1 k2 k2 2 k1 Y1 Y2 1 Y3  (k2 + Y3 )dW2 k2 2 k2 Y3

+

d(

 Y2 ) k2

3

=
k=1 3

 2k  2k
k=1

ak (Y(t))  (Y) ak (Y(t)) + dt  (Y) k2 k2 2 ak (Y(t))  (Y) ak (Y(t)) + dWk (t)  (Y ) k2 k2 ak (Y(t)) 1

+

=

{-k1 Y1

Y2 Y1 Y3 Y3 - k1 Y2 + Y3 + k2 + k3 }dt k2 k2 k2 k2

-

Y2 Y3 Y1 1 1  (k1 Y1 (Y3 + k2 + k1 Y2 )dW1 +  )dW2 k k k2 2 k1 Y1 Y2 2 k2 Y3 2 2 1 Y3  )dW3 (k3 k2 2 k3 Y3

+

The sensitivity equations for Y3 , Y4 can be written as d( Y3 ) k2 = {k1 Y1 Y2 Y1 Y3 Y3 + k1 Y2 - Y3 - k2 - k3 }dt k2 k2 k2 k2

+

1 Y1 1 Y2 Y3  + k1 Y2 )dW1 -  )dW2 (k1 Y1 (Y3 + k2 k2 k2 k2 2 k1 Y1 Y2 2 k2 Y3 1 Y3  (k3 )dW3 k2 2 k3 Y3 {k3 Y3 1 Y3 +  (k3 )dW3 k2 k2 2 k3 Y3 33

- Y4 ) k2

d(

=

5.2. MICHAELIS-MENTEN MODEL

CHAPTER 5. NUMERICAL RESULTS

Figure 5.4 shows the evolution in time of the sensitivity with respect to k2 for the deterministic model (RRE) and the mean of the sensitivity with respect to parameter k2 for the CLE, for the MichaelisMenten system. We find a good agreement between them. In the bottom of Figure 5.5, we present the plots of the standard deviation of the sensitivity with respect to parameter k2 for the CLE of the Michaelis-Menten system. We see that the std is not negligible in the CLE model, while it is zero for the RRE model. Thus, the sensitivities of RRE do not accurately describe the dependence on the kinetic parameter, of the system's dynamics.

34

CHAPTER 5. NUMERICAL RESULTS

5.2. MICHAELIS-MENTEN MODEL

350

300

250 Y1 Y2 Y3 Y4

200

150

100

50

0 0 5 10 15 20 25 30 35 40 45 50

600 Y1stoch Y2stoch 400 Y3stoch Y4stoch 200 Y1det Y2det 0 Y3det Y4det

-200

-400

-600 0

5

10

15

20

25

30

35

40

45

50

Figure 5.4: The evolution in time of the number of molecules (top) and of the sensitivities for k2 for the RRE, and of the mean of sensitivities for the CLE (bottom)

35

5.2. MICHAELIS-MENTEN MODEL
350

CHAPTER 5. NUMERICAL RESULTS

300

250 Y1 Y2 Y3 Y4

200

150

100

50

0 0 5 10 15 20 25 30 35 40 45 50

1800 1600 1400 1200 1000 800 600 400 200 0 0 5 10 15 20 25 30 35 40 45 50 stdY1 stdY2 stdY3 stdY4

Figure 5.5: The evolution in time of the number of molecules (top) and of the std of the sensitivities for k2 for the CLE (bottom)

36

CHAPTER 5. NUMERICAL RESULTS

5.3. A SYSTEM OF STIFF, NONLINEAR CLES

5.3

A system of stiff, nonlinear CLEs

Finally, we present a biochemical system of reversible reactions (see [44]). This system is challenging due to its high degree of stiffness. In spite of its stiffness, this model can be studied very well with the sensitivity analysis we proposed.

Reaction channel R1 R2 R3 R4 R5 R6
1 S1 + S2 - S3 2 S3 - S1 + S2 3 S1 + S3 - S2 4 S2 - S1 + S3 5 S2 + S3 - S1 6 S1 - S2 + S3

Reaction propensity a1 = c1 S1 S2 a2 = c2 S3 a3 = c3 S1 S3 a4 = c4 S2 a5 = c5 S2 S3 a6 = c6 S1

Reaction rate c1 = 103 (molecules-1 s-1 ) c2 = 103 (s-1 ) c3 = 10-5 (molecules-1 s-1 ) c4 = 10(s-1 ) c5 = 1.0(molecules-1 s-1 ) c6 = 106 (s-1 )

c

c

c

c

c

c

Table 5.3: A stiff, nonlinear Chemical reaction model.

We estimate the initial conditions S1 (0) = S2 (0) = 103 molecules and simulate the system on the time interval [0, 0.01]s on 10,000 trajectories . The system is stiff because it has multiple time-scales, with slow and fast reactions with the fast ones being stable [44]. The corresponding CLEs model is dS1 (t) = - + dS2 (t) = - - dS3 (t) = + - {-c1 S1 (t)S2 (t) + c2 S3 (t) - c3 S1 (t)S3 (t) + c4 S2 (t) + c5 S2 (t)S3 (t) - c6 S1 (t)}dt c1 S1 (t)S2 (t)dW1 + c5 S2 (t)S3 (t)dW5 - c2 S3 (t)dW2 - c6 S1 (t)dW6 c3 S1 (t)S3 (t)dW3 + c4 S2 (t)dW4

{-c1 S1 (t)S2 (t) + c2 S3 (t) + c3 S1 (t)S3 (t) - c4 S2 (t) - c5 S2 (t)S3 (t) + c6 S1 (t)}dt c1 S1 (t)S2 (t)dW1 + c5 S2 (t)S3 (t)dW5 + c2 S3 (t)dW2 + c6 S1 (t)dW6 c3 S1 (t)S3 (t)dW3 - c4 S2 (t)dW4 (5.1)

{c1 S1 (t)S2 (t) - c2 S3 (t) - c3 S1 (t)S3 (t) + c4 S2 (t) - c5 S2 (t)S3 (t) + c6 S1 (t)}dt c1 S1 (t)S2 (t)dW1 - c2 S3 (t)dW2 - c3 S1 (t)S3 (t)dW3 + c4 S2 (t)dW4 c5 S2 (t)S3 (t)dW5 + c6 S1 (t)dW6

37

5.3. A SYSTEM OF STIFF, NONLINEAR CLES

CHAPTER 5. NUMERICAL RESULTS

The RREs model for this reaction system is obtained by neglecting the noise in the system: dS1 (t)/dt dS2 (t)/dt dS3 (t)/dt = = = -c1 S1 (t)S2 (t) + c2 S3 (t) - c3 S1 (t)S3 (t) + c4 S2 (t) + c5 S2 (t)S3 (t) - c6 S1 (t) -c1 S1 (t)S2 (t) + c2 S3 (t) + c3 S1 (t)S3 (t) - c4 S2 (t) - c5 S2 (t)S3 (t) + c6 S1 (t) c1 S1 (t)S2 (t) - c2 S3 (t) - c3 S1 (t)S3 (t) + c4 S2 (t) - c5 S2 (t)S3 (t) + c6 S1 (t)

(5.2)

We study the sensitivity of the reaction system with respect to the parameter c4 . The sensitivities are obtained by taking the derivative with respect to c4 in the system (5.1). The derivative of the first equation gives: d( S1 ) c4 = {-c1 S1 S2 S1 S3 S3 S1 - c1 S2 + c2 - c3 S1 - c3 S3 + S2 c4 c4 c4 c4 c4

+

c4

S2 S3 S2 S1 + c5 S2 + c5 S3 - c6 }dt c4 c4 c4 c4

-

S2 S1 1 S3 1 (c1 S1 + c1 S2 )dW1 +  (c2 )dW2 c4 c4 c4 2 c1 S1 S2 2 c2 S3  1 S3 S1  (c3 S1 + c3 S3 )dW3 c4 c4 2 c3 S1 S3 1 S2 1 S3 S2 (S2 + c4 )dW4 +  (c5 S2 + c5 S3 )dW5 c4 c4 c4 2 c4 S2 2 c5 S2 S3  1 S1  (c6 )dW6 c4 2 c6 S1

-

+

-

38

CHAPTER 5. NUMERICAL RESULTS

5.3. A SYSTEM OF STIFF, NONLINEAR CLES

Taking derivative with respect to c4 in the second equation leads to: d( S2 ) c4 = {-c1 S1 S2 S1 S3 S3 S1 - c1 S2 + c2 + c3 S1 + c3 S3 c4 c4 c4 c4 c4 S2 S3 S2 S1 - c5 S2 - c5 S3 + c6 }dt c4 c4 c4 c4

- S2 - c4

-

1 S2 S3 S1 1  (c1 S1 (c2 + c1 S2 )dW1 +  )dW2 c4 c4 c4 2 c1 S1 S2 2 c2 S3 S3 S1 1 (c3 S1 + c3 S3 )dW3 c c4 2 c3 S1 S3 4  1 1 S2 S3 S2 (S2 + c4 )dW4 -  (c5 S2 + c5 S3 )dW5 c4 c4 c4 2 c4 S2 2 c5 S2 S3  1 S1  (c6 )dW6 c4 2 c6 S1

+

-

+

A similar behavior is observed for d(

S3 ). c4

To obtain the deterministic plots for the sensitivities with respect to c4 , we use an ode solver for approximating the solution of the following system:

dS1 (t) = -c1 S1 S2 + c2 S3 - c3 S1 S3 + c4 S2 + c5 S2 S3 - c6 S1 dt dS2 (t) = -c1 S1 S2 + c2 S3 + c3 S1 S3 - c4 S2 - c5 S2 S3 + c6 S1 dt dS3 (t) = c1 S1 S2 - c2 S3 - c3 S1 S3 + c4 S2 - c5 S2 S3 + c6 S1 dt d S1 dt c4 S2 S1 S3 S3 S1 - c1 S2 + c2 - c3 S1 - c3 S3 c4 c4 c4 c4 c4 S2 S3 S2 S1 + c5 S2 + c5 S3 - c6 c4 c4 c4 c4

=

-c1 S1

+

S2 + c4

39

5.3. A SYSTEM OF STIFF, NONLINEAR CLES d S2 dt c4

CHAPTER 5. NUMERICAL RESULTS

=

-c1 S1

S2 S1 S3 S3 S1 - c1 S2 + c2 + c3 S1 + c3 S3 c4 c4 c4 c4 c4 S2 S3 S2 S1 - c5 S2 - c5 S3 + c6 c4 c4 c4 c4

-

S2 - c4

d S3 dt c4

= c1 S1

S2 S1 S3 S3 S1 + c1 S2 - c2 - c3 S1 - c3 S3 c4 c4 c4 c4 c4 S2 S3 S2 S1 - c5 S2 - c5 S3 + c6 c4 c4 c4 c4 =
S2 c4 (0)

+ S2 + c4

with initial conditions for sensitivities

S1 c4 (0)

=

S3 c4 (0)

= 0.

40

CHAPTER 5. NUMERICAL RESULTS
1200 A 1150 S1 S2

5.3. A SYSTEM OF STIFF, NONLINEAR CLES
1.0002 x 10 B 1.0002
6

S3

Number of Molecules of S1 & S2

1100

1050

Number of Molecules of S3

1.0001

1.0001

1000

1

950

1 900 0.9999

850

800

0

0.002

0.004 0.006 Time(sec)

0.008

0.01

0.9999

0

0.002

0.004 0.006 Time(sec)

0.008

0.01

20 0.025 C D

Sensitivity for CLE & RRE

0.02 0.015 S1stoch 0.01 0.005 0 -0.005 0 x 10 3 E
-3

Sensitivity for CLE & RRE

15

S2stoch S1det S2det

10 S3_{stoch S3det 5

0.002

0.004 0.006 Time(sec)

0.008

0.01

0

0

0.002

0.004 0.006 Time(sec)

0.008

0.01

0.45

F

Sensitivity for CLE & RRE

2.5 2 1.5 1 0.5 0 S1stoch S2stoch S1det S2det

Sensitivity for CLE & RRE

0.4 0.35 0.3 0.25 0.2 0.15 S3stoch S3det

-0.5 2 4 6 8 10 Time(sec) A zoom in on above picture 12 14 x 10
-4

1

1.5 2 Time(sec) A zoom in on above picture

2.5 x 10
-4

Figure 5.6: The evolution in time of the numbers of molecules of the species S1 , S2 and S3 , and of the sensitivities for the RRE and of the mean of sensitivities for the CLE.

41

5.3. A SYSTEM OF STIFF, NONLINEAR CLES

CHAPTER 5. NUMERICAL RESULTS

In Figure 5.6, the plots present. (A) A sample trajectory of the number of molecules of S1 and S2 . (B) A sample trajectory of the number of molecules of S3 . (C) The sensitivities of S1 and S2 with respect to the parameter c4 for the RRE and the mean of the sensitivities of S1 and S2 for the CLE in the interval [0,0.01]s.(D) The sensitivities of S3 with respect to c4 for the RRE and of the mean of sensitivities of S3 for the CLE in the interval [0,0.01]s. The results were obtained on 1000 trajectories. Because of the notable behavior of the species of S3 , we used a separate plot for it. This behavior is due to the large initial amount of molecules this species in comparison with the other species. Therefore the noise term effect on it is not large.

42

CHAPTER 5. NUMERICAL RESULTS

5.3. A SYSTEM OF STIFF, NONLINEAR CLES

1

3.5 3

x 10

-3

0.9

std of sensitivity for CLE

2.5 2 1.5 1 0.5 0 0 0.002 0.004 0.006 Time(sec) 0.008 stdS1 stdS2 0.01

0.8

0.7

std of sensitivity for CLE

0.6

0.5 x 10 0.4 3.2 3.1 0.3 3 2.9 0.2 2.8 2.7 0.1 stdS3 0 0 0.002 0.004 0.006 Time(sec) 0.008 0.01 2.6 2.5 2 4 6 Time(sec) A zoom in on above picture 8 x 10
-3 -3

stdS1 stdS2

Figure 5.7: The standard deviation (std) of the sensitivities with respect to c4 for the Chemical Langevin Equation(CLE) on the third model.

43

Chapter 6

Conclusion
This thesis discussed the mathematical modeling and simulation of well-stirred biochemical systems. Such systems appear in the study of important biological processes, and in particular of the cellular dynamics. We focused on a stochastic continuous model of these biochemical systems, namely the Chemical Langevin Equation. The classical deterministic continuous models of (bio)-chemical reactions, the well-known model of the reaction rate equations, were extensively studied in the past. The stochastic models of biochemical reactions are much less considered. In particular, the sensitivity analysis of the deterministic model was well-developed, while a strong parametric sensitivity of the stochastic continuous models is not available in the literature. We developed such a pathwise (strong) sensitivity analysis of the stochastic continuous model of biochemical systems, the Chemical Langevin Equation. We tested the sensitivities obtained with our method on several models. We compared the mean of the sensitivities of the Chemical Langevin equation, with the sensitivities of the simplified deterministic model of the reaction rate equation and found a good agreement. Our sensitivity analysis provides information about the statistics of sensitivities for the Chemical Langevin equation, such as their standard deviation and higher order moments of the distributions. This information can not be obtained from deterministic models. In the presence of a given data set and of many parameters, responses will not change equally to similar changes in parameters, some are sensitive and some are not. The parameter space we wish to fit can be reduced by examining with respect to which parameters the system is sensitive and with respect to which the system is not sensitive. We plan to investigate this problem in the future.

44

Appendix A

Convergence in probability
We denote by  a given set. Definition: If  is a set, then a  -algebra F on  is a family F of subsets of  with the following properties: · F · F  F then the complement of F , F c  F . · A1 , A2 , ...  F then A :=
 i=1

Ai  F .

The pair (, F ) is called a measurable space. A probability measure P on a measurable space (, F ) is a function P : F  [0, 1] satisfying (i) P () = 0 and P () = 1.


(ii) If A1 , A2 , ...  F and Ai P(
 i=1

Ai ) =

 i=1

i=1

is disjoint (i.e Ai  Aj =  if i = j ) then

P (Ai ).

The triple (, F , P ) is called a probability space. Definition: Let (, F , P ) be a probability space. A family {fj } j  J of real and measurable functions fj on  is called uniformly integrable if it satisfies lim supj J
|fj |>M

M 

|fj |dP

=0

Definition: Let (, F , P ) be a probability space. The sequence of random variables (Yn )n is said to converge in probability to a random variable Y , and is denoted by Yn -  Y if P  : |Yn ( ) - Y ( )| > for any given > 0. 45 0 as n
p

Appendix B

Matlab code
The Lotka-Volterra model code %stoichiometric matrix V = [1 -1 0 ;0 1 -1]; Y = zeros(2,1); D = zeros(2,1); Y(1) = 100; Y(2) = 100; k1 = 1; k2 = 0.005; k3 = 0.6; tfinal = 20; L = 10000; tau = tfinal/L; tvals = [0:tau:tfinal]; NumberOfRuns=100; Yvals =zeros(NumberOfRuns,2, L+1); Dvals = zeros(NumberOfRuns,2, L+1); Y1 = 100; Y2 = 100; D1 = 0; D2 = 0; % This is for 1st column of Yvals and Dvals %number of trajectries % stepsize

Yvals(:,1,1) = Y1; Yvals(:,2,1) = Y2; Dvals(:,1,1) = D1; Dvals(:,2,1) = D2; for j=1:NumberOfRuns Y(1) = Y1; 46

APPENDIX B. MATLAB CODE Y(2) = Y2; D = zeros(2,1); for k = 1:L n = randn(4, 1); % terms for the number of molecules a(1) = k1*Y(1); a(2) = k2*Y(1)*Y(2); a(3) = k3*Y(2); d(1) = tau*a(1) + sqrt(abs(tau*a(1)))*n(1); d(2) = tau*a(2) + sqrt(abs(tau*a(2)))*n(2); d(3) = tau*a(3) + sqrt(abs(tau*a(3)))*n(3); % terms for sensitivities Da(1) = Y(1)+ k1*D(1,1); Da(2) = k2*D(1,1)*Y(2) + k2*Y(1)*D(2,1); Da(3) = k3*D(2,1); Dd(1) = Da(1)* tau + 1/2*sqrt(abs(tau/a(1)))* Da(1)*n(1); Dd(2) = Da(2)* tau + 1/2*sqrt(abs(tau/a(2)))* Da(2)*n(2); Dd(3) = Da(3)* tau + 1/2*sqrt(abs(tau/a(3)))* Da(3)*n(3); % number of molecules Y = Y + d(1)*V(:,1) + d(2)*V(:,2) + d(3)*V(:,3); % sensitivity for k4 D = D + Dd(1)*V(:,1) + Dd(2)*V(:,2) + Dd(3)*V(:,3); Yvals(j,1,k+1) = Y(1); Yvals(j,2, k+1) = Y(2); Dvals(j,1, k+1) = D(1,1); Dvals(j,2, k+1) = D(2,1); end end %mean & standard division of Dvals meanDvals =zeros(L+1,2); stdDvals =zeros(L+1,2); for r=1:L meanDvals(r+1,1) = mean (Dvals(:,1, r+1)); meanDvals(r+1,2) = mean (Dvals(:,2, r+1)); 47

APPENDIX B. MATLAB CODE stdDvals(r+1,1) = std(Dvals(:,1, r+1)); stdDvals(r+1,2) = std(Dvals(:,2, r+1)); end

opts = odeset('abstol', 1.e-6); LV=@ (tt,yy)[ k1*yy(1) - k2*yy(1)*yy(2); k2*yy(1)*yy(2)- k3*yy(2);... yy(1)+ k1*yy(3)- k2*yy(3)*yy(2)-k2*yy(4)*yy(1);... k2*yy(3)*yy(2)+k2*yy(4)*yy(1)-k3*yy(4)]; [tt, yy] = ode45(LV, [0,20], [Y1,Y2,0,0], opts); %probability density function(pdf) of Yvals & Dvals X1=round(Yvals(:,1,L+1)); XD1=round(Dvals(:,1,L+1)); X2=round(Yvals(:,2,L+1)); XD2=round(Dvals(:,2,L+1)); %hist(X1) [n1, xout1] = hist(X1); [nD1, xoutD1] = hist(XD1); [n2, xout2] = hist(X2); [nD2, xoutD2] = hist(XD2);

48

APPENDIX B. MATLAB CODE The Michaelis-Menten model code %stoichiometric matrix V = [-1 1 0 ;-1 1 1 ; 1 -1 -1 ; 0 0 1]; Y = zeros(4,1); D = zeros(4,1); nA = 6.023e23; vol = 1e-15; Y(1) = round(5e-7*nA*vol); Y(2) = round(2e-7*nA*vol); Y(3) = 1; Y(4) =1; k1 = 1e6/(nA*vol); k2 = 1e-4; k3 = 0.1; tfinal = 50; L = 1000; tau = tfinal/L; tvals = [0:tau:tfinal]; NumberOfRuns=2; %number of trajectries % stepsize

Yvals =zeros(NumberOfRuns,4, L+1); Dvals = zeros(NumberOfRuns,4, L+1); Y1 = round(5e-7*nA*vol); Y2 = round(2e-7*nA*vol); Y3 =1; Y4=1; D1 = 0; D2 = 0; D3 = 0; D4 = 0; % This is for 1st column of Yvals and Dvals

Yvals(:,1,1) = Y1; Yvals(:,2,1) = Y2; Yvals(:,3,1) = Y3; Yvals(:,4,1) = Y4; Dvals(:,1,1) = D1; Dvals(:,2,1) = D2; Dvals(:,3,1) = D3; Dvals(:,4,1) = D4; for j=1:NumberOfRuns Y(1) = Y1; Y(2) = Y2; Y(3) = Y3; Y(4) = Y4; D = zeros(4,1); for k = 1:L 49

APPENDIX B. MATLAB CODE n = randn(4, 1); % terms for the number of molecules a(1) = k1*Y(1)*Y(2); a(2) = k2*Y(3); a(3) = k3*Y(3); d(1) = tau*a(1) + sqrt(abs(tau*a(1)))*n(1) ; d(2) = tau*a(2) + sqrt(abs(tau*a(2)))*n(2) ; d(3) = tau*a(3) + sqrt(abs(tau*a(3)))*n(3); % terms for sensitivities Da(1) = k1*Y(2)*D(1,1) + k1*Y(1)*D(2,1); Da(2) = k2*D(3,1) + Y(3); Da(3) = k3*D(3,1); Dd(1) = Da(1)* tau + 1/2*sqrt(abs(tau/a(1)))* Da(1)*n(1); Dd(2) = Da(2)* tau + 1/2*sqrt(abs(tau/a(2)))* Da(2)*n(2); Dd(3) = Da(3)* tau + 1/2*sqrt(abs(tau/a(3)))* Da(3)*n(3); % number of molecules Y = Y + d(1)*V(:,1) + d(2)*V(:,2) + d(3)*V(:,3); % sensitivity for k4 D = D + Dd(1)*V(:,1) + Dd(2)*V(:,2) + Dd(3)*V(:,3); Yvals(j,1,k+1) = Y(1); Yvals(j,2,k+1) = Y(2); Yvals(j,3,k+1) = Y(3); Yvals(j,4,k+1) = Y(4); Dvals(j,1, k+1) = D(1,1); Dvals(j,2, k+1) = D(2,1); Dvals(j,3, k+1) = D(3,1); Dvals(j,4, k+1) = D(4,1); end end %mean & standard division of Dvals meanDvals =zeros(L+1,4); stdDvals =zeros(L+1,4); for r=1:L 50

APPENDIX B. MATLAB CODE meanDvals(r+1,1) = mean (Dvals(:,1, r+1)); meanDvals(r+1,2) = mean (Dvals(:,2, r+1)); meanDvals(r+1,3) = mean (Dvals(:,3, r+1)); meanDvals(r+1,4) = mean (Dvals(:,4, r+1)); stdDvals(r+1,1) = std(Dvals(:,1, r+1)); stdDvals(r+1,2) = std(Dvals(:,2, r+1)); stdDvals(r+1,3) = std(Dvals(:,3, r+1)); stdDvals(r+1,4) = std(Dvals(:,4, r+1)); end opts = odeset('abstol', 1.e-6); MM =@ (tt,yy)[-k1*yy(1)*yy(2) + k2*yy(3);... -k1*yy(1)*yy(2)+ k2*yy(3) + k3*yy(3);... k1*yy(1)*yy(2) - k2*yy(3) - k3*yy(3);... k3*yy(3);... -k1*yy(2)*yy(5)-k1*yy(1)*yy(6)+k2*yy(7)+yy(3);... -k1*yy(2)*yy(5)-k1*yy(1)*yy(6)+yy(3)+k2*yy(7)+k3*yy(7);... k1*yy(2)*yy(5)+k1*yy(1)*yy(6)-yy(3)-k2*yy(7)-k3*yy(7);... k3*yy(7)]; yy0=[Y1,Y2,Y3,Y4,0,0,0,0]; [tt, yy] = ode45(MM, [0 ,50], yy0, hold on %probability density function(pdf) of Yvals X1=round(Yvals(:,1,L+1)); X2=round(Yvals(:,2,L+1)); [n1, xout1] = hist(X1); [n2, xout2] = hist(X2); opts);

The stiff, nonlinear system of CLE code

%stoichiometric matrix V = [-1 1 -1 1 1 -1; -1 1 1 -1 -1 1; 1 -1 -1 1 -1 1]; Y = zeros(3,1); D = zeros(3,1); Y(1) = 1e3; 51

APPENDIX B. MATLAB CODE Y(2) = 1e3; Y(3) = 1e6; k1 = 1e3; k2 = 1e3; k3 = 1e-5; k4 = 10; k5 = 1.0; k6 = 1e6; tfinal = 0.01; L = 50000; tau = tfinal/L; tvals = [0:tau:tfinal]; NumberOfRuns=1000; %number of trajectries % stepsize

Yvals =zeros(NumberOfRuns,3, L+1); Dvals = zeros(NumberOfRuns,3, L+1); Y1 = 1e3; Y2 = 1e3; Y3 =1e6; D1 = 0; D2 = 0; D3 = 0; % This is for 1st column of Yvals and Dvals

Yvals(:,1,1) = Y1; Yvals(:,2,1) = Y2; Yvals(:,3,1) = Y3; Dvals(:,1,1) = D1; Dvals(:,2,1) = D2; Dvals(:,3,1) = D3; for j=1:NumberOfRuns Y(1) = Y1; Y(2) = Y2; Y(3) = Y3; D = zeros(3,1); for k = 1:L n = randn(6, 1); % terms for the number of molecules a(1) = k1*Y(1)*Y(2); a(2) = k2*Y(3); a(3) = k3*Y(1)*Y(3); a(4) = k4*Y(2); 52

APPENDIX B. MATLAB CODE a(5) = k5*Y(2)*Y(3); a(6) = k6*Y(1); d(1) = tau*a(1) + sqrt(abs(tau*a(1)))*n(1) ; d(2) = tau*a(2) + sqrt(abs(tau*a(2)))*n(2) ; d(3) = tau*a(3) + sqrt(abs(tau*a(3)))*n(3); d(4) = tau*a(4) + sqrt(abs(tau*a(4)))*n(4); d(5) = tau*a(5) + sqrt(abs(tau*a(5)))*n(5); d(6) = tau*a(6) + sqrt(abs(tau*a(6)))*n(6); % terms for sensitivities Da(1) = k1*Y(2)*D(1,1) + k1*Y(1)*D(2,1); Da(2) = k2*D(3,1); Da(3) = k3*Y(1)*D(3,1) + k3*Y(3)*D(1,1); Da(4) = Y(2) + k4*D(2,1); Da(5) = k5*Y(2)*D(3,1) + k5*Y(3)*D(2,1); Da(6) = k6*D(1,1); Dd(1) = Da(1)* tau + 1/2*sqrt(abs(tau/a(1)))* Da(1)*n(1); Dd(2) = Da(2)* tau + 1/2*sqrt(abs(tau/a(2)))* Da(2)*n(2); Dd(3) = Da(3)* tau + 1/2*sqrt(abs(tau/a(3)))* Da(3)*n(3); Dd(4) = Da(4)* tau + 1/2*sqrt(abs(tau/a(4)))* Da(4)*n(4); Dd(5) = Da(5)* tau + 1/2*sqrt(abs(tau/a(5)))* Da(5)*n(5); Dd(6) = Da(6)* tau + 1/2*sqrt(abs(tau/a(6)))* Da(6)*n(6); % number of molecules Y = Y + d(1)*V(:,1) + d(2)*V(:,2) + d(3)*V(:,3) + d(4)*V(:,4) + d(5)*V(:,5) + d(6)*V(:,6); % sensitivity for k4 D = D + Dd(1)*V(:,1) + Dd(2)*V(:,2) + Dd(3)*V(:,3) + Dd(4)*V(:,4) + Dd(5)*V(:,5) + Dd(6)*V(:,6); Yvals(j,1,k+1) = Y(1); Yvals(j,2,k+1) = Y(2); Yvals(j,3,k+1) = Y(3); Dvals(j,1, k+1) = D(1,1); Dvals(j,2, k+1) = D(2,1); Dvals(j,3, k+1) = D(3,1); 53

APPENDIX B. MATLAB CODE

end end %mean & standard division of Dvals meanDvals =zeros(L+1,4); stdDvals =zeros(L+1,4); for r=1:L meanDvals(r+1,1) = mean (Dvals(:,1, r+1)); meanDvals(r+1,2) = mean (Dvals(:,2, r+1)); meanDvals(r+1,3) = mean (Dvals(:,3, r+1)); stdDvals(r+1,1) = std(Dvals(:,1, r+1)); stdDvals(r+1,2) = std(Dvals(:,2, r+1)); stdDvals(r+1,3) = std(Dvals(:,3, r+1)); end opts = odeset('abstol', 1.e-6); SSS =@ (tt,yy)[ -k1*yy(1)*yy(2)+k2*yy(3)-k3*yy(1)*yy(3)+k4*yy(2)+k5*yy(2)*yy(3)-k6*yy(1);... -k1*yy(1)*yy(2)+k2*yy(3)+k3*yy(1)*yy(3)-k4*yy(2)-k5*yy(2)*yy(3)+k6*yy(1);... k1*yy(1)*yy(2)-k2*yy(3)-k3*yy(1)*yy(3)+k4*yy(2)-k5*yy(2)*yy(3)+k6*yy(1);... -k1*yy(2)*yy(4)-k1*yy(1)*yy(5)+k2*yy(6)-k3*yy(1)*yy(6)-k3*yy(3)*yy(4)+yy(2) +k4*yy(5)+k5*yy(2)*yy(6)+k5*yy(3)*yy(5)-k6*yy(4);... -k1*yy(2)*yy(4)-k1*yy(1)*yy(5)+k2*yy(6)+k3*yy(1)*yy(6)+k3*yy(3)*yy(4)-yy(2) -k4*yy(5)-k5*yy(2)*yy(6)-k5*yy(3)*yy(5)+k6*yy(4);... k1*yy(2)*yy(4)+k1*yy(1)*yy(5)-k2*yy(6)-k3*yy(1)*yy(6)-k3*yy(3)*yy(4)+yy(2) +k4*yy(5)-k5*yy(2)*yy(6)-k5*yy(3)*yy(5)+k6*yy(4)];... yy0=[Y1,Y2,Y3,0,0,0]; [tt, yy] = ode45(SSS, [0 ,0.01], yy0, subplot(1,2,1); plot(tvals,squeeze(Yvals(j,1,:)),'b',tvals,squeeze(Yvals(j,2,:)),'r') subplot(1,2,2); plot(tvals,squeeze(Yvals(j,3,:)),'m') subplot(2,2,1); plot(tvals, meanDvals(:,1), 'm',tvals, meanDvals(:, 2), 'k' ,tt,yy(:,4), '.',tt,yy(:,5), '*g') subplot(2,2,2); plot(tvals, meanDvals(:, 3), 'r',tt,yy(:,6), '--') 54 opts);

APPENDIX B. MATLAB CODE subplot(2,2,3); plot(tvals, meanDvals(:,1), 'm',tvals, meanDvals(:, 2), 'k' ,tt,yy(:,4), '.',tt,yy(:,5), '*g') subplot(2,2,4); plot(tvals, meanDvals(:, 3), 'r',tt,yy(:,6), '--') subplot(2,2,2); plot(tvals, stdDvals(:,1), 'm',tvals, stdDvals(:, 2), 'k') subplot(2,2,4); plot(tvals, stdDvals(:,1), 'm',tvals, stdDvals(:, 2), 'k') subplot(1,2,1); plot(tvals, stdDvals(:, 3), 'r')

55

References
[1] D.F. Anderson. Incorporating postleap checks in tau-leaping. J. Chem. Phys., 128(5):054103, 2008. [2] S. Andrews and D. Bray. Stochastic simulation of chemical reactions with spatial resolution and single molecule detail. Phys Biol, 1:131­151, 2004. [3] Adam Arkin, John Ross, and Harley H. McAdams. Stochastic kinetic analysis of developmental pathway bifurcation in phage-infected escherichia coli cells. Genetics, 149:1633, 1998. [4] Adam P. Arkin and Sergey Plyasunov. Efficient stochastic sensitivity analysis of discrete event systems. Journal of Computational Physics, 221:724­738, 2007. [5] Uri M. Ascher and Linda R. Petzold. Computer methods for ordinary differential equations and differential-algebraic equations. SIAM (Society for Industrial and Applied Mathematics), Philadelphia, 1998. [6] William J. Blake, Mads Kaern, Charles R. Cantor, and J. J. Collins. Noise in eukaryotic gene expression. Nature, 422:633­637, 2003. [7] G.E. Briggs and J.B.S. Haldane. A note on the kinematics of enzyme actions. Biochemical Journal, 19:338­339, 1925. [8] Y. Cao, D.T. Gillespie, and L. Petzold. Efficient step-size selection for the tau-leaping method. J. Chem. Phys, 124:044109, 2006. [9] A. Chatterjee, D.G. Vlachos, and M.A. Katsoulakis. Binomial distribution based tau-leaping accelerated stochastic simulation. J. Chem. Phys, 122:024112, 2005. [10] Guang Qiang Dong, Luke Jakobowski, Marco A.J. Iafolla, and David R. McMillen. Simplification of stochastic chemical reaction models with fast and slow dynamics. Bio Phys Journal, 33:67­95, 2007. [11] M. B. Elowitz and S. Leibler. A synthetic oscillatory network of transcriptional regulators. Nature, 403:335­338, 2000. [12] Michael B. Elowitz, Arnold J. Levine, Eric D. Siggia, and Peter S. Swain. Stochastic gene expression in a single cell. Science, 297:1183­1186, 2002. 56

REFERENCES

REFERENCES

[13] N. Federoff and W. Fontana. Small numbers of big molecules. Science, 297:1129­1131, 2002. [14] C. Gardiner. Handbook of stochastic methods: For physics, chemistry and the natural sciences. Springer Verlag, Berlin, 1996. [15] C.W. Gardiner. Stochastic methods: a handbook for the natural and social sciences. Springer, Berlin, 2009. [16] MA. Gibson and J. Bruck. Efficient exact stochastic simulation of chemical systems with many species and many channels. J. Chem. Phys., 104:1876­ 1889, 2000. [17] Daniel T. Gillespie. A general method for numerically simulating the stochastic time evolution of coupled chemical reactions. J. Comput. Phys, 22:403­34, 1976. [18] Daniel T. Gillespie. Exact stochastic simulation of coupled chemical reactions. J. Phys. Chem., 81:2340­2361, 1977. [19] Daniel T. Gillespie. The chemical langevin equations. J. Phys. Chem., 113:297­306, 2000. [20] Daniel T. Gillespie. Approximate accelerated stochastic simulation of chemically reacting systems. J. Chem. Phys., 115:1716­1733, 2001. [21] Daniel T. Gillespie. Stochastic simulation of chemical kinetics. Annu. Rev. Phys. Chem., 58:35­55, 2007. [22] Paul Glasserman. Monte Carlo methods in financial engineering. Springer, USA, 2003. [23] Didier Gonze. Stochastic modeling: Application to molecular networks. Les Houches - Spring School, May 2007. [24] Rudiyanto Gunawan, Yang Cao, Linda Petzold, and Francis J. Doyle. Sensitivity analysis of discrete stochastic systems. Biophysical Journal, 88:2530­2540, 2005. [25] Biao Guo. Pathwise derivative vs finite difference for greeks computation. On-Line Lecture, Sep 2010. [26] Silvana Ilie, Wayne H. Enright, and Kenneth R. Jackson. Numerical solution of stochastic models of biochemical kinetics. Canadian Applied Mathematics Quarterly, 17:3, 2009. [27] Brian P. Ingalls and Herbert M. Sauro. Sensitivity analysis of stoichiometric networks: An extension of metabolic control analysis to non-equilibrium trajectories. J. of Theoretical Biology, 222:23­36, 2003. [28] Desmond J.Higham. An algorithmic introduction to numerical simulation of stochastic differential equations. SIAM Review, 43 (3):525­546, 2001. [29] Desmond J.Higham. Modeling and simulating chemical reactions. SIAM Review, 50(2):347­368, 2007. 57

REFERENCES [30] H. Kitano. Computational systems biology. Nature, 420:206­210, 2002.

REFERENCES

[31] P.E. Kloeden and E. Platen. Numerical solution of stochastic differential equations. Springer-Verlag, Berlin, 1992. [32] T. Li. Analysis of explicit tau-leaping schemes for simulating chemically reacting systems. SIAM Multi. Model. Simul., 6:417­436, 2007. [33] H. McAdams and A. Arkin. Stochastic mechanism in gene expression. PNAS.USA, 94:814­819, 1997. [34] H. McAdams and A. Arkin. It's a noisy business, genetic regulation at the nanomolar scale. Trends Genet, 15:65­69, 1999. [35] Tan Chee Meng, Sandeep Somani, and Pawan Dhar. Modeling and simulation of biological systems with stochasticity. In Silico Biology, 4:293­309, 2004. [36] L. Michaelis and M.I. Menton. Die kinetik der invertinwirkung. Biochem. Z., 49:333­369, 1913. [37] G. Nicolis and Ilya Prigogine. Self-Organization in Non-Equilibrium Systems. Wiley, 1977. [38] B. Oksendal. Stochastic Differential Equations. Springer, Berlin, 2007. [39] J. Paulsson. Summing up the noise in gene networks. Nature, 427:415­418, 2004. [40] Theodore J. Perkins. Maximum likelihood trajectories for continuous-time markov chains. Ottawa Hospital Research Institute, 2009. [41] M. Rathinam, L. Petzold, Y. Cao, and D.T. Gillespie. Stiffness in stochastic chemically reacting systems: the implicit tau-leaping method. J. Chem. Phys., 119(24):12784, 2003. [42] Alexei A. Sharov. Predators, parasites, and pathogens, lotka-volterra model. Department of Entomology, Virginia Tech, Blacksburg, VA, On-Line Lectures, Dec 1996. [43] Patrick W. Sheppard, Muruhan Rathinam, and Mustafa Khammash. A pathwise derivative approach to the computation of parameter sensitivities in discrete stochastic chemical systems. Journal of Chemical Physics, 136:034115, 2012. [44] Vassilios Sotiropoulos and Yiannis N. Kaznessis. An adaptive time step scheme for a system of stochastic differential equations with multiple multiplicative noise: Chemical langevin equation, a proof of concept. Journal of Chemical Physics, 128:014103,1­014103,16, 2008. [45] P.S. Swain, M.B. Elowitz, and E.D. Siggia. Intrinsic and extrinsic contributions to stochasticity in gene expression. PNAS. USA, 99:12795­12800, 2002. [46] T. Tian and K. Burrage. Bionomial leap methods for simulating stochastic chemical kinetics. J. Chem. Phys, 121(1):10356­10364, 2004. 58

REFERENCES

REFERENCES

[47] LS. Tsimring, D. Volfson, and J. Hasty. Stochastically driven genetic circuits. Chaos, 16:026103, 2006. [48] TE. Turner, S. Schnell, and K. Burrage. Stochastic approaches for modeling in vivo reactions. Computational Biology and Chemistry, 28:165­178, 2004. [49] N.G. van Kampen. Stochastic processes in physics and chemistry. Elsevier, New York, 1990. [50] J. S. van Zon and P. R. ten Wolde. Simulation of biochemical networks at the particle level in time and space: Green's function reaction dynamics. Phys Rev Lett, 94:128­103, 2005. [51] Darren J. Wilkinson. Stochastic modeling for systems biology. Chapman & Hall, CRC, 2006.

59

