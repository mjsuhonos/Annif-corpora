Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2011

Improved Low Voltage Ride Through Capability of Wind Farm using STATCOM
Miad Mohaghegh Montazeri
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Electrical and Computer Engineering Commons Recommended Citation
Montazeri, Miad Mohaghegh, "Improved Low Voltage Ride Through Capability of Wind Farm using STATCOM" (2011). Theses and dissertations. Paper 1407.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

Improved Low Voltage Ride Through Capability of Wind Farm using STATCOM

 
By    MIAD MOHAGHEGH MONTAZERI
B.Eng, Ryerson University, Canada, 2009

 

A thesis presented to Ryerson University in partial fulfillment of the requirements for the degree of Master of Applied Science in the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2011 © Miad Mohaghegh Montazeri 2011
   

Author's Declaration

I hereby declare that I am the sole author of this thesis or dissertation. I authorize Ryerson University to lend this thesis or dissertation to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this thesis or dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

ii   

ABSTRACT

Improved Low Voltage Ride Through Capability of Wind Farm using STATCOM Master of Applied Science 2011 Miad Mohaghegh Montazeri Electrical and Computer Engineering Ryerson University Using power electronic converters with reduced capacity in doubly-fed induction generator (DFIG) based wind turbines make them vulnerable to over-current during grid disturbances. This thesis aims to analyze the behaviour of doubly-fed induction generators based wind farm for various timing schemes of crowbar deactivation and resumption of rotor side converter (RSC) in the case of grid fault. Also, usage of a static synchronous compensator (STATCOM) for the purpose of stabilizing the grid voltage after a three-phase fault is studied in this these. Moreover, finding minimum capacity of STATCOM which ensures low-voltage ride through (LVRT) of wind farm is studied. Finally, coordination of reactive power from wind turbine generators and STATCOM in steady-state condition is performed. All the results in this thesis show that STATCOM improves low voltage ride through (LVRT) capability of wind farm and assists for an uninterrupted operation of wind turbine generators during grid faults.

iii   

ACKNOWLEDGEMENT

I wish to express my deep gratitude to my supervisor, Professor Dewei Xu for his support and the knowledge he shared during my graduate studies at Ryerson University. I am grateful to Professor Bala Venkatesh and Professor Bin Wu for their useful discussions on my research. I would like to thank my wife, Mina for supporting and encouraging me to pursue this degree. Without her encouragement, I would not have finished the degree. I am grateful to my parents and my sister for their love and support. I also would like to thank my colleague and friend Navid Binesh for his help and support.

                                                    iv   

TO MY GRANDPARENTS
                                                                                          v   

TABLE OF CONTENTS
CHAPTER 1. INTRODUCTION ................................................................................................... 1 1.1 Wind Energy Conversion System ......................................................................................... 1 1.1.1 Configurations ................................................................................................................ 1 1.1.2 Low-voltage ride through ............................................................................................... 4 1.2 Synchronous var compensation ............................................................................................. 4 1.3 LVRT capability of different WECSs ................................................................................... 5 1.4 Motivation and objectives ..................................................................................................... 9 1.5 Thesis layout ....................................................................................................................... 10 CHAPTER 2. DFIG BASED WIND FARM ................................................................................ 11 2.1 Introduction ......................................................................................................................... 11 2.2 Wind energy conversion system ......................................................................................... 12 2.3 Operating principle of DFIG ............................................................................................... 15 2.4 DFIG model......................................................................................................................... 17 2.5 Rotor-side converter model ................................................................................................. 19 2.6 Conclusions ......................................................................................................................... 20 CHAPTER 3. SYNCHRONOUS VAR COMPENSATOR (STATCOM) .................................. 21 3.1 Introduction ......................................................................................................................... 21 3.2 STATCOM Model .............................................................................................................. 24 3.3 Location of STATCOM ...................................................................................................... 27 3.4 Conclusions ......................................................................................................................... 27 CHAPTER 4. LVRT CAPABILITY OF DFIG BASED WIND FARM ..................................... 28 4.1 Introduction ......................................................................................................................... 28 4.2 Grid code requirements ....................................................................................................... 29 4.3 LVRT component for DFIG ................................................................................................ 31 4.4 Test template for study ........................................................................................................ 32 4.5 Simulation results ................................................................................................................ 33 4.5.1 Crowbar deactivated, RSC re-enabled after fault clearance ......................................... 33 4.5.2 Crowbar deactivated before, RSC re-enabled after fault clearance.............................. 37 4.5.3 Crowbar deactivated, RSC re-enabled before fault clearance ...................................... 39
vi   

4.6 Conclusions ......................................................................................................................... 40 CHAPTER 5. OPTIMUM CAPACITY OF STATCOM ............................................................. 41 5.1 Introduction ......................................................................................................................... 41 5.2 Minimum reactive power requirement ................................................................................ 42 5.3 Simulation results ................................................................................................................ 43 5.3.1 2500 MVA grid, 130 km transmission line .................................................................. 43 5.3.2 500 MVA grid, 170 km transmission line .................................................................... 46 5.4 Conclusions ......................................................................................................................... 48 CHAPTER 6. COORDINATION OF DFIG AND STATCOM .................................................. 49 6.1 Introduction ......................................................................................................................... 49 6.2 Losses of the system............................................................................................................ 50 6.2.1 Losses of DFIG............................................................................................................. 50 6.2.2 Losses of STATCOM ................................................................................................... 51 6.2.3 Losses of Transformer .................................................................................................. 52 6.3 Reactive power capability limitation of DFIG .................................................................... 52 6.4 Total loss minimization ....................................................................................................... 54 6.5 Results analysis ................................................................................................................... 57 6.6 Conclusions ......................................................................................................................... 62 CHAPTER 7. CONCLUSION...................................................................................................... 63 7.1 Conclusions ......................................................................................................................... 63 7.2 Major Contributions ............................................................................................................ 64 7.3 Future Work ........................................................................................................................ 65 APPENDICES .............................................................................................................................. 66 Appendix A. Parameters for DFIG-based wind turbine test system ......................................... 66 Appendix B. Proposed program for coordination of DFIG and STATCOM............................ 67 Appendix C. Power system model in Matlab/simulink............................................................. 72 REFERENCES ............................................................................................................................. 75

vii   

LIST OF FIGURES
Figure 1- 1. Global cumulative installed wind capacity ................................................................. 1  Figure 1- 2. Top 10 cumulative capacities ...................................................................................... 1  Figure 1- 3. Constant-speed WECS ................................................................................................ 3  Figure 1- 4. WECS with squirrel cage induction generator (SCIG) ............................................... 3  Figure 1- 5. WECS with Doubly-Fed Induction Generator (DFIG) ............................................... 3  Figure 1- 6. WECS with Permanent Magnet Synchronous Generator (PMSG) ............................. 3  Figure 1- 7. Layout of DFIG with crowbar protection ................................................................... 6 
 

Figure 2- 1. Block Diagram of DFIG............................................................................................ 11  Figure 2- 2. The charactersictis of wind turbine .............................................................. 13  Figure 2- 3. Wind turbine power characteristics ........................................................................... 14  Figure 2- 4. Pitch angle controller ................................................................................................ 15  Figure 2- 5. Sub-synchronous mode..... ...................................................................................... 16  Figure 2- 6. Super-synchronous mode.....................................................................16 Figure 2- 7. Equivalent circuit of DFIG in dq-reference frame .................................................... 17 
 

Figure 3- 1. Schametic of SVC .................................................................................................... 23  Figure 3- 2. Schematic of STATCOM.....................................................................23 Figure 3- 3. SVC V-I characteristic .................. ..................................................................... 23  Figure 3- 4. STATCOM V-I characteristic............................................................ . .23 Figure 3- 5. Block diagram of STATCOM ................................................................................... 24  Figure 3- 6. Basic control system block diagram of a STATCOM .............................................. 26 
 

Figure 4- 1. Proposed voltage-time LVRT curve by EON ........................................................... 30  Figure 4- 2. Connection of crowbar in the rotor circuit ................................................................ 31  Figure 4- 3. Test system with connected capacitor bank .............................................................. 33  Figure 4- 4. Test system with connected STATCOM .................................................................. 33  Figure 4- 5. Simulation result in case 1 with shunt capacitor (85km transmission line) .............. 34  Figure 4- 6. Simulation result in case 1 with STATCOM (85km transmission line) ................... 35 
viii   

Figure 4- 7. Simulation result in case 1 with shunt capacitor (110km transmission line) ............ 36  Figure 4- 8. Simulation result in case 1 with STATCOM (110km transmission line) ................. 37  Figure 4- 9. Simulation result in case 2 with shunt capacitor (110km transmission line) ............ 38  Figure 4- 10. Simulation result in case 2 with STATCOM(110km transmission line) ................ 39  Figure 4- 11. Simulation result in case 3 with shunt capacitor (110km transmission line) .......... 40  Figure 4- 12. Simulation result in case 3 with STATCOM (110km transmission line) ............... 40 
 

Figure 5- 1. Simple transmission line ........................................................................................... 41  Figure 5- 2. PCC voltage of 130km transmission line after using 3 Mvar STATCOM ............... 44  Figure 5- 3. Close-up of PCC voltage of 130km transmission line after using 3 Mvar STATCOM ............................................................................................................................ 44  Figure 5- 4. PCC voltage of 130km transmission line after using 3.98 Mvar STATCOM .......... 45  Figure 5- 5. PCC voltage of 170km transmission line after using 4.5 Mvar STATCOM ............ 46  Figure 5- 6. Close-up of PCC voltage of 170km transmission line after using 4.5 Mvar STATCOM ............................................................................................................................ 46  Figure 5- 7. PCC voltage of 170km transmission line after using 5.11 Mvar STATCOM .......... 47 
 

Figure 6- 1. Flow chart of proposed optimization method ........................................................... 56 
                                        ix   

LIST OF TABLES
Table 3- 1. List of installed STATCOMs ..................................................................................... 21 

Table 6- 1. Converter characteristics data..................................................................................... 51  Table 6- 2. Power loss when the local load is 5 Mvar and GSC is 2.08 MVA............................. 57  Table 6- 3. Minimum power loss when the local load is 5 Mvar and GSC is 2.08 MVA ............ 58  Table 6- 4. Minimum power loss when the local load is 5 Mvar and GSC is 3 MVA ................. 58  Table 6- 5. Minimum power loss when the local load is 6 Mvar and GSC is 2.08 MVA ............ 59  Table 6- 6. Minimum power loss when the local load is 6 Mvar and GSC is 3 MVA ................. 60  Table 6- 7. Minimum power loss when the local load is 7 Mvar and GSC is 2.08 MVA ............ 61  Table 6- 8. Minimum power loss when the local load is 7 Mvar and GSC is 3 MVA ................. 61 

 

                                              x   

LIST OF APPENDICES
Appendix A. Parameters for DFIG-based wind turbine test system ............................................. 66 Appendix B. Proposed program for coordination of DFIG and STATCOM ............................... 67 Appendix C. Power system model in Matlab/simulink ................................................................ 72

xi   

LIST OF PRINCIPLE SYMBOLS

Mechanical power Air density Area covered by the rotor Wind speed Performance coefficient Pitch angle of rotor blades Tip speed ratio Wind-turbine rotor speed R
_

Blade length Mechanical power in per unit Performance coefficient in per unit Wind speed in per unit Air gap power Slip power Slip Synchronous speed Rotor speed Stator voltage Rotor voltage
xii 

_

_

 

Stator resistance Rotor resistance Stator inductance Rotor inductance Magnetising inductance Stator current


Rotor current Slip speed Stator flux linkage Rotor flux linkage Stator leakage inductance Rotor leakage inductance , , , , , , Stator voltage in d-q reference frame Stator current in d-q reference frame Rotor voltage in d-q reference frame Rotor current in d-q reference frame Stator flux linkage in d-q reference frame Rotor flux linkage in d-q reference frame Electromagnetic torque Mechanical angular speed of the rotor Mechanical inertia constant of generator
xiii 

 

Mechanical torque produced by the wind turbine , , Active and reactive power of the stator Active and reactive power of the rotor Terminal voltage Voltage source inverter voltage Phase difference between terminal and VSC voltage R X Resistance of the transmission line Reactance of the transmission line Reactive current of the STATCOM
The amount of reactive power exchange between STATCOM and grid

Source voltage Load voltage Z Transmission line impedance Angle of transmission line impedance Phase difference between sending end and receiving end of the transmission line Short-circuit current Short-circuit level Generator copper loss
_

Converter loss Nominal collector current

,

xiv   

Voltage across the collector and emitter
,

Voltage drop regarding switching loss in transistor Voltage drop regarding switching loss in diode  Turn-on and turn-off losses of IGBT Reverse recovery energy of diode

,


_

Switching frequency of converter Rotor-side converter loss Grid-side converter loss
_

_

_

Converter loss of STATCOM Transformer copper loss Primary winding resistance of transformer Secondary winding resistance of transformer Primary current of transformer Primary current of transformer

_



Maximum rotor current Rated power of DFIG direct current of GSC

            xv   

CHAPTER 1. INTRODUCTION
 

1.1 Wind Energy Conversion System 1.1.1 Configurations
Wind power is the fastest growing renewable energy source. With the latest technological advancements in power electronics, considering wind power as an important part of electrical power generation is vital. The cumulative global wind power capacity has grown to 195 GW in the year 2010 (Figure 1-1) [1]. Canada stands in the 9th place of top countries that have the most cumulative installed wind power where China is the leading country of this chart (Figure 1-2) [1]. It has been agreed internationally to accelerate the level of penetration each year and to reach 10% of the saturation level by 2016 [2].

Figure 1- 1. Global cumulative installed wind capacity

Figure 1- 2. Top 10 cumulative capacities

1   

However, wind is an uncontrollable resource and this feature makes it a difficult task to integrate large wind farms into a grid. Stability and power quality are the main issues. Wind turbines are considered as distributed generators (DGs) which are connected to the distribution part of a power grid. Rather than conventional electric energy resources such as nuclear and hydropower plants that are centralized and are the main sources of electric power generators, DGs are decentralized and located in weaker parts of the power grid. With small capacity wind farm connected to the power system, intermittent power flow of wind farm does not pose a major threat to the stability of power system. As wind turbines become larger and level of penetration becomes higher, voltage stability and power quality of the system must be taken into account. One of the issues that can jeopardize uninterrupted operation of wind turbines is grid disturbance. In the past, wind turbines could be disconnected from the grid during grid fault, because their impacts on the grid were not significant. As wind farm gets larger and the penetration level increases, the impacts cannot be ignored anymore. The disconnection of large amount of wind power generators will have serious negative impact on the grid. The tripping of large wind farm can cause long restart delays and production losses. These facts dictated the necessity of a set of comprehensive grid codes. Grid codes are certain regulations that are formulated by Transmission System Operators (TSOs) which can be different from one region to another [3]. A wind energy conversion system (WECS) can be designed for two types of operation: constant speed and variable speed. A squirrel cage induction generator is the common choice for constant speed configuration because of its mechanical simplicity and low maintenance requirements [4]. Figure 1-3 [5] shows a typical constant wind energy system, where the generator and the grid are directly coupled and the generator is connected to the wind turbine via a gear box. Squirrel cage induction generators can also be used in variable speed operation (Figure 1-4) as some other types of generators. Wound rotor induction generators (WRIGs) and permanent magnet synchronous generators (PMSGs) can also be used for this type of operation as shown in figures 1-5 and 1-6 [5], respectively. Variable operations enable the control of rotor speed and allow the wind energy conversion system to operate continuously near its optimum tip-speed ratio [5]. This leads to more electricity production compare to constant operation counterparts.

2   

However, the structure and control of variable wind energy power systems become more complex as power electronic converters are needed to connect the generator to the grid.

Figure 1- 3. Constant-speed WECS

Figure 1- 4. WECS with squirrel cage induction generator (SCIG)

Figure 1- 5. WECS with Doubly-Fed Induction Generator (DFIG)

Figure 1- 6. WECS with Permanent Magnet Synchronous Generator (PMSG)

3   

Doubly-Fed Induction Generators (DFIGs) are widely used in wind farms for their advantages of variable speed and active and reactive power independent controllability. DFIG typically consists of a wound rotor induction generator which is connected to the grid from its stator side. The rotor side of the generator is connected to a back-to-back voltage source converter (VSC) and from there to the grid. The converter that is connected to the rotor of DFIG is called rotor side converter (RSC) and the converter connected to the grid is called grid side converter (GSC). The capacitor between two converters forms DC-link. The basic layout of DFIG is given in figure 1-7. Due to small rating (about 25%-30% of the total rating) power electronic converters, protection devices are required for protecting the converter from over-current and over-voltage during grid fault [6].

1.1.2 Low-voltage ride through
Voltage instability in a power system occurs due to lack of adequate reactive power during grid fault [7]. Injecting enough reactive power to the grid can enhance low voltage ride through (LVRT) capability of a wind farm and guarantees an uninterrupted operation of its units. LVRT is part of the grid code which states that wind turbines are required to remain connected to the grid for a specific amount of time otherwise they can be disconnected. This specific amount of time can be different from one grid code to another; also the severity of the fault might be different as well. Injecting reactive power for ensuring LVRT can be performed using var compensator devices such as STATCOM or capacitor banks.

1.2 Synchronous var compensation
STATCOM is a type of Flexible AC Transmission Systems (FACTS) device. FACTS are powerelectronic based systems which improve controllability and increase power flow capability of a power system. In the same way, static synchronous compensator (STATCOM) is a power electronic-based synchronous var compensator that generates a three-phase reactive power in synchronism with the transmission line voltage and is connected to it by a coupling transformer [8]. STATCOM typically consist of a three-phase inverter using Gate Turn-off Thyristors
4   

(GTOs) or Insulated Gate Bipolar Transistors (IGBTs). The gates of this inverter are typically controlled using Pulse-Width Modulation (PWM) technique. STATCOM acts as a sink of reactive power (inductor) or a source of reactive power (capacitor). By varying the amplitude of the converter voltage with respect to the system bus voltage, STATCOM can continuously exchange power through the flow of a controlled current. The power exchange between STATCOM and rest of the system is purely reactive although an insignificant amount of active power is supplied by the grid to compensate for converter losses. This reactive power support enables the STATCOM improve the voltage profile of the system and reduce voltage fluctuation in event of grid disturbances. When STATCOM is utilized at distribution level for voltage regulation, it is called DSTATCOM [9]. DSTATCOM and STATCOM follow the same operating principles. So throughout of this thesis, the terms STATCOM and DSTATCOM is used interchangeably.

1.3 LVRT capability of different WECSs
Different types of WECSs need different types of strategies to ensure LVRT of the wind farm. A constant-speed SCIG-based wind turbine has the disadvantage of consuming reactive power even during normal operation and as the wind speed increases the amount of reactive power absorption by wind turbine increases. In a typical constant speed wind turbine there are no means of internal reactive power control. The reactive power for the generator must be supplied directly from the grid [4]. In a weak grid or during fault recovery condition, the reactive power absorption of the wind farm can make the grid unstable and leads to voltage collapse. Capacitor banks can be used to supply reactive power in normal condition. But to ensure that the constantspeed wind turbine can ride through a fault, power electronic converters are required because of their fast responses and wide range of operation. STATCOM is the best option to address this problem [10]. The variable speed wind turbine equipped with PMSG and full-power converter shows excellent performance in the aspect of low-voltage ride through [4]. As full-load converter is used in this type of wind turbines, over-voltage and over-current do not threat the power converter as they do DFIG-based wind turbines due to smaller size converter. Although in this type of generator, DC5   

link voltage raises beyond its limit during grid fault which is unacceptable [11]. Three common ways to stabilize DC-link voltage are using diode rectifier and DC-DC chopper, rectifier and DC-DC boost converter, and PWM rectifier with battery for storing extra wind energy [12]. A well-known method for DFIG power converter protection is using crowbars. A crowbar consists of a three-phase diode rectifier, a switching device (thyristor or IGBT) and a small resistor [13]. The overall protection scheme is that during a voltage sag (e.g. three-phase fault) the gate signals of rotor side converter (RSC) is turned off and the rotor is connected to the crowbar. But the drawback of this method is that the control of active and reactive power of the wind turbine which is originally performed by RSC is temporally lost during fault. DFIG starts to act as a conventional induction generator and begins absorbing reactive power from the gird which delays the grid recovery after fault. The layout of DFIG with crowbar protection is shown in figure 1-7.

Figure 1- 7. Layout of DFIG with crowbar protection

In a weak grid scenario, the risk of voltage instability is high. There is no single definition for weak grid, but generally a grid is considered weak when the distribution system is not able to provide enough reactive power to the load connected to the system and the voltage level is close
6   

to the voltage limits (±5% of the nominal voltage) [14]. In a weak grid, grid impedance is significant and has to be considered. This causes severe voltage drop at the end of the line especially for a long transmission line. Gird disturbances affect weak grid more significantly than a stiff grid. Therefore, in a weak grid wind turbine should be disconnected from the gird during fault and reconnected after grid recovery or voltage should be stabilized by injecting reactive power to the system for an uninterrupted operation of wind turbine and satisfying the grid code. Due to its fast response and wide range of operation, STATCOM is an effective choice to be used in the event of grid disturbances. Injection of reactive power by STATCOM will bring the voltage to its nominal value after fault clearance [15]. In a weak grid and without using STATCOM, DFIG cannot bring the voltage up to its nominal value even with the help of capacitor banks and has to be disconnected from the grid [15]. Also, in steady-state condition STATCOM can be used for voltage and power factor regulation of DFIG. Three cases can be considered for crowbar deactivation and converter re-enabling: 1) the crowbar is deactivated and RSC is re-enabled after the fault is cleared; 2) The crowbar is deactivated before fault clearance, while the RSC is re-enabled afterwards; 3) The crowbar is deactivated and RSC is re-enabled before fault clearance [6]. In [6], these cases were analyzed and compared for the matters of PCC (Point of Common-Coupling) voltage, active and reactive power and DC-link voltage of the wind farm. In [16], in addition, to compare between cases 1 and 3, the effects of the crowbar resistance and rotor speed on the time for the crowbar current to reach zero and the impacts of them on voltage recovery was investigated. In [15] [17], STATCOM provided an uninterrupted operation of wind farm during grid fault for the first case that RSC re-enabled after the fault is cleared. In [7], considering case 1 of timing scheme, stabilizing grid voltage using a STATCOM were discussed and simulated for different situations such as grid fault. In [18], GSC of DFIG is configured as a STATCOM. An optimum strategy regarding operational time of STATCOM and crowbar activation time were proposed. The short-comings of this method are: 1) it can only improve voltage stability for faults distant from the wind farm location; 2) due to small capacity of GSC (usually 30% of DFIG capacity), reactive power production of GSC may not be able to meet the reactive power demand that ensures LVRT of a
7   

wind farm [19]. Other than using an a crowbar circuit and/or external reactive power compensators, some major solutions and technologies to achieve LVRT of DFIG-based wind turbines are as follow:1) An energy storage system (ESS) that is connected to the DC-link of DFIG [20]. The ESS can act as a sink or a source of active power depending on the operating mode of DFIG. It can regulate the DC-link voltage during grid disturbances. Although RSC can still operate in the grid fault, it needs to be sized accordingly to accommodate fault current which increases the cost of the system; 2) Regulate stator flux by improving rotor current control [21]. During grid fault, a large EMF (Electromotive force) induced in the rotor circuit which is the result of dc and negativesequence components induced in the stator flux linkage of DFIG. A modified RSC control which controls the rotor current can be used to oppose the dc and negative-sequence components of the stator flux linkage. The controller must act in such a way that rotor current and voltage does not exceed the limitation of the switching devices in the RSC. The advantage of this method is that it does not need any additional hardware such as crowbar. But the efficiency of this method depends on the severity of the fault and pre-fault condition of the wind turbine. Therefore, it may not be applicable to all grid faults; 3) Utilizing an additional series grid-side converter (SGSC) [22]. The SGSC is connected to the DC-link from onside and to the open terminals of DFIG's stator windings from the other side. SGSC can directly control the net voltage applied to the stator windings with this configuration. It can therefore control the stator flux of DFIG. The control system of SGSC transforms the harmful oscillatory synchronous frame stator response to a bounded response. LVRT of the DFIG improves in a way that SGSC regulates the stator flux to a new level compatible with the voltage at the grid connection point of DFIG during grid fault. This method needs additional hardware which adds to the complexity and cost of the system. Also, system parameters such as inductance and frequency must be estimated accurately for effective control of voltage flux. This level of accuracy might not be obtainable in practical situations.

8   

1.4 Motivation and objectives
LVRT capability of a wind farm has been the subject of many researches during recent years. An uninterrupted operation of wind farm for a certain period of time is dictated by many European and North American grid codes. As it was discussed in section 1.3, using crowbar and an external reactive power compensator such as STATCOM is an effective way to ensure uninterrupted operation of DFIG wind turbine during grid fault in a weak grid. Employing a STATCOM is not the most economical solution for LVRT improvement of DFIG wind turbine in a weak grid, but it is the most effective solution to address this problem as stated in many literatures. Considering different timing schemes of crowbar and RSC can help selecting optimum control scheme during grid disturbances. Excellent dynamic performance and wide range of operation of STATCOM makes it an attractive choice as an external compensator device .Also, reducing power system cost can be an excellent motivation for minimizing STATCOM capacity that ensures LVRT of the wind farm and fast post-fault recovery. With existence of STATCOM in the system, coordination of DFIG and STATCOM becomes necessary during normal operation. The objectives of this thesis include: 1. Expand results of [6] and [15] papers in a sense that it explores the three cases of timing schemes for crowbar deactivation and resumption of RSC gate signals as well as dynamic performance of DFIG based wind turbine after grid fault with and without utilizing the STATCOM. A test system which includes grid, transmission line, load, DFIG-based wind turbines and STATCOM is simulated in MATLAB Simulink. 2. Find the minimum rating of STATCOM that ensures wind farm stability and nominal voltage achievement after fault recovery. This is done by utilizing load flow model of transmission line and calculating minimum reactive power demand for compensating voltage drop. Two cases of change in length of the transmission line and change in shortcircuit capacity of the grid is considered and results are verified by simulation. 3. Coordination between DFIG and STATCOM for the matter of providing reactive power for a certain load is proposed based on loss minimization of the whole system. Losses of DFIG
9   

and STATCOM are calculated and Maximum Point of Power Tracking (MPPT) is considered for DFIG.

1.5 Thesis layout
This thesis consists of 7 sections. The first chapter included technical background, review of related literature. Motivation and objectives are also given in this chapter. The rest of the thesis is organized as follow: In chapter 2, wind turbine characteristics and aerodynamic modelling is explained. Pitch control concept for variable speed wind turbine is discussed. Model of DFIG is developed and its principle of operation is discussed. In chapter 3, STATCOM mathematical model is introduced. Its different mode of operation is discussed. In chapter 4, improvement of LVRT capability of a DFIG-based wind farm is discussed. A test system is proposed. Crowbar principle of operation and configuration is given. Different timing scheme of crowbar activation and RSC gate signal are simulated and analyzed. In chapter 5, transmission line is modeled and voltage drop compensation equations are developed. Minimum capacities of STATCOM for different length of transmission line and various grid short-circuit capacities are calculated and verified by simulation. In chapter 6, stator and GSC reactive power limitation curves are discussed. Copper loss and converter loss equations of DFIG and converter loss of STATCOM are formulized and calculated for a test system. Optimum reactive power management is proposed for various reactive loads and DFIG operational points. Chapter 7 consists of conclusions drawn from results and simulations of previous chapters as well as suggestions for future work.

10   

CHAPTER 2. DFIG BASED WIND FARM
 

2.1 Introduction
Figure 2-1 shows the block diagram of a DFIG based wind turbine [14]. The generator is connected to the wind turbine via shafts and a gear box. The wound-rotor induction generator is fed from both stator and rotor sides, where stator is directly connected to the grid and the rotor is connected to a back-to-back voltage source converter (VSC) and from there to the grid. In this way, variable-speed operation becomes viable as mechanical and electrical rotor frequencies are decoupled. The difference between frequencies is compensated by a power electronic converter which injects the rotor current with variable frequency [4]. The ranging of rotor speed is from sub-synchronous to super-synchronous and this speed is controlled by changing the amount of power generated. The aerodynamic power control of this type of wind turbine is normally performed by pitch control [4].

Figure 2- 1. Block Diagram of DFIG

11   

2.2 Wind energy conversion system
Wind turbine converts the wind power to mechanical power and this power is calculated by [15], [4], [23] , Where is the air density; is the area covered by the rotor ; is wind speed; (2-1) is the

performance coefficient or power coefficient; speed ratio defined by [15] / Where

is the pitch angle of rotor blades; and

is the tip

(2-2)

is the wind-turbine rotor speed, and R is the blade length. which is a function of tip speed ratio and pitch angle of rotor

Here, performance coefficient blades

will be discussed in details. The computation of performance coeffient needs

knowledge of aerodynamics so numerical approximations have been introduced. The equations based on [5] are: , 0.5176
. .

0.4

5

0.0068

(2-3) (2-4)

From (2-3) and (2-4),

versus

characteristics can be calculated for various . Figure 2-2 is found which is 0.48 when 8.1.

depicts these curves for certain values of pitch angles of rotor blades. When 0 is chosen as the angle of rotor blades, maximum value of

12   

Figure 2- 2. The

charactersictis of wind turbine

can be calculated by measuring the actual values of wind and rotor speed. Also, by knowing the pitch angle, mechanical power extracted from the wind farm can be calculate by using (2-1) to (2-4). (2-1) is normalized to (2-5) in per unit system:
_ _

,

_

(2-5)

_

and

_

are the performance coefficient and wind speed in per unit, respectively. The

annual average expected wind speed in m/s is typically selected as the base wind speed [5]. Figure 2-3 shows the wind turbine power characteristics for different values of wind speed and rotor speed. In figure 2-3, 12 m/s is chosen as the base wind speed and 1.2 p.u. as the base rotational speed. The pitch angle is 0°.

13   

Figure 2- 3. Wind turbine power characteristics [5]

Maximum power point tracking is defined as controlling mechanical power extracted from the wind turbine by following a pre-defined curve that is overlaid to the wind turbine power characteristics graph [24]. It is usually illustrated by the ABCD curve. Up to point A, wind power is too low for energy production so the reference power is zero. Point A is also called the cut-in wind speed which is 6 m/s in figure 2-3. Between points B and C, the reference power is the maxima of the turbine power versus rotor speed curves. Wind turbine operates in these points in order to extract the maximum power from the wind energy. Between points C and D, tracking characteristics is a straight line. In order to reduce the stress on the turbine, the mechanical power on the rotor shaft is reduced intentionally [25]. For wind speeds higher than point D, the reference power is kept at 1 p.u. to avoid damage to the wind turbine. ABCD curve is shown by ( _.._ ) in figure 2-3. In the event that wind speed is above maximum allowable speed, it can no longer be controlled by increasing the power generation as it leads to overloading of generator and converter. Pitch control is a common method to control the input power aerodynamically. At low wind speed (e.g. below rated wind speed), pitch angle control is at its optimum value to maximize the wind
14   

energy capture. Above rated speed, it prevents the turbine systems to exceed its design limits and reduces mechanical fatigue on the system [25]. Basic control system for pitch angle controller is shown in Figure 2-4 [15].

Figure 2- 4. Pitch angle controller

2.3 Operating principle of DFIG
In section 2.1, it was mentioned that variable operation of DFIG is possible by using voltage source converters. The basic structure of a DFIG wind turbine was also given in figure 2-1. Rotor-Side Converter (RSC) is in charge of applying a controllable voltage across the rotor terminals of WRIG which allows a wide range of variable speed operation [25]. RSC consists of a four-quadrant insulated-gate bipolar transistor (IGBT) and its gates are controlled by pulsewidth modulation (PWM) technique [15]. This allows variable magnitude and phase control of terminal voltage which controls rotor current. Also, active and reactive power of DFIG can be controlled independently via this technique. The main objective of Grid-Side Convertor (GSC) is to keep the DC link voltage constant, thus to balance the power of active power on the rotor side. GSC can also provide reactive power when capacity is available. Its structure and control technique is the same as RSC. The power flow between rotor and grid can be controlled both in magnitude and direction. This leads to wide operating range from sub-synchronous to supersynchronous speeds [15]. The power flowing through the rotor of DFIG has three components: 1) Air gap power ( ) which is the electromagnetic power flowing between stator and rotor of the generator through the air gap in between; 2) Mechanical power ( ) which is transferred between shaft of the wind turbine and rotor of the generator; 3) slip power ( ) which is the power flowing between the

15   

rotor and RSC. Following equations can be given to depict the relations between these powers [26]: (2-6) 1 1 Where  , is the synchronous speed in rad/s and (2-7) (2-8) is the rotor speed in rad/s. When

the wind speed is below rated speed, rotor magnetic field rotates at a slower rate than the stator magnetic field and 0 (Figure 2-5). In this mode, 1. In this case, the machine operates in sub-synchronous mode is transferred from shaft to rotor and is transferred from rotor to

stator. The slip power is supplied by the DC capacitor of the back-to-back VSC. As the power draws from the DC-link, GSC regulates the DC-link voltage and keeps its voltage constant. Enough power should be provided by the grid so that GSC can control the DC-link voltage. Active power of the DFIG is provided by the stator [25]. When the wind speed is above the rated speed, rotor magnetic field rotates in counter-clockwise direction and 2-6). and 1 0. In this case, the machine operates in super-synchronous mode (Figure are transferred in the same direction as previous mode. Power is delivered to the

gird from the rotor winding via VSCs [25]. In this mode, part of the active power is delivered to the grid from stator and the other part is delivered from the rotor winding. Between these two operation modes, there is a synchronous operation mode where the rotor does not provide any active power ( 0 .

Figure 2- 5. Sub-synchronous mode

Figure 2- 6. Super-synchronous mode

16   

2.4 DFIG model
The stator and rotor voltages of a DFIG are given as follows [6]  (2-9) (2-10) Where, Where , , are the stator and rotor resistance respectively. and and , and and are the stator, rotor and


and magnetising inductances respectively. their currents. The stator and slip speed are speed. and

are stator and rotor voltages,

are

is the rotor angular

are stator and rotor flux linkage.

 s ds

(s r ) dr

 s

qs

(  s   r )

qr

 
Figure 2- 7. Equivalent circuit of DFIG in dq-reference frame

17   

The electrical model of DFIG in synchronous reference frame (dq-frame) is given in figure 2-7 and the equations are given below [27], where quantities of rotor side are referred to stator side. Subscripts `s' and `r' refer to stator and rotor side respectively , while `d' and `q' refer to direct and quadrature axes respectively.         Where and . s s (2-12) (2-11)

The electromagnetic torque is given by [4]: 1.5 And the equation of motion is [4]: (2-14) Where is the mechanical angular speed of the rotor, is the mechanical inertia constant of (2-13)

generator, and

is the mechanical torque produced by the wind turbine.

Active power equation of DFIG is given in (2-15). Active power flows through rotor and stator of the generator and combination of both construct the total active power. The equation of reactive power is given in (2-16). This equation might be different from the actual reactive power
18   

which is fed into the grid as reactive power flowing from rotor side of the DFIG depends on the control strategy of its power electronic converters [4]. As aforementioned, GSC can provide some amount of reactive power depending on its capacity. Therefore, GSC impact must be taken into account in power flow calculation. 1.5 1.5 (2-15) (2-16)

Power converters cannot generate or consume active power, although they can produce or consume reactive power [4]. Due to this fact, control strategy of power converters does not have any impact on the active power flow and equation (2-15) holds for power flow calculation. Also, all the active power that flows into or from the rotor winding will be drawn or fed into the gird, respectively [4].

2.5 Rotor-side converter model
The power electronic part of the DFIG consists of two voltage-source converters (VSCs) and a capacitor in between that is called DC-link. The overall control objectives of variable speed operation of wind turbines are divided into generator speed control and electrical power transfer control [28]. The generator speed controller is associated with rotor-side converter and its goal is to control the electromagnetic torque, . By neglecting stator resistance and assuming that d-axis overlap on the maximum of stator flux, torque is directly dependent on the quadrature component of the rotor current. From (2-11) and (2-13), by considering quadrature voltage of the rotor to be equal to the terminal voltage and : 1.5 (2-17) and neglecting rotor transients, following relation holds between

The active power set point of the converter is generated by the rotor speed controller which was discussed above. The reactive power set point is based on terminal voltage or power factor controller [4]. Considering same assumption as above and from (2-11), (2-13), and (2-16), it can

19   

be seen that at the stator terminals, reactive power exchanged with the grid depends on the direct axis component of the rotor current. Following equation can be given for 1.5 If GSC operates in unity power factor, : (2-18) from equation (2-18) equals the total reactive power

exchange between the generator and the grid. Otherwise, total reactive power is the sum of and the reactive power that is fed from the GSC to the grid.

2.6 Conclusions
In this chapter, wind turbine system and principle of operation of a DFIG-based wind turbine are discussed. Wind turbine characteristic curves which can be utilized to indicate the points of maximum power extraction at different wind speeds were given. Different modes of DFIG operation which are sub-synchronous, synchronous and super-synchronous and the flow of power in each case were also explained. At the end, the relation of voltage and current of DFIG in synchronous reference frame as well as active and reactive power flows of DFIG are modelled.

20   

CHAPTER 3. SYNCHRONOUS VAR COMPENSATOR (STATCOM)
 

3.1 Introduction
It has been discussed that stabilizing voltage after fault clearance can help the system to restart normal operation. Voltage stability can be reinforced by injecting reactive power to the system. FACTS-based devices such as Static Synchronous Var Compensator (STATCOM) and Static Var compensator (SVC) can be utilized for this matter. Apart from voltage regulation, FACTS devices can also increase transmission line capacity, improve transient stability to prevent voltage collapse, and damp power oscillations [29]. STATCOM can improve power quality of the system effectively and has been used in many parts of the world. Table 3-1 lists some of the STATCOMs installed on the main transmission lines in the recent years.

No. 1 2 3 4 5 6 7

Place Germany Mexico England USA USA England USA

Voltage 20 kV 138 kV 275 & 400 kV 115 kV 138 kV 115 kV 138 kV

Power Range 0-38 MVar 0-36 MVar ±75 MVar -41 to 133 MVar ±100 MVar ±150 MVar -80 to 110MVar

Year 2000 2000 2001 2001 2003 2003 2004

Table 3- 1. List of installed STATCOMs

Here, STATCOM will be compared to other types of shunt reactive power compensators. The basic types of reactive power compensators are mechanically switchable capacitor banks. This type of compensator is usually used to feed reactive power to wind farms containing asynchronous generators such as induction generators ,as induction generators consumes reactive power even during normal operation. As DFIGs usually operates in unity power factor or provide

21   

some reactive power to the grid, using capacitor banks during normal operation may result in over-voltage at some buses of the power network. Since capacitor banks are not sensitive to voltage changes and mechanically switching them in or out of the grid can be slow, they are not good candidates to be used during grid disturbances. The other issue with the capacitor banks is that at low voltages, their reactive power production is very low and cannot improve voltage stability effectively [7]. Figures 3-1 and 3-2 show the schematics of SVC and STATCOM, respectively. Both STATCOM and SVC are shunt-connected devices that can absorb and/or generate reactive power but STATCOM has wider operating range and faster response [30]. SVC consists of capacitors, reactors or combinations of both that are switched in or out of the system in order to inject or extract reactive power to the system. Conventionally, mechanical switches were used to do the switching operation. In modern SVCs, Thyristor Switched Capacitors (TSC) and Thyristor Controlled Reactors (TCRs) are used for better dynamic characteristics such as faster switching operation. Hence, SVC has semi-controllable element that can only be turned off when valve current is zero. On the other hand, STATCOM consists of Gate Turn-off Thyristors (GTOs) or IGBTs which are fully controllable. Another advantage of STATCOM is that its capacity depends on the inverter capacity as for SVC, large capacitors and reactors are required if a large reactive power compensation is needed [30].

22   

Figure 3- 1. Schametic of SVC

Figure 3- 2. Schematic of STATCOM

The voltage versus current characteristics of SVC and STATCOM are given below (Figures 3-3 and 3-4) which shows a wider operating range for STATCOM.

Figure 3- 3. SVC V-I characteristic

Figure 3- 4. STATCOM V-I characteristic

The major advantage of STATCOM over other reactive power compensators discussed so far is that the STATCOM can operate over its full output current range even at very low voltage levels

23   

and the maximum var generation or absorption changes linearly with the utility or AC system voltage.

3.2 STATCOM Model
The main parts of the STATCOM are a capacitor that is connected to a Voltage-source converter (VSC), a coupling transformer and a connection filter as it is shown in figure 3-5.

Figure 3- 5. Block diagram of STATCOM

The objective of STATCOM in this thesis is to regulate voltage at the PCC (Point of Common Coupling) at the desired level, by injecting or absorbing reactive power. The DC-link capacitor that is connected to VSC of a STATCOM acts as a constant DC voltage source. To keep this voltage constant or in other words to regulate DC-link voltage, there would be some real power exchange between STATCOM and rest of the power system which is defined by the following equation

 Where is the difference between 

(3-1)  . Equation (3-2) gives reactive power injection by

STATCOM [14]

(3-2)

24   

In general, transmission of power (P+jQ) over a power line with impedance (R+jX) results in a voltage drop [7]:



.

.

(3-3) is directly proportional to the reactive power (Q)

It can be seen that change in the voltage 

as X>>R in a transmission line. Therefore, supplying reactive power during voltage sags (e.g. grid fault) can improve voltage stabilization and Results in a better dynamic performance of the power system. Considering the above reason, phase difference STATCOM and terminal voltage between voltage generated by VSC of is kept close to zero (It is not equal to zero as active

power is needed to compensate for the transformer and switching losses of STATCOM and to keep DC-link voltage constant), so only reactive power flows between STATCOM and grid. Reactive current between and flowing between STATCOM and grid depends on the voltage difference . If is less than , reactive power flows from grid to STATCOM is greater than , reactive power

(STATCOM absorbs reactive power), on the other hand if

flows from STATCOM to the grid (STATCOM generates reactive power). The Reactive current grid and the amount of reactive power exchange between STATCOM and

can be formulated as below, respectively. (3-4) (3-5)

The basic control system block diagram of a STATCOM is shown in Figure 3-6 [15]. STATCOM consists of a large number of GTOs (or an IGBT-based voltage source converter in the case of DSTATCOM) which the gating scheme for these devices are controlled by internal converter control [29]. The internal control responds to the demand of reactive and real power reference signals. These reference signals are provided by external control and come from system instructions and variables that dictate the functional behaviour of STATCOM [29]. The Phase-Locked Loop is used in the control system to provide the basic synchronizing signal between three-phase system voltage and output voltage of the STATCOM. In this way, power

25   

electronic converter can be seen as a sinusoidal, synchronous voltage source behind a reactor which is generally the inductance of coupling transformer. The amplitude and angle of this voltage source is controlled by external control via reference signals. Required reactive power for compensation is forced by internal control via operating converter power switches. The magnitude and phase angle of the output voltage is computed from the reference signal Another control loop is required to keep the capacitor voltage signal is
 

.

constant which its reference

as shown in the figure 3-6. The internal control generates a set of coordinated

timing waveforms also known as gating pattern based on these reference signals. These gating pattern determines the on and off period of each switch based on the required output voltage. The magnitude and phase angle of the output voltage determines the real and reactive current flows between converter and the grid and therefore the real and reactive power STATCOM exchanges with the grid.

  t   t

Figure 3- 6. Basic control system block diagram of a STATCOM

26   

3.3 Location of STATCOM
The STATCOM can regulate voltage at the bus which it is connected to. The STATCOM should be installed on the location that needs the most voltage support. As mentioned before, reactive power should be injected to the system to decrease voltage fluctuation and bring the voltage back to its nominal value after fault clearance. For these reasons connecting STATCOM to the load bus gives the maximum benefit. The size of the STATCOM depends on the required reactive power that can bring the voltage to its nominal voltage after fault is cleared. As STATCOM can use its full output current range even in low voltage condition, it can be used effectively in fault conditions. Its minimum size is calculated for several cases of different transmission line lengths in chapter 5.

3.4 Conclusions
This chapter explains the operating principle of the STATCOM when it is connected to the grid. The basic control approach in a STATCOM is also discussed briefly in this chapter. STATCOM can be found to be superior over SVC in terms of faster dynamic response and wider operating range. STATCOM are generally placed in the location which needs the most voltage support in the grid.

27   

CHAPTER 4. LVRT CAPABILITY OF DFIG BASED WIND FARM 4.1 Introduction
In chapter 1, the necessity of power converter protection was discussed and some major methods and technologies that addressed this issue were explained. Among all the methods, protection of RSC using crowbar was chosen to be discussed in details in this thesis. Also, the necessity of using STATCOM for improving system dynamics in fault condition was also explained in chapter 1 and is going to be discussed in details in this chapter. Over-current and over-voltage may occur in the rotor circuit of DFIG if fault happens in the power system. The level of this overflow depends on the severity of the fault and location that fault happened. Fault with high impedance has less impact on the system as well as grid fault which happened in the location far from the wind turbine. The mathematical formulation regarding the occurrence of over-current in the rotor is given below. Using equations (2-9) and (2-10) from chapter 2, the stator and rotor voltage can be formulated as follow  (4-1) (4-2) By combining (4-1) and (4-2), and neglecting stator and rotor resistances,

1

.

. 0, becomes

(4-3)

The above equation during steady state when

.

.

(4-4) . Since the

At the instant of the grid fault, there will be a sudden change in the stator voltage, 

values of stator and rotor flux will not change at the moment of the fault, (4-3) becomes,

28   



1



(4-5) 0 during the grid fault, which can

Over-current in the rotor can be avoided by maintaining

be achieved by a large step change in rotor voltage  to follow the stator voltage as





(4-6)

Since the voltage capability of RSC is limited (25%-30%), the RSC cannot produce enough voltage ( ) to satisfy (4-6), so large over-current occurs on the rotor [6].

4.2 Grid code requirements
In this section, major grid code requirements will be discussed and LVRT which is the focus of this thesis will be explained in details. These requirements can be summarized as follow [19], [31]: 1) Voltage range and control: Wind farm power station is required to operate at a rated voltage as well as a specified operating range which can be different for various power systems. The voltage range considered here is ±5% which is a standard for many countries such as Canada. 2) Power factor requirement: Requirement is concerned with providing reactive power support by the wind farm. It is desired that the power factor remain close to unity and wind farm is reactive power neutral. 3) Active power and frequency control: Wind farms are required to regulate their active power to a defined level in order to ensure a stable frequency in the system and to prevent overloading of lines. Also, frequency control must be applied by wind farms by means of controlling the level of active power with frequency deviations. 4) Low voltage ride through (LVRT): Wind farm must remain connected to the power system for a specific amount of time in the event of grid disturbances. This specific amount of time can be different from one grid code to another.

29   

5) High voltage ride through (HVRT): Wind farm must be connected to the grid for a specific amount of time if the system voltage goes above the upper limit. 6) External control of the wind farm: TSO must be able to control wind farm connection to the grid or disconnection of it from the system remotely. Also, signals corresponding to different parameters of the wind farm such as voltage regulation must be provided by the wind farm operator in order to control the wind farm power station externally. LVRT dictates wind farms must withstand voltage dips to a certain percentage of the nominal voltage on the high voltage side of the DFIG generator (PCC in figure 1-7). This voltage dip can be zero in some cases. The protective voltage and frequency relays which are placed to disconnect wind turbines in the event of grid disturbances must be set in such a way that agrees with the specified time and voltage limits of LVRT. LVRT analysis of the test system in this thesis is performed based on the German (EON) fault ride through requirement which is the one of the most stringent grid codes (Figure 4-1). According to this requirement, wind power plants must not be disconnected or cause instability in the system if a three-phase short circuit with the fault-clearing times up to 150 ms in the entire operating range of the plant happens in the power system.

Figure 4- 1. Proposed voltage-time LVRT curve by EON [32]

30   

4.3 LVRT component for DFIG
Protecting RSC during grid faults becomes a vital issue which can be solved by shorting the rotor circuit of the induction generator through turning on a crowbar. Crowbar activation may occur not only at the instant of a voltage dip but also in a situation where voltage recovery is abrupt after fault clearance [33]. Two types of crowbar circuits are available [33]: 1) The passive crowbar which uses diode rectifier or a pair of antiparallel thyristors to short the rotor side convertor terminals. This type of crowbar has semi-controllable elements that can only be turned off when the valve current reaches zero, so it has no control on the deactivation process of crowbar operation. It leads to longer time of RSC connection to the rotor of DFIG and may delays the voltage recovery procedure. 2) The active crowbar which uses fully controllable elements such as IGBT. Shorting rotor with this crowbar improves the dynamic of the crowbar operation by fast elimination of rotor transient and full control of crowbar deactivation. Figure 4-2 shows the configuration of a typical active crowbar [13]. The IGBT is turned on when the DC link voltage reaches its maximum value (for example, 20% above rated voltage) and/or the rotor current reaches its limit value (typically 2 p.u.). Simultaneously, the rotor of the DFIG is disconnected from the rotor-side converter and connected to the crowbar.

Figure 4- 2. Connection of crowbar in the rotor circuit

31   

4.4 Test template for study
The objective of this chapter is to evaluate the voltage support provided by STATCOM for different crowbar timing scheme under fault condition. A test system has been developed in Matlab/Simulink to simulate the behaviour of the wind farm in weak grid. The test system consists of a wind farm connected to the main system via transmission lines and a local load is connected to the high voltage side of the DFIG wind farm. Figures 4-3 and 4-4 show the single line diagram of the test system with connected capacitor bank and STATCOM, respectively. The DFIG wind turbines used in this simulation are based on Simulink discrete model of DFIG with some modifications. A model of active crowbar is developed and included in the Simulink DFIG model. The gating scheme for IGBT of crowbar is also developed and utilized in the DFIG model. The STATCOM model is also based on the Simulink demo model. In the next chapter higher capacity STATCOM were developed based on the existing model of this chapter. The ratings of the system components are presented in the appendix. The following options for crowbar deactivation and converter re-enabling are considered in section 4.5 case studies: Case 1) crowbar is deactivated and RSC is re-enabled after the fault is cleared; Case 2) crowbar is deactivated before fault clearance, while the RSC is re-enabled afterwards; Case 3) crowbar is deactivated and RSC is re-enabled before fault clearance. The simulations for each of the above cases are carried out for two conditions. The first condition is using a crowbar and a 3MVAR shunt capacitor to maintain the voltage at PCC (Figure 4-3) and the second condition is using a ±3 MVAR STATCOM in addition to crowbar to enhance the LVRT capability of DFIG (Figure 4-4). The distribution grid consists of a 120kV, 60 Hz supplier, feeding a 66 kV distribution system through 120/66 kV step down transformer. During simulation the wind speed is constant at 15m/s and DFIG is running at super-synchronous mode. An aggregated model used for DFIG-based wind farm which consists of six 1.5 MW DFIG based wind turbine. Their converters rated 30% of induction generators. The DC link capacitor is 10 mF and the DC rated voltage is 1150 V. There is a 12MW and 5MVAR load placed on PCC. For each of the proposed cases, a three-phase-to-ground fault occurred at PCC at 1.7 s and last 150ms. The voltage dip is about 90% and this study considers the EON grid code that dictates the wind farm should withstand 100% voltage dip for 150ms.

32   

Figure 4- 3. Test system with connected capacitor bank

Figure 4- 4. Test system with connected STATCOM

In this study, weak grid is simulated by placing a large load at the far end of the transmission line and by increasing the length of the transmission line (e.g. increasing network impedance). The source of the external reactive power is connected to the load to be most effective in voltage support.

4.5 Simulation results 4.5.1 Crowbar deactivated, RSC re-enabled after fault clearance
In case 1, crowbar is activated and RSC is blocked at 1.71s. Crowbar remains on when the fault is cleared. In this manner, rotor of DFIG is still short and wind generator acts as a conventional
33   

induction generator and starts to absorb reactive power from the grid. Consuming reactive power by wind turbines delays fault recovery for the whole system and keeps the voltage at PCC around 60% of the nomial voltage (66 kV). The crowbar is removed when the PCC voltage reaches 0.7 p.u. and RSC is re-enabled after crowbar current reaches zero. After that DFIG supplies reactive power to the grid and acceraletes the process of voltage recovery. Figure 4-5 and 4-6 show the simulation results for case 1 where capacitor bank and STATCOM were used in the system, respectively. The lenght of the transmission line is 85 km. The significance of using STATCOM rather than shunt capacitor becomes apparent from the graphs as in the first graph (Figure 4-5), PCC voltage remains under 70% for 200 ms before reaches the nomial voltage but in the second graph (Figure 4-6), STATCOM boosts the voltage to 1 p.u. by using its full capacity to supply reactive power after fault. The delay in the case of capacitor bank connected to the system postpones grid recovary and may result in damaging the local load connected to the system.

Figure 4- 5. Simulation result in case 1 with shunt capacitor (85km transmission line) From top to bottom: Voltage at PCC; RSC phase currents; DFIG active power; DFIG reactive power;DC-link voltage; Crowbar currents

34   

In figures 4-5 and 4-6, rotor current is shown to reach zero during fault which means the rotor is disconnected from the DFIG and reconnected after fault clearance. The same figures show the current passing through the IGBT of the crowbar. A large value of crowbar resistance reduces the crowbar current to zero at a faster pace allowing the RSC to be re-enabled sooner and leads to faster recovery [6]. However, with larger resistor, energy dissipation in the crowbar circuit becomes higher. In order to consider both of these issues, the value of the crowbar resistance is chosen to be 0.1 , which is the optimum value in terms of fast current reduction and lower power dissipation. The active and reactive output power of the wind farm in both cases are also given in figures 4-5 and 4-6.

Figure 4- 6. Simulation result in case 1 with STATCOM (85km transmission line) From top to bottom: Voltage at PCC; RSC phase currents; DFIG active power; DFIG reactive power; DC-link voltage; Crowbar currents

During fault condition, the active power and reactive power are both zero. Eventhough DFIG acts as an induction generator and started to absorb reative power during fault condition, since the terminal voltage is very low, the reactive power consumption is insignificant. As the terminal
35   

voltage raises, DFIG absorbs more reactive power as the crowbar protection is still in effect. Providing enough reactive power by STATCOM helps faster crowbar deactivation and resumption of RSC gate signals. Although RSC control is lost, GSC is still in operation during fault and keeps the DC-link voltage in control. The maxmimum devation of DC-link voltage (named as Vdc in figures 4-5 and 4-6) is less than 20% which is in the acceptable range. By increasing the length of the transmission line the grid becomes weaker.with 110 km transmission line, utilizing STATCOM becomes even more essential as shunt capacitor bank can no longer supply enough reactive power to increase the PCC voltage to 1 p.u. after fault recovery and wind turbines have to be disconnected from the grid. STATCOM plays a vital role for an uninterrupted operation of wind turbines and satisfying the grid code. The simulation results are shown in Figures 4-7 and 4-8 with shunt capacitor and STATCOM respectively.

Figure 4- 7. Simulation result in case 1 with shunt capacitor (110km transmission line) From top to bottom: Voltage at PCC; RSC phase currents; DFIG active power; DFIG reactive power; DC-link voltage; Crowbar currents

36   

As it is shown in figure 4-7, the RSC currents remain zero because RSC is disconnected from the system. As long as crowbar protection is in effect RSC cannot be reconnected to the system. In the case of installed capacitor bank, this reconnection never happened since the condition for crowbar removal (voltage above 0.7 p.u.) was not met. Since this situation is not accepted by the gird code LVRT requirement, wind turbines have to be disconnected from the grid. Disconnection and reconnection of a wind farm with this size can cause serious voltage instability through the power system. Reactive power support provided by the STATCOM ensures fast nominal voltage restoration for the power system (figure 4-8).

Figure 4- 8. Simulation result in case 1 with STATCOM (110km transmission line) From top to bottom: Voltage at PCC; RSC phase currents; DFIG active power; DFIG reactive power; DC-link voltage; Crowbar currents

4.5.2 Crowbar deactivated before, RSC re-enabled after fault clearance
In case 2, crowbar is activated at 1.71s, and is removed after 30ms after damping rotor overcurrent. RSC gate signals are turned off at the same time that crowbar is activated. In a weak grid
37   

(e.g. 110 km transmission line), although crowbar is deactivated after a few miliseconds after fault has happend in the grid but RSC gate signals remain disabled until the voltage reaches 70% of the nominal voltage. Figure 4-9 shows the result of the test system simulation with capacitor bank.

Figure 4- 9. Simulation result in case 2 with shunt capacitor (110km transmission line) From top to bottom: Voltage at PCC; RSC phase currents; DFIG active power; DFIG reactive power; DC-link voltage; Crowbar currents

Using shunt capacitor bank will not boost the voltage to the desired value but STATCOM can provide enough reactive power for DFIG and the whole system to withstand the fault and recover fast after the fault is removed, moreover as the crowbar is removed earlier than that of the first case, little reactive power is consumed by the generator when the fault is cleared (Figure 4-10). The same as case 1, GSC controls the DC-link voltage and keeps it within 20% limit.
38   

Figure 4- 10. Simulation result in case 2 with STATCOM(110km transmission line) From top to bottom: Voltage at PCC; RSC phase currents; DFIG active power; DFIG reactive power; DC-link voltage; Crowbar currents

4.5.3 Crowbar deactivated, RSC re-enabled before fault clearance
In the last case, Crowbar is activated and RSC is blocked at 1.71 s which is the same as previous two cases but both crowbar and RSC are re-enabled before grid fault clearance, at 1.714 s and 1.722 s respectively. Since RSC is re-enabled before fault clearance, it can control active and reactive power of the wind turbine during and after fault. Utilizing a STATCOM is not necessary for this case in opposite to two previous cases. However, for a weak grid (e.g. 110km transmission line), STATCOM keeps PCC voltage almost within the range (±5% of the nominal
39   

voltage) and damped the voltage oscillation faster than shunt capacitor bank after fault recovery (Figures 4-11 and 4-12).

Figure 4- 11. Simulation result in case 3 with shunt capacitor (110km transmission line)

Figure 4- 12. Simulation result in case 3 with STATCOM (110km transmission line)

For this case, there is a risk of rotor over-current during fault clearance which may cause further action of crowbar protection [6]. This can delay the voltage recovery after fault clearance.

4.6 Conclusions
In this chapter, three cases are studied regarding the deactivation time of crowbar and reenabling the gate signals to the RSC circuit. The first two cases considered the situation where the RSC was re-enabled after the fault was cleared. In former crowbar was deactivated after fault clearance and in latter crowbar was removed during fault. It was shown in the simulation that for a weak grid without using a STATCOM, the PCC voltage could not reach the nominal voltage after the grid fault was cleared and the wind turbine had to be disconnected from the grid to guarantee a fast grid recovery and to satisfy power quality requirements. The existence of STATCOM was not as vital for the third case. Re-enabling the RSC during fault helps in regaining control of active and reactive power and providing reactive power for grid support. However, STATCOM stabilized the voltage faster in the weak grid condition for this case.
40   

CHAPTER 5. OPTIMUM CAPACITY OF STATCOM
   

5.1 Introduction
In the previous chapter, the importance of STATCOM for improving LVRT capability of wind farm was discussed. In this chapter, finding minimum rating of STATCOM that ensures wind farm stability and nominal voltage achievement after fault recovery will be covered. In a conventional generator (e.g. synchronous generator), equal area criterion is used extensively in literatures [34] [3] [35] to ensure that generator will stay synchronized to the grid after the fault is cleared. However, DFIG based wind turbine has LVRT capability (the one that is used in this thesis) and it stays synchronized to the grid during the fault and after the fault is cleared. The transient stability problem in the sense that one or a group of generators may be forced out of synchronism following a grid fault does not as such apply to wind power generation systems [36]. The problem of finding minimum rating for STATCOM can be addressed by using voltage stability criteria. In the event that STATCOM cannot provide enough reactive power (e.g. long transmission line), the voltage stays around 60% as the crowbar is not removed and DFIG acts as an induction generator and keeps consuming reactive power. However, in a situation that STATCOM provides enough reactive power to DFIG, wind turbine starts providing reactive power (since crowbar is deactivated and RSC gate signals is on), and brings the PCC voltage to 1 p.u.
 





 
Figure 5- 1. Simple transmission line

41   

In a simple transmission line (Figure 5-1), the equations for real and reactive power at receiving end can be given as follow [34] cos sin
.

cos
.

) )

(5-1) (5-2) is the

sin

Where Z=R+jX is the impedance of the line, is the angle of the line impedance, and phase difference between sending end and receiving end ( ) of the line.

5.2 Minimum reactive power requirement
In a long transmission line, line resistance is much smaller than the line reactance, hence it can be ignored. By setting R equals to zero, (5-1) and (5-2) will be
.

(5-3) (5-4)  , then (5-5)  (5-6) and  is the change in angular displacement [37].

.

If the receiving end load changed by a factor     

Where  is the scalar change in voltage As is normally small, from (5-6) [37]

(5-7) If the receiving end of the transmission line is shorted, the receiving end short-circuit current is

42   

(5-8) At no load (5-9) (5-10) It can be concluded (5-11) Where is the short-circuit level of the system. It can be observed that the voltage change is

equal to the ratio of the reactive power change to the short-circuit level of the system. This leads to the conclusion that the receiving end voltage falls with the decrease in system short-circuit capacity, or increase in system reactance (e.g. longer transmission line).

5.3 Simulation results 5.3.1 2500 MVA grid, 130 km transmission line
The basic layout of the test system is given in Figure 4-4. According to the simulation results of chapter 4 (section 4.5), using a 3MVAR STATCOM ensured uninterrupted operation of DFIG wind farm when the transmission line was 110km. The grid is rated at 2500 MVA. For this simulation, a longer transmission line (130km) is used. A three-phase fault is occurred at 1.7s and removed at 1.85s. The crowbar protection scheme that is used here, is case 1 of chapter 4 where crowbar is deactivated and RSC is re-enabled after the fault is cleared. At first, a 3 MVAR STATCOM is used for this system. The capacity of the STATCOM is not enough for DFIG based wind farm to ride-through the fault and the maximum PCC voltage is around 0.64 p.u. after the fault is cleared (Figure 5-2 and 5-3). STATCOM capacity is enough to keep the voltage between ±5% of nominal voltage in normal operation of the power system.
 

43   

 
Figure 5- 2. PCC voltage of 130km transmission line after using 3 Mvar STATCOM

 
Figure 5- 3. Close-up of PCC voltage of 130km transmission line after using 3 Mvar STATCOM

 

It should be mentioned that once DFIG terminal voltage reaches 0.7 p.u. the crowbar is removed and RSC gate signal is started. At this instant, DFIG resumes controlling of active and reactive power and PCC voltage will reach 1 p.u. so change in voltage  (in (5-11)) can be considered as 0.06 p.u. and V can be considered as 0.7p.u.
44   

The short-circuit level

of the system is found to be 11.5 MVA. This value is obtained by

short-circuiting the receiving end of the transmission line. Using (5-11)  0.98 to be 3MVar, the system needs at least another = 3.98MVAR (Figure 5-4). it

This means that by considering initial value of

0.98MVar after the fault is cleared to reach 0.7 p.u. therefore, the minimum capacity of STATCOM to ensure LVRT for 130km distribution system is should be mentioned that the actual which is supplied by STATCOM is 1.89MVAR at 0.64 is also calculated

p.u. voltage of PCC. Since STATCOM reactive power injection to the system is linear with its terminal voltage, rated capacity of STATCOM can be used in (5-11) so that for rated capacity.

 
Figure 5- 4. PCC voltage of 130km transmission line after using 3.98 Mvar STATCOM

 

45   

5.3.2 500 MVA grid, 170 km transmission line
For the second case study, A 4.5 Mvar STATCOM is used for 170km transmission line. The grid is rated at 500 MVA. The maximum PCC voltage is around 0.65 p.u. after the fault is cleared (Figures 5-5 and 5-6) so more reactive power is needed to bring the voltage to 0.7 p.u and ultimately to nominal voltage. Change in voltage  (in (5-11)) can be considered as 0.05 p.u. and V is considered as 0.7p.u.

 
Figure 5- 5. PCC voltage of 170km transmission line after using 4.5 Mvar STATCOM

 
Figure 5- 6. Close-up of PCC voltage of 170km transmission line after using 4.5 Mvar STATCOM

46   

The short-circuit level  0.61

of the system is found to be 8.6 MVA. Using (5-11)

This means that by considering initial value of

to be 4.5MVar, the system needs at least = 5.11MVAR (Figure 5-7).

another 0.61MVar after the fault is cleared to reach 0.7 p.u. therefore, the minimum capacity of STATCOM to ensure LVRT for 170km distribution system is
 

 
Figure 5- 7. PCC voltage of 170km transmission line after using 5.11 Mvar STATCOM

 

Choosing the initial capacity of STATCOM to start the process of finding the minimum value is important. The initial capacity of STATCOM which was used in the test systems was based on chapter 4 simulations. Also, equation (5-11) is mostly verified for small variation of voltage around 0.7 p.u. such as values above 0.6 p.u. and below 0.7. If the capacity of STATCOM is chosen in a way that the voltage is very low ( lower than 0.5 p.u.), the proposed solution for finding the minimum capacity of STATCOM ensuring LVRT may not work. Although this is rarely the case, since grid supply some of the reactive power which will bring the voltage above 0.5 p.u. at the PCC.
47   

5.4 Conclusions
In this chapter, minimum capacity of STATCOM that guarantees LVRT and uninterrupted operation of a wind farm is discussed. Minimum capacity of STATCOM was found for two cases with the usage of MATLAB/Simulink wind farm model and mathematical calculations. These calculations are based on short-circuit capacity of the grid and voltage changes at the load bus which is also the point of wind farm connection to the grid. The merit of this optimization is lowering the cost of system operation which can be an excellent motivation for system operators to utilize this method.
         

48   

CHAPTER 6. COORDINATION OF DFIG AND STATCOM
   

6.1 Introduction
The necessity of utilizing STATCOM in a weak grid was verified in chapter 4 and finding the minimum capacity of STATCOM which ensures low voltage ride through was also discussed and calculated for two cases in chapter 5. However, the studies were conducted in fault condition and during transient operation. Here, coordinated operation of STATCOM and DFIG wind farm during steady-state is being investigated. With existence of a certain inductive local load in the location close to wind farm and STATCOM (e.g. the power system is similar to figure 4-4) , finding the optimum ratio of reactive power flow from STATCOM and DFIG wind farm is the objective of this chapter. This optimization is based on losses of DFIG and STATCOM, while considering maximum active power extraction of wind turbines in different operation modes. These operation modes as discussed in section 2.3 are super-synchronous, synchronous and subsynchronous modes. Increased reactive power flow increases the losses. [38], [39], and [40] addressed the regulation of reactive power flow in order to obtain optimum efficiency for DFIG-based wind turbines. The main sources of power loss in DFIG wind turbine are copper loss, inverter loss and transformer loss. The iron loss of DFIG and transformer is not considered here, since the iron loss is almost constant when the PCC voltage is almost constant. Inverter loss and transformer loss are major types of power loss in a STATCOM. [38] and [40] addressed the copper loss and inverter loss in a DFIG and [39] addressed only the copper loss. Here, reactive power flow regulation based on coordination of STATCOM and DFIG in order to minimize the total power loss of the system which consists of STATCOM and DFIG wind farm is going to be discussed. The main approach is to calculate the copper loss, inverter loss and transformer loss for different condition of wind farm (e.g. different wind speed). The same equations which are used to calculate inverter loss and transformer loss of a DFIG-based wind turbine are going to be used to calculate the losses of STATCOM with some modifications. Adding DFIG and STATCOM losses will give the total loss of the system. Minimizing this total loss which consequently minimizes the cost of the system is going to be studied. Moreover, this optimization will increase productivity and efficiency of the generation system.
49   

6.2 Losses of the system 6.2.1 Losses of DFIG
The copper loss in the generator winding is [39]: 1.5 The loss of each converter is given as follows [38]:
_

(6-1)

3

,

,



(6-2)

Where: .

,

,

,

,

.

,

:Nominal collector current :Voltage across the collector and emitter
,

: Voltage drop regarding switching loss in transistor : Voltage drop regarding switching loss in diode :Turn-on and turn-off losses of IGBT

,

:Reverse recovery energy of diode :Switching frequency of converter Since DFIG based wind turbines consist of back-to-back converters, converter loss should be calculated for Rotor-side converter and Grid-side converter.

50   

The values used in this chapter to calculate the converter losses are based on [41] and [42] which are given in table 6-1 and the following assumptions are considered,   [43].  and

Operating dc-link voltage Nominal collector current
,

1200 V 600 A 1V

2800 V 1200 A 1V 8.04 J 1.6 J 1.8 m 1.5 m 1.2 V

Turn-on and turn-off losses of IGBT Reverse recovery energy of diode Lead resistance (IGBT) Lead resistance (diode)

580 mJ 155 mJ 1.7 m 1.1 m 1.1 V

Table 6- 1. Converter characteristics data.

RSC converter loss based on the values of table 6-1, for 1200V IGBT and 1620Hz switching frequency is given as below:
_

3 2.434



0.0017

(6-3)

Also, GSC converter loss based on the values for 1200V IGBT and 2700 Hz switching frequency is:
_

3 3.38



0.0017

(6-4)

6.2.2 Losses of STATCOM
The rating of STATCOM converter is higher than DFIG converters. The loss in the converter of STATCOM is calculated based on the characteristics of IGBT and diode from table 6-1. The switching frequency for this converter is 1680 Hz and the operating voltage is 2800 V.
51   

_

_

3 14.538



0.0018

(6-5)

The STATCOM that is used in this study is distribution STATCOM (D-STATCOM). The operation of D-STATCOM is similar to the STATCOM but its rating is usually lower. Two voltage source converters are used in the structure of the D-STATCOM. Having the second inverter, improved the dynamic performance of the STATCOM and eliminated low order harmonics.

6.2.3 Losses of Transformer
Both STATCOM and DFIG wind farm are connected to the grid via transformers. The power loss happens in the primary and secondary windings of a transformer which is due to ohmic resistances of the windings. It is also called copper loss. The copper loss in the transformer windings is:
_

3 , , , 



(6-6)

Where

are the primary winding resistance, secondary winding resistance,

primary current and secondary current, respectively.

6.3 Reactive power capability limitation of DFIG
The electrical model of DFIG in synchronous reference frame (dq-frame) was given in section 2.4. The stator vector voltage can be selected to align d-axis vector of synchronous reference frame. In this way and in steady state, 0 and , also p p 0. Equation (2-12) can be written as follow in per unit system:  0 (6-7)

From (6-7), it can be concluded that
52   



(6-8)

 Considering the above assumptions, the equations for active and reactive power of the stator of a DFIG based on (2-15) and (2-16) and using (6-8) are: 1.5 1.5 1.5 1.5 (6-9) (6-10)

According to (6-9) and (6-10), reactive power limit of the stator can be approximated to: [44] 1.5 So,  1.5 1.5 (6-12) 1.5 1.5


(6-11)









1.5

1.5



Also, | | is the maximum rotor current that can be driven by RSC and is the rated

Where



power of DFIG. Neglecting the stator and rotor losses of DFIG and following section 2.3, the total power from DFIG is the sum of stator and rotor power [45]. (6-13) Also active power of the rotor can be approximated by following equation
53   

(6-14) By neglecting the power dissipated on the DC-link, it can be said that the rotor power ( ) passes through the GSC. Direct-current of GSC can be written as: (6-15)

.

In general, the main objective of GSC is to regulate DC-link voltage and it works with unity power factor, but it is capable of providing reactive power up to its limits. Therefore, GSC can be considered as a source of reactive power. The limits of GSC reactive power are as follows:  


(6-16)



Where

is the rated power of GSC.

In practice, stator and rotor losses are neglected as they are neglected in this section to ensure a margin of safety [44].

6.4 Total loss minimization
The Total loss of the system ( ( consists of losses in DFIG based wind farm and STATCOM. , quadrature-current of GSC ( , direct current of GSC , and wind speed are dependent It is a function of control and dependent variables. Reactive current of the STATCOM , quadrature-current of stator (

are the control variables. Direct-current of stator (

variables. The values of these variables can be calculated in the program based on (6-9) and (615) and operation mode of the DFIG. The operation mode of DFIG is based on the wind speed that indicates the extracted power from DFIG and the rotor speed from a look-up table. This objective function of this optimization problem is to minimize the total loss of the system. The equality constraint is:

54   



Reactive power demand of the local load must be equal to the reactive power supplied by the stator, GSC and STATCOM.

While the inequality constraints are as follow:     Reactive power provided by the STATCOM must be less than or equal to its capacity. Reactive power supplied by stator must be limited according to (6-12). Rotor current is less than or equal to the rated rotor current of generator. Reactive power supplied by GSC must be limited according to (6-16).

Minimizing loss of the STATCOM and DFIG system is performed using Matlab optimization toolbox. Fmincon() is the function which is used for this optimization. Total loss of the system is a constrained nonlinear multivariable function and Fmincon() is the perfect tool for finding the minimum value of this function for different loads and wind speed conditions. The simplified algorithm for finding minimum value of total loss is given below (Figure 6-1) and the source code can be found in the appendix

55   

Input the value of Load  (Mvar) and wind speed(m/s)

Set initial values for I_qstatcom, I_qs,  I_qg

Find MPPT based on wind speed from  LookUp table 

Calculate P loss function

No 

Is this the  minimum,  based on  fmincon()? 

Yes 

Display Results  END 

No  Yes 
Last  Iteration?

Figure 6- 1. Flow chart of proposed optimization method

56   

6.5 Results analysis
The reactive power flow optimization was performed on a test system similar to the test system of chapter 4, figure 4-4. The rating and characteristics of the DFIG wind farm are given in the appendix, the rating of the D-STATCOM used in this system is 5 Mvar and the reactive demand of the local load is in the range of 5 to 7 Mvar. In this system, the voltage drop at the PCC is neglected and the system is in steady-state. The results of running the optimization algorithm are given in tables 6-3 to 6-8. The results are given for two different capacities of GSC: 2.08 MVA and 3 MVA. Table 6-2 shows the result of total power loss of the system when it is optimized for only two of the reactive power sources and the third one is considered to be zero. The first column indicates the wind speed, the second column gives the power loss when reactive power production of GSC is zero, the third column gives the power loss when reactive power production of STATCOM is zero and the last column shows the power loss when the reactive power coming from stator of DFIG is zero. The result of this table can be compared to the result of table 6-3 where the optimization algorithm has been used.

wind speed (m/s) 6 7 8 9 10 11 12 >12

= Q_gsc 0 P_total_loss (MW) 0.1703 0.1766 0.1935 0.2097 0.2195 0.2257 0.2405 0.2714

Q_STATCOM = 0 = Q_s 0 P_total_loss P_total_loss (MW) (MW) 0.1494 0.1615 0.1558 0.1683 0.1728 0.1857 0.1892 0.2027 0.1991 0.2129 0.2056 0.219 0.2228 0.235 0.3038 0.2965

Table 6- 2. Power loss when the local load is 5 Mvar and GSC is 2.08 MVA

The reason for choosing two values for grid side converter is to analyze the impact of converter ratings on the power loss of the total system. The power converter of DFIG is only required to handle rotor power and the excitation of generator. In this case the DFIG is varied within ±30% slip, so for 10MVA (9 MW) wind farm 3MVA rating for both rotor and grid side converter will
57   

suffice [16]. The active current has the priority of passing through GSC to stabilize the DC-link voltage, while the priority of flow through the rotor side converter is given to the reactive current which is required to magnetize the generator. As power production and therefore magnetizing requirement increases as wind speed increases, the capacity of RSC can restrict the power flow and affect the MPPT [38]. The rating of RSC is kept at 3 MVA to ensure that the power flow is not restricted. Smaller rating (2.08 MVA) is considered for GSC to study its impact on the total loss.

wind speed (m/s) 6 7 8 9 10 11 12 >12

Q_s Q_gsc Q_statcom (Mvar) (Mvar) P_loss_s (Mvar) P_loss_gsc (MW) (MW) 1.8752 0.0688 2.0154 0.0223 1.1094 1.8874 0.0754 2.0083 0.0222 1.1043 1.9097 0.0929 1.9999 0.0221 1.0905 1.9239 0.1097 1.9996 0.0221 1.0765 1.9313 0.1198 1.9976 0.022 1.0712 1.9502 0.1246 1.9108 0.0215 1.139 1.9961 0.1373 1.6989 0.0202 1.3049 2.2954 0.1671 0.1131 0.0143 2.5916

P_loss_stat (MW) 0.0519 0.0517 0.0514 0.0512 0.0511 0.0526 0.0563 0.0872

P_loss_T (MW) 0.143 0.1494 0.1666 0.1831 0.1931 0.1988 0.2139 0.2686

Table 6- 3. Minimum power loss when the local load is 5 Mvar and GSC is 2.08 MVA

wind speed (m/s) 6 7 8 9 10 11 12 >12

Q_s Q_gsc Q_statcom (Mvar) P_loss_s (Mvar) P_loss_gsc (Mvar) (MW) (MW) 1.6833 0.066 2.9556 0.0348 0.3611 1.699 0.0727 2.9507 0.0347 0.3502 1.7261 0.0906 2.945 0.0347 0.3289 1.7429 0.1076 2.9448 0.0346 0.3123 1.7512 0.1178 2.9435 0.0347 0.3053 1.7651 0.1226 2.8853 0.0342 0.3496 1.7978 0.1351 2.7495 0.0332 0.4527 1.917 0.1607 2.1648 0.0291 0.9182

P_loss_stat (MW) 0.0356 0.0353 0.0349 0.0345 0.0344 0.0353 0.0375 0.0476

P_loss_T (MW) 0.1364 0.1429 0.1603 0.177 0.1871 0.1922 0.2059 0.2375

Table 6- 4. Minimum power loss when the local load is 5 Mvar and GSC is 3 MVA

58   

In tables 6-3 to 6-8, the first column indicates the wind speed in (m/s) and the operation mode of DFIG is based on this value. For wind speed below 6 m/s, the output power is too low to be considered for energy production (refer to section 2.2), for wind speed in the range of 6 to 9 m/s, DFIG operates in sub-synchronous mode. For wind speed above 10 m/s, wind turbine is considered to be in super-synchronous mode. If the wind speed reaches 13 m/s or above this value (up to 25 m/s), the pitch angle control will be in effect and rated active power (in this case 9 MW) will flow from DFIG wind farm. The second column indicates the minimum reactive power that should be provided by the stator of DFIG in order to minimize the loss. RSC is in charge of controlling this reactive power generation. The third column shows the power loss of the DFIG. Optimum reactive power generated by GSC is given in the fourth column. The fifth column shows the power loss of GSC. The sixth column shows the optimum reactive power generation of STATCOM. The seventh column shows the power loss of STATCOM. Finally, the last column gives the minimum values of total power loss of the system while satisfying all the equality and inequality constraints.

wind speed (m/s) 6 7 8 9 10 11 12 >12

Q_gsc Q_statcom Q_s (Mvar) (Mvar) P_loss_s (Mvar) P_loss_gsc (MW) (MW) 2.0547 0.0729 2.0154 0.0223 1.9298 1.9963 0.0779 2.0083 0.0222 1.9954 2.0005 0.0951 1.9999 0.0221 1.9996 2.0006 0.1151 1.9996 0.0221 1.9998 2.0019 0.1214 1.9976 0.022 2.0005 2.051 0.1269 1.9108 0.0215 2.0382 2.1611 0.1412 1.6989 0.0201 2.14 2.4734 0.171 0.1131 0.0142 3.4135

P_loss_stat (MW) 0.0709 0.0725 0.0726 0.0726 0.0727 0.0735 0.076 0.1071

P_loss_T (MW) 0.1662 0.1727 0.1899 0.2063 0.2163 0.2221 0.2375 0.2947

Table 6- 5. Minimum power loss when the local load is 6 Mvar and GSC is 2.08 MVA

59   

wind speed (m/s) 6 7 8 9 10 11 12 >12

Q_s Q_gsc Q_statcom (Mvar) P_loss_s (Mvar) P_loss_gsc (Mvar) (MW) (MW) 1.8618 0.0698 2.9556 0.0348 1.1826 1.8765 0.0766 2.9507 0.0347 1.1728 1.9025 0.0944 2.945 0.0347 1.1524 1.9191 0.1115 2.9448 0.0346 1.1361 1.9274 0.1217 2.9435 0.0346 1.1292 1.9413 0.1264 2.8853 0.0342 1.1734 1.974 0.1389 2.7495 0.0332 1.2764 2.0936 0.1647 2.1648 0.0291 1.7416

P_loss_stat (MW) 0.0535 0.0533 0.0528 0.0525 0.0523 0.0533 0.0556 0.0664

P_loss_T (MW) 0.1582 0.1647 0.1821 0.1987 0.2088 0.2141 0.2279 0.2604

Table 6- 6. Minimum power loss when the local load is 6 Mvar and GSC is 3 MVA

The general trend of loss function is that the loss of the system increases as the local load increases which is logical since more active and reactive current, flow in the stator and rotor of DFIG as well as more reactive power goes through the converters of the STATCOM which increase the losses. Also, as wind speed increase more power loss occurs in the DFIG wind turbine since current increases. It can be seen from the tables that GSC reactive power generation is close to its rated capacity. This can be justified by noticing that the converter loss of GSC is less than copper loss of the generator and converter loss of the STATCOM. Therefore, GSC has the least impact on the total power loss of the whole system. STATCOM reactive power production has the most impact on the power loss. By having two large power converters, the converter loss increases dramatically in the STATCOM. Since STATCOM only produces reactive power, the loss of the STATCOM is linearly related to its reactive current. Although the copper loss of the DFIG can be higher than the converter loss of the STATCOM, but this loss is related to both active and reactive current. In order words, copper loss changes slower as the reactive current changes in DFIG than the rate of converter loss changes due to the change of reactive current of STATCOM. Due to this fact, STATCOM has a higher impact on the total loss of the system. The only exception is that near the rated active power, copper loss increases at a higher rate than converter loss of the STATCOM when enough GSC capacity is not available. Since the wind turbine output power is 1 p.u. at 13 m/s and above wind speed (figure (2-3)), GSC has no longer have the capacity for reactive power production (in the case of 2.08 MVA rating) and copper loss of the DFIG becomes very high. For this reason STATCOM must
60   

provide the rest of the reactive power in order to meet equality constraint. In this condition, the total loss of the system increases dramatically.

wind speed (m/s) 6 7 8 9 10 11 12 >12

Q_s Q_gsc Q_statcom (Mvar) P_loss_s (Mvar) P_loss_gsc (Mvar) (MW) (MW) 2.2346 0.0743 2.0154 0.0223 2.75 2.2453 0.0839 2.0083 0.0222 2.7465 2.2657 0.1015 1.9999 0.0221 2.7345 2.2791 0.1182 1.9996 0.0221 2.7213 2.2862 0.1283 1.9976 0.0221 2.7162 2.3052 0.1332 1.9108 0.0215 2.784 2.3512 0.146 1.6989 0.0202 2.9498 2.6516 0.1766 0.1131 0.0143 4.2353

P_loss_stat (MW) 0.0912 0.0911 0.0908 0.0905 0.0904 0.0921 0.0964 0.1312

P_loss_T (MW) 0.191 0.1974 0.2145 0.231 0.2409 0.2469 0.2626 0.3222

Table 6- 7. Minimum power loss when the local load is 7 Mvar and GSC is 2.08 MVA

wind speed (m/s) 6 7 8 9 10 11 12 >12

Q_s Q_gsc Q_statcom (Mvar) P_loss_s (Mvar) P_loss_gsc (Mvar) (MW) (MW) 2.0407 0.0741 2.9556 0.0348 2.0037 2.0544 0.0807 2.9507 0.0347 1.9949 2.0794 0.0985 2.945 0.0347 1.9756 2.0956 0.1156 2.9448 0.0347 1.9596 2.1038 0.1258 2.9435 0.0346 1.9528 2.011 0.128 2.8853 0.0343 2.1037 2.1505 0.1431 2.7495 0.0332 2.0999 2.2704 0.1691 2.1648 0.0291 2.5648

P_loss_stat (MW) 0.0727 0.0725 0.0721 0.0716 0.0715 0.0751 0.075 0.0866

P_loss_T (MW) 0.1816 0.1881 0.2054 0.222 0.2321 0.2375 0.2514 0.2848

Table 6- 8. Minimum power loss when the local load is 7 Mvar and GSC is 3 MVA

The values given in the tables (6-3 to 6-8) can be used as the set points for TSOs, in order to optimize reactive power flow in the system. As mentioned before voltage drop at the PCC is not considered in this case study. Capacitor bank, STATCOM or other types of reactive power compensators or voltage regulators can be used to improve the voltage at PCC.

61   

By analysing the tables for same local load but different GSC rating, it becomes apparent that increasing the rating of the GSC results in lower power loss. Therefore, 3MVA GSC is preferred over 2.08 MVA GSC in this case study. The remaining capacity of GSC after regulation of DC link and flow of rotor active power can be used to provide reactive power to the grid. If the local load requires small amount of reactive power, e.g. less than 5 Mvar, the existence of STATCOM is no longer necessary.

6.6 Conclusions
In this chapter, coordination of DFIG-based wind turbine and STATCOM is discussed in steadystate condition. Reactive power demand of a local load was supplied from three sources: stator of DFIG, GSC of DFIG and STATCOM. The objective of this part of the thesis was to optimize the reactive power flow from these suppliers by minimizing the loss of the whole system. Matlab optimization toolbox was used in this study and a program which calculates the total loss of the system was proposed. The results of optimum reactive power flow of each source were tabulated and minimum power loss of the system under different wind and load conditions were given. Also, from the results it became apparent that investing in a larger capacity grid side converter is more efficient in terms of minimizing power loss of the system, than utilizing STATCOM.

62   

CHAPTER 7. CONCLUSION   7.1 Conclusions
Utilizing renewable energy sources such as wind and solar powers have been an important research topic for the recent years. With depletion of conventional energy sources such as oil and gas, finding alternative energy sources became inevitable. Wind energy power has gained unprecedented popularity in the past few years. Doubly-fed induction generator based wind turbines are the industry leaders for variable speed wind energy systems. Due to increased penetration of wind turbines in power system, stringent grid codes are placed. Low- voltage ride through is one of the grid codes which ensures wind turbines remain connected to the grid for certain fault time after the fault is cleared. Disconnecting large wind turbines will cause severe voltage instability and in weak grids may lead to voltage collapse in the whole power system. Due to small rating of power converters of DFIG, crowbar protection is usually used to bypass the over-voltage and over-current. As the RSC is switched off during certain crowbar activation scheme, DFIG starts to act as the conventional induction generator absorbing reactive power. Placing reactive power compensators such as STATCOM near the wind farm will ensure that enough reactive power is fed into the system and this will improve the LVRT capability of the DFIG based wind farm. In this thesis, a power distribution system with connected DFIG wind farm is studied based on Matlab Simulink model and the behaviour of the system during fault condition is simulated for different crowbar deactivation schemes. In the first case, crowbar is deactivated and RSC is reenabled after the fault is cleared. In the second case, crowbar is deactivated before fault clearance, while the RSC is re-enabled afterwards. In the last case, crowbar is deactivated and RSC is re-enabled before fault clearance. The results of simulating these cases with and without the existence of STATCOM in the system were given and analysed. Utilizing STATCOM was compulsory in the first two cases. Without the STATCOM, voltage collapse occurred in the weak grid condition and LVRT grid code can not be satisfied as the wind turbines had to be disconnected from the grid.

63   

Calculation of the minimum STATCOM rating is also proposed in this thesis. The proposed method is based on short-circuit calculation which can be easily performed. The costeffectiveness of STATCOM rating minimization is the main motivation. Guessing an initial capacity for the STATCOM (zero can also be considered as the initial capacity), changes in the length of the transmission line and/or changes in the short-circuit level of the grid were the main variable in calculating the required reactive power after fault clearance and choosing the proper rating for the STATCOM. Coordination of STATCOM and DFIG is studied based on power loss minimization of the system in steady-state. Optimum reactive power flow from three sources of generator's stator, GSC and STATCOM which provide reactive power for a local load is calculated using a proposed program written in Matlab. Minimizing power loss of the system is the objective of this program. Matlab optimization toolbox was utilized to address the optimization problem. Two ratings were considered for GSC and since it has the smallest impact on the system loss, utilizing a large rating (30% of the total DFIG rating) of GSC was observed to be more beneficial than utilizing STATCOM in the system. Although reactive power production of GSC was not considered in the fault analysis section of this thesis, but it can be concluded that if the rating of the GSC is large enough so that it can provide enough reactive power before fault clearance, GSC can replace the STATCOM in the system since the power loss is lower in this case and the existence of the STATCOM is not necessary.

7.2 Major Contributions
The major contributions of this thesis are: 1) Three cases of various deactivation times of crowbar and re-enabling the gate signals to the RSC circuit are studied. The result shows that the wind farm needs a STATCOM (or larger grid side converter) to provide reactive power in weak grid.

64   

2) A practical method to obtain the minimum rating of STATCOM for fast voltage recovery at the PCC after the fault is removed was proposed and tested for different grid conditions. 3) A program that calculates the power loss of the STATCOM and DFIG system was developed and optimization toolbox of the Matlab was utilized to coordinate the operation of STATCOM and DFIG in the steady-state condition.

7.3 Future Work
In this thesis, improving dynamic performance of DFIG wind farm after fault clearance and coordination of STATCOM and DFIG in normal condition were studied. Future work can involve using multi-level STATCOM to reduce the harmonics of the system. Also, more practical sophisticated method may be proposed to address the minimization of STATCOM capacity so that if the PCC voltage is less than 0.5 p.u.; Optimum capacity of STATCOM can still be calculated. Finally, different ratings of GSC were considered in the coordination of STATCOM and DFIG and the impacts of these ratings were considered in the optimization problem. The RSC rating is considered high enough that it did not affect the active power flow through the rotor as well as the magnetizing current of DFIG. Further research can involve studying the impact of different ratings of RSC on the power loss of the system.

65   

APPENDICES
 

Appendix A. Parameters for DFIG-based wind turbine test system
DFIG Parameters: Parameter Nominal power Capacity ( = 6 nos. x 1.5 MW each) Voltage Line frequency No. of Poles Power Factor Inertia Constant Stator Resistance (in per unit) Stator Inductance (in per unit) Rotor Resistance (in per unit) Rotor Inductance (in per unit) Magnetizing Inductance (in per unit) Stator/rotor turn ratio Crowbar Resistance (in per unit) 2.9 0.3 0.2 Values 10 MVA 9 MW 575 V 60 Hz 6 0.9 4.32 0.023 0.18 0.016 0.18

Transmission line parameters: Positive Parameter Resistance Inductance Sequence 0.04 /Km 1.05 mH/Km Zero Sequence 0.12 /Km 3.32 mH/Km 5.01 nF/Km

Capacitance 11.33 nF/Km

66   

Appendix B. Proposed program for coordination of DFIG and STATCOM
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% %%%%%% Equality and inequality constraints function [c, ceq] = p_constraint(Q) wspeed=13; switch wspeed case 6 P_dfig=200000*6; wr=0.7; case 7 P_dfig=320000*6; wr=0.78; case 8 P_dfig=540000*6; wr=0.85; case 9 P_dfig=800000*6; wr=0.93; case 10 P_dfig=975000*6; wr=1.11; case 11 P_dfig=1050000*6; wr=1.15; case 12 P_dfig=1200000*6; wr=1.2; case 13 P_dfig=1500000*6; wr=1.3; otherwise if wspeed>13 P_dfig=1500000*6; wr=1.3; else display ('error') end end Q_load=5e6; MVA=1e7; Rs=0.023;%p.u. for six dfigs Rr=0.0032;%p.u. for six dfigs Ls=3.08;%p.u. Ls=Lls+Lm Lr=3.06;%p.u. Lr=Llr+Lm Lm=2.9;%p.u. Vds=1;%p.u

67   

n_trans3=25e3/575; im_trans2=10; Rm_trans2=93.75;% magnetizing resistance of 2phase transformer (ohms) R1_trans2=4.6875e-4;%resistance of w1 of 2phase transfomer (Ohms) R2_trans2=4.6875e-4;%resistance of w2 of 2phase transfomer (Ohms)

im_trans3=0.49; % magnetizing current of 3phase transformer (A) Rm_trans3=29762;% magnetizing resistance of 3phase transformer (ohms) R1_trans3=2.624e-5;%resistance of w1 of 3phase transfomer (Ohms) R2_trans3=2.624e-5;%resistance of w2 of 3phase transfomer (Ohms) I_rmax=1;%p.u. ws=1;% p.u. Vds=1;%p.u V_base=575; Z_base=(V_base^2)/1e7;% for six DFIGs I_base=(1e7)/(sqrt(3)*V_base); s=(ws-wr)/ws; Ps=P_dfig/(1-s);%(W) P_s=Ps/MVA; %p.u. if s<0 Pr=P_dfig*(-s)/(1-s); else Pr=P_dfig*(s)/(1-s); end P_r=Pr/MVA;%p.u. n_trans3=25e3/575; I_filter_rms=1; %(A) z1=(Vds^2)/(ws*Ls); z3=sqrt((1.5*(Lm/Ls*Vds*I_rmax))^2-(P_s^2)); Q_s_max1=((-1.5*z1)+z3)*1e7; Q_s_min=((-1.5*z1)-z3)*1e7; Q_s_max2= sqrt((MVA^2)-(P_s^2)); Q_s_max=min(Q_s_max1,Q_s_max2);

Q_stat_max=5e6; Q_stat_min=-5e6; c = [Q(1)-Q_s_max; -Q(1)+Q_s_min; Q(2)-MVAR_GSC_max ; -Q(2)+MVAR_GSC_min; Q(3)-Q_stat_max; -Q(3)+Q_stat_min; ]; ceq = [-Q(1)-Q(2)-Q(3)+Q_load ];

68   

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% %%%%%% Total power loss calculation function [P_loss_total]= P_loss_func3(Q) wspeed=13; switch wspeed case 6 P_dfig=200000*6; wr=0.7; case 7 P_dfig=320000*6; wr=0.78; case 8 P_dfig=540000*6; wr=0.85; case 9 P_dfig=800000*6; wr=0.93; case 10 P_dfig=975000*6; wr=1.11; case 11 P_dfig=1050000*6; wr=1.15; case 12 P_dfig=1200000*6; wr=1.2; case 13 P_dfig=1500000*6; wr=1.3; otherwise P_dfig=1500000*6; wr=1.3; if wspeed>13 P_dfig=1500000*6; wr=1.3; else display ('error') end end MVA=1e7; MVA_stat=5e6; Rs=0.023;%p.u. for six dfigs Rr=0.0032;%p.u. for six dfigs Ls=3.08;%p.u. Ls=Lls+Lm Lr=3.06;%p.u. Lr=Llr+Lm Lm=2.9;%p.u. Vds=1;%p.u n_trans3=25e3/575; im_trans2=10;

69   

Rm_trans2=93.75;% magnetizing resistance of 2phase transformer (ohms) R1_trans2=4.6875e-4;%resistance of w1 of 2phase transfomer (Ohms) R2_trans2=4.6875e-4;%resistance of w2 of 2phase transfomer (Ohms) im_trans3=0.49; % magnetizing current of 3phase transformer (A) Rm_trans3=29762;% magnetizing resistance of 3phase transformer (ohms) R1_trans3=2.624e-5;%resistance of w1 of 3phase transfomer (Ohms) R2_trans3=2.624e-5;%resistance of w2 of 3phase transfomer (Ohms) I_rmax=1;%p.u. ws=1;% p.u. Vds=1;%p.u V_base=575; Z_base=(V_base^2)/1e7;% for six DFIGs I_base=(1e7)/(sqrt(3)*V_base); s=(ws-wr)/ws; Ps=P_dfig/(1-s);%(W) P_s=Ps/MVA; %p.u. if s<0 Pr=P_dfig*(-s)/(1-s); else Pr=P_dfig*(s)/(1-s); end P_r=Pr/MVA;%p.u. n_trans3=25e3/575; I_filter_rms=1; %(A)

iqs=Q(1)/MVA; iqg=Q(2)/MVA; iq_st=Q(3)/MVA_stat; %p.u. I_base_stat=MVA_stat/(sqrt(3)*25e3); iq_stat=iq_st*I_base_stat; idr=(-Ls/Lm)*ids; iqr=-((Vds/ws)+(iqs*Ls))/Lm;%p.u. %cupper loss of six dfigs P_cu_dfig_pu=Rs*((ids^2)+(iqs^2))+Rr*((idr^2)+(iqr^2));%p.u. P_cu_dfig=P_cu_dfig_pu*MVA;

%loss of RSC and GSC I_rms_s=(sqrt((ids^2)+(iqs^2)))*I_base; I_rms_r=(sqrt((idr^2)+(iqr^2)))*I_base; I_rms_g=(sqrt((idg^2)+(iqg^2)))*I_base; P_loss_conv_r=6*((6.57*(I_rms_r/20.6))+(0.0051*((I_rms_r/20.6)^2))); %P_loss_conv_g=6*((60*(I_rms_g/6))+(0.0054*((I_rms_g/6)^2))); P_loss_conv_g=6*((9.12*(I_rms_g/6))+(0.0051*((I_rms_g/6)^2)));

70   

%loss of transformer connected to wind farm Pm_trans3=(im_trans3^2)*Rm_trans3; P_loss_trans3=3*(Pm_trans3+ ((I_rms_s+I_rms_g+I_filter_rms)^2)*( R1_trans3+R2_trans3)); %total loss of wind farm P_loss_1= P_cu_dfig +P_loss_conv_r+P_loss_conv_g+P_loss_trans3; %loss of STATCOM Iq_stat=abs(iq_stat)*11.25; loss_stat=(39.24*Iq_stat)+(0.0054*(Iq_stat)^2); P_loss_stat=loss_stat*2; Iq_stat_trans=iq_stat*11.75; Pm_trans2=(im_trans2^2)*Rm_trans2; P_loss_trans2=3*(Pm_trans2+ ((Iq_stat_trans)^2)*( R1_trans2+R2_trans2)); P_loss_2=P_loss_stat+P_loss_trans2; P_loss_total=P_loss_1+P_loss_2;

end Q0 = [0,0,0 ]; % Make a starting guess at the solution options = optimset('Algorithm','active-set'); [x,fval] = fmincon(@P_loss_func3,Q0,[],[],[],[],[],[],@p_constraint,options)

71   

Appendix C. Power system model in Matlab/simulink
Distribution system

                            72   

 

DFIG/ Crowbar model

73   

RSC and GSC control block

74   

REFERENCES
[1] "Global wind statistics 2010",Global wind energy council. Internet: http://www.gwec.net/ fileadmin/documents/Publications /GWEC_PRstats_02-02-2011_final.pdf [May 26, 2011] S. Seman, "Transient performance analysis of wind power induction generators", Doctoral dissertation, Dept. Electrical and Communications Eng., Helsinki Univ. of technology, Espoo, Finland, 2006 D.T. Johnsen; W. Christiansen;, "Optimisation of the fault ride through strategy of a wind farm", master's thesis, Technical University of Denmark (DTU), Lyngby, Denmark, 2006 T. Ackermann. Wind Power in Power Systems. Hoboken, NJ: Wiley, 2005. B. Gong;, "Real time wind turbine simulator", Master dissertation, Dept. Computer and Electrical Eng., Ryerson University, Toronto, Canada, 2007 S. Foster; Lie Xu; B. Fox; , "Coordinated control and operation of DFIG and FSIG based Wind Farms," Power Tech, 2007 IEEE Lausanne , pp.522-527, 1-5 July 2007 A.P. Jayam;,"Application of STATCOM for improved dynamic performance of wind farms in a power grid", master's thesis, Missouri University of science and technology, Missouri, United States, 2008 A.H. Norouzi; A.M. Sharaf; , "Two control schemes to enhance the dynamic performance of the STATCOM and SSSC," Power Delivery, IEEE Transactions on , vol.20, no.1, pp. 435- 442, Jan 2005 Hosseini Mehdi, Shayanfar Heidar Ali, Fotuhi-Firuzabad Mahmud, "Modeling of DSTATCOM in distribution systems load flow", Journal of Zhejiang University science A, pp. 1532-1542 ,Aug 2007 Zhu Wu; Cao Rui-fa; , "Improved low voltage ride-through of wind farm using STATCOM and pitch control," Power Electronics and Motion Control Conference, 2009. IPEMC 2009. IEEE 6th International , pp.2217-2221, 17-20 May 2009 J.F Conroy; R. Watson; , "Low-voltage ride-through of a full converter wind turbine with permanent magnet generator," Renewable Power Generation, IET , vol.1, no.3, pp.182-189, September 2007 R. Mittal; K.S. Sandhu; D.K.Jain;," LVRT of Grid Interfaced Variable Speed Driven PMSG for WECS during Fault", International Journal of Computer and Electrical Engineering, Vol. 1, No. 4, October, 2009

[2]

[3]

[4] [5] [6] [7]

[8]

[9]

[10]

[11]

[12]

75   

[13]

Wang Chengfu; Zhang Li; Liang Jun; Nuiyuanfang; , "A New Method of Reactive power-Voltage Coordinated Control in Wind Farm," Power and Energy Engineering Conference (APPEEC), 2010 Asia-Pacific , pp.1-4, 28-31 March 2010 B. Pokharel; Gao Wenzhong; , "Mitigation of disturbances in DFIG-based wind farm connected to weak distribution system using STATCOM," North American Power Symposium (NAPS) 2010 , pp.1-7, 26-28 Sept. 2010 Wei Qiao; G.K. Venayagamoorthy; R.G. Harley; , "Real-Time Implementation of a STATCOM on a Wind Farm Equipped With Doubly Fed Induction Generators," Industry Applications, IEEE Transactions on , vol.45, no.1, pp.98-107, Jan.-feb. 2009 S. Foster; Lie Xu; B. Fox; , "Behaviour and protection of doubly-fed induction generators during network faults," Power & Energy Society General Meeting, 2009. PES 2009. IEEE , pp.1-8, 26-30 July 2009 M. Jazayeri; M. Fendereski; , "Stabilization of gird connected wind generator during power network disturbances by STATCOM," Universities Power Engineering Conference, 2007. UPEC 2007. 42nd International , pp.1182-1186, 4-6 Sept. 2007 L. Meegahapola; D. Flynn; J. Kennedy; T. Littler; , "Active use of DFIG based wind farms for transient stability improvement during grid disturbances," Power & Energy Society General Meeting, 2009. PES 2009. IEEE , pp.1-8, 26-30 July 2009 W. Qiao; R.G. Harley; , "Grid Connection Requirements and Solutions for DFIG Wind Turbines," Energy 2030 Conference, 2008. ENERGY 2008. IEEE , pp.1-8, 17-18 Nov. 2008 C. Abbey; G. Joos; , "Effect of low voltage ride through (LVRT) characteristic on voltage stability," Power Engineering Society General Meeting, 2005. IEEE, pp. 1901- 1907 Vol. 2, 12-16 June 2005 D. Xiang; L. Ran; P. J. Tavner; and S. Yang;, "Control of a doubly fed induction generator in a wind turbine during grid fault ride-through," IEEE Trans. Energy Conversion, vol. 21, no. 3, pp. 652-662, Sept. 2006. P. Flannery and G. Venkataramanan;, "Evaluation of voltage sag ride-through of a doubly fed induction generator wind turbine with series grid side converter," in Proc. 38th IEEE Power Electronics Specialists Conferences, Orlando, FL, USA, pp. 18391845, 17-21 June 2007, Slootweg, J.G.; Polinder, H.; Kling, W.L.; , "Dynamic modelling of a wind turbine with doubly fed induction generator," Power Engineering Society Summer Meeting, 2001. IEEE , vol.1, pp.644-649, 15-19 July 2001 R. Gagnon; G. Sybille; S. Bernard; D. Paré; S. Casoria; C. Larose;, "Modelling and realtime simulation of a doubly-fed induction generator driven by a wind turbine,"
76 

[14]

[15]

[16]

[17]

[18]

[19]

[20]

[21]

[22]

[23]

[24]

 

International Conference on Power Systems Transients (IPST `05), Montreal, Canada, 19-23 June 2005 [25] D. Amitkumar;, "Modeling of doubly fed induction generators for distribution system power flow analysis", Master dissertation, Dept. Computer and Electrical Eng., Ryerson University, Toronto, Canada, 2011
 M. Saleh; M. Eskander;, "Sub-Synchronous Range of Operation for a Wind

[26] 

Driven Double-Fed Induction Generator," Journal of Power Electronics, Vol. 10, No. 1, January 2010 [27] Liu chun; Kang Yong; Chen Jian; Kevin Lee; Lin Xinchun; Liu Xiaohu; Xu Feidong; , "Simplified Active and Reactive Power Control of Doubly Fed Induction Generator and the Simulation with STATCOM," Applied Power Electronics Conference and Exposition, 2009. APEC 2009. Twenty-Fourth Annual IEEE, pp.1927-1931, 15-19 Feb. 2009 I. Munteanu , A. I. Bratcu, N. Cutululis , E. Ceang, I. Munteanu, A. I. Bratcu, N. A. Cutululis, E. Ceanga. Optimal Control of Wind Energy Systems: Towards a Global Approach. London: Springer, 2008. N. G. Hingorani and L. Gyugyi, Understanding FACTS: Concepts and Technology of Flexible AC Transmission Systems. New York: IEEE Press, 2000. X.-F.Wang, Y.-H. Song, and M. Irving, Modern Power Systems Analysis. New York: Springer, 2008 Willi Christiansen; David T. Johnsen;, "Analysis of requirements in selected Grid Codes", Section of Electric power Engineering, Technical University of Denmark (DTU), 20 Jan. 2006 "Grid Code for High and extra high voltage," EON Netz GmbH. 1 April 2006. Internet: http://www.pvupscale.org/IMG/pdf/D4_2_DE_annex_A3_EON_HV_grid__connection_requirements_ENENARHS2006de.pdf [Oct. 2010] M. Tsili; Ch. Patsiouras; S. Papathanassiou;,"Grid code requirements for large wind farms: a review of technical regulations and available wind turbine technologies", National Technical University of Athens (NTUA) School of Electrical and Computer Engineering, Athens, Greece J. Machowski; J. W. Bialek; James R. Bumby. Power System Dynamic and Stability. Chichester: JohnWiley&Sons Press, 1997. E. W. Kimbark. Power System Stability. New York: Wiley, 1956.

[28]

[29] [30] [31]

[32]

[33]

[34] [35]

77   

[36]

F. Shewarega; I. Erlich; J.L. Rueda;, "Impact of large offshore wind farms on power system transient stability," Power Systems Conference and Exposition, 2009. PSCE 09. IEEE/PES, pp.1-8, 15-18 March 2009 J.C. Das. Power System Analysis: Short-circuit Load Flow and Harmonic. New York: Marcel Dekker, 2002. A.H Kasem; E.F. El-Saadany; H.H. El-Tamaly; M. Wahab; , "Performance enhancement of DFIG-based wind turbines close to the rated operation," Power Symposium, 2008. NAPS 08. 40th North American , pp.1-6, 28-30 Sept. 2008 H. Li; Z. Chen; J.K. Pederson;, "Optimal Power Control Strategy of Maximizing Wind Energy Tracking and Conversion for VSCF Doubly Fed Induction Generator System,"Power Electronics and Motion Control Conference, 2006. IPEMC 2006. CES/IEEE 5th International , vol.3, pp.1-6, 14-16 Aug. 2006 B. Rabelo; W. Hofmann; L. Pinheiro; , "Loss reduction methods for doubly-fed induction generator drives for wind turbines," Power Electronics, Electrical Drives, Automation and Motion, 2006. SPEEDAM 2006. International Symposium on, pp.1217-1222, 23-26 May 2006 "Semikron, SKM800GA176D. Data sheet." Internet: http://www.semikron.com/products/data/cur/assets/SKM800GA176D_22890435.pdf [April 11, 2011] "ABB Hipak, 5SNA 1200G450300. Data sheet." Internet: http://www05.abb.com/global/scot/scot256.nsf/veritydisplay/e507eb705d79900bc125759 f003041ea/$file/5sna%201200g450300_5sya%201401-01mar%2009.pdf [April 11, 2011] A. Petersson; "Analysis, modeling and control of doubly-fed induction generators for wind turbines" , Ph.D. Thesis , Chalmers Univ., Göteborg, Sweden, 2003. Lei Sun; Zengqiang Mi; Yang Yu; Tao Wu; Haifeng Tian; , "Active power and reactive power regulation capacity study of DFIG wind turbine," Sustainable Power Generation and Supply, 2009. SUPERGEN `09. International Conference on, pp.1-6, 6-7 April 2009 O. Anaya-Lara; N. Jenkins; J. Ekanyake ; P. Cartwright; M. Hughes. Wind energy generation: modeling and control. Chichester: Wiley, 2009.

[37] [38]

[39]

[40]

[41]

[42]

[43] [44]

[45]

78   

