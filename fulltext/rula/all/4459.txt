GEOMETRIC WATER-FILLING AND RADIO RESOURCE MANAGEMENT

by Zhiming He Master of Applied Science in Electrical Engineering McMaster University, Hamilton, Canada, 2009

A Dissertation Presented to Ryerson University in partial fulfilment of the requirements for the degree of Doctor of Philosophy in the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2015 c Zhiming He, 2015

Author's Declaration
(AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A DISSERTATION) I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners.

I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

I understand that my dissertation may be made electronically available to the public.

ii

Abstract
GEOMETRIC WATER-FILLING AND RADIO RESOURCE MANAGEMENT c Zhiming He, 2015 Doctor of Philosophy Electrical and Computer Engineering Ryerson University This thesis considers the radio resource management (RRM) of advanced wireless communication systems. With the emerging of more advanced and more complicated systems, such as cognitive radio, nodes with energy harvesting capacities (green communications), and the application of Multiple-Input Multiple-Output (MIMO) technology, RRM problems introduce more difficulties and challenges to optimize system performances. Due to specific structure of communication systems, water-filling (WF) plays an important role in RRM. This thesis introduces the fundamental theory and development of WF algorithm. The proposed Geometric Water-Filling (GWF) is presented and compared with the conventional WF algorithms. It can break through the limitations of the conventional WF to solve the more complicated optimization problems in the advanced wireless communication systems. For the application of the proposed GWF to solve the RRM problems in the advanced MIMO communication systems, cognitive radio communication systems, green communication systems and the "dual problems", which are the sum power minimization problems, of the throughput maximization problems is investigated in this thesis. Efficient algorithms are presented to achieve the optimal resource allocation.

iii

Acknowledgements
The thesis is written under the guidance and with the help of my supervisor, Dr. Lian Zhao, whose valuable advices and extended knowledge help me all along. I learn from her the precious research experience, and how it combines with and applies to wireless communications, especially on RRM. I would like to express my sincere gratitude to my supervisor Dr. Lian Zhao, for her continuous guidance and support. I am also grateful to my friends, teachers and classmates.

My special thanks go to all the members of the examination committee: Dr. Beheshti, Dr. Cai, Dr. Fernando, Dr. Misic, and Dr. Zhao (in the alphabetical order).

Finally, I am indebted to thank all the members of my family, especially my wife and son, for their patience, understanding and continuous support.

iv

Contents

Author's Declaration Abstract Acknowledgements List of Figures List of Tables Notation and Acronyms 1 Introduction 1.1 1.2 1.3 1.4 Multiple Input Multiple Output System . . . . . . . . . . . . . . . . . . . . . . . .

ii iii iv x xi xii 1 1 2 2 3 4 4 5 8 12 14 19 19

Energy Harvesting Technology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Water-Filling Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Organization of Thesis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2 Geometric Water-Filling in RRM 2.1 2.2 2.3 2.4 2.5 2.6 Problem Statement and Water-Filling . . . . . . . . . . . . . . . . . . . . . . . . . . Proposed Geometric Water-Filling Approach . . . . . . . . . . . . . . . . . . . . . . Generalization of Weighted Case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Weighted Water-Filling with Individual Peak Power Constraints . . . . . . . . . . . Weighted Water-Filling with Group Bounded Power Constraints . . . . . . . . . . . Numerical Results and Complexity Analysis . . . . . . . . . . . . . . . . . . . . . . 2.6.1 Numerical Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

v

2.6.2

Complexity Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

24 26 26 29 32 32 33 38 42

3 RRM in Wireless Communications with Energy Harvesting Technology 3.1 3.2 3.3 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Extended GWF for Preparation of EH system . . . . . . . . . . . . . . . . . . . . . Maximizing Throughput in Fading Channel and Algorithm RGWF . . . . . . . . . 3.3.1 3.3.2 3.4 3.5 Problem Statement and Conventional Approach . . . . . . . . . . . . . . . . Recursive Geometric Water-Filling and Its Optimality . . . . . . . . . . . . .

Transmission Completion Time Minimization . . . . . . . . . . . . . . . . . . . . . . Numerical Examples for RRM with Energy Harvesting Transmission . . . . . . . . .

4 Optimal Recursive Power Allocation for Energy Harvesting System with Multiple Antennas 4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.1.1 4.2 4.3 4.4 Our Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47 48 48 49 52 55 55 59 60 62 62 68

System Model and Proposed Problems . . . . . . . . . . . . . . . . . . . . . . . . . RGWFM - Recursive GWF for Multiple Antennas . . . . . . . . . . . . . . . . . .

Transmission Completion Time Minimization . . . . . . . . . . . . . . . . . . . . . . 4.4.1 4.4.2 Discrete Transmission Completion Time Minimization . . . . . . . . . . . . . Continuous Transmission Completion Time Minimization . . . . . . . . . . .

4.5 4.6

Extension to a Hybrid System Coexisting with Grid Power . . . . . . . . . . . . . . Numerical Examples and Computational Complexity . . . . . . . . . . . . . . . . . 4.6.1 4.6.2 Numerical Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Computational Complexity Analysis . . . . . . . . . . . . . . . . . . . . . .

5 Exact Solution of Non-Commutative Composite Water-Fillings for EH and Smart Power Grid Coexisting System with Peak Power Constraints 5.1 5.2 5.3 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Problem Statement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Hybrid Power Allocation Algorithm 1 (HPA1) for Maximum Throughput . . . . . . 5.3.1 5.3.2 Two parts of HPA1(K) and Their Non-Commutativity . . . . . . . . . . . . Optimality of HPA1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . vi 70 71 72 74 75 78

5.4

Numerical Example and Computational Complexity . . . . . . . . . . . . . . . . . . 5.4.1 5.4.2 Numerical Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Computational Complexity Analysis . . . . . . . . . . . . . . . . . . . . . .

81 81 84 86 86 87 89 89 90 93 98

6 Using GWF to Solve A Class of Sum Power Minimization Problems 6.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6.1.1 6.2 Our Work for Sum Power Minimization Problem . . . . . . . . . . . . . . . .

Generalized Water-Filling for Sum Power Problem . . . . . . . . . . . . . . . . . . . 6.2.1 6.2.2 6.2.3 Problem Statement and Conventional Approach . . . . . . . . . . . . . . . . Illustration of the Proposed Generalized Water-Filling Algorithm (P-GWF) . Extend to Weighted Case . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6.3

Solving Generalized RRM Problem Using P-GWF . . . . . . . . . . . . . . . . . . . 6.3.1 Weighted Water-Filling with Individual Peak Power Constraints (P-WFPP) for Sum Power Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6.3.2 Weighted Water-Filling with Group Peak Power Constraints (P-WFGPP) for Sum Power Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6.3.3 Weighted Water-Filling with Group Bounded Power Constraints for Sum

98

99

Power Problem (P-WFGBP) . . . . . . . . . . . . . . . . . . . . . . . . . . . 101 6.4 Numerical Results and Complexity Analysis . . . . . . . . . . . . . . . . . . . . . . 104 6.4.1 Complexity Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106 108 110

7 Conclusions Bibliography

vii

List of Figures
2.1 Illustration for the proposed Geometric Water-Filling (GWF) algorithm. (a) Illustration of water level step k  = 3, allocated power for the third step s 3 , and step/stair depth di = 1/ai . (b) Illustration of P2 (k ) (shadowed area, representing the total water/power above step k ) when k = 2. (c) Illustration of P2 (k ) when k = 3. (d) Illustration of the weighted case. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.2 Illustration for Example 1, results for CWF and GWFPP. (a) the CWF: without peak power restriction check (s1 = 3, s2 = 0); (b) the CWF: s1 is clipped considering peak power constraint; (c) GWFPP: s1 = 2, s2 = 1. . . . . . . . . . . . . . . . . . . 2.3 Illustration for Power Allocation using the CWF and the proposed GWFPP for Example 2. (a) Results for the CWF; (b) the CWF, clipped s1 to s4 due to peak power restrictions; (c) Results for GWFPP. . . . . . . . . . . . . . . . . . . . . . . . 2.4 Optimal Power Allocation Results for Example 2. (a) solution from the the CWF; (b) 1st iteration results of GWFPP; (c) 2nd iteration results of GWFPP; (d) 3rd iteration results of GWFPP. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.5 2.6 3.1 3.2 Illustration for Example 3 using GWFPP (s1 = 2, s2 = 1). . . . . . . . . . . . . . . Illustration for Multi-User Power Allocation Results by GWFGBP. . . . . . . . . . 22 23 24 27 21 20 7

Illustration of simple system instance . . . . . . . . . . . . . . . . . . . . . . . . . . Illustration for the proposed Geometric Water-Filling (GWF) algorithm. (a) Illustration of water level step k  = 3, allocated power for the third step s 3 , and step/stair depth di =
1 . ai wi

(b) Illustration of P2 (k ) (shadowed area, representing the total

water/power above step k ) when k = 2. (c) Illustration of P2 (k ) when k = 3. (d) Illustration of the weights as the widths. . . . . . . . . . . . . . . . . . . . . . . . . 30

viii

3.3

Illustration for Algorithm RGWF (Line 6-15 for L = 6), harvested energy having been allocated up to epoch 5; horizontal-wave shadowed areas denote power allocation for
   = 5; (b) n = 5, ke = 4; (c) n = 4, ke = 3; (b) the processing window; (a) n = 6, ke  = 2; . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . n = 3, ke

35

3.4

Procedures to solve Example 1: (a) s1 = 1; (b) s1 = 1, s2 = 1; (c) s1 = 1, s2 = 1, s3 = 1. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43

3.5

Procedures to solve Example 2: (a) s1 = 1; (b) s1 = 0.75, s2 = 1.25; (c) s1 = 11/18, s2 = 20/18, s3 = 23/18. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43

3.6

Procedures to solve Example 3: (a) s1 = 2; (b) s1 = 2, s2 = 2; (c) s1 = 2, s2 = 2, s3 = 1. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

3.7

Procedures to solve Example 4: (a) s1 = 1; (b) s1 = 0.75, s2 = 1.25; (c) s1 = 11/18, s2 = 20/18, s3 = 2399/2523. . . . . . . . . . . . . . . . . . . . . . . . . . . . 46

4.1

3 , Tr(S2 ) = 5 ; (c) Procedures to solve Example 2: (a) Tr(S1 ) = 2; (b) Tr(S1 ) = 2 2 . . Tr(S1 ) = 14 = 1.17, Tr(S2 ) = 26 = , Tr(S2 ) = 26 , Tr(S3 ) = 8 ; (d) Tr(S1 ) = 7 12 12 3 6 12 2 . ) ) = 1.35. . . . . . . . . . . . . . . . . . . . . . . . . . . 2.17, Tr(S3 ) = 2 log (4 · ( 12 19

64 65 66 66 68 82 82 83

4.2 4.3 4.4 4.5 5.1 5.2 5.3 6.1

Weighted sum-rates (Unit: bits) of RGWFMH and PD-IPM, as K=10 and 15 . . . Weighted sum-rates (Unit: bits) of RGWFMH and PD-IPM, as K=10 and 15 . . . Weighted sum-rates (Unit: bits) of RGWFMH and PD-IPM, as K=10 and 15 . . . Weighted sum-rates (Unit: bits) of RGWFMH and PD-IPM, as K=5 . . . . . . . . Weighted sum-rates (Unit: bits) of HPA1 and PD-IPM, as K=10 . . . . . . . . . . Weighted sum-rates (Unit: bits) of RGWFMH and PD-IPM, as 15 . . . . . . . . . . Weighted sum-rates (Unit: bits) of RGWFMH and PD-IPM, as K=20 . . . . . . . . Illustration for the proposed generalized Water-Filling Algorithm for the sum power problems (P-GWF). (a) Water level step k  = 3, allocated power for the third step s 3 , and step/stair depth di = 1/ai . (b) ER(k ) (which is determined by the shadowed area, representing the total water/power, up to, but excluding step k ) when k = 2. (c) ER(k ) when k = 3. (d) The weighted case. . . . . . . . . . . . . . . . . . . . . .

91

6.2

Illustration for Examples 1, 3, 4 respectively.

. . . . . . . . . . . . . . . . . . . . . 104

ix

6.3

Illustration for Example 2, results for the first, second and third iterations respectively. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105

x

List of Tables
4.1 5.1 Comparison of the achieved throughput (Nr = 4) . . . . . . . . . . . . . . . . . . . Comparison of the achieved throughput . . . . . . . . . . . . . . . . . . . . . . . . . 67 83

xi

Notation and Acronyms
Notation:

A (·) C (H, P ) Cn Cm×n det (B ) or |B | E ( ) f H H Hi Hi HiT

Mapping Channel capacity Unitary space with dimension n The set of m × n complex matrices Determinant of the square matrix B Expected value of the random variable  The probability density function of random variable  Channel matrix The conjugate transpose of matrix H The channel matrix of the i-th user The conjugate transpose of matrix Hi The transpose of matrix Hi

xii

Notation (Con't):

Ir log M 0

Identity matirx with demension r Natural logarithm Matrix M being positive semidefinite The trace of matrix M The input vector of the channel or a vector The conjugate transpose of vector x The i-th entry (scalar) or the i-th block of vector x The input vector of the i-th user the i-th entry (scalar) of vector x Floor function Ceiling function

Tr (M ) x x xi xi (x)i

xiii

Acronyms:

KKT WFA IWFA MIMO MAC BC CR EH GWF

Karush-Kuhn-Tucker Water-filling algorithm Iterative water-filling algorithm Multiple input multiple output Multiple access channel Broadcast channel Cognitive radio Energy harvesting Geometric water-filling

xiv

Chapter 1 Introduction
The world is demanding more from wireless communication services now than ever before. Many advanced wireless communication techniques, such as multiple-input multiple-output (MIMO), cognitive radio (CR), and energy harvesting (EH) communications have attracted lots of research attention. For a wireless network operating in a fading environment, power and bandwidth are precious radio resources which need careful planning. Reducing power consumption to satisfy the target QoS requirement leads to enlarged system capacity and prolonged battery life. With the evolution to the more complicated wireless communication systems, the issues of optimal radio resource management problems have become more and more important to achieve overall optimal system design. Water-filling has been an important algorithm for radio resource management (RRM) problem in wireless communication systems. In this thesis, we present a new geometric water-filling (GWF) algorithm, and explore its application in solving RRM problems for the advanced wireless communication systems. In the remaining of this Chapter, we will first review the advances in MIMO, EH communication systems, and water-filling algorithm. In the subsequent chapters, we will further discuss the application of water-filling algorithm to solve RRM problems in these advanced communication systems.

1.1

Multiple Input Multiple Output System

The use of multiple antennas at the transmitter and receiver, i.e., Multiple-Input Multiple-Output (MIMO) technology, constitutes a breakthrough ([5, p. 1]) in the design of wireless communication 1

systems. MIMO technology is now at the core of several existing and emerging wireless standards ([5, p. 18]). Exploiting multipath scattering, MIMO techniques have delivered significant performance enhancements in terms of data transmission rate and interference reduction on point-to-point links. In this thesis, we focus our attention on MIMO systems. Actually, we have also obtained the design of multi-user SIMO systems [18].

1.2

Energy Harvesting Technology

In recent years, energy harvesting in green communications has attracted a lot of research attention due to its environment friendly features. One possible technique to overcome the limitation of battery lifetime is to harvest energy from the environment. In such systems, harvesting energy has become a preferred choice for supporting green communications. However, harvesting energy depends on natural conditions and thus is random over time. It owns causality of power usage, corresponding to the dependence of harvested energy on time. As a result, the energy from this constraint is often considered to regulate the overall energy flow of the system. For convenience, this system is called the EH system in this thesis. The optimal radio resource allocation problem to maximize system throughput turns out to be more complicated. In this thesis, the proposed algorithms can be used for the maximum throughput problems and/or the minimum transmission completion time problems.

1.3

Water-Filling Algorithm

In many engineering problems, water-filling plays an important role in radio resource management. For communications, it stems from a class of the problems of maximizing the mutual information between the input and the output of a channel with parallel independent sub-channels. With waterfilling, more power is allocated to the channels with higher gains to maximize the sum of data rates or the capacity of all the channels. The solution to this class of the problems can be interpreted by a vivid description as pouring limited volume of water into a tank, the bottom of which has the stair levels determined by the inverse of the sub-channel gains. The conventional way to solve the water-filling problem is to solve the Karush-Kuhn-Tucker

2

(KKT) conditions [2], and then find the water-level(s) and the solutions. In Chapter 2 or our paper [19], we proposed a water-filling algorithm from geometric approach (GWF). GWF provides the exact solutions, by a finite amount of computation or the basically arithmetic and logic operation, to the power allocation problem and avoids the complexity to solve the KKT conditions with non-linear equations. Due to complexity of solving the KKT conditions of the problem with multiple variables, the GWF is easier to compute than the conventional water-filling and reveals more useful information. GWF has also been extended to solve more general and more complicated power allocation problems, e.g., the minimum sum power with the throughput and more constraints in the following Chapter 6, or [21].

1.4

Organization of Thesis

In this thesis, GWF is proposed to compute the exact solutions to the maximum throughput problems with more constraints in Chapter 2. For the EH system, the coexisting system of EH with MIMO, and the coexisting system of EH with power grid, new algorithms are proposed to compute the exact solutions to the maximum throughput problems and/or the minimum transmission completion time problems in Chapters 3-5, respectively. A set of novel algorithms to compute the exact solutions to the sum power minimization problems with more constraints are proposed in Chapter 6. Chapter 7 closes this thesis.

3

Chapter 2 Geometric Water-Filling in RRM
In this thesis, we firstly introduce water-filling algorithms to solve power allocation problems. Two water-filling approaches are presented. One is the conventional water-filling (CWF); and the other one is the proposed geometric water-filling (GWF). GWF is further extended to efficiently solve a class of power allocation problems with more complex structure which owns upper bounds of the power variables. Computational complexities are investigated.

2.1

Problem Statement and Water-Filling

The water-filling problem can be abstracted and generalized into the following problem: given P > 0, as the total power or volume of the water; the allocated power and the propagation path gain for the ith channel are given as si and ai respectively, i = 1 . . . K ; and K is the total number of channels. Letting {ai }K i=1 be a sorted sequence, which is positive and monotonically decreasing, find that max{si }K i=1
K i=1

log(1 + ai si ) (2.1)

subject to: 0  si , i;
K i=1

si = P.

Since the constraints are that (i) the allocated power to be nonnegative; (ii) the sum of the power equals P , the problem (2.1) is called the water-filling (problem) with sum power constraint. Note, according to information theory, that si of log(1 + ai si ) in (2.1) is a ratio, i.e., a numerical value without any physical unit, under the assumption that the power of noise is 1. It is seen that this assumption does not lose any generality. Thus, the si is the signal noise ration (SNR), although 4

this value is equal to the numerical value part of the transmitted signal power, under the assumption that the power of noise is 1. Therefore, it does not depend on choice of physical units, such as Watt or mW. To find the solution to problem (2.1), we usually start from the Karush-Kuhn-Tucker (KKT) conditions of the problem, as a group of the optimality conditions, and derive the system (2.2) below from the KKT conditions,   1  si =  - a   i  K i=1 si = P,        0,
+

, for i = 1, . . . , K, (2.2)

where (x)+ = max {0, x}.  is the water level chosen to satisfy the power sum constraints with equality (
K i=1

si = P ). The solution to (2.2) is referred to as a solution of the CWF problem (2.1).

It can be seen that the implied system (2.2) has been used to find the optimal solution. The existence of its Lagrange multipliers and the implication mentioned above determine that enumeration can be utilized to find the water level . In [36], how to solve the problems has been discussed extensively. Complexity of the non-geometric approach to solve the problem (2.1) will be discussed in Section 2.6. In the sequel of the chapter, when water-filling problem is mentioned, the power sum constraint is always included.

2.2

Proposed Geometric Water-Filling Approach

In this chapter, we propose a novel approach to solve problem (2.1) based on geometric view. The proposed Geometric Water-Filling (GWF) approach eliminates the procedure to solve the non-linear system for the water level, and provides explicit solutions and helpful insights to the problem and the solution. Figs. 2.1(a)-(c) give an illustration of the proposed GWF algorithm, by analogy. Suppose there are 4 steps/stairs (K = 4) with unit width inside a water tank. For the conventional approach, the dashed horizontal line, which is the water level , needs to be determined first and then the power allocated for each stair (water volume above the stair) is solved. Let us use di to denote the "step depth" of the ith stair which is the height of the ith step to 5

the bottom of the tank, and is given as 1 , for i = 1, 2, . . . , K. ai

di =

(2.3)

di may take the same unit as si . Since the sequence ai is sorted as monotonically decreasing, the step depth of the stairs indexed as {1, · · · , K } is monotonically increasing. We further define i,j as the "step depth difference" of the ith and the j th stairs, expressed as 1 1 - , for i  j and 1  i, j  K, ai aj

i,j = di - dj =

(2.4)

where 1  i, j  K means that 1  i  K and 1  j  K . Instead of trying to determine the water level , which is a real non-negative number, we aim to determine water level step, which is an integer number from 1 to K , denoted by k  , as the highest step under water. Based on the result of k  , we can write out the solutions for power allocation instantly. Fig. 2.1(a) illustrates the concept of k  . Since the third level is the highest level under water, we have k  = 3. The shaded area denotes the allocated power for the third step by s 3. In the following, we explain how to find the water level step k  without the knowledge of the water level . Let P2 (k ) denote the water volume above step k or zero, whichever is greater. The value of P2 (k ) can be solved by subtracting the volume of the water under step k from the total power P , as
k -1 i=1 + k -1 i=1 k,i +

P2 (k ) =

P-

1 ak

-

1 ai

= P-

, for k = 1, . . . , K.

(2.5)

Due to the definition of P2 (k ) being the power (water volume) above step k , it cannot be a negative number. Therefore we use {·}+ in (2.5) to assign 0 to P2 (k ) if the result inside the bracket is negative. The corresponding geometric meaning is that the k th level is above water. Note a reminder of the definition of a special case for the summation is:
n

bi = 0, as m > n.
i= m

(2.6)

6



1

s 111 000 000 4 111 000 111 0000 1111 1 0 000 111 3 1111 0000 0 1 s 0 1 0 2 1 01 1 0 0 d1 = 0 1 0 1
 3 2 2 1 a2

 111111111111 000000000000 000000000000 111111111111 3 000000000000 111111111111 3 000000000000 111111111111 000000000000 111111111111 000000000000 111111111111 2 000000000000 111111111111 2
1 (b) 4

4

(a)

111111111111 000000000000 000000000000 111111111111 3 0 1 0 1 0 2 1 0 1 0 1 1 0 1 0 1
3,1



4



(c)

1 0 0 1

w1
1

1 0 3 0 1 s /w 0 1 0 1 0 1 2 0 1 0 1 0 d =1 1/a w 0 1 0 1
2 2 2 2

2

(d)

Figure 2.1: Illustration for the proposed Geometric Water-Filling (GWF) algorithm. (a) Illustration of water level step k  = 3, allocated power for the third step s 3 , and step/stair depth di = 1/ai . (b) Illustration of P2 (k ) (shadowed area, representing the total water/power above step k ) when k = 2. (c) Illustration of P2 (k ) when k = 3. (d) Illustration of the weighted case.

Fig. 2.1(b) and Fig. 2.1(c) illustrate the concept of P2 (k ) for k = 2 and k = 3 respectively by the shadowed area. As an example of Fig.2.1(c), the water volume under step 3 can be expressed as the sum of the two terms: (i) the step depth difference between the 3rd and the 1st step, 3,1 , and (ii) the step depth difference between the 3rd and the 2nd step, 3,2 . Thus, P2 (k = 3) can be written as P2 (k = 3) = [P - 3,1 - 3,2 ]+

and the above result is the shadowed area in Fig. 2.1(c), which is also an expansion of the composite form of (2.5). Then, we are ready to have the following proposition: Proposition 2.1. The explicit solution to (2.1) is:    sk  + ( d k  - d i ) si =   0, 1  i  k k < i  K,


(2.7)

7

where the water level step k  is given as k  = max k P2 (k ) > 0, 1  k  K

(2.8)

and the power level for this step is sk  = 1 P2 (k  ). k (2.9)

We can interpret Proposition 2.1 from Fig. 2.1. The first step of the proposed approach is to find the water level step k  . From Fig. 2.1, we can find that k = 3 is the maximal index that makes P2 (k ) greater than zero. Therefore, based on (6.28), k  = 3 can be determined. Then the power at this step sk can be determined based on (6.29). For those steps with index higher than k  , no power is assigned. For those steps with index lower than k  , their power levels are obtained by adding sk with the corresponding level depth difference with the k  th step as shown in (2.7). Proposition 2.1 provides an explicit constructed solution rather than the implicit solution. The procedure eliminates solving the nonlinear equation as shown in (2.2) and the real number water level , through finding the index k  of the highest "step" under the "water". This idea will be used in the followings, too. This point is just the distinct characteristic between CWF and GWF. The proof of the optimality of the solution will be left to the next subsection when we discuss the weighted case.

2.3

Generalization of Weighted Case

For the weighted case, the generalized problem can be stated as: given P > 0, as the total power or volume of the water; the weights, the allocated power and the propagation path gain for the ith antenna are given as wi , si and ai respectively, i = 1, . . . , K ; and K is the total number of the transmit antennas. Furthermore, the weighted coefficients wi > 0, i  {1, . . . , K }, and {ai wi }K i=1 being monotonically decreasing, find that max{si }K i=1
K i=1

wi log(1 + ai si ) (2.10)

subject to: 0  si , i;
K i=1

si = P.

8

Using the proposed geometric approach, we can extend the geometric relation for the weighted case as shown in Fig. 2.1(d) to obtain the corresponding solution to (2.10). By the way, since the power distribution is our major concern in this paper and RRM, the weights are not selected as the optimization variables of the problem (2.10), like the most references on RRM. Also, the other investigated problems follow this rule in this thesis. In Fig. 2.1(d), the width of the ith stair/step is denoted as wi , by analogy. The value of 1/ai denotes the volume under the ith step to the bottom of the tank. Hence, the step depth of the ith step is given as di = 1 , ai wi i = 1, · · · , K. (2.11)

Then, P2 (k ), the water volume above step k , can be obtained using the similar approach as in the previous subsection considering the step depth difference and the width of the stairs as,
k -1 i=1 (dk +

P2 (k ) = P -

- di ) wi

, for k = 1, . . . , K.

(2.12)

As an example in Fig. 2.1(d), the water volume above step 1 and below step 3 with the width w1 can be found as: the step depth difference, (d3 - d1 ) multiplying the width of the step, w1 . Therefore, the corresponding P2 (k = 3) can be expressed as, P2 (k = 3) = [P - (d3 - d1 )w1 - (d3 - d2 )w2 ]+ ,

which is an expansion of (2.12). Then we have the following proposition. Proposition 2.2. The explicit solution to (2.10) is:    si = [ sk + (dk - di )]wi , as 1  i  k  ; wk    si = 0, as k  < i  K, where k  = max k P2 (k ) > 0, 1  k  K (2.14)

(2.13)

9

and the power level for this step is wk 
k i=1

sk  =

wi

P2 (k  ).

(2.15)

Proof of Proposition 2.2. System (2.13) implies that wk  = + sk  ak
1

1 ai

wi , as 1  i  k  . + si

(2.16)

Let =
1 ak

wk  . + sk  

(2.17)

From a geometric view,  is the reciprocal of water level . According to the definitions of k  and sk , for k  < i  K, Let i = Then
1 ak
1 ak 

wk  +s k 

>

wi 1 +s i ai

and si = 0. wk  - + sk   wi . + si

1 ai

(2.18)

   i > 0, if k  < i  K   i = 0, if 1  i  k  .

(2.19)

Therefore, the following system holds:   wi  -  + i = 0, as 1  i  K  1 +s i  ai       s  0, i   i i si = 0,       i  0,       K si = P, i=1 i i   R. (2.20)

By observation, the equation and inequality set above is just a set of the KKT conditions of the problem in Proposition 2.2 and the water level  is equal to the reciprocal of the Lagrange multiplier  mentioned above. Note that the Lagrange function of the problem in Proposition 2.2 is L({si }, , {i }) =
K i=1

wi log (1 + ai si ) - 

K i=1

si - P +

K i=1

i si .

(2.21)

10

Since it is a differentiable convex optimization problem with linear constraints, not only are the KKT conditions mentioned above sufficient, but they are also necessary for optimality. Note that the constraint qualification of the problem (2.10) holds. Proposition 2.2 hence is proved. Similar to the unweighted case, the first step is to calculate P2 (k ), then find the water level step, k  , from (2.14), which is the maximal index making P2 (k ) nonnegative. The corresponding power level for this step, sk , can be obtained by applying (2.15). Then for those steps with index higher than k  , the power level is assigned with zero. For those steps below k  , the power level is assigned as in (2.13). The first term (sk /wk ) inside the square bracket denotes the depth of the k  th step to the surface of the water. The second term inside the square bracket denotes the step depth difference of the k  th step and the ith step. Therefore, the sum inside the square bracket means the depth of the ith step to the surface of the water. When this quantity is multiplied with the width of this step, the volume of the water above this step (allocated power) can be then readily obtained. With the proposed GWF approach, the weighted problem could be solved straightforwardly, avoiding complicated derivation and calculation. When the weighting factors are set to ones, the corresponding unweighed case is obtained. In the following description of algorithm implementation and proof, we only provide weighted case. From Proposition 2.2, when k  is obtained, P2 (k  ) is given. Then it is memorized and only multiplied by a constant to compute sk . Thus, searching k  is a key point for the proposed GWF and the procedure is stated as follows: 1) Initialize Ws = 0; PM = P  = P ; i = 1. 2) Compute Ws  Ws + wi ; P   P  - (di+1 - di )Ws . Then i  i + 1, where the symbol "" represents the assignment operation. 3) If P  > 0 and i  K, PM = P  , and repeat the step 2); else, output k  = i - 1, Ws = Ws - wi and sk =
wk  P . Ws M sk  wk 

We can observe that

+ dk is the water level due to

sk  wk 

+ dk  =

si wi

+ di , for 1  i  k  in (2.13).

As an alternative to the enumeration search in the Algorithm GWF, a Fibonacci-like search is possibly used to speed up finding k  due to (non-increasing) monotonicity of the sequence {P2 (k )}.

11

Without loss of generality, let Fibonacci approximation ratios be method can be described as: 1st Step. 2nd Step. Assume that a = 1 and b = K . If a = b, then k  = a and go to Step 3 of GWF.

1 3

and

2 3

for searching k  . The

(b - a) , b1 = a + 2 (b - a) . Else, a1 = a + 1 3 3 3rd Step. If P2 (a1 )  0, then b = a1 - 1 and go to the 2nd Step;

If P2 (b1 ) > 0, then a = b1 and go to the 2nd Step; If P2 (a1 ) > 0 and P2 (b1 )  0, then a = a1 , b = b1 - 1 and go to the 2nd Step. The number of loops to search k  is reduced into a complexity level of log3 (K ).

2.4

Weighted Water-Filling with Individual Peak Power Constraints

In this section, we extend the CWF problem to include individual peak power constraints (WFPP). The weighted WFPP problem is stated as follows. Given P > 0, as the total power or volume of the water; the allocated power and the propagation path gain for the ith antenna are given as si and ai respectively, i = 1, . . . , K ; and K is the total number of the transmit antennas. Also, the weights wi > 0, i, and without loss of generality, {ai · wi }K i=1 being positive and monotonically decreasing, find that max{si }K i=1
K i=1

wi log(1 + ai si ) (2.22)

subject to: 0  si  Pi , i;
K i=1

si  P.

Comparing the problem (2.22) with (2.10), the constraint of 0  si is extended to 0  si  Pi , i.e., additional individual peak power constraints, and
K i=1

si = P to

K i=1

si  P . The problem

(2.22) is thus referred to as (weighted) water-filling with sum and individual peak power constraints (WFPP). In this section, we discuss the solution to the WFPP problem. By the way, the discussed problem above is of multi-user cases. According to the multi-user information theory, the optimal capacity point set determined by the optimal power allocation is located at the boundary of the 12

capacity region that is a polygon. Therefore, any optimal capacity point can be found by setting up a group of weights of the target problem, like our (2.22). The detail can refer to [5] and its references therein. As a simple explanation, a group of weights plays a role of adjusting priority of channels to obtain the optimal power allocation. Proposition 2.2 in section 2.3 provides an explicit solution using geometric view approach. Interestingly, the proposed GWF can be applied to the WFPP problem with some modifications. The following presents an algorithm which is a modification of the above discussed GWF and it is termed as the GWFPP. For convenience, the expression (2.12) can further be extended into the expression:
|E |-1 t=1 (dik +

P2 (ik ) = P -

- d it ) w it

, for k = 1, . . . , |E |,

(2.23)

where E is a subsequence of the sequence {1, 2, . . . , K }, |E | is the cardinality of the set E , so E can be expressed as {i1 , i2 , . . . , i|E | }. Especially, if E is taken as the sequence {1, 2, . . . , K }, then the extended expression is regressed into the original expression (2.12). Similarly, some corresponding changes in (2.13)-(2.15) are also done (i.e., the subscripts of sequence are replaced with those of the subsequence). For avoiding tediousness, these extended expressions are still labelled as (2.13)-(2.15) in the following statement of Algorithm GWFPP. Algorithm GWFPP: Input: vector {di }, {wi }, {Pi } for i = 1, 2, . . . , K , the set E = {1, 2, . . . , K }, and P . 1) Utilize (2.13)-(2.15) to compute {si }. 2) The set  is defined by the set {i|si > Pi , i  E }. If  is the empty set, output {si }K i=1 ; else, si = Pi , as i  . 3) Update E with E \  and P with P -
t

Pt . Then return to 1) of the GWFPP.

Remark 1. Algorithm GWFPP is a dynamic power distribution process. The state of this process is the difference between the individual peak power sequence and the current power distribution sequence obtained by the Algorithm GWF. The control of this process is to use (2.13)-(2.15) of the Algorithm GWF based on the state mentioned above. Thus, a new state for next time stage 13

appears. Therefore, an optimal dynamic power distribution process, the GWFPP, with the state feedback is formed. Since the finite set E is getting smaller and smaller until the set  is empty, Algorithm GWFPP carries out K loops to compute the optimal solution, at most. Similar to the proof of the Proposition 2.2, we can obtain the following conclusion: Proposition 2.3: Algorithm GWFPP can provide the optimal solution to the problem (2.22). Proof of Proposition 2.3. If the final set E in Algorithm GWFPP is empty, it implies that
K i=1

Pi  P . Then it is seen that the optimal solution si = Pi holds, for any i.

If it is non-empty, observing the stricture of (2.22), Proposition 2.3 is easily proved, similarly to the previous one.

2.5

Weighted Water-Filling with Group Bounded Power Constraints

The weighted WFGBP problem is stated as follows. Considering a cognitive network, given P  0, as the total power of the CRs or volume of the water; the allocated power, the propagation path gain and the weight for the ith CR are given as sk , ak and wk ( 0) respectively, k = 1, . . . , K , where K is the total number of the CRs; and let {i }T i=1 be a partition of the index set: {1, . . . , K }. For convenience, the elements of i can be listed, monotonically increasing, i.e., i1 < i2 < . . . < i(i ) . P i and P i , under the assumption of 0  P i  P i , denote the lower bound and the upper bound of the power constraints for the ith group of the CRs, i. The generalized weighted water-filling problem with group bounded power constraints under consideration then reads max{sk }K k=1
K k =1 wk

log(1 + ak sk ) (2.24) sk  P i , i = 1, . . . , T.

subject to: 0  sk , k ;
K k =1 sk

 P;
k i

Pi 

Compared the problem (2.24) with (2.22), the constraints of 0  si  Pi , i, are generalized to Pi 
k i

sk  P k , i.e., additional group bounded power constraints, the lower bounds of which

can be used to guarantee the fair transmitted rate from the ith group of CRs, whereas the upper bounds of which can be used to limit interference of the group with the primary users, for any i. 14

That is to say, adjusting the just mentioned lower bounds can make the rate more fair, due to the relationship between the power and the rate; and adjusting the just mentioned upper bounds can more reasonably control the interference from SUs, also due to the same cause. The problem (2.24) is thus referred to as (weighted) water-filling with group bounded power constraints (WFGBP). In this subsection, we discuss the solution to the WFGBP problem. Due to the explicit solution using geometric view approach that is provided in Proposition 2.2, interestingly, the proposed GWF can be applied to the WFGBP problem with some modifications. The following presents an extended algorithm, which is a meaningful modification of the GWF and is termed as the GWFGBP. Note, as P  whereas, as
T i=1 T i=1

P i , it is seen that there does not exist any solution to problem (2.24);

P i  P , problem (2.24) is regressed into a trivial case without the sum power
T i=1

constraint. Hence,

Pi  P 

T i=1

P i is assumed.

If P i = 0, P i >> 0, i, and the weights are equal, then problem (2.24) is reduced into the regular case that can be solved by the conventional weighted water-filling problem [44]; and if i is regressed a singleton and P i = 0, i, then problem (2.24) is reduced into the WFPP problem. Thus, (2.24) is a more general form of the RRA problem. To find the solution to (2.24), the generalized geometric water-filling algorithm for the group bounded power constraints (GWFGBP) is presented as follows: Firstly, for integrity of this new algorithm, let us re-visit the four concepts: (i) power (water volume) above level k , P2 (k ); (ii) power allocated to the ith group tth channel, sit ; (iii) water level step k  ; and (vi) power allocated for the water level step sik as below:  P2 (k ) = P -
E -1 t=1

+ 1 1 - aik wik ait wit w it  , for k = 1, . . . , E , (2.25)

where E is a subsequence of the sequence {1, 2, . . . , K }, E is the cardinality of the set E , so E can be written as {i1 , i2 , . . . , iE }. Note that k in P2 (k ) is a subscript of the subsequence {it }E t=1 under the assumption: 1  i1 < i2 < . . . < iE  K in the given set E , and the sequence {1, 2, . . . , K } is a subsequence of itself under the definition of subsequence.

15

Also, note s it =

   wi t   0,

sik wik

+

1 aik wik

-

1 ait wit

,

1  t  k k <tE ,


(2.26)

where the water level step k  is given as k  = max k P2 (k ) > 0, 1  k  E

(2.27)

and the power level for this step is s ik  = 1 P2 (k  ).  k (2.28)

If water-filling is vividly described as pouring the water of volume P into a tank with the bottom of E stairs, then P2 (k ) is the water volume above the k th stair. Along this analogue understanding, we can interpret the geometric meaning of these four concepts under the simple assumptions of E = {1, 2, . . . , K }, similarly mentioned above. Using these four concepts, the steps of GWFGBP can be described as below. Algorithm GWFGBP:
K Input: the channel gains {ak }K k =1 , the weights {wk }k =1 , the group lower and upper power T bounds {P i , P i }T i=1 , the index set E = (E0 =){1, 2, . . . , K }, the partition {i }i=1 , the sum power

constraint P and i = 1. 1) Initialize Wis = 0; PM = P  = P i ; j = 1. 2) Update Wis with Wis + wij and P  with P  - (dij+1 - dij )Wis . Then increase the iteration index j to j + 1, where the used symbols are referred in Proposition 2.2. 3) If P  > 0 and j  (i ) , PM = P  , and repeat the step 2); else, output k  = j - 1, s ik  =
wik Wis

PM , increase the iteration index i to i + 1 , and then repeat the step 1), until
1 ak

i = T . Thus, {sk }K k =1 is obtained. Let E be updated with {1, . . . , K }, Pt with P and
1 ak

with

+ sk , k . Finally in this step, let n = 1 and  = , where  stands for the empty set.

4) Then utilize (2.25)-(2.28) to compute {si }, which appear in the left hand-side (LHS) of (2.26). Successively, assign sk with sk , k .

16

5) The set n is defined by the set {i|

j i

sj > P i - P i , 1  i  T }. If n is the empty
j i

set, output the solution {sk + sk }K k =1 to the problem (2.24); else, let

sj = P i - P i ,

as i  n . Further, continuously utilize similar expressions to (2.25)-(2.28), these similar expressions only changing from Pt to P i - P i and from E to i for any i  n , and then obtain sj , j  in i . Let  =   n .
in (P i - P i ).

6) Update E with E \ (in i ); Pt with Pt - n to n + 1, and return to 4) of GWFGBP.

Then increase the iteration index

Remark 2. GWFGBP is also a dynamic power distribution process. The state of this process is the difference between the group bounded power sequence and current power distribution sequence obtained by (2.25)-(2.28). The control of this process is to use the mentioned similar expressions to (2.25)-(2.28) based on the state mentioned above. Thus, a new state for next time stage appears. Therefore, an optimal dynamic power distribution process, GWFGBP, with the state feedback is formed. Since the finite set E is getting smaller and smaller until there exists n such that the set n is empty, GWFGBP carries out T loops to compute the optimal solution, at most. For optimality of the proposed GWFGBP, we can obtain the following conclusion: Proposition 2.4: Algorithm GWFGBP can provide the optimal solution to the problem (2.24) via finite computation. Proof of Proposition 2.4. Without loss of generality, assume that the final set  in GWFGBP is empty. It is seen that the optimal solutions { sj }j i hold, for any i, with only requiring to satisfy
j i

sj  P i - P i and also satisfy the total sum power constraint for { sk }. Thus, appending

all the groups of the solutions from GWFGBP, we can obtain the solution to the problem (2.24) and its optimality is proven as follows. The final set E , as a non-empty set, implies that 1 + sk  = + skw 
k

1 ak wk

1 aj wj

1  sj + sj , as {j, k }  E, + wj
j i

(2.29)

and there exists i such that

j i

sj > 0. Thus, under 1 + sk  + skw 
k

sj > 0, let

=

1 ak wk

(2.30)

17

and then j = 0 as j  E and

sj > 0 and j  i . Further, according to the definitions of k  and sk , for 1 + sk  > + skw k 1 + sk  - + skw k 1 s + s + j wj j 1 s + s > 0 + j wj j sj = 0, then let  0,

sj = 0, since
1 ak wk 1 aj wj

(2.31)

holds, then let j =
1 ak wk 1 aj wj

(2.32)

and  i =  i = 0, as i  E . If the set i implies i =  -

j i

1
1 ak (i ) wk (i )
i

+

sk (i ) wk (i )

(2.33)

and  i = 0. Also, if sj > 0, let j = 0; if sj = 0, let j =  -  i - aj wj  0, keeping the mentioned values of  i and  i . On the other hand, if i   and j  i , then sj = P i - P i ,
j i

0 < i =

(2.34) -   0, (2.35)

1
1 ak (i ) wk (i )

+

sk (i ) + sk (i ) wk (i )

let  i = 0 and j = 0, as

sj > 0. If

sj = 0, then 1 +

j =  +  i -

1 aj wj

sj wj

>0

(2.36)

and  i = 0.
K Therefore, there have been the Lagrange multipliers , {i ,  i }T i=1 and {k }k =1 obtained above,

the Lagrange function of which, for the problem (2.24), is: L({sk }, , {i }, {i }, {k }) = -
K k =1 wk T i=1

log (1 + ak sk ) - 
j i

K k =1 T i=1

sk - P
j i

(2.37) sj - P i ) +
K k =1

i(

sj - P i ) +

i(

 k sk .

Further, by observation, they satisfy the KKT conditions. Since the problem (2.24) is a differentiable convex optimization problem with linear constraints, not only are the KKT conditions mentioned

18

above sufficient, but they are also necessary for optimality. Note that it is easily seen that the constraint qualification of the problem (2.24) holds. Proposition 2.4 hence is proved. Remark 3. If we chose the CWF to solve the problem (2.24), similarly, a non-linear system with non-linear equations and inequalities in multiple dual variables would have had to be solved:  + wj  T 1  = P, as j  i , i = 1, 2, . . . , T ;  i=1 j i +i -i - ai    +  wj  1  P  -  P i , as i = 1, 2, . . . , T ;  i j    +  -  a i  i i i  + wj 1 ( - - P i ) = 0, as i = 1, 2, . . . , T ;  i j    +  -  a i i i  i   +  w 1    i ( j i +ij- - a - P i ) = 0, as i = 1, 2, . . . , T ;  i i        0;   0, i  0, as i = 1, 2, . . . , T. i There seems no existing result that can solve this system. As a note, the proposed algorithms in this section can output the unique optimal solution to each of the corresponding problems, since the objective function of each of the problems has a negative definite Hessian matrix.

(2.38)

2.6
2.6.1

Numerical Results and Complexity Analysis
Numerical Results

As an illustration for the proposed algorithm, some numerical examples are provided in this subsection. To clearly account for procedures of the proposed algorithms, the simple and easily checked parameters are used. This way can make readers grasp essence of procedures in the proposed algorithms without being tangled with tedious numerical computation. It stems from loose assumption by our approach. Example 1. Instance a case of the water-filling with individual peak power constraints (WFPP) problem: max{si }2 i=1
2 i=1

log(1 + ai si ) (2.39)

subject to: 0  si  2, i;
2 i=1

si  3 .

where a1 = 1 and a2 = 0.2. The problem given is a WFPP problem. Utilizing the proposed GWFPP, the result of the first loop is s1 = 2, as part of the solution based on the algorithm. The 19

remaining of the solution, s2 , is allocated with zero. The result of the second loop is s1 = 2 and s2 = 1, as full entries of the solution. According to Proposition 2.3, the result of the second loop is guaranteed to be the optimal solution. For comparison purpose, the solution to the CWF is also plotted in Fig. 2.2. In Fig. 2.2, the step depth for channel 1 and channel 2 are 1 and 5 respectively, as the reciprocal of their respective channel gains. Using the CWF, the solution is shown in Fig. 2.2(a): all the power is allocated to the first channel with good channel condition. If consider peak power constraints check, s1 may be clipped as shown in Fig. 2.2(b). With the proposed GWFPP, we can directly obtain the optimal solution as shown in Fig. 2.2(c).

s2 = 1 s1 = 3 s1 = 2
5 1 (a) 1 (b) 5 1 (c)

s1 = 2
5

Figure 2.2: Illustration for Example 1, results for CWF and GWFPP. (a) the CWF: without peak power restriction check (s1 = 3, s2 = 0); (b) the CWF: s1 is clipped considering peak power constraint; (c) GWFPP: s1 = 2, s2 = 1. Example 2. Instance another case of the water-filling with the WFPP problem with multiple channels: max{si }8 i=1
8 i=1

log(1 + ai si ) (2.40)

subject to: 0  si  i, i;
8 i=1

si  30.

where ai = 1/i, i. The step depth is then monotonically increase from 1 to 8, as shown in Fig. 2.3. For the CWF, without considering the peak power constraints, the water level is solved as 8.25, then the power allocation is shown in Fig. 2.3(a) and Fig. 2.4(a). Considering peak power constraints, the power levels for channels 1-4 are clipped and are set to their peak values as shown in Fig. 2.3(b). The CWF doesn't tell us where to and how to assign the clipped power.

20

Utilizing the proposed GWFPP, the result of the first loop is si = i, as i = 1, . . . , 4, as part of the solution. The remaining entries of the solution are allocated with zero, as shown in Fig. 2.4(b). The result of the second loop is si = i, as i = 1, . . . , 5, also as part of the solution. The remaining entries of the solution are allocated with zero, as shown in Fig. 2.4(c). The results of the third loop are si = i, as i = 1, . . . , 5; and si = 12 - i, as i = 6, 7, 8, as full entries of the solution, as shown in Fig. 2.4(d) and Fig. 2.3(c). According to Proposition 2.3, the result of the third loop is the optimal solution.

s1 = 7.25

water level 8 7 6 5 4

s1 = 1

water level 8 7 6 5 4 3 3 2 1 (b) (c) 4 5 6 7 8

3 2 1 1 (a) 1 2

Figure 2.3: Illustration for Power Allocation using the CWF and the proposed GWFPP for Example 2. (a) Results for the CWF; (b) the CWF, clipped s1 to s4 due to peak power restrictions; (c) Results for GWFPP. It is shown that the solution for the problem with sum power constraint only (see for example, Fig. 2.3(a) and Fig. 2.4(a)) is different from the solution of the corresponding problem with added peak power constraints (see for example, Fig. 2.3(c) and Fig. 2.4(d)). From Fig. 2.3, we can observe that for more complicated problems, the conventional water-fill exhibits its limitations. The water level is no longer a unique level. Thus, our approach using the concept of water-fill is more general to solve the RRA problems. Example 3. Instance a case of the weighted water-filling with individual peak power constraints (WFPP) problem: max{si }2 i=1
2 i=1

wi log(1 + ai si ) (2.41)

subject to: 0  si  2, i;
2 i=1

si  3 ,

21

8 Allocated Power 6 4 2 0 0 2 4 6 User Index (a) 8 Allocated Power

4 3 2 1 0 0 2 4 6 User Index (b) 8

6 Allocated Power Allocated Power 0 2 4 6 User Index (c) 8

6

4

4

2

2

0

0

0

2

4 6 User Index (d)

8

Figure 2.4: Optimal Power Allocation Results for Example 2. (a) solution from the the CWF; (b) 1st iteration results of GWFPP; (c) 2nd iteration results of GWFPP; (d) 3rd iteration results of GWFPP. where a1 = 2, a2 = 0.1, w1 = 0.2 and w2 = 0.8. Utilizing the proposed GWFPP, the result of the first loop is s1 = 2, as part of the solution. The remaining of the solution, s2 , is allocated with zero. The result of the second loop is s1 = 2 and s2 = 1, as full entries of the solution. From Proposition 2.3, the result of the second loop is guaranteed to be the optimal solution. The result is illustrated in Fig. 2.5. In this figure, for channel 1, the stair width is 0.2, specified by its weight factor. The level depth is 1/(a1 w1 ) = 2.5. Similarly, for the channel two, the stair width is 0.8 and the level depth is 1/(a1 w1 ) = 12.5. The power allocated for channel 1 is 2, so the water level for channel 1 is 10. For channel 2, the power is 1, the water level is 1.25. Again, water level is not unique for different channels. Example 4. As a last example, we instance a case of the weighted water-filling with group

22

s1 = 2

s2 = 1

0.8 10 2.5 0.2 12.5 13.75

Figure 2.5: Illustration for Example 3 using GWFPP (s1 = 2, s2 = 1). bounded power constraints (WFGBP) problem: max{si }3 i=1
3 i=1

wi log(1 + ai si )

subject to: 0  si , i;
3 i=1

si  5;

(2.42)

1  s1 + s2  2.5; 1  s3  2.5, where a1 = a2 = a3 = 1, w1 = 0.3, w2 = 0.2 and w3 = 0.5. Utilizing the proposed GWFGBP, the result from 1)-3) of GWFGBP is: s1 = 0.8, s2 = 0.2 and s3 = 1. Then continuously using 4)-6) of GWFGBP, the optimal solution is: s1  = 0.8 + 0.9 = 1.7, s2  = 0.2 + 0.6 = 0.8 and s3  = 1 + 1.5 = 2.5. The results are shown in Fig. 2.6, where the stair width for the three channels are 0.3, 0.2, 0.5 respectively specified by their weighting factors. The step depth is calculated as 1/(ai wi ), leading to the step depth values as 3.33, 5, and 2 respectively for the three channels. The water level for channel 1 and channel 2 is the same, but different with that of channel 3. It is interesting to observe that with the same path gain of these three channels, the channel with the highest weight factor, channel 3, is not necessarily being assigned as the highest power level due to the structure of the constraints.

23

s1 = 1.7 s2 = 0.8 s3 = 2.5
5.66 0.2 0.3 3.33 5 0.5 2 5

Figure 2.6: Illustration for Multi-User Power Allocation Results by GWFGBP.

2.6.2

Complexity Analysis

As stated in [36, Section 3], the conventional WF algorithm had an exponential worst-case complexity of 2K , where K is the number of the channels, even though the channel gains had been sorted in decreasing order. Pointing to this case, [36] proposed an improved algorithm with worst-case complexity of K iterations. Since each iteration consists of multiple arithmetic and logical operations, here we use total number of operations as a measure of the complexity level (See [38, Chapter 8]). The CWF approach has a worst-case complexity of K iterations, i.e., total O (K 2) fundamental arithmetic and logical operations under the 2(K +1) memory requirement and the sorted parameters {wk ak }K k =1 (e.g. see [37, p. 137], for more details). The proposed GWF algorithm occupies less computational resource. It is seen that it needs K loops at most to search k  and it needs 4 arithmetic operations and 2 logical operations to complete each loop. Thus, the worst-case computational complexity of the proposed solution is 8K + 2 (from the operations of 6K + 2 + 2K ) fundamental arithmetical and logical operations under the 2(K + 1) memory units to store {di }, {wi }, Ws , and PM . For GWFPP, it needs K loops to compute the optimal solution, at most. The required number of operations is, at worst,
K i=1 (8i +2)

= 4K 2 +6K fundamental arithmetical and logical operations.

For GWFGBP, it needs T loops to compute the optimal solution, at most. The required number of operations, at worst, is O (K 2 ) fundamental arithmetical and logical operations.

24

In this complexity analysis, we didn't take sorting procedure into consideration. It is stated in [36] that the channel gain sequences come from the eigenvalues of a matrix and many of the algorithms to compute the eigenvalues and eigenvectors already produce the eigenvalues sorted. As a note, CWF and GWF assumed the channel gain sequences to have been sorted.

25

Chapter 3 RRM in Wireless Communications with Energy Harvesting Technology
3.1 Introduction

There has been recent research effort on understanding data transmission with an energy harvesting transmitter that has a rechargeable battery for green communications [33, 43, 35, 25]. Recently, based on [35], [14] further investigates the issues of power allocation problems to minimize the grid power consumption with random energy and data arrival. In more detail, for the implied problem that is a convex optimization problem, rather than the original non-convex problem, a solution is computed. For convenience and without loss of generality, the process is considered as a discrete time process. The simplest and useful system model, illustrated in Fig. 3.1, assumes that there are K epochs in the time period or interval (0, T ]. For each epoch, an event occurs which may be the consequence of channel fading gain variation and new energy harvested. At the beginning of the process, a sequence of the fading gain is denoted by {ai }, the value of each term of which depends on epoch i. Thus, ai corresponds to epoch i. Similarly, we denote the corresponding sequence of harvested energy by {Ein (t)}, where Ein (t) is the observed harvested energy for epoch t, t = 1, . . . , K . For convenience, Ein (t), where t = i, is also expressed by Ein (i), i. This setting leads to new design insights in a wireless link with a rechargeable transmitter and fading channels. Besides the allocated power to be non-negative, sum of successively harvested energy over time determines a more complicated power constraint. Generally, the incoming energy can be stored in

26

Ein (1) L1

Ein(3)

Ein (5)

Ein (8)

1/a2
1 2 3 4 5 6 7 8

t epochs

Figure 3.1: Illustration of simple system instance

the battery of the rechargeable transmitter for future use. However, it cannot be used before its arrival. This point is called causality. Often, this battery owns a great storage capacity and it is hardly filled fully from the incoming harvested energy. This assumption is taken into account in this chapter, i.e., the maximum energy capacity of the battery, Emax 0. This assumption also

lays down a solid foundation to solve the cases of finite Emax in our incoming research outcome. In this setting, we can compute optimal transmission schemes that adapt the instantaneous transmit power to the variations in the energy and fading levels. Since the proposed optimal dynamic transmission power allocation policy results from the recursive computing, which does not utilize any information in time future, the optimal dynamic power allocation can provide the optimal solution to the maximum throughput for every sub-process or time window from epoch 1 until epoch k , as k = 1, . . . , K . This advantage owns more challenge and could be utilized to efficiently solve other problems. In recent years, energy harvesting green communication has attracted great research attention. In [33], data transmission with energy harvesting sensors is considered, and the optimal online policy for controlling admissions into the data buffer is derived using a dynamic programming framework. Dynamic programming can offer a real-time feedback policy or control, i.e., considering the time constraint of decisions, but it needs to store a family of offline policies. Further, its object is a dynamic optimization problem model, including the dynamic state transition equation(s). To avoid the curse of dimensionality, a "good" dynamic optimization problem model should be needed or set up. In [43], energy management policies stabilizing the data queue are proposed for single-user communication and under a linear approximation, some delay optimality properties are derived. In [12], the optimality of a variant of the back pressure algorithm using energy queues is shown. In [35] 27

and references therein, optimization approaches are considered to attempt to obtain the maximum throughput over AWGN and fading channels. Successively, in [25], throughput optimal energy allocation is studied for energy harvesting systems in a time constrained slotted setting. Especially in recent work, [35] and [25] investigated the same objective function, in order to attempt to use offline machinery and conventional water-filling approach which come directly from the the KKT conditions of the target problem. For the fading channel cases, [35], at the first paragraph on page 1737, used the four sentences to define its "directional water-filling algorithm". The third sentence is a key point but it still used the term "directional water-filling algorithm" to define the algorithm. Thus, a circular logic or definition seems generated. As a result, optimality of the algorithm is not provided either. Since Algorithm 2, on page 4815 in [25], used its embedded Algorithm 1 to compute the solution to the cases of the full side information, an infinitely iterated algorithm may be required. The proposed algorithm in this chapter could overcome these weaknesses. With water-filling, more power is allocated to the channels with higher gains to maximize the sum of data rates of all the sub-channels [44]. The conventional way to solve the water-filling problem is to solve the KKT conditions, and then find the water-level(s) and the solutions. In this chapter, we exploit our proposed GWF presented in Chapter 2, and construct a recursive algorithm to solve the target problem and then prove its optimality, referred as RGWF. We have shown that GWF owns less computation. This advantage becomes more significant, especially when GWF is utilized multiple times. Compared with the existing results on energy harvesting, the proposed RGWF owns three distinct characteristics: 1) for the fading channel cases, the algorithm is clearly defined; 2) it provides the exact optimal solution via finite computation recursively; 3) its optimality is strictly proven. Therefore, following the proposed algorithm, exact solution can be obtained for any subprocess from time (0, T ]. Numerical examples provide detailed procedures for determining the optimal solution by the proposed RGWF. The contents in this chapter corresponds to that in [20]. In fact, our proposed algorithm RGWF can lay down the solid fundamental of the "on-line" optimal power or energy allocation for our future energy harvesting study. To the best knowledge of ours, the existing "on-line" algorithms on energy harvesting are all suboptimal, without setting up the solid fundamental. In the remaining of the chapter, the proposed GWF is discussed in Section 3.2 with sum power

28

constraint. The proposed power allocation problem and RGWF is further investigated in Section 3.3. The transmission completion time minimization problems and their solution are investigated in Section 3.4. Numerical examples are presented in Section 3.5.

3.2

Extended GWF for Preparation of EH system

This section is only preparation for the incoming recursive GWF, in this chapter, to maximize the throughput under the EH system. It is a somewhat extended version of GWF, mentioned in the last chapter. If the readers are familiar with GWF and the extended index of the starting channel and the ending channel, this section can be skipped over. For Let L and K be two positive integers and L  K to denote the index of the starting channel and the ending channel respectively. Often, L is assigned to be 1. The water-filling problem can be abstracted and generalized into the following problem: given P > 0, as the total power or volume of the water; the allocated power and the propagation path gain for the ith channel are given as si and ai respectively, i = L . . . K ; and K - L + 1 is the total number of channels. Furthermore, the weighted coefficient wi > 0, i, and {ai wi }K i=L being monotonically decreasing, find that max{si }K i=L
K i= L

wi log(1 + ai si ) (3.1)

subject to: 0  si , i;
K i= L

si = P.

Since the constraints are that (i) the allocated power to be nonnegative; (ii) the sum of the power equals P , the problem (3.1) is called the water-filling (problem) with sum power constraint. In this chapter, we propose a novel approach to solve problem (3.1) based on geometric view. The proposed Geometric Water-Filling (GWF) approach eliminates the procedure to solve the nonlinear system for the water level, and provides explicit solutions and helpful insights to the problem and the solution. Similarly, Figs. 3.2(a)-(d) give an illustration of the proposed GWF algorithm. Suppose there are 4 steps/stairs (L = 1, K = 4) inside a water tank. For the conventional approach, the dashed horizontal line, which is the water level , needs to be determined first and then the power allocated (water volume) above the step is solved.

29

Let us use di to denote the "step depth" of the ith stair which is the height of the ith step to the bottom of the tank, and is given as 1 , for i = L, L + 1, . . . , K. ai wi

di =

(3.2)

Since the sequence ai wi is sorted as monotonically decreasing, the step depth of the stairs indexed as {L, · · · , K } is monotonically increasing. Instead of trying to determine the water level , which is a real nonnegative number, we aim to determine water level step, which is an integer number from L to K , denoted by k  , as the highest step under water. Based on the result of k  , we can write out the solutions for power allocation instantly. Fig. 3.2(a) illustrates the concept of k  . Since the third level is the highest level under water, we have k  = 3. The shadowed area denotes the allocated power for the third step by s 3.
s 3 
3

4

4


3

s1 /w1
2 1 2

d2 = 1/(a2w2)
(a) 4

1 (b) 4


3


3

d3 - d1 2

s2 /w2
2

w1 d2 = 1/(a2w2)
(c) (d)

Figure 3.2: Illustration for the proposed Geometric Water-Filling (GWF) algorithm. (a) Illustration 1 of water level step k  = 3, allocated power for the third step s 3 , and step/stair depth di = ai wi . (b) Illustration of P2 (k ) (shadowed area, representing the total water/power above step k ) when k = 2. (c) Illustration of P2 (k ) when k = 3. (d) Illustration of the weights as the widths.

In the following, P2 (k ), the water volume above step k , can be obtained considering the step 30

depth difference and the width of the stairs as, P2 (k ) = P - k = L, . . . , K. where (x)+ = max{0, x}. As an example in Fig. 3.2(c), the water volume above step 1 and below step 3 with the width w1 can be found as: the step depth difference, (d3 - d1 ) multiplying the width of the step, w1 . Therefore, the corresponding P2 (k = 3) can be expressed as, P2 (k = 3) = [P - (d3 - d1 )w1 - (d3 - d2 )w2 ]+ ,
k -1 i= L

(dk - di ) wi

+

, for

(3.3)

which is an expansion of (6.14). Then we have the following proposition for integrity. Proposition 3.1. The explicit solution to (3.1) is:    si =
sk  wk 

+ (d k  - d i ) w i , L  i  k 

  si = 0, k  < i  K, where k  = max k P2 (k ) > 0, L  k  K and the power level for this step is wk 
k i= L

(3.4)

(3.5)

sk  =

wi

P2 (k  ).

(3.6)

Proposition 3.1 has been proven above. GWF can be regarded as a mapping from the point of parameters

K {L, K, {wi }K i=L , {ai }i=L , P }

 to the solution {si }K i=L and the important water level step index: k . That is to say, it can be

31

written as a formal expression:
 K K {{si }K i=L , k } = GW F (L, K, {wi }i=L , {ai }i=L , P ).

Note that, for concision and without confusion from context, we may write the right hand side of the expression, mentioned above, as GWF(L, K ) to emphasize time stages from L to K .

3.3

Maximizing Throughput in Fading Channel and Algorithm RGWF

In this section, we firstly introduce the maximizing throughput problem in fading channel and the conventional approach from its KKT conditions. Then, we present the proposed online geometric algorithm.

3.3.1

Problem Statement and Conventional Approach

As shown in Fig. 3.1, we consider the time period from (0, T ]. The channel state changes or/and energy arrives K times in this time period. Hence, we have K epochs, with Li being the time length of the ith epoch. As a recall, {ai } and {Ein (i)} have been claimed above. Our objective is to maximize the number of bits transmitted by the deadline T . The optimal power management strategy is such that the transmit power is constant in each event epoch. Therefore, let us again denote the transmit power in epoch i by si , for i = 1, . . . , K . We have causality constraints due to energy arrivals and an Emax constraint due to finite battery size. Hence, the optimization problem in this fading case becomes [35]: max{si }K i=1
K Li i=1 2

log(1 + ai si ) (3.7) Ein (i), as l = 1, . . . , K ; Li si  Emax , l,

subject to: 0  si , i;
l i=1 l i=1

Li si  Ein (i) -

l i=1

l i=1

where if we interpret the observed properties of the optimal power allocation scheme as a waterfilling scheme mentioned above, Ein (i) units of water is filled into a rectangle of bottom width 32

Li , i. With the assumption of Emax

0, the last constraint of (3.7) disappears. Note that the last

power sum constraint in this narrowed problem is of equality. Furthermore, for unifying parameter notation, through a change of variables, we can obtain an equivalent problem to the narrowed one by Emax 0 as follows: max{si }K i=1
K i=1

wi log(1 + ai si ) (3.8)
l i=1

subject to: 0  si , i;
l i=1

si 

Ein (i), l,

where wi 

Li , ai 2



ai Li

and si  Li si . Note that the symbol  has been used at last section as

assignment operator. To find the solution to problem (3.8), the parameters of which are given with off-line, the conventional water-filling approach usually starts from the Karush-Kuhn-Tucker (KKT) conditions of the problem as a group of the optimality conditions, then the following system in the variables {si } and the dual variables can be written as     si =    
l i=1 +
K j =i

wi

j

-
1

1 ai

, for i = 1, . . . , K,
+ 1 ai wi

wi        j  0, j

K j =i

j

-



l i=1 Ein (l ), l

(3.9)

where j is the dual variable corresponding to the j th sum power constraint, for any j . The solution to (3.9) is the solution of the problem (3.8). However, it is not easy to solve (3.9).

3.3.2

Recursive Geometric Water-Filling and Its Optimality

In this section, we propose a novel approach to solve problem (3.8) using our proposed GWF approach. Similar to those assumptions in [25, 35], the parameters of problem (3.8) are given. The constraint in (3.8) can be expanded into a matrix form as
    1 1     · · ·  1 1 ··· 1          1 s1 s2 . . . sK                .  .  . 
1 i=1 Ein (i) 2 i=1 Ein (i)

     .   

(3.10)

K i=1 Ein (i)

33

Note the coefficients matrix forms a triangle matrix, as a different mathematical structure from that conventional Water-Filling deals with, mentioned before. The proposed RGWF(K) is stated as in the following Algorithm description: Algorithm 1 Pseudocode for RGWF 1: Initialize: L = 1, K, Ein (1), w1 , a1 ;
2:

Output the result for epoch 1: RGWF(1) = s 1 = Ein (1);

3: 4: 5: 6: 7: 8: 9: 10: 11: 12: 13: 14: 15: 16:

for L = 2 : 1 : K do Input: {Ein (L), wL , aL };
-1 { sk } L k =1 = RGWF(L - 1);

for n = L : -1 : 1 do W = {w j }L j =n ; A = {aj }L j =n ; ST =
L- 1 j =n

sj + Ein (L);
1 an-1 wn-1 sn-1 wn-1

L  {{s k }k =n , k } = GWF(n, L, W, A, ST );

if

1 ak wk

+

sk  w k



+

and sn-1 > 0, or n == 1 then

 Output: RGWF(L) = {s1 , . . . , sn-1 , s n , . . . , sL } ,

Move to next epoch, i.e., go to Line 16; end if end for end for

RGWF is illustrated as follows. Based on Lines 1-2 of RGWF, as the base case of the recursive definition, the inner loop (Lines 6-15) can be illustrated in Fig. 3.3 where it is assumed that the current processing epoch L = 6. The optimal power allocation for the first 5 epochs has been completed as shown in the shadowed area in Fig. 3.3(a). Epoch 6 is now under processing. Based on Line 9, since there is no harvested energy input in epoch 6, the power level for epoch 6 is zero and
 = 5 and then Line 11 compares the water level is just the fading level. Line 10 calculates that ke  th epoch. Since the comparison in Line the water level of current processing window with that of ke

11 does not hold, the algorithm goes back to Line 6 by decreasing n to 5 and then the processing window is extended to include epochs 5 and 6 as shown in Fig. 3.3(b). Fig. 3.3(b) also shows 34

processing window

(a) 1 2 3 4 5 6 epoches

processing window

(b) 1 2 3 4 5 6 epoches

processing window

(c) 1 2 3 4 5 6 epoches

processing window

(d) 1 2 3 4 5 6 epoches

Figure 3.3: Illustration for Algorithm RGWF (Line 6-15 for L = 6), harvested energy having been allocated up to epoch 5; horizontal-wave shadowed areas denote power allocation for the processing     window; (a) n = 6, ke = 5; (b) n = 5, ke = 4; (c) n = 4, ke = 3; (b) n = 3, ke = 2;

35

the power allocation from GWF(5,6) in Line 9 as the horizontal-wave shadowed areas. Still, the comparison of the water level non-decreasing in Line 11 does not hold, the algorithm returns to Line 6 again by decreasing n = 4. As shown in Fig. 3.3(c), the processing window is epochs 4 to 6. The water level non-decreasing condition still is not satisfied. The processing window is extended from epochs 3 to 6 as shown in Fig. 3.3(d). With the new water level in the processing window, the water level non-decreasing condition up to epoch 6 is satisfied. As a result, RGWF(L = 6) is solved which is recursively obtained from RGWF(L - 1 = 5) as illustrated in Fig. 3.3. A summation is used in Line 8. If the lower limit of the summation is greater than the upper limit, the result of this summation is defined as zero, as well known. Through this mechanism, the
K solution {s i }i=1 is obtained as RGWF(K ) within finite loops.

The proposed algorithm eliminates the procedure to solve the non-linear system (3.9) in multiple variables and dual variables, provides online and exact solutions via finite computation steps, and offers helpful insights to the problem and the solutions. To guarantee optimality of RGWF, we have the following proposition: Proposition 3.2. RGWF can compute the optimal exact solution to problem (3.8) within finite loops. Proof of Proposition 3.2. From the algorithm RGWF(K), there exists n1 , where 1  n1 
n1 K - 1, and {s i }i=1 = [RGWF(K )]|{1,...,n1 } . Thus, there are the non-negative Lagrange dual varin1 1 ables {i }n i=1 and {i }i=1 such that KKT conditions, of the restriction of the optimization problem

RGWF(K) to the set {1, . . . , n1 }, hold. This restriction means a sub-problem:
n1
1 {si }i=1

max n

wi log(1 + ai si )
i=1 l l

(3.11) (3.12) (3.13) (3.14)

subject to:
i=1 n1

si 
i=1 n1

Ein (i),

0  si , as 1  l  n1 - 1; si =
i=1 i=1

s i.

Further, {i , i } correspond to the ith sum power constraint and power non-negativeness constraint,

36

respectively. On the other hand,
K j =n1 +1

K  {{s i }i=n1 +1 , k } = GWF(n1 + 1, K, {wj }, {aj },

s j ).

Thus, there are also the non-negative Lagrange dual variables  and {i }K i=n1 +1 that are the KKT conditions of the following sub-problem:
K {si }K i=n

max
1 +1

wi log(1 + ai si )
i=n1 +1

(3.15) (3.16)

subject to:

0  si , i;
K K

si =
i=n1 +1 i=n1 +1

s i.

(3.17)

Since GWF(n1 + 1, K ) has one sum power constraint and specific finite loop operations, we can assign 1
1 ak +wk

K =  =

+

K -1 = · · · = n1 +1 = 0

sk  wk 

(3.18) (3.19)

with the fine k  , as the minimum positive step index of the set: {n1 + 1, . . . , K }, where the adjective "fine" expresses that k  can be used to clarify whether the allocated power to be positive or zero, and determine the water-level, at once. Also due to characteristics of the loop transition from n1 + 1 to n1 during carrying out RGWF(n1 ), and the points mentioned above, it is seen that the feasible
K solution of {s i }i=1 , computed by RGWF(K), is indeed the optimal solution to (3.8).

Therefore, Proposition 3.2 is proved. Remark 1. RGWF is a recursive algorithm with the characteristics of optimal dynamic online power distribution. Dynamics of this algorithm but that for the target problem is shown by the generalized varying structure state equation on dynamics:
RGWF(L + 1) = [[RGWF(L)]|1 , [GWF(n, L + 1)]|2 ],

(3.20)

for L = 1, . . . , K - 1, where n is the index of the starting epoch of the currently processing window (i.e., it satisfies Line

37

-1 11 of RGWF), the set 1 denotes {sk }n k =1 and this set is referred to in RGWF mentioned above, and +1 the set 2 denotes {sk }L k =n and this set is referred to in (3) mentioned before. Thus, we extend the

concept of algorithm [53], as a static mapping to a dynamic mapping as a new concept of algorithm to efficiently solve the problems. In this process, RGWF(L) can be regarded as the generalized system state at the time stage (or epoch) L; GWF(n, L + 1) can be regarded as the generalized system control at the time stage (or epoch) L; and then RGWF(L + 1), as a state at the next time stage, can be derived or determined from the previous state and control. Due to the optimality of RGWF(L) from Proposition 3.2 for any L, the proposed algorithm is indeed an optimal dynamic water-filling algorithm with high efficiency. In addition, the proposed algorithm RGWF(K ) in this section can output the unique optimal solution to the corresponding problem, since the objective function of the problem has a negative definite Hessian matrix.

3.4

Transmission Completion Time Minimization

In previous section, RGWF was discussed to efficiently solve the throughput maximization problem. In this section, RGWF is extended to solve the transmission completion time minimization problem. Now assume that the transmitter has B bits to be transmitted to the receiver. Our objective now is to minimize the time required to transmit these B bits. This problem is called the transmission completion time minimization problem. In [46] and [50], this problem is formulated and solved for an energy harvesting system in a non-fading environment. In [35], the problem is attempted to be solved offline in a fading channel. In this chapter, we use the proposed RGWF to solve the problem in a fading channel with recursive computation, referred to as RGWFn. The transmission completing time minimization can be stated as follows, with assuming N to be a positive integer and N  K .

{{si }N i=1 ,N }

min

N
N

(3.21) wi log(1 + ai si ) = B ; (3.22) (3.23) Ein (i), l = 1, . . . , N.
i=1

subject to:
i=1

0  si , i;
l l

si 
i=1

(3.24)

38

The proposed RGWFn is presented in the algorithm description shown below. Compared with the steps of RGWF, in the first line of the algorithm, RGWFn introduces B as a parameter while others being the same. In line 8, RGWFn sequentially processes from the second epoch to the K th epoch to output the optimal value N  and its optimal solution: {RGWFn(N  ), N  }. Similarly, the inner "for" loop updates power levels for the current processing epoch (L) and its previous L - n epochs to form a processing window. GWF algorithm is also applied to this window to find a common water level. Note that a new "if" clause is inserted into the outer level "if" clause (for the water level non-decreasing condition check). The function of this inner "if" clause is to check whether the transmitted bits reach B . Therefore, it is the normal exit of the algorithm (lines 23-28). For convenience, the condition of this new "if" clause is called the criterion of RGWFn. This is also due to the importance of the criterion in the following proposition.

39

Algorithm 2 RGWFn, Based on RGWF
1: Initialize: L = 1, K, B, Ein (1), w1 , a1 ; 2: Output the result for epoch 1: s1 = RGWF(1) = Ein (1), 3: if 4: 5: 6:
1 i=1

wi log (1 + ai si )  B then
1 wL aL (2
B

RGWFn(1) = s 1 = N  = 1; Exit the algorithm;

- 1);

7: end if 8: for L = 2 : 1 : K do 9: 10: 11: 12: 13: 14: 15: 16: Input: {Ein (L), wL , aL };
-1 { sk } L k=1 = RGWF(L - 1);

for n = L : -1 : 1 do
L W = {wj }L j =n ; A = { a j } j =n ; L -1 j =n s j L

ST =

+ Ein (L);

 {{s k }k=n , k } = GWF(n, L, W, A, ST );

if n > 1 then
 ke = max{k |sk > 0, 1  k  n - 1},  = 1; else ke

17: 18: 19: 20: 21: 22: 23: 24: 25: 26: 27: 28: 29: 30: 31: 32:

end if if
1 ak wk

+

sk w k



1 ake wke

+

ske wke

then

RGWF(L) = T1 = T2 = T3 =
n-1 i=1 L i=n

 {s1 , . . . , sn-1 , s n , . . . , sL } ;

wi log (1 + ai si ); wi log (1 + ai s i ); log (1 + ai s i );

L -1 i=n wi

if T1 + T2  B then B1 = B - T 1 - T 3 ; s L =
1 wL aL (2
B1

- 1);

-1  L RGWFn(L) = {si }n i=1  {sj }j =n ;

N  = L; Exit the algorithm; end if Move to next epoch, i.e., go to Line 31; end if end for

33: end for

40

Proposition 3.3. If there does not exist L such that the criterion in RGWFn:
n -1 L

wi log (1 + ai si ) +
i=1 i= n

wi log (1 + ai s i)  B

(3.25)

holds, where the symbols in (3.25) keep the same meaning as those in the statement of RGWFn, then there is no solution to problem (3.21). If the criterion holds, then the obtained N  is the optimal value and {RGWFn(N  ), N  } is the exact optimal solution. Proof of Proposition 3.3. For the given B , if there does not exist L such that the criterion in RGWFn:
n -1 L

wi log (1 + ai si ) +
i=1 i= n

wi log (1 + ai s i)  B

holds, it implies that the optimal value of problem (3.8) is strictly less than B , corresponding to Proposition 3.2. Thus, the first constraint of problem (3.21) never holds. Then there is no solution to problem (3.21). Then, assume that there exist N  and RGWF(N  ) such that
n -1 N

wi log (1 + ai si ) +
i=1 i= n

wi log (1 + ai s i )  B,

where
 RGWF(N  ) = {s1 , . . . , sn-1 , s n , . . . , sN  } .

According to the obtained N  from the RGWFn algorithm, the optimal value of the problem
N {si }N i=1

max

wi log(1 + ai si ) 0  si , i;
l l i=1

subject to:

si 
i=1 i=1

Ein (i) for l = 1, . . . , N,

is less than B , where RGWF(N ) is the optimal solution to this problem, for N = 1, . . . , N  - 1. Hence, the optimal value of problem (3.21) is not less than N  . Stemming from the statement of RGWFn, {RGWFn(N  ), N  } is a feasible solution to problem (3.21) and further N  is the evaluated objective value of problem (3.21) at {RGWFn(N  ), N  }. Thus, N  is a feasible value. Together 41

with the mentioned fact that the optimal value of problem (3.21) is not less than N  , as a result, N  is the optimal value and {RGWFn(N  ), N  } is the exact optimal solution to problem (3.21). Therefore, Proposition 3.3 is proved. Remark 2. RGWFn is an optimal dynamic progressive process to compute the transmission completion time minimization. This progressive process is ended at current epoch and then output the minimum completing time once the criterion is satisfied. Hence, it doesn't need the informatio/solution of the entire process of the problem(s). In addition, given the lengths of epochs: {Li }, due to wi = completion time duration is 2
N k =1 wi , Li , i, 2

the minimum transmission

which can be computed by finding N  .

3.5

Numerical Examples for RRM with Energy Harvesting Transmission

The system model is static. However, our computation does not wait full information input but it can compute the exact optimal solution through finite computation for every sub-process that starts from epoch 1 and ends at epoch k , as k = 1, . . . , K , including the entire process. This point can also lean toward designing other efficient algorithms, such as the algorithm to compute the minimum transmission completion time to avoid a tedious and huge backlog of offline or static computation. The minimum transmission completion time problem can be refereed to in [35] for details. Due to the limit of pages, its discussion is omitted. For simple illustration, we assume only three epochs, each with unit weight (wi = 1, i = 1, 2, 3). At the beginning of each epoch, unit energy is harvested (Ein (i) = 1, i = 1, 2, 3). Example 1. Suppose the fading profile for the three epochs is a1 = 1, a2 =
1 2

and a3 = 1 . 3

Epoch 1 is first scanned to output RGWF(1)=s1 = 1 as shown in Fig. 3.4(a). Now we move to epoch 2 and apply GWF(2,2) and output s2 = 1. Check if the water level of epoch 2 (2+1=3) is greater than the water level of epoch 1 (1+1=2). It is true then output the optimal solution at epoch 2: s1 = 1; s2 = 1 as shown in Fig. 3.4(b). Similarly, for epoch 3, by applying GWF(3,3), we have s3 = 1. Check the water level, it satisfies non-decreasing condition. So the algorithm outputs the completed solution as shown in Fig. 3.4(c). Example 1 is calculated out without power level adjustment. In the following example, we 42

Ein (1) = 1

Ein (2) = 1

Ein(3) = 1

s1 = 1
3 1 2
(a)

2 1
(b)

3 1

2
(c)

3

Figure 3.4: Procedures to solve Example 1: (a) s1 = 1; (b) s1 = 1, s2 = 1; (c) s1 = 1, s2 = 1, s3 = 1.

illustrate the power level adjustment procedure. Example 2. Suppose the fading profile for the three epochs is a1 = 1, a2 = 2 and a3 = 3. For this example, the proposed RGWF is illustrated in the following fig. 3.5.

Ein (1) = 1 s1 = 1

Ein (2) = 1 s1 = 0.75

Ein(3) = 1 s1 = 11/18

1 1/2
(a)

1 1/3

1 1/2
(b)

1/3

1/2
(c)

1/3

Figure 3.5: Procedures to solve Example 2: (a) s1 = 1; (b) s1 = 0.75, s2 = 1.25; (c) s1 = 11/18, s2 = 20/18, s3 = 23/18.

First, we scan the first epoch and RGWF(1) output s1 = 1, as shown in Fig. 3.5(a). Then move to the second epoch, by applying GWF(2,2), it gives s2 = 1. Now check the water level of epoch 2 is 1+1/2=1.5 and the water level for epoch 1 is 1+1=2. Water level non-decreasing condition is violated. Power level adjustment procedure is triggered. By applying GWF to the first two epochs, we have GWF(1,2)={s1 = 0.75, s2 = 1.25}. With this power adjustment, the new water level for both epochs is 1.75, satisfying non-decreasing condition. The output for RGWF(2) is then s1 = 0.75, s2 = 1.25 as shown in Fig. 3.5(b). 43

Now we move to epoch 3, the output of GWF(3,3)=s3 = 1. The corresponding water level for epoch 3 is 1+1/3, which is lower than the water level of the previous epoch (=1.75). Then the power adjustment is triggered. The algorithm calculates the power allocation for current epoch (epoch 3) and its previous epoch (epoch 2) to have output GWF(2,3)={s2 = + 25 = to water level check step. The new water level of epoch 2 ( 1 2 24
37 ) 24 25 , s3 24

=

29 }. 24

We move

is lower than the water level

of epoch 1 (1.75). Therefore, power adjustment needs to include epoch 1 as well. We then compute GWF(1,3), the output is {s1 =
11 , s2 18

=

11 18

+1 , s3 = 2

11 18

+2 }, which is the completed output for the 3

optimal solution as shown in Fig. 3.5(c). Example 3. Suppose the fading profile for the three epochs is a1 = 1, a2 =
1 2

and a3 = 1 ; 3

the energy harvesting at the beginning of each epoch is Ein (1) = Ein (2) = Ein (3) = 2. The information required for transmission is B = 3 bits (strictly speaking, B bits/Hz ). Then the minimizing transmission completion time problem is

{{si }N i=1 ,N }

min

N
N

(3.26) log(1 + ai si ) = 3; (3.27) (3.28) (3.29)

subject to:
i=1

0  si , i;
l

si  2l, l = 1, . . . , N.
i=1

Epoch 1 is first scanned to output RGWF(1)= s1 = 2 as shown in Fig. 3.6(a). Since log (1 + 2) < B (= 3), now we move to epoch 2 and apply GWF(2,2) and output s2 = 2. Check if the water level of epoch 2 (2+2=4) is greater than the water level of epoch 1 (1+2=3). It is true then output the temporary optimal solution at epoch 2: s1 = 2; s2 = 2 as shown in Fig. 3.6(b). Since log (1 + 2)+log (1 + 1) < B (= 3), now we move to epoch 3 and apply GWF(3,3) and output s3 = 2. Check if the water level of epoch 3 (3+2=5) is greater than the water level of epoch 2 (2+2=4). It is true then output the temporary optimal solution at epoch 3: s1 = 2; s2 = 2; s3 = 2. Since
4 > B , B1 = 3 - (log 3 + log 2) = log 3 . Then, s3 = log 3 + log 2 + log 5 3 1
1 3

(2log 3 - 1) = 3 × ( 1 ) = 1. 3

4

   Therefore, The optimal solution is {{s 1 = 2, s2 = 2, s3 = 1}, N = 3} and the optimal value is

N  = 3 as shown in Fig. 3.6(c). Example 4. Suppose the fading profile for the three epochs is a1 = 1, a2 = 2 and a3 = 3;

44

Ein (1) = 2

Ein (2) = 2

Ein(3) = 2

s1 = 2

3 1 2
(a)

1

2
(b)

3 1

2
(c)

3

Figure 3.6: Procedures to solve Example 3: (a) s1 = 2; (b) s1 = 2, s2 = 2; (c) s1 = 2, s2 = 2, s3 = 1.

the energy harvesting at the beginning of each epoch is Ein (1) = Ein (2) = Ein (3) = 1. The information required for transmission is B = log(20) bits. The minimizing transmission completion time problem is described as

{{si }N i=1 ,N }

min

N
N

(3.30) log(1 + ai si ) = log(20); (3.31) (3.32) l = 1, . . . , N. (3.33)

subject to:
i=1

0  si , i;
l

si  l,
i=1

Epoch 1 is first scanned to output RGWF(1)= s1 = 1 as shown in Fig. 3.7(a). Since log (1 + 1) < B (= log(20)), now we move to epoch 2 and apply GWF(2,2). It gives s2 = 1. Check the water level of epoch 2 which is 1+1/2=1.5 and the water level for epoch 1 is 1+1=2. Water level non-decreasing condition is violated. Power level adjustment procedure is triggered. By applying GWF to the first two epochs, we have GWF(1,2)= {s1 = 0.75, s2 = 1.25}. With this power adjustment, the new water level for both epochs is 1.75, satisfying non-decreasing condition. The output for RGWF(2) is then s1 = 0.75, s2 = 1.25 as shown in Fig. 3.7(b). Since log (1 + 0.75) + log (1 + 2 × 1.25) < B , we move to epoch 3 and apply GWF(3,3). Similarly as in Example 2, the output of RGWF(3) is {s1 =
11 , s2 18

=

11 18

+ 1 , s3 = 2
11 ) - log (1 18

11 18

+ 2 }. Since log (1 + s1 ) + log (1 + 2s2 ) + log (1 + 3s3 ) > B , 3
20 ) 18

B1 = log 20 - log (1 +

+2×

= log (10 × ( 18 ) ). Then, s3 = 1 (2log (10×( 29 ) ) - 1) = 29 3
11 , s 2 18

2

18 2

2399 . 2523

Therefore, the completed optimal solution is {{s 1 = 45

=

20 , s 3 18

=

2399 }, N  2523

= 3} as shown in

Fig. 3.7(c).

Ein (1) = 1 s1 = 1

Ein (2) = 1 s1 = 0.75

Ein(3) = 1 s1 = 11/18

1 1/2
(a)

1 1/3

1/2
(b)

1 1/3

1/2
(c)

1/3

Figure 3.7: Procedures to solve Example 4: (a) s1 = 1; (b) s1 = 0.75, s2 = 1.25; (c) s1 = 11/18, s2 = 20/18, s3 = 2399/2523.

46

Chapter 4 Optimal Recursive Power Allocation for Energy Harvesting System with Multiple Antennas
In this chapter, we investigate the optimal recursive power allocation policies with energy harvesting wireless nodes equipped with multiple antennas in a fading channel. This optimization problem includes several complex matrices as optimization variables. As a difference, existing optimization theory and methods have been designed to solve these problems over real space. Naturally, the optimization variables have been assumed to be points in the real space. We proposed a transform approach and designed the algorithms for solving the throughput maximization problem and transmission time minimization problem for a MIMO (multiple-input multiple-output) system. The algorithms were further extended to solve throughput maximization problem of a hybrid system with both harvesting energy and grid power. Numerical results illustrated the algorithms steps and significant efficiency of the proposed algorithms. To the best knowledge of the authors, there is no existing algorithms reported in the open literature to obtain exact solutions to the proposed problems. Significant features of the proposed algorithms include i) they provide the exact optimal solutions via efficient finite computation; ii) optimality of the proposed algorithms is strictly proven. With the property from the aid of the EH and the utilization of MIMO technology, a cooperative MIMO EH communication system (MIMO EH) is formed. The introduction is stated in Section

47

4.1. System models and proposed maximum throughput problems are mentioned in Section 4.2. In order to find the solution to the maximum throughput problems, the recursive geometric waterfilling (RGWF) is then presented in Section 4.3. Then, for minimizing the transmission completion time problems of the MIMO EH, the algorithms based on RGWF is presented in Section 4.4. Extending the MIMO EH to the hybrid system of MIMO, EH and power grid is carried out in Section 4.5. Numerical results and computational complexity are investigated in Section 6.

4.1

Introduction

Prolonging the lifetime of the batteries in wireless communication systems is extremely important. One possible technique to overcome the limitation of battery lifetime is to harvest energy from the environment, such as vibration absorption devices, solar energy, wind energy, thermal energy, and other clean energy. In such systems, energy harvesting has become a preferred choice for supporting "green communication". Furthermore, the multiple-input multiple-output (MIMO) technology [5] uses multiple antennas at either the transmitter or the receiver or both sides to significantly increase data throughput and link range without additional bandwidth or transmitted power. Thus it plays an important role in advanced wireless communication systems. The focus of this chapter is to investigate the optimal power allocation policies to enhance transmission efficiency for wireless communications with multiple antennas and energy harvesting in fading environment.

4.1.1

Our Work

In our recently published paper [19], we proposed an efficient geometric approach (GWF) to solve water-filling problems. The proposed GWF, as a functional block, was recursively used to solve the power allocation problem with energy harvesting under both fading and single input single output (SISO) channels, i.e., single antenna cases, in [20]. In this chapter, we extend the algorithms in [20] to the MIMO system to solve the problems with energy harvesting causal constraints. Note that [20] cannot directly be used to solve the MIMO cases. Furthermore, it did not consider the related problems under a hybrid system with the coexistence of harvested energy and grid power. Due to the recursive feature and the repeatedly application of the GWF [19], the proposed algorithms are referred to as RGWFM (Recursive GWF for MIMO) for throughput maximization

48

and RGWFMn/RGWFMt for transmission minimization problems. They can handle more general cases of the multiple antennas than the cases of the single antenna [20]. Compared with the existing results, the proposed algorithms own two significant and distinguished features: i) it provides the exact optimal solution via finite computation with cubic polynomial computational complexity; ii) its optimality is strictly proven. Due to the usage of recursion, the solutions to a family of the maximum throughput problems for any of the sub-processes starting from epoch 1 to epoch k , for k = 1, · · · , K , can be obtained (where K is the index of the last epoch in the process). Our major contribution in this chapter is: Using our earlier geometric water-filling theory, the maximum throughput and the minimum transmission completion time problems for energy harvesting with multiple antennas are solved with optimal and exact solutions. The throughput maximization problem is further extended to a hybrid system including grid power and optimal solutions being provided. To the best knowledge of the authors, no existing algorithms reported in the open literature could provide exact solutions to the target problem.

4.2

System Model and Proposed Problems

In this section, since system model can be referred to in that of last chapter, we directly introduce the transmission throughput maximization problem with energy harvesting in a fading channel. For convenience and without loss of generality, the process is assumed to be a discrete time process. For a MIMO-enhanced channel, assume that there are one receiver with Nr antennas, and one transmitter or user, which is equipped with Nt antennas. The received signal at the ith epoch, yi  CNr ×1 , at the receiver is described as
i yi = H i x + Z,

Hi  CNt ×Nr , i = 1, 2, · · · , K,

(4.1)

where Hi is the channel gain matrix; xi  CNt ×1 is the complex input signal vector transmitted at the ith epoch and is assumed to be a Gaussian random vector, having zero mean for any i, and
Nr × 1 is an {xi }K i=1 are independent on the meaning of probability theory. The noise term, Z  C

additive Gaussian noise random vector, i.e., Z  N(0, I). The channel input, {xi }K i=1 and Z are also assumed to be mutually independent. Furthermore, the covariance matrix of the transmit power at 49

the ith epoch can be expressed as Si = E xi (xi ) , i = 1, 2, · · · , K.

(4.2)

The total transmit power for the ith epoch is, therefore, Tr(Si ). Note that Si , i, is positively semi-definite, i.e., Si 0.

The objective is to maximize the number of bits transmitted by the deadline T , i.e., within the K epochs. Thus, the proposed problem is: min{Sk }K - Si
K Li i=1 2

k=1

log |I + H i Si Hi | (4.3) Ein (k ),

Subject to:

0, i;
l k =1

Li Tr(Sk ) 

l k =1

for l = 1, . . . , K. Furthermore, for unifying parameter notation, through a change of variables, we can obtain an equivalent problem, as follows: min{Si }K i=1 -
K i=1

wi log |I + H i Si Hi | (4.4)
l k =1 Ein (k ), l,

subject to: Si

0, i;
l k =1

Tr(Sk ) 

where wi 

Li , Hi 2



Hi  Li

and Si  Li Si . Note that the symbol  is the assignment operator.

Since the objective function of problem (4.4) with constraints has complex matrices Si s as the optimized variables, and the existing optimization theory and method only solve the real space problems, we need to transform problem (4.4) to an equivalent real form problem, which is stated as follows. min{si }Nt ×K -
i=1

Nt × K i=1

w[ i-1 ]+1 log(1 + ai si )
Nt

subject to:

0  si , i;
Nt × l i=1

(4.5)
l i=1

si 

Ein (i), l,
Nt

where [ ] denotes the integral part of a real number. For simplicity, we write {w[ i-1 ]+1 } as {wi }. The transformation for the mentioned equivalence between problem (4.4) and problem (4.5) is stated as

50

follows. For problem (4.4), since

 wi log |I + H i Si Hi | = wi log |I + Hi Hi Si |, i,

(4.6)

there is the eigenvalue decomposition such that Hi H i can be transformed into a diagonal matrix. This procedure is that there exists a unitary matrix Ui such that
 i = Ui Hi H i Ui =   a(i-1)×Nt +1  ..  .  

   ,   a(i-1)×Nt +Nt (4.7)

t where i is a diagonal matrix and its diagonal element set {a(i-1)×Nt +j }N j =1 , as a sequence, is

monotonically decreasing. Thus, wi log |I + Hi H i Si |
 = wi log(|Ui ||I + Hi H i Si ||Ui |)

= wi log |Ui U i + i S i | = wi log |I + i2 Si i2 |, i,
1 1

(4.8)

where Si = Ui Si U i for simplifying notation. Furthermore, problem (4.4) is equivalent to the following problem: min{Si }K i=1 -
K i=1

wi log |I + i2 Si i2 | (4.9)
l k =1 Ein (k ), l.

1

1

subject to: Si

0, i;
l k =1

Tr(Sk ) 

From the well known Hadamard's inequality on positive definite matrices and some matrix operations, problem (4.9) is equivalent to problem (4.5). Note that, since problem (4.4) earlier mentioned is equivalent to problem (4.9) from the shown derivation above, therefore, problem (4.4) is equivalent to problem (4.5). As a result, we only need to compute the solution to problem (4.5),

51

and the solution is denoted by {s i }. Successively, we can obtain  U i      s (i-1)×Nt +1 .. . s (i-1)×Nt +Nt     Ui , i,   (4.10)

as the solution to problem (4.4). As a note, equivalence between two optimization problems can be guaranteed only by their having the same optimal value. Further, it needn't require their objective values to be the same for any independent variable. To find the solution to problem (4.5), the conventional water-filling approach usually starts from the Karush-Kuhn-Tucker (KKT) conditions of the problem, and try to solve a system of equations and inequalities in many optimization variables {si } and the dual variables. Unlike the conventional approach, our proposed algorithm directly and efficiently solves the target problem by recursion and repeatedly application of our earlier proposed GWF. Due to our constructive solution, it also solves the KKT conditions.

4.3

RGWFM - Recursive GWF for Multiple Antennas

In this section, we propose a novel approach to solve problem (4.5) using our proposed GWF approach. Since the proposed RGWFM is based on a generalized algorithm of GWF [19], this generalized GWF is still termed as GWF that is concisely introduced as follows. GWF can be regarded as a
K K mapping from the point of parameters {L , K , {wi }K i=L , {ai }i=L , P } to the solution {si }i=L and

the important water level step index: k  (which is defined as the highest channel/level index under water), where {ai } and {wi } are respectively fading gain vector and weight vector [19]; L and K are two positive integers, to denote respectively the index of the starting channel and the ending channel of a set of channels (for power allocation) sorted according to their channel gains, i.e., L  K ; and then K - L + 1 is the total number of channels. Often, L is assigned to be 1. That is to say, it can be written as a formal expression:
 K K {{si }K i=L , k } = GWF(L , K , {wi }i=L , {ai }i=L , P ).

(4.11)

52

Thus, if L = 1 and K = K , this GWF is regressed into the original GWF. Since we often use the first part, {si }K i=L from GWF, we also write
K K { si } K i=L = GWF(L , K , {wi }i=L , {ai }i=L , P ).

(4.12)

Note that, for concision and without confusion from context, we may write the right hand side of the expression as GWF(L , K ) to emphasize time stages from L to K . Furthermore, the detailed definition, discussion and optimality proof of GWF can be referred to in [19].
KNt Through the mechanism of recursion, the solution {s i }i=1 is obtained as RGWFM(K ) within

finite loops. Note that in Line 8 shown, we used a summation. If the lower limit of the summation index is greater than the upper limit, the result of this summation is defined as zero. Algorithm 3 Pseudocode of RGWFM
Nt t 1. Initialize: L = 1, Nt , K, P = Ein (1), {wk }N k =1 , {ak }k =1 ; 2. Output the result for epoch 1: Nt RGWFM(1) = GWF(1, Nt )|I = {s k }k =1 . 3. For L = 2 : 1 : K , t 4. Input:{Ein (L), {w(L-1)Nt +j , a(L-1)Nt +j }N j =1 };

5. 6. 7. 8. 9. 10. 11. 12. 13. 14. 15. 16.

{sk }k=1 t = RGWFM(L - 1); For n = L : -1 : 1, LNt t W = {wj }LN j =(n-1)Nt +1 ; A = {aj }j =(n-1)Nt +1 ;
(L-1)Nt j =(n-1)Nt +1 sj LNt  {{sk }k=(n-1)Nt +1 , k }

(L-1)N

ST =

+ Ein (L);

e k +s  ak 1 + wk , w ke e w ke k output: RGWFM(L)  = {s1 , . . . , s(n-1)Nt , s (n-1)Nt +1 , . . . , sLNt }, Move to next epoch, i.e., go to Line 16; End If End For End For

= GWF((n - 1)Nt + 1, LNt , W, A, ST );  = max{k |s > 0, 1  k  (n - 1)N }; ke t k If
1 ak wk s

For algorithm RGWFM, all the parameters in problem (4.5) are given except optimization variables. The proposed algorithm eliminates the procedure to solve the non-linear system from the KKT conditions in multiple variables and dual variables, provides exact solutions via finite computation steps, and offers helpful insights to the problem and the solutions. To guarantee optimality of RGWFM, we have the following proposition: Proposition 4.1. RGWFM can compute the optimal exact solution to problem (4.5) within 53

finite loops. Proof of Proposition 4.1. Problem (4.5) being given implies all the parameters being given except optimization variables. From the algorithm RGWFM(K), there exists n1 , where 1  n1 
n 1 Nt K - 1, and {s i }i=1 = [RGWFM(K )]|{1,...,n1 Nt } = RGWFM(n1 ). Thus, there are the non-negative n 1 Nt 1 Lagrange dual variables {i }n i=1 and {j }j =1 such that KKT conditions, of the restriction of the

optimization problem RGWFM(K) to the epoch set {1, . . . , n1 }, hold. This restriction means a sub-problem: min{si }n1 Nt
i=1

n 1 Nt i=1 lNt i=1

-wi log(1 + ai si )
l i=1

subject to:

si 

Ein (i), as 1  l  n1 - 1;

(4.13)

0  si , i;
n 1 Nt i=1

si =

n 1 Nt i=1

s i.

Furthermore, {i , {j }} correspond to the ith sum power constraint and power non-negativeness
KNt constraint, respectively. On the other hand, {s i }i=n1 Nt +1 = GWF(n1 Nt +1, KNt , {wj }, {aj }, KNt j =n1 Nt +1

s j ).

KNt Thus, there are also the non-negative Lagrange dual variables {i }K i=n1 +1 and {j }j =n1 Nt +1 that sat-

isfy the KKT conditions of the following sub-problem: min{si }KNt -
KNt i=n1 Nt +1

i=n1 Nt +1

wi log(1 + ai si ) (4.14)

subject to:

0  si , i;
KNt i=n1 Nt +1

si =

KNt i=n1 Nt +1

s i.

Since GWF(n1 Nt + 1, KNt ) has one sum power constraint and specific finite loop operations, we can assign 1
1 ak +wk

K =

+

K -1 = · · · = n1 +1 = 0

sk  wk 

(4.15) (4.16)

with the fine k  , as the minimum positive step index of the set: {n1 Nt + 1, . . . , KNt }, where the adjective "fine" expresses that k  can be used to clarify whether the allocated power to be positive or zero, and determine the water-level. Also due to characteristics of the loop transition from n1 Nt + 1 to n1 Nt during carrying out RGWFM(n1 ) and GWF(n1 Nt + 1, KNt , {wj }, {aj },
KNt j =n1 Nt +1

s j ),

KNt and the points mentioned above, it is seen that the feasible solution of {s i }i=1 , computed by

54

KNt RGWFM(K), is indeed the optimal solution to (4.5) due to the facts that {{i }K i=1 , {j }j =1 } are KNt the dual variables; they, together with {s i }i=1 , satisfy the KKT conditions of (4.5); and the

qualification of (4.5) holds. Therefore, Proposition 4.1 is proved.

4.4

Transmission Completion Time Minimization

In previous section, RGWFM was discussed as a recursive water-filling to efficiently solve the throughput maximization problem. In this section, RGWFM is used to solve the transmission completion time minimization problem. Now assume that the transmitter has B bits to be transmitted to the receiver. Our objective now is to minimize the time required to transmit these B bits. This problem is called the transmission completion time minimization problem. In [46] and [50], this problem is formulated and solved for an energy harvesting system in a non-fading environment. In [35], the problem is discussed offline in a fading channel by offering a condition the solution should meet. Single antenna problems are investigated in those works. In this chapter, we use RGWFM to solve the target problem in a fading channel with multiple antennas applying the recursion feature of the computation. The transmission completion time minimization is categorized into two classes. The first class assumes that the completion time is taken at the ends of the epochs as discrete time points. Since T and {Li } are given, this class of problems just finds the minimum index of the epochs for transmission. The second class of the problem assumes that the completion time is taken at a time point which is continuously located in the interval [0, T ], as a continuous straight segment.

4.4.1

Discrete Transmission Completion Time Minimization

The discrete transmission completion time minimization problem can be stated as follows: assume N to be a positive integer and N  K , noting that the two notations N and Nt stand for the different meanings that the former is the index of an epoch; but the latter is the number of the

55

antennas equipped by a user. The problem can be written as min{{si }NNt ,N } N
i=1

subject to:

N Nt i=1

wi log(1 + ai si ) = B ;

(4.17)

0  si , i;
lNt i=1

si 

l i=1

Ein (i), l = 1 . . . , K.

We use the RGWFM machinery to design a recursive algorithm to solve (4.17), referred to as RGWFMn. The steps of the RGWFMn is presented in the algorithm description shown below. Compared with the steps of RGWFM, in the first line of the algorithm, RGWFMn introduces B as a parameter while others being kept unchanged. In Line 6, RGWFMn sequentially processes from the second epoch to the K th epoch to output the optimal value N  and its optimal solution: RGWFM(N  ) with the target rate: B bits. Similarly, the inner "For" loop updates power levels for the current processing epoch (L) and its previous (L - n + 1) epochs to form a processing window. GWF algorithm is also applied to this window to find a common water level. Note that a new "If" clause is inserted into the outer level "If" clause (for the water level non-decreasing condition check). The function of this inner "If" clause is to check whether and how the transmitted bits reach B . Therefore, it is the normal exit of the algorithm (lines 19-20). For convenience, the condition of this new "If" clause is called the criterion of RGWFMn. This is also due to the importance of the criterion in the following proposition. As a note, truth of Line 4 is easily to test. Also, Line 4 of RGWFMn provided a solution but this solution is not unique. However, this proposed solution uses the least power to guarantee the rate requirement (= B ). As a note, however, the mentioned algorithm of RGWFM(K) can output the unique optimal solution to problem (4.5), since the objective function of problem (4.5) has a negative definite Hessian matrix. To guarantee optimality of RGWFMn, the proposition is stated as follows: Proposition 4.2. If there does not exist L such that the criterion in RGWFMn:

(n-1)Nt i=1

wi log (1 + ai si ) +

LNt i=(n-1)Nt +1

wi log (1 + ai s i)  B

(4.18)

holds, where the symbols in (4.18) keep the same meaning as those in the statement of RGWFMn, then there is no solution to problem (4.17). If the criterion holds, then the obtained N  is the

56

Algorithm 4 Algorithm RGWFMn, Based on RGWFM
Nt t 1. Initialize: L = 1, Nt , K, Ein (1), {wk }N k =1 , {ak }k =1 , B ; 2. Output the result for epoch 1: RGWFM(1) = GWF(1, Nt , {wi }, {ai }, Ein (1))|I Nt = {s k }k =1 ; t  3. If N i=1 wi log (1 + ai si )  B, N t 4. {s i }i=1 = GWF(1, Nt , {wi }, {ai }, P1 ),

where P1 =

 k1 1 i=1 [ ak ( 1

k -1 ai  = max {k | k1 , 1  k  Nt }, i=1 ( ak ) < 2 N  = 1, and then exit the algorithm; 5. End If 6. For L = 2 : 1 : K , t 7. Input:{Ein (L), {w(L-1)Nt +j , a(L-1)Nt +j }N j =1 };

B 2 w1  -1 k1 ai i=1 ( a  k 1 B w1

)

) k1 -

1 

1 ai ],

8. {sk }k=1 t = RGWFM(L - 1); 9. For n = L : -1 : 1, LNt t 10. W = {wj }LN j =(n-1)Nt +1 ; A = {aj }j =(n-1)Nt +1 ; 11. 12. 13. 14. 15. 16. 17. 18. 19. 20. 21. 22. 23. 24. 25.
(L-1)Nt j =(n-1)Nt +1 sj LNt  {{sk }k=(n-1)Nt +1 , k }

(L-1)N

ST =

+ Ein (L);

= GWF((n - 1)Nt + 1, LNt , W, A, ST );  = max{k |s > 0, 1  k  (n - 1)N }; ke t k If
1 ak wk s

e k +s  ak 1 + wk , w ke e w ke k RGWFM(L) =  {s1 , . . . , s(n-1)Nt , s (n-1)Nt +1 , . . . , sLNt },

If

RGWFM(L) = (n-1)N LNt {si }i=1 t  {s j }j =(n-1)Nt +1 , N  = L, and then exit the algorithm; End If Move to next epoch, i.e., go to Line 25; End If End For End For

(n-1)Nt wi log (1 + ai si )+ i=1 LNt  i=(n-1)Nt +1 wi log (1 + ai si )  B, (n-1)N B1 = B - i=1 t wi log (1 + ai si )- (L-1)Nt  i=(n-1)Nt +1 wi log (1 + ai si ), LNt {s i }i=(L-1)Nt +1 can be obtained, similar

to Line 4,

57

optimal value and the {RGWFM(N  ), N  } is the exact optimal solution. Proof of Proposition 4.2. For the given B , if there does not exist L and n such that the criterion in RGWFMn,

(n-1)Nt i=1

wi log (1 + ai si ) +

LNt i=(n-1)Nt +1

wi log (1 + ai s i )  B,

(4.19)

holds, it implies that the optimal value of problem (4.5) is strictly less than B , corresponding to Proposition 4.1. Thus, the first constraint in problem (4.17) never holds. Then there is no solution to problem (4.17). Then, assume that there exist N  and RGWFM(N  ) such that
(n-1)Nt i=1 N  Nt i=(n-1)Nt +1

wi log (1 + ai si ) +

wi log (1 + ai s i )  B,

(4.20)

where
 RGWFM(N  ) = {s1 , . . . , s(n-1)Nt , s (n-1)Nt +1 , . . . , sN  Nt }.

(4.21)

According to the obtained N  from the RGWFMn algorithm, the optimal value of the problem min{si }NNt
i=1

N Nt i=1

-wi log(1 + ai si ) (4.22)
lNt i=1

subject to:

0  si , i;
lNt i=1

si 

Ein (i) for l = 1, . . . , N,

is less than B , where RGWFM(N ) is the optimal solution to this problem, for N = 1, . . . , N  - 1. Hence, the optimal value of problem (4.17) is not less than N  . Stemming from the statement of RGWFMn, RGWFM(N  ) is a feasible solution to problem (4.17) and N  is the evaluated objective value of problem (4.17) at RGWFM(N  ). Thus, N  is a feasible value. Together with the mentioned fact that the optimal value of problem (4.17) is not less than N  , as a result, N  is the optimal value and {RGWFM(N  ), N  } is the exact optimal solution to problem (4.17). Therefore, Proposition 4.2 is proved. Note that for the first constraint in (4.17), if the powers make the weighted sum-rate greater than the target B , we may reduce the powers to make the weighted sum-rate equal to B . The reduced powers is just a feasible solution and the sum power becomes less. This result comes from

58

min{{si }NNt ,t} t i=1 subject to: 1  N  K and N  Z; N1 (t) = max{N | N k =1 Lk  t}; N1 Nt l=1 j =1 w(l-1)Nt +j · log(1 + a(l-1)Nt +j · s(l-1)Nt +j )+ Nt t 1 (2 - N k =1 wk ) · j =1 log(1 + a(N1 -1)Nt +j s(N1 -1)Nt +j ) = B ; 0  si , i; 0  t  T ; lNt l i=1 Ein (i), l = 1 . . . , K. i=1 si 

(4.23)

continuity of the throughput or rate constraint function and rest of the constraints. Therefore, the problem that substitutes the inequality of "" for the equality of "=" in the first constraint, has the same optimal solution set.

4.4.2

Continuous Transmission Completion Time Minimization

The continuous transmission completion time minimization problem can be stated as follows: assume t to be a real number and N to denote the index variable of the sequence, consisting of the ends for the progressive epochs, Z to denote the set of integers, and then the corresponding objective function is shown as in (4.23) given in next page. Note the mentioned wi =
Li , i. 2

If Lebesgue-Stieltjes integration [11] is used for problem (4.23), it can make the expression concise. The presented method is used to avoid introducing more abstract mathematical expressions. We use the proposed RGWFMn to design a recursive algorithm to solve the continuous transmission completion time minimization problem (4.23), referred to as RGWFMt. The steps of the RGWFMt are stated below: RGWFMt only replaces Line 18 and the N  = L of Line 20 of RGWFMn with the statement: t = and the statements: N  = L, t = t +
N  -1 k =1
Nt j =1

2B1 , log(1+a(N  -1)Nt +j s(N  -1)Nt +j )

(4.24)

Lk ,

(4.25)

respectively. The optimality proof of RGWFMt can be proven, similarly to that of RGWFMn: Proposition 4.2. Therefore, its proof is ignored in this chapter.

59

4.5

Extension to a Hybrid System Coexisting with Grid Power

Since energy harvesting depends on natural condition and it is a random process, the energy from power grid is often added as a supplementary source. The corresponding maximum throughput problem of such a hybrid system can be stated as - min{Si ,SG,i }K i=1 subject to: Si SG,i
K i=1

wi log |I + H i (Si + SG,i )Hi |

0, i; 0, i; 
l k =1 Ein (k ), l ;

(4.26)

l k =1 Tr(Sk )

K k =1 Tr(SG,k )

 E(G,total) ,

where SG,k , k, is the power from power grid, and E(G,total) is the total energy from power grid. To easily understand the essence and the proof of this extension and avoid more subscripts being used, without loss of generality, let Nt = 1 in this section. For problem (4.26), We add a statement ak , E(G,total) |I 1 + ak s H,k

K { s G,k }k =1 = GWF 1, K, W,

(4.27)

at the end of RGWFM for grid power allocation. We refer to this as RGWFMH. RGWFMH implies that for this hybrid system, harvested energy is first allocated as in the algorithm RGWFM. The results from RGWFM defines the new water tank bottom. The total available grid power is then allocated again with water-filling algorithm. Optimality of RGWFMH is stated and proven by the following proposition. Proposition 4.3. RGWFMH can compute the optimal exact solution to the problem (4.26) within finite loops. Proof of Proposition 4.3. Similar to the transformation from (4.4) to (4.5), problem (4.26) has its real representation or problem. For clarity, {sH,i } denotes the powers from energy harvesting and {sG,i } from power grid. According to Proposition 4.1, for the real form of problem (4.26) under E(G,total) = 0, there

60

K exist the optimal solution {sH,i }K i=1 and the dual variables {i , i }i=1 satisfy the following KKT

conditions:

  K 1  sH,i =  1 k =i k - i , i;  +  ai wi wi      s = 0, s  0,   0, i; i H,i H,i i  l   l ( l  k =1 sH,k - k =1 Ein (k )) = 0,      l sH,k  l Ein (k ), l  0, l. k =1 k =1

(4.28)

We define the index set 1 as follows: 1 = {i|sH,i > 0} = {it |1  i1 < i2 < . . . < it1  K }.

(4.29)

Expression (4.29) combined with RGWFM(K), implies that sH,ik+1 sH,ik 1 1 +  + , aik wik w ik aik+1 wik+1 wik+1

(4.30)

for any {ik , ik+1 }  1 . Note that optimal solution satisfies the mentioned inequalities (4.30), but only some variables which meet these inequalities cannot guarantee themselves to be (the part of) the optimal solution. Let
ak  {{sG,k }K k =1 , k } = GWF(1, K, W, { 1+ak S  }, E(G,total) ).
H,k

(4.31)

It is seen that sH,it sG,it 1 sG,k sG,k 1 + + = + + , ait wit w it w it ak wk wk  wk  for any {k  , it }  1 , where 1  it  k  , t. Let it = 0, as it  1 ;  = {k  }. Also, j = and  j =
1
1 aj wj 1 ak wk

(4.32)

+

+

sH,k wk

1

+

sG,k wk

; and k =  and l = 0, as l  {1, 2, . . . , K } \

k  -
+
sG,j wj

1 aj wj

1 sH,j + w +
j

, as j  {1, 2, . . . , K } \ 1 . In addition,  it = 0, as it  1 ;

+

K Therefore, the {sH,i , sG,i }K i=1 mentioned above and the constructed dual variables {i , i }i=1 and

sH,j wj

-

, as j  {1, 2, . . . , K } \ 1 .

{,  1 , . . . ,  K } satisfy the KKT conditions of the real form of problem (4.26), the Lagrange function

61

of which is:
K L({sH,i , sG,i }K i=1 ; {i , i }i=1 , {,  1 , . . . ,  K })

=- + -

K i=1 K l=1 K i=1

wi log(1 + ai (sH,i + sG,i )) -
l k =1 sH,k

K i=1

i sH,i

l (

-

l k =1

(4.33)

Ein (k ))

i sG,i + (

K k =1 sG,k

- E(G,total) ).

In addition, by observation, the general constraint qualification of problem (4.26) holds. Then {sH,i , sG,i }K i=1 computed by the proposed RGWFMH is the optimal solution to problem (4.26). Therefore, Proposition 4.3 is proved. As a remark, we should emphasize two points: (1) RGWFMH is actually a block coordinate ascent algorithm (BCAA, to find maximum) ([2]). BCAA is only guaranteed to be infinite iterations to find an optimal solution to the proposed problem. However, we further exploit the structure of the proposed problem and then the proposed RGWFMH is designed. Further, RGWFMH just uses one time iteration and rapidly obtains the optimal solution; (2) we may treat E(G,total) to be the harvested energy at the starting of the first epoch and can obtain the equivalent solution, but we cannot obtain or distinguish the optimal power allocation from the two different energy sources. With the implementation of RGWFMH, this problem can be solved efficiently.

4.6

Numerical Examples and Computational Complexity

This section consists of two subsections: numerical examples and computational complexity analysis. The former subsection firstly uses one simple example to clearly illustrate the procedures of the proposed algorithms. Then two more complicated examples to compare with the primal-dual interior point method (PD-IPM) which is now regarded as an efficient optimization algorithm with great promise ([6] and references therein). The latter subsection discusses computational complexity of the proposed algorithms, and arrives at the conclusion of polynomial complexity ([38]). Due to exploiting the structure of the proposed problems, the proposed algorithms show significant efficiency.

4.6.1

Numerical Examples

The proposed algorithms scan the epochs sequentially to obtain the optimal power allocation.

62

Example 1. we assume that there are three epochs, each with unit length (Li = 1, i = 1, 2, 3) , i = 1, 2, 3). To clearly account for the procedures of the proposed and the same unit weight (wi = 1 2 algorithms, no power grid case is considered without loss of essence. Let Nt = Nr = 2. At the beginning of each epoch, the energy is harvested as Ein (i) = 2, i = 1, 2, 3. The information required for transmission is B = 3 bits. Suppose the fading profile for the three epochs is H1 =
1  2









 1 -1   1 -1    , H2 =   and 1 1 1 1     1 -1  H3 = 2  . 1 1

(4.34)

First, RGWFM(1) outputs {s1 = 1, s2 = 1}, i.e., the allocated power sum is Tr(S1 ) = 2 to epoch 1, as shown in Fig. 4.1(a). The height of the blue (darker) stair bars denotes the reciprocals of the fading gains, i.e., the height of the steps for water-filling [19]. The allocated powers are illustrated by the height of the green (grey) bars. Along the axis of "Index of epoch", the index of epochs increases from left to right. Then the process moves to the second epoch. By applying GWF(2,2), it gives {s3 = 1, s4 = 1}. Now check the water level of epoch 2 is 1+1/2=1.5 and the water level for epoch 1 is 1+1=2. Water level non-decreasing condition is violated. Power level adjustment procedure is triggered. By applying GWF to the first two epochs, we have GWF(1,2)={s1 = 0.75, s2 = 0.75; s3 = 1.25, s4 = 1.25}. With this power adjustment, the output for RGWFM(2) is then {s1 = 0.75, s2 = 0.75; s3 = 1.25, s4 = 1.25}, i.e., Tr(S1 ) = 1.5 and Tr(S2 ) = 2.5, as shown in Fig. 4.1(b). Now the process moves to epoch 3, the output of GWF(3,3)= {s5 = 1, s6 = 1}. The correspond, which is lower than that of the previous epoch (=1.75). Then ing water level for epoch 3 is 1 + 1 4 the power adjustment is triggered. After twice power adjustment operations, the final output is {s1 = 7/12, s2 = 7/12; s3 = 13/12, s4 = 13/12; s5 = 4/3, s6 = 4/3}, which is the completed output for the optimal solution, i.e., Tr(S1 ) = 14/12, Tr(S2 ) = 26/12 and Tr(S3 ) = 8/3, as shown in Fig. 4.1(c). In this example, the channel states (fading gains) for the three epochs are continuously improving. Therefore, the harvested energy at the beginning of each epoch tries to flow to the later epochs, leading to the uniform water level of these three epochs. In addition, if Nt = Nr = 1, 63

the power gains are reduced into hi = 2i-1 , i = 1, 2, 3, it can be calculated that the maximum transmission throughput is 3 log (31/6). However, if Nt = Nr = 2, the maximum transmission throughput is 2 log (8 · (19/12)3 ). Thus, the throughput ratio of the MIMO case to the SISO case (8·(19/12) 3 ) . = 1.40 by adding one more antenna at both the transmitter and the receiver. is 2·log 3·log (31/6) Let us compute the solutions to two types of the minimum transmission completion time problems. For the final result over the entire process, the optimal solution is {{s1 = 7/12, s2 = 7/12; s3 =
2 2   13/12, s4 = 13/12; s 5 = log (4 · (12/19) ), s6 = log (4 · (12/19) )}, N = 3} and the optimal value is

N  = 3, i.e., the allocated power is Tr(S3 ) = 2 log (4 · (12/19)2 ) to epoch 3, as shown in Fig. 4.1(d). For continuous solution t, we obtain a different solution using RGWFMt: {s1 = 7/12, s2 =
 7/12; s3 = 13/12, s4 = 13/12; s 5 = 4/3, s6 = 4/3}, and

t = 2 +

Nt j =1

2B1 log (1+a(N  -1)Nt +j s(N  -1)Nt +j )
2

(4·(12/19) ) = 2 + log log (1+4·4/3) . = 2.25.

(4.35)

(a) 2 1 0 1 Index of antenna 2 1 0 1 Index of antenna 2 Index of epoch 2 (c) Index of epoch 2 1 0 1 Index of antenna 2 1 0 1 Index of antenna 2 2

(b)

Index of epoch (d)

Index of epoch

Figure 4.1: Procedures to solve Example 2: (a) Tr(S1 ) = 2; (b) Tr(S1 ) = 3 , Tr(S2 ) = 5 ; (c) 2 2 26 8 7 . 26 . Tr(S1 ) = 14 = 1 . 17 , Tr( S = 2 . 17 , Tr( S , Tr( S ) = , Tr( S ) = ; (d) Tr( S ) = ) = 2 3 1 2 3) = 12 12 3 6 12 12 2 . 2 log (4 · ( 19 ) ) = 1.35. Through this simple example, the computation procedures and the effectiveness of the proposed algorithms are well demonstrated. The following general example further reveals the effectiveness of the proposed algorithms. Example 2. The well known optimization algorithm, the primal-dual interior point method 64

(PD-IPM), is chosen for comparison purpose due to its competitiveness in computing the solutions to the convex optimization problems. The proposed minimum transmission completion time problems are non-convex mixed integer optimization problems. As far as the authors' knowledge, there is no algorithm reported in the open literature which can compute the exact solutions to the target problems. As a result, we only focus on the throughput maximization problem. Figs. 4.2-4.4 are used to show the difference between PD-IPM and RGWFMH for the maximum throughput problems, through some choices of the number of antennas (Nt ) at the user or the number of epochs (K ). In calculation, the number of antennas at base station (Nr ) is set to be 4. Channel gains are generated randomly using random Nr × Nt matrices with each entry drawn independently from the standard Gaussian distribution. {Ein (k )} is the set of randomly chosen positive numbers. The sum power constraint of the power grid E(G,total) is 5. A group of different weights are also generated randomly. The chosen parameters mentioned above are assigned to both algorithms with the identical values for comparability. In these figures, the circle markers and the cross markers represent the results of the proposed RGWFMH and PD-IPM respectively. For the proposed RGWFMH, since it uses recursion, no iteration is invoked. Therefore, the number of iterations of the circles maps to one iteration. The obtained throughput is summarized in the following table. The obtained throughput for PD-IPM is the result after 100 iterations.

K=10;Nt=1;Nr=4 10 9 10 8 12

K=15;Nt=1;Nr=4

Value of Sum Rate (bits)

7 6 5 4 3 PD-IPM RGWFMH(Proposed)

Value of Sum Rate (bits)

8 PD-IPM RGWFMH(Proposed) 6

4

2 2 1 0

0

50 Number of Iterations

100

0

50 Number of Iterations

100

Figure 4.2: Weighted sum-rates (Unit: bits) of RGWFMH and PD-IPM, as K=10 and 15

With different parameters, the achieved throughput ratio of the PD-IPM to that of RGWFMH is in the range of 0.33 to 0.49. These results show that the proposed RGWFMH exhibits much better performance. It also shows that as the number of the antennas increases, the throughput or 65

K=10;Nt=2;Nr=4 18 22 20 18

K=15;Nt=2;Nr=4

16

Value of Sum Rate (bits)

Value of Sum Rate (bits)

14 PD-IPM RGWFMH(Proposed)

16 14 12 10 8 PD-IPM RGWFMH(Proposed)

12

10

8

6

6 4

4

0

50 Number of Iterations

100

0

50 Number of Iterations

100

Figure 4.3: Weighted sum-rates (Unit: bits) of RGWFMH and PD-IPM, as K=10 and 15

K=10;Nt=4;Nr=4 22 24 22 20

K=15;Nt=4;Nr=4

20

Value of Sum Rate (bits)

Value of Sum Rate (bits)

18 PD-IPM RGWFMH(Proposed)

18 16 14 12 10 PD-IPM RGWFMH(Proposed)

16

14

12

10

8 6

8

0

50 Number of Iterations

100

0

50 Number of Iterations

100

Figure 4.4: Weighted sum-rates (Unit: bits) of RGWFMH and PD-IPM, as K=10 and 15

66

Table 4.1: Comparison of the achieved throughput (Nr = 4) parameter PD-IPM RGWFMH ratio K = 10, Nt = 1 3.67 9.15 0.40 K = 15, Nt = 1 3.84 11.36 0.34 K = 10, Nt = 2 7.11 17.77 0.40 K = 15, Nt = 2 6.91 20.79 0.33 K = 10, Nt = 4 10.11 20.76 0.49 K = 15, Nt = 4 9.32 22.95 0.41

the weighted sum-rate increases. Example 3. For ease to follow the simulation results, a deterministic example is given. The parameters are chosen as: assume there are five epochs with weight factor vector W = {0.1633, 0.2132, 0.2282, 0.2035, 0.1918}, Ein (i) = 6, i, E(G,total) = 5, the channel gain matrices of the two by two antenna array are randomly generated as
 H1 =  = H2  = H3  = H4  = H5 -0.2056 + 0.1700i 0.2236 + 0.2518i 0.3851 - 0.2639i -0.1068 - 0.1593i 0.2877 + 0.5690i -0.2702 - 0.5321i -0.2851 - 0.5181i 0.1038 - 0.4797i -0.7143 - 0.6832i 0.2136 - 0.5346i -0.3895 - 0.6354i 1.5094 - 1.0604i 1.6777 + 0.3762i -0.3660 - 0.9417i 0.5789 + 0.8900i -0.2975 - 0.5033i 0.3035 - 0.1812i 0.4999 - 0.4366i -0.1870 - 0.7028i 0.2199 - 1.1445i

; ; ; ; . (4.36)

The optimal power allocation of the harvested energy is:

{4.6740, 6.1910, 6.4261, 5.1950, 7.5139},

the ith member of which corresponds to the ith epoch. Similarly, the optimal power allocation of the grid power is: {0.6851, 0.8944, 0.9574, 0.8538, 1.6094}. The throughput is illustrated in Figure 4.5. It is seen that the achieved throughput of the proposed algorithm is 9.2, but the corresponding value of PD-IPM is 4.1, which reflects an almost 1.2 times gain in the achieved throughput.

67

K=5;Nt=2;Nr=2 10 9 8 PD-IPM RGWFMH(Proposed)

Value of Sum Rate (bits)

7 6 5 4 3 2

0

20

40 60 Number of Iterations

80

100

Figure 4.5: Weighted sum-rates (Unit: bits) of RGWFMH and PD-IPM, as K=5

4.6.2

Computational Complexity Analysis

Since the proposed algorithms use the proposed real throughput mathematical representation by the unitary similarity matrix transformation, the proposed algorithms need the unitary similarity matrix transformation with computational complexity K × O (Nt3 ) (refer to [38]) for (4.5). Second, to compute the optimal solution, RGWFMH, as a more general case than RGWFM, utilizes GWF
K L=1 (1

+ L)L/2 + 1 times, so it needs

K L=1

L k =1 (8Nt k

+ 3) + 8Nt K + 3 = 4Nt K [K 2 + 3K +

8]/3 + 3K (K + 1)/2 + 3, i.e., Nt O (K 3 ) fundamental operations (refer to [19]). Because a valid algorithm needs to apply the proposed real throughput mathematical representation to avoid the differentiability problem from the several complex optimization variables, therefore, the comparison only focuses on the computational complexity led by the computation of the optimal solution. The complexity of RGWFMH is rather low Nt O (K 3 ). For example, even let PD-IPM use the proposed transform to obtain an equivalent real problem, however, for the solution, i.e., not the optimal

solution, it still needs a polynomial computational complexity: Nt3.5 O (K 3.5 ) log(1/ ) (refer to [55], [7]). Hence, PD-IPM cannot guarantee to output the optimal solution by finite computation. Our method eliminates any linear search but output the exact optimal solution with finite computation. Note that the difference between iteration and recursion. The linear search is often computation demanding. This is one weakness of PD-IPM. When the feasible set has the sharp boundary where optimal point(s) is located and the objective function is non-linear, this weakness appears to be more remarkable.

68

Simply speaking, RGWFMH needs total K × O (Nt3 ) + Nt O (K 3) basic operations to compute the exact solution, while PD-IPM needs total K × O (Nt3 ) + Nt3.5 O (K 3.5) log(1/ ) basic operations to compute an solution.

69

Chapter 5 Exact Solution of Non-Commutative Composite Water-Fillings for EH and Smart Power Grid Coexisting System with Peak Power Constraints
Energy harvesting makes use of energy from the environment. However, since harvesting energy depends on natural conditions, it is not a stable energy source. As a result, the energy from power grid is often included to serve as a supplementary source to regulate the overall energy supply of the system. Further, the powers from the power grid are often subject to the constraints of peak powers and the energy budget. These constraints render solving the optimal power allocation problems more difficult. In this chapter, we extend our recently proposed geometric water-filling (GWF) and recursive geometric water-filling (RGWF) algorithms to solve the throughput maximization problem and transmission completion time minimization problems, i.e., to make the power grid smart. Importantly, it can compute the exact (optimal) solutions to the problems via finite computation with lower computational complexity, compared with others. This point also lays down a solid fundamental basis for real-time and dynamical resource allocation. Beside more strict discussion of optimality for the proposed algorithms, numerical examples are presented to illustrate the detailed procedures to efficiently obtain the optimal power allocation by the proposed algorithms. The numerical example also shows the composite operation of the two water-fillings is non-commutative.

70

5.1

Introduction

Often, the powers from the power grid are subject to the constraints of peak powers and the energy budget. These constraints render solving the optimal power allocation problems more difficult. According to our best knowledge, there is no publication to handle them. Without more explanation, in fact, the constraint, which seems to be a trivial case, of an optimization problem just brings a significant watershed from classical to modern optimization. Although the presented throughput maximization problem, as one of three presented problems, is a convex optimization problem, our algorithm shows much more efficient computation than others, including the well-known efficient primal-dual interior point method (PD-IPM) ([7] and references therein). This advantage is especially leaning forwards to the dynamic optimal power resource allocation of wireless communications. For the other two non-convex optimization problems, this advantage is still kept. In this chapter, GWFPP in [19] to solve the problems with peak power constraints, is utilized. In detail, GWFPP and RGWF [20] are applied to form the two step distribution and the one step adjustment with condition to obtain the optimal solution of the hybrid system for maximizing system throughput. GWFPP and RGWF are all derived from our GWF. Also, it is shown that these two water-filling steps are not commutative. Then the algorithm is developed to solve the transmission completion time minimization problem. Both discrete time case (to find the index n of the epoch to complete the transmission) and the continuous time case (to find time t to complete the transmission) are investigated. By checking if the target B bits transmission is completed, the algorithms are constructed and the optimality proof is provided. Note only for the simpler transmission completion time minimization problem without the consideration of power grid and its peak power constraints, [35] offered the scheme, not a detailed algorithm. Since the proposed optimal power allocation policy mainly results from the recursive computing epoch by epoch, it does not always need the information/solution of the entire process to solve the minimum transmission completion time problem. This is a distinct feature of the proposed algorithms compared to the algorithms reported in the open literature. Note that, according to the definition of online algorithms ([1, p. 1430]), RGWF in the proposed algorithms possess some characteristics of the online algorithms. This is because the family of RGWF is defined by recursion, without extrapolation; and its input and computation choose the way of piece-by-piece information in a serial fashion. Furthermore, since the powers from the power 71

grid are, in practice, subject to the peak power constraints, these constraints are considered with a more general form in this chapter. In the remaining of this chapter, the system model and the problem statement are presented in Section 5.2. Hybrid power allocation algorithm 1 (HPA1) for maximum throughput is investigated in Section 5.3. For minimum discrete or continuous transmission completion time problems, we can choose a similar approach, by the preceding two chapters, to handle them. Thus, solving such a class of the minimum time problems is not presented. Numerical examples and computational complexity discussion are presented in Section 5.4.

5.2

Problem Statement

In this section, the energy harvesting and the smart power grid coexisting system model in a fading channel is presented, followed by the optimization problem to maximize the throughput. For convenience and without loss of generality, the process is assumed to be a discrete time process, like the previous ones. Besides the harvested energy Ein (i), the transmission is also connected with the smart power grid. Let E(G,total) denote the energy budget of total energy supported by the power grid. Also, we assume that EG,i  0, as the peak power constraint from the power grid for the ith epoch, i. By interpreting the observed properties of the optimal harvested power allocation as a waterfilling scheme, Ein (i) units of water is filled into a rectangle container with bottom width
Li , i. 2

The last weighted power sum constraint from energy harvesting forms an equality. Furthermore, for unifying parameter notation, through a change of variables, we can obtain an equivalent target problem as follows: max{sH,i ,sG,i }K i=1 subject to:
K i=1

wi log (1 + ai (sH,i + sG,i ))

0  sH,i , i; 0  sG,i  EG,i , i;
l i=1 K i=1

(5.1)

sH,i 

l i=1

Ein (i), l;

sG,i  E(G,total) ,

where wi 

Li , ai 2



ai , Li

sH,i  Li sH,i , sG,i  Li sG,i and EG,i  Li EG,i , for any i. Note that the

symbol  is the assignment operator. Without consideration of trivial cases, E(G,total) > 0 can be

72

assumed. The second constraint remarkably increases difficulty to solve (5.1). To find the solution to problem (5.1), the conventional water-filling approach starts to obtain the Karush-Kuhn-Tucker (KKT) conditions of problem (5.1) as a set of optimality conditions, and then it solves the conditions to determine the variables {sH,i , sG,i } and their duals:  +  wi 1 1 i  s + s = - = w -a  H,i G,i K a + i   i i k k = i      for i = 1, . . . , K ;        0  sH,i , i;       0  sG,i  EG,i ,    i (sG,i - EG ) = 0, i  0, i;     l   l  0 , l ( l  i=1 sH,i - i=1 Ein (i)) = 0,     l l  1  l  K;  i=1 sH,i  i=1 Ein (i),       ( K   0,  i=1 sG,i - E(G,total) ) = 0,      K sG,i  E(G,total) , i=1
+

,

(5.2)

where the function (x)+ means (x)+ = x, for x  0, and (x)+ = 0, for x < 0. Furthermore, i is the dual variable corresponding to the constraint: sG,i  EG,i , for any i; l is the dual variable corresponding to the lth harvested power sum constraint, for any l; and  is the dual variable corresponding to the total power sum constraint from the smart power grid. However, by only observing or using the monotonicity information
K j =i

1

j

with respect to i in the first KKT

condition related to the sums of pairs {sH,i , sG,i }, i, it is not sufficient to obtain a solution. The set of {, {i }, {l }} or {, {i }, { to solve (5.2). The reciprocal of
K j =i K j =i

j }} needs to further satisfy other KKT conditions in order

j is called the water level at epoch i for the entire process

from epoch 1 to K. Thus, it is important information that the water level at epoch i depends on the duration of the process (e.g., the water level at epoch i is normally different for processes [1, K 1] and [1, K 2] where K 1 and K 2 are arbitrary ending epoch indexes). However, for system (5.2) in the original variables and the dual variables, there appears to be no existing method available in open literature to obtain an exact solution. The fact that the first equation in (5.2) is in the summation form sH,i + sG,i , renders determining an optimal allocation solution from the harvested energy {sH,i } and from the smart grid power {sH,i } separately, more difficult.

73

5.3

Hybrid Power Allocation Algorithm 1 (HPA1) for Maximum Throughput

Since the proposed algorithms are based on GWF and GWFPP, they are concisely introduced as follows. In [19], we presented a geometric water-filling (GWF) approach for solving generalized radio resource allocation problems. As an extension, let L and K be two positive integers and L  K denote the index of the starting channel and the ending channel, respectively. Then K - L + 1 is the total number of channels. Let P denote the total power for allocation. GWF can be regarded to as
K K a mapping from the point of parameters {L, K, {wi }K i=L , {ai }i=L , P } to the solution {si }i=L and the

important water level step index: k  . That is to say, it can be written as a formal expression [19]:
 K K {{si }K i=L , k } = GWF L, K, {wi }i=L , {ai }i=L , P .

(5.3)

Since we often only use the first part, {si }K i=L from GWF, we also write
K K { si } K i=L = GWF L, K, {wi }i=L , {ai }i=L , P |I .

(5.4)

Note that, for conciseness and without confusion from context, we may write the right hand side of the expression as GWF(L, K ) to emphasize time stages from L to K . Let P i denote the peak power constraint for the ith channel, GWFPP can be expressed as [19]
K { si } K i=1 = GWFPP 1, K, {wi , ai , P i }i=1 , P |I ,

(5.5)

E = GWFPP 1, K, {wi, ai , P i }K i=1 , P |II , where E is the final index set in which, there is no peak power constraint correspondingly, referring to [19]. Further, for convenience, E may be written as {it |1 < i1 < · · · < i|E |  K } where |E | is the cardinality of the set E . Thus,

K {{si }K i=1 , E } = GWFPP 1, K, {wi , ai , P i }i=1 , P .

74

Without confusion, GWFPP 1, K, {wi, ai , P i }K i=1 , P |I can be regarded to as GWFPP 1, K, {wi , ai , P i }K i=1 , P , due to a subordinate state of the final index set E . In this section, we propose a novel algorithm to solve problem (5.1) using GWF approach. The last three constraints in (5.1) can be expanded into a matrix form and two scalar inequality forms, respectively, as follows:               
          1    1 1     · · ·    1 1 1  sH,1 sH,2 . . . sH,K                .  .  . 
1 i=1 Ein (i) 2 i=1 Ein (i)

     ,   

     0      

K i=1 Ein (i)

sG,i

EG,i , for i = 1, . . . , K, E(G,total) ,

sG,1 + · · · + sG,K

where the empty elements inside the matrix denote zeros. The above coefficient matrix form a triangle matrix for the variable {sH,i }K i=1 . The proposed algorithm to solve (5.1) is referred to as the hybrid power allocation algorithm 1 (HPA1). The proposed HPA1(K) is stated by pseudocode, attached at the end of this chapter. In the remaining of this section, algorithm description and optimality analysis will be presented.

5.3.1

Two parts of HPA1(K) and Their Non-Commutativity

The proposed HPA1(K ) consists of two parts: HPA1(K )|I for smart grid power allocation as
K { s G,k }k =1 = HPA1(K )|I

(5.6)

and HPA1(K)|II for harvested energy power allocation portion as
K { s H,k }k =1 = HPA1(K )|II .

(5.7)

From the definition of HPA1(K), it is seen that HPA1(K)|I is Algorithm GWFPP. GWFPP is used twice in the proposed algorithm: HPA1(K), and then the final index set E also appears 75

twice. To distinguish between the two E s, the first E is also denoted by E (1) and, i1 in E (1) by i1 (1). Similarly, we also have E (2) and i1 (2). In addition, HPA1(K)|II is Algorithm RGWF [20], in essence, with the only difference of the updated "step depths" or the updated channel gains. The implemented order for GWFPP and RGWF is: using GWFPP as HPA1(K)|I to compute the initial distribution of the powers from the power grid, then RGWF as HPA1(K)|II to compute the allocation of the powers from energy harvesting, and finally using GWFPP again, under the condition, to adjust the distributed powers from the power grid and then determine their allocation in the updated HPA1(K)|I . In this way mentioned above, the entire optimal solution to the proposed problem is obtained. Simply speaking, GWFPP is used twice; and between them, RGWF is used once. The following Lemmas are proposed to study the optimality of HPA1. Lemma 1. HPA1(K)|I can compute the optimal solution of problem (5.1) with finite loops, under
K i=1

Ein (i) = 0.

Since HPA1(K)|I is Algorithm GWFPP, which has been detailed by [19], the proof of Lemma 1 can be referred to Proposition 3.1 in [19]. Lemma 2. HPA1(K)|II can compute the optimal solution of problem (5.1) with finite loops, under E(G,total) = 0. Since HPA1(K)|II is Algorithm RGWF, which has been detailed by [20], the proof of Lemma 2 can be referred to Proposition 2 in [20]. It is seen that GWFPP and RGWF can be regarded as two functions in

{1, K, {wi , ai , EG,i , Ein (i)}K i=1 , EG,total }, respectively. If {1, K, {wi , EG,i , Ein (i)}K i=1 , E(G,total) } are kept unchanged except {ai }, GWFPP can be written as GWFPP({ai }) to emphasize the relationship of the function in {ai }, so can RGWF. Since these two functions are the set-valued ones, the k th evaluated value of the first function, GWFPP, is labelled as [GWFPP({ai })] |k , or simply [GWFPP] |k , so is that of the second function, RGWF. Two composite functions are defined as below. (RGWF  GWFPP) RGWF({ 76
1 ai

1 } ), + [GWFPP] |i

(5.8)

which refers the result by applying GWFPP to allocate the grid power first, followed by applying RGWF to allocate the harvested energy. Thus, using (RGWF  GWFPP) can output the powers, respectively from the energy harvesting and the power grid, earlier outputting the powers from the power grid and later the energy harvesting. The second composite function, HPAF, is defined as: 1 } ). + [RGWF] |i

HPAF = (GWFPP  RGWF)

GWFPP({

1 ai

(5.9)

Thus, HPAF|I = RGWF outputs the powers from the energy harvesting. HPAF|II = (GWFPP  RGWF) outputs the powers from the power grid. Thus, using HPAF can also output the powers, respectively from the energy harvesting and the power grid. However, the composite operation mentioned above does not satisfy the commutative law, i.e., (RGWF  GWFPP) = HPAF. This point is accounted for by the following example. Example 5.3.1. max{(sH,i ,sG,i)}2 i=1 subject to:
2 i=1

log (1 + (sH,i + sG,i )

sH,i  0, i = 1, 2; 0  sG,1  2; 0  sG,2  0.5;
l i=1 2 i=1

(5.10) l = 1, 2;

sH,i  l, sG,i  2.2.

According to the definitions of (RGWF  GWFPP) and HPAF, the output of (RGWF  GWFPP) is {sH,1 = 0.4, sH,2 = 1.6; sG,1 = 1.7, sG,2 = 0.5}, at which the objective function value is log 9.61; while that of HPAF is {sH,1 = 1, sH,2 = 1; sG,1 = 1.7, sG,2 = 0.5}, at which the objective function value is log 9.25. Thus, the performance of (RGWF  GWFPP) is truly better than that of HPAF due to log 9.61 > log 9.25. Then, the commutative law does not hold for this example. From this example, it is seen that the target problem cannot be decomposed into two decoupled sub-problems in the two classes of powers, respectively. Furthermore, HPAF, as the two water-fillings, RGWF and GWFPP successively being applied, cannot guarantee to find the optimal solution. In HPA1, in Line 3, GWFPP is applied to update the new step heights, which are formed by the original fading gains and the power levels allocated in HPA1(K)|I . From Line 4 to Line 22,

77

HPA1(K) computes the optimal solution for the harvested energy part, i.e., HPA1(K)|II to complete the computation. Note that based on GWFPP, the term (1/ai + sG,i )/wi denotes the overall step depth after the power allocation of the power grid. Therefore, the reciprocal of (1/ai + sG,i ) is ai /(1 + ai SG,i ), which is equivalent to the channel gain used by RGWF in [19]. The proposed algorithm eliminates the procedures to solve the non-linear system (5.2) in multiple variables and dual variables, provides exact solutions via finite computation steps, and offers helpful insights to the problems and the solutions.

5.3.2

Optimality of HPA1

This subsection discusses optimality of the proposed HPA1. Remark 1. HPA1|II is an optimal dynamic power distribution process. The dynamics of this recursive process are shown by the generalized state equation:

HPA1(L + 1)|II = [HPA1(L)|II , GWF(n + 1, L + 1)|I ], for L = 1, . . . , K - 1,

(5.11)

where n is the index of the starting epoch of the currently processing window. Note that the concept of dynamic processes is not identical to that of dynamic programming. The value of n is determined by HPA1(L)|II . In this process, HPA1(L)|II can be regarded as the generalized system state at the time stage (or epoch) L; GWF(n + 1, L + 1) can be regarded as the generalized system control at the time stage (or epoch) L; and then HPA1(L + 1)|II , as a state at the next time stage, can be derived or determined from its previous state and control. Due to optimality of HPA1(L)|II from Lemma 2, for any L, the proposed algorithm is indeed an optimal and efficient forwarding dynamic recursive water-filling algorithm. Then, since Lemma 2 guarantees optimality of HPA1(K )|II under the special condition, and so does Lemma 1, we may obtain the following conclusion of HPA1(K ). Proposition 5.1. HPA1 can compute the optimal exact solution to problem (5.1) within finite loops. Proof of Proposition 5.1. First, HPA1(K )|I is implemented. Thus, it is equivalent to Lemma 1 being used. According to Lemma 1, for problem (5.1) under
K i=1

Ein (i) = 0, there exist the

78

(1) K optimal solution {sG,i }K i=1 and the dual variables { , {i , i }i=1 } such that they satisfy the

(1)

(1)

following KKT conditions:  (1) (1)  1 (1)  + i - i , i; sG,i =   1  + ai wi wi     (1) (1)    s = 0, sG,i  0, i  0, i;   i G,i (1) (1) i (sG,i - EG,i ) = 0, sG,i  EG,i , i  0,     K  (1)   i=1 sG,i - E(G,total) = 0,       K s E , (1)  0.
i=1 G,i (G,total)

i;

Second, HPA1(K )|II is implemented. Thus, it is equivalent to Lemma 2 being used, however, with the updated "step depths"
1 ai wi

+

sG,i , wi

or the updated channel gains { 1+aaiisG,i }.
(2) (2)

According to Lemma 2 with the updated channel gains, for problem (5.1) under E(G,total) = 0,
K there exist the optimal solution {sH,i }K i=1 and the dual variables {i , i }i=1 such that they satisfy

the following KKT conditions:          
1

s +s 1 + H,iw G,i ai wi i

=

K k =i

k -  i ,
(2)

(2)

(2)

i;

i;  (2) i   i ( i  k =1 sG,k - k =1 Ein (k )) = 0,      i sG,k  i Ein (k ), (2)  0, i. i k =1 k =1 On the one hand, if E =  (the empty set), let G = 0; G,i =
(2) (2)
s +s 1 + H,iw G,i ai wi i

i sH,i = 0, sH,i  0, i  0,

(2)

1

 0 and G,i = 0, as

1  i  K . Also, let H,i = i , and H,i = i , for any i. Note that this set E mentioned above is obtained, when GWFPP is used at the first time. On the other hand, if E = , and i1  E such that
1 ai1 wi1 sH,i1 +sG,i1 wi1 1 aK wK sH,K +sG,K , wK 1 1

+



+

let G =

and G,i = 0, as sG,i > 0 or the case of both sG,i = 0 and EG,i = 0, under 1  i  K . Note that this set E just mentioned above is obtained, when GWFPP is still used at the first time. Further, if E = , then i1  E such that
1 ai1 wi1 sH,i1 +sG,i1 wi1 sH,k +sG,k , wk

1 ai wi 1 1

+

sH,i +sG,i 1 1 wi 1

; G,i =

s +s 1 + H,iw G,i ai wi i

- G  0;

+



1 ak wk

+

where sG,k > 0, 1  k  K .

Note that this set E just mentioned above is obtained, when GWFPP is used at the second time. It has been emphasized that to distinguish between the two E s, the first E is also denoted by E (1) and, i1 in E (1) by i1 (1). Similarly, we also have E (2) and i1 (2). Let G = G,i =
s +s 1 + H,iw G,i ai wi i 1 ai wi 1 1

+

1

- G  0; and G,i = 0, as sG,i > 0 or the case of both sG,i = 0 and EG,i = 0,

sH,i +sG,i 1 1 wi 1

1

;

79

under 1  i  K . Further, if sG,i = 0 and EG,i > 0, let G,i = 0; G,i = G -

G defined above. Also, it has been noted that the water level for each of the epochs in the set {i|1  i < i1 (1)} keeps unchanged, although the adjustment is done or GWFPP is used twice; difference between the water levels of epochs in the set {i|i1 (1)  i < i1 (2)} is decreased; and difference between the water levels of epochs in the set {i|i1 (2)  i  K } is leaning forward to the same. Thus, {H,i , H,i }K i=1 can be easily constructed, similar to those in [20] together with the just mentioned distinguishing characteristics. That is to say, according to the two sets of KKT conditions, the definitions, or assigned and constructed values of the dual variables: {{H,i , H,i , G,i , G,i }, G }, and the solutions {sH,i , sG,i }K i=1 mentioned above, it is seen that these dual variables and solutions also satisfy the following KKT conditions:   K 1   sH,i +sG,i = G + G,i - G,i = k =i H,k - H,i ,  1  + ai wi wi       i;       H,i sH,i = 0, 0  sH,i , H,i  0, i;          G,i sG,i = 0, 0  sG,i , G,i  0, i; G,i (sG,i - EG,i ) = 0, sG,i  EG,i , G,i  0, i;      l  H,l  0, H,l ( l  i=1 Ein (i)) = 0, i=1 sH,i -     l l   1  l  K;  i=1 Ein (i), i=1 sH,i        G ( K G  0 ,  i=1 sG,i - E(G,total) ) = 0,      K sG,i  E(G,total) , i=1 where this set of KKT conditions is of problem (5.1), the Lagrange function of which is: L ({sH,i , sG,i }; {H,i , H,i }, {G , {G,i , G,i }}) = - +
K i=1 K l=1 K i=1

s +s 1 + H,iw G,i ai wi i

1

 0 with

wi log(1 + ai (sH,i + sG,i )) + H,l
l k =1 sH,k K i=1

K i=1

H,i sH,i

-

l k =1

Ein (k )

G,i sG,i -
K i=1

G,i (sG,i - EG,i )

- G

sG,i - E(G,total) .

In addition, we can observe that the general constraint qualification of problem (5.1) holds. Then {sH,i , sG,i }K i=1 computed by the proposed HPA1 is the optimal solution to problem (5.1).

80

Therefore, Proposition 5.1 is proved. Therefore, we settled the points: (1) HPA1 can compute the optimal solution only from the causal information in finite steps. It does not need to solve any non-linear system, consisting of many equations and inequalities in multiple dual variables; (2) the relationship between HPA1|I and HPA1|II is determined; optimality of HPA1 stemming from HPA1|I and HPA1|II is revealed.

5.4

Numerical Example and Computational Complexity

HPA1 does not need to wait for the full information to be available but it can compute the exact optimal solution through finite computation for every sub-process that starts from epoch 1 and ends at epoch i, as i = 1, . . . , K . This point can also lean toward designing other efficient algorithms, such as algorithms to compute the minimum transmission completion time.

5.4.1

Numerical Example

Example 1. PD-IPM is chosen for the purpose of comparison due to its competitiveness in computing the solutions to the convex optimization problems. It has been known that the proposed minimum transmission completion time problems are non-convex and mixing continuous with integer variable optimization problems. As far as the authors' knowledge, there is no algorithm reported in the open literature which can compute the exact solutions to these problems. As a result, we only focus on the throughput maximization problem. Figs. 5.1-5.3 are used to show the difference between PD-IPM and HPA1 for the maximum throughput problems, through some choices of the number of epochs (K = 10, 15, 20). Channel gains are generated randomly using random variables with the standard Gaussian distribution. For convenience, {Ein (k ) = 6, k }. The sum power constraint of the power grid E(G,total) = K , and the peak power constraints {E(G,k) = k, k }. A group of different weights are also generated randomly. The chosen parameters mentioned above are assigned to both algorithms with the identical values for comparability. In these figures, the circle markers and the cross markers represent the results of the proposed HPA1 and PD-IPM respectively. For the proposed HPA1, since it uses recursion, no iteration is invoked. Therefore, the number of iterations of the circles maps to one iteration. The obtained throughput is summarized in the following table. The obtained throughput for PD-IPM

81

is the result after 100 iterations.
K=10 2 1.8 1.6 PD-IPM HPA1(Proposed)

Value of Sum Rate (bits)

1.4 1.2 1 0.8 0.6 0.4 0.2 0 0 20 40 60 Number of Iterations 80 100

Figure 5.1: Weighted sum-rates (Unit: bits) of HPA1 and PD-IPM, as K=10

K=15 2 1.8 1.6 PD-IPM HPA1(Proposed)

Value of Sum Rate (bits)

1.4 1.2 1 0.8 0.6 0.4 0.2 0 0 20 40 60 Number of Iterations 80 100

Figure 5.2: Weighted sum-rates (Unit: bits) of RGWFMH and PD-IPM, as 15

With different parameters, the achieved throughput ratio of the PD-IPM to that of HPA1 is in the range of 0.55 to 0.70. These results show that the proposed HPA1 exhibits much better performance. It also shows that as the number of the users increases, the throughput or the weighted sum-rate increases. As a supplement, for ease to follow the simulation results, a deterministic example is given. The parameters are chosen as: assume there are five epochs with weight factor vector W = (0.1633, 0.2132, 0.2282, 0.2035, 0.1918). Ein (k ), {E(G,k) , k }, and E(G,total) are assigned by the same

82

K=20 2 1.8 1.6 PD-IPM HPA1(Proposed)

Value of Sum Rate (bits)

1.4 1.2 1 0.8 0.6 0.4 0.2

0

20

40 60 Number of Iterations

80

100

Figure 5.3: Weighted sum-rates (Unit: bits) of RGWFMH and PD-IPM, as K=20

Table 5.1: Comparison of the achieved throughput parameter PD-IPM RGWFMH ratio K = 10 1.30 1.84 0.70 K = 15 1.19 1.86 0.63 K = 20 1.14 1.87 0.61 K = 25 1.09 1.87 0.58 K = 30 1.07 1.88 0.57 K = 35 1.04 1.88 0.55

values as the ones mentioned above. Further the channel gains are generated as (a1 , a2 , a3 , a4 , a5 ) = (0.2056 , 0.3851 , 0.2877 , 0.2851 , 0.7143 ). The optimal power allocation of the harvested energy is:
2 2 2 2 2

(5.12)

{0, 10.1359, 6.4885, 4.2572, 9.1185},

the ith member of which corresponds to the ith epoch. Similarly, the optimal power allocation of the grid power is: {0, 0.4705, 0, 0, 4.5295}.

83

5.4.2

Computational Complexity Analysis
K L=1 (1 + L)L/2

To compute the optimal solution, HPA1, utilizes GWF needs
K L=1 L k =1 (8k + 3)

times for RGWF(K), so it

= K (K + 1)(8K + 25)/6, i.e., O (K 3 ) fundamental operations for utilizing

GWF (refer to [19]). Due to HPA1 also using GWFPP two time, this usage needs 8K 2 + 14K fundamental operations (refer to [19]). Therefore, HPA1 needs K (K + 1)(8K + 25)/6 + 8K 2 + 14K , i.e., O (K 3 ) fundamental operations. Therefore, the complexity of HPA1 is rather low O (K 3 ). As a comparison, when PD-IPM being used can only obtain the solution, which is not the optimal

solution, it still needs a polynomial computational complexity: O (K 3.5 ) log(1/ ) (refer to [55, 7]). Hence, PD-IPM cannot guarantee to output the optimal solution by finite computation. Our method eliminates any linear search but output the exact optimal solution with finite computation. One weakness of PD-IPM is the linear search being used. When the feasible set has the sharp boundary where optimal point(s) is located and the objective function is non-linear, this weakness appears to be more remarkable. In addition, since PD-IPM requires efficiently compute the solution, assuming the LU decomposition to be used, to the linear system which is determined by the fact that the barrier function gradient is the difference between the objective function gradient and the linear combination of the constraint function gradients, and the perturbed complementarity condition,
2 (4K + 1)3 fundamental operations. Together applying Newton's method, it needs approximately 3

with evaluation of the coefficient matrix of the linear system and the computation burden of the linear search, PD-IPM requires an equivalent computational complexity, for each of iterations, to that used totally for HPA1. Simply speaking, HPA1 needs total O (K 3 ) basic operations to compute the exact solution, while PD-IPM needs total O (K 3.5 ) log(1/ ) basic operations to compute an solution.

84

Algorithm 5 Pseudocode for HPA1
1: Initialize: L = 1, K, E(G,total) , {wk , ak , P k = EG,k , Ein (k )}K k=1 ; 2: Prepare:
K K HPA1(K)|I = {{s G,k }k=1 , E } = GWFPP({ai }i=1 );

3: Update: { ak 
1 ak

1 }K k=1 ; +s G,k

4: Output the result for the epoch 1: RGWF(L) = Ein (1); 5: for L = 2 : 1 : K do 6: 7: 8: 9: 10: 11: 12: 13: 14: Input: {Ein (L), wL , aL) };
L -1 {sH,k }k =1 = RGWF(L - 1);

for n = L : -1 : 1 do
L W = {wj }L j =n ; A = { a j } j =n ; L -1 j =n sH,j

ST =

+ Ein (L);

 {{sH,k }L k=n , k } = GWF(n, L, W, A, ST );  ke = max{k |sH,k > 0, 1  k  n - 1};

if

1 ak wk

+

sH,k wk



1  wk ake e

+

 sH,ke  wke

then

output:
 RGWF(L) = {sH,1 , . . . , sH,n-1 , s H,n , . . . , sH,L },

15: 16: 17:

Move to the next epoch, i.e., go to Line 18; end if end for
sH,i1 +s G,i1 wi1 sH,K +s G,K , wK

18: end for 19: if E =  or 20:
1 ai1 wi1

+



1 aK wK

+

where sH,i is the the ith member of RGWF(K ) then

output of HPA1(K):
K { s G,k }k=1 = HPA1(K)|I = GWFPP from Line 2; K { s H,k }k=1 =HPA1(K)|II = RGWF(K );

21: end if
i1 -1 22: HPA1(K)|I = {{s G,k }k=1 , GWFPP({ i1 -1 HPA1(K)|II = {{s H,k }k=1 , RGWF({
1 ak wk

1 sH,k + w 1
k

}K k=i1 ); }K k=i1 ).

1 ak wk

+

([HPA1(K)]|I )k wk

85

Chapter 6 Using GWF to Solve A Class of Sum Power Minimization Problems
In this chapter, we first propose a generalized water-filling approach to solve the power allocation problem of minimizing sum power while meeting the target sum rate constraint with weights. Based on this sum power objective function, we extend the proposed method to more complicated RRM problems with more stringent constrains. The proposed algorithms with this generalized approach possess several distinguished features. They provide exact optimal solutions based on non-derivative methods, as the implementation of the proposed algorithms invokes neither the derivative nor the gradient. With geometric interpretation, the proposed algorithms provide more insights to and intuitions of the problems and could be used to efficiently solve a family of the sum power minimization problems. Optimality of the proposed algorithms is strictly proved. Numerical results that illustrate the steps and demonstrate efficiency of the proposed algorithms are presented.

6.1

Introduction

Transmit power and data rates are two fundamental radio resources. The required Quality of Service (QoS) can be satisfied by adjusting either power or rate or both in a complementary way. The optimal allocation of these scarce radio resources for different users/channels directly affects system performance. Therefore, for radio resource management (RRM) with different target and/or priorities, the problems or mathematical models may be formulated through maximizing the objective function of transmission throughput (or sum rate), subject to the sum power constraint; or 86

through minimizing the objective function of sum power, subject to the throughput constraint. In this chapter, we simply refer to the former problem as the original RRM problem, and the latter one as the (sum) power problem to distinguish itself from the original RRM problem.

6.1.1

Our Work for Sum Power Minimization Problem

In this chapter, a set of new problems are formed by changing the throughput of objective function, in the original RRM problem, into the sum power; while by changing the sum power constraint, in the original RRM problem, into the throughput constraint. At the same time, we will use the operator of minimization for this set of new problems. Thus, this set of new problems are readily distinguishable from the original RRM problems mentioned above. Correspondingly, this set of problems, with the objective functions having (sum) power forms, are referred to as PGWF, P-WFPP, P-WFGPP, and P-WFGBP respectively here. These problems have their practical applications. For example, when we consider different class of QoS services, the constraint of the different lower and upper bounds of the power allocation is reflected in our target problems. Without loss of clarity, we will use the same set of abbreviations to denote the problems and the algorithms that solve the corresponding problems. In this chapter, we significantly extend beyond earlier proposed approach [19] to solve the sum power RRM problems, including the basic form (P-GWF) and its extended and generalized forms. The stated generalized approach has a distinguished feature that the proposed algorithms start from geometric interpretations of the target problems. These geometric interpretations and the relationships they formed provide more insights into the problems; and such insights assist us to efficiently solve the target problems with optimal solutions. The proposed algorithms possess simple procedures due to the fact that the proposed algorithms belong to the non-derivative methods (which have been defined in [2]) that use neither the derivative nor the gradient during theirs implementation. The proposed algorithm P-GWF for the basic sum power problem has two advantages: it provides the exact solution, and thus eliminates the iterative steps of finding the water level through solving the non-linear system. On the other hand, the machinery of the proposed approach enabled us to solve the more generalized RRM problems with more stringent constraints. In our numerical examples, it is shown that with optimal power allocation for the generalized RRM problems, the water levels are different for the different constraints of lower and upper bounds. 87

The conventional approach of determining the water level(s) might not be able to solve this kind of generalized problems. The difference between our approach and those of others is summarized below. First, for the simple case of P-GWF problem that can be solved through the conventional approach, it is generalized into a weighted case in this chapter. Together, the corresponding algorithm with less computation is also proposed. Second, for the more complicated P-WFPP, P-WFGPP, and P-WFGBP cases, their solutions cannot be computed exactly by the conventional approach, but these (optimal) solutions can be computed exactly by our approach in this chapter. Third, for each of these problems, our approach only takes a low degree polynomial computational complexity for the exact solution, unlike the popular primal-dual interior point method (PD-IPM) that only computes an solution, which is not an optimal solution and requires more

computations (refer to [55, 7], and references therein). Fourth, for the mentioned problems of P-WFPP, P-WFGPP, and P-WFGBP, similar results have not been reported in the open literature, to the best of the authors' knowledge. For example, [19, 36] provided efficient algorithms for some RRM problems that have different structures, unlike the structure of these target problems in this chapter. The approaches discussed in [19, 36] cannot solve the target problems in this chapter. The proposed algorithms are novel and efficient. In the remaining of the chapter, the problem statement, the conventional approach, and the preparation or the illustration for the proposed P-GWF are discussed in Section 6.2. The extended and generalized sum power RRM problems with additional stringent constraints are further investigated in Section 6.3. Numerical examples and complexity analysis are presented in Section 6.4. We provide where the strict optimality proofs appear for the extended and generalized algorithms to compute the minimum sum power problems with more constraints, to meet some readers' requirement.

88

6.2
6.2.1

Generalized Water-Filling for Sum Power Problem
Problem Statement and Conventional Approach

The original basic RRM problem can be described by the following: given P > 0, which is the total power or volume of the water; the allocated power and the propagation path gain of the ith channel, which are denoted by si and ai respectively, i = 1 . . . K ; and K which is the total number of channels, letting {ai }K i=1 be a sorted sequence with monotonically decreasing (the indexes can be arbitrarily renumbered to satisfy this condition), in which ai > 0, i, find a group of the powers {si } to satisfy: max{si }K i=1 subject to:
1 2 K i=1 K i=1

log2 (1 + ai si )

(6.1)

si = P ; 0  si , i.

Extensive investigation to solve problem (6.1) has been reported in the open literature. Using a geometrical approach to solve this problem has been discussed in our earlier chapter [19]. The basic sum power RRM problem can be stated as: given B > 0, which denotes the number of the target transmission bits (or sum rate of the system), find a group of the powers {si } to satisfy: min{si }K i=1 subject to:
K i=1 si K 1 i=1 2

(6.2) log2 (1 + ai si ) = B ; 0  si , i.
1 2 K i=1

Note that if only the first constraint is substituted with

log2 (1 + ai si )  B , the new problem,

as a convex optimization problem, is equivalent to (6.2). Solving problem (6.2) is important, especially when saving energy/power is indeed the first priority of the system design. Problem (6.1) is to solve the throughput maximization problem; while problem (6.2) is to solve the sum power minimization problem. Generally, the solution to (6.1) can not be directly applied to (6.2). This chapter focuses on the investigation of the solution to (6.2) and its extended and more generalized forms. To find the solution to problem (6.2), conventional approach usually starts from the equivalent form of the Karush-Kuhn-Tucker (KKT) conditions of problem (6.2). This equivalent form is:    si =  -  
l

1 ai

+

, for i = 1, . . . , K ;
1lK } log2 (1 + ai si ) = 2B ;   0,

(6.3)

1 i{l|- a 0,

89

where (x)+ = max {0, x}.  is the water level chosen to satisfy the sum rate constraint with equality (1 2
K i=1

log2 (1 + ai si ) = B ).

Enumeration can be utilized to find the water level  in (6.3). This statement means that solving the equation in : log2 1 + ai  -
1 i{l|- a 0, l

1lk }

1 ai

= 2B,

(6.4)

can find the water level  in (6.3), where the index k runs up from 1 to K . Further, after the
1 index k only runs some steps that are not greater than K , due to { a } keeping monotonicity, the l

solution to (6.4) can be obtained. That is to say, we may use fewer steps to find . This algorithm or solution to (6.3) is referred to as the conventional sum power water-filling algorithm or solution, denoted by P-CWF. The detail can be furthermore referred to in [8]. Since P-CWF results from the motivation to solve the system directly, it is a non-geometric approach.

6.2.2

Illustration of the Proposed Generalized Water-Filling Algorithm (P-GWF)

In this section, we apply our proposed generalized water-filling methodology [19] to solve problem (6.2). Similar to GWF [19], Figs. 6.1(a)-(c) illustrate the proposed P-GWF algorithm for the sum power problems. Suppose there are 4 steps/stairs (K = 4) with unit width inside a water tank. In the conventional approach, the dashed horizontal line, which is the water level , needs to be determined first and then the powers (water volume above the step) are solved. Let us use di to denote the "step depth" of the ith stair which is the height of the ith step to the bottom of the tank, and is given below: 1 , for i = 1, 2, . . . , K. ai

di =

(6.5)

Since the sequence {ai } is sorted with monotonically decreasing, the step depth of the stairs indexed by {1, · · · , K } is monotonically increasing. Instead of trying to determine the water level , which is a real nonnegative number, we aim to determine the highest (shallowest) water level step under water, which is an integer number between 1 and K , and denoted it by k  . Based on the result of k  , we can write out the solutions for power

90

allocation in problem (6.2) instantly. Fig. 6.1(a) illustrates the concept of k  . Since the third level is the highest level under water, we have k  = 3. The shaded area denotes the allocated power for the third step by s 3. We define the achieved data rate using power below step k by R(k ) that can be expressed by R (k ) = = = = where si (k ) = as follows:
1 ak 1 2 1 2 1 2 1 2 k -1 i=1 log2 k -1 i=1 log2 k -1 i=1 log2 -1 log2 k i=1

(1 + ai s(k )i ) 1 + ai
ai ak ai ak 1 ak

-

1 ai

(6.6)

,

1 -a in R(k ). To include the case of k = 1 in (6.6), we define the two special cases i

n i=m bi

= 0, for m > n, and

n i=m bi = 1, for m > n, where {bi } is assumed to be a general number sequence.
s 3
3 4 4

(6.7)




3

s2
2 2

1

d2 = 1/a2

1

(a)

(b)

4

4


3


3

s2 /w2
2

2

w1
1 1

d2 = 1/(a2w2)

(c)

(d)

Figure 6.1: Illustration for the proposed generalized Water-Filling Algorithm for the sum power problems (P-GWF). (a) Water level step k  = 3, allocated power for the third step s 3 , and step/stair depth di = 1/ai . (b) ER(k ) (which is determined by the shadowed area, representing the total water/power, up to, but excluding step k ) when k = 2. (c) ER(k ) when k = 3. (d) The weighted case.

Let ER(k ) denote the Exponential Rate function achieved with the power below step k , which 91

can be written by
-1 ER(k ) = 22R(k) = k i=1

ai ak

,

for k = 1, . . . , K,

(6.8)

where the factor "2" in the exponent comes from the fractional coefficient before the sum of logarithm functions in (6.6). Further the exponential rate target given is defined by  :  = 22B . In the following, we explain how to find the water level step k  without the knowledge of the water level . Fig. 6.1(b) and Fig. 6.1(c) illustrate the concepts of ER(k ) achieved by the power from the shadowed area for the cases of k = 2 and k = 3 respectively. As an example of Fig. 6.1(c), the water volume under step 3 can be expressed as the sum of the two terms: (i) the step depth difference between the 3rd and the 1st step, (1/a3 - 1/a1 ), and (ii) the step depth difference between the 3rd and the 2nd step, (1/a3 - 1/a2 ). Thus, the achieved data rate using power under the 3rd step can be written as R(k = 3) = =
1 2 1 2

log2 1 + a1 log2
a1 a2 a2 3

1 a3

-

1 a1

+1 log2 1 + a2 2

1 a3

-

1 a2

(6.9)

.

Therefore, the corresponding ER(k = 3) is given by ER(k = 3) = 22·R(k=3) = a1 a2 , a2 3

(6.10)

which is an expansion of the composite form of (6.8). To clearly understand the procedures of the proposed algorithm, the line of the methodology is briefly summarized by the following: using { a1k -
1 k -1 } , ai i=1

for k = 1, . . . , K , to define the achieved

data rate or the exponential rate sequence in k ; using the exponential rate sequence to determine the highest step k  ; and then this k  is used to compute the optimal solution to the target problem.
1 k -1 } , k , is not guaranteed to be the optimal solution. It is only utilized for computing Thus, { a1k - a i i=1

the optimal solution in this proposed algorithm. The explicit solution, on the other hand, is optimal, and its optimality proof to (6.2) will be introduced, as an instance of the generalized case in following subsection.

92

6.2.3

Extend to Weighted Case

For the weighted or generalized case, an extended problem can be stated as: given the weighted coefficients wi > 0, i, associated with {ai wi }K i=1 which are assumed to be in decreasing order (similar to the case in Subsection 6.2.1, the indexes can be arbitrarily renumbered to satisfy this condition), find a group of the powers {si } which are the solutions to the following problem, min{si }K i=1 subject to:
1 2 K i=1

si wi log2 (1 + ai si ) = B ; 0  si , i.

K i=1

(6.11)

In Fig. 6.1(d), the width of the ith stair/step is denoted by wi . The term si denotes the allocated power represented by the area above step i under water. The value of 1/ai denotes the area, under the ith step to the bottom of the tank. Hence, the step depth of the ith step is given by

di = 1/(ai wi ),

i = 1, · · · , K.

(6.12)

Then R(k ) can be expressed by R(k ) =
1 2 k -1 i=1 wi k -1 i=1 wi

log2 1 + ai wi log2
ai wi ak wk wi ai wi ak wk

1 ak wk

-

1 ai wi

= =

1 2 1 2

(6.13) .

k -1 i=1 log2

The corresponding exponential rate function is
2R(k ) -1 k i=1

ER(k ) = 2

=

ai wi ak wk

wi

, for k = 1, . . . , K.

(6.14)

Based on these extended definitions, we have the following proposition to compute the solution to (6.11). Proposition 6.1. The explicit solution, by finite amounts of computation, to (6.11) is: sk  + (dk - di ) wi , for 1  i  k  ; and si = 0, for k  < i  K,  wk

si =

(6.15)

93

where k  = max k ER(k ) < , 1  k  K with ER(k ) defined by (6.14), the power level for this step is 1 = ak  ER(k  )
1 k w i=1 i

(6.16)

sk 

-1

(6.17)

and the optimal sum power allocated in (6.11) is:
k i=1

P =



1 · ak wk

 ER(k  )

1 k w i=1 i

-

1 wi . ai wi

(6.18)

Prior to the formal proof, we first show how sk in (6.17) is obtained, and whether {si } in (6.15), including sk , is a feasible solution to (6.11). Using (6.15) and (6.16), the first constraint, i.e., the rate constraint, of (6.11) leads to the following equation in sk : B= = = = =
1 2 1 2 1 2 1 2 1 2 k i=1 k i=1 k i=1 k i=1 k i=1

wi log2 (1 + ai si )
sk  wi log2 [1 + ai wi ( w + k sk  wi log2 [ai wi ( w + k
k k

1 ak wk

-

1 )] ai wi

1 )] ak wk
k

(6.19)
1 )]} ak wk k i=1

sk  i wi log2 { a ai w [a  wk ( w + w  k 

ai wi wi log2 ( ak )+ 1 [log2 (1 + ak sk )] 2  wk 

wi .

So, this equation in sk is further simplified as below:
1 2 k i=1 ai wi wi log2 ( ak )+ 1 [log2 (1 + ak sk )] 2  wk  k i=1

B=

wi .

(6.20)

Finally, (6.17) is obtained by solving this equation: (6.20), and then {si } in (6.15) is the feasible solution. Proof of Proposition 6.1. The formal proof is stated as follows. System (6.15) implies that wk  = + sk  ak
1

1 ai

wi , for 1  i  k  . + si

(6.21)

94

Let = wk  1 + sk  ak

-1

.

(6.22)

From geometric view,  itself is the water level . According to the definitions of k  and sk , for k  < i  K,
1 ak 

wk  +s k 



wi 1 +s i ai

and si = 0. This statement can be explained as follows: si = 0

first comes from (6.15). To show the inequality, assume to the contrary that, for k  < i  K ,
1 ak 

wk  +s k 

<

wi 1 +s i ai

holds. That is to say,

1 ak wk

+

sk  wk 

>

1 . ak +1 wk +1

Then,

1 + ai wi (

1 sk  1 1 1 + - ) > 1 + ai wi ( - ), i. ak wk wk ai wi ak +1 wk +1 ai wi

(6.23)

The logarithm operation is applied to both sides of the inequality; and then the summation operation with the weights is applied with the index running from 1 to k  . Finally put the exponentiation on the last result of both sides. As a result,  > ER(k  + 1). However, a contradiction of the maximum k  not being maximum is acquired. Therefore, for k  < i  K, Let i = 1 - 
wi 1 +s i ai
1 ak 

wk  +s k 



wi 1 +s i ai

.

. Then

i  0, for k  < i  K ; i = 0, for 1  i  k  . Therefore, the following system holds:    1-  
wi 1 +s i ai

(6.24)

- i = 0, for 1  i  K ; si  0, i si = 0, i  0, i;
K i=1

(6.25)

K i=1

wi log2 (1 + ai si )  2B, 

wi log2 (1 + ai si ) - 2B = 0,   0.

By observation, the equation and inequality set above is a set of the KKT conditions of the problem in (6.11) and the water level  is equal to the Lagrange multiplier  mentioned above. Note that the Lagrange function of the problem (6.11) is
K K K

L({si }, , {i }) =
i=1

si - 
i=1

wi log2 (1 + ai si ) - 2B -
i=1

i si .

(6.26)

Since problem (6.11) is, in essence, a differentiable convex optimization problem, not only are the KKT conditions mentioned above sufficient, but they are also necessary for optimality. We observe that the General Constraint Qualification of the problem holds. This (3.71) is often abbreviated as

95

GCQ, for which, it is seen that Slater's condition [7] is a special case and implies GCQ. Proposition 6.1 hence is proved. Note that Proposition 6.1 is the first proposition in section 6.2 of this chapter. Remark 1. Proposition 6.1, at the first line in the formal proof, stated that {sk }K k =1 in (6.15) implies (6.21), then the Lagrange multipliers are constructed by (6.22) and (6.24), and it is seen that for {sk }K k =1 in (6.15), there exists the group of Lagrange multipliers constructed above to satisfy the KKT conditions of the problem (6.11). Therefore, according to optimization theory, {sk }K k =1 in (6.15) is the optimal solution to problem (6.11). Within the statement of Proposition 6.1, it is worth mentioning that (6.14) determines ER(k ), then obtains k  by (6.16), and further sk by (6.17). Thus, the first step is to calculate ER(k ), then find the water level step, k  from (6.16), which is the maximal index of ER(k ) <  . The corresponding power level for this step, sk , can be obtained by applying (6.17). Then for those steps with index higher than k  , the power level is assigned with zero. For those steps below k  , the power level is assigned by the first expression in (6.15). The first term (sk /wk ) inside the square bracket denotes the depth of the k  th step to the water level. The second term inside the square bracket denotes the step depth difference between the k  th step and the ith step. Therefore, the sum inside the square bracket means the depth of the ith step to the water level. When this quantity is multiplied by the width of this step, the volume of the water above this step (allocated power) can be obtained. When the weighting factors are set to ones, a corollary of Proposition 6.1 is stated as follows. Corollary 6.1. The explicit solution to (6.2) is:    sk  + ( d k  - d i ) si =   0, where the water level step k  is given by k  = max k ER(k ) < , 1  k  K 1  i  k k  < i  K,

(6.27)

(6.28)

96

with ER(k ) defined by (6.8), the power level for this step is 1 = ak  ER(k  )
1 k

sk 

-1

(6.29)

and the optimal sum power allocated in (6.2) is:
K k

P =
i=1



si =
i=1

1 · ak

 ER(k  )

1 k

-

1 . ai

(6.30)

Note that the solution {si } expressed in (6.27) has an identical geometric form to that in [19]. However it is solved differently, since it is stemming from (6.28) and (6.29). Similar to the weighed case, the first step of the proposed approach is to find the water level step k  based on (6.28). Then the power sk at this step can be determined based on (6.29). For those steps with index higher than k  , no power is assigned. For those steps with index lower than k  , their power levels are obtained by adding sk to the corresponding level depth difference, between the k  th step and the ith step, which are shown in (6.27). In the following descriptions of algorithmic implementation, only weighted case is provided. From Proposition 6.1, when k  is obtained, ER(k  ) is known. Then it is memorized to compute sk . Thus, how to search k  is a key point for the proposed P-GWF. The procedure of P-GWF approach is stated below: Algorithm P-GWF: 1) Let  = 22B . Initialize Ws = 0; ERM = ER = 1; i = 1. If K = 1, output the optimal solution s 1 =
1 [ w1 a1
1

- 1]; else go to 2).

+1 Ws ) . Then i  i + 1, where the symbol "" 2) Compute Ws  Ws + wi ; ER  ER · ( di di

represents the assignment operation. 3) If ER <  and i < K, ERM = ER , and repeat the step 2); else, for ER   , output k  = i - 1, Ws = Ws - wi ; for i = K and ER < , k  = i, Ws = Ws + wi and ERM = ER . Finally, let sk = We can observe that
1 ak  ) Ws - 1 . ( ER M sk  wk 
1

sk  wk 

+ dk is the water level due to

+ dk  =

si wi

+ di , for 1  i  k  . In

addition, Ws and ERM are used, in each of the iteration, for a factor of less computation. 97

6.3

Solving Generalized RRM Problem Using P-GWF

In this section, we generalize the basic sum power RRM problem (6.2) to the sum power problems of WFPP, WFGPP, and WFGBP. The last case, P-WFGBP, is the most generalized RRM problem which will strip down to the other forms when applied to special values of lower and upper bounds and the number of its groups. To the best of the authors' knowledge, there is no existing algorithm reported in the open literatures to compute the exact solution for the generalized sum power problem P-WFGBP.

6.3.1

Weighted Water-Filling with Individual Peak Power Constraints (P-WFPP) for Sum Power Problems

Let Pi denote the peak power restriction of the ith channel. The weighted P-WFPP problem is stated by min{si }K i=1 subject to:
K i=1 K i=1

si wi log2 (1 + ai si )  2B ; 0  si  Pi , i.

(6.31)

Comparing the problem (6.31) with (6.11), the constraint of 0  si is replaced with 0  si  Pi , i.e., adding additional individual peak power constraint, and with
K i=1 K i=1

wi log2 (1+ ai si ) = 2B is replaced

wi log2 (1 + ai si )  2B . In fact, by properly further reducing some allocated power(s),

we can reach the equality constraint of the transmitted bits. Thus, problem (6.31) is reasonably assumed here. Proposition 6.1 in subsection 6.2.3 provides an explicit exact solution using the proposed approach. P-WFPP problem can be obtained with some modifications to P-GWF. For convenience, the expression (6.14) can be extended into the expression:
wit

-1 ER(ik ) = k t=1

dik dit

, for k = 1, . . . , |E |,

where E is a subsequence of the sequence {1, 2, . . . , K }, |E | is the cardinality of the set E , so E can be expressed through {i1 , i2 , . . . , i|E |}. Especially, if E is taken as the sequence {1, 2, . . . , K }, then the extended expression is regressed into the original expression (6.14). Similarly, some corresponding changes in (6.15)-(6.17) are also made (i.e., the subscripts of sequence are replaced with

98

those of the subsequence). For avoiding notation-wise tediousness, these extended expressions are still labelled by (6.15)-(6.17) in the following algorithm descriptions. Algorithm P-WFPP: Input: arrays {ai , wi , Pi } for i = 1, 2, . . . , K , the set E = {1, 2, . . . , K }, and  = 22B . 1) Utilize (6.15)-(6.17) to compute {si }. 2) The set  is defined by the set {i|si > Pi , i  E }. If  is the empty set, output {si }K i=1 ; else, si = Pi , for i  . 3) Update E with E \  and  with / [t (1 + at Pt )wt ]. Then return to 1) of the P-WFPP. Remark 2. 3) in P-WFPP is a dynamic power distribution process. The state of this process is the difference between the individual peak power sequence and the current power distribution sequence obtained by P-GWF. The control of this process is to use (6.15)-(6.17) of Algorithm PGWF based on the state mentioned above. And, a new state appears for next time stage. Therefore, a dynamic power distribution process, P-WFPP, with the state feedback is formed. Since the finite set E is getting smaller and smaller until the set  is empty, P-WFPP carries out K loops to compute the optimal solution, at most. In detail, updating E with E \  is to remove the set {i|si > Pi }, when si  Pi , i in the set. Then over the updated set E , the exponent rate  is updated with / [t (1 + at Pt )wt ] correspondingly. Further, the process of updating E and  is a middle process, from the current state to form the current control, based on system theory. For Algorithm P-WFPP, we can obtain the following results: Proposition 6.2: P-WFPP can provide the exact optimal solution to the problem (6.31) by finite amounts of computation. Its proof can be referred to in [21].

6.3.2

Weighted Water-Filling with Group Peak Power Constraints (PWFGPP) for Sum Power Problems

Let {i }T i=1 be a partition of the index set: {1, . . . , K }. For convenience, the elements of i can be listed, monotonically increasing, i.e., i1 < i2 < . . . < i|i | . Let P i (> 0) denote the upper or 99

peak power bound of the power constraint for the ith group channels, i. The weighted P-WFGPP problem can be written by min{si }K i=1 subject to:
K i=1 K i=1

si wi log2 (1 + ai si )  2B ; 0  sk , k ;
k i sk  P i ,

(6.32) i = 1, . . . , T.

Comparing the problem (6.32) with (6.31), we know that the constraints of 0  si  Pi , i, are extended to 0 
k i

sk  P i , i.e., if every i is taken as a singleton, the problem (6.32) is

regressed into the problem (6.31). To solve the problem (6.32), let us recall the original preliminary RRM problem and its solution (GWF) reported in our earlier work [19], for preparation: max{sk }K
K k =1 wk K k =1 sk

k=1

log2 (1 + ak sk )  Ptotal ; 0  sk , k.

(6.33)

subject to:

GWF gives the following solution to (6.33) by [19]: sk  + (dk  - dm ) wm , for 1  m  k  ; sm = 0, for k  < m  K ,  wk

sm =

(6.34)

where k = max k P2 (k ) > 0, 1  k  K and the power level for this step is wk   P2 (k ), k m=1 wm


(6.35)

sk  =

(6.36)

where P2 (k ) = Ptotal - and dm = 1/(am wm ), m = 1, · · · , K . (6.38)
k -1 m=1

(d k - d m ) w m

+

, for k = 1, . . . , K ,

(6.37)

The following statement presents an algorithm which is a combination and modification of the GWF and P-GWF. This algorithm is termed as the P-WFGPP.

100

Similarly, for convenience, the expression (6.14) can be extended into the expression:
wit

-1 ER(ik ) = k t=1

dik dit

, for k = 1, . . . , |E |,

where E is a subsequence of the sequence {1, 2, · · · , K }. Algorithm P-WFGPP:
T 2B Input: Sets {ak , wk }K k =1 , {P i }1=1 , E = {1, 2, . . . , T }, and  = 2 .

1) Let n = 1 and  =  (empty set). Utilize (6.15)-(6.17) to compute {sk }K k =1 . 2) The set n is assigned by the set {i|
k i

sk > P i , i  E }. If n is the empty set, output

{ si } K i=1 ; else, Ptotal  P i , K  |i |, i is renamed into the set {i1 , . . . , iK }, and then utilize (6.34)-(6.36) from GWF, for i  n . 3) Update E with E \ n and  with / [in ti (1 + at st )wt ]. Then n  n + 1, K  K-
in

|i | and return to the second statement in 1) of the P-WFGPP.

Proposition 6.3: P-WFGPP can provide the exact optimal solution to the problem (6.32) by finite amounts of computation. Its proof can be referred to in [21].

6.3.3

Weighted Water-Filling with Group Bounded Power Constraints for Sum Power Problem (P-WFGBP)

Let {i }T i=1 be a partition of the index set: {1, . . . , K }. Assume that 0  P i  P i , and P i and P i denote the lower bound and the upper bound of the power constraint for the ith group channels, i. The weighted P-WFGBP problem is stated by min{si }K i=1 subject to:
K i=1 K i=1

si wi log2 (1 + ai si )  2B ; 0  sk , k ;
k i

(6.39)

Pi 

sk  P i , i = 1, . . . , T.
k i

Comparing the problem (6.39) with (6.32), it is seen that the constraints of 0  are generalized to P i 
k i

si  P i , i,

sk  P i , i.e., adding additional group lower bound power constraints. 101

The lower bound of the additional constraint can be used to guarantee the fair transmitted rate from the ith group transmission, whereas the upper bound of the additional constraint can be used to limit the total interference from the ith group. The problem (6.39) is thus referred to as power (weighted) water-filling with group bounded power constraints (P-WFGBP). Similarly, due to the explicit solution using generalized view approach that is provided in Proposition 6.1, the proposed GWF and P-WFGPP can be applied to the P-WFGBP problem with some modifications. The following statement presents a generalized algorithm, which is based on a meaningful combination and modification of the GWF and P-WFGPP. Note, for the problem: max{sk }ki subject to: wk log2 (1 + ak sk )

k i

(6.40)

k i sk = P i ; 0  sk , k,

its optimal value is denoted by V i , for i = 1, . . . , T . It can be observed that there does not exist any solution to problem (6.39), if
T i=1 V i

< 2B . Further, if

T i=1

V i = 2B, the optimal solution

 T to (6.40) denoted by {s k }k i , for i = 1, . . . , T , can determine the optimal solution, {{sk }k i }i=1 ,

to (6.39). Hence,

T i=1

V i > 2B is assumed in the following. Further, P i , in the problem men-

tioned above, is replaced with P i , i, and the corresponding optimal value is denoted by V i , i. If
T i=1

V i  2B , the optimal solutions to the problems undergo a similar process to that mentioned

above. For i = 1, . . . , T , this constitutes an optimal solution to problem (6.39) and the optimal value is
T i=1 P i

with practical meaning. Therefore, we only consider the cases under
T i=1

T i=1

V i > 2B ,

which has been assumed before, together with

V i < 2B .

It is seen that if P i = 0, i, then problem P-WFGBP (6.39) is reduced into problem P-WFGPP (6.32); and if i is regressed to a singleton and P i = 0, i, then problem P-WFGBP (6.39) is reduced into problem P-WFPP (6.31). Thus, problem P-WFGBP (6.39) is the most general form of the RRA problems. It is called the generalized problem in this chapter. The corresponding algorithm is described below. Algorithm P-WFGBP:
K Input: the channel gains {ak }K k =1 , the weights {wk }k =1 , the group lower and upper power T bounds {P i , P i }T i=1 , the partition {i }i=1 and the (weighted) sum-rate constraint B .

102

1) Ptotal  P i , K  |i |, i is written into the set {i1 , . . . , iK }, and then utilize (6.34)-(6.36) from GWF, for i = 1, . . . , T . Hence, the solutions {{sit }ti }T i=1 are obtained. 2) Update B with B -
1 2 K k =1

wk log2 (1 + ak sk ),

1 ak

with

1 ak

+ sk , k, and P i with P i - P i , i.

3) Utilize P-WFGPP to compute {sk }K k =1 as the optimal solution to (6.32) under the updated parameters. 4) Output the optimal solution {sk }  {sk + sk } to the problem (6.39). Remark 3. Due to its definition mentioned above, P-WFGBP carries out T loops to compute the exact optimal solution, at most. For optimality of the proposed P-WFGBP, we have the following conclusion: Proposition 6.4: P-WFGBP can provide the exact optimal solution to the problem (6.39) via finite amounts of computation. Its proof can be referred to in [21]. Remark 4. If we chose an approach, similar to P-CWF to directly solve the class of problems (6.39), a non-linear system with non-linear equations and inequalities in multiple dual variables (as below) would have had to be solved in a difficult manner:  + wj  T 1   w log [1 + a - ]  2B ; j j  2 i=1 j i 1+ i -i aj    +  wj  T 1   w log [1 + a - ] - 2B } = 0;  { j 1+ i - 2  j i j i=1 aj i   +   wj  1  P   P i , for i = 1, 2, . . . , T ; i j i 1+ i - - aj
+  wj  1   [ - - P i ] = 0, for i = 1, 2, . . . , T ;  i j   1+  -  a  i i j i   +  wj   1   [ - - P i ] = 0, for i = 1, 2, . . . , T ;  i j   1+ i - i aj i        0;   0,   0, for i = 1, 2, . . . , T. i i
i

(6.41)

For example, the system of (3) and (4) in [36] is defined, which was claimed to find a very general multiple water level multiple constrained water filling result. However, it cannot be used for the exact solution to the mentioned problem (6.39). The reason is stated as follows. It is seen that sj =
wj  1+ i - i +

-

1 aj

, for j  i , i = 1, 2, . . . , T , where {sj } is the solution to problem (6.39).
 , 1+ k - k

According to (3) in [36], the water levels should be taken as k =

for k = 1, 2, . . . , T . Since

{sj } is the solution, it should also satisfy the second, and the fourth to the sixth constraints in the

103

8

25 20 15

25 20 15 10 5 1 11 (b) 2
2

6 4

10

2
5 0 1 (a) 2 0 2 3 (c)

0

Figure 6.2: Illustration for Examples 1, 3, 4 respectively. system (6.41). Thus, a further developed version from (4) in [36] cannot include only the water-levels {k }. It also should include other dual variables, as a prerequisite for solving the problem, although (4) in [36] does not need the dual variables which correspond to non-negativeness constraints of the solution {sj } due to using the function (·)+ . This point for the assumed form (4) in [36] results in [36] not being able to be used to solve the target problem (6.39). The algorithms proposed in [19] are to compute the solutions to the maximum throughput problems. The minimum sum power problems discussed in this chapter are different. In addition, KKT conditions for these two cases are different. As a result, algorithms of [19] cannot directly be used for the problems discussed here. From duality between the throughput maximization and the sum power minimization, we can obtain uniqueness of the solution, discussed in this section.

6.4

Numerical Results and Complexity Analysis

A few numerical examples are presented in this section to illustrate the steps of the proposed algorithms. Example 1. Instantiate a case of P-WFPP problem by min{si }2 i=1 subject to:
2 i=1 2 i=1

si log(1 + ai si )  3; 0  s1  1; 0  s2  8,

(6.42)

where a1 = 1 and a2 = 0.5. Utilizing the proposed P-WFPP, the optimal solution is {s1 = 1, s2 = 6} that is shown in Fig. 6.2(a).

104

8 7 6 5 4 3 2 1 0 (a) 2 4 6

8

10 8 7 6 5 4 3 2 1 0 (b) 2 4 6

12 10 8 8 6 4 2 0 1 4 (c) 6 8 3 2 5 4 7 6 8

10

Figure 6.3: Illustration for Example 2, results for the first, second and third iterations respectively. Example 2. Instantiate another case of P-WFPP problem with multiple channels: min{si }8 i=1 subject to:
8 i=1 8 i=1

si log(1 + ai si )  7; 0  si  i, i,

(6.43)

where ai = 1/i, i. That is to say, the step depth monotonically increases from 1 to 8, as shown in Fig. 6.3 with the solution.
1 . 128 6 ) - 1](= 0.72) Using the proposed P-WFPP, the result of the first iteration is s6 = sk = 6[( 64 .8 . 6 8 3 6 8 and then {si = i}3 i=1 {si = s6 +6 - i}i=4 {si = 0}i=7 = {si = i}i=1 {si = 6.72 - i}i=4 {si = 0}i=7 . 1 . The result of the second iteration is s8 = sk = 8[( 105 ) 5 - 1](= 2.146) and then {si = i}5 i=1  {si = 32 . 5 8 s8 + 8 - i}8 i=6 (= {si = i}i=1  {si = 10.146 - i}i=6 ). The result of the third iteration is s8 = sk  = 1 . . 8 ) 3 - 1](= 3.036) and then {si = i}5 8[( 21 i=1  {si = s8 + 8 - i}i=6 (= {1, 2, 3, 4, 5, 5.036, 4.036, 3.036}). 8

According to the algorithm and Proposition 6.2, the result of the third iteration is indeed the optimal solution. These results are illustrated in Figs. 6.3(a)-(c). Example 3. Instantiate a case of weighted P-WFPP problem by min{si }2 i=1 subject to:
2 i=1 2 i=1

si wi log(1 + ai si )  3; 0  si  12, i,

(6.44)

where a1 = 1, a2 = 0.5, w1 = 0.4 and w2 = 0.6. Utilizing the proposed P-WFPP, the optimal result  64 56 - 1, s2 = 12}, which is shown in Fig. 6.2(b). is {s1 = 49 Example 4. As the last example, we instantiate a case of the sum power weighted water-filling

105

with group bounded power constraints (P-WFGBP) problem by: min{si }3 i=1 subject to:
3 i=1 si 3 i=1 wi

log(1 + ai si )  3; 0  si , i;

(6.45)

1  s1 + s2  12; s3  12, where a1 = a2 = a3 = 1, w1 = 0.3, w2 = 0.2 and w3 = 0.5. Utilizing the proposed Algorithm: P-WFGBP with inputting: 1 = {1, 2}, 2 = {3} and B  1.5. The optimal solution is {s1 =
22.8 ×30.7 50.5

- 1 , s2 =

23.8 50.5 ×30.3

- 1 , s3 =

22.8 ×50.5 30.3

- 1} which is shown

in Fig. 6.2(c), where the stair width for the three channels are 0.3, 0.2, 0.5 respectively specified by their weighting factors. The step depth is calculated using 1/(ai wi ), leading to the step depth values of 10/3, 5, and 2 respectively for the three channels.

6.4.1

Complexity Analysis

For the non-weighted basic sum power water-filling problem (6.2), according to the expressions (9) and (10) in [36, Section 3], the conventional (sum power) water-filling algorithm had an exponential worst-case complexity [36, Section 3] of 2K , where K is the number of the channels, even though the channel gains had been sorted in decreasing order. Pointing to this case, [36] and [8] proposed an improved algorithm with worst-case complexity of K iterations. Since each iteration consists of the multiple basic elementary function evaluations, the arithmetic operations, and the logical operations, the proposed P-GWF is measured on these operations more accurately than the iterations. P-GWF uses K iterations, each of which includes 8 operations: 1 basic elementary function evaluation (BE), 5 arithmetic operations (AOs), and 2 logical operations (LOs). For an algorithm, a total of these numbers right down to such operation(s) can measure the complexity level of the algorithm [38, Chapter 8]. The conventional approach [8, p. 310] requires a total of O (K 2 ) operations which consist of
(K +1)K 2

+ 1 BEs,

(K +1)K 2

+ 4 AOs and K LOs, under the K + 4 memory unit requirement with a

worst-case complexity of K iterations. As mentioned above, the proposed P-GWF uses 8K operations, which consist of K BEs, 5K AOs, and 2K LOs under the K + 4 memory unit requirement with a worst-case complexity of K iterations. 106

For P-WFPP, it needs K loops to compute the optimal solution, at most. The required number of operations is, at worst,
K i=1

8i = 4K 2 + 4K fundamental basic elementary function evaluations,

arithmetical and logical operations. For P-WFGBP, it needs T loops to compute the optimal solution, at most, where T  K . The required number of operations, at worst, is T × O (K 2 ) fundamental basic elementary function evaluations, arithmetical and logical operations. However, it is known from the prior works mentioned above that PD-IPM needs the computational complexity of O (K 3.5log (1/ )), to compute an solution. In this complexity analysis, we didn't take sorting procedure into consideration. It is stated in [36] that the channel gain sequences come from the eigenvalues of a matrix. There are many algorithms to compute the eigenvalues and eigenvectors, with the eigenvalues sorted.

107

Chapter 7 Conclusions
A few new algorithms are presented for the MIMO and EH maximum throughput problems, in this thesis. Optimality proofs for the algorithms are also provided. Compared with existing methods by others, our algorithms have the distinct characteristics: the proposed theory is strict and the proposed computation is fast. In detail, this thesis in Chapter 2 presents the efficient methods for computation of exact optimal solutions to the problems with more and more constraints. It also constructs solutions to the optimization problems based on the water-filling geometrical principle, and offers a formal proof of optimality for the constructed solutions. Thus, the proposed methods can solve the problems the conventional methods cannot. Further, they own the polynomial complexity, and the polynomial has a lower degree. This thesis also presents a new mathematical model up to the hybrid systems of the EH, MIMO and power grid. The first, it designs the recursive geometric water-filling algorithm (RGWF) in Chapter 3 for the EH system, stemming from GWF. Then it extends RGWF for finding the optimal solutions of the new mathematical models with both the EH capability and the MIMO technology; and those with hybrid power sources of EH and the grid power, in Chapters 4-5, respectively. In addition, using GWF to compute the exact solutions to the sum power minimization problems, has been presented in Chapter 6. On the theoretical level, this thesis sets up a solid theoretical framework for the discussion of the investigated algorithms for the target problems. Under such a framework, optimality proof for each of our algorithms is presented. Note the difference between the recursive definition and the explicit

108

definition (of an algorithm). This point can be referred to in any standard textbook on mathematical logic. Then, it is omitted in this thesis. If the word of recursive has been mentioned for an algorithm in this thesis, the algorithm is guaranteed to be recursive; else, it is not. In addition, this thesis does not consider other objective functions, such as the one to look for the fairness purpose. Maybe this fairness topic will be of our future research. In addition, not only may the proposed approach keep up optimality of all the proposed waterfilling algorithms, but it also may lift the performance of computing objective values much more. Numerical examples also show that utilization of the proposed algorithms can significantly improve efficiency of the computation. For the future, we can extend our approach to designing optimal on-line power allocation algorithms for wireless communication systems, together with EH, MIMO and cognitive radio (CR) techniques.

109

Bibliography
[1] S. Albers, Online algorithms, In Interactive Computation: The New Paradigm edited by D.Q. Goldin, S.A. Smolka and P. Wegner, pp. 143-164, 2006. [2] D. P. Bertsekas, Nonlinear Programming, 2nd Edition, Athena Scientific, Belmont, MA, 1999. [3] D. P. Bertsekas, Dynamic Programming and Optimal Control, 4th Edition, Nashua, NH, USA: Athena Scientific, 2007. [4] D. P. Bertsekas, and J. N. Tsitsiklis, Parallel and Distributed Computation: Numerical Methods, Athena Scientific, Belmont, MA, 1997. [5] E. Biglieri, R. Calderbank, A. Constantinides, A. Goldsmith, A. Paulraj, and H. V. Poor, MIMO Wireless Communications, Cambridge University Press, 2007. [6] J. F. Bonnans, J. C. Gilbert, C. Lemar´ echal, and C. A. Sagastiz´ abal, Numerical Optimization: Theoretical and Practical Aspects, 2nd Edition, Springer, 2006. [7] S. Boyd, and L. Vandenberghe, Convex Optimization, Cambridge University Press, 2004. [8] J. Cioffi, Ee379c course reader, chapter 4, http://www.stanford.edu/group/cioffi/ee379c, frequently updated. [9] N. Devroye, M. Vu and V. Tarokh,Cognitive radio networks: Information theory limits, models and design, IEEE Signal Process. Mag., Vol. 25, pp. 1223, 2008. [10] U. Erez, S. Shamai, and R. Zamir, Capacity and lattice strategies for cancelling known interference, IEEE Trans. Inf. Theory, Vol. 51, pp. 3820-3833, 2005. [11] G. B. Folland, Real Analysis: Modern Techniques and Their Applications, John Wiley And Sons, North York, 1999. 110

[12] M. Gatzianas, L. Georgiadis, and L. Tassiulas, Control of wireless networks with rechargeable batteries, IEEE Trans. on Wireless Communications, Vol. 9, pp. 581-593, 2010. [13] M. Gorlatova, A. Wallwater, and G. Zussman, Networking lowpower energy harvesting devices: Measurements and algorithms, IEEE Transactions on Mobile Computing, Vol. 12, pp. 18531865, 2013. [14] J. Gong, S. Zhou, and Z. Niu, Optimal power allocation for energy harvesting and power grid coexisting wireless communication systems, IEEE Trans. Communications, Vol. 61, pp. 30403049, 2013. [15] M. Gregori, and M. Payaro, Deploying multi-antenna energy-harvesting cooperative jammers in the mimo wiretap channel, Asilomar conference on signals, systems and computers, pp. 1886-1890, 2012. [16] S. Haykin, Cognitive radio: brain-empowered wireless communications, IEEE J. Sel. Areas Commun., Vol. 23, pp. 201-220, 2005. [17] P. He, and L. Zhao, Correction of convergence proof for iterative water-filling in Gaussian MIMO broadcast channels, IEEE Trans. Inf. Theory, Vol. 57, pp. 2539-2543, 2011. [18] P. He, L. Zhao, and J. H. Lu, Weighted sum-rate maximization for multi-user SIMO multiple access channels in cognitive radio networks, EURASIP Journal on Advances in Signal Processing, 15 pages, doi: 10.1186/1687-6180-2013-80, 2013. [19] P. He, L. Zhao, S. Zhou, and Z. S. Niu, Water-filling: a geometric approach and its application to solve generalized radio resource allocation problems, IEEE Trans. on Wireless Communications, Vol. 12, pp. 3637-3647, 2013. [20] P. He, L. Zhao, S. Zhou, and Z. S. Niu, Recursive water-filling for wireless links with energy harvesting transmitters, IEEE Trans. on Vehicular Technology, Vol. 63, pp. 1232-1241, 2014. [21] P. He, and L. Zhao, Solving A Class of Sum Power Minimization Problems Using Generalized Water-Filling, IEEE Trans. on Wireless Communications, dio: 10.1109/TWC.2015.2459714, 2015.

111

[22] P. He, L. Zhao, S. Zhou, and Z. S. Niu, Optimal recursive power allocation for energy harvesting nodes with multiple antennas, IEEE Trans. on Vehicular Technology, published on-line, DOI: 10.1109/TVT.2014.2366560, 2014. [23] P. He, and L. Zhao, Non-commutative composite water-fillings for energy harvesting and smart power grid hybrid system with peak power constraints, IEEE Trans. on Vehicular Technology, published on-line, DOI: 10.1109/TVT.2015.2418318, 2015. [24] P. He, L. Zhao, S. Zhou, and Z. S. Niu, Radio Resource Management Using Geometric Waterfilling, Springer Brief in Computer Science, Springer, 2014. [25] C. Ho, and R. Zhang, Optimal energy allocation for wireless communications with energy harvesting constraints, IEEE Trans. on Signal Process., Vol. 60, pp. 4808-4818, 2012. [26] C. Hsu, H. Su, and P. Lin, Joint subcarrier pairing and power allocation for OFDM transmission with decode-and-forward relaying, IEEE Trans. on Signal Process., Vol. 59, pp. 399-414, 2010. [27] W. Jia, H. Zhu, Z. Cao, X. Dong, and C. Xiao, Human-factor-aware privacy-preserving aggregation in smart grid, IEEE Systems Journal, Vol. 8, pp. 598-607, 2014 [28] H. Jiang, L. Lai, R. Fan, and H.V. Poor, Optimal selection of channel sensing order in cognitive radio, IEEE Trans. on Wireless Communications, Vol. 8, pp. 297-307, 2009. [29] N. Jindal, W. Rhee, S. Vishwanath, S. A. Jafar, and A. Goldsmith, Sum power iterative waterfilling for multi-antenna Gaussian broadcast channels, IEEE Trans. Inf. Theory, Vol. 51, pp. 1570-1580, 2005. [30] N. Jindal, S. Vishwanath, A. Goldsmith, On the duality of Gaussian multiple-access and broadcast channels, IEEE Trans. Inf. Theory, Vol. 50, pp.768-783, 2004. [31] T. Kailath, A. Sayed, and B.Hassibi, Linear Estimation, Prentice Hall, 2000. [32] M. Kobayashi, and G. Caire, An Iterative water-filling algorithm for maximum weighted sumrate of Gaussian MIMO-BC, IEEE J. Sel. Areas Commun., Vol. 24, pp. 1640-1646, 2006.

112

[33] J. Lei, R. Yates, and L. Greenstein, A generic model for optimizing single-hop transmission policy of replenishable sensors, IEEE Trans. on Wireless Communications, Vol. 8, pp. 547-551, 2009. [34] J. Mitola, and G. Q. Maguire, Cognitive radios: making software radios more personal, IEEE Personal Commun. Vol. 6, 13-18, 1999. [35] O. Ozel, K. Tutuncuoglu, J. Yang, S. Ulukus, and A. Yener, Transmission with energy harvesting nodes in fading wireless channels: Optimal policies, IEEE J. Sel. Areas Commun., Vol. 29, pp. 1732-1743, 2011. [36] D. Palomar, Practical algorithms for a family of waterfilling solutions, IEEE Trans. Signal Process., Vol. 53, pp. 686-695, 2005. [37] D. Palomar, A unified framework for communications through MIMO channels, Ph.D. thesis, Universitat Politecnica De Catalunya, 2003. [38] C. H. Papadimitriou, and K. Steiglitz, Combinatorial Optimization: Algorithms and Complexity, Unabridged Edition, Dover Publications, 1998. [39] R. V. Prasad, P. Pawelczak, J. A. Hoffmeyer, and H. S. Berger, Cognitive functionality in next generation wireless networks: standardization efforts, IEEE Commun. Mag. Vol. 46, pp. 72-78, 2008. [40] Q. Qi, A. Minturn, and Y. Yang, An efficient water-filling algorithm for power allocation in OFDM-based cognitive radio systems, in Proc. International Conference on Systems and Informatics (ICSAI), pp. 2069-2073, Yantai, 2012. [41] Y. Rong, X. Tang, and Y. Hua, A unified framework for optimizing linear non-regenerative multicarrier MIMO relay communication systems, IEEE Trans. on Signal Process., Vol. 57, pp. 4837-4852, 2009. [42] C. E. Shannon, A mathematical theory of communication, Bell Sys. Tech. J., Vol. 27, pp. 379-423, 1948.

113

[43] V. Sharma, U. Mukherji, V. Joseph, and S. Gupta, Optimal energy management policies for energy harvesting sensor nodes, IEEE Trans. on Wireless Communications, Vol. 9, pp. 13261336, 2010. [44] E. Telatar, Capacity of multi-antenna Gaussian channels, Europ. Trans. on Telecomm., Vol. 10, pp. 585-596, 1999. [45] D. Tse, and S. Hanly, Multiaccess fading channels. Part I: Polymatroid structure, optimal resource allocation and throughput capacities, IEEE Trans. Inf. Theory, Vol. 44, 2796-2815, 1998. [46] K. Tutuncuoglu, and A. Yener, Optimum transmission policies for battery limited energy harvesting nodes, IEEE Trans. on Wireless Communications, Vol. 11, pp. 1180-1189, 2012. [47] S. Vishwanath, S. Jafar, and A. Goldsmith, Optimum power and rate allocation strategies for multiple access fading channels, in Proc. IEEE Vehicular Technology Conf., pp. 2888-2892, Rhodes, 2001. [48] P. Viswanath, and D. Tse, Sum capacity of the multiple antenna Gaussian broadcast channel and uplink-downlink duality, IEEE Trans. Inf. Theory, Vol. 49, pp. 1912-1921, 2003. [49] H. Weingarten, Y. Steinberg, and S. Shamai, The capacity region of the Gaussian multiple-input multiple-output broadcast channel, IEEE Trans. Inf. Theory, Vol. 52, pp. 3936-3964, 2006. [50] J. Yang, and S. Ulukus, Optimal packet scheduling in an energy harvesting communication system, IEEE Trans. Commun., Vol. 60, pp. 220-230, 2012. [51] W. Yu, W. Rhee, Boyd, S., and J. M. Cioffi, Iterative water-filling for Gaussian vector multiaccess channels, IEEE Trans. Inf. Theory, Vol. 50, pp. 145-152, 2004. [52] W. Yu, Sum-capacity computation for the Gaussian vector broadcast channel via dual decomposition, IEEE Trans. Inf. Theory, Vol. 52, pp. 754-759, 2006. [53] W. I. Zangwill, Nonlinear Programming: A Unified Approach, Prentice-Hall, Englewood Cliffs, N.J., 1969.

114

[54] L. Zhang, Y. C. Liang, and Y. Xin, Joint beamforming and power allocation for multiple access channels in cognitive radio networks, IEEE J. Sel. Areas Commun., Vol. 26, pp. 38-51, 2008. [55] L. Zhang, Y. Xin, Y. C. Liang, and H. V. Poor, Cognitive multiple access channels: optimal power allocation for weighted sum rate maximization, IEEE Trans. Commun., Vol. 57, pp. 2754-2762, 2009. [56] R. Zhang, S. Cui, and Y. C. Liang, On ergodic sum capacity of fading cognitive multiple-access and broadcast channels, IEEE Trans. Inf. Theory, Vol. 55, pp. 5161-5178, 2009.

115

