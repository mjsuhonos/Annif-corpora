FAULT DIAGNOSIS AND PROGNOSIS OF SATELLITE ATTITUDE CONTROL SYSTEM WITH REACTION WHEELS AND CONTROL MOMENT GYROS

by Afshin Rahimi Bachelor of Science, K.N. Toosi University of Technology (2010) Master of Applied Science, Ryerson University (2012)

A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of Doctor of Philosophy in the Program of Aerospace Engineering

Toronto, Ontario, Canada, 2017  Afshin Rahimi 2017

Author's Declaration
I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my dissertation may be made electronically available to the public.

Afshin Rahimi

ii

Abstract
Fault Diagnosis and Prognosis of Satellite Attitude Control System with Reaction Wheels and Control Moment Gyros Afshin Rahimi, Doctor of Philosophy, Aerospace Engineering Ryerson University, Toronto, August 2017 Condition-based maintenance (CBM) and prognostics and health management (PHM), as consisting parts of diagnosis, prognosis, and health monitoring (DPHM) framework, have developed over the past decades to remedy the limitations of the traditional maintenance practices for complex systems. In space, where mass and power budget are restricted, application of CBM and PHM has become more vital to the success of a mission. Reaction wheels (RW) and Control Moment Gyros (CMG), as the most commonly used actuators onboard satellites, are prone to faults and failures. The ability to detect faults, isolate their location and severity, and estimate the remaining useful life (RUL) of the faulty unit can enhance mission success rate and reduce maintenance and damage costs extensively. Therefore, in this thesis, a model-based DPHM framework is developed and evaluated. Firstly, a novel fault detection algorithm is proposed, using Unscented Kalman filters (UKF) in conjunction with residual and innovation sequences, for detecting agile faults in RW/CMG onboard satellites. Secondly, a novel fault isolation algorithm is proposed, using UKF, Bayes' probability and interacting multiple models (IMM), to isolate the location of the fault and its severity. Finally, a new fault prognosis approach is proposed, using UKF and particle filters (PF) to estimate the RUL of a faulty unit. Extensive simulations were conducted for each phase of the DPHM to verify advantages of the proposed techniques over the available methods in the literature. Extensive simulations were conducted to evaluate the performance of the proposed

iii

methods in each module of the framework. Regarding the proposed fault detection scheme, results showed superior performance of the proposed adaptation technique compared to the original UKF and a previously developed AUKF. The proposed fault isolation scheme was able to successfully isolate the faulty unit at multiple levels of isolation including formation level, system level, and actuator level with over 99% success rate for formation level, over 99% success rate for the RW assembly and for up to 90% success rate for the CMG assembly in the system level. For the CMG assembly, due to direct estimation of the fault parameters, it was possible to determine the severity of the faults as well as their location. Finally, the proposed fault prognosis approach provided RUL estimates with errors as low as 1.5% compared to the actual remaining useful life. Overall, the proposed framework can be regarded as a promising tool for fault detection, isolation and identification, and prognosis of the complex nonlinear systems. Furthermore, the proposed framework can be extended to other complex systems in space including multi-agent formation systems and other areas where the model of the system under study is available.

iv

Acknowledgements
After four years and a half and many uncertain and turbulent times, I have finally completed my Ph.D. thesis. I am grateful for my supervisors Dr. Krishna Dev Kumar and Dr. Hekmat Alighanbari and my external examiner Dr. Khashayar Khorasani for thoroughly reviewing my work and providing me with immense amount of constructive feedback. I appreciate the challenges they threw my way and their confidence in me. Over these past years, I came to know other knowledgeable engineers such as members of the SSDC lab. I appreciate your friendship and camaraderie, and during this period I learned a lot from each one of you. I want to thank you Bahram, Michael, Alex, Sobhan, and Venkatesh individually and let you know that all those memories will never be forgotten. Amirhossein Ahadi and Sogol Bandehali were nothing but my brother and sister during hardship and peace. I am grateful to have them in my life and am hopeful to remain as close with them, regardless of what the future holds. Industrial opportunities at Bombardier Transportation through MITACS program and Pratt & Whitney Canada through RIADI program were invaluable. I gained an immense amount of knowledge during these fellowships and could not be more exposed to technical implementations of my research any other way. It was an honor to receive the Vanier Canada Graduate Scholarship for my research and contributions in the field of aerospace focusing on fault diagnosis and prognosis. This scholarship helped me with the peace of mind to focus on my research and perform better in the absence of financial concerns. Last but not the least my parents Majid and Farideh, are the ones whom their unconditional love made them the most selfless individuals I have ever come to know in my life. I will always be indebted to them and feel blessed and privileged to have them as my parents. This thesis is dedicated to them, in the hope that it would make them content and proud of the son they raised to this point. v

To my loving parents Majid Rahimi and Farideh Farhang, without whose support and endless love, I would not be here.

vi

Table of Contents
List of Tables .................................................................................................................. x List of Figures .............................................................................................................. xiii Nomenclature .............................................................................................................. xvii Introduction ................................................................................................................... 1 1.1 Motivation .......................................................................................................... 2 1.2 Satellite Attitude Control System ....................................................................... 5 1.2.1 ACS Units .................................................................................................. 6 1.2.2 Actuators .................................................................................................... 7 1.3 Fault Detection, Isolation, and Prognosis ........................................................... 8 1.3.1 Fault Classification ..................................................................................... 8 1.3.2 Fault Diagnosis and Prognosis Cycle .........................................................10 1.4 Literature Review .................................................................................................11 1.4.1 Fault Detection..........................................................................................11 1.4.2 Fault Isolation ...........................................................................................12 1.4.3 Fault Prognosis..........................................................................................15 1.5 Problem Statement ............................................................................................17 1.6 Research Objectives ...........................................................................................19 1.7 Main Contributions ............................................................................................21 1.8 Thesis Outline ....................................................................................................22 Preliminaries .................................................................................................................23 2.1 Satellite Attitude Model.....................................................................................23 2.1.1 Satellite Dynamics .....................................................................................24 2.1.2 Attitude Kinematics ..................................................................................25 2.2 Formation Flying ...............................................................................................27 2.2.1 Decentralized FDI architecture ..................................................................28 2.2.2 Semi-decentralized FDI architecture ..........................................................28 2.2.3 Centralized FDI architecture .....................................................................29 2.3 Actuator Model ..................................................................................................30 2.3.1 Reaction Wheel Model ...............................................................................30 2.3.2 Reaction Wheel Assembly .........................................................................34 2.3.3 Control Moment Gyro ...............................................................................34 2.4 Kalman Filters ...................................................................................................38 2.4.1 Unscented Kalman Filter...........................................................................38

vii

2.4.2 Adaptive Unscented Kalman Filter ...........................................................41 2.5 Particle Filter.....................................................................................................41 2.5.1 Algorithm ..................................................................................................42 2.5.2 Degeneracy ................................................................................................43 2.5.3 Importance Density Choice........................................................................44 2.5.4 Resampling ................................................................................................44 2.5.5 Alternatives to Sub-optimality ..................................................................45 2.5.6 Variations of Particle Filter .......................................................................45 2.6 Confusion Matrix ...............................................................................................46 2.7 Conclusions ........................................................................................................47 Fault Detection .............................................................................................................48 3.1 Proposed Covariance Adaptive UKF (CAUKF) ................................................49 3.1.1 Fault Annunciation Metric ........................................................................49 3.1.2 Filter Adaptation Algorithm .....................................................................50 3.2 Stability of the CAUKF .....................................................................................51 3.2.1 Instrumental Diagonal Matrix and Extra Positive Definite Matrix ...........51 3.2.2 Stochastic Boundedness of Estimation Error .............................................52 3.3 Error Performance of the CAUKF .....................................................................53 3.3.1 Cramér­Rao lower bound ..........................................................................53 3.3.2 The Mean Square Error of the UKF..........................................................54 3.4 Computational Complexity of the CAUKF........................................................54 3.4.1 Fault Annunciation Complexity ................................................................55 3.4.2 Fault Adaptation Complexity....................................................................56 3.4.3 Overall Complexity....................................................................................56 3.5 Noise Considerations ..........................................................................................57 3.6 Results and Discussion .......................................................................................58 3.6.1 Fault Types ...............................................................................................58 3.6.2 Monte Carlo Simulations ...........................................................................59 3.6.3 Reaction Wheels ........................................................................................60 3.6.4 Control Moment Gyros..............................................................................71 3.7 Conclusions ........................................................................................................76 Fault Isolation ...............................................................................................................77 4.1 Proposed Methodology .......................................................................................77 4.1.1 Fault Detection..........................................................................................79 4.1.2 Likelihood-based Isolation .........................................................................80 4.1.3 Adaptive Windowing .................................................................................83

viii

4.2 Results and Discussion .......................................................................................84 4.2.1 Formation Level ........................................................................................84 4.2.2 RW Assembly ............................................................................................88 4.2.3 CMG Assembly ....................................................................................... 100 4.3 Conclusions ...................................................................................................... 104 Fault Prognosis ........................................................................................................... 105 5.1 Model-based Prognostics .................................................................................. 106 5.2 Model Definition .............................................................................................. 106 5.3 Particle Filter Process ...................................................................................... 108 5.3.1 Step 1 ­ Initialization .............................................................................. 108 5.3.2 Step 2 ­ Update ....................................................................................... 108 5.3.3 Step 3 ­ Resampling ................................................................................ 109 5.4 Predicting the Damage State and RUL ........................................................... 110 5.5 Results and Discussion ..................................................................................... 113 5.5.1 Exponential Decline ................................................................................. 113 5.5.2 Normal Distribution ................................................................................ 117 5.5.3 Lognormal Distribution ........................................................................... 121 5.6 Conclusions ...................................................................................................... 123 Conclusions and Future Work ..................................................................................... 124 6.1 6.2 6.3 Highlights......................................................................................................... 124 Summary of Contributions............................................................................... 126 Future Work .................................................................................................... 127

References ................................................................................................................... 128

ix

List of Tables
Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table 1.1 Satellite program costs by mass [3], [4] ............................................................ 2 1.2 Summary of on-orbit failure of MW/RW/CMG [12] ....................................... 4 2.1 ITHACO Type `A' Reaction Wheel Parameters [76] ......................................33 2.2 Sample confusion matrix.................................................................................46 2.3 Terminology for confusion matrix [157] ..........................................................46 2.4 Sample Monte Carlo confusion matrix............................................................47 3.1 Proposed CAUKF covariance adaptation algorithm .......................................50 3.2 Matrix square root algorithm computational requirement [164] .....................55 3.3 Computational complexity of different estimation methods ...........................56 3.4 Sample Monte Carlo confusion matrix............................................................59 3.5 Fault detection simulation parameters for RW ..............................................61 3.6 Abrupt Bus Voltage fault profile ....................................................................61 3.7 Abrupt Bus Voltage fault performance measures ...........................................63 3.8 MC for LOE 5%, =10...................................................................................64 3.9 MC for LOE 5%, =20...................................................................................64 3.10 MC for LOE 5%, =30 .................................................................................64 3.11 MC for LOE 5%, =40 .................................................................................64 3.12 MC for LOE 5%, =50 .................................................................................64 3.13 MC for LOE 5%, =100 ...............................................................................64 3.14 MC for LOE 5%, =150 ...............................................................................64 3.15 MC for LOE 5%, =200 ...............................................................................64 3.16 MC for LOE 10%, =10 ...............................................................................65 3.17 MC for LOE 10%, =20 ...............................................................................65 3.18 MC for LOE 10%, =30 ...............................................................................65 3.19 MC for LOE 10%, =40 ...............................................................................65 3.20 MC for LOE 10%, =50 ...............................................................................65 3.21 MC for LOE 10%, =100 .............................................................................65 3.22 MC for LOE 10%, =150 .............................................................................65 3.23 MC for LOE 10%, =200 .............................................................................65 3.24 MC for LOE 15%, =10 ...............................................................................66 3.25 MC for LOE 15%, =20 ...............................................................................66 3.26 MC for LOE 15%, =30 ...............................................................................66 3.27 MC for LOE 15%, =40 ...............................................................................66 3.28 MC for LOE 15%, =50 ...............................................................................66

x

Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table Table

3.29 MC for LOE 15%, =100 .............................................................................66 3.30 MC for LOE 15%, =150 .............................................................................66 3.31 MC for LOE 15%, =200 .............................................................................66 3.32 MC for LOE 20%, =10 ...............................................................................67 3.33 MC for LOE 20%, =20 ...............................................................................67 3.34 MC for LOE 20%, =30 ...............................................................................67 3.35 MC for LOE 20%, =40 ...............................................................................67 3.36 MC for LOE 20%, =50 ...............................................................................67 3.37 MC for LOE 20%, =100 .............................................................................67 3.38 MC for LOE 20%, =150 .............................................................................67 3.39 MC for LOE 20%, =200 .............................................................................67 3.40 Transient Bus Voltage fault profile...............................................................67 3.41 Transient Bus Voltage fault performance measures ......................................68 3.42 Intermittent Bus Voltage and motor torque fault profile..............................69 3.43 Intermittent Bus Voltage and motor torque performance measures .............69 3.44 Incipient Bus Voltage fault profile ................................................................70 3.45 Incipient Bus Voltage performance measures ................................................70 3.46 Fault detection simulation parameters CMG ................................................74 3.47 CMG fault parameters out-of-phase abrupt fault profile ..............................76 3.48 CMG out-of-phase abrupt fault scenario performance measures ...................76 4.1 Fault scenarios for RW/CMG assemblies and satellite formation ..................81 4.2 Logic for determining output of the isolation scheme .....................................84 4.3 Single BEMF constant and Bus Voltage fault ................................................85 4.4 Confusion matrix for 4 satellites in formation ................................................87 4.5 Simulation Parameters [5], [7].........................................................................89 4.6 Single BEMF constant and Bus Voltage fault ................................................90 4.7 Confusion matrix for three orthogonal assembly ............................................97 4.8 Confusion matrix for pyramid assembly .........................................................97 4.9 Multiple BEMF constant and Bus Voltage fault profile ­ Scenario 1 .............99 4.10 Multiple BEMF constant and Bus Voltage fault profile ­ Scenario 2 ...........99 4.11 CMG fault parameters in-phase abrupt fault profile................................... 101 4.12 CMG in-phase abrupt fault scenario performance measures ....................... 101 4.13 Confusion matrix for CMG assembly .......................................................... 102 5.1 Exponential decline in Motor Torque Constant fault profile ........................ 114 5.2 Exponential decline in Motor Torque Constant performance measures ........ 114 5.3 Fault prognosis simulation parameters ......................................................... 117 5.4 Fault prognosis for a normally distributed sample set with 500 particles ..... 120 5.5 Fault prognosis for a normally distributed sample set with 100 particles ..... 120 xi

Table 5.6 Fault prognosis for a normally distributed sample set with 1000 particles ... 120 Table 5.7 Fault prognosis for a log-normally distributed sample set with 500 particles ..................................................................................................................................... 122 Table 5.8 Fault prognosis for a log-normally distributed sample set with 100 particles ..................................................................................................................................... 123 Table 5.9 Fault prognosis for a log-normally distributed sample set with 1000 particles ..................................................................................................................................... 123

xii

List of Figures
Figure 1.1 SpaceWorks small satellites launch historical, current, and future projections data ................................................................................................................................. 3 Figure 1.2 SpaceWorks nano/microsatellites trends by sector ......................................... 3 Figure 1.3 SpaceWorks nano/microsatellite trends by purpose: (Left) 2009-2016 (Right) 2017-2019......................................................................................................................... 3 Figure 1.4 Schematic of the fault tolerant satellite attitude control system .................... 5 Figure 1.5 Satellite attitude control system units ............................................................ 6 Figure 1.6 Types of faults based on addition to the system ............................................ 8 Figure 1.7 Types of faults based on time characteristics ................................................. 9 Figure 1.8 The CBM/PHM cycle ...................................................................................10 Figure 1.9 Major fault detection methods [46] ................................................................12 Figure 1.10 Major fault diagnosis methods [46] ..............................................................13 Figure 1.11 Major fault prognosis methods [2]................................................................16 Figure 1.12 Different stage of a model-based CBM/PHM framework ............................22 Figure 2.1 Geometry of orbit motion for rigid body spacecraft ......................................24 Figure 2.2 Decentralized FDI architecture [134] .............................................................28 Figure 2.3 Semi-decentralized FDI architecture [134] .....................................................29 Figure 2.4 Centralized FDI architecture [134] ................................................................29 Figure 2.5 Reaction wheel model [76] .............................................................................31 Figure 2.6 Reaction wheel unit developed in the SSDC lab at Ryerson University ........33 Figure 2.7 Torque decomposition for RW assembly (a) pyramid, (b) standard four-wheel .......................................................................................................................................34 Figure 2.8 RW assembly (a) pyramid configuration, (b) standard four-wheel configuration .......................................................................................................................................36 Figure 2.9 Pyramid assembly of four SGCMGs (a) schematics (b) free body diagram [135] ................................................................................................................................37 Figure 2.10 Schematics of the particle filter algorithm ..................................................44 Figure 3.1 Placement of fault detection module in a model-based CBM/PHM flow ......48 Figure 3.2 Comparison of  and its threshold for transient fault scenario (a) and (b) between (c) fixed and (d) adaptive approaches ..............................................................58 Figure 3.3 Simulation setup for performance evaluation of the proposed filter...............60 Figure 3.4 Case 1 ­ state and parameters estimates for abrupt fault with =10 ...........62 Figure 3.5 Case 1 - state and parameters residuals for abrupt fault with =10 .............62 Figure 3.6 Case 1 ­ and for abrupt fault with =10 .............................................62

xiii

Figure 3.7 Case 1 ­ comparison of estimates for abrupt fault with =10 .................63 Figure 3.8 Case 1 ­ comparison of estimates for abrupt fault with =10 .............63 Figure 3.9 Case 2 ­ comparison of estimates for transient fault with =10 ..............68 Figure 3.10 Case 2 ­ comparison of estimates for transient fault with =10 ........68 Figure 3.11 Case 3 ­ comparison of estimates for intermittent fault with =10........69 Figure 3.12 Case 3 ­ comparison of estimates for intermittent fault with =10...70 Figure 3.13 Case 4 ­ comparison of estimates for incipient fault with =10.............71 Figure 3.14 Case 4 ­ comparison of estimates for incipient fault with =10 ........71 Figure 3.15 Simulation results for CMG fault isolation out-of-phase abrupt CMG faults with =10 (a) Satellite attitude (b) Satellite angular velocities (c) Scaler  trend (d) CMGs gimbal angles.......................................................................................................74 Figure 3.16 Comparison of fault parameters estimates for out-of-phase abrupt fault with =10 (a) CMG1 (b) CMG2 (c) CMG3 (d) CMG4 .........................................................75 Figure 4.1 Placement of fault isolation module in a model-based CBM/PHM flow .......77 Figure 4.2 Proposed hierarchical approach towards fault isolation .................................78 Figure 4.3 Proposed fault isolation scheme based on likelihood and probability distribution .......................................................................................................................................82 Figure 4.4 Proposed fault isolation scheme for formation level.......................................85 Figure 4.5 Attitude response of the system under fault scenario 15 with pyramid RW assembly: (a) satellite #1 quaternions (b) satellite #2 quaternions (c) satellite #3 quaternions (d) satellite #4 quaternions ........................................................................86 Figure 4.6 Angular velocity of the system under fault scenario 15 with pyramid RW assembly: (a) satellite #1 angular velocities (b) satellite #2 angular velocities (c) satellite #3 angular velocities (d) satellite #4 angular velocities.................................................86 Figure 4.7 Angular velocity of the RWs for all satellites under fault scenario 15 ...........87 Figure 4.8 Proposed fault isolation simulation setup ......................................................90 Figure 4.9 Attitude response of the system under fault scenario 1 with pyramid RW assembly: (a) satellite quaternions (b) satellite angular velocities (c) reaction wheels torques (d) satellite angular velocities in 3D axes (e) satellite quaternions in 3D axes ..91 Figure 4.10 Attitude response of the system under fault scenario 1 with standard fourwheel RW assembly: (a) satellite quaternions (b) satellite angular velocities (c) reaction wheels torques (d) satellite angular velocities in 3D axes (e) satellite quaternions in 3D axes ................................................................................................................................94 Figure 4.11 Fault isolation performance, scenario 1, pyramid assembly, uniform initial distribution: first iteration (a) prior probability (b) likelihood (c) posterior probability; final iteration (d) prior probability (e) likelihood (f) posterior probability.....................95 Figure 4.12 Fault isolation performance, scenario 1, pyramid assembly, normal initial distribution: first iteration (a) prior probability (b) likelihood (c) posterior probability; xiv

final iteration (d) prior probability (e) likelihood (f) posterior probability.....................95 Figure 4.13 Fault isolation performance, scenario 1, standard four-wheel assembly: first iteration (a) prior probability (b) likelihood (c) posterior probability; final iteration (d) prior probability (e) likelihood (f) posterior probability .................................................96 Figure 4.14 Fault isolation performance, scenario 6 and 9, pyramid assembly: final iteration for scenario 6(a) prior probability (b) likelihood (c) posterior probability; final iteration for scenario 9 (d) prior probability (e) likelihood (f) posterior probability ......96 Figure 4.15 Attitude response of the system to multiple faults scenario 1 with pyramid RW assembly: (a) satellite quaternions (b) satellite angular velocities (c) reaction wheels torques (d) satellite angular velocities in 3D axes (e) satellite quaternions in 3D axes ..98 Figure 4.16 Attitude response of the system to multiple faults scenario 2 with pyramid RW assembly: (a),(e) satellite quaternions (b),(d) satellite angular velocities (c) reaction wheels torques ................................................................................................................99 Figure 4.17 Fault isolation performance, multiple fault scenario, pyramid assembly: final iteration of scenario 1 (a) prior probability distribution (b) likelihood (c) posterior probability distribution; final iteration of scenario 2 (d) prior probability distribution (e) likelihood (f) posterior probability distribution ............................................................ 100 Figure 4.18 Simulation results for CMG fault isolation in-phase abrupt CMG faults with =10 (a) Satellite attitude (b) Satellite angular velocities (c) Scaler  trend (d) CMGs gimbal angles ................................................................................................................ 102 Figure 4.19 Comparison of fault parameters estimates for in-phase abrupt fault with =10 (a) CMG1 (b) CMG2 (c) CMG3 (d) CMG4................................................................. 103 Figure 5.1 Placement of fault prognosis module in a model-based CBM/PHM flow .... 105 Figure 5.2 Different stages of model-based prognostics ................................................ 106 Figure 5.3 Fault location statistics for a group of reaction wheels................................ 107 Figure 5.4 Particle filtering process visual representation............................................. 110 Figure 5.5 Inverse CDF resampling method ................................................................. 110 Figure 5.6 RUL prediction process schematics ............................................................. 111 Figure 5.7 State and parameters estimates for incipient fault with =10 .................... 115 Figure 5.8 and for incipient fault with =10....................................................... 115 Figure 5.9 State and parameters residuals for incipient fault with =10 ..................... 115 Figure 5.10 Comparison of estimates for incipient fault with =10 ........................ 116 Figure 5.11 Comparison of estimates for incipient fault with =10 .................... 116 Figure 5.12 Flow of the fault detection leading to fault prognosis................................ 116 Figure 5.13 Fault prognosis for under normal noise................................................. 118 Figure 5.14 RUL distribution based on damage model for normal noise ................. 118 Figure 5.15 Fault prognosis for under normal noise .................................................. 119 Figure 5.16 Fault prognosis for under normal noise .................................................. 119 xv

Figure Figure Figure Figure

5.17 5.18 5.19 5.20

Fault prognosis for under lognormal noise ............................................ 121 RUL distribution based on damage model for lognormal noise ............. 122 Fault prognosis for under lognormal noise.............................................. 122 Fault prognosis for under lognormal noise ............................................. 123

xvi

Nomenclature
Alphabetical identity matrix , , , , ,
× !

back electromotive force constant x, y, z-axes for the Earth-centered inertial frame x, y, z-axes for the orbital frame  x, y, z-axes for the body-fixed frame principal axis from Euler's theorem Euler parameters representing the spacecraft body frame orientation orientation transformation matrix from body frame to orbital frame spacecraft distance from the center of the Earth average Earth radius angular momentum generated by a momentum exchange device altitude of the spacecraft from the surface of the Earth bus current bus voltage motor current back electromotive force voltage gain temperature motor disturbance term motor disturbance term the electromotive torque limiting block approximation of the sign function in the Coulomb friction block speed limiter block fault parameters matrix fault parameter torque command voltage ripple torque cogging torque motor torque constant bridge resistance



,

'%&$ +

%&$

$



"

() +

+, +. + 0 + -

*

'23

/0 B C
4

xvii

56 8 9
; 7

driver gain number of motor poles input filter resistance quiescent bus power voltage feedback gain state vector at time step k over-speed circuit gain measurement vector at time step k process noise covariance matrix

N

?;   A A

>;  

;



 < @;
; <

: $

additive process noise at time step k

additive measurement noise at time step k measurement noise covariance matrix component weight matrix for covariance calculation component weight matrix for mean calculation dimension of the states output of the measurement model covariance of the measurements matrix n-state random variable sigma points discretization step size posteriori estimates covariance matrix the result of instantiated sigma points through measurement model cross covariance matrix Kalman filter gain residual sequence covariance matrix window size number of samples effective sample size true weight temporary posteriori estimate covariance matrix residual error input voltage initial input voltage xviii

( )

(!)

8 FF

D G

E

dt = L = *$ 8MF 8 MM
N

G0

P):: ' !3

88;

N >;

P$

P

(
O

' !3

R
S

@T DU V3&4
3&4 × × T

initial process noise covariance matrix initial measurement noise covariance matrices reaction wheel motor current adaptive threshold factor for the each faulty case scenario index in the residual window initial value for the residual index of the case with maximum probability threshold for confidence in the output of the logic reaction wheel assembly mapping matrix satellite moment of inertia including the actuators satellite moment of inertia RWs moment of inertia failure threshold

RN,T
×-

W

V

Y>  

Y$  

X Y

-×4$

Greek



  
× ×

orbital frame body-fixed coordinate frame earth-centered inertial (ECI) reference frame angular velocity relative to inertial frame expressed in body frame external torque axial angular velocity of the reaction wheels torque generated by RWs principal angle  magnitude of the orbital angular velocity of LVLH frame orbital frame angular velocity gravitational constant parameter control torque applied by the momentum exchange device gravity gradient torque solar radiation pressure aerodynamic torque other disturbances reaction wheel angular speed xix





viscous torque torque noise disturbance Jitter Angle Driver Bandwidth Maximum Wheel Speed in-plane angle for RW and CMG out-of-plane angle for RW and CMG Kronecker-Z function control moment gyro gimbal angle scalar value [ threshold for CAUKF , , mean scalar value [ for CAUKF Kalman filter parameters process noise standard deviation measurement noise standard deviation motor current noise standard deviation adaptive fading factor for Kalman filter

standard deviation of scalar value [ for CAUKF

Notations

[ ]

( )  × [ ]   | |  
+ -

( )

\(G)/\L

\ , (G)/\L ,

skew-symmetric matrix for matrix G transpose operation of matrix G Euclidian norm of G absolute value of G estimate of G mean of G

value of G at time 0 (initial value) post-process value of G pre-process value of G a vector of frame  relative to frame , expressed in frame  xx

Functions

() () () () () () () () () [ ]

nonlinear process model nonlinear measurement model variance of a set probability of the condition inside brackets sine cosine Kronecker-Z function, resulting in 1 if importance density probability density function importance density or density of a distribution expected value sum of the diagonal elements of a matrix
N ;

sin() =

cos() = ()

Pr()

is in the set and 0 otherwise

Acronyms AAD ACC ACS AR ARIMA ASIR AUKF BEMF BLDC BM CAUKF CBM CDF CI CMG CRLB CSS DGCMG Attitude Anomaly Detection Accuracy Attitude Control System Autoregressive Autoregressive Integrated Moving Average Auxiliary Sampling Importance Resampling Adaptive Unscented Kalman Filter Back Electromotive Force Brushless Direct Current Bayesian Methods Covariance Matching Adaptive Unscented Kalman Filter Condition-Based Maintenance Cumulative Distribution Function Confidence Interval Control Moment Gyro Cramér­Rao lower bound Coarse Sun Sensor Double-gimbal Control Moment Gyro xxi

DPHM ECI EKF FDI FLOPS FN FP FSS FUSE GYR HI HOF IID ILO IMM INPID JAXA JWST KF LEO LIP LOE LVLH MC MGM MGT MIT MM MSE MTTF MW ND-AR PCA

Diagnosis, Prognosis, and Health Monitoring Earth Centered Inertial Extended Kalman Filter Fault Detection, Isolation, and Identification Floating Point Operations Per Second False Negative False Positive Fine Sun Sensor Far Ultraviolet Spectroscopic Explorer Gyroscope Health Index Hard-Over Failure Independent and Identically Distributed Iterative Learning Observer Interacting Multiple Models Iterative Neuron Proportional, Integral, and Derivative Japan Aerospace Exploration Agency James Webb Space Telescope Kalman Filter Low Earth Orbit Lock in Place Loss of Effectiveness Local Vertical Local Horizontal Monte Carlo Magnetometer Magnetorquer Massachusetts Institute of Technology Multiple Model Mean Squared Error Mean Time to Failure Momentum Wheel Nonlinear Degradation Auto Regression Principal Component Analysis xxii

PF PHM PPV PR RK4 RMS RPF RRG RUL RVM RW RWA SDA SGCMG SHM SIR SIS SMC SOH STR SVM SVR TESS TIMED TN TP UKF WAFT

Particle Filter Prognostics and Health Management Positive Predictive Value Prediction Interval Runge-Kutta Root Mean Squared Regularized Particle Filter Robotics Research Group Remaining Useful Life Relevance Vector Machine Reaction Wheel RW Assembly Stacked Denoising Autoencoder Single-gimbal Control Moment Gyro Structural Health Monitoring Sampling Importance Resampling Sequential Importance Sampling Sequential MC State of Health Star Sensor Support Vector Machine Support Vector Regression Transiting Exoplanet Survey Satellite Thermosphere, Ionosphere, Mesosphere Energetics and Dynamics True Negative True Positive Unscented Kalman Filter Weight Application to Exponential Parameters

xxiii

Introduction

1.1 Motivation

CHAPTER 1

Introduction

I

n the recent years, the topic of intelligent systems and autonomous vehicles has attracted a wide range of scientists and industries. The need for more intelligent systems comes from the fact that technological systems are vulnerable to faults [1]. With the paradigm shift in systems complexity and advances in technological processes[2], it is imperative to formulate and employ autonomous systems capable of self-monitoring and maintenance. Over the past years, condition-based maintenance (CBM), prognostics, and health management (PHM) have emerged as powerful and significant technologies that have positively influenced the military and commercial sectors. Reaction wheels (RW) and control moment gyros (CMG) are the most commonly used actuators in spacecraft attitude control system; they are prone to malfunction, which could lead to catastrophic failures. Such malfunctions can be detected and addressed in time if proper analytical redundancy algorithms such as parameter estimation and control reconfiguration are employed. Major challenges in parameter estimation include speed and accuracy of the employed algorithm. Tracking changes in system parameters for mechanical systems has been of constant interest for system monitoring and control [1­4]. Analytical redundancy, as one of the major subsidies in this field, has evolved to remedy the limitations of hardware redundancy for complex systems. Such limitations include major budget constraints, space limitations for design and manufacturing, concerns with safety and reliability, etc. One of the major challenges in system monitoring and fault detection is to achieve the ability for tracking sudden changes in non-measurable system parameters; this becomes more challenging when the system under study is nonlinear and complex. Reaction wheels and control moment gyros can be considered as such and are prone to hardware failures [5]. Sudden changes in non-measurable RW/CMG parameters can occur while operating in space. If such changes are not tracked precisely, and with a reasonable delay, catastrophic failures could occur. Therefore, a framework that could detect faults, isolate and identify their location and severity onboard satellite and forecast the remaining useful life (RUL) of the faulty components can help develop fail-safe satellites where hardware redundancy is not possible. This can be accomplished through providing alternative options for the system to maintain its partial operability in order to accomplish its mission or fail without catastrophic consequences through reprogrammed control logic for less risky failures. This thesis, aims to address this need in space system actuators by proposing a CBM/PHM framework.

1

Introduction

1.1 Motivation

1.1 Motivation
Heavier satellites need larger launchers, whereas, smaller satellites only require lower end launch vehicles and can be launched in multiples. Therefore, they bring about financial benefits making it possible to save costs for design and mass production. They also bring about the opportunity to enable missions, otherwise impossible by larger satellites such as arrangements for low data rate communications, formations flying to gather data from multiple points, in-orbit inspection, data collection, and monitoring of larger satellites, and finally university-related research projects. Satellites, in terms of mass, can be categorized into eight major categories [3], [4]. Table 1.1 shows each class of satellites with their corresponding mass and production costs. As can be observed from Table 1.1, production costs immensely decrease with the decrease in mass and size of the satellite. Therefore, smaller satellites like RyeSat [5], BeeSat [6], and BeeSat2 [7], individually or in a formation are preferred compared to their larger costly counterparts.
Table 1.1 Satellite program costs by mass [3], [4]

Class Large Medium Mini Micro

Mass (kg) >1000 500-1000 100-500 10-100

Cost (M US$) >100 50-100 5-20 2-3

Class Nano Pico Femto Atto

Mass (kg) 1-10 0.1-1 0.01-0.1 0.001-0.01

Cost (M US$) 0.5-1 <0.08 <0.0001 ~100 US$

This preference has started a shift in the way satellites are being designed, developed, and manufactured. Tafazoli [8] has provided an extensive review of 156 on-orbit spacecraft failures conducted on more than 130 different spacecraft up to 2009 where he provides some insights on how to avoid most common failures in the most vulnerable satellite subsystems. SpaceWorks Enterprises publishes an annual report on small satellites marketing assessments. Their 2014 report [9] analyses the developments to date and provides a potential market for future developments until 2020. SpaceWorks had estimated that 93 nano/microsatellites would launch globally in 2013 where 92 were actually launched and showed a 269% increase over 2012. In SpaceWorks' 2017 report [10] it is mentioned that they had estimated 210 nano/microsatellites global launches across all sectors in 2016; however, only 101 nano/microsatellites were actually launched which represents a 23% decrease compared to 2015. The major factor contributing to this shortfall was launch delays. However, SpaceWorks' 2017 forecast reflects that despite technical challenges and a continuing backlog of satellites awaiting launch (including SpaceX's Falcon family and Spaceflight Industries' SHERPA), the market potential for the industry remains high. According to Figure 1.1,

2

Introduction

1.1 Motivation

about 2400 nano/microsatellites will require a launch during 2017-2023. Sector-wise, referring to Figure 1.2, commercial satellites will be the majority of the future small satellites deployed in the space as the government projects shrink in the upcoming years. In addition, academic small satellites deployment will be a record in 2017 as industrious are working through their current launch backlog. Figure 1.3 shows that the Earth observation and remote sensing applications of small satellites are growing rapidly.

Figure 1.1 SpaceWorks small satellites launch historical, current, and future projections data

Figure 1.3 SpaceWorks nano/microsatellite trends by purpose: (Left) 2009-2016 (Right) 2017-2019

This growth requires advanced monitoring systems that can compensate for the lack of redundancy in hardware due to smaller design and mass restrictions. Table 1.2 summarizes 3

Percentage of satellites
Figure 1.2 SpaceWorks nano/microsatellites trends by sector

Introduction

1.1 Motivation

some of the recent momentum/reaction wheel failures in space programs emphasizing on the importance of proper monitoring systems in place to avoid such failures. In 2005, two of the Japan Aerospace Exploration Agency (JAXA) Hayabusa's RWs failed, causing the mission plan to be altered. The failed reaction wheels were manufactured by ITHACO Space Systems, later acquired by Goodrich. On 12 July 2007, NASA's Far Ultraviolet Spectroscopic Explorer (FUSE) final RW failed and caused mission termination. One of the NASA's Thermosphere, Ionosphere, Mesosphere Energetics and Dynamics (TIMED) RWs failed in 2007. Another case was observed in NASA's Dawn spacecraft where it suffered two RW failures in 2010 and 2012. Kepler's RWs failed on 14 July 2012 and 11 May 2013, stopping its primary mission. Another telescope that will rely on the functionality of the RWs is the Transiting Exoplanet Survey Satellite (TESS) [11], which is set to launch in 2017 searching for Earth-like planets. TESS is part of NASA's Explorer program led by a team from Massachusetts Institute of Technology (MIT). Reaction wheels are essential parts of a telescope as they aim the telescope with pinpoint accuracy and allow it to focus on a small desired target for long periods. Larger satellites can afford to carry redundant wheels in case of faulty behavior or failure of main RW units. For example, Swift Gamma-Ray Burst Explorer (Swift) employs six RWs for rapid slewing, and the James Webb Space Telescope (JWST) used a similar RW configuration. However, for smaller satellites including nano/microsatellites, hardware redundancy cannot be accommodated due to limited space and power budget.
Table 1.2 Summary of on-orbit failure of MW/RW/CMG [12]

Spacecraft Radarsat-1 ISS Hayabusa FUSE TIMED Dawn Kepler

Cause of anomaly
2 pitch MWs failed 1 CMG failed on June 8 X and Y axis RW failed on July 31 and October 2, respectively Final RW required for accurate pointing failed Single RW failure Two RW failures due to excessive friction development Two RW failures disabled accurate positioning/data collection

Year 1999, 2002 2002 2005 2007 2007 2010, 2012 2012, 2013

This is where analytical redundancy comes in. CBM and PHM can provide means to detect, isolate, and forecast future failures based on available historical data, a mathematical model of the system, and the combination of the two. Therefore, in this study, we are interested in exploiting the possibility of providing a framework for prognostics and health monitoring of small satellites. This seems feasible when hardware redundancy is not an option, but rather analytical redundancy is available to compensate for the lack of physical space and reliabilty improvements. In this thesis, we investigate three main components of a CBM and PHM framework, namely fault detection, fault isolation, and fault prognosis. The goal

4

Introduction

1.2 Satellite Attitude Control System

is to develop, implement, and assess the performance of fault detection, fault isolation, and fault prognosis algorithms for individual RWs/CMGs, assembly of three or four RWs/CMGs, and RWs/CMGs as part of satellite attitude control system (ACS). As discussed earlier, early detection, isolation, and identification of fault onboard satellite can help eliminate early mission abortions, unexpected extra costs, and finally the development of fail-safe satellites.

1.2 Satellite Attitude Control System
The ACS is one of the satellite subsystems with main functionality of controlling its attitude, which processes telecommands and telemetry data. It also obtains measurements from a set of sensors on a continuous basis and uses them to calculate control signals needed for a set of actuators. The schematic for a closed-loop controlled satellite attitude and orbit system is shown in Figure 1.4. In the following sections, each block of this diagram will be defined and discussed as needed.
Fault Management Block

Control Switching Scheme
Desired Attitude + +e

Fault Isolation Scheme
Torque Command u ~ x

Fault Detection Scheme
Control Torque 

Disturbance Torques Spacecraft Attitude

Controller
^ x

Actuators

Spacecraft Dynamics
x

y

Estimator/ Observer

Attitude Sensors

+

Noise
Figure 1.4 Schematic of the fault tolerant satellite attitude control system

The ACS is usually responsible for the following functions [13]: Attitude Control Function: for any satellite, a nominal attitude is defined, which it should ideally maintain. It may be either calculated on the ground and sent to the

satellite or computed by ACS onboard. Actuators help maintain the nominal attitude
under a closed loop and autonomous control system. Telecommand Processing: in order to process information received from the ground, telecommands are sent to the ACS in an asynchronous manner. Telemetry Processing: the ACS generates telemetry and sends it to the central computer. Failure Detection and Isolation: the ACS is responsible for detecting anomalies 5

Introduction

1.2 Satellite Attitude Control System

and isolating their cause. Typical checks include: 1. Attitude Anomaly Detection (AAD), which ensures that the nominal attitude is maintained. 2. Single Sensor Consistency Check, which verifies that the sensor outputs are feasible and within operational range. 3. Multi-Sensor Consistency Check, which cross-checks multiple sensors outputs for the same measurement to detect and, if possible, isolate failures. 4. Watchdog Alarm, which is triggered if a `watchdog event' is not captured by its dedicated hardware (the `watchdog') within a certain period. Failure Recovery: recovery actions include ACS software reset, notifying the ground and take no further actions, changing the operational mode, reconfiguring a sensor or an actuator. Reconfigurations: due to redundancy requirements, the ACS only uses a subset of its available units at any given time. When the ACS detects a failure, attempting to recover by performing a reconfiguration is necessary to exclude the faulty unit. The types of reconfigurations include: 1. Unit Reconfiguration: if the faulty unit is identified, a switchover to the redundant copy of the faulty unit is performed. 2. Subsystem Reconfiguration: if fault isolation fails, all subsystem units are switched over to their redundant copies followed by a re-initialization of the subsystem. Manoeuvre Execution: in order to achieve a pre-defined goal, ACS is responsible for performing a sequence of actions at the certain time. 1.2.1 ACS Units The main ACS units consist of its sensors and actuators. The sensors are used to collect measurements while the actuators deploy torques and forces. There are two types of attitude sensors: one with no internal processors (Passive) and the other one with an internal processor (Active). The most common types of passive sensors are shown in Figure 1.5 [13]:
ACS Sensors Passive FSS CSS SPS ES MGM GYR Active STR GPS Actuators RW/MW MGT CMG

Figure 1.5 Satellite attitude control system units

6

Introduction

1.2 Satellite Attitude Control System

where Fine Sun Sensor (FSS) and Coarse Sun Sensor (CSS) measure the direction of the sun line with high and low accuracy, accuracy. Sun Presence Sensor (SPS) outputs "sun present" and "sun not present". Earth Sensor (ES) measures the earth direction. Magnetometers (MGM) measure the direction of the earth's magnetic field. Gyroscope (GYR) measures satellite's inertial angular rate. Star Sensor (STR) measures positions of several stars. GPS Receiver provides position determination. Reaction wheel (RW) provides a torque by accelerating or decelerating its flywheel. Momentum wheel (MW) provides a constant torque using its constant speed rotating wheel. Magnetorquers (MGT) generate control torques by interact with the Earth's magnetic field. And finally, Control Moment Gyros (CMG) are gimballed RWs. 1.2.2 Actuators The most common actuator technologies for small satellites are RWs/MWs, thrusters, and magnetorquers, while CMGs are found in larger satellites. An RW consists of a flywheel attached to an electric motor. Minimum of three RWs are required for fully actuated attitude control. RWs can be used to perform maneuvers or to keep the system stable under disturbances by accelerating or decelerating its wheel. An MW, on the other hand, is always spinning at a very high speed helping stabilization of the spacecraft, making it resistant to change its attitude. An MGT usually consists of a wire coil with a ferrite core. When a current passes through the coil, a magnetic field is created. Multiple MGTs can form a magnetic dipole that counteracts the Earth's magnetic field and provides two-axis pointing of a spacecraft. MGTs are usually employed along with RWs for full three-axis attitude control. Finally, CMG is a momentum exchange device similar to an RW and MW. A CMG unit consists of a flywheel that is gimballed about one, two, or three of its axes. Gyroscopic torques are generated as the angular momentum vector is rotated about axes perpendicular to the flywheel spin axis. International Space Station (ISS) uses CMGs, Hubble has MWs and Kepler employs RWs. Depending on mission requirements one type of actuator may deem more appropriate. In particular, the required degree of pointing accuracy is a primary factor for selecting actuators. MGTs provide the lowest pointing accuracy because of the timevarying nature of the Earth's magnetic field and their inability to provide control about more than two axes. They are usually used in conjunction with RWs and CMGs for momentum dumping. For a small satellite, MGTs are small enough to satisfy the mass/power/volume constraints; hence, making them a popular choice. RWs provide substantially improved pointing accuracy and agility relative to MGTs. However, power consumption and mass tend to be larger. CMGs can provide even more accurate and agile pointing capabilities due to their torque amplification characteristics and gyroscopic

7

Introduction

1.3 Fault Detection, Isolation, and Prognosis

stabilization at a price of larger units, more complex dynamics, and power consumption. Based on a study by [8], more than half of the failures (54%) in ACS are mechanical in nature,while a small portion is electrical and although there is a large portion of unknown component responsible for these failures, gyroscopes, momentum wheels and thrusters attribute to about 50% of ACS failures.

1.3 Fault Detection, Isolation, and Prognosis
Faults and failures are inevitable when dealing with mechanical parts and if occurred, can add to the costs of a mission or lead it to termination. The most probable area on spacecraft for a fault to occur is in its ACS, more particularly its actuators. Most actuators consist of moving mechanical parts. These components are subject to unanticipated faults/failures like cold solder joint, minute particles, or massive temperature fluctuations [14]. Traditionally, faults and failures were dealt with hardware redundancy in larger satellites. However, recently due to budget constraints, hardware redundancy is limited. Therefore, in the case of a fault occurrence, numerical methods can be utilized to diagnose and correct the problem(s). If the satellite can detect, isolate, and identify faults, the operators can take remedial actions remotely, or the satellite could autonomously correct itself. Eventually, the aim is to achieve at least partial completion of a mission in the presence of faults/failures. As a result, fault detection, isolation, and identification (FDI) techniques have been developed to monitor/estimate some of these parameters. Furthermore, prognostics techniques are developed to for estimating such parameter's remaining useful life (RUL) and mean time to failure (MTTF). 1.3.1 Fault Classification A "fault" is used to denote an unpredicted change of system behavior that results in a degradation of performance or prevents any semblance of normal operation of the system. Actuator faults can be categorized as (1) additive, and (2) multiplicative, based on their modeling and addition to the system (Figure 1.6). Additive faults are typically observed in ACS actuators RWs. Changes in friction between stator and rotor resulted from aging or temperature can lead to discrepancies between the generated and commanded torques. When malfunctioning of the actuator leads to continuous addition or lack of torque or force, such faults can be modeled as an abrupt change in the nominal control action and categorized as multiplicative faults.
fault signal fault faulty signal signal faulty signal

+
Additive

Multiplicative

Figure 1.6 Types of faults based on addition to the system

8

Introduction

1.3 Fault Detection, Isolation, and Prognosis

Faults can also be categorized based on their form or timely characteristics as (1) abrupt, (2) transient, (3) intermittent, and (4) incipient (Figure 1.7). Abrupt faults occur instantaneously due to hardware damage. This can lead to a complete failure of the unit unless the unit is repaired or replaced. Transient faults represent a temporary malfunction in the unit, and if repeated they are categorized as intermittent. Such faults may or may not be crucial to the performance of the unit depending on the time of occurrence. Finally, incipient faults are gradual variations in the actuator performance and typically appear with the aging of the unit. Enduring incipient faults is crucial in ACS as their propagation over time can lead to complete system failure. Fault prognostics is a useful asset in forecasting fault propagation and estimating unit's RUL and MTTF.
fault fault fault fault

time Abrupt Transient

time

time Intermittent Incipient

time

Figure 1.7 Types of faults based on time characteristics

The nature of failures in RW and their consequential effects on the system performance can be categorized under four major fault scenarios [15]: 1. Failure to respond to control signal: due to faulty drive electronics drive motor, and power supply, the wheel fails to respond to any control signals and decelerates slowly or holds its position. This can cause zero or undesired torque outputs from the wheel. 2. Decreased reaction torque: caused by the friction between rotor and stator, marginal failure of the bearings, or decreased motor torque and current drive can lead to less than desired/commanded reaction torque from the wheel. 3. Increased bias torque: incipient faults, caused by friction due to aging, or time-varying temperature, etc. can lead to undesired acceleration or deceleration of the wheel. Consequently, the wheel would generate a bias torque even in the event of zero commanded torque. 4. Continuous generation of reaction torque: intermittent time-varying faults in the motor current or fault in the bus voltage can lead to continuous increase/decrease in the wheel speed. This can lead to undesired reaction torques generated by the wheel regardless of the commanded torque by the controller. Furthermore, CMGs can face particular types of problems including singularities, saturation, anti-parallel alignment, and hitting the gimbal stops.

9

Introduction 1.3.2

1.3 Fault Detection, Isolation, and Prognosis

Fault Diagnosis and Prognosis Cycle A comprehensive health management system integrates readings from the monitoring sensor through the reasoning software, which offers optimal use of maintenance assets. This strategy relies intensely on the ability to (1) predict the inception of forthcoming faults/failures or RUL of critical components accurately and (2) isolate the root cause of such anomalies efficiently. This can lead to the main objective of the health management system, which is maximizing system availability and minimizing its downtime through more effective troubleshooting. The two main steps of CBM/PHM frameworks are (1) extraction of trends from measurements, (2) interpretation of the extracted trends [16]. Extensive work has been done on trend extraction and representation [17]. Primary components of the interpretation schemes include (1) detection (2) isolation and identification (3) prognostics (Figure 1.8). In FDI, fault detection refers to determining fault presence in a system, fault isolation determines the type, location, and time of detection of a fault, and comes after fault detection. Fault identification determines size and behavior of a fault proceeding fault occurrence and comes after fault isolation. Fault diagnosis refers to fault isolation, and identification tasks joined. Finally, fault prognosis refers to determining the RUL and MTTF of a component in faulty conditions, which can help with scheduling maintenance actions taken onward.
Machine Sensors
Data

Fault Detection

Symptoms

Fault Isolation

Fault Identification

PreProcessing

Feature Extraction

Fault Classification
Diagnostics

Prediction of Fault Evolution
Prognostics

Schedule Maintenance
Maintenance Scheduling

Systems and Signal Processing

CBM

current fault condition
Figure 1.8 The CBM/PHM cycle

PHM

The focus of this thesis is on the interpretation of the measurement aspect of the CBM/PHM process. Particularly, we will look at fault detection, fault isolation, and fault prognosis modules of the process. In each module, based on the literature reviewed, a new approach is proposed to handle the problem at hand. Next, the proposed methodology is implemented in a simulation for a high-fidelity system to evaluate its performance and compare its results with some of the existing methods. In the following section, a literature review on the above-mentioned modules is provided to outline the problems addressed in this thesis.

10

Introduction

1.4 Literature Review

1.4 Literature Review
Recent developments in micro and nanotechnology have changed the focus of design and manufacturing in the aerospace industry toward smaller, lower-cost spacecraft [18]. The smaller the satellites become, there is less space to accommodate larger high accuracy or redundant hardware. Therefore, ACS actuator failure is still one of the most common causes of spacecraft operational deficiencies. Therefore, the need for analytical redundancy measures to compensate for the lack of hardware redundancy and lower precision is paramount. This section places the objectives of this thesis in perspective with the state-of-theart fault detection, isolation, and prognosis techniques available in the literature for various purposes including spacecraft attitude control using reaction wheels. 1.4.1 Fault Detection Several researchers have examined the problem of fault detection, isolation, and identification [19]­[22]. Gertler [19] has surveyed model-based methods for fault detection and concludes that major quality issues for failure detection algorithms are isolability, sensitivity, and robustness. Marzat et al. [20] have reviewed model-based fault diagnosis approaches for aerospace systems; these approaches include expert systems [23], neural networks [24]­[26], support vector machine (SVM) [27]­[29], principal component analysis (PCA) [30]­[33], parameter estimation [34], [35], Kalman filters (KF) [36]­[38], and unscented Kalman filters (UKF) [39]­[43] and Cubature Kalman Filter (CKF) [44]. More recently, Gao et al. [21], [22] have comprehensively reviewed fault diagnosis approaches and their applications from the model and signal-based perspectives. Tidriri et al. [45] have also investigated features of different model-based and data-driven fault diagnosis and health monitoring individually as well as hybrid approaches that incorporate advantages of each. Figure 1.9 illustrates major fault detection methods as discussed in [46]. The reviewed literature suggests advantages of using Kalman filters as small false alarm rate, short detection delay, robustness to model uncertainty, and isolation of simultaneous faults with the only limitation being restrictive Gaussian noise assumption. In addition, parameter estimation using Kalman filters is considered as an effective approach for structural damage detection with the limitation of non-applicability for on-line identification due to time delays. The following categories can be mentioned in the field of fault detection and diagnosis: 1) Mathematical model-based: which is the main approach employed in this study, consists of using a mathematical model of the system with ideal behavior in a fault-free mode. The outputs of the model are compared to the measured states and when noticeable deviations are observed a fault is annunciated. Boskovic et al. [47] designed thruster FDI based on Multiple Models while Wu and Saif [30] developed a nonlinear iterative neuron proportional, integral, and derivative (INPID) observer-based FDI. Tudoroiu and Khorasani

11

Introduction

1.4 Literature Review

[48] developed FDI for RW using multiple interacting models while Azarnoush and Khorasani [49] applied linear and nonlinear observers for the same purpose. The main deficiency of adaptive-observer-based FDI methods is their inability to detect time-varying faults. An iterative learning observer (ILO) was proposed by Chen and Saif [50] to overcome this limitation.
Fault Detection Methods Detection with single signal Limit/Trend checking Fixed threshold Change detection methods Adaptive threshold Signal models used Spectrum analysis Correlation Wavelet analysis SVM Detection with multiple signals and models Multi-variant data analysis Process model used

Parameter PCA estimation Neural networks

State estimation Parity equations

State observers

Figure 1.9 Major fault detection methods [46]

2) Learning-Based: use time-histories of the system input/output data to learn its mathematical model and generate residuals. Li and Khorasani [51] used a dynamic neural network to learn the non-linear RW dynamics and generate residuals. Later, a fault identification function was developed using a mathematical model of the system along with selflearning computational intelligence techniques [52]. The algorithm was only able to identify one fault at a time, and its application to different systems required redesign and re-training of the algorithm's intelligent portion. 3) Expert System-Based (fuzzy rule-based): employs a set of "if the" rules that are based on expert knowledge of the system or otherwise neural networks. Neural networks can well perform trend analysis and/or feature extraction to determine the operating state of a system [53], [54]. Clustering algorithms based on Bayesian classification rules have also been developed to classify data into clusters representing a particular operating condition of the system [55]. 1.4.2 Fault Isolation There are two main categories of fault isolation approaches [56], [57]: model-based and data-driven. When the precise mathematical model of the system under study is not available, data-driven approaches are more suitable. Figure 1.10 illustrates major fault diagnosis methods available in the literature.

12

Introduction
Fault Diagnosis Methods Quantitative Model-Based Observers Parity Space EKF Digraphs Fault Trees Qualitative Model-Based Casual Models Abstraction Hierarchy Functional Structural

1.4 Literature Review

Process History Based

Qualitative

Quantitative

Qualitative Physics

Statistical Expert QTA Systems PCA/PLS

Neural Networks Statistical Classifiers

Figure 1.10 Major fault diagnosis methods [46]

Various approaches including neural networks [58], fuzzy logic [59], [60], and clustering algorithms [61], [62], as well as hierarchical approaches, have been studied to enhance isolation scheme [59], [63], [64]. However, the main issue with data-driven approaches is the requirement for historical data as well as computational complications. On the other hand, in model-based approaches, residual is generated based on the continuous comparison of the nominal model with current system outputs [19], [20]. An extensive review is published in a three-part series by Venkatasubramanian et al. [56], [57]. Part I, II, and III of this series provide a review on quantitative model-based, qualitative model-based, and history-based approaches, respectively. Parameter estimation methods [34], [35], [41], [65], provide fault detection and isolation simultaneously since they provide time, source, and size of fault by estimating parameters of the system. The limitations of parameter estimation methods are extensive computational resources as well as noise distribution for Kalman-based filters (KF) [66], and speed of convergence for particle-based filters (PF) [67], [68]. Multiple model methods (MM) [36], [48], [69]­[73] use multiple models of the system, one with nominal performance, and others covering a range of faulty conditions. At any given time, the current state of the system is a combination of the output provided by all models. Cheng et al. [74] have combined a model-based approach with an intelligent method to detect and isolate small faults in actuators. Tudoroiu and Khorasani [48] use a bank of interacting KFs for satellite fault diagnosis where all filters run in parallel at all times and a pre-known probability model provides the overall estimate for the satellite states by combining outputs from all individual filters. The limitations in [48] can be listed as (1) Running parallel filters at all times can consume tremendous computational resources. (2) All states are assumed measurable including RW angular velocity and motor current. (3) Only one RW assembly (standard four-wheel) is considered. (4) No disturbance is added to the satellite model, and external disturbances are ignored. (6) RW model dynamics are simplified. (7) Linear KFs are used, and system equations are linearized at various operating points, which limits applicability range for the proposed approach. Jiang and Khorasani [75] have investigated 13

Introduction

1.4 Literature Review

FDI for satellite attitude control subsystem with redundant reaction wheels using sliding mode observer to detect faults and incorporating residuals post-processing to isolate the fault. The limitations of this work are (1) extensive a priori knowledge required to reconstruct each fault scenario for a particular RW assembly. (2) RW model is not detailed, and it is not clear if it is simplified from its original model by [76]. (3) Only one reaction wheel assembly is considered, and particular scenarios are built based on specifics of that configuration. Meskin and Khorasani [77] have worked on a similar problem to [75] where they used a modified standard geometric FDI approach in conjunction with a set of detection filters for fault isolation. The limitations of their work include: (1) RW dynamics is not considered; hence, explicit fault isolation is proposed in their work. (2) Satellite dynamics is simplified and external disturbances are considered as constant values. (3) Particular scenarios are considered based on a priori knowledge of the system where these scenarios my not always hold. In a more recent effort, Meskin et al. [78] have explored an MM approach towards fault isolation of jet engines where they employ multiple linearized models of the system at various operating points to build the overall model piecewise and establish an isolation scheme. The limitation of this approach is the requirement for linearization and consequently its applicability range. In an extension to [78], Pourbabaee et al. [36] have exploited a novel sensor FDI for gas turbine engines using MM approach. Their scheme is based on multiple hybrid KFs representing nonlinear mathematical system model with piecewise linear models. The limitations of their work include (1) The assumption on a minimum delay between "concurrent faults" to allow model reconfiguration, which in the proposed method in this thesis also holds. (2) The assumption on constant severity for sensor bias fault. (3) Lack of feedback from fault identification module to the FDI scheme, which cannot be used for reconfiguring the control logic. In addition to the single satellite and actuator fault diagnosis problem, there exists multiple satellites in formation flying and multi-agent cooperative systems where only very few research results are available in the literature. Barua and Khorasani [59], [63] have developed a decomposition hierarchical framework through a Bayesian network-based model called component dependency model. Their model specifies the network parameters using domain experts' beliefs and node fault diagnosis performance data. In another work by Azizi and Khorasani [79] a constrained-state distributed Kalman filter is proposed to estimate the states of the model for formation, which is developed from an overlapping block-diagonal state-space representation of a hierarchical large-scale system transformed into a constrained-state block-diagonal state-space model. The cooperative fault diagnosis in formation flying of spacecraft is still an open problem. Exchange of information among different units and different levels of the diagnosis system leads to new research problem where Meskin and Khorasani [80] have developed three FDI architectures including centralised, decentralised, and semi-decentralised, for a network of unmanned vehicles with relative

14

Introduction

1.4 Literature Review

state measurements and compared the performance of these architectures. In another attempt, Azizi and Khorasani [81] have considered three levels for fault estimation and recovery in formation flying of satellites, namely low-level, high-level, and formation-level. The satellites are considered as one integrated module, and fault severities are estimated cooperatively by using distributed estimation filters in the formation-level and the high-level acts as a mediator between the formation-level and low-level (component) diagnosis to infuse data and isolate faults using sub-observers. As pointed in [82], the literature on FDI of formation flying of spacecraft is limited to the studies mentioned above. However, the research on FDI of multi-agent systems can be of relevance among which, Meng, Dimarogonas, and Johansson [82] have proposed a decentralised FDI framework for two different cooperative multi-agent system models. And Shames, Teixeira, Sandberg, and Johansson [83] have constructed a bank of unknown input observers for networks of interconnected second-order linear time-invariant systems. More recently Zhang et al. [84] have tackled the problem of unknown input observer for a class of linear multi-agent systems and its application to fault estimation for a leader-follower system. Chadli et al. [85] have proposed a new approach for the design of distributed state estimation and FDI filters for a class of linear parameter-varying multi-agent systems with non-identical state-space representation of the agents, among other research work. 1.4.3 Fault Prognosis The core element of a condition monitoring and assessment block in CBM and PHM is a reliable and real-time fault diagnosis and failure prognosis system [2]. Many researchers have investigated the feasibility of fault prognosis algorithms [86], [87]. Figure 1.11 illustrates major fault prognosis methods found in the literature. An et al. [86] have reviewed data-driven and physics-based prognostic methods and examined advantages and limitations of each method on a particular fatigue crack growth problem. They aimed to provide researchers with practical options for selecting proper methods based on the problem in hand. Liao and Köttig [87] have categorized the developed prognostics models in the literature into experience-based, date-driven, and physics-based and further categorized hybrid approaches into possible combinations of the other two. They argue that there is no universally accepted best model to estimate remaining useful life (RUL) due to system complexity, data availability and application constraints. Further, hybrid approaches in the literature are systematically classified in their study, and a hybrid prognostics method is proposed and applied to a battery degradation [88]. Most researchers have studied the application of fault prognosis and RUL estimation on batteries and specifically lithium-ion type [89]­[95]. Saha et al. [93] have reviewed various approaches toward estimating RUL for lithium-ion batteries including autoregressive integrated moving average (ARIMA), extended Kalman filter (EKF), relevance vector machine

15

Introduction

1.4 Literature Review

(RVM), and particle filter (PF) framework [94]. Bolde et al. [89] have proposed a novel method for the adaptation of parameters in an electrochemical model of a lithium-ion battery using an unscented Kalman filter (UKF) with battery current and voltage over randomized discharge profiles. Liu et al. proposed a Gaussian process model [90] and an improved autoregressive (AR) time series model named Nonlinear Degradation Auto Regression (ND-AR) model [91] for RUL estimation of lithium-ion batteries. Olivares and Muñoz [92] have proposed a PF-based prognostic framework for estimating the state of health (SOH) and predicting the RUL of lithium-ion batteries. Zhou et al. [95] have proposed an on-line data-driven RUL estimation approach using support vector regression (SVR).
Fault Prognosis Methods Model-Based Kalman/ Particle Physicsfilter based Autoregressive Moving Average Probability -Based Bayesian Weibull Data-Driven

RUL PDF

Neural Network

Fuzzy logic

Figure 1.11 Major fault prognosis methods [2]

In the field of aerospace RUL prediction, and particularly satellite actuators, including RWs, there are not many studies available in the literature. Tung and Yang [96] have reviewed, summarized and classified published techniques up to 2009 in diagnosis and prognosis of rotating machinery. Ciandrini et al. [97] have reviewed various fault detection and failure prediction methods for rotating electrical machines. Their study focuses on data collection from accelerometers to acquire vibration measurements on a laboratory-scale experimental system. Jin et al. [98] have proposed a novel reliability estimation framework in terms of physics of failure, which is based on the relationship between the MW's physics performance and its failure mechanisms. Rocchi et al. [99] have proposed a fault prognostics algorithm for rotating electrical machines using recursive least square. Their experimental setup is the same as [97] using vibration data to develop a failure propagation model. Chen et al. [100] have investigated stacked denoising autoencoder (SDA) deep learning method, which is suitable for health state identifications under noisy signals. Wathiq et al. [101] propose an approach for identifying bearing defects in brushless direct current (BLDC) motors under non-stationary operating conditions. They use a recurrent neural network to detect and classify presence of bearing faults with implemented and tested simulations on data collected from an experimental setup. Ahmad et al. [102] propose a bearing degradation model from smoothed historical data using a monotonically increasing function that is globally non-linear and locally linearized. A neural network uses this model for learning and estimates the RUL of a bearing by predicting future levels of vibration acceleration. More 16

Introduction

1.5 Problem Statement

recently, Jingfu et al. [103] have investigated a data-driven approach combined with similitude method [104], [105] to predict the RUL of an MW. The similitude method is based on similarity; it uses available data on the life of other similar systems to predict the RUL of the current system employing weighted average. In Jingfu et al. study, a neural network method is used to model the degradation trend of the telemetry data for a momentum wheel that had failed combined with a Weight Application to Exponential Parameters (WAFT) method for the similitude forecast to estimate the RUL of the wheel under study. Other literature pertaining to the RUL prediction of MWs are mentioned in [103]. However, the author verification of the following literature was a burden as they were not available online or in English. Li [106] have used a Bayesian network to fuse failure data and performance data from ground tests of particular MWs in order to form a model for RUL prediction. Hao [107] has proposed an RUL prediction method based on RVM, which utilizes temperature trends to extrapolate MWs lifespan. Liu [107] has also used the Bayes method to fuse momentum wheel ground test information for predicting the RUL of MWs. Fan et al. [108] have analyzed mental wear, cage wear, lack of lubricant and other failure modes. They propose a testing program based on failure physics and test analysis method, which present a range of RUL prediction models for MWs.

1.5 Problem Statement
Drawing on the literature reviewed in the previous section. The following problems can be formulated in each module of the CBM/PHM scheme in this thesis. In each of the formulated problems, references are given to the studies where particular issues were observed. [PROBLEM 1] When sudden changes are expected, off-line tuning of the estimators is not acceptable. Therefore, an approach that can track non-measurable system parameters is required. In a previous study [41] , a parameter tracking approach based on adaptive unscented Kalman filters was proposed. However, that approach suffers from limitations to be addressed in the present work as follows: (1) The system model used in [41], neglects some of the stochastic components that could in fact adversely affect simulation results. (2) The adaptation system in [41] considers only system and measurement noise covariances, and the optimization process is done off-line. This approach suffers from a lack of agility when abrupt faults occur, even after algorithm parameters are optimized. (3) The fault scenario in [41], [109] only includes abrupt fault while in practical situations, transient, intermittent, and incipient faults also occur. (4) The tracking speed of the estimator is very slow for sudden changes in the system. (5) The proposed work in [109] considers a constant threshold for the fault annunciation with limitation of requirement for all experimental data before designing the filter parameters. 17

Introduction

1.5 Problem Statement

[PROBLEM 2] In the published literature, there has not been much emphasis on the integrated approach for the purpose of FDI for actuator system onboard satellites wherein the following factors are considered: (1) parallel filters do not run at all times and do not interact unlike [48]. This is in particular important to mention that the proposed method in this thesis uses a 2-step approach (detection+isolation) unlike other MM approaches, which run parallel filters at all times. (2) All system states are not assumed measurable unlike [48]. (3) More than one RW assembly is considered unlike [48], [75] where moving from orthogonal to pyramid configuration can cause remapping, dynamics difficulties, and symmetrical isolation issues. (4) External disturbances are considered in simulations unlike [48]. (5) Full RW model dynamics are considered unlike [75], [77]. (6) Complicated statistical equations are not incorporated unlike [75], [77]. (7) Extensive a priori knowledge about system and its faults are not required unlike [36], [75], [77], [78]. [PROBLEM 3] To the author's knowledge, not many studies have focused on fault prognosis for rotary machines specifically in space application including RW. There is almost no published work on RW fault prognosis in space application based on system model, and there was no comparative study found on the topic as well. It should be noted that knowing the RUL of a system, which is not physically accessible in space, does not limit its usefulness in other areas of maintenance and configurability. It may be true that the cost associated with accessing a satellite in space and performing replacements can be so high that cannot justify its feasibility. However, one can argue other maintenance/remedial actions can be taken into consideration knowing how the system is deteriorating and when it is expected to fail. For example, one can change the course of orbit/attitude considering the current and estimated future behavior of certain components of the system. Furthermore, software updates can be uploaded to the C&C unit of the satellite to compensate for what is expected to be less effective or fail altogether in near future. One example of that can be going from fully actuated system to an under-actuated configuration to compensate for the lack of additional actuator while maintaining required mission specifications. In addition, NASA and other big players in the space field, have invested and explored the feasibility of such actions. Some publications on such efforts can be found in [110]­[112]. Moreover, contracts available on certain projects dealing with this matter including Payload Integrated Health Management Systems1 and others where it is explicitly mentioned: "...[Sest] will have predictive prognostic models combining the individual component/subsystem (such as electro optics, refrigeration and heat

1

https://www.sbir.gov/sbirsearch/detail/10163

18

Introduction

1.6 Research Objectives

rejection system, gimbal, electronics, reaction wheels, etc.) and their interactions, identify degradation modes and possible failure mechanisms, and impact of uncertainties in the variables controlling the payload performance and reliability." And another example in the book System health management: with aerospace applications [113] where it is mentioned, "Adding intelligent, decision making technology into commercial and military jets. Identifies the equipment that will fail prematurely on satellites and launch vehicles for replacement before launch, stops premature equipment failures that cause catastrophic failures." Both of which emphasize on the importance of such frameworks in place for space systems. Therefore, investigating RUL prediction for RW onboard satellite seemed an interesting researching area. [PROBLEM 4] To the author's knowledge, there are not many studies published on the fault detection, isolation, and identification of the CMGs and there is almost no literature on the fault prognosis of such devices. Minor studies on CMGs are mostly concerned with the fault-tolerant control and design of a controller [114]­[121] rather than establishing an FDI framework. The few minor cases where FDI framework is proposed for CMGs are Beck et al. [122] where they have used a sliding mode observer for detecting secular and oscillating disturbances. Oh and Kim [123] where a continuous second order sliding mode observer is suggested and applied for the detection of single disturbances/faults on CMGs. Choi et al. [60] have used fuzzy logic and Q-learning for FDI of a small CMG-actuated satellite. The challenge from extending application from RW to CMG lies in the complexity of modeling and certainty of the simulations. It should be noted that CMGs have more degrees of freedom (DOF) (2 or 3 DOF) compared to RWs (1 DOF) and this can affect the performance of the FDI algorithm through dynamics, symmetry, and other possible issues pertaining only to CMG as singularities, saturation, anti-parallel alignment, and hitting the gimbal stops.

1.6 Research Objectives
To address the problems identified above, the following objectives were set for the studies resulting in the thesis in hand: [OBJECTIVE 1] To address the limitations in PROBLEM 1, in this work a new 2-step fault detection approach is proposed that (1) considers the missing components in the RW system model. (2) Considers states error covariance matrix when abrupt changes occur to ensure agile tracking of non-measurable system parameters. (3) Is also applicable to all fault scenarios including transient, intermittent, and incipient faults also occur. (4) proposes an adaptive threshold for the proposed modification of UKF in [109] where a constant threshold for the fault annunciation is considered.

19

Introduction

1.6 Research Objectives

the proposed modification in this thesis is expected to resolve the limitation of requirement for all experimental data before designing the filter parameters in [109]. [OBJECTIVE 2] To address the limitations in PROBLEM 2, a new fault 2-step isolation approach is proposed in this thesis having (1) a new hierarchical MM isolation scheme wherein multiple models are used only when a fault is detected until it is isolated unlike [48]. The novelty of the approach lies in its 2-step procedure. In step 1, fault is detected using the proposed fault detection method in this thesis, and in step 2, fault is isolated using temporary MM approach. In other MM approaches, all models run at all times and the final estimate of system states/parameters is the weighted average of all filters. In the proposed approach in this thesis, however, only one model of the system runs in parallel with the hardware, and MM are only used from inception of the fault to its isolation. This is achieved under full external disturbances unlike [48] and the assumption of partial measurements availability at each level of the isolation unlike [48]. Multiple unscented Kalman filters (UKF) are incorporated to generate estimates, one for the nominal system and others for possible faulty scenarios. The fault is detected using residual sequence followed by the first level of isolation using Bayes' probability theorem to locate the faulty unit and the second level of isolation using parameter estimation to locate the faulty parameter. (2) Incorporating two reaction wheel assemblies, namely standard four-wheel and pyramid, for simulations unlike [48], [75] that use only one configuration. (3) Incorporating full RW dynamics including all disturbance terms unlike [75], [77]. (4) Using only limited a priori information for initializing the simulations and running isolation scheme unlike [36], [75], [77], [78]. [OBJECTIVE 3] To address PROBLEM 3, the feasibility of implementing a hybrid UKF+PF for fault prognosis of RW onboard satellite is studied using a mathematical model of the system, its degradation and synthetic data. The proposed approach shall be capable of handling Gaussian and non-Gaussian measurement noise while providing satisfactory RUL estimations with low error. [OBJECTIVE 4] To investigate the applicability of the proposed methods in each section, a second space system actuator, namely CMG is considered. The choice for this system was made based on the fact that there are very limited number of publications pertaining to the problem of fault detection, isolation, and identification as well as fault prognosis for such CMGs. In addition, CMGs are the next level of complexity for RWs where additional degree(s) of freedom are added to the actuator using gimbal(s).

20

Introduction

1.7 Main Contributions

1.7 Main Contributions
[CONTRIBUTION 1] A new 2-step fault detection approach is proposed that (1) considers the missing components in the RW system model. (2) Considers states error covariance matrix when abrupt changes occur to ensure agile tracking of non-measurable system parameters. (3) Is also applicable to all fault scenarios including transient, intermittent, and incipient faults also occur. (4) Proposes an adaptive threshold for the proposed modification of UKF in [109] where a constant threshold for the fault annunciation is considered. the proposed modification in this thesis resolves the limitation of requirement for all experimental data before designing the filter parameters in [109] as it is adapting the threshold to generated residuals online and based on residuals statistical properties, namely mean and standard deviations. [CONTRIBUTION 2] A new 2-step fault isolation approach is proposed based on a hierarchical MM scheme. In step 1 of the proposed method, the fault is detected using residual sequence as detailed in CONTRIBUTION 1, followed by the first level of isolation at multi-agent/formation level to isolate the faulty spacecraft, a second level of isolation using Bayes' probability theorem with limited a priori information to locate the faulty actuator unit with limited measurements to the satellite attitude only and no actuator measurements; and a third level of isolation using parameter estimation to track the non-measurable faulty parameters in the faulty actuator to isolate the parameter and the root cause of the faulty behaviour in the complex formation system. It should be noted that the main advantage of the proposed method in this thesis lies in its ability to isolate the fault without having to run parallel models at all times. However, the limitation of this proposal is the inability of the proposed method in isolating a new fault occurrence "concurrent fault" while the isolation process is in progress. Therefore, if a second or third fault occurs in the system before the current fault is isolated and the model running in parallel with the hardware is updated, the isolation cannot be accomplished. [CONTRIBUTION 3] The proposed fault detection scheme, is implemented and numerically analyzed through computer simulations for a small CMG-actuated satellite for fault detection of faulty units under multiple in-phase and out-of-phase faults. In addition, a variation of the proposed fault isolation scheme is implemented and numerically analyzed through computer simulations for a small CMG-actuated satellite with multiple in-phase faults occurring at the same time with different severities and inception times. Since there are not many literature published on the fault detection, isolation, and identification of CMGs onboard satellites, this study can provide more insight into evaluating performance of the proposed tehchniques on the CMG system. Moreover, it can provide guidelines as how to extend the applicability of the proposed methods to more complox systems (from RW to CMG) 21

Introduction

1.8 Thesis Outline

using a set of modifications in the propsoed methods. [CONTRIBUTION 4] A new hybrid UKF+PF-based approach is proposed for fault prognosis of RW onboard satellite using a mathematical model of the system and its mathematical degradation model using synthetic data to investigate the feasibility of employing UKF and PF for such applications. UKF is used to estimate nonmeasurable parameter of the RW, namely 4 . Next, Gaussian and non-Gaussian measurement noises are added to the estimates from the UKF to generate measurements fed into the PF to identify parameters of the degradation model for 4 . Once the degradation model parameters are identified, the model is extrapolated and its intersection with the 4 threshold is used as the end of life for that particular agent's estimates. RUL is defined as end of life minus current time and a distribution is created using PF agents to find the distribution of RUL for the faulty unit.

1.8 Thesis Outline
In Chapter 2 preliminaries are explained to lay out a foundation for the reader to understand the proceeding contents better. Contents of this chapter include single satellite attitude model, formation of multi-agent systems, actuator models including RW, CMG and assembly of four actuators in different configurations, namely standard four-wheel and pyramid, Kalman filters, and Particle filters. In Chapter 3, the first stage of the CBM/PHM process (Figure 1.12), namely fault detection is explained, and the proposed method is outlined, followed by performance evaluations and comparative studies. In Chapter 4, the second stage of the CBM/PHM process (Figure 1.12), namely fault isolation is explained, and the proposed method is outlined, followed by performance evaluation and discussions. In Chapter 5, the third stage of the CBM/PHM process (Figure 1.12), namely fault prognosis is described, and the proposed method is outlined, followed by performance evaluation and discussions. Finally, in Chapter 6, conclusions of the study are provided followed by potential future work and suggestions for further investigations on the topic.
Inputs Diagnostics Current Fault Condition Fault Isolation Fault Identification Prognostics

Plant

Model Outputs

Residuals

Fault Detection Stage 1

Symptoms

Fault Evolution Prediction Stage 3

Outputs Stage 2

Figure 1.12 Different stage of a model-based CBM/PHM framework

22

Preliminaries

2.1 Satellite Attitude Model

CHAPTER 2

Preliminaries

I

n order to lay out a foundation for better understanding the contents of the following chapters, in this chapter, essential preliminaries are explained to ensure the reader can easily follow the forthcoming derivations and proposed methodologies. The contents of

this chapter are organized as follows: first, the satellite attitude model, including dynamics and kinematics, is explained in this section, satellite dynamics differs based on the actuator used onboard. Therefore, dynamics equations are provided separately for satellite with RW and CMG onboard. Next, the actuator model including a high fidelity RW's mathematical model and a RW assembly (RWA) along with its mapping methods are explained followed by CMG dynamics model and its integration with satellite dynamics when used onboard satellite. Next, a brief review on Kalman filters, unscented Kalman filters, and adaptive unscented Kalman filters is provided with focus on UKF and adaptation schemes. Finally, a brief review on particle filters and various aspects of their implementation strategies along with possibility of implementation of such methods into a fault prognosis problem is presented.

2.1 Satellite Attitude Model
The satellite is modeled as a rigid body. The coordinate frames used for the satellite by  ­ modeling are shown in Figure 2.1. An Earth-centered inertial (ECI) reference frame denoted has its origin at the center of the Earth, where axis points towards the vernal equinox, and axis passes through celestial axis completes the triad with axis is North Pole,

is denoted by  -

right-handed rule. The orbital frame also known as local vertical local horizontal (LVLH) and is fixed at the center of the spacecraft. In LVLH, axis is pointing at the Earth. True anomaly (for eccentric orbits) or reference angle d (for in the direction of motion, axis in the opposite direction of the angular velocity, and

frame , expressed in frame  is denoted by ? [125]. 23

circular orbits) is measured from perigee. The body-fixed coordinate frame denoted by  - has its origin at the spacecraft center of mass [124]. A vector of frame  relative to

Preliminaries

2.1 Satellite Attitude Model

Lo ca lV er tic

al

Figure 2.1 Geometry of orbit motion for rigid body spacecraft

2.1.1 Satellite Dynamics The rotational equations of motion for a spacecraft actuation by momentum exchange devices such as RWs or CMGs can be described as [126] where e is the angular velocity of the spacecraft relative to the inertial frame expressed in the body frame. f)   × is the external torque. g is the total angular momentum of the spacecraft relative to the inertial frame expressed in the body frame given by [126] (2.1) where Y is defined as Y = Y$ - XYh Xi where Y$   × is the moment of inertia of the spacecraft including the actuators. Yh  -×- = \Vjk(lYh , Yh, , Yh , Yh- m) denotes the axial moment of inertia of each momentum exchange device.  is the total momentum provided by the momentum exchange device (RW) expressed in the spacecraft body-fixed frame [18]. (2.2) where X   ×- maps the influence of the actuators to the principal axes of the spacecraft. g is the momentum generated by momentum exchange devices in their respective axes. Combining Eqs. (2.1)-(2.3), we can obtain [126] (2.3) If the control torque applied by the momentum exchange device is denoted by f! we have [126]  + × =- + (2.5)  + +  + ×( + )= (2.4) = + = +  + × =

24

O

rb i

t

Preliminaries +  + × =

2.1 Satellite Attitude Model (2.6)

The terms Xn and gn appear because depending on system and variation of the elements, each can contribute to the overall momentum. For example, if RWs are used, Xn = 0 because there are no varying terms in X. On the other hand, if CMGs are employed, gn = 0 because flywheel speed is constant and there are no variations with time wheel speed and only gimballing causes the momentum exchange. If RWs are used as actuators, gh is used instead of g , which is expressed as [126] where   -× denotes the axial angular velocity of the reaction wheels. Substituting gh in Eq. (2.3) gives [126] (2.7) Putting this back into Eq. (2.1) gives [126]  + = +  + = + ( + ) (2.8) ( + )) = ( + )

×(

+

(2.9)

Expanding the terms and using the definitions provided earlier, a fully actuated rigid body spacecraft controlled by reaction wheels with internal and external torques acting on it can be formulated as [127] where fqr is the torque generated by RWs and can be formulated as [127] =  = ( +  )  =- ×( + )- + (2.10)

In this study, reaction wheels angular velocities () are calculated from RW dynamics using Eq. (2.31) in Section 2.3.1 and are fed into satellite dynamics and kinematics. If CMGs are used as actuators, from Eq. (2.1) and Eq. (2.2) we have [120] (2.11) where 2st is defined in Eq. (2.38) n!   1 = 2  =- ×( +
u

is defined in Eq. (2.39).

) - 

+

(2.12)

2.1.2 Attitude Kinematics The kinematic equations for the spacecraft using quaternions can be formulated as [120] is unit quaternion,  denotes the principal angle,  = + -
×

(2.13)

l , , , mi is the principal axis from Euler's theorem ( + + = 1). -   and  ×  = [ , , ] denote the Euler parameters representing the spacecraft body frame orientation with respect to the orbital frame where + = 1.   × is the identity 25

where  = [  sin( ) , cos( )] =

Preliminaries matrix and
×

2.1 Satellite Attitude Model is the skew-symmetric matrix of the quaternion vector given by [120]
×

The angular velocity of the body frame with respect to the inertial frame can be written as [120] The transformation matrix is used to describe the orientation of the spacecraft body frame  with respect to the orbital frame  . It can be formulated in terms of Euler parameters as follows [120] The orbital angular velocity expressed in the body frame e rotating with the Earth) can be defined as [120] = [0 - 0] =( - ) +2 -2
×

=  -

0

- 0

-   0 

(2.14)

=

+

(2.15)

(2.16) (i.e. the speed the orbit is (2.17)

where eT = dn is the orbital frame angular velocity. This value is equal to dn = wx) / ! for circular orbits were x) is the gravitational constant parameter of the Earth equal to 398600 ~ /· , and ! is the spacecraft distance from the center of the Earth. This will be equal to ! = " + $ where " is the average Earth radius equal to 6378 ~ and  is the altitude of the spacecraft from the surface of the Earth. In this study $ = 500 ~. Equation (2.10) is with respect to the inertial frame reference  because the Euler' equation holds with respect to the inertial frame. However, in orbital satellite motion, it is desired to work with the spacecraft body angular velocity relative to the orbital frame  expressed in the body frame en . From theory we have [128] Taking a time derivative of Eq. (2.15) and applying it to Eq. (2.18) we have [128] Since we are interested in en   =  - +
×

 =-

×

(2.18)

(2.19)

we have [128] = 

The external torque is assumed to include gravity gradient torque (fuu ), solar radiation pressure ( ), aerodynamic torque ( ), and other disturbances (f6 ). = + + + . These disturbances can be defined as [5], [18, p. 112], [129], [130] =3
×

×

(2.20)

;

=

[0

0

1]

(2.21)

26

Preliminaries =   =    = 1.36   =   (2 × 10- )[1 - 2 (  -  (1 × 10 ) ( )  -(5 × 10- ) ( ) )   

2.2 Formation Flying

(2.22) )   )]   

where positive scaling factors : and X: are calculated based on worst expected disturbance torques in low earth orbit (LEO) and are equal to : = 1.70 × 10 , X: = 1.0 × 10 for RyeSat (pico-satellite) [5].

1 = + 2

1 1+ ( )+ (2  2  -(5 × 10 )[4 + 2 ( ) + 1  2  1 -[1 + ( )+ (2  2     ( ( ( ) )  )

(2 )]

(2.23)

(2.24)

2.2 Formation Flying
There are several advantages in employing a group of satellites in formation flying to accomplish a mission compared to employing a single-satellite platform. The ability to avoid a single point of failure and achieving a more robust mission is one of the most important advantages of the formation flying systems. As discussed earlier, the multiple spacecraft approach will also cost less due to smaller launch vehicles and development costs associated with it. There are other advantages to this approach including higher reliability and redundancy, higher resolution, simpler design, faster build times [131], [132]. It is well known that efficiency and reliably of the formation mission can be jeopardized due to occurrence of faults in the actuators of the satellites. Therefore, autonomous real-time and online file detection and isolation schemes can help alleviate this problem. Diagnosing faults in individual satellite's subsystems before they lead to severe damage and catastrophic failures can save a lot of costs and save missions and the entire networked formation flying system. There are three major FDI architectures defined in [82], namely decentralized, semi-decentralized, and centralized, which will be discussed briefly as follows. However, only centralized architecture is employed in this thesis as an extension from single to multiple satellite systems. There are five architectures for formation flying control proposed in the literature. These include Multiple Input-Multiple Output, Leader/Follower, Virtual Structure, Cyclic, and Behavioral based [133]. In this thesis, formation flying of spacecraft is considered to be accomplished by a pre-designed set of inputs. Therefore, the controller module in this formation is not detailed further in this thesis. Furthermore, there are various types of network 27

Preliminaries

2.2 Formation Flying

topologies including Ring Mesh, Star, Line, Fully Connected, Tree, and Bus. In this thesis, since it is an extension of the system level (single satellite) to multi-system level (formation) and the objective is to merely provide a proof of concept for the future studies on more detailed investigations of fault tolerant formation flying, a bidirectional fully connected topology is employed. This can be argued as a restrictive and unrealistic choice, however, the proof-of-concept was meant to be evaluated in this thesis at this level and further, more detailed investigations are left for future studies. 2.2.1 Decentralized FDI architecture In the decentralized architecture [134] (Figure 2.2), there is a dedicated FDI unit for each the FDI goal. Therefore, the Vth spacecraft would detect faults in its actuators solely based spacecraft with no communications among spacecraft for the purpose of accomplishing on the internal information it has of its input, output and control signals.
Si S1 SN

Decentralized Decentralized Decentralized ... ... FDI unit 1 FDI unit i FDI unit N

The mathematical model of the Vth spacecraft for this structure can be formulated as [134]  = ( ( ), ( ), ()= where GN denotes states, dN denotes system parameters, ^N denotes control signals, EN denotes the outputs or measurements, +() denotes the nonlinear process model, k() denotes the nonlinear measurement model, and >N and ?N denote process and measurement noise, respectively. 2.2.2 Semi-decentralized FDI architecture In the semi-decentralized architecture as show in Figure 2.3, the FDI unit for each spacecraft has access to the control input and information from its neighbouring spacecraft. The communication of information between spacecraft is modelled using graph theory with a vertices and edges. () + ( )) + () () (2.25)

Figure 2.2 Decentralized FDI architecture [134]

28

Preliminaries
Semi-decentralized FDI unit 1 Semi-decentralized FDI unit 3

2.2 Formation Flying
Semi-decentralized FDI unit N

S3 S1 S2 Semi-decentralized FDI unit 2 SN

Figure 2.3 Semi-decentralized FDI architecture [134]

The information communicated between spacecraft gives the FDI unit of any spacecraft the ability to detect and isolate actuator faults of the given spacecraft as well as of its neighbouring spacecraft. The mathematical model of this architecture is not discussed in this section, since applications of the proposed methods to this architecture are suggested as future work for this research. 2.2.3 Centralized FDI architecture In the centralized architecture as shown in Figure 2.4, a single FDI module is designed and in charge of the entire formation flying mission. All spacecraft send their states and control signal information to the central FDI module for processing.
Si S1 SN

Centralized FDI unit
Figure 2.4 Centralized FDI architecture [134]

The mathematical model for this structure can be formulated as [134]  = [  ,  , ... ,  ]; =[ , ,... ];  = ( ( ), ( ), ()= () + ( )) + () () (2.26)

where GN denotes states, dN denotes system parameters, ^N denotes control signals, EN denotes the outputs or measurements, +() denotes the nonlinear process model, k() denotes the nonlinear measurement model, and >N and ?N denote process and measurement noise, respectively. The main difference between this model and decentralized model is in the processing of information where in the decentralized architecture, each spacecraft individually processes information (hence, Gn N , EN ), while in this architecture all information is processed 29

Preliminaries

2.3 Actuator Model

by one central unit (hence, Gn , E). In this thesis, at the formation level, the states and measurements required for the isolation are satellite angular velocity and quaternions for each individual satellite. However, it was observed that the only satellite angular velocity or quaternion would suffice isolation requirement under the numerical simulations conducted in this study. Nevertheless, it should be considered in the future studies the feasibility of using partial information availability as well as other topologies and control schemes applicable to type of formation.   = [  ,  , ... ,  ];   = 1 2 + +
×

 

=

-

-

×

- +

+

+ (2.27)

=  

 = [ ( , 1 = { ( )+

=[ , =

[ ( ) + 1] - ( )+ ,... ];

)-

( )] -

-

-

( )+

}

where the governing satellite equations are discussed in the previous section in eqs. (2.10) and (2.13); and the governing actuator (RW) equations are discussed in the next section in eq. (2.31).

2.3 Actuator Model
To date, RWs are the most common actuators that can fit within small satellites mass, power, and volume constraints and provide adequate control torque [14]. These constraints vary depending on the payload and mission requirements. This section provides details on RW model, structure, and possible fault/failure scenarios. 2.3.1 Reaction Wheel Model Reaction wheels have been among the most common actuators to provide full 3-axis attitude control for small satellites. An RW is a flywheel mounted to an electric motor. The RW model includes motor disturbances such as cogging and ripple torque, nonlinearities, and back electromotive force (BEMF) torque limiting (Figure 2.5). The RW model parameters in this study are based on ITHACO 'type A' by Goodrich where system parameters can be found in [76]. There are several essential loops incorporated in each RW model to allow for precision.

30

Preliminaries
EMF Torque Limiting 6V VBUS

2.3 Actuator Model

__ _
Kf

+

_

Back EMF 1 Hb Hb(I)=1 for I>0 Hb(I)=0 for I0 RIN Hb abs

power

Ke

IBUS(Im,,VBUS)

Motor Disturbances B Hf Hf(V)=0 for V>0 Hf(V)=1 for V0 C Sin Torque Ripple Sin Cogging Torque Command Voltage Vcomm
2

3Nt

Nt 2
Reaction Torque

+ _

Motor Torque Control Im + -dd Gdde

×
Kt

m

+ +_

+ + _

-1

z

n
1 Jw 
Viscous Friction


Jw Angular Momentum Hz

Ja Sina t Bearing Friction and Disturbances

v c

Coulomb Friction

Sign()

Speed Limiter

Hs=0 for ||<s Hs=1 for || s Ks Hs

_ s +

Figure 2.5 Reaction wheel model [76]

These loops are shown with dashed lines in Figure 2.5 and can be formulated as follows [16]: a) The negative feedback EMF torque limiting loop due to low bus voltage condition that can limit the motor torque at high speed due to increasing back-EMF voltage gain of the motor [16]: where %&$ and '%&$ are the bus current and voltage, respectively; () is the BEMF voltage gain, and e is the wheel's angular speed. = 0.049 - 0.0002( + 30) = 1 -1 ( + 0.04| | + + ) (2.28) is the motor current,

b) The negative feedback viscous friction in addition to Coulomb friction, which is generated in the bearings [16]: (2.29)

where f is the viscous torque, and * is the wheel's temperature in degrees Celsius. It is 31

Preliminaries

2.3 Actuator Model

important to note the unit for f is mN.m/rad/sec when incorporating this parameter in simulations. c) The Coulomb friction is caused by the friction in bearings. d) The negative feedback speed limiter loop to prevent wheel speed from saturation.

e) The motor torque control. The motor has a torque gain 4 , which delivers a torque proportional to the current driver. Therefore, to inject faults in the motor current it would be sufficient to change the torque gain 4 . f) The torque noise disturbance f<3N$) is a very low frequency torque variation from bearings due to lubricant dynamics and is formulated as follows [16]. The nonlinear model of the RW including discontinuous functions approximated with sigmoidal functions can be expressed as follows [16]:  = [ ( , ) - ( )] - 1 = { ( )+ [ ( ) + 1] - ( )= ( , , )= - + ( )+ } (2.31) = ( ) (2.30)

in which [16] ( )= (3 2 )

[- ( , , 1+ [- ( , , ( )= 1+ (- (- 1- 1+ 1 [- ( - 1+ ) ) (- (-

( )=

[ - ,

( ,

2

( )] ) =

where + and +, account for motor disturbances, + accounts for the EMF torque limiting block, + - accounts for analytical approximation of the sign function in the Coulomb friction block, +. represents the speed limiter block, and '23 is the torque command voltage. (motor current) and e (motor angular velocity) are RW system states. Finally, the sigmoidal parameter j = 10 is used [16]. 32

-

1- 1+

-6-

1 (-

)]

) )

)]

)]

( ,

,

) (2.32) )] )

+

1+ ) (1 +

1 [ ( +

Preliminaries

2.3 Actuator Model

Figure 2.6 Reaction wheel unit developed in the SSDC lab at Ryerson University Table 2.1 ITHACO Type `A' Reaction Wheel Parameters [76]

The analytical nonlinear model was discretized using Euler's backward difference method with sampling time of *$ = 10 ~·. Based on a discussion provided in [16], this value for sampling time ensures the validity of Nyquist-Shannon sampling theorem. In addition, extensive numerical simulations on continuous model illustrated in Figure 2.5 and discrete model from Eq. (2.31) demonstrated consistency between the two [16]. All reaction wheel parameters used for the simulations in this study are listed in Table 2.1 with their values for ITHACO Type `A' RW. 33

Parameter Coulomb Friction (f! ) Viscous Friction (f ) Drive gain time constant (f6 ) Ripple Torque (B) Temperature (*) Cogging Torque (C) Torque Noise Frequency (eS ) Jitter Angle (dS ) BEMF (() ) Nominal Motor Torque Constant ( 4 ) Bus Voltage ('%&$ ) Nominal Bridge Resistance ( ) Driver Gain (56 ) Number of Motor Poles (N) Input Filter Resistance ( 7 ) Quiescent Bus Power (89 ) Driver Bandwidth (e6 ) Voltage Feedback Gain ( : ) Over-speed Circuit Gain ( $ ) Maximum Wheel Speed (e$ )

Value 0.002 Nm 3.84×10-4 Nm/rad/s 0.245 0.22 23° C 0 0.2 rad/sec 0.05 rad = 3 degrees 0.029 V/rad/s 0.029 Nm/A 8V 2 0.19 A/V 36 2 3W 9 rad/s 0.5 V/V 95 680 rad/s

Preliminaries

2.3 Actuator Model

2.3.2 Reaction Wheel Assembly Reaction wheel assemblies can be in many forms and configurations depending on the requirements for specific applications. In this study, we have examined performance of the proposed methodology on most popular configurations: (1) standard four-wheel configuration with three orthogonal RWs and one redundant oblique RW, (2) four RWs in pyramid configuration (see Figure 2.8). The mapping of each actuator's torque contribution to each principal axis of the spacecraft body frame (see Figure 2.7) is as follows: =       (2.33)

where fM , fF , f< are applied torques to satellite in G, E, OE directions, respectively and fh· is torque generated by each RW on its own axis of rotation. The mapping matrix (X) used for configuration 1 and 2 are as follows: 1 = 0 0 0 1 0 0 0 1 - -

where Xqr N is mapping matrix for configuration V. Math functions sin() and cos() are abbreviated as "() and ·(), respectively with " as the in-plane angle and [ as the out-ofplane angle. For this study " and [ angles are considered as 45° each. The 3D models in Figure 2.8 were drafted using Autodesk Inventor professional.

= -

- -

-

(2.34)

T2 T1

proj

Z T3
 
proj

T
proj

Z Tz
 

T2
   

T Tx Y

T4



T3

Ty

proj

T1 X
(a)

Y
proj

T4

X
(b)

Figure 2.7 Torque decomposition for RW assembly (a) pyramid, (b) standard four-wheel

2.3.3 Control Moment Gyro Reaction wheels have a fixed spin axis, and the torque generated by these actuators

34

Preliminaries

2.3 Actuator Model

is through a change in their flywheel angular speed. They are the simplest and least expensive of all momentum exchange devices; however, the control torque of most reaction wheels with less than 1 N.m maximum torque is much smaller than their counterpart CMGs with 100-500 N.m maximum torque. A CMG is a RW or MW, whose angular momentum vector direction can be changed by gimballing the spinning rotor. The spinning rotor is mounted on a gimbal if it is a single gimbal design or multiple gimbals for more degrees of freedom and precision. Spinning the rotor causes a precise, gyroscopic reaction, which is orthogonal to the rotor spinning and gimbal axis. Therefore, CMG is a torque amplification device that can apply large control outputs on the satellite with a small gimbal torque input. This capability makes CMGs favorable for precision pointing and tracking control of agile spacecraft in LEO and momentum management of large space vehicles. In general, the categorization of CMGs is based on the gimballing arrangements and the configuration used for redundancy management and failure accommodation. The two basic types of CMGs are (1) single-gimbal control moment gyros (SGCMGs) and (2) doublegimbal control moment gyros (DGCMGs). For SGCMGs, the spinning rotor is constrained to rotate in a circle in a plane normal to the gimbal axis. The SGCMGs are much simpler than DGCMGs in terms of hardware and offer significant cost, power, weight, and reliability advantages over DGCMGs. For the purpose of optimal redundancy management and failure accommodation, many different arrangements of CMGs have been developed in the past including four SGCMGs in a pyramid configuration, six parallel-mounted SGCMGs used in the Mir space station, three orthogonally mounted DGCMGs used in NASA's Skylab, and four parallelmounted DGCMGs used in ISS. When using CMGs, a steering logic needs to be developed, which generated the required gimbal rate commands based on the commanded spacecraft control torques. The optimal steering logic is the one that generates exactly the commanded spacecraft control torques. One of the main limitations with CMGs is the geometric singularity problem when they are used for the spacecraft attitude control. When singularity occurs, no control torque is generated for the commanded gimbal rates, and most valuable type among others are SGCMGs due to reduced degrees of freedom. Referring back to Eq. (2.4), when CMGs are used as actuators instead of RWs, the n X term in Eq. (2.6) will be non-zero, while gn will be zero due to no change in CMG's flywheel speed and consequently momentum. The CMG angular momentum is in general a function of CMG gimbal angles Z = (Z , ... , Z< ) and flywheels angular speed  = ( , ... , < ) One approach to the CMG steering logic design is simply to find the inverse of Eq. = ( , ) (2.35)

35

Preliminaries

2.3 Actuator Model

(2.35) where the task is to determine optimal gimbal angles trajectories that can generate the commanded momentum  while meeting hardware constraints such as gimbal rate limits and gimbal stops, while avoiding singularities.

(a)

(b)

Figure 2.8 RW assembly (a) pyramid configuration, (b) standard four-wheel configuration

The second approach is to use the differential relationship between gimbal angles and the CMG momentum vector. For such method, the derivation of  is obtained as [135] where X2st = X2st (Z )  
×<



is the Jacobin matrix defined as [135] =  =  (2.37)

=



(2.36)

The CMG steering logic then becomes the inverse of X2st Zn = n2st . If we consider a typical pyramid mounting configuration for four SGCMGs as shown in Figure 2.9 where each face is inclined with an out-of-plane angle of [ = 54.73 \ k, which makes the momentum envelope nearly spherical [135]. 36

Preliminaries

2.3 Actuator Model

Spacecraft Reference Frame CMG #3 Gimbal Axis

Yaw Axis CMG #2 Gimbal Axis 2 h2 Pitch Axis

3

h3

4 CMG #4 Gimbal Axis h4 CMG Platform

h1

CMG #1 Gimbal Axis 1

Roll Axis

(a)

(b)

Figure 2.9 Pyramid assembly of four SGCMGs (a) schematics (b) free body diagram [135]

For the conventional pyramid mount (Figure 2.9), the total CMG angular momentum can be expressed in the spacecraft reference frame, considering that the moment of inertia of the gimbals along the rotation axis is considered while the rotational inertia about other axes are assumed to be negligible, as [135]  - =
=

where N is the angular momentum of each CMG expressed in the spacecraft reference frame. ZN are the gimbal angles, N are flywheel angular speed, and T N is the momentum magnitude for the Vth CMG. The time derivative of the CMG angular momentum can be obtained as [135] where Z is the gimbal angle vector and [135] -  = -  - -  =
=

=  

( , - -

) -

  (  

) (

) (

) (

)

(2.38)

 ( ,

)=  (

) (

) ( -

) ( -   

)



(2.39)

For a known control torque f! , the CMG torque command n is chosen as [135]  = =- - × = ( 1 ) 
+

(2.40)

And the gimbal rate command Zn , given T = hT~ = hTTM = hTs = hT> is obtained as [135] 

(2.41)

i i  where Xoe 2st = X2st (X2st X2st ) , often referred to as the pseudoinverse steering logic and

(2.42)

37

Preliminaries

2.4 Kalman Filters

most CMG steering laws determine the gimbal rate commands with its variations. In the following chapters, dynamic equations for satellite are employed based on the actuator used onboard. Where CBM of RW is of interest, Eq. (2.10) is used, and where CMGs are employed, Eq. (2.12) is used.

2.4 Kalman Filters
The Kalman Filter (KF) is a model-based observer that produces estimates based on the stochastic properties of a system. This feature of the KF makes it robust to measurement and process noise, hence, make it practical to implement. The most common application for KFs is in state and parameter estimation, and therefore, a great candidate for fault diagnosis and identification (FDI), which has been studied extensively in the literature. Three of the common KF variants applied to the FDI problem are the EKF, AKF, UKF, and adaptive unscented Kalman filter (AUKF).The EKF uses linearization to estimate the true mean and covariance of the random variable while the UKF uses sigma points or particles. These sigma points when spread through a non-linear system, capture the posterior mean and covariance accurate to the third order, whereas the standard EKF is only accurate to the first order [62]. This means that the UKF is a better option for highly non-linear systems but has no advantage for weakly non-linear systems. Whether the EKF or UKF structures are used the adaptive mechanism, which could be used in both, remains the same. These filters can be implemented for either state/parameter estimation or joint state and parameter estimation. State estimation uses the standard KF equations without any modifications and hence, is the most straightforward approach to Kalman filtering. The goal of this approach is to estimate the system states based on the mathematical model of the system. The FDI approach could be as simple as just comparing the measured system states from the sensors and with the predicted model states, if the residuals exceed a threshold, then a fault has been detected. On the other hand, isolation and identification are not as direct and generally require a good choice of residuals in addition to postprocessing of the raw data. Parameter estimation, however, is a form of system identification as it implicates estimating the physical parameters of a system. In order to accommodate the parameters as the state-vector for this purpose, modifications need to be made to the KF equations. The FDI problems are then directly resolved when the parameters of a system are estimated; the reason for that is that the change in parameter(s) identifies where the faults have occurred and the level of severity for each. Therefore, the parameter estimation approach is better suited for FDI problems than the state-estimation is. 2.4.1 Unscented Kalman Filter The Robotics Research Group (RRG) in Oxford UK proposed a "New Filter" in 1994, which was named the UKF. Then, in 1997 the first paper was published describing the UKF as a new extension of the KF to nonlinear systems. The UKF is a variant of the KF with 38

Preliminaries

2.4 Kalman Filters

the capability of estimating the mean and covariance of a random variable to the third order while the EKF only approximates them to the first order. As a result, higher order terms in the dynamics are not ignored in UKF. This filter is built on the belief that "it is easier to approximate a probability distribution than it is to approximate an arbitrary nonlinear function." [63]. Simply put, it means that the linear approximations are not used to approximate non-linear functions in here; instead, the statistical moment of the state is approximated. The UKF is, in fact, a form of particle filter applied to a random variable with a Gaussian distribution. Particle filters can be applied to systems with sampling densities that are non-Gaussian [64] where the posterior distribution of the state is approximated using a large number of "well chosen" particles or sigma points that change randomly in time according to the model dynamics and system measurements [65]. The parameter estimation with the assumption that the full state measurement is available is first presented based on the standard UKF. Consider the following nonlinear discrete stochastic system where ;  < is the state vector at time step , d;  < is the model parameter vector, is the measurement vector, >;  < is the additive process noise, ?;   is the ;  additive measurement noise, +() is a nonlinear process model, and k() is nonlinear measurement model. The process and measurement noises are assumed to be uncorrelated zeroi mean Gaussian white noises with covariances ·z>; >Yi = @; Z;Y , ·z?; ?Y = ; Z;Y , respectively. The process noise covariance @; is non-negative definite, the measurement noise covariance ; is positive definite, and Z;Y is the Kronecker-Z function. When the system equation is in continuous form as It can be transformed to the discrete domain using =
-

= ( - , , )+ = ( )+

(2.43)

 = ( ( ), ( ), ( )) + ( ) +

(2.44) +

where L or *$ is discretization step size or sampling time. The integration can be carried out using the fourth order Runge-Kutta (RK4) method. The formulation for parameter estimation of a nonlinear discrete stochastic system using UKF [136] with minor modifications [137] can be described in the following steps: 1) Compute weights [137]
( )

( - )

( ( ), ( ), ( ))

(2.45)

=

+

;

( )

=

+

+ (1 -

+ );

(

)

=

( )

=

1 2( + )

(2.46)

39

Preliminaries

2.4 Kalman Filters

2) Establish symmetric sigma points about the state estimate [137] =  -( ±
-

+ )

( + )
+

=  -(

+ ) - ( + )

(2.47) ,
+

 = 1,2, ... ,

(2.48)

3) Predict mean and covariance of states [137]
- ( + )

=

-

4) Instantiate sigma points through measurement model [137] = ( ) (2.51)

=

+
+

(2.49) (2.50)

5) Predict mean and covariance of measurements [137] = = =
= =

(2.52) - ] + [ - ]
+

[

-  ][ -  -(
+

(2.53)

6) Predict cross covariance [137]
= + )

(2.54)

7) Calculate gain and update [137]  +( =
- ( + ) +

=

-

(2.55) ( - )
+

component weight for mean calculation, ¦(¨) is the component weight for covariance calculation, D is the dimension of the states, ¢  0, 0  " < 1, and -  0 are the control factors ¯ is the mean of variable E, °FF is the covariance of measfor the spread of sigma points, ® urements matrix, ± is the n-state random variable, G ² is the initial sigma point, °MM is the posteriori estimates covariance matrix, ³N is the result of instantiated sigma points through measurement model, °MF is the cross covariance matrix, is the Kalman filter gain, and + and - superscripts show the pre-process and post-process values at each iteration, respectively. The primary difference between state and parameter estimation with UKF is most notable in steps 3. Since no dynamics information are available for parameters, the sigma

 , ¦(§) is the  terms denote the scaled V 4¥ rows or columns of where the ¡(D + ¢)£¤¤ w£¤¤ N

+

+ ) +

=

-

-

+

+ +

(2.56) (2.57)

40

Preliminaries

2.5 Particle Filter

points from step 2 are not propagated; instead they are used in subsequent steps as is [14]. For state estimation with UKF step 3 is broken into two steps as follows 3a) Instantiate sigma points through process model [14] = ( ) (2.58)

3b) Predict mean and covariance of states [14] = =
= =

(2.59) - ] +
+

[

- ][

(2.60)

2.4.2 Adaptive Unscented Kalman Filter The proposed adaptive scheme consists of three major parts: (1) adapting process and measurement noises, (2) detecting fault occurrence, (3) adapting states/parameters covariance matrix. The following adaptive mechanism is used to adjust process and measurement noise covariance matrices on-line [138]. The approach is adapted from [41] where the algorithm parameters are optimized off-line for specific abrupt fault scenarios. First Eq. (2.49) is re-written as [41] where the adaptive fading factor ´ is defined as [41] =1+ ( )
- +

=

-

+

+

(2.61)

where LRj" () is the sum of the diagonal elements of the matrix µ , and ¶ is the controlling factor. Next, the process and measurement matrices are adjusted as follows [41]:  = 1
+ + = - +

(2.62)

(2.63) (2.64) 
+

where R; = (OE - E · ) is the residual, OE is the measurement, E · is the estimated measurement, ¹ ¹ ¸º is the estimated residual sequence covariance matrix, µ is the estimated measurement ¹ is the estimated process noise covariance matrix, and P is the noise covariance matrix, » window size. (2.65)

=

=

 +

+

2.5 Particle Filter
The most common forms of particle filters developed so far are based on a sequential 41

Preliminaries

2.5 Particle Filter

importance sampling (SIS) algorithm. It is a Monte Carlo (MC) method that forms the basis for the majority of the sequential MC (SMC) filters developed [139], [140]. This SMC approach is widely known as bootstrap filtering [141], the condensation algorithm [142], particle filtering [143], interactive particle approximations [144], and survival of the fittest [145]. In this technique, a recursive Bayesian filter by MC simulations is implemented to represent the posterior probability density function (PDF) through a set of random samples (particles) with associated weights and estimations of the two. As the number of samples grows, the estimations become closer to optimal Bayesian estimates, and the MC characterization becomes an equivalent representation to the actual PDF description. 2.5.1 Algorithm A discrete weighted approximation of the true posterior ¼(GT:; |OE lated as [146] ( | )
=

:; )

can be formu-

are normalized to ensure = 1. The weights are chosen using the principle of importance sampling [147]. In this principle, ¼(G)  Ç(G) is a PDF that is difficult to generate samples from but Ç(G ) can be evaluated for it. If G N ~ (G ), V = 1, ... P$ are samples generated from a proposal importance density (), a weighted approximation to the density function ¼() can be formulated as [146] ( ) where [146] =
=

N where P$ is number of samples, {GT:; , V = 1, ... , P$ } is a set of support points with associated N weights {>; , V = 1, ... , P$ }, and GT:; = {GY , W = 0, ... , } is the set of all states up to time . N The function ZÁ · () is a function that if you integrate it over a set X, the result is 1 if ; is

(

-

)

(2.66)

in X and 0 otherwise: Ã ZÁ · (G )\G = 1 if and only if Ä
N  >;
Â

Â

N ;

 X and 0 otherwise. The weights

( - ( ) ( )

)

(2.67)

N Is the normalized weight of the Vth particle. Hence, if samples GT:; were drawn from an importance density (GT:; |OE :; ), the weights in Eq. (2.66) can be defined by Eq. (2.68) as [146]

(2.68)

In the sequential case, having samples that form an approximation to ¼(GT:; |OE 42

=

( (

| |

) )

(2.69)
:;

) the

Preliminaries goal is to approximate ¼(GT:; |OE chosen as [146] ( | )= (
:; )

2.5 Particle Filter with new set of samples. If the importance density is
-

N Samples of GT:; ~ (GT:; |OE :; ) can be obtained by augmenting the existing samples N N GT:; ~ (GT:; |OE :; ) with the new state G; ~ (G; |GT:; , OE :; ). The weight update equation can be formulated as [146]

|

,

) (

-

,

-

)

(2.70)

Furthermore, if (G; |GT:; , OE :; ) = (G; |G; , OE; ), the importance density would only be reliant on G; and OE; . This is useful when only filtered estimate of ¼(G; |OE :; ) is required N N at each time step. In this case, only G; needs to be stored and the path GT:; and history of observations OE :; can be discarded. The modified weight can then be formulated as [146] = ( |
-

=

-

( | ) ( | ( | - ,

-

)

)

(2.71)

And the posterior filtered density can be approximated as [146] where the weights are given in Eq. (2.72) and as P$   the approximation in Eq. (2.73) approaches the true posterior density ¼(G; |OE :; ). It can therefore, be seen that the SIS algorithm sequentially propagates weights and support points as each measurement is received. A general schematic of the particle filter algorithm is shown in Figure 2.10 where particles are first initialized using a particular method. After initialization, a weight is computed for each particle using a distribution similarity function to measure how close that particle is to its true measured value. After all particles are weighted and a distribution is formed, resampling is done to ensure diversity of the particles. The process is repeated until satisfactory criteria are met. 2.5.2 Degeneracy A common limitation with the SIS particle filter is that after a few iterations, all particles except for one will have negligible weights. This phenomenon is known as degeneracy. It is shown in [140] that it is impossible to avoid degeneracy due to the fact that the variance of the importance weights can only increase over time. Degeneracy means that a lot of computational resources are dedicated to updating particles that have almost no contribution to the approximation of the posterior density ¼(G; |OE :; ). )
=

( | ) ( | - ) ( | - , ) ( - )

(2.72)

(2.73)

43

Preliminaries

2.5 Particle Filter

A suitable measure of degeneracy of the algorithm is the effective sample size P):: [147]
Figure 2.10 Schematics of the particle filter algorithm

N N N N ÌOE :; Í/ (G; where >; = ¼ËG; |G; , OE; ) is known as true weight, and 'jR() is the variance of a set. Since true weight cannot be calculate precisely, an estimate of P):: can be obtained by [147]

=

1+

(



)

(2.74)

N where >; is the normalized weight obtained from Eq. (2.71). It is important to note P)::  P$ and small values for P):: points to acute degeneracy. Degeneracy is an undesirable effect in particle filters and a simple solution would be to use a large number of particles for P$  , however, this is often impractical. Therefore, other solutions have been proposed in the literature including (1) good choice of importance density and (2) resampling.



=

= (

1

)

(2.75)

2.5.3 Importance Density Choice N A good choice of importance density means choosing a density ¼(G; |G; , OE :; ) that N minimizes 'jR(>; ) so that P):: is maximized. This optimal density is shown to be [140] ( |
-

,

)

= (

|

-

,

)=

( |

,

However, this choice of importance density suffers from two major drawbacks (1) it requires N to sample from ¼(G; |G; , OE; ) and (2) it needs to evaluate the integral over the new state. In general, it is not straightforward to do either of these things, although there are two cases where use of optimal importance density is possible (See [146]). 2.5.4 Resampling The basic idea of resampling is to eliminate those particles with negligible weights

( |

-

) (
-

)

|

-

)

(2.76)

44

Preliminaries
7Ñ

2.5 Particle Filter

N ÏNÐ by resampling P$ times from an approximate discrete representaerating a new set ÎG;

and concentrate on those particles with predominant weights. The resampling involves genY Y

N tion of ¼(G; |OE :; ) using Eq. (2.73) so that PrËG; = G; Í = >; . The resulting sample is in fact independent and identically distributed (IID) sample from the discrete density in Eq. N (2.73). As a result, the weights are now reset to >; = 1/P$ . Various methods of resampling include stratified sampling and residual sampling [148] and systematic resampling [149]. Although resampling process reduces degeneracy effect, it introduces other practical problems: 1. It limits the opportunity to parallelize since all particles need to be combined. 2. Sample impoverishment: particles with large weights are statistically selected and reselected again and again. This causes loss of diversity among particles as the regenerated sample set would include a lot of repeated particles. This is particularly problematic in the case of small process noise where all particles would collapse to a single point within a few iterations. Some methods to solve this issue can be named as resample-move algorithm [150] and regularization algorithm [151]. 3. Since the diversity of the particles' paths is reduced, any smoothed estimates based on these paths can degenerate.

2.5.5 Alternatives to Sub-optimality A good importance density is not always available. For example, if the prior ¼(G; |G; ) is used as the importance density and has a much broader distribution than the likelihood ¼(OE; |G; ), only a few particles will have a large weight. In order to remedy this problem, some methods exist that introduce intermediate distributions between the prior and likelihood such as bridging densities [152] and progressive correction [153]. If the likelihood is very peaked but can be factorized into number of broader distributions, the partitioned sampling method [142] can be used. 2.5.6 Variations of Particle Filter The SIS algorithm forms the basis for most particle filters. Other variations of particle filter proposed in the literature can be regarded as special cases of the SIS algorithm modifying the choice of importance sampling and/or resampling method. Among these variations stand sampling importance resampling (SIR) filter [141], auxiliary sampling importance resampling (ASIR) filter [154] and regularized particle filter (RPF) [155]. More details on variations and advantages of each variation can be found in their respective published work or in [146].

45

Preliminaries

2.6 Confusion Matrix

2.6 Confusion Matrix
In the field of machine learning and more specifically the problem of statistical classification, a confusion matrix, which is also known as an error matrix [156], is referred to as a specific table layout that allows for visualization of an algorithm's performance. Each row represents the instances in an actual class while each column represents the instances in a predicted class, or vice versa [156]. The name originates from the fact that this table layout can make it easy to see if the system is confusing two classes or mislabelling one as another. It can be considered as a special kind of contingency table, with two dimensions ("actual" and "predicted") where identical sets of "classes" are shown in both dimensions. Table 2.2 shows a sample of a confusion matrix. In this example, there were 10 trials to identify given samples as Class 1 or Class 2. It can be seen that the algorithm has performed poorly by classifying only 30% (3 out of 10) of the given samples correctly.
Table 2.2 Sample confusion matrix

Identified  Actual  Class 1 Class 2

Class 1 3 7

Class 2 7 3

There are many metrics associated with a confusion matrix to quantitatively evaluate the performance of an algorithm or method. These metrics come with a series of terminologies where important factors from these series are listed below:
Table 2.3 Terminology for confusion matrix [157]

Terminology condition positive (P)

condition negatives (N) true positive (TP) true negative (TN) false positive (FP) false negative (FN)

Definition the number of real positive cases in the data the number of real negative cases in the data equivalent with hit equivalent with correct rejection equivalent with false alarm equivalent with miss

The important metrics derived from these values that are more common in the literature are precision and accuracy. Precision or positive predictive value (PPV) and accuracy (ACC) are defined as [157] = = + + 46 (2.77) + + + (2.78)

=

+ +

Preliminaries

2.7 Conclusions

These metrics are used in the following sections to evaluate performance of the proposed algorithms on various cases for particular systems through Monte Carlo simulations. In the following chapters, when dealing with fault detection, the matrix shown in Table 2.4 is used as a template to evaluate performance of the proposed algorithm for a particular fault scenario under different simulation conditions.
Table 2.4 Sample Monte Carlo confusion matrix

Identified  Actual  Fault No Fault

Alarm True Positive (TP) False Positive (FP)

No Alarm False Negative (FN) True Negative (TN)

Furthermore, based on the PPV and ACC metrics introduced above, precision and accuracy of the algorithm under different cases will be analyzed.

2.7 Conclusions
In this chapter, required preliminaries were presented to lay out a foundation for the better understanding of the reader. first, the satellite attitude model, including dynamics and kinematics, were explained based on the actuator used onboard. Next, the actuator model including a high fidelity RW's mathematical model and a RW assembly (RWA) along with its mapping methods were explained followed by CMG dynamics model and its integration with satellite dynamics when used onboard satellite. Next, a brief review on Kalman filters, unscented Kalman filters, and adaptive unscented Kalman filters were provided with focus on UKF and adaptation schemes. Finally, a brief review on particle filters and various aspects of their implementation strategies along with possibility of implementation of such methods into a fault prognosis problem were presented. In the following sections, proposed methodologies in fault detection, isolation, and prognosis are presented, respectively.

47

Fault Detection

2.7 Conclusions

CHAPTER 3

Fault Detection

R

eaction wheels, as one of the most commonly used actuators in satellite attitude control systems, are prone to malfunction which could lead to catastrophic failures. Such malfunctions can be detected and addressed in time if proper analytical redundancy algorithms such as parameter estimation and control reconfiguration are employed. Major challenges in parameter estimation include speed and accuracy of the employed algorithm. Figure 3.1 illustrates a flow diagram for a model based CBM/PHM system. As can be seen, fault detection (the grayed box) is the first major module in this process where proper detection of anomalies in the system can play a major role in the success of the subsequent modules. Therefore, it is important to ensure the fault detection module of the framework is founded on solid ground.
Inputs Diagnostics Current Fault Condition Fault Isolation Outputs Fault Identification Prognostics

Plant

Model Outputs

Residuals

Fault Detection

Symptoms

Fault Evolution Prediction

Figure 3.1 Placement of fault detection module in a model-based CBM/PHM flow

This chapter presents a new 2-step approach for improving parameter estimation with adaptive unscented Kalman filter. The enhancement in tracking speed of the unscented Kalman filter is achieved by systematically adapting the covariance matrix to the faulty estimates using innovation and residual sequences combined with an adaptive fault annunciation scheme. The proposed approach provides the filter with the advantage of tracking sudden changes in the system non-measurable parameters accurately. Results showed successful detection of reaction wheel malfunctions without requiring a priori knowledge about system performance in the presence of abrupt, transient, intermittent, and incipient faults. Furthermore, the proposed approach resulted in superior filter performance with less mean squared errors for residuals compared to generic and adaptive unscented Kalman filters. The contents of this chapter are organized as follows: first the proposed covariance adaptive UKF is formulated. Next stability, convergence and boundedness of the proposed algorithm are analyzed. Next, computational complexity of the proposed algorithm is analyzed and compared with other relevant methods discussed in the literature. And finally, results and

48

Fault Detection

3.1 Proposed Covariance Adaptive UKF (CAUKF)

discussions are provided for the considered scenarios through extensive Monte Carlo simulations, confusion matrices, and their metrics.

3.1 Proposed Covariance Adaptive UKF (CAUKF)
In this section, the proposed 2-step detection and matching technique is detailed. The 2-steps comprising this algorithm are fault annunciation and filter adaptation. in the fault annunciation step, a scalar is calculated to amplify cumulative effect of residuals from the measurement outputs. In the adaption step, after a fault is annunciated, filters estimated covariance matrix is readjusted to the system's performance in such a way to accommodate a sudden change in the tracking as quickly as possible. Details of these two steps and the rationale behind their mechanisms are provided as follows. 3.1.1 Fault Annunciation Metric The posteriori estimates covariance matrix °MM elements show available confidence in the estimated values for the system under study. The larger the values of the elements, the less confidence in the estimations. Hence, when initiating the filter, it is common to have large values for the diagonal elements of this matrix, however, as the filter converges to the system parameters, the diagonal elements automatically decrease to show more confidence in the estimation. The challenge is when a sudden change in system parameters occurs; convergence deems slow and may not lead to fast estimation. Based on a discussion provided in [109], that a manual adjustment of the diagonal elements can remove such effect in the filter's performance, the following approach is proposed to enhance filter's tracking speed and accuracy. The proposed method consists of two steps: Annunciation and adjustment. In the Annunciation step, an anomaly in the filter estimations is detected; followed by adjustment where state covariance matrix elements are adjusted for better performance. Scalar [ is introduced as [109] =
-

Bisht and Singh [109] propose a constant threshold for anomaly detection where [T is the threshold based on the available data and a fault is annunciated when [ > [T . Since this can cause false alarms, an outlier detection can also be incorporated to remedy the problem. Although the results shown in their work seems promising, using a constant-valued threshold has two major limitations: (1) it requires a priori knowledge about the dataset since [T is determined based on statistical properties of the whole dataset. (2) It can lead to divergence or poor performance when it is not pre-defined properly. In order to address these limitations, we propose an adaptation mechanism for [T that does not require a priori knowledge; considering that for a normally distributed dataset, 99.73% of the data falls within three standard deviations (3Õ) from the mean [158]. At time step , mean (xU ) and standard deviation (ÕU ) are computed considering a memory window of size P as (3.1) 49

Fault Detection

3.1 Proposed Covariance Adaptive UKF (CAUKF) 1 = Ö ×Ø
=1

-

Ù

2

(3.2)

=

1

×
=1

(3.3)

which leads to calculating the adaptive threshold as where DU denotes the adaptive threshold factor and is selected based on the statistical information about the noise in the system as discussed earlier. (3.4) 3.1.2 Filter Adaptation Algorithm When a fault is annunciated, 8MM elements need to be adjusted to compensate for the filter latency. In order to adjust 8 MM elements, the algorithm in Table 3.1 is considered. This algorithm is a modified version of the algorithm presented in [109]. 88; = 8; and R3Ú6 =  For i = 1 to rows(8; ) For j = 0.1 to 1 step 0.1 Set 88;·· = W
Table 3.1 Proposed CAUKF covariance adaptation algorithm

=

1: 2: 3: 3a: 3b: 3c: 3d: 4: 5:

where 88; is the temporary posteriori estimate covariance matrix used for finding diagonal elements of the actual 8; matrix. The following modifications compared to the algorithm in [109] are applied: (1) Residual error R, unlike in [109], is calculated without (8FF ) in Eq. (3.1) to reduce simulation computational time. It was found that inclusion or exclusion of such term does not affect the performance of the filter to an extent that results become unsatisfactory. (2) A grid search is employed instead of a threshold check compared to [109], since [T is not known in advance and adaptively changes on-line based on the incoming data. The grid search limits for each 88; diagonal elements are based on numerical simulations where lower bound cannot be 0 due to numerical stability and upper bound needs to be large enough to speed up the tracking speed. It was found that the upper bound value

Calculate G; using 88; using CAUKF Calculate R<)h = (OE; - G; )i (OE; - G; ) with measurement OE; If R<)h < R3Ú6 set 8; NN = W; R3Ú6 = R<)h Go to 3 Go to 2

50

Fault Detection

3.2 Stability of the CAUKF

of 1 is sufficient for the purpose of the cases studied in this thesis. For other systems and scenarios, proper value of the upper bound can be determined via simulations.

3.2 Stability of the CAUKF
In order to stablish required stability, convergence, and boundedness of the modified CAUKF, the summary of the proof provided by Xiong et al. [159] for a modified version of the UKF is presented here, followed by the discussion on how the proposed modification in this thesis affect the so-called proof and concludes that the proof holds for the proposed modification in this thesis, given the structure of the filter is not fundamentally modified. The proof in [159] consists of two major sections as follows 3.2.1 Instrumental Diagonal Matrix and Extra Positive Definite Matrix to give a formulation for the Unscented Transform (UT) technique, instrumental time-varying matrices are introduced. Defining the estimation and prediction error as [159]  |  = = -  -  (3.5)  |
-

Expanding G; by a Taylor series about G ²; gives an approximate equality [159] where [159]  |
-

-

(3.6)



-

+

(3.7)

An unknown instrumental diagonal matrix [; = \VjkË[ ,;, [,,; , ... ... , [s,; Í is introduced to take these residuals into account and obtain an exact equality so that [159]
-

=

( )



(3.8)

The residual of the measurement is defined as [159] Substituting noise, their covariances, and measurement update into (3.10) provides, [159] In the modified UKF algorithm [159], the predicted covariance matrix is calculated as [159] where @; is an extra positive definite matrix. The real prediction error covariance matrix is [159] 
-

 |

-

= 



-

+

(3.9)

=

-



(3.10) +

 =

 |

-

(3.11) -  | ) + + ,

=

=

(

-

-

 |

-

)(

-

-

(3.12)

51

Fault Detection |
-

3.2 Stability of the CAUKF =  |
-

=

i i Ü; /; where 8; |; is the difference between [; /; 8 [; and ·([; /; G Ý; G Ý; i /; [; ). Let Z8; |; be the difference between the real covariance matrix 8; |; and the sample one , ²; |; ) ( N,; Ì; - G ²; |; )i + @; , the calculated covariance matrix NÐT >N ( N,; Ì; - G

=

[(





-

-

+

)(

 | 

+

-

-

-

+

+

,

) ]

(3.13)

shown in (3.12) becomes [159] 
-

=

|

-

+

|

-

+ | +

= + |



-

+ ,

|

-

+ 

(3.14)

where [159]

 = 

-

-

+

(3.15)

3.2.2 Stochastic Boundedness of Estimation Error For analysis of the error dynamics residual, standard results regarding boundedness of stochastic processes the proof provided in [159] are recalled with the following additional remarks (1) [; is an unknown instrumental diagonal matrix introduced to evaluate the error introduced by the UT. Therefore, the stability of the algorithm does not depend on the magnitude of [; . Although different [; may change the value of - N< , the require inequality Ü ; is positive definite. In will still hold and its sign will not change so long as the matrix @ Ü;  ² N< is fulfilled, an upper bound on · l'(Þ; )|Þ; m can be obtained other words, if @ and the estimation error will remain bounded even for bad approximation to the nonlinear Ü; is not manipulated model. Since in the adaption proposed in this thesis, the matrix @ manually, the proof provided here holds for the proposed modification in this thesis. Therefore, it can be concluded that the error remains bounded for the proposed CAUKF. (2) To Ü; need to be positive definite. From (23), as ensure the stability of UKF, the matrices @ 8; |; and 8; |; may not be positive definite matrices, extra additive matrix Ü;  ² N< is satisfied. @4 should be introduced as a modification to the UKF so that @ Ü ; is sufficiently large, the required condition can always be fulfilled. This means Clearly, if @ that the modified UKF can tolerate high order error introduced during the UT by enlarging the noise covariance matrix. Furthermore, the precision of the algorithm also relates to the Ü; and its is closely related to observability property of the linearized system [160]. value of @ It should be added that in the proposed CAUKF in this thesis, since the structure of the Ü; is not manually manipulated, the proof and discussion provided herein still holds. There@ Ü; remains positive definite and the proposed fore, it can be concluded that the matrix @ CAUKF is stable. 52

Fault Detection

3.3 Error Performance of the CAUKF

3.3 Error Performance of the CAUKF
Cramér­Rao lower bound (CRLB), which provides a lower bound on the MSE is widely used to assess the performance of an estimator. In this section, CRLB is applied to evaluate the effectiveness of the modified UKF in [159], and further extended to the CAUKF proposed in this thesis. 3.3.1 Cramér­Rao lower bound ; ; = {GT , G , ... . . , G; } represent state vector series, T = {ET , E , ... . , E; } noisy obLet GT ; ; ; ; servations, ¼( T T ) the joint probability density of the pair( T T ) and G ²; a estimate of ; G; . G ²; is a function of T . The CRLB on the estimation error has the form [160] where Jk is the Fisher information matrix [159] = - (  {[ -  ][ -  ] } , )
-

,

(3.16)

An efficient method for computing Y; recursively is given in [161]. - ( + ( ( (
-

.

(3.17)

Proposition 1. The sequence {Y; } of posterior information matrices for estimating state vectors {G; } obeys the recursion [159] where
= -

)-
- - -

,

(3.18)

= = = (

- - | -
-

-

| | |
-

) ) )

, , , ( | )

(3.19) .

=

-

)

,+

-

From Proposition 1, it follows that Proposition 2. Assume that the nonlinear filtering is applied to system (2.43), the CRLB is given by [159] 
-

where [159] =
-1

,

(3.20) +
-1

+

-1

-

-1

Ë

-1

Í

-1

-1

.

(3.21)

53

Fault Detection

3.4 Computational Complexity of the CAUKF

The proof of Proposition 2 can be found in Appendix B of [159]. 3.3.2 The Mean Square Error of the UKF In this subsection, the MSE for the UKF is derived and compared to the CRLB. Theorem 2. Assuming that the UKF for (2.43) is expressed as Section 2.4.1, the MSE of the UKF-based estimation method is given by [159] = [ - + +

-

where

,

- -

- - + -

-

-

 - ]-

(3.22)

=( -

)

|

-1

The proof of Theorem 2 can be found in Appendix C of [159]. Remark 2. Compared to the CRLB shown in (3.20), it is evident that the MSE of the UKF (3.22) depends on the instrumental matrix [; and the calculated covariance matrix Ü; , while the CRLB is related to @; . If the error introduced by the UT is negligible, and @ Ü; = @; , or equivalently, [; = , 8; = 0, and (3.14) can be reduced to [159] @  |
-

-1

( -

) .

(3.23)

Then the MSE of the UKF is equal to the CRLB. Thus, the UKF reaches the optimal Ü; and @; is small performance if high order error is negligible and the difference between @ enough. Revisiting the argument provided in the previous section, since the structure of @; and its estimate is not manually manipulated in the proposed CAUKF in this thesis, the analysis for the error performance provided here holds and is applicable to the proposed CAUKF error performance analysis. It should be noted that the main difference in the proposed CAUKF and UKF discussed in [159] is the change in computation process from one seamless procedure to a 2-step approach, i.e. detect and match proposed in this thesis. The matching process also deals only with 8; , which is the state/parameter estimate covariance and does not affect the proofs or analyses provided in this section. Therefore, it can be concluded that the stability, convergence, and boundedness analyses provided in this section and the previous section are applicable to and hold for the proposed CAUKF in this thesis.



=

-

=



-

|

+
-

.

,

(3.24) (3.25)

3.4 Computational Complexity of the CAUKF
In this section, the computational complexity of the proposed CAUKF is analyzed and compared to AUKF and UKF to evaluate how intense the computations would be with 54

Fault Detection

3.4 Computational Complexity of the CAUKF

the modifications proposed in this thesis. Computational complexity theory is a division of the theory of computation in theoretical computer science focusing on classifying computational problems according to their intrinsic difficulty. A computational problem is understood to be a task that is to be solved by a computer, which also means the problem may be solved by mechanical application of mathematical steps, such as an algorithm. A problem is regarded as inherently difficult if its solution requires significant resources, whatever the algorithm used. One of the roles of computational complexity theory is to determine the practical limits on what computers can and cannot do. However, in recent years, other fields employ this notion to evaluate performance of the algorithms developed regardless of the machines they will be run on. Therefore, in this section a brief analysis of the computational complexity for the methods discussed in this chapter is provided. In a study done by Rhudy [162], the computational complexity of the UKF for different types of matrix square root employed in the algorithm are calculated as shown in Table 3.2 where FLOPS refers to floating point operations per second.
Table 3.2 Matrix square root algorithm computational requirement [162]

Algorithm Diagonalization Schur Newton's iteration Denman-Beavers (DB) iteration Product DB iteration Cyclic Reduction (CR) iteration Cholesky

49

/3 - /2 + 43 /6 85n /3 8n /3 4n 4n 14n /3 n /3

FLOPS

In this thesis, the Cholesky matrix square root is considered for the original UKF employed in the thesis. Therefore, the rest of the analysis and computation provided in this section is based on the fact that the original UKF with Cholesky matrix square root method is equal to D /3 FLOPS. In order to compute the computational complexity for the AUKF and proposed CAUKF, it is important to note that both of these methods consist of 2 parts: annunciation, and adaptation. The main difference between the two methods is in the annunciation component since both employ similar covariance matching algorithm. In the following section, the computational complexity of each component will be analyzed. 3.4.1 Fault Annunciation Complexity Referring to eq. (3.1), this component is shared between the two methods AUKF

55

Fault Detection

3.4 Computational Complexity of the CAUKF

and CAUKF. Considering that each FLOPS addresses a floating operation, calculating eq. (3.1), which is in the matrix multiplication form, can be calculated as follows. Since multiplication of two D × D matracies requires 2D FLOPS [163], it can be seen that eq. (3.1), which is multiplication of three D × D matrices requires 3D FLOPs1. Moving to the modification proposed in this thesis, there are extra terms added to the annunciation, which include Eqs. (3.2), (3.3), and (3.4). calculating each term's computational complexity yields (1) Eq. (3.2) is a square root of a mean of a summation. Since summation is a loop with constant increment in the step size2, the complexity of this term is á(D). (2) Eq. (3.3) is a mean of a summation. Since summation is a loop with constant increment in the step size, the complexity of this term is also á(D). (3) Eq. (3.4) is a multiplication. It is considered as complexity á(1). Since these extra steps are added together in the modification proposed in this thesis, the overall complexity would be the summation of these terms. This leads to D + D + 1 = 2D + 1. Therefore, the overall complexity term for the fault annunciation can be considered as 3D + 2D + 1.

3.4.2 Fault Adaptation Complexity Referring to Table 3.1, the proposed algorithm consists of two inner loops with constants increments in step size. This leads to the computational complexity of á(D, ). This is without considering the new estimates calculated in the most inner loop. That is to avoid extra calculations for the sake of comparison in this study. Therefore, the computational complexity of the adaptation algorithm, which is similarly shared between AUKF and CAUKF is á(D, ).

3.4.3 Overall Complexity Referring to the discussions provided above, it can be seen that the overall computational complexity of each algorithm is the summation of its components. That means, if individual components/blocks of an algorithm are put together to form its totality, the overall computational complexity of the final algorithm, is equal to summation of all individual consisting blocks. Therefore, the computational complexity of the algorithm discussed in this chapter can be presented as shown in Table 3.3.
Table 3.3 Computational complexity of different estimation methods

Algorithm

FLOPS

1 2

https://stackoverflow.com/questions/13900538/theoretical-and-practical-matrix-multiplication-flop http://www.geeksforgeeks.org/analysis-of-algorithms-set-4-analysis-of-loops/

56

Fault Detection
UKF AUKF CAUKF

3.5 Noise Considerations n /3 n /3 + 3 + n /3 + 3 + + 2 + 1

It can be seen that the order of complexity, which is the order of the term with the highest power, for all three approaches is equal to 3. In other words, the order of complexity for all three approaches is á(D ). This means that the computation of each algorithm should roughly take the same amount of time mostly driven by the dominant term.

3.5 Noise Considerations
In the simulations conducted in this study, measurement and process noise are considered for the systems under simulation. In fault detection and isolation chapters, for the measurement and process noise, Gaussian zero-mean noise with a variance provided in each section is considered based on the discussions provided in [164]. In fault prognosis chapter, for the process noise, Gaussian zero-mean noise with a variance provided in each section is considered based on the discussions provided in [164] and for the measurement noise, to evaluate performance of PF under non-Gaussian noise distribution, other types of additive noise are considered as described in respective sections. The noise levels considered for each chapter under various sections of scenarios and simulations, are considered as white noise with standard deviation (Õ) of 10- and 10. for motor current and flywheel's angular velocity, respectively. These values are consistent with the values provided in [165]. In the context of this study, it is assumed that the measurement sensors for the RWs onboard satellite can provide such level of accuracy. Furthermore, it is assumed that an attitude control system (ACS) exists on the satellite and it can handle this level of accuracy for quaternion and angular velocity measurements of the satellite using available sensor systems such as magnetometers, and rate gyros [164]. The Kalman filter, which processes the incoming sensors measurements and provides a state/parameter estimate of the system states and non-measurable parameters also requires process and measurement noise matrices where these values are selected in such a way to accommodate the noise variance requirements set in [164] as listed in the tables for each simulation provided under results and discussion section of each of the Chapters 3, 4, and 5. It should be noted that to further investigate validity and stability of the approaches proposed in this thesis, multiple levels of fault of introduced and investigated through extensive Monte Carlo simulations. The noise level factor is introduced as â where it represents the multiplication of the proposed measurements noise variance by a factor. Furthermore, it should be noted that since motor current and flywheel's angular velocity for the RW are not of the same order of magnitude, the additive noise should be adjusted accordingly for each measurement.

57

Fault Detection

3.6 Results and Discussion

3.6 Results and Discussion
In order to evaluate the performance of the proposed algorithm presented, the RW model was examined for abrupt, transient, intermittent, and incipient fault scenarios. And CMG unit was examined for abrupt faults. All simulations were conducted on a Dell PC XPS8700 running on an Intel® CoreTM i7-4790 CPU with 3.60 GHz processing power, 8 MB cache and 16 GB of RAM. Simulations were set up as shown in Figure 3.3. First, we examine the constant threshold defined in [109] and the proposed adaptive threshold. Figure 3.2 illustrates changes of [ and [T for a sample scenario of the RW model in Eq. (2.31) Using formulation in [109], the threshold is constant as shown in Figure 3.2(c) while in Figure 3.2(d) the threshold changes its value with changes in [ , based on Eq. (3.4).

(a)

(b)

(c)

(d)

Figure 3.2 Comparison of  and its threshold for transient fault scenario (a) and (b) between (c) fixed and (d) adaptive approaches

3.6.1 Fault Types In this section, different fault types that can be introduced to the system actuator are formulated mathematically. In this thesis, the actuator faults of the spacecraft are investigated because actuators are the components that are among the most critical and vital parts of a spacecraft. Sensor redundancy can be a low-cost solution for handling sensor faults, but for actuators it is not possible to have always extra actuators to recover from the possibility of actuator fault occurrence. The actuator faults can be classified into four types, namely: lock-in-place, hard-over failure, float, and loss-of-effectiveness [166]. These faults may be represented as follows:

58

Fault Detection  

3.6 Results and Discussion

( =0

+

)

=

( -

) -

where ãN is the healthy actuator control matrix, ^ is the control input, ãN is the faulty actuator control matrix, +N = -ãN N is a negative semi-definite matrix with diagonal matrix N = \Vjk(åN; ) where åN; = låN åN, åN mi includes the LOE parameters 0 < åNY < 1. The æN SM and æN N< are the maximum and minimum actuations, respectively. And æN 3!; (æN N< < æN 3!; < æN SM ) is a constant level of actuation [81]. In this thesis, loss of effectiveness actuator fault is considered, which is the most common fault in spacecraft actuators. For this kind of fault, the applied control signal becomes a percentage of the desired control signal. In order to introduce faults, for RW, LOE is presented in terms of change in a system dynamics parameter value (i.e. 4 or '%&$ ). For CMG, LOE is presented in a form of a matrix (/0 ) where effectiveness itself is multiplied by output of each unit onboard satellite. Further details of these fault presentations are provided in the respective sections for both RW and CMG where results and discussions are provided.
:

(

)

( ( )

)

(3.26)

3.6.2 Monte Carlo Simulations To further substantiate the results in each section, a comprehensive Monte Carlo simulation is provided for each fault type under two different simulation condition changes: (1) noise level, (2) severity of the fault. For each case, a table similar to Table 3.4 is provided to quantify performance metrics including precision and accuracy.
Table 3.4 Sample Monte Carlo confusion matrix

Identified  Actual  Fault No Fault Precision Accuracy

Alarm

No Alarm

True Positive (TP) False Negative (FN) False Positive (FP) True Negative (TN) PPV% ACC%

For each table, simulations are conducted 100 times under each scenario. Each scenario is explained in the caption of the table, and data are recorded as described in Table 3.4 for TP, FP, FN, TN. Furthermore, PPV and ACC are calculated based on the equations provided in eq. (2.77) and eq. (2.78), respectively. TP was considered if the trigger for alarm/detection of the fault was within ±0.5 sec of the actual fault time.

59

Fault Detection

3.6 Results and Discussion

3.6.3 Reaction Wheels For the following simulations the process model in Eq. (2.43) is provided as Eq. (2.31) and the measurement model in Eq. (2.43) is provided as k( ; ) = ; + ?; . Other parameters are presented in Table 3.5 where × is the identity matrix of size ~ × ~. To produce measured states, normally distributed zero-mean white noise with standard deviation Õ< is added to the nominal states; where ç is used for noise factor, which can also be considered as an indicator for signal to noise (SNR) ratio. The step size for grid search in Table 3.1 is selected to be 0.1 based on low computational demand for the grid search and high tracking performance requirements. Other parameters including P, ¶, D were selected based on extensive simulations. Simulation period for all cases presented is from 0 sec to 100 sec. The residual vector is defined as where è is the measured current from the RW, é is the estimated current for the RW, ë is the estimated angular velocity e ê is the measured angular velocity of the RW, and e for the RW. Furthermore, parameter residuals vector is defined as (3.27) Ü%&$ are estimated where 4 and '%&$ are the values defined in the fault scenario and Ü 4 and ' values for these parameters. It is important to note that the estimator only uses RM residuals for calculating estimates, while Rì values are only used for visualisation of the results. For Monte Carlo simulations where loss of effectiveness or severity of the fault is discussed for a particular parameter, the percentage provided as the LOE or severity is calculated as follows (3.28) %= %= - × 100 (3.29) = -  , -  =[  -  ,  -  ]

where faulty value is the value of the parameter under which the simulation was conducted and the nominal value is the value defined as the nominal performance case for the system. For RW, non-measurable parameters 4 and '%&$ are considered while for the CMG fault parameters are directly defined as an effectiveness factor.
White Noise ZOH RW High Fidelity Model With Faults\Hardware in the Loop

 I

Control Voltage

Va

ZOH

+

m Im
Parameter Estimation with CAUKF

p



ZOH

+
White Noise

 

 I

RW High Fidelity Analytical Model

Figure 3.3 Simulation setup for performance evaluation of the proposed filter

60

Fault Detection

3.6 Results and Discussion
Table 3.5 Fault detection simulation parameters for RW

Parameter Input Voltage (' ) !3 Initial Input Voltage (' ) !3 S Initial States ( T = l , em) Initial Parameters (dT = l 4 , '%&$ m) Filter Parameters ([", ¢, -m) Process Noise Standard Deviation (Õí ) Measurement Noise Standard Deviation (Õq ) Process Noise Covariance Matrix (@T ) Measurement Noise Covariance Matrices ( T ) Motor Current Õ< Motor Angular Velocity Õ< Window Size (P) Adaptive Fading Factor (¶ ) Adaptive Threshold Factor (DU ) Step time (*$ )

Value 5sin(0.2t) V 0.1 V [0 A, 0 rpm] [0.1 Nm/A, 2 V] [1,2,2] 10 10, Õí <×< , Õq × l10, Õq ç] A l10 Õq çm rpm 50 60000 6 0.01 sec

3.6.3.1

Case 1 ­ Abrupt Fault

The abrupt fault essentially occurs when a parameter in a system changes its value from one to another at a certain time. In this case, an abrupt fault scenario in the bus voltage ('%&$ ) of the RW is considered. State and parameter estimates for this case are illustrated in Figure 3.4 while their residuals are shown in Figure 3.5. Scalar [ and its adaptive threshold [T are depicted in Figure 3.6. As can be observed from Figure 3.4, when a fault occurs, there is a jump in states and more specifically in motor current ( ) value. Consequently, a spike can be observed in respective residuals shown in Figure 3.5 at the instant of fault occurrence. Time '%&$ (s) < 50  50
Table 3.6 Abrupt Bus Voltage fault profile

'%&$ (V) 6 7.5

Time (4 (s) < 50  50

(4 (Nm/A) 0.029 0.029

In addition, these remarks agree with the observations from Figure 3.6 where at the occurrence of the fault, [ exceeds its adaptive threshold ([T ) and [T adapts itself accordingly afterwards to avoid consequent false fault annunciations. Referring to Figure 3.7 and Figure 3.8, performance evaluations are presented for the fault scenario described in Table 3.6 for generic unscented Kalman filter (UKF), adaptive unscented Kalman filter (AUKF) proposed in [109], and covariance-matching adaptive unscented Kalman filter (CAUKF) proposed in this study. In addition, numerical results

61

Fault Detection

3.6 Results and Discussion

are presented in Table 3.7, where `time' refers to the total simulation time, to put comparisons in perspective. Results in Table 3.7 show that CAUKF takes nearly 4% more computation time but provides about 4% less mean squared error (MSE) for RW parameter residuals compared to AUKF for two noise levels.
I (A) (rpm)
Figure 3.6 Case 1 ­ and for abrupt fault with =10

Figure 3.4 Case 1 ­ state and parameters estimates for abrupt fault with =10

I (A)

Figure 3.5 Case 1 - state and parameters residuals for abrupt fault with =10

62

V bus (Volts)

Kt (Nm/A)

(rpm)

V bus (Volts)

K t (Nm/A)

Fault Detection Noise factor ç = 1 MSE ((4 ) 7.28×10-7 1.01×10-7 1.01×10-7

3.6 Results and Discussion
Table 3.7 Abrupt Bus Voltage fault performance measures

Algorithm UKF AUKF CAUKF

time (sec) 2.22 2.23 2.30

MSE ('%&$ ) 4.27×10+2 2.53×10-3 2.53×10-3

time (sec) 2.17 2.20 2.30

Noise factor ç = 10 MSE ((4 ) 4.12×10-7 1.01×10-7 1.01×10-7

MSE ('%&$ ) 2.63×10-3 2.53×10-3 2.53×10-3

K t (Nm/A)
Figure 3.7 Case 1 ­ comparison of

estimates for abrupt fault with =10

V bus (Volts)
Figure 3.8 Case 1 ­ comparison of

estimates for abrupt fault with =10

For all the remaining case studies, similar responses were observed for the changes in state estimates and their residuals (see Figure 3.4 and Figure 3.5), and [ (see Figure 3.6). This comes from the fact that input provided to all cases is similar and the only difference is in the time and severity of the faults introduced in the system. As the focus in this chapter is on parameter estimation performance of the proposed scheme compared to other methods available in the literature, only comparative figures (see Figure 3.7 and Figure 3.8) are

63

Fault Detection

3.6 Results and Discussion

presented for the remaining case studies. In the following tables, results of comprehensive Monte Carlo simulations are provided under various simulation conditions including noise level in accordance to practical experimental applications [167], [168] and fault severity. In the following MC simulation, the nominal value for '%&$ is considered as 6 Volts and percentage of severity is calculated from eq. (3.29). furthermore, noise is reposted in the â form as discussed at the beginning of this section. The inception of the fault is generated randomly using the RjD\() function in MATLAB and imposing limit between 5 sec to 50 sec. Table 3.8 to Table 3.15 show results for Monte Carlo simulations for a 5% loss of effectiveness, which is equal to the '%&$ = 6.3 volts. Results are presented from â = 10 to â = 200 as an extreme case. The 5% LOE can be considered as a slight change in the '%&$ . While the â = 200 imposes an extreme signal to noise (SNR) ratio condition.
Table 3.8 MC for LOE 5%, =10 Table 3.9 MC for LOE 5%, =20

Alarm Fault No Fault Precision Accuracy 100 4

No Alarm 0 0 96.15% 96.15% Fault No Fault Precision Accuracy

Alarm 100 10

No Alarm 0 0 90.91% 90.91%

Table 3.10 MC for LOE 5%, =30

Table 3.11 MC for LOE 5%, =40

Alarm Fault No Fault Precision Accuracy 97 3

No Alarm 3 0 97.00% 94.17% Fault No Fault Precision Accuracy

Alarm 73 7

No Alarm 26 0 91.25% 68.87% No Alarm 96 0 25.00% 1.00% No Alarm 97 0 66.67% 2.00%

Table 3.12 MC for LOE 5%, =50

Table 3.13 MC for LOE 5%, =100

Alarm Fault No Fault Precision Accuracy 38 2

No Alarm 60 0 95.00% 38.00% No Alarm 97 0 0.00% 0.00% Fault No Fault Precision Accuracy Fault No Fault Precision Accuracy

Alarm 1 3

Table 3.14 MC for LOE 5%, =150

Table 3.15 MC for LOE 5%, =200

Alarm Fault No Fault Precision Accuracy 0 3

Alarm 2 1

From Table 3.8 to Table 3.15 it can be clearly observed that the because the LOE is comparatively small, as the noise level is increased, precision and accuracy of the fault

64

Fault Detection

3.6 Results and Discussion

detection algorithm decreases. It should be noted that the difference between precision and accuracy is that precision is how close the algorithm is outputting results to actual/desired results, while accuracy is how well the algorithm is performing over time. Therefore, effect of noise, as long as it does not completely overshadows the signal itself (e.g. â = 200), should be more present in the precision and effect of noise overall should be more visible in the accuracy. Referring back to the results from Table 3.8 to Table 3.15, it can be observed that with lower noise levels (â = 10 to â = 30) accuracy remains almost constant, while with higher noise levels (â > 30) accuracy start to degrade. Another factor to consider is the threshold adjustment for different levels of noise. In these MC simulations, threshold factor (D) was kept constant. However, one can adjust this factor to obtain more accuracy.
Table 3.16 MC for LOE 10%, =10 Table 3.17 MC for LOE 10%, =20

Alarm Fault No Fault Precision Accuracy 100 6

No Alarm 0 0 94.34% 94.34% Fault No Fault Precision Accuracy

Alarm 100 3

No Alarm 0 0 97.09% 97.09%

Table 3.18 MC for LOE 10%, =30

Table 3.19 MC for LOE 10%, =40

Alarm Fault No Fault Precision Accuracy 100 5

No Alarm 3 0 95.24% 95.24% Fault No Fault Precision Accuracy

Alarm 100 3

No Alarm 26 0 97.09% 97.09% No Alarm 62 0 92.50% 36.27% No Alarm 96 0 25.00% 1.00%

Table 3.20 MC for LOE 10%, =50

Table 3.21 MC for LOE 10%, =100

Alarm Fault No Fault Precision Accuracy 99 2

No Alarm 1 0 98.02% 97.06% Fault No Fault Precision Accuracy

Alarm 37 3

Table 3.22 MC for LOE 10%, =150

Table 3.23 MC for LOE 10%, =200

Alarm Fault No Fault Precision Accuracy 4 3

No Alarm 93 0 57.14% 4.00% Fault No Fault Precision Accuracy

Alarm 1 3

Table 3.16 to Table 3.23 show results for the LOE of 10% for a range of noise levels as above. It can be observed from these tables that with 5% increase in the LOE, the precision and accuracy of the algorithm have increased slightly because now there is a bigger difference in the parameter value change.

65

Fault Detection
Table 3.24 MC for LOE 15%, =10

3.6 Results and Discussion
Table 3.25 MC for LOE 15%, =20

Alarm Fault No Fault Precision Accuracy 100 5

No Alarm 0 0 95.24% 95.24% Fault No Fault Precision Accuracy

Alarm 100 5

No Alarm 0 0 95.24% 95.24%

Table 3.26 MC for LOE 15%, =30

Table 3.27 MC for LOE 15%, =40

Alarm Fault No Fault Precision Accuracy 100 2

No Alarm 0 0 98.04% 98.04% Fault No Fault Precision Accuracy

Alarm 100 3

No Alarm 0 0 97.09% 97.09%

Table 3.28 MC for LOE 15%, =50

Table 3.29 MC for LOE 15%, =100

Alarm Fault No Fault Precision Accuracy 100 2

No Alarm 0 0 98.04% 98.04% Fault No Fault Precision Accuracy

Alarm 100 5

No Alarm 6 0 94.95% 89.52%

Table 3.30 MC for LOE 15%, =150

Table 3.31 MC for LOE 15%, =200

Alarm Fault No Fault Precision Accuracy 37 5

No Alarm 58 0 88.10% 37.00% Fault No Fault Precision Accuracy

Alarm 9 3

No Alarm 88 0 75.00% 9.00%

This can be expected since the jump in the parameter change has a higher SNR compared to LEO of 5% and therefore, more observable by the algorithm. Table 3.24 to Table 3.31 show results for the LOE of 15% for a range of noise levels as above. It can be observed from these tables that with 5% increase in the LOE, the precision and accuracy of the algorithm have again increased slightly because now there is a bigger difference in the parameter value change. This can be expected since the jump in the parameter change has a higher SNR compared to LEO of 5% and therefore, more observable by the algorithm. This phenomenon can be further observed in the results shown in Table 3.32 to Table 3.39 for the LOE of 20% for a range of noise levels as above. Result in Table 3.32 to Table 3.39 further verify that the increase in LEO improves the performance of the algorithm under higher levels of noise by increasing the accuracy compared to the previous lower LOE cases. Since other types of fault including transient, intermittent, and incipient can be arguably constructed with blocks of abrupt fault, it can be argued that the same performance is expected for the following cases provided as transient, intermittent, and incipient faults.

66

Fault Detection

3.6 Results and Discussion

Therefore, Monte Carlo simulations are not provided for the remaining cases of this chapter and a single case with comparison plots and tables among UKF, AUKF, and CAUKF results are provided.
Table 3.32 MC for LOE 20%, =10 Table 3.33 MC for LOE 20%, =20

Alarm Fault No Fault Precision Accuracy 100 6

No Alarm 0 0 94.34% 94.34% Fault No Fault Precision Accuracy

Alarm 100 2

No Alarm 0 0 98.04% 98.04%

Table 3.34 MC for LOE 20%, =30

Table 3.35 MC for LOE 20%, =40

Alarm Fault No Fault Precision Accuracy 100 2

No Alarm 0 0 98.04% 98.04% Fault No Fault Precision Accuracy

Alarm 100 5

No Alarm 0 0 95.24% 95.24%

Table 3.36 MC for LOE 20%, =50

Table 3.37 MC for LOE 20%, =100

Alarm Fault No Fault Precision Accuracy 100 0

No Alarm 0 0 100% 100% Fault No Fault Precision Accuracy

Alarm 100 1

No Alarm 0 0 99.01% 99.01%

Table 3.38 MC for LOE 20%, =150

Table 3.39 MC for LOE 20%, =200

Alarm Fault No Fault Precision Accuracy 83 1

No Alarm 17 0 98.81% 82.18% Fault No Fault Precision Accuracy

Alarm 43 2

No Alarm 55 0 95.56% 43.00%

3.6.3.2

Case 2 ­ Transient Fault

The transient fault essentially occurs when a parameter in a system changes its value from one to another for a certain period and then back to its nominal value afterward. In this case, a transient fault scenario in the bus voltage ('%&$ ) of the RW is considered. Time '%&$ (s) < 50 50  < 70  70
Table 3.40 Transient Bus Voltage fault profile

'%&$ (V) 6 7.5 6

Time (4 (s) < 50 50   70  50

(4 (Nm/A) 0.029 0.029 0.029

67

Fault Detection

3.6 Results and Discussion

Table 3.41 Transient Bus Voltage fault performance measures

Algorithm UKF AUKF CAUKF
0.06

time (sec) 2.24 2.24 3.32

Noise factor ç = 1 MSE ((4 ) 3.09×10-4 1.01×10-7 1.56×10-7

MSE ('%&$ ) 4.04×10+1 2.99×10-3 2.99×10-3

time (sec) 2.24 2.23 2.30

Noise factor ç = 10 MSE ((4 ) 5.84×10-8 1.20×10-7 1.44×10-7

MSE ('%&$ ) 3.52×10-3 3.87×10-3 3.31×10-3

0.03 0.05

Kt (Nm/A)

0.029 0.04 0.03 0.02 0.028 61 62 63 64 65

UKF AUKF CAUKF True

0

10

20

30

40

50

60

70

80

90

100

Time (sec)
Figure 3.9 Case 2 ­ comparison of estimates for transient fault with =10

Vbus (Volts)
Figure 3.10 Case 2 ­ comparison of

estimates for transient fault with =10

Referring to Figure 3.9 and Figure 3.10, performance evaluations are presented for the fault scenario described in Table 3.40 with the same details described for Case 1. Results in Table 3.41 show that CAUKF takes nearly 4% more computation time but provides 14% less MSE for RW parameter residuals compared to AUKF.

3.6.3.3

Case 3 ­ Intermittent Fault

The intermittent fault occurs when a parameter in the system changes its value from time to time on an irregular basis. In this case intermittent in-phase and out-of-phase fault

68

Fault Detection

3.6 Results and Discussion

scenarios in the bus voltage ('%&$ ) and motor torque ( 4 ) parameters of the RW are considered (see Table 3.42).
Table 3.42 Intermittent Bus Voltage and motor torque fault profile

Time '%&$ (s) < 20 20  < 28 28  < 35 35  < 50 50  < 60 60  < 70 70  < 80  80

'%&$ (V) 6 7 8 6 6.5 5 8 6

Time (4 (s) < 20 20  < 28 28  < 35 35  < 50 50  < 60 60  < 70 70  < 80  80

(4 (Nm/A) 0.029 0.029 0.039 0.039 0.039 0.029 0.029 0.029

Referring to Figure 3.11 and Figure 3.12, UKF fails to track the parameters properly during simulation (see the spikes in Figure 3.11), where AUKF and CAUKF successfully track the parameters. However, in Table 3.43, CAUKF takes nearly 5% more computation time but provides 42% less MSE for RW parameter residuals compared to AUKF.
Table 3.43 Intermittent Bus Voltage and motor torque performance measures

Algorithm UKF AUKF CAUKF

time (sec) 2.87 2.96 3.10

Noise factor ç = 1 MSE ((4 ) 5.19×10-5 2.11×10-7 2.05×10-7

MSE ('%&$ ) 1.47×10-2 5.98×10-3 5.95×10-3

time (sec) 2.17 2.19 2.32

Noise factor ç = 10 MSE ((4 ) 2.16×10-4 2.42×10-7 2.18×10-7

MSE ('%&$ ) 2.65×10-1 8.81×10-3 6.17×10-3

Kt (Nm/A)
Figure 3.11 Case 3 ­ comparison of

estimates for intermittent fault with =10

69

Fault Detection

3.6 Results and Discussion

V bus (Volts)
Figure 3.12 Case 3 ­ comparison of

estimates for intermittent fault with =10

3.6.3.4

Case 4 ­ Incipient Fault

Incipient faults are fast decaying transients and very difficult to detect even for experts and may cause severe problems leading to faults and consequent outage. In this case an incipient fault in the bus voltage ('%&$ ) of the RW is considered (see Table 3.44). Time '%&$ (s) < 30 30  < 40  40
Table 3.44 Incipient Bus Voltage fault profile

'%&$ (V) 6 6+0.1(t-30) 8

Time (4 (s) < 30 30  < 40  40

(4 (Nm/A) 0.029 0.029 0.029

Table 3.45 Incipient Bus Voltage performance measures

Algorithm UKF AUKF CAUKF

time (sec) 2.39 2.62 3.12

Noise factor ç = 1 MSE ((4 ) 4.23×10-8 4.00×10-6 3.82×10-6

MSE ('%&$ ) 2.83×10-3 2.94×10-3 2.27×10-3

time (sec) 2.15 2.30 2.72

Noise factor ç = 10 MSE ((4 ) 4.11×10-8 3.53×10-6 4.10×10-6

MSE ('%&$ ) 2.32×10-2 3.82×10-3 2.24×10-3

Figure 3.13 and Figure 3.14 illustrate parameter estimations for the fault scenario in Table 3.44. Results in Table 3.44 show that CAUKF outperforms both UKF and AUKF in terms of decreasing MSE for both RW parameters by more than ten times; however, it takes nearly 14% more computational time. It can be concluded that the proposed CAUKF could successfully perform parameter estimation for the abrupt, transient, intermittent, and incipient faults in the presented scenarios. This is substantiated further through Monte Carlo simulations provided for various levels of loss of effectiveness and various levels of noise for the abrupt scenario. As discussed earlier, abrupt MC results can be extended to other cases of transient, intermittent and incipient. 70

Fault Detection
0.06 0.03 0.05

3.6 Results and Discussion

K t (Nm/A)

0.029 0.04 0.03 0.02 0.028 61 62 63 64 65

UKF AUKF CAUKF True

0

10

20

30

40

50

60

70

80

90

100

Time (sec)
Figure 3.13 Case 4 ­ comparison of estimates for incipient fault with =10

V bus (Volts)
Figure 3.14 Case 4 ­ comparison of

estimates for incipient fault with =10

3.6.4 Control Moment Gyros In order to examine the performance of the proposed scheme on another actuator (as an extension of the applicability verification), fault detection for a CMG assembly mounted onboard an in-orbit satellite is presented in this section. The choice for extending the work to CMG as another actuator was made based on the fact that CMGs have more degrees of freedom due to gimballing and can be a challenge in terms of dynamics simulations as well as effects on satellite attitude. For the CMGs, the input command is provided as the gimbal angle rates since flywheels on the CMG are of constant speed. The process model in Eq. (2.43) is provided as eqs. (2.12), (2.13) and the measurement model in Eq. (2.43) is provided as k( ; ) = ; + ? . Since there are no RWs in this setup, fault parameters are introduced in the mapping function of CMG (X2st ) in Eq. (2.40), which can be regarded as effectiveness parameters directly associated with LOE, as [14] where = (3.30)

71

Fault Detection  0  =  0  0 0 0 0 0 0 0 0 0   0   

3.6 Results and Discussion

(3.31)

where /0 is the fault parameter matrix, and +¼N corresponds to the efficiency of the Vth CMG and ranges from 0 to 1. Multiplicative faults are applied because they are more likely to resemble actual gimbal motor faults. The reason that additive faults would not be realistic for this case is that they would amount to gimbal rotor constantly rotating in which case no control cannot be achieved. Therefore, each fault parameter can determine how well each CMG is performing where + 0 = 1 means ideal performance and + 0 = 0 denotes failure of the CMG and therefore, no control torque from that CMG. Since there are no control schemes incorporated in this setup, gimbal angle rates are fed to CMGs as listed in Table 3.46. The reason for different profiles for each input lies in the fact that if CMGs cancel out each others' generated torque, accumulative torque applied on the spacecraft remains zero or unchanged. If outputs of the system are not sensitive to the inputs (e.g. control command does not result in control torque), parameter identification and state/parameter estimation deems impossible. Hence, the choice for gimbal angle rates. Other simulation parameters for this section are provided in Table 3.46. It should be noted that in this system, there are 11 states and 4 parameters estimated, which is more complex compared to the RW system with 2 states and 2 parameters. In addition, this simulation considers CMGs in an assembly onboard satellite and not individually in isolation. The reason that RW simulations were conducted in isolation and not onboard a satellite, was merely caused by the direction of the studies. In the studies provided in this thesis, modeling was started with RW in isolation with extensive analysis, simulation tests, and hardware tests and data acquisition. Next, RW was considered in a RWA and was further mounted on a satellite in orbit. Next CMG was considered as a second actuator system, namely CMG because CMG was more complex than RW due to its ability to also gimbal its mounted fly wheel. Finally, formation of multiple satellites was considered to extend applicability of the proposed schemes to a more complex configuration. Therefore, the direction of the study imposed some restrictions as how to present the work in the order provided in this thesis. The residual vector is defined as ê is the measured angular velocity vector of the satellite, î ë is the estimated angular where î ê is the measured quaternion vector of the satellite, and ï ë velocity vector of the satellite, ï is the estimated quaternion vector of the satellite. Furthermore, parameter residuals vector is defined as (3.32) = [  -  ,  - ]

72

Fault Detection = - 

3.6 Results and Discussion (3.33)

Ü0 is the where /0 is the defined value of fault parameter matrix diagonal elements and / estimated value for this matrix and its diagonal elements. It is important to note that the estimator only uses RM residuals and Rì values are only used for visualisation purposes. The fault profile for each fault parameter is listed in Table 3.47 and results are illustrated in Figure 3.15-Figure 3.16, it can be observed that UKF has inferior performance compared to AUKF and CAUKF. The inferior performance of the UKF compared to others is most visible in +¼- . During simulations, it was found that including the 4th gimbal angle rate (Zn- ) had a major influence on the results of the estimations. Including a 4th input feed for the gimbal angle rates caused estimation performance to degrade while not including it resulted in much more accurate estimates. It can be concluded that the 4th input can cause influence on the other CMGs torques, which can result in confusion for the estimation algorithm as discussed earlier. Results in Table 3.48 also confirm the superiority of the proposed detection algorithm compared to the other methods. In Table 3.48, MSE is provided for each fault parameter and the RMS of the MSEs is also provided to compare the overall performance of all parameters. Another important note is the time required to adapt to the new fault parameters, which as can be observed from Figure 3.16 is agile. For the noise factor in CMG case, only ç = 10 was considered for the presentation of the results; however, other noise factors (up to 30) were also considered and results were similar to the ones presented. Overall, results show the proposed CAUKF outperforms AUKF and UKF. The limitation of the proposed method is its requirement for nearly 10% more computational time on average; however, the overall MSE was decreased by up to 10 times. It can be concluded that tracking the non-measurable system parameters in case of sudden changes was performed better when CAUKF was used compared to UKF and AUKF. Moreover, AUKF requires a priori knowledge about system performance from beginning to the end of simulation to determine [T where unlike the proposed CAUKF. One of the main factors to consider in the simulations for the CMGs, is the availability of less dynamics information compared to the RW dynamics. Since in the RW simulations, full dynamics of the internal motors is considered, estimation of the parameters is done more precisely and accurately. However, in the CMG simulation, the motor dynamics is not considered and the total momentum of the wheel is considered for each CMG. Furthermore, gimbal angles dynamics are considered for the simulations and they are related to the satellite attitude through dynamics equations and mapping matrices. This difference in the availability of the detailed mathematical equations for the system can play a major role where other measures are not available for compensation for un-modelled components and uncertainties in the system.

73

Fault Detection

3.6 Results and Discussion
Table 3.46 Fault detection simulation parameters CMG

Filter Parameters ([", ¢, -m) Process Noise Standard Deviation (Õí ) Measurement Noise Standard Deviation (Õq ) Process Noise Covariance Matrix (@T ) Measurement Noise Covariance Matrices ( T ) Adaptive Fading Factor (¶ ) Adaptive Threshold Factor (DU ) Satellite Moment of Inertia (Y$ )
CMGs Moment of Inertia (Yh )

Initial Parameters (l+0 +0, +0 +0- m) T = hT~ = hTTM = hTs = hT>

lZ T Z, T Z T Z- T] l T ,T Tm le T e,S e S m

Parameter Input Zn Input Zn, Input Zn Input Zn-

Value 0.5 sin(0.8L) × Ç/180 rad/s -sin(0.8L) × Ç/180 rad/s -sin(0.8L) × Ç/180 rad/s 0.1sin(cos(0.8L)) × Ç/180 rad/s [0 0 0 0] deg [-0.6 0.4 -0.2] [0 0 0] rad/s [0.8 0.8 0.8 0.8] 0.3 lkg. m, /sm [1,2,2] 10 10, Õí <×< , Õq × 60000

0.015 ò 0 0

Step time (*$ )

6 0 0 0.017 0 ó[kg. m, m 0 0.020 1 0 0 0 0 1 0 0 õ[kg. m, m 1 × 10. ô 0 0 1 0 0 0 0 1 0.1 sec

(a)

(b)

(c)

(d)

Figure 3.15 Simulation results for CMG fault isolation out-of-phase abrupt CMG faults with =10 (a) Satellite attitude (b) Satellite angular velocities (c) Scaler  trend (d) CMGs gimbal angles

74

Fault Detection

3.6 Results and Discussion

(a)

(b)

(c)

(d)

Figure 3.16 Comparison of fault parameters estimates for out-of-phase abrupt fault with =10 (a) CMG1 (b) CMG2 (c) CMG3 (d) CMG4

75

Fault Detection

3.7 Conclusions

Table 3.47 CMG fault parameters out-of-phase abrupt fault profile

< 30 20  < 28 28  < 35 35  < 50 50  < 60 60  < 80 80  < 90  90 MSE (+0~ ) 2.98×10-3 1.64×10-3 1.62×10-3

Time (s)

1 0.5 1 1 1 1 1 1

+0~

1 1 1 0.1 1 1 1 1

+ 0TM

1 1 1 1 1 0.1 1 1

+ 0s

+0> 1 1 1 1 1 1 1

0.1

Table 3.48 CMG out-of-phase abrupt fault scenario performance measures

Algorithm UKF AUKF CAUKF

time (sec) 2.63 7.39 7.69

MSE (+0TM ) 4.77×10-3 2.56×10-3 2.58×10-3

Noise factor ç = 10

MSE (+0s ) 3.40e-03 2.29e-03 2.31e-03

MSE (+0> ) 1.37×10-2 4.58×10-3 4.44×10-3

RMS 7.58×10-3 2.98×10-3 2.93×10-3

3.7 Conclusions
In this chapter, a new 2-step adaptive scheme was proposed to adapt states/parameters covariance matrix of the UKF in the case of sudden changes in non-measurable system parameters. The adaptive scheme was developed based on innovation and residual sequences of system states. The proposed scheme was tested on an RW system in isolation, as well as on a 4SGCMG configuration onboard satellite, to evaluate its performance. For the RW, numerical simulations comprised four fault scenarios including abrupt, transient, intermittent, and incipient. For each fault scenario, two noise levels were considered for detailed comparison as well as extensive MC simulations under multiple LOE % and â. Results showed superior performance compared to the UKF and AUKF. Parameter tracking for non-measurable system parameters was enhanced by up to 10 times based on MSE measures at the cost of 10% more computational time. For the CMG, simulations comprised only out-of-phase abrupt faults in all four CMGs, the in-phase fault detection is also possible using the proposed scheme, however, that scenario will be discussed in the fault isolation section where it fits more appropriately. The proposed scheme can be implemented where a priori knowledge about system performance is not available and computational resources can allow for the additional calculation requirements. Therefore, small satellites with could be a reasonable target to implement such method.

76

Fault Isolation

4.1 Proposed Methodology

CHAPTER 4

Fault Isolation

T

he problem of promptly and accurately finding the root cause of a fault in a complex system has been the center of attention for engineers, dynamists, and control experts. When a fault is detected, it is important to find the source of error and consequently, take remedial actions before a complete failure results in mission abortion. This constitutes the second major module in the CBM/PHM framework as can be seen in Figure 4.1, where the gray boxes show fault isolation and identification modules. Due to highly non-linear nature of satellite dynamics in space and effect of actuator faults on its attitude, it is vital to employ approaches that provide reasonable solutions using limited resources.
Symptoms

Inputs

Diagnostics

Current Fault Condition Fault Isolation Outputs Fault Identification

Prognostics

Plant

Model Outputs

Residuals

Fault Detection

Fault Evolution Prediction

Figure 4.1 Placement of fault isolation module in a model-based CBM/PHM flow

RWs are prone to fault or failure mainly due to 1) Friction torque increase due to increase in bearing temperature or failure of lubrication system and 2) BEMF increase caused by a surge in the control circuit voltage [62]. An RW yields a highly non-linear dynamic system. The system becomes more complex when RWs are placed in an assembly (RWA), coupled with the dynamics and attitude of the satellite in orbit. If only limited measurements are available to the FDI scheme, it becomes a challenging task to detect faults and isolate their root cause. In this chapter, a new 2-step methodology for fault isolation of RWs (standard fourwheel/pyramid configuration) onboard satellite is proposed based on a reduced variation of a hierarchical multiple model approach in conjunction with Bayes' probability distribution and adaptive windowing. Multiple models are considered for faulty variations of the nominal system using unscented Kalman filters for fault isolation. Results show over 99% successful isolation for various fault scenarios including single fault, multiple in-phase faults, and multiple faults in sequence.

4.1 Proposed Methodology
The proposed fault isolation methodology in this study uses hierarchical approach

77

Fault Isolation

4.1 Proposed Methodology

towards fault isolation. The hierarchical approach ensures resources are allocated for computation only when required. The proposed scheme is shown in Figure 4.2 where at each level, only certain information is passed to the subsequent level to isolate the location of a fault. At the highest level of this hierarchy, there is a centralized FDI unit supervising a set of 4 spacecraft. It is important to note that the number of satellites can be expanded without the loss of generality. However, in this study 4 satellites were considered to be consistent and use the same terminologies as the 4 actuators discussed at system level. At this level, all spacecraft send their attitude information to the FDI unit including their quaternions and angular velocities. Using the nominal model and parallel UKFs running to generate residuals, when a fault is annunciated, a window of residuals is created to isolate the faulty spacecraft. After faulty spacecraft are identified, respective satellite attitude information is passed to the fault isolation scheme. It is worthy to mention that limited measurements are available to the isolation scheme including only satellite quaternions and angular velocities. There is no access to RW output measurements at the isolation level. Next, based on the RW assembly configuration and likelihood of each model to the current state of the system, the faulty RW unit is determined ( AN , V = 1,2,3,4). Finally, to further locate source of the fault in the actuator, parameter estimation is employed to determine the faulty parameter ( 4 or '%&$ ) for RW and fault parameter for CMG.
Centralized FDI unit Formation Level

Satellite 1

Satellite 2

Satellite 3

Satellite 4

System Level

Payload

ACS
Attit ude C ontrol

EPS
Electrical Power

TCS
Thermal Cont rol

DHS
Dat a Handling

Structure

Sub-system Level

Reaction Wheel Assembly

RW 1

RW 2

RW 3

RW 4

Sub-system Component level

Kt

Vbus

Kt

Vbus

Kt

Vbus

Kt

Vbus

Sub-system Sub-component level

Figure 4.2 Proposed hierarchical approach towards fault isolation

78

Fault Isolation

4.1 Proposed Methodology

where R; is the residual at time step . At the formation level, the residual vector is defined as (4.1) =[  - , - ] (4.2)

4.1.1 Fault Detection The first step of the isolation is to detect an anomaly in the system's behavior. In order to detect anomalies in the system behavior, scalar [ is defined as [169] =

ê ö is the measured angular velocity vector of the Vth satellite in the formation, î ë ö is where î êö is the measured the estimated angular velocity vector of the Vth satellite in the formation, ï ëö is the estimated quaternion quaternion vector of the Vth satellite in the formation, and ï vector of the Vth satellite in the formation. It was also observed that using only one set of ë ö or ï êö - ï ëö ) can also suffice for the purpose of êö - î the residual vector elements (i.e. î formation level isolation. At the system level, the residual vector is defined as ê is the measured angular velocity vector of the satellite, î ë is the estimated angular where î ê is the measured quaternion vector of the satellite, and ï ë velocity vector of the satellite, ï is the estimated quaternion vector of the satellite. And finally at the sub-system level (i.e. RW), the residual vector is defined as (4.3) where è is the measured current from the RW, é is the estimated current for the RW, e ê is the measured angular velocity of the RW, and e ë is the estimated angular velocity for the RW. Furthermore, parameter residuals vector is defined as (4.4) Ü%&$ are estimated where 4 and '%&$ are the values defined in the fault scenario and Ü 4 and ' values for these parameters. It is important to note that the estimator only uses RM residuals for calculating estimates, while Rì values are only used for visualisation of the results. A constant threshold for anomaly detection ([T ) is used based on the available data and, a fault is annunciated when [ > [T . This choice was made since the focus of this chapter was on isolation rather that detection. At the formation level, a UKF runs in parallel to each spacecraft to generate residuals and detect faults. When fault is detected, a window of cumulative residual is created to isolate faulty spacecraft, residuals are calculated until a certain threshold is reached and faulty spacecraft are identified based on the description in Table 4.1. Next, in the system level, referring to Figure 4.3, a UKF runs in parallel to the hardware model of the spacecraft at all times to generate residuals. Scalar [ (4.5) 79 = -  , -  =[  -  ,  -  ] = [  -  ,  - ]

Fault Isolation

4.1 Proposed Methodology

is calculated at each time step and fault isolation module is activated once [ passes its threshold [T . 4.1.2 Likelihood-based Isolation The main advantage of the proposed approach is its ability to generate a likelihood distribution of all possible scenarios for the faulty system and use it to generate posterior probability distribution of each case scenario. The term all possible scenarios means the number of possible cases to choose 1,2,3 or 4 actuators out of 4 actuators. This can be calculated for any number of satellite using the -combination rule or the binomial coefficient as = ! ( - 1) ... ( - + 1) = ! ( - )! ( - 1) ... 1 (4.6)

Using this for any arbitrary number of satellites summation of all possible combination is the maximum number of cases to be considered. For 4 options (e.g. satellites or actuators) this can be calculated as 4 4 4 4 + + + = 4 + 6 + 4 + 1 = 15 1 2 3 4 (4.7)

where if adding the case of no faulty unit comes to 16 possible cases. Posterior probability is the probability of the parameter d given the evidence : ¼(d| ), In contrary to likelihood function, which is the probability of the evidence given the parameters ¼( |d). If we have a prior belief that the probability distribution function is ¼(d) and we obtain observations G with the likelihood ¼(G|d), the posterior probability function then becomes [170, pp. 21­24] ( | )=  ( | ) ( ) ( ) × 

(4.8)

which can be rephrased in a simpler language as

(4.9)

Using this concept, we assume there is an initial probability distribution for all possible cases of fault in the system (see Table 4.1). The initial probability distribution can be of any form, however, in this study, we have only examined uniform and normal distributions. Further discussions for the effect of initial distribution on the performance of the algorithm are provided in the results and discussion section. To be able to refer to each fault case more conveniently, all possible cases are assigned with a number in Table 4.1 where the faulty wheel number is defined in Figure 2.8 for each RW assembly configuration.

80

Fault Isolation

4.1 Proposed Methodology

Table 4.1 Fault scenarios for RW/CMG assemblies and satellite formation

Scenario No. 0 1 2 3 4 5 6 7

Faulty Units None 1 2 3 4 1,2 1,3 1,4

Scenario No. 8 9 10 11 12 13 14 15

Faulty Units 2,3 2,4 3,4 1,2,3 1,2,4 1,3,4 2,3,4 1,2,3,4

The overall scheme for fault isolation is shown in Figure 4.3. At each time step, the control input is fed into two models. One is the satellite attitude hardware model, and the other one is the mathematical model running in parallel to detect faults in the system and subsequently conduct isolation. Since there was no access to the hardware in this study, we assume outputs of the hardware model are measurements from the hardware. State estimates are obtained using UKF from the mathematical model before generating residuals to ensure robustness of the algorithm to uncertainties and disturbances. Comparison is made between outputs of mathematical model and hardware model to generate residuals as follows where G is the state vector from the satellite models. This state vector includes Gn = l n (en )mi where is the quaternion for the satellite attitude and e is the satellite angular velocity described in Eq. (2.15). G refers to hardware model states and G ² refers to mathematical model states, which runs in parallel to the actual model. It is important to note that G is a vector with 7 states in it. Therefore, a summation of all differences is generated for R; . At each time step Using Eq. (4.1) scalar [ is calculated and when it is greater than a threshold [T , fault isolation scheme considers the state of the system as faulty and activates the isolation module. This measurement/state set is used for both formation level and system level, however, it should be noted that at formation level due to direct availability of system measurements, it is possible to use only satellite angular velocity instead of full quaternion plus angular velocity set as discussed in [82]. This is important to note that one of the major differences between the proposed approach in this thesis and other MM based approaches (e.g. Nareri's [171] proposed MM UKF-based approach in his PhD dissertation under Chapter 3), is that the proposed approach in this thesis only runs parallel models when fault is annunciated while others run multiple models at all time. The limitation, however, is that while isolating the fault, this algorithm cannot isolate another fault. =
=

- 

(4.10)

81

Fault Isolation

4.1 Proposed Methodology

Input V

Satellite Attitude Mathematical Model Satellite Attitude Hardware Model

Fault Detection and Isolation  ,q
+/-

Fault Detection No r  Calculation  >0 Yes Multiple Model Isolation Module

Mp

, q Multiple Model Isolation Module

Model 1 (M1) Model 2 (M2) Input V Model 3 (M3) . . . Model n-1 (Mn-1) Model n (Mn)

 1  1, q  2  2, q
Likelihood Posterior
+/-

Li

pi

ri

MAX

Mp

, q  n  n, q

In this study [T = 0.06 was chosen based on extensive simulations and can vary for different applications. It should also be noted that adaptive threshold can also be implemented from definitions in the previous chapter, however, in this chapter since the focus is on fault isolation, adaptive threshold was not considered. It is important to note that in this approach only one UKF is running before a fault is annunciated unlike MM methods where multiple models run at all times. When the threshold is passed, multiple UKFs based on faulty models of the system where each model corresponds to a particular fault scenario (see Table 4.1) are activated and system input is fed into all UKFs in parallel. The latest nominal states before fault annunciation are used as initial states for multiple UKFs to generate new states. This means if fault is detected at time step and the states of the system are G; at this time step, multiple models use G; for their initial states. The estimates of each UKF corresponding to a particular faulty model is then compared with the "actual model" outputs and mean square error (MSE) is calculated for each residual as follows where V corresponds to each faulty case scenario listed in Table 4.1. The farther we get from the inception of the fault, for models that do not describe the current state of the system, 82 =
=

Figure 4.3 Proposed fault isolation scheme based on likelihood and probability distribution

- 

(4.11)

Fault Isolation

4.1 Proposed Methodology

the residual becomes larger. In order to accommodate this accumulation of error in residuals, a window is defined for each model to store specific number of residuals over a period of time as follows where W is the index in the residual window and RN,T , which is the initial value for the residual, is equal to 0. Based on this MSE, a likelihood function is generated for the probability of each case being the current state of the system. Presumably, the smaller the MSE the closer the current state of the system to the corresponding model. In order to generate the likelihood and consequently the posterior probability function, the following steps are taken 1) Find maximum MSE among cases = ( ) (4.13) =
-

+

=

- 

(4.12)

2) Recompute MSE compared to maximum = - (4.14)

3) Compute summation of the residuals = (4.15) = =
-

4) Compute likelihood

(4.16) ×

5) Compute posterior probability

(4.17)

These steps provide a likelihood and posterior distribution at each step. As mentioned, initial distribution can be of any form; however, in this study, we only show results for uniform and normal initial distributions. 4.1.3 Adaptive Windowing Since it is computationally heavy to store a large window of residuals for all cases and not efficient to run parallel models of the system for a long period of time, adaptive windowing is employed to finalize the isolation procedure. There is maximum window size is considered Ph SM to avoid overflow of memory. At each iteration in the isolation scheme, the Vth case corresponding to the maximum ¼N is the case closest to the current state of the system. However, we need a confidence level to make sure the case with maximum ¼N is actually the current state of the system. When calculating ¼N at each step, the following logic is used to determine the result of isolation

83

Fault Isolation V3&4 = VD\ G ÷+ (øjG(¼N )) if j > Nû SM then else
3: 4: 5: output V3&4 if øjG(¼N ) > end end

4.2 Results and Discussion

Table 4.2 Logic for determining output of the isolation scheme

1: 2:

output V3&4

3&4

then

where V3&4 is the index of the case with maximum probability of being the current state of the system and 3&4 is a threshold for confidence in the output of the logic. In this study 3&4 = 90% and Ph SM = 60. The 60 for window was chosen based on the worst case sce-

nario results and a safety factor. For the worst case scenario, it took the algorithm 42 iterations to isolate the case properly, adding 12 more iterations as a safety net resulted in 60 iterations as the maximum threshold for number of iterations in the isolation process. Employing this logic in the adaptation of the isolation scheme, ensures that computation of the likelihood and posterior probability is conducted until satisfactory confidence in probability distributing is obtained or maximum number of attempts has reached. The latter is particularly useful when symmetry in the system may causes probability distribution to lean towards two or more cases at the same time.

4.2 Results and Discussion
Numerical simulations were conducted to evaluate the performance of the proposed isolation scheme on a RWA and a CMG assembly. Simulations were performed on an Intel® CoreTM i7-4790 CPU with 3.60 GHz power PC and 16.00 GB RAM. 4.2.1 Formation Level At formation level, control input to all satellites are the same as and each individual satellite is setup the same way as discussed in Section 0. The only difference is that at this level, instead of a single satellite, there is an array of four satellites operating in parallel. An actual model and an analytical model is considered for each satellite and residuals are generated as the difference between the outputs of the two. For each satellite, a UKF runs in parallel to estimate the states of the system and feed them to the residual generation. When a threshold is passed, a window of residuals is collected until a threshold is passed or window is out of memory based on the logic described in Table 4.2. The overall simulation setup can be considered as shown in Figure 4.4 where all satellites send their info to the central FDI unit and once a fault is annunciated, the isolation scheme identifies the faulty. All satellites are setup with Table 4.5 84

Fault Isolation

4.2 Results and Discussion
Fault Detection No
+/-

Input V

Satellite 1 Mathematical Model Satellite 1 Hardware Model Satellite 2 Mathematical Model Satellite 2 Hardware Model Satellite 3 Mathematical Model Satellite 3 Hardware Model

 ,q r

 Calculation  Fault Isolation

>0 Yes

, q  ,q
+/-

Input V

r

Residual Window

, q  ,q
+/-

MAX r
Mp

Input V

, q  ,q
+/-

Input V

Satellite 4 Mathematical Model Satellite 4 Hardware Model

r

, q

Figure 4.4 Proposed fault isolation scheme for formation level

The fault introduced in this scenario is described in Table 4.3 where a transient change in the satellite RW's bus voltage is considered. Faulty RW(s) and satellite(s) are defined in different scenarios as described in Table 4.1.
Table 4.3 Single BEMF constant and Bus Voltage fault

Time Vbus (s) t<50 50t<60 t60

Vbus (V) 8 3 8

Time kt (s) t<50 50t<60 t60

kt (Nm/A) 0.029 0.02 0.029

Results for fault isolation at formation level with a centralized FDI architecture are presented in Figure 4.5, Figure 4.6, and Figure 4.7 for fault case 15 with all satellites faulty and all RWs fault. Performance of isolation scheme for other scenarios is presented in Table 4.4. Figure 4.5 illustrates attitude response of all satellites where thin lines represent nominal behaviour and bold lines represent faulty behaviour. It can be observed that at the incept of fault, faulty attitude deviates from the nominal states and fault detection scheme annunciates the fault and starts the isolation process. It should be noted that the deviation of the fault is not observable with naked eyes. That is why human cannot as quickly detect and isolate source of the fault when such changes in non-measurable system parameters occur. Figure 4.6 illustrates angular velocity of each satellite for nominal and faulty estimates and it is clear that faulty estimates deviate at fault inception.

85

Fault Isolation

4.2 Results and Discussion

(a)

(b)

(c)

(d)

Figure 4.5 Attitude response of the system under fault scenario 15 with pyramid RW assembly: (a) satellite #1 quaternions (b) satellite #2 quaternions (c) satellite #3 quaternions (d) satellite #4 quaternions

(a)

(b)

(c)

(d)

Figure 4.6 Angular velocity of the system under fault scenario 15 with pyramid RW assembly: (a) satellite #1 angular velocities (b) satellite #2 angular velocities (c) satellite #3 angular velocities (d) satellite #4 angular velocities

Furthermore, many other approaches have investigated the feasibility of the MM models techniques to explore applicability of such methods in different systems under different operating conditions. However, in space, physical access to the system (e.g. satellite) is very limited or not at all possible. Therefore, employing analytical techniques to analyze the data from satellite sensors is of paramount importance to be further explored. Although human operators in the ground station constantly monitor the incoming data and performance of the critical system components, there is only so much human beings are capable of in terms of sensory and physical/analytical capabilities. Therefore, the argument can be made that employing analytical techniques is an inevitable reality.

86

Fault Isolation
40 20 0 -20 0 100 200

4.2 Results and Discussion
40 20 0 -20 0 100 200

Satellite #1

Satellite #1

40 20 0 -20 0

Satellite #1

40 20 0

Satellite #1

100

200

-20

0

100

200

40 20 0 -20 0

Time (s) Satellite #2

40 20 0

Time (s) Satellite #2

40 20 0

Time (s) Satellite #2

40 20 0

Time (s) Satellite #2

100

200

-20

0

100

200

-20

0

100

200

-20

0

100

200

40 20 0 -20 0

Time (s) Satellite #3

40 20 0

Time (s) Satellite #3

40 20 0

Time (s) Satellite #3

40 20 0

Time (s) Satellite #3

100

200

-20

0

100

200

-20

0

100

200

-20

0

100

200

40 20 0 -20 0

Time (s) Satellite #4

40 20 0

Time (s) Satellite #4

40 20 0

Time (s) Satellite #4

40 20 0

Time (s) Satellite #4

100

200

-20

0

100

200

-20

0

100

200

-20

0

100

200

Time (s)

Time (s)

Time (s)

Time (s)

Figure 4.7 Angular velocity of the RWs for all satellites under fault scenario 15 Table 4.4 Confusion matrix for 4 satellites in formation

Identified  Actual  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15

1 99 0 0 0 0 0 0 0 0 0 0 0 0 0 0

2 0 99 0 0 0 0 0 0 0 0 0 0 0 0 0

3 1 0 99 0 0 0 0 0 0 0 0 0 0 0 0

4 0 0 0 99 0 0 0 0 0 0 0 0 0 0 0

5 0 0 0 0 99 0 0 0 0 0 0 0 0 0 0

6 0 0 0 0 0 100 0 0 0 0 0 0 0 0 0

7 0 0 0 0 0 0 99 0 0 0 0 0 0 0 0

8 0 1 0 0 0 0 0 100 0 0 0 0 0 0 0

9 0 0 0 1 0 0 0 0 99 0 0 0 0 1 0

10 0 0 0 0 0 0 0 0 0 100 0 1 0 0 0

11 0 0 0 0 1 0 0 0 0 0 100 0 0 0 0

12 0 0 0 0 0 0 0 0 1 0 0 99 0 0 0

13 0 0 0 0 0 0 0 0 0 0 0 0 100 0 0

14 0 0 0 0 0 0 1 0 0 0 0 0 0 99 0

15 0 0 1 0 0 0 0 0 0 0 0 0 0 0 100

87

Fault Isolation

4.2 Results and Discussion

Figure 4.7 shows nominal and faulty angular wheel speed for each RW on each satellite. It can be observed from this figure as well as the attitude response and angular velocity figures that faulty estimates deviate from the nominal at the inception of fault and continue to deviate further after fault is resolved in the RW. In the RW responses it can be seen that faulty estimates return back to nominal after fault is resolved, however, their effect on satellite attitude remains even after their nominal performance is recovered, due to the irreversible effects they leave on the satellite motion in the absence of a controller. Results in Table 4.4 are presented in a form of a confusion matrix. Table 4.4 shows that the isolation scheme is capable of accurately identifying faulty satellites in all possible scenarios with more than 99% success rate. This is important as this is the first level of isolation and any false alarm or misidentification can lead to further wrong decision along the hierarchy. With this success rate, it can be concluded that the proposed scheme for fault isolation at the formation level is capable of handling identification of the faulty satellites with attitude measurements directly provided to it from each satellite in a centralized FDI architecture. In the following sections, the next level of isolation at subsystem level is examined. Fault isolation for both RW and CMG units are investigated for different configurations of the actuators onboard satellite.

4.2.2 RW Assembly A control voltage of a sine form with an amplitude of 5V and a frequency of 0.2 Hz is applied to the RW assembly, which applies the same voltage to all RWs (Figure 4.8) enclosed within it. This voltage is fed into all RWs onboard satellite throughout the simulation. Hence, the system is open loop controlled. The output of the RW assembly is the torque generated by each wheel individually; these torques are then mapped to satellite principal axes using mapping matrix based on the RW assembly configuration specified in Eq. (2.34). Satellite dynamics in Eq. (2.10) and satellite kinematics in Eq. (2.13) are used to output angular velocities and quaternions for the process model in Eq. (2.43). The measurement model in Eq. (2.43) is provided as k( ; ) = ; + ?; , which in practice is provided by the onboard sensors. Numerical integration of the states are done in MATLAB using classical Runge-Kutta method (RK4) [172] with a sampling period of *$ = 0.01 ·. Whitenoise is added to the integration outputs of the satellite dynamics model, including RWs, as measurement noise with 0 mean and standard deviation (Õ) of 1 × 10. . The total simulation time = 250 s. The overall simulation setup is illustrated in Figure 4.8 where control switching scheme block and attitude control block are not considered in this study. Further simulation parameters are listed in Table 4.5.

88

Fault Isolation

4.2 Results and Discussion
Table 4.5 Simulation Parameters [5], [7]

Parameter Input Voltage (' ) !3 Initial Input Voltage (' ) !3 S UKF Filters Parameters ([", ¢, -m) Process Noise Standard Deviation (Õí ) Measurement Noise Standard Deviation (Õq ) Process Noise Covariance Matrix (@T ) Measurement Noise Covariance Matrices ( T ) Additive States Õ< Window Size (P) Step time (*$ ) Satellite Moment of Inertia (Y$ ) RWs Moment of Inertia (Yh )

As discussed, the potential sources of failure for RWs are: (1) faults in the bus voltage and ('%&$ ) (2) faults in the motor torque BEMF constant ( 4 ). Hence, transient faults are introduced in RWs regarding these parameters. The objective is to identify where a fault has occurred at subsystem level having access only to the system level measurements. The faults injected into the system are BEMF constant and bus voltage faults occurring in phase (Table 4.6). The values for fault parameters used in isolation module are l 4 '%&$ m=[0.029 Nm/A 5 V]. This is to ensure the values of the faulty parameters do not affect the performance of the isolation module and only direction of change is of significance. However, if the values in isolation module are far from the values in the actual system, the isolation module performance can degrade and result in false isolation. For different fault case scenarios, it is assumed that the fault injection scenario and values are the same for all cases (i.e. time of fault and value of parameter changes in the wheel), and the only difference is where the fault is injected in the assembly pertaining to which wheels are malfunctioning. Figure 4.9 illustrates the response of the system under nominal and faulty conditions for a fault case where wheel 1 is defective in the pyramid configuration. In this figure, thin line corresponds to the nominal response and bold line corresponds to the faulty response. Figure 4.9 (a) and Figure 4.9 (b) show when wheel 1 becomes faulty, satellite angular velocities deviate from the nominals. This phenomenon is more visible in Figure 4.9 (c)

Satellite Initial Quaternions [ , m Satellite Initial Angular Velocities [e e, e ]

60 0.01 sec 0.015 0 0 ò 0 0.017 0 ó[kg. m, m 0 0 0.020 1 0 0 0 0 1 0 0 õ[kg. m, m 1 × 10. ô 0 0 1 0 0 0 0 1 [-0.6 0.4 -0.2] [0 0 0] rad/s

Value 5sin(0.2t) V 0.1 V [1,2,2] 10, 10. , Õí <×< , Õq × . 10

89

Fault Isolation

4.2 Results and Discussion

where wheel 1 torque deviates from its nominal response after wheel goes faulty. At the fault isolation module, we do not have access to wheel outputs including torque generated by each wheel and need to isolate the fault using only measurements from satellite attitude and angular velocity. Figure 4.9 (d) and Figure 4.9 (e) illustrate trends of satellite angular velocities and quaternions in 3D, respectively.
Fault Management Block

Reference Attitude (r,qr) +-

Torque Command Attitude Voltage

External Torques Reaction Wheel Assembly Sensor Dynamics
Reaction Torque + Control Torque

Attitude (,q)

Control Switching Scheme

Fault Isolation Scheme

Fault Detection Scheme

Control Law

Attitude Dynamics

+

White Noise

Figure 4.8 Proposed fault isolation simulation setup Table 4.6 Single BEMF constant and Bus Voltage fault

Time Vbus (s) t<15 15 t<77 t 77

Vbus (V) 8 3 8

Time kt (s) t<15 15 t<77 t 77

kt (Nm/A) 0.029 0.02 0.029

Figure 4.11 shows the performance of the fault isolation module. Figure 4.11 (a)-(c) illustrate prior distribution, likelihood, and posterior distribution of fault cases at the first iteration of isolation. Figure 4.11 (d)-(f) illustrate prior distribution, likelihood, and posterior distribution of fault cases at the final iteration of isolation. As can be seen in Figure 4.11 (a), at the beginning of isolation we assume a uniform distribution for all fault cases. It means that all cases have the same probability of being the current state of the system; however, as we proceed through iterations of isolation, likelihood function multiplied by prior distribution provides posterior distribution. In Figure 4.11 (f), case 1 has the highest probability of being the current state of the system among others. As mentioned earlier, the threshold is set in the probability to be more than 90% in the final posterior probability distribution. Hence, for different cases and under different conditions, final iteration differs. Figure 4.12 illustrates isolation performance for the same scenario (wheel 1 is faulty in the pyramid configuration) with normal initial distribution. Referring to Figure 4.12 (a) the initial distribution is normal. However, Figure 4.12 (f) shows that after isolation scheme reaches a decision, case 1 is the most probable case.

90

Fault Isolation

4.2 Results and Discussion

Another difference that the initial distribution can make is the number of iterations required for the isolation scheme to reach the decision. This can be explained based on the distribution itself. Referring to Figure 4.11 and Figure 4.12, it can be seen that at the beginning case 1 has a higher probability in Figure 4.11 than it has in Figure 4.12. Therefore, if the same likelihood distribution is generated in both cases, it takes more iterations for case 1 under normal initial distribution to pass the threshold compared to case 1 under uniform initial distribution. The fault scenario under which wheel 1 is faulty on a standard fourwheel configuration is illustrated in Figure 4.10. As can be observed, due to change in the configuration of the wheels on the assembly, system response and consequently attitude deviation after fault inception is changed. However, isolation is accomplished promptly for both cases regardless of the assembly configuration. Referring to Figure 4.13, case 1 is the predominant case in the final iteration of isolation and therefore is chosen by the isolation module as the current faulty state of the system (satellite).
1 0.5 0 -0.5 -1
q1 q2 q3

0

50

100

150

200

250

Time (s)

(a)

3

(d)

(b)

q3

(e) (c)

Figure 4.9 Attitude response of the system under fault scenario 1 with pyramid RW assembly: (a) satellite quaternions (b) satellite angular velocities (c) reaction wheels torques (d) satellite angular velocities in 3D axes (e) satellite quaternions in 3D axes

91

Fault Isolation

4.2 Results and Discussion

A confusion matrix is provided for each RW assembly under different fault cases with uniform initial distribution to investigate the performance of the proposed methodology. The tables are filled with the data of 100 simulations for each fault case under the same initial conditions and fault start and end times. The only variation in these simulations is the external white noise added to the system and measurement units. Table 4.7 shows the confusion matrix for the orthogonal configuration. As can be observed from this table, the majority of the cases are identified as the actual case except for some cases where the noise has caused likelihood to shift from actual probabilities and result in wrong isolation. However, isolation results are accurate in more than 99% of the cases. Table 4.8 shows the confusion matrix for the pyramid configuration. In this table, it is noticeable that case 6 and 9 are isolated interchangeably. Looking at the configuration of the assembly, it is evident that case 6 corresponds to fault in wheel 1 and wheel 3 while case 9 corresponds to fault in wheel 2 and wheel 4. Due to symmetry in this configuration, it is expected that fault in any of the combinations for case 6 or 9 could have similar effects on satellite attitude response. Figure 4.14 shows final iteration of isolation for case 6 and 9 in the pyramid configuration. Referring to Figure 4.14 (c) and Figure 4.14 (f) both cases have a final probability of less than 90%; however, according to Table 4.2, another termination logic with a maximum number of 60 iterations was defined, which is imposed in this case. A new scenario was considered where wheels go faulty in sequence to examine the performance of the proposed methodology for multiple faults. Multiple faulty wheels are covered under the scenarios discussed in Table 4.1. However, a more probable case is when wheels go faulty in sequence, one wheel at a time or in-phase with another. For this scenario, we have two possibilities: (1) the first wheel is recovered before the second wheel goes faulty; (2) the first wheel is still faulty while the second wheel goes faulty. Scenario (1) is setup as listed in Table 4.9 and scenario (2) is setup as listed in Table 4.10. Corresponding system responses are shown in Figure 4.15 and Figure 4.16 for scenario 1 and 2, respectively. Referring to Figure 4.3, when a fault is isolated, the current state of the system is updated to the faulty state determined by the isolation module. Hence, isolating a new fault is achieved based on residuals being generated based on the updated system model. When faults occur in sequence, it is important that faults cannot be isolated simultaneously if the previous fault is not isolated. This means, for the sequence of faults to be isolated properly, it is required that fault isolation of the previous fault be completed and system model is updated with the current state of the system.

92

Fault Isolation

4.2 Results and Discussion

A change in system response compared to single fault case studies is expected as in these cases two wheels become faulty and consequently satellite motion is altered in two stages. It can be observed from Figure 4.15 (d)-(e) and Figure 4.16 (d)-(e) that satellite motion under these fault scenarios is more chaotic compared to single fault scenarios. Figure 4.15 (c) and Figure 4.16 (c) show wheel 1 and wheel 2 outputs degrading from nominal values. In Figure 4.16 (c) due to concurrent faulty conditions in wheel 1 and 2, degradation is more visible compared to Figure 4.15 (c). Figure 4.16 (b) shows coupled effect of a concurrent fault in wheels 1 and 2 compared to Figure 4.15 (b). The performance of the isolation algorithm is depicted in Figure 4.17 (a)-(c) for scenario 1 and Figure 4.17 (d)-(f) for scenario 2 at their final iteration of isolation. The main observation from these figures is the lower confidence in fault case for scenario 2 in Figure 4.17 (f) compared to that of Figure 4.17 (c) for scenario 1. It should be noted that for scenario 1 it took isolation algorithm 18 and 24 iterations for wheel 1 and wheel 2, respectively to reach confidence level greater than 90% for the isolated case. However, for scenario 2 it took isolation algorithm 17 and 30 iterations for wheel 1 and wheel 2, respectively to reach confidence level greater than 90% for the isolated case. This is important since 60 is the maximum number of iterations defined by the isolation algorithm. This means the termination logic for isolation was a maximum number of faults rather than required confidence level in the isolated case of scenario 2. This can be explained by the behavior of the system under concurrent faults from both wheels. Since each wheel affects the response of the system, the isolation algorithm cannot differentiate fully between effects of each wheel on the overall response of the system. Hence, lower confidence in the final decision is acquired. Similar results were obtained for same multiple fault scenarios under standard four-wheel RW assembly configuration. For scenarios where more than 2 wheels are faulty, the same procedure can be implemented to isolate faults in sequence. Various simulations were conducted to examine the stability of the proposed method under different influencing parameters. These simulations were mainly concerned with: (1) starting time of the fault (2) initial conditions for the satellite attitude (3) change in parameters of the wheels and their values. Regarding starting time of the fault, it was observed that the earlier a fault occurs in the system, the more accurate the isolation scheme can provide proper results. This can be explained by the fact that at the beginning of the simulation, due to motor dynamics in the RWs, there is more sensitivity to input and hence, larger amplitudes of outputs. As the motor passes its transient period, amplitudes of change

93

Fault Isolation

4.2 Results and Discussion

become stable and smaller in size, which leaves MSE generation to work with smaller values and less sensitivity. Regarding initial conditions for the satellite, it was observed that increasing satellite's initial values for angular velocities causes more chaotic satellite motions but does not affect the performance of the isolation module. Finally, the change of values in RW parameters influences the isolation results. The change in values cannot be smaller than 10% of noted that changes in these parameters are in reality larger than 10% because if the '%&$ is their nominal values; otherwise, isolation module may provide wrong results. It should be surged or
4

is changed due to change in temperature, the changes are only visible at the

system level when there is substantial change of momentum and consequently a major change in satellite attitude.

(a)

3

(d)

(b)

q3

(e) (c)

Figure 4.10 Attitude response of the system under fault scenario 1 with standard four-wheel RW assembly: (a) satellite quaternions (b) satellite angular velocities (c) reaction wheels torques (d) satellite angular velocities in 3D axes (e) satellite quaternions in 3D axes

94

Fault Isolation

4.2 Results and Discussion

(a)

(d)

(b)

(e)

(c)

(f)

Figure 4.11 Fault isolation performance, scenario 1, pyramid assembly, uniform initial distribution: first iteration (a) prior probability (b) likelihood (c) posterior probability; final iteration (d) prior probability (e) likelihood (f) posterior probability

(a)

(d)

(b)

(e)

(c)

(f)

Figure 4.12 Fault isolation performance, scenario 1, pyramid assembly, normal initial distribution: first iteration (a) prior probability (b) likelihood (c) posterior probability; final iteration (d) prior probability (e) likelihood (f) posterior probability

95

Fault Isolation

4.2 Results and Discussion

(a)

(d)

(b)

(e)

(c)

(f)

Figure 4.13 Fault isolation performance, scenario 1, standard four-wheel assembly: first iteration (a) prior probability (b) likelihood (c) posterior probability; final iteration (d) prior probability (e) likelihood (f) posterior probability

(a)

(d)

(b)

(e)

(c)

(f)

Figure 4.14 Fault isolation performance, scenario 6 and 9, pyramid assembly: final iteration for scenario 6(a) prior probability (b) likelihood (c) posterior probability; final iteration for scenario 9 (d) prior probability (e) likelihood (f) posterior probability

96

Fault Isolation

4.2 Results and Discussion
Table 4.7 Confusion matrix for three orthogonal assembly

Identified  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Actual  1 99 0 0 0 0 1 0 0 0 0 0 0 0 0 0 2 0 99 0 0 0 0 0 1 0 0 0 0 0 0 0 3 0 0 99 0 0 0 0 0 0 0 0 0 0 0 1 4 0 0 0 99 0 0 0 0 0 1 0 0 0 0 0 5 0 0 0 0 99 0 0 0 0 0 1 0 0 0 0 6 0 0 0 0 0 100 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 99 0 0 0 0 0 1 0 0 8 0 0 0 0 0 0 0 100 0 0 0 0 0 0 0 9 0 0 0 99 0 0 0 0 1 0 0 0 0 0 0 10 0 0 0 0 0 0 0 0 0 100 0 0 0 0 0 11 0 0 0 0 0 0 0 0 0 0 100 0 0 0 0 12 0 0 0 0 0 2 98 0 0 0 0 0 0 0 0 13 0 0 0 0 0 0 0 0 0 0 0 0 100 0 0 14 0 0 0 0 0 0 0 0 1 1 0 0 0 98 0 15 0 0 0 0 0 0 0 0 0 0 0 0 0 0 100
Table 4.8 Confusion matrix for pyramid assembly

Identified  Actual  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15

1 99 0 0 0 0 0 0 0 0 0 0 0 0 0 0

2

3

4

5

6

7

8

9

10

11 0 0 0 0 3 0 0 0 0 0 99 0 0 0 1

12 0 0 0 0 2 0 0 0 0 0 0 99 0 0 0

13 0 0 0 0 0 0 1 0 0 0 0 0 97 0 0

14

15

0 0 0 0 0 1 0 0 0 98 0 0 1 0 0 1 0 0 0 98 0 0 0 0 0 0 2 0 0 96 0 0 2 0 0 2 0 0 0 95 0 0 0 0 0 0 0 0 0 55 0 0 45 0 0 0 0 0 0 99 0 0 0 0 0 0 0 0 0 99 0 0 0 0 0 0 53 0 0 47 0 0 0 0 0 0 0 0 0 99 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0 1 0 1 0 3 100 0 0 99

97

Fault Isolation

4.2 Results and Discussion

(a)

3

(d)

(b)

q3

(e) (c)

Figure 4.15 Attitude response of the system to multiple faults scenario 1 with pyramid RW assembly: (a) satellite quaternions (b) satellite angular velocities (c) reaction wheels torques (d) satellite angular velocities in 3D axes (e) satellite quaternions in 3D axes

For the second level of isolation, parameter changes at the RW level can be examined [169]. Parameter estimation methods can be used to estimate RW parameters and provide further details on which parameters have changed and their severity as detailed in Chapter 3. This, however, can only be achieved if further information is available to the estimator. For example, RW current and angular velocities either directly or through other observers. For the control part of the satellite system, outputs of the isolation module can be fed into a control switching unit (Figure 4.8) and accommodate for faulty actuators to maintain mission objectives and satellite attitude in orbit. This part can be further investigated in future work to complete the package of fault tolerant satellites in orbit and under uncertainties.

98

Fault Isolation

4.2 Results and Discussion

Table 4.9 Multiple BEMF constant and Bus Voltage fault profile ­ Scenario 1

Time Vbus (s) t<15 15t<25 25t<50 50t<80 t80

Vbus (V) 8 3 8 3 8

Time kt (s) t<15 15t<25 25t<50 50t<80 t80

kt (Nm/A) 0.029 0.02 0.029 0.02 0.029

Faulty wheel None Wheel 1 None Wheel 2 None

Table 4.10 Multiple BEMF constant and Bus Voltage fault profile ­ Scenario 2

Time Vbus (s) t<15 15t<25 20t<50 25t<50 t50

Vbus (V) 8 3 3 8 8

Time kt (s) kt (Nm/A) t<15 0.029 15t<25 0.02 20t<50 0.02 25t<50 0.029 t50 0.029

Faulty wheel None Wheel 1 Wheel 2 Wheel 1 None

(a)

3

(d)

(b)

q3

(e) (c)

Figure 4.16 Attitude response of the system to multiple faults scenario 2 with pyramid RW assembly: (a),(e) satellite quaternions (b),(d) satellite angular velocities (c) reaction wheels torques

99

Fault Isolation

4.2 Results and Discussion

Probablity of fault case

Probablity of fault case

(a)

100

Prior

(d)

80 60 40 20 0 1 2 3 4 5 6 7

Prior

50

0

1

2

3

4

5

6

7

8

9

10 11 12 13 14 15

8

9

10 11 12 13 14 15

Likelihood of fault case

10 5 0

Likelihood of fault case

(b)

15

Fault case Likelihood

(e)

15 10 5 0

Fault case Likelihood

1

2

3

4

5

6

7

8

9

10 11 12 13 14 15

1

2

3

4

5

6

7

8

9

10 11 12 13 14 15

Probablity of fault case

Probablity of fault case

(c)

100

Fault case Posterior

(f)

80 60 40 20 0 1 2 3 4 5 6

Fault case Posterior

50

0

1

2

3

4

5

6

7

8

9

10 11 12 13 14 15

7

8

9

10 11 12 13 14 15

Fault case

Fault case

Figure 4.17 Fault isolation performance, multiple fault scenario, pyramid assembly: final iteration of scenario 1 (a) prior probability distribution (b) likelihood (c) posterior probability distribution; final iteration of scenario 2 (d) prior probability distribution (e) likelihood (f) posterior probability distribution

4.2.3 CMG Assembly Since it is possible to directly estimate the fault parameters for the system described in Eq. (3.30), it can be concluded that it is straightforward to isolate which CMG is faulty in the assembly along with the severity of the fault(s). In order to investigate the performance of the fault isolation for the CMG assembly, an in-phase fault scenario was considered with different fault severities for each CMG. The process model in Eq. (2.43) is provided as Eqs. (2.12), (2.13) and the measurement model in Eq. (2.43) is provided as k( ; ) = ; + ?; . Other simulation parameters are the same as Table 3.46 and the fault scenario is described in Table 4.11 where at each fault instant, at least two of the CMGs are performing with lower than perfect performance (+¼ < 1) and at some instances, all CMGs go back to nominal performance (+¼ = 1). This scenario is considered to ensure the algorithm performs well when multiple CMGs go faulty with different fault severities. Results for this scenario are shown in Figure 4.18-Figure 4.19 and listed in Table 4.12. As can be seen, all parameters are properly estimated using AUKF and CAUKF, while UKF has failed to precisely estimate all parameters. In addition, Table 4.12 confirms that the CAUKF has outperformed both UKF and AUKF by having the least RMS.

100

Fault Isolation +0~ + 0TM + 0s

4.2 Results and Discussion +0> 1 1

Table 4.11 CMG fault parameters in-phase abrupt fault profile

Time (s) < 30 20  < 28 28  < 35 35  < 50 50  < 60 60  < 80 80  < 90  90 MSE (+0~ ) 4.95×10-3 2.27×10-3 1.44×10-3

1 0.5 1 1 1 0.8 1 1

1 0.3 0.1 1 0.1 0.8 1 1

1 1 0.5 1 0.1 0.8 1 1

1 1 0.3 0.8 1 0.1

Table 4.12 CMG in-phase abrupt fault scenario performance measures

Algorithm UKF AUKF CAUKF

time (sec) 2.57 8.15 7.85

MSE (+0TM ) 9.74×10-3 5.96×10-3 5.81×10-3

Noise factor ç = 10

MSE (+0s ) 3.55×10-3 2.52×10-3 2.52×10-3

MSE (+0> ) 3.76×10-2 4.99×10-3 3.49×10-3

RMS 1.97×10-2 4.24×10-3 3.69×10-3

To investigate all possible cases of in-phase fault, a confusion matrix is presented in Table 4.13. To generate this table, fault cases from Table 4.1 are considered. The fault inception time and severity of each fault (i.e. value for +0· ) is generated randomly with MATLAB rand function, which produces a normally distributed random number. Next, when fault detection scheme captures a fault, it readjusts the covariance matrix and continues to estimate the fault parameters. After 1 second from the inception of the fault, parameters are considered to have settled at their new value and the isolation starts. Isolation works by creating a vector that calculates each CMG's + 0 by subtracting its value from 1 (nominal performance); and if the difference is more than 0.05, the CMG unit is considered to be faulty. Therefore, a vector of size 1 × 4 is generated where each element can have a value of 1 (faulty) or 0 (non-faulty). This vector is then compared with the cases Table 4.1 to determine which case is the current state of the system. For all possible cases in Table 4.1, 100 simulations were conducted, each with a randomly generated fault inception time and fault severity, and results are presented in Table 4.13. As can be seen, results show successful isolation in all cases with the average success rate of about 89.5%. The reason for less accuracy of this approach compared to the RW isolation scheme, is the fact that less information is available to isolation scheme and parallel models are not running to ensure the probability of the current state. Instead, direct estimation of the fault parameters is employed. Another consideration for these results is the

101

Fault Isolation

4.2 Results and Discussion

fact that fault inception time and fault severity is generated randomly for each fault. Therefore, if fault severity is very small, the fault isolation scheme will consider that as a nonfaulty case; hence, the result of the isolation will not be accurate. This can be most visibly observed where fault case 0 is determined by the isolation scheme, while it was not introduced to the system at all. Other wrong determinations follow the same justification.
Table 4.13 Confusion matrix for CMG assembly

Identified  Actual  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15

1

2

3

4

5

6 0 0 0 0 0 82 0 0 0 0 9 0 7 0 0

7 0 0 0 0 0 0 91 0 0 0 0 2 2 0 0

8 0 0 0 0 0 0 0 93 0 0 5 0 0 3 0

9 0 0 0 0 0 0 0 0 88 0 0 7 0 4 0

10 0 0 1 0 0 0 0 0 0 87 0 0 4 7 1

11 0 0 0 0 0 0 0 0 0 0 83 0 0 0 4

12 0 0 0 0 1 0 0 0 0 0 0 83 0 0 1

13 0 0 0 0 0 1 0 0 0 0 0 0 86 0 5

14 0 0 0 0 0 0 0 0 0 0 0 0 0 84 1

15 0 0 0 0 0 0 0 0 0 0 0 0 0 0 86

98 0 0 0 0 0 98 0 0 0 0 0 97 0 0 0 0 0 98 0 4 6 0 0 89 8 0 7 0 0 6 0 0 3 0 0 3 4 0 0 0 6 0 5 0 0 0 5 5 0 0 0 0 0 2 0 1 0 0 7 0 0 1 0 0 0 0 1 1 0 0 0 0 0 2

(a)

(b)

(c)

(d)

Figure 4.18 Simulation results for CMG fault isolation in-phase abrupt CMG faults with =10 (a) Satellite attitude (b) Satellite angular velocities (c) Scaler  trend (d) CMGs gimbal angles

102

Fault Isolation

4.2 Results and Discussion

fp1

(a)

fp2

(b)

fp3

(c)

fp4

(d)

Figure 4.19 Comparison of fault parameters estimates for in-phase abrupt fault with =10 (a) CMG1 (b) CMG2 (c) CMG3 (d) CMG4

103

Fault Isolation

4.3 Conclusions

4.3 Conclusions
In this chapter, a new 2-step approach was proposed for improving the fault isolation scheme of fault detection, isolation, and identification of satellites in orbit and in formation using a hierarchical approach. The goal was to find the root cause of the fault while only having access to limited measurements at each level of isolation. At the first level of isolation in the formation level, performance of the proposed scheme was evaluated for possible scenarios of fault in the satellites and results showed more than 99% success rate in isolation attempts. Next, for the second of isolation, two different actuators were considered, namely RW (in two configurations) and CMG. For RW, the isolation was achieved using modelbased probability distributions and online likelihood distribution generation with parallel model comparison and MSE calculations. The performance of the proposed methodology was investigated for different fault scenarios under two RW assembly configurations, namely pyramid and standard four-wheel. Single and multiple transient abrupt faults were investigated. Results were presented in a confusion matrix and proved that the proposed methodology could isolate faults in more than 99% of the cases. For CMG, the parameter estimation method was directly used to estimate fault parameters and determine the current state of the system using a Boolean logic. Faults were investigated with different inception times and different severity for each CMG, and a confusion matrix was generated. Results showed close to 90% success rate in isolation results. Future work on extending the proposed methodology was also discussed considering carrying out a complete fault-tolerant scheme for satellite attitude in orbit.

104

Fault Prognosis

4.3 Conclusions

CHAPTER 5

Fault Prognosis

I

n order to effectively control the satellite, reaction wheels should be able to provide torque or momentum with adequate volume and precision. Reaction wheels are required to work stably and reliably for over 10 years [103] considering their performance is an important factor affecting lifetime and mission of a satellite [8]. Therefore, creating a model of the degradation for the reaction wheel in order to assess its lifespan is of paramount importance [173]. As can be seen in Figure 5.1, fault evolution prediction or RUL estimation is the last component of the CBM/PHM framework. The outcomes of this module can help operators or intelligence systems to perform remedial actions that include, satellite control reprogramming, mission alternation, etc. in case of catastrophic repercussions.
Symptoms

Inputs

Diagnostics

Current Fault Condition Fault Isolation Outputs Fault Identification

Prognostics

Plant

Model Outputs

Residuals

Fault Detection

Fault Evolution Prediction

Figure 5.1 Placement of fault prognosis module in a model-based CBM/PHM flow

In general, prognostic methods can be categorized in three major subsidies: data-driven, model-based, and hybrid methods. The data-driven method does not require a physical model of the system and relies heavily on the measured and historical data collected over time. When data is available, it is possible to construct models that mimic the pattern observed in the collected data and further extrapolate that trend to predict future behavior [174]­[176]. On the other hand, a model-based approach requires a physical model of the damage or degradation behavior and combines the model with collected or measured data to identify model parameters. In order to improve the performance and reliability of the algorithm, hybrid methods use the two above-mentioned approaches. In this study, a modelbased prognosis approach is considered since access to historical data on the system under study was not available. In this approach, parameters of the model which affect system's behavior are unknown and need to be identified before the prognostics process begins or as part of it. Various methods can be used to estimate these parameters including KFs that give exact analytical PDF for linear systems with Gaussian noise [177], PFs where the posterior distribution of the model parameters is expressed through a number of particles/agents and their respective weights [178], and Bayesian methods (BM) that estimate

105

Fault Prognosis

5.1 Model-based Prognostics

the parameters using measured data and incorporates them into a single posterior distribution [179]­[181]. In this study, PF is employed since it is the most widely used approach in the field of prognostics and can be used for nonlinear systems with non-Gaussian noise.

5.1

Model-based Prognostics

The process for a model-based prognostic is illustrated in Figure 5.2 where the necessary stages can be named as (1) model identification, (2) state reconstruction, and (3) prognostics. In the model identification stage, unknown parameters of the model are estimated based on the measured data available to the system. The parameters estimated in the identification stage are then used in the state reconstruction stage along with a Markovian form of the model, the data, and input command to estimate the current state of the system. It should be noted that since the damage cannot be measured directly in most cases, a damage quantification process is required from sensor measurement data. This process is usually referred to as structural health monitoring (SHM) where health index (HI) parameters are identified and used for the next stage. In this study, a non-measurable parameter ( 4 ) is used as a HI due to extensive discussions provided in [173] and the explanation provided for this parameter in [52], where it is mentioned to be the factor affecting output torque of the RW proportionally and therefore, faults can affect this parameter one way or the other. Finally, in the prognostics stage, the RUL of the system is estimated based on the reconstructed state and available failure thresholds for a particular parameter or state.
Sensor Readings (y1:k) Measurement Model y=f(t,,u) Input command (u1:k)
Figure 5.2 Different stages of model-based prognostics

Process Model xk+1=g(xk,k,uk+1) Identification k

Expected input command (uk:k+H) 'k x1:k Prognostics RUL xk:k+H

State Reconstruction

5.2 Model Definition
The reaction wheel is a key component of the satellite orbit and attitude control system, which consists of the motor assembly, control circuit, bearing assembly, shell assembly, etc. In a study by Wu mentioned in [103], he calculated the test records for a set of reaction wheels as shown in Figure 5.3. It can be seen that the most number of faults occur in the bearing assembly, which also in the engineering design, life of the bearing assembly is the shortest of the components. Therefore, it can be concluded that health condition of the reaction wheel can be represented by the performance data from the bearing assembly in addition to the discussions provided above for choosing 4 as a HI. The failure causes of the bearing assembly include insufficient or excessive lubrication, poor bearing

106

Fault Prognosis

5.2 Model Definition

preloading, cage guide problem, etc. where most of these difficulties can be detected from changes in the bearing assembly friction torque. Since the friction torque cannot be directly measured from the telemetry data, an indirect estimation or observation is required for monitoring purposes.
Number of Faults
Figure 5.3 Fault location statistics for a group of reaction wheels

According to engineering practices, indicators such as wheel speed, wheel current, and bearing temperature can display variations in the bearing friction torque. Other sources of fault can be identified as unexpected changes in the bus voltage '%&$ (i.e. bus voltage drop); and unexpected changes in the motor current, which can be represented (or modelled) by changes in the motor torque gain 4 . Therefore, in this study, faults in the motor current were modelled and injected intermittently as time-varying variations in the RW's motor torque gain [16]. Based on previous studies [97], [99], [176], [182] working on the electrical motors, vibration, friction, and degradation behaviour of such systems and their respective parameters, the degradation model for 4 (note that L here is part of the torque gain symbol and not time index) was considered to be of the exponential growth/decline model as [173] where j and ý are model parameters to be estimated and L is the time of the evolution. The particle filter process was described earlier in Section 2.5. As discussed particle filter works on basis of Bayesian inference with Bayes' theorem explained in Eq. (4.8). In particle filter, the Bayesian update is processed in a sequential manner with particles carrying the probability distribution of the unknown parameters. When a new measurement is available, the posterior at the previous step is used as the prior at the current step, and the parameters are updated by multiplication of the prior with likelihood as explained in Eq. (4.9). Hence, the name sequential Monte Carlo method. The general process of the particle filter is based on the state transition function +(), which is also known as the damage model in the prognosis field, and the measurement function k() as described in Eq. (2.43). The degradation model in Eq. (5.1) can be rewritten in discrete form as (5.1) =
-

=

-

-

(5.2)

107

Fault Prognosis

5.3 Particle Filter Process

where L; = L; + L. In this case the process noise >; is neglected due to the fact that it can be handled though uncertainty considered for the model parameters. For the measurement function, since 4 is not directly measurable, parameter estimation techniques introduced in Chapter 2 for the fault detection are used. Using RW dynamics from Eq. (2.31) with measurements as wheel speed (e) and motor current ( ), system parameters 4 and '%&$ are estimated using the proposed CAUKF in Chapter 2. When 4 values are estimated, the fault trend is among the four possible scenarios for the faulty situation as described in Chapter 2, including abrupt, transient, intermittent, and incipient. Based on the discussion provided for each type of fault progression, it can be concluded that fault prognosis is mainly concerned with the gradual degradation of the system, which can be observed most visibly in incipient fault progression. Therefore, in this chapter, we only deal with the incipient fault progression.

5.3 Particle Filter Process
As explained earlier, the process of PF is based on Bayes' theorem. At the first step of the process ( = 1), D samples of the parameter are drawn from the initial (prior) distribution. Next, the following steps are followed 5.3.1 Step 1 ­ Initialization The posterior distribution of the model parameters at the previous step ( - 1th) is used as the prior distribution for the current step ( th) in the form of samples. In addition, damage state at the current time is transmitted from the samples of the damage model at the previous step, based on the model parameters. The samples in step correspond to ¼(d) in Eq. (4.8). 5.3.2 Step 2 ­ Update Assuming a distribution model for the noise, the likelihood of the measurements is obtained. If the measurement noise ?; is assumed to be normally distributed, from the normal distribution function formulation, where x is the mean or expected value of the distribution for G, Õ is its standard deviation, and Õ , is its variance. The likelihood of the measurements can be obtained from The weight for the Vth particle is assigned based on the likelihood calculated from Eq. (5.4). If the measurement noise ?; is assumed to be lognormally distributed, from the lognormal distribution function formulation, 108 ( | , , )= 1 2 ( ) - 1 2 - ( ) , = 1,2, ... , (5.4) ( | , )= 1 2
- ( - )

(5.3)

Fault Prognosis ( | , )= 1 
- ( - )

5.3 Particle Filter Process

where x is the mean or expected value of the distribution for G, Õ is its standard deviation, and Õ , is its variance. The likelihood of the measurements can be obtained from The weight for the Vth particle is assigned based on the likelihood calculated from Eq. (5.6). These weights are used for the next step of resampling. For the lognormal distribution, mean, median, and mode are calculated differently from that of the normal distribution. The formulation for these terms can be written as follows = = ( + ( ) /2) ) (5.7) (5.8) (5.9) ( | , , )= 1  2 - 1 2 - ( ) , = 1,2, ... , (5.6)

2

(5.5)

It is important to note that x and Õ are not location and scale parameters for the lognormally distributed variable, but rather location and scale parameters of its logarithm. If mean, standard deviation, and variance of the non-logarithmic set are denoted as ~, Õ, and ? , respectively, the two sets can be linked as =    1+ 1+    (5.10)

=

( -

=

(5.11)

5.3.3 Step 3 ­ Resampling In the resampling step, based on the weights for each particle and the resampling method used, particles are eliminated or duplicated to form a new population from the previous population. The idea is to go back from weighted samples to unweighted samples to enforce diversity of the population and avoid degeneracy. As shown in Figure 5.4 after initiation process in Figure 5.4 (a), particles are propagated through the transition model to get the current states from the previous states as shown in Figure 5.4 (b). Next, all particles are weighted based on a probability distribution or fitness criterion as mentioned in step 2 of the particle filter process, which results in weighted particles as shown in Figure 5.4 (c). The weighted particles are prone to degeneracy, and potential solution spaces may disappear if weighted particles are continued with. Therefore, using a resampling technique, the new sample set is generated having unweighted particles, which essentially represents 109

Fault Prognosis

5.4 Predicting the Damage State and RUL

the weights of the previously weighted particles with the number of particles rather than associated weights. This process can be observed visually in the transition from Figure 5.4 (c) to Figure 5.4 (d).

(a)

(b)

(c)

(d)

Figure 5.4 Particle filtering process visual representation

Among other methods, the inverse cumulative distribution function (CDF) resampling method is employed in this study. The CDF of a real-valued random variable or its PDF, evaluated at G, is equal to the probability that would take a value  G. Therefore, for a continuous distribution, it equals the area under the PDF from - to G. Figure 5.5 illustrates the inverse CDF process where first, a CDF is constructed from the likelihood in Eq. (5.4). Next, a random value between 0 and 1 is generated (e.g. 0.5 in Figure 5.5) and used to find the corresponding sample that has the same CDF among other particles (shown as a circle on the G axis). It should be noted that since the CDF in this case is discrete, the closest sample to the corresponding CDF value is selected as the new sample. Repeating this process D times, generates D new samples from the previous weighted particles. The newly generated particles are the posterior distribution at the current ( th) step and the prior distribution at the following ( + 1th) step.
0.4 1 0.36 0.32 0.28 0.24 0.2 0.16 0.12 0.08 0.04 0 1 2 3 k k+1 ... n
PDF CDF

0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0

Particle

Figure 5.5 Inverse CDF resampling method

5.4 Predicting the Damage State and RUL
Once the estimated parameters are obtained from the particle filter, which can handle non-Gaussian additive noise unlike other methods, through the process detailed above, the future damage state and RUL can be predicted by propagating the damage state 110

Fault Prognosis

5.4 Predicting the Damage State and RUL

through the damage model until it reaches a pre-set threshold. The remaining useful life of the unit is then calculated as the difference between the end of life (where damage model extrapolation intersects with failure threshold) and the current time (observation of faulty behaviour). This can be formulated in mathematical form as [183] where L)<6 refers to end of life for the unit and L refers to the current time. Figure 5.6 illustrates the schematics of the RUL prediction process input/outputs. In Figure 5.6, the two dashed lines surrounding the true model's extrapolation, represent the prediction interval of the damage state. While the distribution curve at the failure threshold line represents the distribution of time when the damage state reaches the threshold. (5.12)
RUL PDF prediction at k failure threshold
damage level, x

=

-

lower %ile of RUL prediction intervals current PDF at k true model true model's extrapolation

estimated model's median measurments

current time, k

time

Figure 5.6 RUL prediction process schematics

In order to obtain the RUL distribution, the distribution of time needs to be subtracted from the threshold. It should be noted that in the prognosis step, only the damage state is transmitted and damage model parameters are no longer updated. In addition, during the prognosis step, the measurement error with the updated standard deviation is added to the damage state for accuracy. The novelty in this approach lies in its 2-step process. In the literature, as discussed earlier, fault prognosis is not investigated for satellite systems specially actuators. Most recently Nguyen et al. [173] have examined the induction motors but for terrestrial applications. In addition, they use system measurements to feed data to the PF estimator for RUL predictions, however, in the approach proposed in this thesis, the proposed CAUKF in this thesis is used to estimate the non-measurable system parameter 4 as HI and feed it to the PF estimator for damage model reconstruction and RUL predication. Therefore, the mathematical formulation of the problem addressed in this chapter can be represented as follows:

111

Fault Prognosis

5.4 Predicting the Damage State and RUL

Step 1: Estimate As discussed earlier, the first step is to estimate non-measurable parameter RW measurable states e and as presented in Chapter 2 with = where ( )= ( , , )= ( )= (3 2 )  = 1 { ( )+ [ ( , [ ( ) + 1] - )- ( )] - - + ( )+ }

4

from

(5.13)

[- ( , , 1+ [- ( , , ( )= 1+ (- (- 1- 1+ 1 [- ( - 1+ ) ) (- (-

( )=

[ - ,

( ,

2

( )] ) = -

1- 1+

-6-

1 (-

)]

) )

)]

)]

( ,

,

) (5.14) )] )

+

1+ ) (1 +

1 [ ( +

Step 2: Add noise to estimated In order to investigate performance of the estimated RUL from proposed PF approach, it is important to evaluate the performance under different types of additive noise. Particularly, non-Gaussian noise needs to be evaluated because unlike other KF family methods, PF does not rely on the Gaussian distribution for the added noise to the measurements. where þ 4 is the generated measured 4 fed to the PF for degradation model identification. Ü 4 is the estimated 4 from the CAUKF as discussed in Step 1. And ?; is the measurement noise added to the estimated 4 before feeding to PF. It is important that there is no restriction on the type of noise that ?; represents, since PF is capable of handling Gaussian and non-Gaussian noise. Detailed discussions on convergence theories and results for various types of PF are provided in a survey by Crisan and Doucet [184]. (5.15) Step 3: Identify degradation model parameters using PF  =  +

112

Fault Prognosis

5.5 Results and Discussion

Using the input measurements from Step 2, PF runs sequential Monte Carlo simulations as discussed earlier and identifies model parameters in eq. (5.1). Therefore, the system for which the PF identifies models can be presented as = ( )= = = +
-

(5.16)

Step 4: Extrapolate model and determine RUL The last step of this process is to extrapolate the estimated degradation model in time and intersect it with the failure threshold defined for the HI, which in here is 4 . The time at which these two intersect is the end of life time and the remaining useful time is defined as the difference between the current time and end of life time. Since PF provides a series of estimates for all of its agents/particles, the final RUL is presented as a distribution of these estimates. Furthermore, one can identify mean, median, or another property of this distribution to provide a value for the RUL. Further discussions on the choice for this property as well as case studies are presented in the following section.

5.5 Results and Discussion
Numerical simulations were conducted to evaluate the performance of the proposed prognosis scheme. Numerical integration of the states was done in MATLAB using classical Runge-Kutta method (RK4) [172] with a sampling period of *$ = 0.01 ·. White-noise was added to the integration outputs of the RW for measurement noise. The total simulation time = 100 s and simulations were performed on an Intel® CoreTM i7-4790 CPU with 3.60 GHz power PC and 16.00 GB RAM. The overall simulation setup can be referred to the flow shown in Figure 5.12. Further simulation parameters are listed in Table 3.5. First, new fault scenarios are considered for the RW parameter changes that were not discussed in Chapter 3. Since the damage model in this chapter is considered to be of exponential form, parameter's behaviour from the inception of the fault also needs to be of exponential form, which was not considered in Chapter 2. 5.5.1 Exponential Decline In this section, new fault scenario wherein value of 4 degrades exponentially is introduced (Table 5.1). As can be seen in this scenario, unlike the other ones we introduced in Chapter 2, fault inception continues until the end of simulation time. This is to show the fault progression is gradual and lasts until the end of life for the component. This is the reason that incipient faults are particularly important when it comes to fault prognosis and RUL estimation.

113

Fault Prognosis Time '%&$ (s) < 30 30  < 100 '%&$ (V) 8 8 Time (4 (s) < 30 30  < 100

5.5 Results and Discussion (4 (Nm/A) 0.029 0.019 + 0.01 G¼(-.064  L)

Table 5.1 Exponential decline in Motor Torque Constant fault profile

all states and parameters are accurately estimated. Figure 5.8 shows how [ and [T values Figure 5.7 illustrates state and parameter estimations for this fault scenario. As can be seen, change for this fault scenario. Figure 5.9 depicts states and parameters residuals, which residuals. As can be seen, since there are no sudden jumps in the trend for parameters, there further confirms accurate estimation of the state and parameters by providing bounded are no sudden spikes in the [ trend either. This means that in this case the CAUKF behaves iance matrices. Figure 5.10 shows the comparison between different methods for mates. This figure is important since the prognosis process starts after this trend is captured by the fault detection scheme. As discussed earlier, inputs to the fault prognosis scheme are Figure 5.11 illustrates comparison between different methods for ?%&$ estimates. As ?%&$ method perform relatively the same for this estimation.
Table 5.2 Exponential decline in Motor Torque Constant performance measures
4

very much like AUKF because there are not many manual adjustments of the filter covaresti-

provided by the estimates calculated from the parameter estimation algorithm. Finally, remains unchanged in this fault scenario, this figure shows a straight line and different Noise factor ç = 1 MSE ((4 ) 7.04×10-8 4.58×10-8 4.55×10-8 Noise factor ç = 10 MSE ((4 ) 7.51×10-8 5.28×10-8 5.13×10-8

Algorithm UKF AUKF CAUKF

time (sec) 2.31 2.28 3.35

MSE ('%&$ ) 3.18×10-3 3.18×10-3 3.18×10-3

time (sec) 2.25 2.28 3.39

MSE ('%&$ ) 3.20×10-3 3.19×10-3 3.19×10-3

Summary of the performance measures for two different noise levels is provided in Table 5.2. Results in Table 5.2 show that CAUKF outperforms both UKF and AUKF in terms of decreasing MSE for both RW parameters. The flow of the prognosis is illustrated in Figure 5.12 where the output of the UKF parameter estimation, which is 4 is fed to the particle filter fault prognosis scheme. An additional measurement noise is added to 4 before it is fed to damage model identification where it is ?; ~P(0, Õ) and Õ is an unknown standard deviation to the identification scheme. Therefore, the unknown parameters for the damage model become  = l 4 , d(= ý), Õm; where 4Â is also included and obtained based on the model parameter ý; .

114

Fault Prognosis
1 0 -1 0 20 40 60 80 100 50 0 -50 0 20

5.5 Results and Discussion

40

60

80

100

Time (sec)
0.035 0.03 0.025 0.02 0.015 8 6 0 20 40 60 80 100 0 20

Time (sec)

40

60

80

100

Time (sec)

Time (sec)

Figure 5.7 State and parameters estimates for incipient fault with =10

Figure 5.8

and

for incipient fault with =10

0.05 0 -0.05 0 20 40 60 80 100

5 0 -5 0

10-4

20

40

60

80

100

Time (sec)
0.02 0 -0.02 0 20 40 60 80 100 5 0 -5 0 20

Time (sec)

40

60

80

100

Time (sec)

Time (sec)

Figure 5.9 State and parameters residuals for incipient fault with =10

115

Fault Prognosis

5.5 Results and Discussion

K t (Nm/A)

Figure 5.10 Comparison of

estimates for incipient fault with =10

Vbus (Volts)
Figure 5.11 Comparison of
Noise

estimates for incipient fault with =10
Expected input command (uk:k+H)
State

Va

RW High Fidelity Model With Faults\Hardware in the Loop

m  + I Im
^^ I

Parameter Estimation with CAUKF

Noise

Damage Model xk+1=g(xk,k,uk+1)

+ p =[kt,Vbus]
^

Identification

k

'k x1:k

[kt,b, ] Reconstruction

Prognostics

RUL xk:k+H

RW High Fidelity Analytical Model

After initializing the fault scenario and estimating 4 and ?%&$ , where only 4 is further fed to PF for RUL estimation, the next step is to initialize the fault prognosis scheme. In this scenario, we assume the data coming from the estimator are available for a number of measurements after fault inception. This gives the prognosis algorithm priori information to start the prognosis. We assume that the data provided to the prognosis algorithm are measured every day after inception of the fault; therefore, the time unit for
Figure 5.12 Flow of the fault detection leading to fault prognosis

116

Fault Prognosis

5.5 Results and Discussion

the prognosis is considered to be days. Next based on the damage model provided in Eq. (5.1) we need values for j and ý to setup the true model values (Table 5.3). Since there are no priori information about  is not available, the initial distribution for all the parameters is assumed to be uniform with lower and upper bounds provided in Table 5.3. The number of particles can be chosen between 500 to 5000 particles depending on the complexity of the problem. Next, there is significant level (") [185], [186] for calculating confidence interval (C.I.) and prediction interval (P.I.). Significant level can be chosen as 5, 2.5, or 0.5 for 90%, 95% or 99% intervals, respectively.
Table 5.3 Fault prognosis simulation parameters

Parameter Time unit Data collection delay (\L) j4O&) ý4O&) Failure threshold ( ýT ÕT D "
4T 4$ )

Value days 3 [time unit] 0.03 [Nm/A] 0.012 0.01 [Nm/A] ~U(0.025, 0.035) ~U(0,0.02) ~U(0, 0.01) 500 0.5 (99%)

5.5.2 Normal Distribution Results for a particular simulation under normal distribution are shown in Figure 5.13 to Figure 5.16. Figure 5.13 illustrates the available data and the forecasted data on the system combined. In this figure, True curve represents the degradation model with designed values provided in Table 5.3. As can be seen, the data coming from the estimator and were discussed in the previous section, are now treated as measurement data for the prognosis algorithm. Extra measurement noise is added to the data points to ensure completeness of the results. The threshold line is set at 0.01, which separates the operating and non-operating regions. It is also used for intersecting the true extrapolation of the model with the threshold to find the true RUL of the system. Next, 99% prediction intervals and median of the data show forecasted progression of the system parameter and the confidence in its value at each point in time. It can be observed that as soon as there are no more measurements available to the prognosis algorithm, the prediction interval widens to compensate for the loss of confidence in the forecast data. Figure 5.14 illustrates the RUL distribution for the system based on 4 reaching its threshold. In this figure, x is the mean of the data and G Ý is the median of the data. Median can be a better representative of the estimated RUL for the component in this case [183]. In order to obtain the mean and median, a normal

117

Fault Prognosis

5.5 Results and Discussion

distribution curve (normal distribution curve) was fitted to the estimated data spread (bars), and the mean was obtained from that fit. Median could be obtained from the estimated data spread (bars) directly or from the fitted distribution.
0.035 0.03 0.025 0.02 0.015 0.01 0.005 0 -0.005 0 50 Times horizon (days) 100 150 Operating Region Non-operating Region
True Extrapolation True Median 99% PI Measurment Threshold

Figure 5.13 Fault prognosis for
350 300 250 200 150 100 50 0

under normal noise

0

100

200

300

400

RUL (days)

Figure 5.15 and Figure 5.16 show the fault prognosis results obtained for the damage model parameter ý and measurement noise Õ. The median of the data and the true data seem to match closely after a few iterations (days) in the prognosis. This means that the model has matched accurately with damage model considered in generating measurement data after the fault inception. The confidence intervals seem to narrow down as the estimated value converges to the true value to provide more confidence in the estimations. This can be looked at from the UKF point of view where covariance matrix elements become smaller to

Figure 5.14 RUL distribution based on

damage model for normal noise

118

Fault Prognosis show higher confidence in the estimates.

5.5 Results and Discussion

b
Figure 5.15 Fault prognosis for

under normal noise

Figure 5.16 Fault prognosis for

under normal noise

Detailed results for the prognosis of the parameter degradation are provided in Table 5.4 for simulation with 500 particles under a normally distributed sample set, using inverse CDF resampling method. Since the simulation setup is based on random data (noise/particle) generation, outcomes of the simulations can vary in each run. Therefore, a set of 100 simulations were conducted, and minimum, average, and the maximum value of the whole set were reported under each measure. It is also important to note that sometimes particles may not converge to a particular solution and system may keep running. For this reason, it was considered to use a computation time threshold above which the simulation would be terminated, and that particular simulation results were nullified and removed from simulation set. For the results provided in Table 5.4, out of 100 simulation attempts, 93 were successful, and the rest failed to converge within the specified threshold of 10 seconds. Total

119

Fault Prognosis

5.5 Results and Discussion

computation time for this set was 101.93 sec and minimum, average, and maximum computation time for individual runs are reported in the table under L parameter.
Table 5.4 Fault prognosis for a normally distributed sample set with 500 particles

From the results provided in Table 5.4, it can be observed that median (G Ý ) is a better representation of the RUL compared to mean (x ) of the data. It can also be observed that the estimated RUL is reasonably close to the actual RUL by 3.3 in value or ~5% error. Table 5.5 presents results for the prognosis for same system in Table 5.4 with 100 particles instead of 500. This simulation took 8.17 sec to complete and all 100 simulations were successful. It can be observed that in this case, mean of the data provides a better estimated of the actual RUL compared to the median. However, if we keep our estimated value as the median of the estimations, it is clear that with smaller number of particles the accuracy has decreased to 7.54 in value or ~12% error.
Table 5.5 Fault prognosis for a normally distributed sample set with 100 particles

Metric Min Mean Max

True 64.56 64.56 64.56

37.25 70.30 256.30

x

RUL (days) G Ý 0.5% 33 3 61.26 12.70 264 57

Õ 99.5% 57 7.39 286.05 46.04 2046 277.45

L (sec) 0.053 0.33 4.99

Metric Min Mean Max

True 64.56 64.56 64.56

19.05 65.05 312.27

x

RUL (days) G Ý 0.5% 18 3 57.02 17.85 192 153

Õ 99.5% 48 4.26 211.72 36.99 2328 494.00

L (sec) 0.021 0.079 0.973

Table 5.6 presents the results for the system in Table 5.4 and Table 5.5 with the same conditions except for the number of particles. In Table 5.6, 1000 particles were employed. The whole simulation took 182 sec to complete, and 94 attempts were successful out of the total 100. It can be clearly observed that increasing the number particles has improved the accuracy of the estimates by decreasing the error to 1.07 in value or ~1.6%. However, the trade-off is the increased computation time.
Table 5.6 Fault prognosis for a normally distributed sample set with 1000 particles

Metric Min Mean Max

True 64.56 64.56 64.56

RUL (days) x G Ý 0.5% 35.56 33 3 75.23 63.49 12.11 759.06 519.00 43.50

99.5% 63 302.71 2005

L (sec) 7.41 0.09 56.08 1.16 657.57 8.44

Õ

120

Fault Prognosis

5.5 Results and Discussion

5.5.3 Lognormal Distribution In order to investigate other distributions, results for a simulation under lognormal distribution are shown in Figure 5.17-Figure 5.20. Figure 5.17 illustrates the available data and the forecasted data on the system. The descriptions on the Figure 5.17 are the same as Figure 5.13. Figure 5.18 illustrates the RUL distribution for the system based on 4 reaching its threshold. In this figure, x is the mean of the data and G Ý is the median of the data, and also in lognormal distribution Mode is introduced as another important parameter.
0.035 0.03 0.025 0.02 0.015 0.01 0.005 0 Operating Region Non-operating Region
True Extrapolation True Median 99% PI Measurment Threshold

0

50 Times horizon (days)

100

150

Figure 5.17 Fault prognosis for

under lognormal noise

In order to obtain the mean and median, a lognormal distribution curve (normal distribution curve) was fitted to the estimated data spread (bars), and the mean was obtained from that fit. Median could be obtained from the estimated data spread (bars) directly or from the fitted distribution. Figure 5.19 and Figure 5.20 show the fault prognosis results obtained for the damage model parameter ý and measurement noise Õ. Detailed results for the prognosis of the parameter degradation are provided in Table 5.7 for simulation with 500 particles under a log-normally distributed samples, using inverse CDF resampling method. For the results provided in Table 5.7, out of 100 simulation attempts, 99 were successful. Total computation time for this set was 53.68 sec. From the results provided in Table 5.7, median (G Ý ) is considered as the representation of the RUL. The estimated RUL is close to the true RUL by 5.27 in value or ~8% error. Table 5.8 presents results for the prognosis for same system in Table 5.7 with 100 particles instead of 500. This simulation took 16.5 sec to complete and 99 simulations were successful out of 100.

121

Fault Prognosis

5.5 Results and Discussion

Table 5.7 Fault prognosis for a log-normally distributed sample set with 500 particles

Metric Min Mean Max

True 64.56 64.56 64.56
400 350 300 250 200 150 100 50 0 0

34.78 68.86 215.10

x

RUL (days) G Ý 0.5% 33 6 59.29 18.21 120 45

99.5% 69 338.64 2589

0.09 0.44 1.01

Õ

L (sec) 0.06 0.44 6.89

50

100

150

200

250

300

350

RUL (days)

Figure 5.18 RUL distribution based on

damage model for lognormal noise

Figure 5.19 Fault prognosis for

under lognormal noise

It is clear that with a smaller number of particles the accuracy has decreased to 8.65 in value or ~13% error. This comes with the advantage of faster computation compared to 500 particles case. Table 5.9 presents the results for the system in Table 5.7 and Table 5.8 with the same conditions except for the number of particles. In Table 5.9, 1000 particles were employed. The whole simulation took 245.9 sec to complete, and 85 attempts were successful out of the total 100. It can be clearly observed that increasing the number particles has improved the accuracy of the estimated by decreasing the error to 4.67 in value or ~7%. However, the trade-off is the increased computation time. 122

Fault Prognosis

5.6 Conclusions

Figure 5.20 Fault prognosis for

under lognormal noise

Table 5.8 Fault prognosis for a log-normally distributed sample set with 100 particles

Metric Min Mean Max

True 64.56 64.56 64.56

26.53 63.88 239.25

x

RUL (days) G Ý 0.5% 21 3 55.91 19.45 222 159

99.5% 51 181.42 1002

0.10 0.42 1.05

Õ

L (sec) 0.02 0.06 0.35

Table 5.9 Fault prognosis for a log-normally distributed sample set with 1000 particles

Metric Min Mean Max

True 64.56 64.56 64.56

35.18 71.30 244.27

x

RUL (days) G Ý 0.5% 30 3 59.89 17.54 189 37.50

99.5% 63 437.65 2359

0.13 0.48 0.99

Õ

L (sec) 0.12 1.12 7.36

5.6 Conclusions
In this chapter, a new 2-step approach was proposed for estimating the remaining useful life a RW onboard satellite. Adaptive unscented Kalman filter was employed to estimated non-measurable system parameters 4 and ?%&$ , of which only 4 was fed to PF as a HI. When inception of a fault was detected by the FDI algorithm, an exponential failure damage model was used along with a Particle Filter to adapt the deterioration trend of the system to measurements provided by the CAUKF. Next, the identified damage model was used to extrapolate the data and determine the RUL of the faulty RW. The proposed scheme was evaluated using two types of measurement noise: normal Gaussian and lognormal. Results showed successful estimation of the RUL with errors in estimating ranging from 1.5% to 13% in both cases. Therefore, it can be concluded that the proposed scheme can be a feasible approach for such application. 123

Conclusions and Future Work

6.1 Highlights

CHAPTER 6

Conclusions and Future Work
his thesis dealt with the problem of fault detection, isolation, and prognosis in actuators of the in-orbit satellite. The main modules of a CBM/PHM framework were discussed as fault detection module, fault isolation/identification module, and fault prognosis module. In fault detection module, the occurrence of a fault is detected followed by fault isolation/identification where location and severity of the fault are determined. Finally, fault prognosis provides an estimate for the RUL of the faulty component, which can help plan future maintenance or remedial actions in advance. In light of the importance associated with CBM/PHM frameworks for today's complex systems, in this thesis, three major modules of this framework were investigated, and enhancement techniques were proposed and evaluated to address some of the limitations observed in the literature. Most importantly, the combination of these methods can provide a complete CBM/PHM flow to enhance reliability and availability of engineering system where expert knowledge and experienced staff are not available. Furthermore, the proposed framework can be extended from single satellites to multi-agent systems, using similar approach to the proposed algorithms, given the dynamics equations of the multi-agent system as well as proper implementation of the schemes.

T

6.1 Highlights
In Chapter 3, a new 2-step fault detection scheme was proposed to address the agility and accuracy limitations in other related literature. The proposed scheme was designed based on adjusting the covariance matrix for the adaptive unscented Kalman filter, which estimated two non-measurable parameters of a high-fidelity RW on-line. The process was a two-step scheme where first a fault was annunciated and second filter was adjusted. The performance of the proposed scheme was evaluated on all possible fault scenarios including abrupt, transient, intermittent and incipient. it should be noted that incipient faults are not investigated in many of the open literature due to their ongoing variable behavior. In addition, mild and severe noise levels were considered for the measurement noise to evaluate the performance of the proposed scheme with regards to noise. Results showed that the proposed scheme outperformed all other methods it was compared to in terms of accuracy and agility in detecting faults and adjusting estimates. In Chapter 4, a new 2-step fault isolation scheme was proposed where the applicability of the technique was broadened, and implementation of it was made easier.

124

Conclusions and Future Work

6.1 Highlights

The technique relies on a multiple model approach where multiple version of the system run in parallel to the nominally behaving unit. At each time, when a fault is annunciated, parallel models, each pertaining to a particular faulty mode, run in parallel to the nominal unit and outputs are compared using residuals to create a likelihood distribution of the faulty cases and when a confidence level is achieved, faulty mode is determined and current system mode is switched to the determined faulty mode to be able to investigate future faults. After switching is done, parallel models stop running and fault detection scheme monitors system behavior for anomalies. The benefits of this approach can be mentioned as (1) since no simplification or linearization is considered for the model, range of operation in this approach is broader compared to other multi-model approaches where, due to the estimator used (e.g. KF or EKF), linearization is required, and inaccuracies can occur. (2) Any initial distribution can be assumed for the faulty modes, and no uniform or Gaussian distribution assumption is necessary. (3) Since all models are not running at all times and parallel models only run during the isolation process, computational resources can be allocated to other necessary sections onboard or remain idle to save power consumption. (4) Hierarchical architecture of the scheme allows for demanding certain information and/or resources at each level, saving the need to require unnecessary information or resources at all times. The proposed scheme was tested on an RWA with four RW in two different configurations (standard four-wheel and pyramid) onboard a satellite in orbit and under various disturbance torques. Results showed more than 99% success is properly isolating the faulty units in case of faulty behavior, uniform and normal distributions were evaluated for the initial distribution of the faulty models to ensure applicability of the scheme to various scenarios. Results showed successful isolation regardless of the initial distribution considered for faulty modes. In addition, concurrent and consequent faults were investigated to evaluate the performance of the proposed scheme in case of faults occurring at the same time or in sequence, respectively. Results showed the successful isolation of the faults in both cases. In Chapter 5, a new hybrid fault prognosis scheme using UKF and PF was proposed. First, based on the literature pertaining to RW failures onboard satellites, key components and measurable and non-measurable parameters were identified. Next, a fault scenario was introduced based on the data collected from the literature, and simulated data were fed to the fault detection scheme, which then provided simulated measurements to the prognosis scheme. The prognosis scheme used a degradation model and the measurements provided by the estimator to adjust the degradation model to the current situation of the system. After adjusting the degradation model, its trend was extrapolated to find its intersection with the threshold for the critical parameter representing the component under wear and tear, to find the RUL of the faulty unit. Using the true data and estimated RUL, results were compared to evaluate the performance of the proposed scheme. Results showed that

125

Conclusions and Future Work

6.2 Summary of Contributions

the proposed scheme was able to estimate the RUL of the system with errors as low as 1.5%. In addition, multiple scenarios for the measurement noise added to the estimator's estimates were considered including normal and lognormal distributions. Results were satisfactory for both cases, and RUL was estimated successfully.

6.2 Summary of Contributions
As mentioned earlier the main focus of this thesis was to develop a framework for CBM/PHM of a complex engineering system, particularly satellite's actuators. In the process, three major modules were investigated, and enhancement proposals were made to improve accuracy and reliability of each module. All numerical simulations were conducted on a high fidelity `ITHACO Type A' RW model. A summary of the contributions in each module can be provided as follows: Fault Detection: A new 2-step fault detection approach was proposed that (1) considers a high-fidelity model of an RW system, (2) considers states error covariance matrix when abrupt changes occur to ensure agile tracking of non-measurable system parameters, (3) is applicable to all fault scenarios including abrupt, transient, intermittent, and incipient, (4) performs well under various noise levels. The proposed method was also implemented and analysed through numerical simulations for a CMG assembly onboard satellite where results showed superior performance of the proposed method compared to other similar available techniques in the literature. Fault Isolation: A new 2-step fault isolation approach was proposed based on a hierarchical MM scheme. The fault is detected using residual sequence followed by the first level of isolation in the formation level using residual windowing, second level of isolation using Bayes' probability theorem to locate the faulty unit and the third level of isolation using parameter estimation to locate the faulty parameter with limited a priori information. This approach (1) considers a high-fidelity model for each RW in the RWA mounted on an in-orbit satellite with external disturbances, (2) does not require linearization of the system model, (3) due to hierarchical architecture only requires certain information at certain levels, (4) performs well regardless of the initial distribution considered for faulty modes. A variation of the proposed method was also implemented and analyzied through numerical simulations for a CMG assembly onboard satellite where results showed satisfactory results comparable to the RWA case. Fault Prognosis: A new hybrid fault prognosis approach was proposed for RW onboard satellite using a mathematical model of the system, degradation model, and synthetic data to investigate the feasibility of employing PF for such application. The proposed approach (1) employs particle filter for system identification on degradation model, (2) performs well under different noise distributions including normal and lognormal, (3) does

126

Conclusions and Future Work

6.3 Future Work

not require linearization of the system model, (4) can estimate RUL with errors as low as 1.5%.

6.3 Future Work
A number of future works can be envisioned for this thesis considering the extensively growing requirements and applicability of fault diagnosis, prognosis, and health management (DPHM) technologies across science and engineering fields: Investigating the proposed framework on other Systems: Although in this thesis, substantial simulations were provided for the proposed framework on an RW system, it is interesting to investigate the performance of the proposed framework on other complex systems. Investigating integrity of the proposed framework: Although each module of the proposed framework was evaluated individually or in conjunction with another module, all three modules were not investigated together. It would be valuable to evaluate the performance of the proposed framework when all modules are integrated, and outputs of one module are fed to the following modules for a complete DPHM process. Investigating the proposed framework in a complete close-loop system: Another aspect that was not focused on in this thesis was the controller aspect of the ACS. It is understood that the outcomes of the CBM/PHM framework can greatly help accommodate unforeseen circumstances in complex systems. However, the controller unit is responsible for considering such changes in the system and applying alternations/reconfigurations to maintain system performance or at least partially accomplish its expected mission. Therefore, implementing this framework along with a control unit to evaluate the overall system performance can be a valuable asset. Investigating the proposed framework in other architectures/topologies for multi-agent systems: In this thesis, single satellite system and two different architectures of formation flying were considered, and satellite's ACS actuators were investigated for fault diagnosis and prognosis. However, the proposed framework can be extended to other multi-agent systems and architectures where the difference would be in the proper derivation of the multi-agent dynamics equations and proper implementation of the proposed framework. Investigating hybrid approaches: Due to lack of experimental data, this thesis was mostly based on simulated and synthetic data. It would be interesting to evaluate the performance of the proposed framework when it is combined with data-driven approaches built on experimental data. Such approach could expand the applicability of the framework to cases and systems where the mathematical model of the system is not available. It can also compensate for inaccuracies or inconsistencies between mathematical models and hardware.

127

References

References
[1] [2] [3] [4] [5] [6] M. Blanke, M. Kinnaert, J. Lunze, and M. Staroswiecki, Diagnosis and Fault-Tolerant Control, 2nd ed. Springer, 2006. G. Vachtsevanos et al., Intelligent Fault Diagnosis and Prognosis for Engineering Systems, 1st ed. Hoboken, NJ, USA: John Wiley & Sons, Inc., 2006. N. Tahri, C. Hamrouni, and A. M. Alimi, "Study of Current Femto-Satellite Approches and Services," Int. J. Adv. Comput. Sci. Appl., vol. 4, no. 5, pp. 148­153, 2013. G. Konecny and Institute, "Small Satellites ­ A Tool for Earth Observation? Gottfried," in XXth ISPRS Congress-Commision, 2004, pp. 1­3. Godard, K. D. Kumar, and A.-M. Zou, "A novel single thruster control strategy for spacecraft attitude stabilization," Acta Astronaut., vol. 86, pp. 55­67, May 2013. H. Kayal, F. Baumann, K. Briess, and S. Montenegro, "BEESAT: A Pico Satellite for the On Orbit Verification of Micro Wheels," in 2007 3rd International Conference on Recent Advances in Space Technologies, 2007, pp. 497­502. S. Trowitzsch, F. Baumann, and K. Brieß, "BEESAT-2: A Picosatellite Demonstrating Three-Axis Attitude Control Using Reaction Wheels," in 65th International Astronautical Congress, 2014. M. Tafazoli, "A study of on-orbit spacecraft failures," Acta Astronaut., vol. 64, no. 2­3, pp. 195­205, Jan. 2009. E. Buchen and D. DePasquale, "2014 Nano/Microsatellite Market Assessment," Atlanta, GA, 2014. B. Doncaster, C. Williams, and J. Shulman, "2017 Nano/Microsatellite Market Assessment," Atlanta, GA, 2017. J. D. Harrington, "NASA Selects Explorer Investigations for Formulation," NASA press, Washington, DC, DC, 2016. R. Cowen, "The wheels come off Kepler," Nature, vol. 497, no. 7450, pp. 417­418, May 2013. A. Pasetti, "Background on Attitude and Orbit Control Systems (AOCS)," 2002. [Online]. Available: https://www.pnp-software.com/AocsFramework/AocsBackground.html. [Accessed: 11-May-2017]. N. Abreu, "Fault Diagnosis with Adaptive Kalman Filters and CMG Design for Picosatellite ACS," Ryerson University, 2010. S. Murugesan and P. S. Goel, "Fault-tolerant spacecraft attitude control system," Sadhana, vol. 11, no. 1­2, pp. 233­261, Oct. 1987. E. Sobhani-Tehrani and K. Khorasani, "Identification For Nonlinear Systems Using Hybrid Approach," Master's Thesis. p. 12­13,15,18,37,92, 2008. J. T. Cheung and G. Stephanopoulos, "Representation of process trends - Part 1. A formal representation framework," vol. 14, no. 4/5, pp. 495­510, 1990.

[7]

[8] [9] [10] [11] [12] [13]

[14] [15] [16] [17]

128

References

[18] [19] [20]

[21]

[22]

[23] [24]

[25]

[26] [27]

[28]

[29]

[30]

[31]

[32]

Godard, "Fault Tolerant Control of Spacecraft," Ryerson University, 2010. J. J. Gertler, "Survey of Model-based Failure Detection and Isolation in Complex Plants," IEEE Control Syst. Mag., vol. 8, no. 6, pp. 3­11, Dec. 1988. J. Marzat, H. Piet-Lahanier, F. Damongeot, and E. Walter, "Model-Based Fault Diagnosis for Aerospace Systems: A Survey," Proc. Inst. Mech. Eng. Part G J. Aerosp. Eng., vol. 226, no. 10, pp. 1329­1360, Jan. 2012. Z. Gao, C. Cecati, and S. X. Ding, "A Survey of Fault Diagnosis and Fault-Tolerant Techniques Part I: Fault Diagnosis With Model-Based and Signal-Based Approaches," IEEE Trans. Ind. Electron., vol. 62, no. 6, pp. 3757­3767, Jun. 2015. Z. Gao, C. Cecati, and S. Ding, "A Survey of Fault Diagnosis and Fault-Tolerant Techniques Part II: Fault Diagnosis with Knowledge-Based and Hybrid/Active Approaches," IEEE Trans. Ind. Electron., vol. 62, no. 6, pp. 3768­3774, 2015. P. Manikandan and M. Geetha, "Takagi Sugeno Fuzzy Expert Model-Based Soft Fault Diagnosis for Two Tank Interacting System," Arch. Control Sci., vol. 24, no. 3, Jan. 2014. H. A. a Talebi, K. Khorasani, and S. Tafazoli, "A recurrent neural-network-based sensor and actuator fault detection and isolation for nonlinear systems with application to the satellite's attitude control subsystem.," IEEE Trans. Neural Netw., vol. 20, no. 1, pp. 45­ 60, Jan. 2009. I. Samy, I. Postlethwaite, and D.-W. Gu, "Sensor Fault Detection and Accommodation Using Neural Networks with Application to A Non-linear Unmanned Air Vehicle Model," Proc. Inst. Mech. Eng. Part G J. Aerosp. Eng., vol. 224, no. 4, pp. 437­447, Jan. 2010. Z. Liu and H. He, "Model-based Sensor Fault Diagnosis of a Lithium-ion Battery in Electric Vehicles," Energies, vol. 8, no. 7, pp. 6509­6527, Jun. 2015. W. Yin, W. Zhang, and X. Sun, "A SVM- Based Multiple Faults Classification Scheme Design in Flight Control FDI System," in Second International Conference on Innovative Computing, Informatio and Control (ICICIC 2007), 2007, pp. 187­187. R. T. Rausch, K. F. Goebel, N. H. Eklund, and B. J. Brunell, "Integrated in-Flight Fault Detection and Accommodation: A Model-Based Study," J. Eng. Gas Turbines Power, vol. 129, no. 4, p. 962, 2007. L. Ren, W. Lv, S. Jiang, and Y. Xiao, "Fault Diagnosis Using a Joint Model Based on Sparse Representation and SVM," IEEE Trans. Instrum. Meas., vol. 65, no. 10, pp. 2313­ 2320, Oct. 2016. R. Fujimaki, T. Yairi, and K. Machida, "An Approach to Spacecraft Anomaly Detection Problem Using Kernel Feature Space," in Proceeding of the eleventh ACM SIGKDD international conference on Knowledge discovery in data mining - KDD '05, 2005, p. 401. S. Borguet and O. Léonard, "Coupling Principal Component Analysis and Kalman Filtering Algorithms for On-line Aircraft Engine Diagnostics," Control Eng. Pract., vol. 17, no. 4, pp. 494­502, Apr. 2009. I. Trendafilova, M. P. Cartmell, and W. Ostachowicz, "Vibration-based Damage Detection in an Aircraft Wing Scaled Model Using Principal Component Analysis and Pattern Recognition," J. Sound Vib., vol. 313, no. 3­5, pp. 560­566, Jun. 2008.

129

References

[33]

[34]

[35] [36]

[37] [38]

[39] [40]

[41]

[42] [43]

[44] [45]

[46]

[47]

H. Yu, F. Khan, and V. Garaniya, "A Sparse PCA for Nonlinear Fault Diagnosis and Robust Feature Discovery of Industrial Processes," AIChE J., vol. 62, no. 5, pp. 1494­1513, May 2016. T. Jiang, K. Khorasani, and S. Tafazoli, "Parameter Estimation-Based Fault Detection, Isolation and Recovery for Nonlinear Satellite Models," IEEE Trans. Control Syst. Technol., vol. 16, no. 4, pp. 799­808, Jul. 2008. H. Ye, W. Wang, and S. Zhai, "Fault Diagnosis Based on Parameter Estimation in ClosedLoop Systems," IET Control Theory Appl., vol. 9, no. 7, pp. 1146­1153, Apr. 2015. B. Pourbabaee, N. Meskin, and K. Khorasani, "Sensor Fault Detection, Isolation, and Identification Using Multiple-Model-Based Hybrid Kalman Filter for Gas Turbine Engines," IEEE Trans. Control Syst. Technol., vol. 24, no. 4, pp. 1184­1200, Jul. 2016. A. Sidhu, A. Izadian, and S. Anwar, "Adaptive Nonlinear Model-Based Fault Diagnosis of Li-Ion Batteries," IEEE Trans. Ind. Electron., vol. 62, no. 2, pp. 1002­1011, Feb. 2015. S. Nadarajan, S. K. Panda, B. Bhangu, and A. K. Gupta, "Online Model-Based Condition Monitoring for Brushless Wound-Field Synchronous Generator to Detect and Diagnose Stator Windings Turn-to-Turn Shorts Using Extended Kalman Filter," IEEE Trans. Ind. Electron., vol. 63, no. 5, pp. 3228­3241, May 2016. K. Xiong et al., "Detection of satellite attitude sensor faults using the UKF," IEEE Trans. Aerosp. Electron. Syst., vol. 43, no. 2, pp. 480­491, Apr. 2007. H. S. Kim, S. K. Park, Y. Kim, and C. G. Park, "Hybrid Fault Detection and Isolation Method for UAV Inertial Sensor Redundancy Management System," IFAC Proc. Vol., vol. 38, no. 1, pp. 265­270, 2005. A. Rahimi, K. D. Kumar, and H. Alighanbari, "Enhanced Adaptive Unscented Kalman Filter for Reaction Wheels," IEEE Trans. Aerosp. Electron. Syst., vol. 51, no. 2, pp. 1568­ 1575, Apr. 2015. H. Liu, D. Liu, C. Lu, and X. Wang, "Fault Diagnosis of Hydraulic Servo System Using the Unscented Kalman Filter," Asian J. Control, vol. 16, no. 6, pp. 1713­1725, Nov. 2014. P. V. S. Nag, G. K. Silla, V. H. V. Gummadi, C. B. Harishankar, V. K. Ray, and C. S. Kumar, "Model Based Fault Diagnosis of Low Earth Orbiting (LEO) Satellite using Spherical Unscented Kalman Filter," IFAC-PapersOnLine, vol. 49, no. 1, pp. 635­638, 2016. I. Arasaratnam and S. Haykin, "Cubature Kalman Filters," IEEE Trans. Automat. Contr., vol. 54, no. 6, pp. 1254­1269, Jun. 2009. K. Tidriri, N. Chatti, S. Verron, and T. Tiplica, "Bridging data-driven and model-based approaches for process fault diagnosis and health monitoring: A review of researches and future challenges," Annu. Rev. Control, vol. 42, pp. 63­81, 2016. M. Vale, R. Martins, and A. Maitelli, "Hybrid Method for Fault Detection and Identi cation Based on State Observers and Decision Trees," J. Eur. des Systèmes Autom., vol. 48, no. 1­3, pp. 185­210, May 2014. J. D. Boskovic, S. M. Li, and R. K. Mehra, "Intelligent control of spacecraft in the presence of actuator failures," in 38th IEEE Conference on Decision and Control, 1999, vol. 5, pp.

130

References

[48]

[49] [50]

[51]

[52] [53] [54]

[55]

[56]

[57]

[58]

[59]

[60]

[61]

[62]

4472­4477. N. Tudoroiu, K. Khorasani, and K. K. N. Tudoroiu, "Satellite fault diagnosis using a bank of interacting Kalman filters," Aerosp. Electron. Syst. IEEE Trans., vol. 43, no. 4, pp. 1334­1350, Oct. 2007. H. Azarnoush and K. Khorasani, "Fault detection in spacecraft attitude control system," in IEEE International Conference on Systems, Man and Cybernetics, 2007, pp. 726­733. W. Chen and M. Saif, "Observer-Based Fault Diagnosis of Satellite Systems Subject to Time-Varying Thruster Faults," J. Dyn. Syst. Meas. Control, vol. 129, no. 3, pp. 352­356, May 2007. L. M. Z. Q. Li, K. Khorasani, Z. Q. Li, and L. Ma, "A Dynamic Neural Network-based Reaction Wheel Fault Diagnosis for Satellites," in 2006 International Joint Conference on Neural Networks, 2006, pp. 3714­3721. E. Sobhani-Tehrani and K. Khorasani, Fault Diagnosis of Nonlinear Systems Using a Hybrid Approach, vol. 383. Springer, 2009. V. Venkatasubramanian and R. Vaidyanathan, "Diagnosing noisy process data using neural networks," IFAC/IMACS Symp. Fault Detect., no. 6, pp. 547­552, 1991. J. Wong, K. McDonald, and A. Palazoglu, "Classification of process trends based on fuzzified symbolic representation and hidden Markov models," J. Process Control, vol. 8, no. 5, pp. 395­408, 1998. J. B. MacQueen, "Some methods for classification and analysis of multivariate observations," in Berkeley Symposium on Mathematical Statistics and Probability, 1967, vol. 1, pp. 281­297. V. Venkatasubramanian, R. Rengaswamy, K. Yin, S. N. Kavuri, and K. Yin, "A review of process fault detection and diagnosis," Comput. Chem. Eng., vol. 27, no. 3, pp. 293­311, Mar. 2003. V. Venkatasubramanian, R. Rengaswamy, and S. N. Kavuri, "A review of process fault detection and diagnosis: Part II: Qualitative models and search strategies," Comput. Chem. Eng., vol. 27, no. 3, pp. 313­326, 2003. S. Mousavi and K. Khorasani, "Fault detection of reaction wheels in attitude control subsystem of formation flying satellites: A dynamic neural network-based approach," Int. J. Intell. Unmanned Syst., vol. 2, no. 1, pp. 2­26, 2014. A. Barua and K. Khorasani, "Hierarchical Fault Diagnosis and Fuzzy Rule-Based Reasoning for Satellites Formation Flight," IEEE Trans. Aerosp. Electron. Syst., vol. 47, no. 4, pp. 2435­2456, 2011. Y.-C. Choi, J.-H. Son, and H.-S. Ahn, "Fault detection and isolation for a small CMGbased satellite: A fuzzy Q-learning approach," Aerosp. Sci. Technol., vol. 47, pp. 340­355, Dec. 2015. R. Wang, X. Gong, M. Xu, and Y. Li, "Fault detection of flywheel system based on clustering and principal component analysis," Chinese J. Aeronaut., vol. 28, no. 6, pp. 1676­1688, 2015. D. Hu, A. Sarosh, and Y.-F. F. Dong, "A novel KFCM based fault diagnosis method for

131

References

[63]

[64]

[65]

[66] [67]

[68] [69]

[70] [71] [72]

[73]

[74]

[75]

[76]

unknown faults in satellite reaction wheels," ISA Trans., vol. 51, no. 2, pp. 309­316, Mar. 2012. A. Barua and K. Khorasani, "Verification and Validation of Hierarchical Fault Diagnosis in Satellites Formation Flight," IEEE Trans. Syst. Man, Cybern. Part C (Applications Rev., vol. 42, no. 6, pp. 1384­1399, Nov. 2012. A. Joshi, V. Gavriloiu, A. Barua, A. Garabedian, P. Sinha, and K. Khorasani, "Intelligent and learning-based approaches for health monitoring and fault diagnosis of RADARSAT-1 attitude control system," in 2007 IEEE International Conference on Systems, Man and Cybernetics, 2007, pp. 3177­3183. X. Li, Q. Zhang, and H. Su, "An adaptive observer for joint estimation of states and parameters in both state and output equations," Int. J. Adapt. Control Signal Process., vol. 25, no. 9, pp. 831­842, Sep. 2011. R. Zhan and J. Wan, "Iterated Unscented Kalman Filter for Passive Target Tracking," IEEE Trans. Aerosp. Electron. Syst., vol. 43, no. 3, pp. 1155­1163, Jul. 2007. F. Campillo and V. Rossi, "Convolution Particle Filter for Parameter Estimation in General State-Space Models," IEEE Trans. Aerosp. Electron. Syst., vol. 45, no. 3, pp. 1063­1072, Jul. 2009. S. Yin and X. Zhu, "Intelligent Particle Filter and Its Application on Fault Detection of Nonlinear System," IEEE Trans. Ind. Electron., vol. 62, no. 6, pp. 1­1, 2015. N. Meskin and K. Khorasani, "Fault Detection and Isolation of discrete-time Markovian jump linear systems with application to a network of multi-agent systems having imperfect communication channels," Automatica, vol. 45, no. 9, pp. 2032­2040, Sep. 2009. N. B. Hoang and H. J. Kang, "A model-based fault diagnosis scheme for wheeled mobile robots," Int. J. Control. Autom. Syst., vol. 12, no. 3, pp. 637­651, 2014. K. Kolcio and L. Fesq, "Model-based off-nominal state isolation and detection system for autonomous fault management," IEEE Aerosp. Conf. Proc., vol. 2016­June, 2016. A. Rosich, R. Sarrate, and F. Nejjari, "On-line model-based fault detection and isolation for PEM fuel cell stack systems," Appl. Math. Model., vol. 38, no. 11­12, pp. 2744­2757, 2014. Q. N. Xu, K. M. Lee, H. Zhou, and H. Y. Yang, "Model-Based Fault Detection and Isolation Scheme for a Rudder Servo System," IEEE Trans. Ind. Electron., vol. 62, no. 4, pp. 2384­ 2396, 2015. Y. Cheng, R. Wang, and M. Xu, "A Combined Model-Based and Intelligent Method for Small Fault Detection and Isolation of Actuators," IEEE Trans. Ind. Electron., vol. 63, no. 4, pp. 2403­2413, 2016. Tao Jiang and K. Khorasani, "A fault detection, isolation and reconstruction strategy for a satellite's attitude control subsystem with redundant reaction wheels," in 2007 IEEE International Conference on Systems, Man and Cybernetics, 2007, pp. 3146­3152. B. Bialke, "High Fidelity Mathematical Modeling of Reaction Wheel Performance," in 1998 Annual AAS Rocky Mountain Guidance and Control Conference, Advances in the Astronautical Sciences, 1998, pp. 483­496.

132

References

[77]

[78]

[79]

[80]

[81]

[82]

[83]

[84]

[85]

[86]

[87]

[88]

[89]

[90]

N. Meskin and K. Khorasani, "Fault detection and isolation in a redundant reaction wheels configuration of a satellite," Conf. Proc. - IEEE Int. Conf. Syst. Man Cybern., no. 1, pp. 3153­3158, 2007. N. Meskin, E. Naderi, and K. Khorasani, "A Multiple Model-Based Approach for Fault Diagnosis of Jet Engines," IEEE Trans. Control Syst. Technol., vol. 21, no. 1, pp. 254­262, Jan. 2013. S. M. Azizi and K. Khorasani, "A distributed Kalman filter for actuator fault estimation of deep space formation flying satellites," in 2009 3rd Annual IEEE Systems Conference, 2009, pp. 354­359. N. Meskin and K. Khorasani, "Fault Detection and Isolation of Actuator Faults in Spacecraft Formation Flight," in Proceedings of the 45th IEEE Conference on Decision and Control, 2006, pp. 1159­1164. S. M. Azizi and K. Khorasani, "A Hierarchical Architecture for Cooperative Actuator Fault Estimation and Accommodation of Formation Flying Satellites in Deep Space," IEEE Trans. Aerosp. Electron. Syst., vol. 48, no. 2, pp. 1428­1450, 2012. S. Ghasemi and K. Khorasani, "Fault detection and isolation of the attitude control subsystem of spacecraft formation flying using extended Kalman filters," Int. J. Control, vol. 88, no. 10, pp. 2154­2179, Oct. 2015. I. Shames, A. M. H. Teixeira, H. Sandberg, and K. H. Johansson, "Distributed fault detection for interconnected second-order systems," Automatica, vol. 47, no. 12, pp. 2757­ 2764, Dec. 2011. K. Zhang, G. Liu, and B. Jiang, "Robust Unknown Input Observer-Based Fault Estimation of Leader­Follower Linear Multi-agent Systems," Circuits, Syst. Signal Process., vol. 36, no. 2, pp. 525­542, Feb. 2017. M. Chadli, M. Davoodi, and N. Meskin, "Distributed state estimation, fault detection and isolation filter design for heterogeneous multi-agent linear parameter-varying systems," IET Control Theory Appl., vol. 11, no. 2, pp. 254­262, Jan. 2017. D. An, N. H. Kim, and J. H. Choi, "Practical options for selecting data-driven or physicsbased prognostics algorithms with reviews," Reliab. Eng. Syst. Saf., vol. 133, pp. 223­236, 2015. L. Liao and F. Kottig, "Review of Hybrid Prognostics Approaches for Remaining Useful Life Prediction of Engineered Systems, and an Application to Battery Life Prediction," IEEE Trans. Reliab., vol. 63, no. 1, pp. 191­207, Mar. 2014. L. Liao and F. Köttig, "A hybrid framework combining data-driven and model-based methods for system remaining useful life prediction," Appl. Soft Comput., vol. 44, pp. 191­ 199, Jul. 2016. B. Bole, C. S. Kulkarni, and M. Daigle, "Adaptation of an Electrochemistry-based Li-Ion Battery Model to Account for Deterioration Observed Under Randomized Use," Annu. Conf. Progn. Heal. Manag. Soc., pp. 1­9, 2014. L. Datong, P. Jingyue, Z. Jianbao, and P. Yu, "Data-driven prognostics for lithium-ion battery based on Gaussian Process Regression," Progn. Syst. Heal. Manag. (PHM), 2012

133

References

[91]

[92]

[93]

[94] [95]

[96]

[97]

[98]

[99]

[100]

[101]

[102]

[103] [104]

IEEE Conf., pp. 1­5, 2012. D. Liu, Y. Luo, Y. Peng, X. Peng, and M. Pecht, "Lithium-ion Battery Remaining Useful Life Estimation Based on Nonlinear AR Model Combined with Degradation Feature," Annu. Conf. Progn. Heal. Manag. Soc. 2012, pp. 1­7, 2012. B. E. Olivares, M. A. Cerda Munoz, M. E. Orchard, and J. F. Silva, "Particle-FilteringBased Prognosis Framework for Energy Storage Devices With a Statistical Characterization of State-of-Health Regeneration Phenomena," IEEE Trans. Instrum. Meas., vol. 62, no. 2, pp. 364­376, Feb. 2013. B. Saha, K. Goebel, and J. Christophersen, "Comparison of prognostic algorithms for estimating remaining useful life of batteries," Trans. Inst. Meas. Control, vol. 31, no. 3­4, pp. 293­308, 2009. B. Saha and K. Goebel, "Modeling Li-ion battery capacity depletion in a particle filtering framework," Proc. Annu. Conf. Progn. Heal. Manag. Soc., pp. 2909--2924, 2009. J. Zhou, D. Liu, Y. Peng, and X. Peng, "Dynamic battery remaining useful life estimation: An on-line data-driven approach," 2012 IEEE I2MTC - Int. Instrum. Meas. Technol. Conf. Proc., pp. 2196­2199, 2012. T. Van Tung, B.-S. Yang, V. T. Tran, and B.-S. Yang, "Machine Fault Diagnosis and Prognosis: The State of The Art," Int. J. Fluid Mach. Syst., vol. 2, no. 1, pp. 61­71, Mar. 2009. C. Ciandrini, M. Gallieri, A. Giantomassi, G. Ippoliti, and S. Longhi, "Fault detection and prognosis methods for a monitoring system of rotating electrical machines," in 2010 IEEE International Symposium on Industrial Electronics, 2010, pp. 2085­2090. G. Jin, Q. Liu, J. Zhou, and Z. Zhou, "RePofe: Reliability physics of failure estimation based on stochastic performance degradation for the momentum wheel," Eng. Fail. Anal., vol. 22, pp. 50­63, 2012. M. Rocchi et al., "Fault prognosis for rotating electrical machines monitoring using recursive least square," EDERC 2014 - Proc. 6th Eur. Embed. Des. Educ. Res. Conf., pp. 269­273, 2014. C. Lu, Z. Y. Wang, W. L. Qin, and J. Ma, "Fault diagnosis of rotary machinery components using a stacked denoising autoencoder-based health state identification," Signal Processing, vol. 130, pp. 377­388, 2017. W. Abed, S. Sharma, R. Sutton, and A. Motwani, "A Robust Bearing Fault Detection and Diagnosis Technique for Brushless DC Motors Under Non-stationary Operating Conditions," J. Control. Autom. Electr. Syst., vol. 26, no. 3, pp. 241­254, 2015. W. Ahmad, S. Ali Khan, and J.-M. Kim, "Estimating the remaining useful life of bearings using a neuro-local linear estimator-based method," J. Acoust. Soc. Am., vol. 141, no. 5, p. EL452-EL457, 2017. W. Jingfu, H. Zheng, Q. Li, H. Wu, and B. Zhou, "Prognostic for On-orbit Satellite Momentum Wheel Based on the Similitude Method," 2015. E. Zio and F. Di Maio, "A data-driven fuzzy approach for predicting the remaining useful life in dynamic failure scenarios of a nuclear system," Reliab. Eng. Syst. Saf., vol. 95, no.

134

References

[105]

[106]

[107] [108] [109] [110] [111] [112]

[113]

[114]

[115]

[116]

[117]

[118]

[119] [120]

1, pp. 49­57, 2010. T. Wang, J. Yu, D. Siegel, and J. Lee, "A similarity-based prognostics approach for remaining useful life estimation of engineered systems," 2008 Int. Conf. Progn. Heal. Manag. PHM 2008, no. November, 2008. H. Li, G. Jin, J. Zhou, and B. Zhou, "Bayesian Network Reliability Modeling and Assessment of Momentum Wheel on Orbit," Acta Aeronaut. Astronaut. Sin., vol. 30, no. 6, pp. 1084­1089, 2009. X. Hao, "Life prediction of satellite key components based on RVM-PF," National Defense University of Science and Technology, 2011. Y. W. Fan, X. L. Yang, C. W. Li, and T. Qing, "Experimental research on the momentum wheel failure physical model," Chinese J. Sp. Sci., vol. 29, no. 1, pp. 78­86, 2009. S. S. Bisht and M. P. Singh, "An Adaptive Unscented Kalman Filter for Tracking Sudden Stiffness Changes," Mech. Syst. Signal Process., vol. 49, no. 1­2, pp. 181­195, 2014. L. Losik and D. Ph, "Using the Prognostic Health Management Program on the Air Force Next Generation Reusable Launch Vehicle," pp. 1­20, 2012. "Research and Technology Goals and Objectives for Integrated Vehicle Health Management (IVHM)," Washington, DC, 1992. M. Schwabacher, J. Samuels, and L. Brownston, "The NASA integrated vehicle health management technology experiment for X-37," Proc. SPIE - Int. Soc. Opt. Eng., vol. 4733, pp. 49­60, 2002. P. Johnson, S.B., Gormley, T., Kessler, S., Mott, C., Patterson-Hine, A., Reichard, K. and Scandura Jr, System health management: with aerospace applications. John Wiley & Sons, 2011. S. Li, M. Zhong, and Y. Zhao, "Estimation and compensation of unknown disturbance in three-axis gyro-stabilized camera mount," Trans. Inst. Meas. Control, vol. 37, no. 6, pp. 732­745, Jul. 2015. H. Gui, L. Jin, S. Xu, and J. Zhang, "On the attitude stabilization of a rigid spacecraft using two skew control moment gyros," Nonlinear Dyn., vol. 79, no. 3, pp. 2079­2097, Feb. 2015. F. Zhang, L. Jin, and S. Xu, "Fault Tolerant Attitude Control for spacecraft with SGCMGs under actuator partial failure and actuator saturation," Acta Astronaut., vol. 132, no. September 2016, pp. 303­311, 2017. A. Noumi, H. Misuzu, T. Kanzawa, and M. Takahashi, "Fault-Tolerant Attitude Control System for a Spacecraft with Control Moment Gyros Using Multi-Objective Optimization," Int. J. Adv. Comput. Sci. Appl., vol. 6, no. 1, pp. 40­48, 2015. L. Jin and S. Xu, "Fault Tolerant Attitude Control for Small Satellites Using Single Gimbal Control Moment Gyros and Magnetic Torquers," J. Aerosp. Eng., vol. 28, no. 3, p. 4014079, May 2015. Y. Yoshimura, "Optimal Fault-Tolerant Configurations of Control Moment Gyros," J. Guid. Control. Dyn., vol. 38, no. 12, pp. 2460­2467, Dec. 2015. B. Wie, D. Bailey, and C. Heiberg, "Singularity robust steering logic for redundant single-

135

References

[121]

[122]

[123]

[124]

[125]

[126] [127] [128] [129] [130]

[131]

[132]

[133]

[134]

[135]

gimbal control moment gyros," J. Guid. Control. Dyn., vol. 24, no. 5, pp. 865­872, 2001. H. Chang, W. Jiao, Q. Fu, J. Xie, and W. Yuan, "Design and Simulation of a MEMS Control Moment Gyroscope for the Sub-Kilogram Spacecraft," Sensors, vol. 10, no. 4, pp. 4130­4144, Apr. 2010. S. Beck, J. Kim, and H. Oh, "Identification of Control Moment Gyro Faults on Noisy Sensor Data," Recent Adv. Syst. Signals, Control. Commun. Comput. Identif., no. 2, pp. 298­303. H. Oh and J. Kim, "The Detection and Identification of Control Moment Gyro Faults," in Second IAA Conference on Dynamics and Control of Space Systems 2014, DyCoSS'2014, 2015, pp. 1­10. J. Li and K. D. Kumar, "Decentralized fuzzy fault tolerant control for multiple satellites attitude synchronization," in 2011 IEEE International Conference on Fuzzy Systems (FUZZ-IEEE 2011), 2011, pp. 1836­1843. D. Fragopoulos and M. Innocenti, "Stability considerations in quaternion attitude control using discontinuous Lyapunov functions," IEE Proc. - Control Theory Appl., vol. 151, no. 3, pp. 253­258, May 2004. P. Tsiotras, H. Shen, and C. Hall, "Satellite Attitude Control and Power Tracking with Energy/Momentum Wheels," J. Guid. Control. Dyn., vol. 24, no. 1, pp. 23­34, Jan. 2001. P. C. Hughes, Spacecraft Attitude Dynamics. Mineola, New York: Dover Publiocation Inc., 2004. A. H. J. De Ruiter, C. J. Damaren, and J. R. Forbes, Spacecraft Dynamics and Control An Introduction, 1st ed. John Wiley & Sons Ltd., 2013. H. Schaub and J. L. Junkins, "Analytical Mechanics of Space Systems," AIAA Educ. Ser., p. 11,34,37,112,113, 2003. W. Cai, X. Liao, and D. Y. Song, "Indirect Robust Adaptive Fault -Tolerant Control for Attitude Tracking of Spacecraft," J. Guid. Control. Dyn., vol. 31, no. 5, pp. 1456­1463, Sep. 2008. D. P. Scharf, F. Y. Hadaegh, and S. R. Ploen, "A survey of spacecraft formation flying guidance and control. Part II: control," Proc. 2004 Am. Control Conf., vol. 4, no. Part 11, pp. 2976­2985, 2004. D. P. Scharf, F. Y. Hadaegh, and S. R. Ploen, "A Survey of Spacecraft Formation Flying Guidance and Control (Part I): Guidance," Proc. 2003 Am. Control Conf., no. Part I, pp. 1733­1739, 2003. D. P. Scharf, F. Y. Hadaegh, and S. R. Ploen, "A Survey of Spacecraft Formation Flying Guidance and Control (part I): Guidance," in American Control Conference, 2013, pp. 1733­1739. Wei Ren and R. W. Beard, "A decentralized scheme for spacecraft formation flying via the virtual structure approach," in Proceedings of the 2003 American Control Conference, 2003., 2003, vol. 2, no. 1, pp. 1746­1751. C. H. Bong Wie David Bailey, "Singularity Robust Steering Logic for Redundant SingleGimbal Control Moment Gyros," J. Guid. Control, vol. 24, no. 5, pp. 865­872, 2001.

136

References

[136] R. Van der Merwe and E. Wan, "The Square-Root Unscented Kalman Filter for State and Parameter-Estimation," in 2001 IEEE International Conference on Acoustics, Speech, and Signal Processing. Proceedings (Cat. No.01CH37221), 2001, vol. 6, pp. 3461­3464. [137] J. H. Gove and D. Y. Hollinger, "Application of a Dual Unscented Kalman Filter for Simultaneous State and Parameter Estimation in Problems of Surface-Atmosphere Exchange," J. Geophys. Res., vol. 111, no. D8, p. D08S07, 2006. [138] J. Zhou, S. Knedlik, and O. Loffeld, "INS/GPS Tightly-Coupled Integration Using Adaptive Unscented Particle Filter," J. Navig., vol. 63, no. 3, pp. 491­511, Jul. 2010. [139] A. Doucet, N. Freitas, and N. Gordon, "An Introduction to Sequential Monte Carlo Methods," in Sequential Monte Carlo Methods in Practice, New York, NY: Springer New York, 2001, pp. 3­14. [140] A. Doucet, S. Godsill, and C. Andrieu, "On sequential Monte Carlo sampling methods for Bayesian filtering," Stat. Comput., vol. 10, no. 3, pp. 197­208, 2000. [141] N. J. Gordon, D. J. Salmond, and A. F. M. Smith, "Novel approach to nonlinear/nonGaussian Bayesian state estimation," IEE Proc. F Radar Signal Process., vol. 140, no. 2, p. 107, 1993. [142] J. MacCormick and A. Blake, "A probabilistic exclusion principle for tracking multiple objects," in Proceedings of the Seventh IEEE International Conference on Computer Vision, 1999, pp. 572­578 vol.1. [143] J. Carpenter, P. Clifford, and P. Fearnhead, "Improved particle filter for nonlinear problems," IEE Proc. - Radar, Sonar Navig., vol. 146, no. 1, p. 2, 1999. [144] D. Crisan, P. Del Moral, and T. Lyons, "Discrete filtering using branching and interacting particle systems," Markov Process. Relat. Fields, vol. 5, no. 3, pp. 293­319, 1999. [145] K. Kanazawa, D. Koller, and S. Russell, "Stochastic simulation algorithms for dynamic probabilistic networks," Proc. Elev. Annu. Conf. Uncertain. AI, pp. 346­351, 1995. [146] M. S. Arulampalam, S. Maskell, N. Gordon, and T. Clapp, "A tutorial on particle filters for online nonlinear/non-Gaussian Bayesian tracking," IEEE Trans. Signal Process., vol. 50, no. 2, pp. 174­188, 2002. [147] N. Bergman, "Recursive Bayesian Estimation: Navigation and Tracking Applications," Linkoping University, 1999. [148] J. S. Liu and R. Chen, "Sequential Monte Carlo Methods for Dynamic Systems," J. Am. Stat. Assoc., vol. 93, no. 443, pp. 1032­1044, Sep. 1998. [149] G. Kitagawa, "Monte Carlo filter and smoother for non-Gaussian nonlinear state space models," J. Comput. Graph. Stat., vol. 5, no. 1, pp. 1­25, 1996. [150] W. R. Gilks and C. Berzuini, "Following a moving target-Monte Carlo inference for dynamic Bayesian models," J. R. Stat. Soc. Ser. B (Statistical Methodol., vol. 63, no. 1, pp. 127­146, Feb. 2001. [151] F. Martinerie and P. Forster, "Data association and tracking using hidden Markov models and dynamic programming," in [Proceedings] ICASSP-92: 1992 IEEE International Conference on Acoustics, Speech, and Signal Processing, 1992, pp. 449­452 vol.2. [152] S. Godsill and T. Clapp, "Improvement Strategies for Monte Carlo Particle Filters," in

137

References

[153]

[154] [155]

[156] [157] [158] [159] [160] [161]

[162] [163] [164] [165]

[166]

[167]

[168]

Sequential Monte Carlo Methods in Practice, New York, NY: Springer New York, 2001, pp. 139­158. N. Oudjane and C. Musso, "Progressive correction for regularized particle filters," in Proceedings of the Third International Conference on Information Fusion, 2000, p. THB2/10-THB2/17 vol.2. M. K. Pitt and N. Shephard, "Filtering via simulation: Auxiliary particle filters," J. Am. Stat. Assoc., vol. 94, no. 446, pp. 590­599, 1999. C. Musso, N. Oudjane, and F. Gland, "Improving Regularised Particle Filters," in Sequential Monte Carlo Methods in Practice, New York, NY: Springer New York, 2001, pp. 247­271. S. V. Stehman, "Selecting and interpreting measures of thematic classification accuracy," Remote Sens. Environ., vol. 62, no. 1, pp. 77­89, Oct. 1997. T. Fawcett, "An introduction to ROC analysis," Pattern Recognit. Lett., vol. 27, no. 8, pp. 861­874, Jun. 2006. E. W. Grafarend, Linear and Nonlinear Models: Fixed Effects, Random Effects, and Mixed Models. Berlin: Walter de Gruyter, 2006. K. Xiong, H. Y. Zhang, and C. W. Chan, "Performance evaluation of UKF-based nonlinear filtering," Automatica, vol. 42, no. 2, pp. 261­270, Feb. 2006. K. Reif and R. Unbehauen, "The extended Kalman filter as an exponential observer for nonlinear systems," IEEE Trans. Signal Process., vol. 47, no. 8, pp. 2324­2328, 1999. A. Farina, B. Ristic, and D. Benvenuti, "Tracking a ballistic target: comparison of several nonlinear filters," IEEE Trans. Aerosp. Electron. Syst., vol. 38, no. 3, pp. 854­867, Jul. 2002. M. B. Rhudy, "Sensitivity and Stability Analysis of Nonlinear Kalman Filters with Application to Aircraft Attitude Estimation," West Virginia, 2013. C. F. Van Loan, Introduction to Scientific Computing: A Matrix-Vector Approach Using Matlab, 2nd ed. Upper Saddle River, New Jersey: Prentice-Hall, 2000. M. D. Griffin and J. R. French, Space Vehicle Design, 2nd ed. Blacksburg, Visrginia, US: American Institute of Aeronautics and Astronautics, 2004. M. M. Carrasco and A. L. da Silva, "Attitude Determination for Low Cost IMU and Processor Board using the Methods of TRIAD , Kalman Filter and Allan Variance," BRAZILIAN J. Sci. Initiat., vol. 3, no. 2, pp. 26­41, 2016. M. Staroswiecki and N. E. Wu, Eds., Fault Detection, Supervision and Safety of Technical Processes 2003 (SAFEPROCESS 2003): A Proceedings Volume from the 5th IFAC Symposium, Washington, D.C., USA, 9-11 June 2003, Volume 1. Washington, DC: Elsevier, 2004. V. Kumar and H. B. Hablani, "Autonomous Formation Keeping of Geostationary Satellites with Regional Navigation Satellites and Dynamics," J. Guid. Control. Dyn., vol. 40, no. 3, pp. 563­583, Mar. 2017. H. B. Hablani, "Imaging Sensors Pointing and Tracking Controller Insensitive to Inertial Sensors Misalignments," J. Guid. Control. Dyn., vol. 31, no. 4, pp. 980­990, Jul. 2008.

138

References

[169] A. Rahimi, K. D. Kumar, and H. Alighanbari, "Fault estimation of satellite reaction wheels using covariance based adaptive unscented Kalman filter," Acta Astronaut., vol. 134, pp. 159­169, May 2017. [170] C. Bishop, Pattern Recognition and Machine Learning. New York, NY, USA: SpringerVerlag, 2006. [171] E. Naderi, "Fault Diagnosis and Estimation of Dynamical Systems with Application to Gas Turbines," Concordia University, 2016. [172] K. E. Arkinson, An Introduction to Numerical Analysis, 2nd ed. New York, NY, USA: John Wiley & Sons, 1989. [173] V. Nguyen, J. Seshadrinath, D. Wang, S. Nadarajan, and V. Vaiyapuri, "Model-Based Diagnosis and RUL Estimation of Induction Machines Under Interturn Fault," IEEE Trans. Ind. Appl., vol. 53, no. 3, pp. 2690­2701, May 2017. [174] V. Carrara and H. K. Kuga, "Estimating Friction Parameters in Reaction Wheels for Attitude Control," Math. Probl. Eng., vol. 2013, pp. 1­8, 2013. [175] A. Y. Lee and E. K. Wang, "In-Flight Performance of Cassini Reaction Wheel Bearing Drag in 1997­2013," J. Spacecr. Rockets, vol. 52, no. 2, pp. 470­480, Mar. 2015. [176] J. M. Hacker, J. Ying, and P. C. Lai, "Reaction Wheel Friction Telemetry Data Processing Methodology and On-Orbit Experience," J. Astronaut. Sci., vol. 62, no. 3, pp. 254­269, 2015. [177] R. E. Kalman, "A New Approach to Linear Filtering and Prediction Problems," J. Basic Eng., vol. 82, no. 1, p. 35, 1960. [178] M. Jouin, R. Gouriveau, D. Hissel, M.-C. Péra, and N. Zerhouni, "Particle filter-based prognostics: Review, discussion and perspectives," Mech. Syst. Signal Process., vol. 72­73, pp. 2­31, May 2016. [179] D. An, J.-H. Choi, T. L. Schmitz, and N. H. Kim, "In situ monitoring and prediction of progressive joint wear using Bayesian statistics," Wear, vol. 270, no. 11­12, pp. 828­838, May 2011. [180] D. An, J.-H. Choi, and N. H. Kim, "Identification of correlated damage parameters under noise and bias using Bayesian inference," Struct. Heal. Monit., vol. 11, no. 3, pp. 293­303, May 2012. [181] S. J. Payne, "A Bayesian approach for the estimation of model parameters from noisy data sets," IEEE Signal Process. Lett., vol. 12, no. 8, pp. 553­556, Aug. 2005. [182] J. M. Hacker, J. Ying, and P. C. Lai, "Reaction Wheel Friction Telemetry Data Processing Methodology and On-Orbit Experience," J. Astronaut. Sci., vol. 62, no. 3, pp. 254­269, Sep. 2015. [183] D. An, J. H. Choi, and N. H. Kim, "Prognostics 101: A tutorial for particle filter-based prognostics algorithm using Matlab," Reliab. Eng. Syst. Saf., vol. 115, no. July, pp. 161­ 169, 2013. [184] D. Crisan and A. Doucet, "A survey of convergence results on particle filtering methods for practitioners," IEEE Trans. Signal Process., vol. 50, no. 3, pp. 736­746, Mar. 2002. [185] R. A. Fisher, Statistical methods for research workers, Fifth., no. V. Edinburgh, UK: Oliver

139

References

and Boyd, 1925. [186] J. Neyman, E. S. Pearson, and G. U. Yule, "The testing of statistical hypotheses in relation to probabilities a priori," Math. Proc. Cambridge Philos. Soc., vol. 29, no. 4, p. 492, Oct. 1933.

140

