Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2008

Synthetic Aperture Imaging : Applications In HighFrequency Ultrasound
Nazanin Nayebi
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Other Physics Commons Recommended Citation
Nayebi, Nazanin, "Synthetic Aperture Imaging : Applications In High-Frequency Ultrasound" (2008). Theses and dissertations. Paper 1164.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

SYNTHETIC APERTURE IMAGING: APPLICATIONS IN HIGH-FREQUENCY ULTRASOUND
By

Nazanin Nayebi B.Eng, Sahand University of Technology, Iran, 2001

A thesis presented to Ryerson University in partial fulfillment of the requirements for the degree of Master of Science

in the Program of Biomedical Physics

Toronto, Ontario, Canada, 2008 ©Nazanin Nayebi, 2008

PROPERTY OF RYERSON UNIVERSITY LIBRARY

Author's Declaration
I hereby declare that I am the sole author of this thesis. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

11

SYNTHETIC APERTUR IMAGING: APPLICATIONS IN HIGH-FREQUENCY ULTRASOUND
Nazanin Nayebi, M.Sc., Biomedical Physics, Ryerson University, Toronto, 2008

Abstract
Synthetic Aperture (SA) is an imaging method that uses the motion of a single-element transducer to synthesize the effect of a larger array transducer. In synthetic aperture ultrasound imaging (SAUl), a single-element transducer which works as both the transmitter and receiver is used to record pulse echoes in a region of interest at multiple, sequential locations. The SA imaging inverse problem is the processing of these signals to form a highresolution image of the ROI. The aim of this project is to implement SAUl in the frequency domain and incorporate the effects of the beam pattern into image reconstruction algorithm. The images reconstructed applying the new SA algorithms to the simulated and experimental data demonstrate the effectiveness of some of the proposed methods in improving the lateral resolution beyond the focal point. The principles, simulated and experimental results, and implementation issues of the new algorithms are described in this thesis.

111

Acknowledgements
I would like to thank my supervisor, Dr. Carl Kumaradas for his support, friendship,

availability and wise guidance throughout this project. I could not have asked to work with a better supervisor.
I would like to extend my most heartfelt gratitude to Dr. Pedro Goldman, our chair,

for his encouragement and inspiration. I could never thank him enough for the impact he has made in my life. Many thanks to Dr. Victor Yang, my other supervisor, for many insightful discussions during our few, but helpful meetings.
I would like to thank Dr. Michael Kolios, my advisory committee member for his

valuable comments on my project and editing this thesis. Thanks to Dr. Yuan Xu for honouring me by accepting to serve In my exam committee. My thanks also go to my friends at the Physics Department, Sara, Kanakam, Ahmed, Matthew, Eli, Robin and Sayed for all the support and fun. I am very grateful to my first friend at Ryerson, Omar for his kindness and cheerful help. My special thanks to my parents, for having faith in me when I did not yet have faith in myself. Without them, I would never have dreamed I could accomplish this work. Further more, I would like to thank my friend Sheida for being a sister to me all this time and many thanks to Pedram for always being there for me whenever I needed someone.

IV

Table of Contents
Author's Declaration .............................................................................................................. ii Abstract ................................................................................................................................... iii Acknowledgements ................................................................................................................ iv Table of Contents .................................................................................................................... v List of Tables .......................................................................................................................... ix List of Figures .......................................................................................................................... x Chapter 1 Introduction ........................................................................................................... 1
1.1 High-frequency ultrasound imaging' s role in medicine .................................................. 1 1.2 Beamforming in ultrasound imaging .............................................................................. 3 1.2.1 Single element transducers ............................................................................. .......... 3 1.2.2 Array transducers ...................................................................................................... 3 1.3 Resolution issues in single-element imaging .................................................................. 4 1.4 Synthetic aperture imaging in Radar ............................................................................... 5 1.4.1 History ...................................................................... .. .. ... ......................................... 5 1.5 Synthetic aperture imaging in Ultrasound ....................................................................... 7 1.5.1 History ...................................................................................................................... 7 1.6 Hypothesis ..................................................................................................................... 10 1.7 Outline of the thesis .... ................................................. ... ............................. .. ................ 11

Chapter 2 Acoustic background .......................................................................................... 12
2.1 Ultrasound wave propagation .......................................... .............................................. 12 2.1.1 Wave equation ........................................................................................................ 12 2.1.2 Solutions to the wave equation ............................................................................... 13 2.1.3 Theory of radiation and diffraction ........................................................................ 15 2.1 .4 Attenuation ............................................................................................................. 15

Chapter 3 Ultrasound Imaging Theory .............................................................................. 16
3.1 Fundamentals of ultrasound imaging ............................................................................ 16 3.1.1 A-mode scan ............................ ............................................................. ... ............... 16
v

3.1.2B-modescan ........................................................................................................... 17 3.2 Image quality factors ..................................................................................................... 18 3 .2.1 Spatial resolution .................................................................................................... 19 3.2.2 Contrast ................................................................................................................... 19 3.2.3 Signal-to-noise ratio (SNR) .................................................................................... 19 3.3 Conventional ultrasound imaging ................................................................................. 20 3.3 .1 Gain compensation ................................................................................................. 21 3.3.2 Logarithmic compression ...... ................................................................................. 21 3.3.3 Scan conversion and interpolation .......................................................................... 22 3.4 Synthetic aperture imaging ............................................................................................ 24 3 .4.1 The region-of-interest ............................................................................................. 25 3.4.2 Point transducer assumption ................................................................................... 25 3.4.3 Image reconstruction: Point transducer .................................................................. 27 3 .4.4 Finite aperture effect ............................................................................................... 31 3.4.5 Transducer beam pattern ........................................................................................ 32 3.4.6 Scanning to create a synthetic aperture .................................................................. 37 3.4.7 Transmit-Receive mode beam pattern .................................................................... 38 3.4.8 Image reconstruction considering beam pattern effects ......................................... 39 3.4.9 Resolution ............................................................................................................... 40 3.5 Frequency domain representation of an ultrasonic imaging system ............................. 50 3.6 Synthetic aperture reconstruction via deconvolution .................................................... 54 3.7 Synthetic aperture reconstruction via the virtual point method .................................... 55 3.8 Synthetic aperture reconstruction via the virtual line method ....................................... 56 3.9 Summary ....................................................................................................................... 57

Chapter 4 Methods ............................................................................................................... 59
4.1 Simulations .................................................................................................................... 60 4.1.1 Field II .................................................................................................................... 60 4.1.2 Simulated image of points phantom ....................................................................... 62 4.1.3 Data Acquisition and signal processing .................................................................. 63
Vl

4.1.4 Piston transducer ..................................................................................................... 65

4.1.5 Concave transducer ................................................................................................. 66 4.2 Simulation parameters for a piston transducer .............................................................. 67 4.2.1 Amplitude function method .................................................................................... 68 4.2.2 Deconvolution method ........................................................................................... 68 4.3 Simulation parameters for a concave transducer ........................................................... 69 4.3.1 Amplitude function method .................................................................................... 70 4.3.2 Deconvolution method ........................................................................................... 70 4.4 Experimental parameters ............................................................................................... 71 4.5 Summary ....................................................................................................................... 72

Chapter 5 Results .................................................................................................................. 73
5.1 Simulation results for a piston transducer ..................................................................... 73 5.1.1 Amplitude function method .................................................................................... 74 5 .1.2 Deconvolution method ........................................................................................... 74 5.2 Simulation results for a concave transducer. ................................................................. 74 5.2.1 Amplitude function method .................................................................................... 75 5.2.2 Deconvolution method ........................................................................................... 76 5.2.3 Virtual source method ............................................................................................ 79 5.2.4 Virtual line method ................................................................................................. 80 5.3 Lateral profile ................................................................................................................ 82 5.4 Experimental results and verification of the simulations .............................................. 84 5.4.1 Single wire phantom ............................................................................................... 85 5.4.2 Four wire phantom .................................................................................................. 90 5.4.3 Excised bovine liver target ..................................................................................... 92 5.5 Discussion of results ...................................................................................................... 94

Chapter 6 Conclusion and future work .............................................................................. 98
6.1 Summary ....................................................................................................................... 98 6.2 Conclusion ..................................................................................................................... 98 6.3 Future work ................................................................................................................... 99
Vll

Bibliography ........................................................................................................................ 100

Vlll

List of Tables
Table 4.1: Simulation parameters for an unfocused transducer. ............................................. 67 Table 4.2: Simulation parameters for a focused transducer. ................................................... 69 Table 4.3: Measurement parameters for the focused transducer ............................................ 71 Table 5.1: Lateral resolution values calculated based on -6 dB drop of the maximum amplitude ......................................................................................................................... 83 Table 5.2: Side lobe width values calculated based on -32 dB drop of the maximum amplitude ......................................................................................................................... 83 Table 5.3: Lateral resolution and side lobe width values for the single wire target ............... 89

lX

List of Figures
Figure 1.1: A digital SA imaging system based on delay-and-sum reconstruction [12] .......... 8 Figure 3.1: B-mode scanning using a single-element transducer ........................................... 18 Figure 3.2: Scan conversion from a polar to a Cartesian coordinates .................................... 22 Figure 3.3: Bilinear interpolation ............................................................................................ 23 Figure 3.4: SA imaging system geometry ............................................................................... 26 Figure 3.5: Aspect angle of
nth

target with respect to transducer .......................................... 27

Figure 3.6: Spatial frequency mapping ................................................................................... 29 Figure 3.7: Geometry used for the derivation of the beam pattern of a piston transducer ..... 34 Figure 3.8: Piston transducer: Amplitude patterna(w,x, y) versus wavelength and cross-range .............................................................................................. ........................................... 42 Figure 3.9: Piston transducer: Amplitude pattern A(w,kJversus mand ku ......................... 43 Figure 3.10: Concave transducer: Amplitude pattern a(m,x,y) versus wavelength and crossrange ............................................................................. ................................................... 44 Figure 3.11: Concave transducer: Amplitude pattern A(w,ku)versus co and ku .................... 45 Figure 3.12: Piston transducer: Target spectral support in spatial frequency (kx,ky) domain46 Figure 3 .13: Concave transducer: Target spectral support in spatial frequency ( kx, kY) domain ........................................................................................................................... .............. 47 Figure 3.14: Target point spread function in spatial domain .................................................. 48 Figure 3.15: Block diagram of the pulse-echo response of the ultrasound imaging system in the frequency domain ...................................................................................................... 51 Figure 3.16: Baseband conversion ofthe ROI. ....................................................................... 53 Figure 3.17: Idealized wavefront of a concave transducer reprinted from [33] ..................... 55 Figure 3.18: Sketch of a highly focused transducer ideal for a virtual point reconstruction (left) versus a moderately focused transducer ideal for a virtual line reconstruction (right) ............................................................................................................................... 57
X

Figure 4.1: The procedure followed in this research to test the hypothesis ............................ 59 Figure 5.1: Conventional B-mode image from points phantom ............................................. 73 Figure 5.2: B-mode image from points phantom reconstructed via the amplitude function method ............................................................................................................................. 74 Figure 5.3: B-mode image from points phantom reconstructed via the deconvolution method . ......................................................................................................................................... 74 Figure 5.4: Conventional B-mode image of point phantom. The focus is at 6 mm ................ 75 Figure 5.5: B-mode image from point phantom reconstructed via the amplitude function method ............................................................................................................................. 75 Figure 5.6: B-mode image from point phantom reconstructed with the deconvolution method where the reference point considered at the focus (at 6mm) ........................................... 77 Figure 5.7: B-mode images from point targets. Conventional (left) and SA image reconstructed using the deconvolution with a reference point at 8 mm (right) ............... 78 Figure 5.8: Conventional versus virtual point method reconstructed images from points phantom ........................................................................................................................... 79 Figure 5.9: Conventional versus virtual line method reconstructed images from points phantom ........................................................................................................................... 80 Figure 5.10: Conventional versus deconvolution method reconstructed images from points phantom ........................................................................................................................... 81 Figure 5.11: Lateral profiles of the points located at 7.3, 9, and 10 mm from the transducer surface .............................................................................................................................. 82 Figure 5.12: Conventional B-mode image of a wire phantom in a water container ............... 85 Figure 5.13: Contour plot of the conventional B-mode image shown above ......................... 85 Figure 5.14: B-mode image of a wire phantom reconstructed via deconvolution method ..... 86 Figure 5.15: Contour plot of the B-mode image reconstructed via the deconvolution method ......................................................................................................................................... 86 Figure 5.16: B-mode image of a wire phantom reconstructed via virtual point method ........ 87 Figure 5.17: Contour plot of the B-mode image reconstructed via the virtual point method. 87 Figure 5.18: B-mode image of a wire phantom reconstructed via virtual line method .......... 88
Xl

Figure 5.19: Contour plot of the B-mode image reconstructed via the virtual line method ... 88 Figure 5.20 Lateral profile of the single wire target ............................................................... 89 Figure 5.21: Conventional image of 4 wires in a water container .......................................... 90 Figure 5.22: B-mode image of 4 wires reconstructed via deconvolution method .................. 90 Figure 5.23: B-mode image of 4 wires reconstructed via virtual point method ..................... 91 Figure 5.24: B-mode image of 4 wires reconstructed via virtual line method ....................... 91 Figure 5.25: Conventional image of excised bovine liver ...................................................... 92 Figure 5.26: B-mode image of excised bovine liver reconstructed via deconvolution method ......................................................................................................................................... 93 Figure 5.27: B-mode image of excised bovine liver reconstructed via virtual point method 93 Figure 5.28: B-mode image of excised bovine liver reconstructed via virtual line method .. 94 Figure 6.1: Depiction of target spectral support for a curved aperture (Left) .A varied length 2D Hamming window applicable to SAR reconstruction (Right) reprinted from[35] .... 99

Xll

Chapter 1 Introduction
1.1 High-frequency ultrasound imaging's role in medicine
The use of high-frequency ultrasound imaging (HFUI) to investigate the structural and functional properties of biological soft tissues at the microscopic level is a growing field of interest. The following is a summary of current clinical applications of HFUI taken from a review article by Foster, et al[l]: Ocular imaging: The eye is an ideal target for HFUI because deep penetration is not needed. HFUI is a useful tool for diagnosing ophthalmic diseases such as anterior segment tumors, glaucoma, corneal disease, scleral disease, intraocular lens abnormality and trauma. Skin imaging: Although HFUI is not an alternative to histology, it contributes to the assessment of skin tumours by providing information on tumour depth and margins. This information is useful in the evaluation of skin tumours before surgery and in monitoring the response to therapy for certain inflammatory conditions [2]. Furthermore, the Doppler information on the vascular patterns of these tumours may provide a means of differentiating them from normal tissue. Intravascular imaging: HFUI has the ability to visualize and measure the vessel wall and any associated plaque buildup; therefore it is used in the assessment of short- and long-term outcome following interventional procedures such as balloon angioplasty and stenting for the treatment of coronary artery disease.
1

Nonvascular endoluminal imaging: HFUI can quantify the thickness of the mucosal and submucosal layers, as well as the thickness of tumors and other abnormalities of the lumen. Examples of endoluminal applications of high-frequency ultrasound include imaging the urinary tract, biliary tract, endometrial canal, Fallopian tube, esophagus, large and small bowel, and bronchial tree. Developmental biology: The limited penetration of high-frequency ultrasound in living tissue has led to its growing use in small animal imaging where this is an issue of less importance. Turnbull et al.[3] demonstrated the first use of high-frequency ultrasound for non-invasive in
utero imaging of live mouse embryos. More recent investigations in this area have focused

on Doppler methods for examining mouse cardiovascular development [4]. The accuracy of all diagnostic methods described above highly depends on the quality of the images obtained by the high-frequency ultrasound system. There are several imaging algorithms used in ultrasound imaging while the ultimate common goal of them is to improve the image resolution, signal-to-noise ratio and contrast. The rest of this Chapter includes a summary of the ultrasound imaging methods focusing on issues encountered in the high-frequency imaging. Synthetic aperture (SA) techniques are introduced as potential solutions to these issues.

2

1.2 Beamforming in ultrasound imaging
To enhance the quality of the image, the ultrasound beam should be focused and steered within the body. The process of focusing and steering the beam is called beamforming. Beamforming increases the transducers directivity and sensitivity to a particular direction.

1.2.1 Single element transducers

Single-element transducers have a simple design where the ultrasound beam is focused using a lens or a curved piezoelectric crystal. In a single-element system, this focused beam is steered within the body by mechanically moving the transducer. The motion systems can be from a range of various stepping motor-controlled positioning stages to DC servo systems with custom actuators. In a conventional imaging system there is not any electronic beamforming involved in the scanning process.

1.2.2 Array transducers

Array transducers use electronic beamforming. Each element has separate electronics including a time delay element that makes it possible to steer the transducer's beam in a given direction and focus at a given axial distance both in transmit and receive. The most common beamforming technique in modem digital beamformers is delay and sum (DAS) which is based on simple geometric relations to focus the beam in a specific point. Usually the focus in transmit is fixed; however, the focus in receive can be changed as a function of time, this is called dynamic focusing.

3

1.3 Resolution issues in single-element imaging
The inherent high attenuation of tissue which grows dramatically with rising frequencies, makes the depth of penetration limited in HFUI systems. The fundamental issue in the design of an ultrasound imaging system is to find a compromise between good lateral resolution, high axial resolution and the required penetration depth. Thus, to overcome the problems imposed by the limited penetration, highly focused transducers are employed in HFUI to obtain a high energy density in the short and narrow focus area compensating for the attenuation of the signal and increasing the signal-to-noise ratio (SNR). Since the lateral resolution depends on the beamwidth, the ideal transducer is one with a narrow beamwidth which is extended in the beam (axial) direction. This is in contrary to the focused transducer characteristics where the beamwidth is narrow only in vicinity of the focal point. This introduces a substantial shortcoming in the acquired B-mode images due to the depth-dependant and non-uniform lateral resolution. Although this is the case with all focused transducers, the problem of limited focal area can be handled in various ways for focused array transducers. Advanced beamforming techniques can be implemented in the array transducer to extend the focal area or to have multiple foci at different depths. Unfortunately there are currently two main challenges to fabricate array transducers for high frequency applications. The first is the difficulty in constructing array elements with very small feature sizes needed for good acoustic operation at such high frequencies. The second is the difficulty and expense of constructing a high-frequency beamformer.
4

Due to its advantages, single-element transducers will remain in common use for HFUI for the foreseeable future. Its primary drawback, the poor lateral resolution in regions outside of its focal range may be overcome using off-line beamforming or post-processing of its data. Synthetic aperture is one of such post-processing methods. Originally applied to radar in 1950s, Synthetic Aperture radar (SAR) is an advanced, yet well established imaging technique. There are several synthetic aperture reconstruction algorithms that are commonly used for non-radar purposes, such as sonar, geological, non-destructive testing and medical imaging. As implied by its name, synthetic aperture can synthesize the effects of an array transducer by simply scanning a single-element transducer and recording the corresponding ultrasonic data at each transducer location. These data can then go through some postprocessing to provide the user with a high-resolution image.

1.4 Synthetic aperture imaging in Radar

1.4.1 History

SAR is an airborne or satellite-borne radar system that provides the user with the map of remote targets on a terrain, a planet, etc .... These systems have very precise hardware for the data acquisition and employ advanced theoretical principles of physics and mathematics to convert the acquired data to high-resolution images. The origin of these principles can be traced back to Gabor's theory of wavefront reconstruction [5].

5

Early SAR systems in 1950s were based on an analog optical system made of lenses and optical filters for processing the echoed signal recorded on a photographic film using the Fresnel approximation for image formation [6, 7]. With the advent of digital processors, the digital version of this algorithm was introduced for the space-borne SAR in the late 1970s [8]. These algorithms in the analog or digital form are generally known as range-Doppler Imaging. Another SAR method developed in the 1970s, known as polar format processing, is based on a plane wave approximation of the propagated wave. This method was largely employed in 1980s when the concept of spotlight SAR first introduced by walker [9, 10]. In spotlight SAR, the physical antenna is slewed so that the same small region of interest remains illuminated while the platform goes across the synthetic aperture. During the early 1990s, Fourier-based multidimensional signal processing was used to develop a more concrete theoretical principle for the SAR data inversion by Soumekh[ 11]. The algorithms based on this theory are now generally referred to as Wavenumber algorithms. The original Wavenumber algorithms required interpolators to do a remap of the raw data onto a rectangular grid suitable for Fourier processing. In 1994 a new Wavenumber inversion algorithm known as the chirp-scaling was developed which replaces the interpolator needed in the previous inversion with a far-field approximation of the wave equation solution. Regardless of whether it is used for radar, sonar or ultrasound, synthetic aperture techniques are very similar. However, there are some factors that effect the implementation
6

of SA techniques in each field. The differences and similarities between radar and ultrasound systems are discussed in more details in the following section.

1.5 Synthetic aperture imaging in Ultrasound
1.5.1 History
Before focusing on synthetic aperture ultrasound, it is helpful to briefly look at the major differences between Radar and ultrasound imaging systems. For Radar, the target is located in the far-field of the antenna, whereas the target is always in the near-field of a medical ultrasound system, which complicates the reconstruction. The scanning path is fixed in ultrasound, whereas the deviations from a straight flight path have to be compensated for in Radar systems. The "stop and hop" assumption in SAR is not always valid where as in ultrasound systems this is always true. All these factors affect the implementation of a medical SA ultrasound system and many details have to be considered comparing to SAR to perform a successful implementation. The history of synthetic aperture ultrasound (SAU) is much shorter. SAU imaging has been implemented primarily in 1978 for nondestructive testing (NDT) [12].The main goal was to employ SA principles directly to construct an array transducer with a single transmit/receive circuitry and a multiplexer to switch the active element. Figure 1.1 illustrates such a SA imaging system. Since there was only one element in transmit at a time, the corresponding SNR in this system was low. With the advent of transducer arrays in the early 1980s, focus was gradually directed towards this area where to overcome the problem with 7

low SNR the single-element transmission was replaced by simultaneous excitation of a multielement subaperture. The application of multi-element subapertures to increase the SNR of synthetic aperture imaging has been investigated using phased array transducers by Karaman and colleagues for small scale systems [ 13], by Lockwood and colleagues for sparse synthetic aperture systems with the focus on 3D imaging applications [14], and by Nikolov and colleagues for recursive ultrasound imaging [15]. In all cases, the image reconstruction algorithms are realized via a simple time-domain delay-and-sum (DAS) procedure called synthetic aperture focusing technique (SAFT).

~A~DOM

WEIIII()~'W

ACCESS

t

2
DIGITAL

ADOER

OfSPl..AY

X

V

MINI CONPUTEI:t

Figure 1.1: A digital SA imaging system based on delay-and-sum reconstruction [ 12]

SAFT implementations are based on a very simplified model of the imaging system used in SAR which assumes that the ROI is located in the far field of the antenna. This means that 8

the specific diffraction effects of the physical antenna are neglected (point source assumption). To generate the same effect in SAU while keeping the SNR high, a multielement subaperture was used to emulate the radiation pattern of the single-element transmission by applying defocusing delays in the same way that a spherical wave with limited angular extend is generated. For the case of a fixed-focus array or single-element large transducer where the assumption of point source is not valid any more, another technique called virtual source was proposed by Passmann and Ermert [16] in early 1990 based on a previous study by Ermert and Karg in 1979 [ 17] . The virtual source method involves treating the focal point of the transducer as a virtual point source for synthetic aperture processing, assuming that the distortion due to the diffraction effects of a large transducer can be compensated by assuming that the virtual source produces spherical waves. The performance of the virtual source technique in terms of lateral resolution, side lobe levels, spatial sampling rate, and SNR in low frequencies has been studied by Frazier and O'Brien [18]. Until early 1980, frequency-domain SAFT was relatively unknown. The first frequency-domain reconstruction algorithm was developed by Nagai in 1984 [19]. Since then several authors have re.ported different implementations of frequency-domain SAFT [20, 21]. In all cases, the algorithms take the form of a 2D spatia-temporal matched filter generating high-resolution images if the transducer size is small comparing the wavelength. If the transducer size is on the order of a wavelength, the diffraction effects of the transducer should be taken into account for a successful reconstruction. This is the case with
9

the single-elements transducer currently used in HFUI and high-frequency NDT. An implementation of SAFT in frequency domain with applications in high-frequency NDT has been studied by Stepinski for a piston transducer [22]. The algorithm performs the 2D FFT transform of the measured ultrasonic data followed by the 2D matched filter and interpolation. The final image which is obtained using a 2D inverse FFT shows a clear improvement in lateral resolution compared with the time domain SAFT. A similar situation where the diffraction pattern of the transducer should be compensated for is encountered when a single-element concave transducer used for highfrequency imaging. The analysis of SAFT performance for this type of transducers should be of great interest for its potential users.

1.6 Hypothesis
There is a need to develop imaging techniques for HFUI which improve the lateral resolution in the nonfocal regions of B-mode images produced using focused, single-element transducers. Synthetic aperture methods have been proposed as a potential solution to this problem. The hypothesis in this thesis is that the frequency domain implementation of the SA algorithms which incorporate the diffraction effects of the transducer into the 1mage reconstruction will lead to a more uniform lateral resolution in single-element HFUI.

10

To test this hypothesis, several SA algorithms were developed and implemented on the simulated and experimental data. The B-mode images from point targets were used to quantify the lateral resolution.

1.7 Outline of the thesis
This thesis presents the work carried out in order to develop and implement the SA algorithms on simulated and measured data. Chapter 2 provides some acoustic background required to understand the ultrasound imaging model developed in Chapter 3. A synthetic aperture model of the ultrasound imaging system that includes the transducer electromechanical characteristics is presented in Chapter 3 along with several synthetic aperture reconstruction algorithms and their implementation details. Chapter 4 explains the methods used in the simulations and experiments for data simulation, acquisition and processing. Chapter 5 presents the B-mode images reconstructed using conventional and SA algorithms for both unfocused and focused transducers and compares their performance. Lastly, Chapter 6 discusses future work to be completed on the method.

11

Chapter 2 Acoustic background
2. 1 Ultrasound wave propagation
Ultrasound is sound at frequencies higher than what can be heard by humans (above 20kHz). For several reasons, medical ultrasound systems operate at much higher frequencies depending on the application. Sound or acoustical waves are pressure waves that propagate through matter via compression and expansion of the material. An acoustic wave is a longitudinal wave in which particles of the material move back and forth in the same direction that the wave is traveling.

2.1.1 Wave equation

For soft biological tissue it 1s often assumed that ultrasonic wave propagation 1s approximated by assuming that the medium acts as a fluid and that any shear wave propagation can be ignored. In this case, the acoustic wave equation can be derived by applying conservation of mass, the equation of motion of fluid and the pressure-density relation. Detailed derivation of the wave equation can be found in [23]. The wave equation
lS:

(2.1)

where p(x,y,z,t) = p(x,t)represents the sound pressure in space and time, and Cis the speed of propagation. Equation (2.1) is valid if the following conditions are satisfied: 12

1) The medium is homogeneous.

2) The medium is stationary. 3) The ambient velocity is zero. 4) The process is adiabatic. Equation (2.1) can be also expressed for density and velocity. To simplify the calculations a new variable, the velocity potential <D(;, t) is defined as:

8D(x,t) - )_ p ( x ,t --Po_....;____

t5t

(2.2)

where p 0 denotes the ambient density. Substituting (2.2) into (2.1 ), the wave equation becomes: (2.3)

2.1.2 Solutions to the wave equation
In an unbounded, homogeneous space, one solution to the wave equation 1n Cartesian coordinates is the complex function:
<D(x,y, z,t) =A exp[J(mt- (kxx + kyy + kzz))

J

(2.4)

This solution is known as a monochromatic plane wave, A is the amplitude of the wave and
k = (kx, ky,k;:) is called the wavenumber, and
OJ

is the angular frequency. The following

relationship is required in order for (2.4) to satisfy the wave equation.

13

(2.5)

<f>(x0 ,y0 ,z0 ,t) = AexJ

l

J(_!}!~t-(kxxo +kyYo +k,z
Frequency Phase

0 ))]

(2.6)

This wave is a plane wave because its phase is the same at the points lying on the plane given by kxx + kyy + kzz =I where I is a constant. The smallest distance between two points that have the same phase is called wavelength and is equal to:

..1=c

f

(2.7)

where f = m I 2tr represents the wave frequency. The wavenumber and the wavelength are related through the equation:

(2.8)

The linearity property of the wave equation implies that many plane waves propagating in different directions can exist simultaneously. Therefore, an arbitrary wave can be expressed as a weighted sum of the plane waves. This is called the superposition property. Another solution to the wave equation in an unbounded, homogeneous space, as presented in spherical coordinates is:

(2.9)

14

where A is complex amplitude, r is the radial distance. This represents a spherical wave. Other solutions to the wave equation are difficult to obtain. The excellent book by Goodman [24] has a review of these solutions.

2.1.3 Theory of radiation and diffraction
The solutions to the wave equation provided 1n section 2.1.1 assume unbounded, homogeneous space with no sources. However it is important to be able to solve the wave equation in the presence of sources of finite size. There are two classical solutions to this problem: the Kirchhoff and the Rayleigh-Sommerfeld theories of diffraction. The interested reader is referred to the book by Cobbold for a thorough derivation of the mentioned methods [23].

2.1.4 Attenuation
In reality, the amplitude of an acoustic wave decreases as the wave propagates. This attenuation of the wave is due to absorption and scattering. In absorption acoustic energy is converted to thermal energy while in scattering the energy is deflected from its original direction of travel. The first part of next Chapter introduces the fundamentals of ultrasound imaging and image quality factors then discusses the conventional B-mode imaging and finally presents a mathematical model for SA imaging algorithm in detail along with the calculation of the theoretical spatial resolution in the discussed algorithm.

15

Chapter 3 Ultrasound Imaging Theory

3.1 Fundamentals of ultrasound imaging
The methods studied in this thesis are called the pulse-echo methods. This means that a pressure wave is transmitted into a region of interest (ROI) and the received echo is displayed. The received echo is based on both reflection and scattering properties of the ultrasound waves.

3.1.1 A-mode scan
A-mode is the simplest and the oldest way of performing a pulse-echo scan. A transducer transmits a short ultrasonic pulse to a ROI then the same transducer receives the backscattered signal. "A" stands for the amplitude as it is the amplitude of the received signal that is displayed on an oscilloscope. If the speed of sound in the medium is known, then the time axis can be converted to depth. Although this method is rarely used in medical imaging, A-mode signals are the basis of all ultrasound images. Since the frequencies of A-mode signals are in the range of radio signals, in analogy to the RADAR terminology, the raw Amode signals are also called radio frequency (RF) signals. The frequency bandwidth of the RF signals is called their spectral support band. As the temporal frequency bandwidth is used to determine the sampling criterion in the time domain (Nyquist criterion), a spatial frequency support band is employed to find the proper spatial sampling rate. The 2D spectral 16

support band of a 2D signal is composed of the frequencies that contain most of the signal information.

3.1.2 8-mode scan
A conventional B-mode tmage is created by scanning the transducer beam in a plane. Figure 3.1 illustrates a single-element B-mode scanner moving in the y direction while its beam is aimed down the x axis. The transducer periodically transmits ultrasonic pulses and records a succession of A-mode signals that are keyed to the position of the transducer in the
y axis. In earlier B-mode systems, the B-mode image was created by brightness-modulating

a cathode ray tube (CRT) along a column using the corresponding A-mode signal. There are different methods for scanning the region of interest. Some imaging systems use a stepping motor system for moving a single-element transducer along a straight or a curved path. These mechanical scanning methods are respectively called linear and sector scanning. The advantage of a sector scan over a linear one is to provide a wider field of view. The mechanical scanning does not need additional complex electronic circuitry for beamforming therefore it is appealing for high-frequency imaging where the appropriate array beamformers have not fully developed yet.

17

Transducer Motion

y
I

Pulse ~

Matching ge 1 orwatet·

X

·~¥#J'~

·
I

Figure 3.1: B-mode scanning using a single-element transducer

The other type of scanning is performed electronically with array transducers in both linear and sector fashions. The beam steering and focusing in the array transducers are achieved by advancing and delaying the electrical excitation signal to each element in the array.

3.2 Image quality factors
The ability of medical professionals to accurately interpret the ultrasound images strongly depends on the quality of image. Studying the factors that affect the image quality is an important and complicated task. This task is simplified by defining some image quality factors such as resolution, contrast, SNR, etc. The following sections provide a brief description of each of the above factors. 18

3.2.1 Spatial resolution

Spatial resolution is defined as the ability of a medical imaging system to accurately depict two distinct objects as separate. In the case of ultrasound imaging, spatial resolution can be thought of as the degree of smearing, or blurring introduced to each point imaged by the system. This is the response of an imaging system to a point source or the traditional point spread function (PSF) of the system. Given the PSF of the system, its resolution can be quantified using a measure called the full with at the half maximum (FWHM). This is the full width of the PSF at one-half its maximum value. In 2D ultrasound imaging, the component of the PSF which is parallel to the ultrasound beam is called the axial resolution and the one perpendicular to the beam is called the lateral resolution.

3.2.2 Contrast

Contrast refers to differences between the image intensity of an object and surrounding objects or background. The image contrast results from the inherent object contrast within the patient. The contrast in an ultrasound image arises from difference in tissue acoustic impedance. Other factors influencing the contrast are the dynamic range of the system, side lobe levels of ultrasound beam pattern and noise level.

3.2.3 Signal-to-noise ratio (SNR)

SNR is a measure of relative strength of the signal with respect to that of interfering noise which is always present in imaging.
19

To increase SNR, noise should be reduced or the signal should be increased. The two major noise sources in ultrasound imaging are speckle and random electronic noise. The electronic noise can be minimized by utilising transducer engineering designs of higher quality. The speckle noise is formed by the coherent scattering of the ultrasound wave from many sub-resolution scatterers. Some do not consider speckle as noise because it represents the local echogenicity of the underlying scatterers however in this thesis it is called noise since the texture of the speckle pattern does not correspond to anatomical structure and it obscures the information in the image. There are several filtering methods to reduce the speckle noise and to enhance both the contrast and SNR in ultrasound images.

3.3 Conventional ultrasound imaging
Conventional B-mode imaging refers to the most common and simple signal processing algorithm used in ultrasound imaging. Each received RF line is processed once the acquisition is complete at the current transducer location and then transducer is moved to the next position. The signal processing steps in a typical imaging system includes: time gain compensation, envelope detection, logarithmic compression, scan conversion, and interpolation. The following is a brief description of each of these processing steps.

20

3.3.1 Gain compensation

The ultrasound energy is attenuated when traveling though a medium. This means that two identical targets at different depths will generate echoes of different amplitude. The attenuation of the received echoes increases with increasing depth (time). This causes the brightness of an ultrasound image to decrease with depth (distance from the transducer).To compensate for this effect, an amplitude gain is applied to the received ultrasound signals that increases with depth (time). This method called time gain compensation (TGC), makes the brightness of an image more uniform with depth and improves the quality of the images dramatically. Various forms of TGC have been used, such as exponential, linear and windowed. They are usually applied in the hardware of an imaging system.

3.3.2 Logarithmic compression

One of the major concerns in the design of gray scale B-mode imaging system is the need to display a very large range of echo amplitudes in the limited gray scale levels which are discriminable to the human eye. To avoid loss of information some signal compression is used to reduce the dynamic range of the echo signals by means of a logarithmic conversion. Such an a provides reduced gain for large signals and high gain for small signals. The logarithmic compression operation is defined as:
sc(t)

= 20log(s(t))

where s(t) and sc(t) are the original and compressed signals, respectively.

21

3.3.3 Scan conversion and interpolation

If any of the sector scanning methods is used in data acquisition, a polar image will be obtained with the vertical axis as ranger and horizontal axis as angle e. A scan conversion is necessary to convert the polar image to a Cartesian image that is appropriate for digital display. See Figure 3.3.

e
y

r

· (x,y)

Cattesian image Polar image

Figure 3.2: Scan conversion from a polar to a Cartesian coordinates

For each pixel (x, y) in a Cartesian image, the corresponding position in the polar image can be obtained by following equations:
r =

~x2 + y2

B

=arcsin(; J
22

Since the determined pixel value in the polar coordinate (r, B) is usually not an integer number some kind of interpolation must be performed. The scan conversion and the corresponding interpolation are the most computationally intensive steps in an ultrasound imaging system. There are many different interpolation methods such as windowed sine, bilinear and nearest neighbour. These interpolations can be implemented by either software or hardware. In real-time scanning systems the bilinear interpolation is often used. This method 1s illustrated in the figure below.

Figure 3.3: Bilinear interpolation

The interpolation transforms from a polar image I P to a Cartesian image l c. For each pixel in lc, the corresponding position in IP is calculated. Four closest sampled data points to this position

23

~'~'~'and~ are used for the interpolation. Assume that the positions of ~'~'~'and P4 are
(lj 'el ), (lj' e2 ), (r2' el) and (r2' e2)' the value for the pixel to be interpolated is:

P = ~ (B2 - B)(r2 - r) + ~ (B2 - B)(r -lj) + ~(B- B1 )(r2 - r) + ~ (B -B1 )(r -lj)

3.4 Synthetic aperture imaging
Synthetic aperture imaging is a pulse-echo imaging method that relies on the rules of linear superposition of waves. In a synthetic aperture imaging system, a larger aperture is synthetically created from a smaller aperture. The basic idea behind such a system is to use a moving small aperture which insonifies a region of interest (ROI) and records the echo data at each insonification point. Since the same aperture is used to transmit and receive the sound this is called a mono-static approach. The synthetic aperture imaging inverse problem is to use the echo data to produce a high-resolution image of the scatterers in the ROI. Depending on the modality (radar, sonar, ultrasound) beamforming and focusing can be considered synthetic aperture imaging. The SA algorithm development begins with a simple ultrasound imaging system model .The corresponding model assumes a very small ultrasound transducer (point aperture) that linearly scans a predefined ROI. After developing a system model for SA, an inversion method will be presented. Next a more realistic case will be studied that assumes a transducer with dimensions comparable to the wavelength of transmitted ultrasonic pulse. At this point, the effect of transducer beam pattern is included in producing a modified imaging algorithm. 24

Finally the theoretical spatial resolution of two common transducer geometries is investigated.

3.4.1 The region-of-interest

SA image reconstruction is based on a two-dimensional (2D) signal theory which in our case deals with 2D signals and their Fourier transforms. A discrete scatterer ( also called "targets" ) model is used to represent the ROI by assuming that it is composed of stationary scatterers at locations ( xn, y n), n= 1, 2, .. . It worth noting that while a discrete model is used here, the results are also applicable for a continuous target model.

3.4.2 Point transducer assumption

Figure 3.4 illustrates the imaging system used in this discussion, considering of a point transducer which is mechanically scanned along the line defined by (x = 0, y

= u).

It is

assumed that the measurements in the cross-range domain (y axis) are made within an infinite synthetic aperture u E ( -oo, oo) . The scanning path is called synthetic aperture or cross- range domain. At each transducer location, a very short (large-bandwidth) pressure pulse p(t) is transmitted. Since the transducer is a point, the transmitted pressure wave will propagate spherically or omni-directionally.

25

R
h . '"'at i 1n;-;
u

2.1 ' Il

(R I 1

u
Ul
)

u
Ul

·

I

Figure 3.4: SA imaging system geometry

If the reflectivity of point targets located in the ROI is given by an, the received

backscattered pressure wave is:
2 2 2~ x + ( y - u) ] tn Cn

s(t,u) = ~anp

[

(3.1)

where t-

2~x~ +(y~ -u) 2

c

is the round-trip delay from the transducer to the nth target. The

attenuation of the spherical wave due to its divergence or absorption is ignored as discussed in 3.4.7.

26

For the nth target when the transducer is located at (0, u) the aspect angle is defined as:

(3.2)

Figure 3.5 illustrates the aspect angle at different transducer locations (O,u).

y!u

Un·

_ )

~(Un)
J e"(u

u·
I

) /3(n

0 (.xn ,Jn)
X

u

u .. I

/

e"( ui)

Figure 3.5: Aspect angle of n

th

target with respect to transducer

3.4.3 Image reconstruction: Point transducer

In a typical imaging system, the "object function" is what makes up the image. In an SA system, the object function is called the reflectivity function or related to target reflectivity an via:
27

f 0 (x, y) .This function is

(3.3)
n

where 8(x, y) is the Dirac delta function. The reconstruction approach studied in this thesis is based on a frequency domain formulation. The implementation of this algorithm, takes advantage of efficient Fast Fourier Transforms (FFT) algorithms. The Fourier transform of SA signal s(t, u) with respect to t is:
s(m,u) = P(m)Lan exp[- j2k~x~ +(yn -u)
n
Spherical PM signal

2

J

(3.4)

where k =OJ! c represents the wavenumber. It is assumed that the target reflectivity an

IS

independent of OJ. The phase function exp[- j2k ~ x~ + ( yn - u ) 2 ] is a nonlinear function of
(xn, Yn), it is called a phase-modulated (PM) spherical signal [25].

The Fourier transform of spherical PM signal with respect to u is found via the following Fourier integral:
00

Sn(m,ku) =
=

f sn(m,u)exp(- jkuu)du
(3.5)

j a.P(w)exp[- j2k~x~ +(Y. -u)' Jexp(- Jk.u)du

where ku represents the spatial frequencies in the cross-range domain u . The above integral can be evaluated using the method of "stationary phase" [25, 26], to produce:

28

for ku

E [- 2k, 2k]

and zero otherwise. The term 1 I~ 4k 2 - k ~ will be cancelled out by a term

appearing in the numerator of the Jacobian of the Stolt transformation and will not be considered in the reconstruction. The SA signals in the (OJ, ku) domain can be written in the following form:
(3.7)
n

where the two new functions, kx(OJ, ku) and kY(OJ, ku) are defined as: kx(OJ,ku) = ~4k -k: ky(OJ,ku)=ku
2

(3.8)

Figure 3.6: Spatial frequency mapping

29

The spatial frequency mapping by these two functions is often called "Stolt transformation" [27] . Figure 3.6 illustrates Stolt transformation for the discrete data in the spatial frequency. The dots indicate the raw data samples along radii 2k. The underlying rectangular grid shows the format of samples after the Stolt transformation to a Cartesian grid on ( kx, kY) . After comparing, the 2D spatial Fourier transform of the object function (equation (3.3)):

(3.9)
n
Linear phase phunclion Linearcombinalion

to (3. 7) , the SA signal can be written as:

S(OJ,ku) = P(w)F0 [kx(OJ, ku),ky(OJ,ku)]

(3.1 0)

Since the goal is to reconstruct the image of the object function, the equation above should be solved for F'c/kx, ky): (3 .11)

Observing the above equation we note that the shown theoretical reconstruction

IS

a

deconvolution operation performed in frequency domain. The main drawback of implementing it via a simple inverse filtering method is that p(t) is a bandlimited signal and therefore the division by P(w) will amplify any noise inS(w,kJ that is outside the band. This makes equation (3.11) numerically unstable for small P(w) values and greatly amplifies the high-frequency noise component. The most common and practical reconstruction is via matched filtering:

(3 .12)

30

where

*

denotes the complex conjugate operation. Note that F(kx,ky) is defined over a

different set of coordinates than S(m,ku). This can be handled using Stolt mapping followed by an interpolation.

3.4.4 Finite aperture effect
The SA reconstruction algorithm developed so far assumes a point transducer. Since point transducers radiate in all directions, an infinite scan is needed to acquire a complete signal. Practical transducers have a directional and limited radiation pattern, therefore only a finite scanning aperture is sufficient to collect a complete signal. An intermediate formulation which is useful for array transducers is to assume that a point transducer is used to perform measurements within a finite aperture u E signal for the
nth

[ -L, L]

. If u E

[ -L, L]

the measured spherical PM

target can be represented as:

(3.13)

where forJuJ ~ L
0

(3.14)

Otherwise

is a rectangular function in the synthetic aperture u domain. The Fourier transform of this signal with respect to u can be presented via the following Fourier integral:

31

00

Sn({f),ku) =
=

J Sn({f),u)exp(- jk u)du
11

-00

1
-00

O"nan(OJ,Xn,Yn -u)P(w)exp[-j2k~x~ + (Yn -ui - jk,u ]du

(3.15)

Using the method of stationary phase, equation (3.15) can be solved to give:

Sn({f), ku) =anA,/ {f), ku)P({j)) exp (- j~4k

2

- k~ xn- JkuYn)

(3.16)

where the amplitude pattern in the ku domain and the amplitude pattern in the u domain are related to each other via the following transformation

where

k,

=

2k ~ y x2 + y2

(3.17)

Based on this discussion for the case presented above, the following can be deduced:

For ku

E

nn = [2ksinBn(L),2ksinBn( -L)]

Otherwise

(3.18)

Note that An ({f), ku) is a shifted rectangular window function in the ku domain, not the Fourier transform ofthean({f),Xn,Yn -u).

3.4.5 Transducer beam pattern
The assumption thus far is that the transducer is a point while this may be appropriate for arrays, it is not valid in a single-element imaging system. The transducers used in highfrequency ultrasound imaging are much larger than the ultrasound wavelength. Therefore it is appropriate to replace the point transducer with a realistic one of some physical extent for 32

high-frequency, single-element systems. To do so, the transmit beam pattern and sensitivity pattern of the transducer need to be considered. We first assume that the transducer is located at the origin (u

= 0).

The transmitted

pressure signal is an impulse (delta) function of the form p(t) = 8(t). The transducer is made of virtual differential elements on its surface that are located at the coordinates
[xe(l),ye(l)],lE S in the spatial (x,y) domain where S represents the contour of the

transducer surface. The transducer pressure transmitted at an arbitrary point (x, y) in the spatial domain from the differential elements is given by

ltr(t,x,y)=

J
X

21

2

Ji(l)p[t-~[x-xe (l)f+[y-ye(l)f]dl
leS]

(3.19)

+Y

C

where i(l) represents the relative strength of the differential elements at [xe (l), Ye(l)]. The beam pattern of the transducer in the transmit mode in the temporal frequency domain is then:
ltr(w,x,y)=

J
X

1
2

+y

2

Ji(l)exp[-jkJ [x-x, (l)] +[y-y, (l)]' Jdz
2
IES
Spherical PM Signal

(3.20)

The exponential term in the above equation can be replaced by its Fourier decomposition[26,

27] :
exp[- jk~[ x-x,(l) ] +[y- y, (l)]' =
2

J

-k

J

exp[- j~k'- k; [x-x, (l) ]- jk. [y- y, (l)] Jdk. (3.21)

After changing the order of integration, the following is obtained:

33

h,.(m,x,y)= J
X

1
2

k

+Y

2

Jexp(-jJk'-k;x-jk.y)xA,.(m,k.)dk.
-k

(3.22)

AT(m,ku)=

Ji(l)exp[j~k
/ES

2

-k~xe (l)+ jkuYe(l)]dl

Where

Ar (m, ku)

is called the transmit mode amplitude function and it depends on the shape

and size of the transducer.

3.4.5.1 Piston transducer
In this section, equation (3.22) is utilized to derive transmit-mode

Ar (m, ku)

for a piston

transducer. See Figure 3.7 for the corresponding geometry.
yIu

2D Assumption

z
§

3D Geometry

X

L

X

X

-L

Figure 3.7: Geometry used for the derivation of the beam pattern of a piston transducer

34

We assume that the transducer is made of differential elements which transmit the same pressure pulse at the same time. Therefore i(l) = 1 . For a transducer of diameter D y and

l

E [- DY I

2, DY I 2], the transducer surface in a 2D spatial domain is presented as:

(3.23) Substituting these parameters in (3.22) yields to:

AT (OJ, ku) =

D,)

-D) 2

kJ Jexp(jkJ) dl =sine (D2tr
2

__!____!!__

(3.24)

Therefore the support band of AT (OJ, ku) is the main lobe of the sine function,
k
u

E

r-2:r 2:rJ D 'D
y y

(3.25)

Combining (3.22) and (3.17) we get:

(3.26)

The beam width, B, of aT in the cross-range domain can be approximated by:
yE[-B,B]

~[rA rA-J
D'D y y

(3.27)

35

where r =

~ x 2 + y 2 and A denotes the wavelength of the transmitted ultrasonic pressure. An

alternative way to define the beamwidth via divergence angle ¢dis as follows:

¢"=arcsin(
B=rsin¢d

~J

(3 .28)

It will be shown how this information can help to determine the spatial resolution of such a
system.
3.4.5.2 Concave transducer

The surface of a concave transducer can be represented as a parabola in 2D spatial domain. The same steps in 3.4.5.1 are taken here. Equation (3.22) is used to calculate Ar(m,ku)for a concave transducer of focal length x1 , and diameter D and with a uniform excitation along the transducer ( i(l) = 1), the following can be written:

for IE

-D ,2 D] [2

(3.29)

The divergence angle is then:

¢d =arctan(__!!__]
2x.r

(3.30)

Then the support band of the amplitude pattern Ar is [26]: 36

(3 .31) Using (3 .17) and (3 .18), the beamwidth of ar in the cross-range domain becomes:
y
E

[-B,B]

= [ -r sin ¢d, r

sin ¢d]

(3.32)

3.4.6 Scanning to create a synthetic aperture
In the previous section, the beam pattern of a transducer located at the origin was studied. The beam pattern of a transducer located at an arbitrary point u can be derived as follows:

h1 (m,x,y-u) =
=

~

1

k

x + (y- u )
1
2

2

2

JA (m,k.)exp[- j~k 2 -k: x- Jku(y-u)Jdku
1

-k

~

x +(y-u)

2

F.:' [Ar(OJ, ku)exp[- j~k 2 - k:

X-

Jkuy ]]

(3.33)

where ~: 1 denotes the inverse Fourier transform with respect to ku. As one can see this is a shifted version of (3.22) in the cross-range domain. Based on what was shown earlier, the transmit-mode beam pattern can also be expressed in terms of an amplitude pattern and a spherical phase modulated signal:

hr (m,x,y- u) = ar(m,x,y- u)exp[- jk~x 2 + (y- u) 2 J
Amplitude Pattern Spherical PM signal

(3.34)

37

3.4.7 Transmit-Receive mode beam pattern Using similar arguments to those used before, one can account for the sensitivity pattern of the transducer in the receive mode to produce the overall radiation pattern. The receive-mode beam pattern of a transducer located at (0, u) based on the analysis above is:

h11 (m,x,y-u)= J
=

1
x 2 +(y-u) 2

k

JA (m,kJexp[ -jJk' -k~x- jk"(y-u)Jdku
11

-k

J

1
x +(y-u) 2
2

F.:' [A11 (m,kJexp[- jJk'- k~ x- jk"y ]]

(3.35)

The transmit and receive beam patterns are assumed to be the same; that is, (3.36) The overall beam pattern is the product of transmit and receive beam patterns; that is

h({J),x,y-u) = h.r({J),x,y-u)hR({J),X,y-u)

(3.37)

Since it is common to use time gain compensation to offset the decline in the power due to the now two-way spreading losses, the denominator (x 2 + (y- u) 2 ) is dropped from here on. The multiplication of hr and hR in the cross-range domain translates into the following convolution integral in the ku domain (for ku
2k

E [ -2k, 2k] ):

FJh({J),x,y-u)]=

JAr({J),p)exp[ -j~k

2

-p x- jpy

2

Jx
(3.38)
2
2

-2k

2k

=

exp(- jkuy)

JAr(m,p)AR(m,ku- p)x exp[- j[Jk'- p
38

+ Jk'- (ku- p)

J YP
X

-2k

To calculate the above convolution integral the method of stationary phase is used one more time. The outcome can be shown to be: (3.39)

where (3.40)

3.4.8 Image reconstruction considering beam pattern effects
In this section, the pulse-echo SA signal model is presented to incorporate the effects of a finite sized transducer more precisely (3.41)

where D , denotes the temporal convolution. The 2D Fourier transform of this signal is

S(w,ku)=P(w)LCTnA(w,ku)exp[ -j~4k -k:xn- fkuYn
2
n

J
(3.42)

=

P(w) LCTnA(w,ku)exp[-Jkx(w,ku)xn- jky(w,ku)Yn]
n

where

kx(w,ku) ky(w,ku)

= ~4k 2 -k:
=

(3.43)

ku

2D spectrum of the SA data in (3.42) can be simply expressed as:

S(w,ku) = P(w)A(w,ku)F[ kx(w,ku),ky(w,ku)

J

(3.44)

A basic reconstruction using a matched filter inversion and a coordinate transform gives the following image spectral estimate: 39

(3.45)

where the coordinate transform via Stolt mapping is denoted viaS {.}. This algorithm which is referred to as Wavenumber, 0.- K or seismic migration depending on who invented it and the field of application. The seismic migration algorithm comes from geophysics [28],where as the 0. - K comes from SAR [29]. In this thesis, this reconstruction will be referred to as the Wavenumber algorithm with reference to its applications in sonar [30] and nondestructive testing [22] . The implementation of Wavenumber algorithm by the means of FFT will be further investigated in next Chapter.

3.4.9 Resolution
The image of a point target is called the point spread function (PSF) of the imaging system. It depends on the 2D spectral support of the SA signal of the target that is the response of the SA system to a point. The resolution of an image characterizes the degree of smearing, or blurring in the PSF. Therefore a system's PSF is often used to characterize its resolution. The SA signal of the
nth

target in the ( m, ku) domain is:

(3.46)

Thus the spectral support of Sn(m,ku) in the ku domain is dictated by the support band of

A(m, kJ in the ku domain, which is:

40

Recall from the previous discussion on the beam pattern of piston and concave transducers that this divergence angle ¢Jd depends on the geometry of the transducer. The other limiting factor for the spectral support in a SA signal is the limited bandwidth of the ultrasonic pulse p(t) in the temporal frequency domain, which is:
OJE [OJmin 'OJmax ] E [~.- %' OJc + OJo]

The transmit-receive amplitude pattern of a piston transducer of diameter Dv is a sinesquared pattern; that is: (3.47) The support of this amplitude pattern in the spatial frequency domain can be approximated by the main lobe of the sine pattern, which is:
k
u

E

4 [-4Jr Jr] D 'D
y y

(3.48)

Figure 3.8 illustrates the support of the ultrasound amplitude pattern in the spatial domain that is beamwidth as a function of the wavelength and the cross-range y.

41

y

Figure 3.8: Piston transducer: Amplitude pattern a(m, x, y) versus wavelength and cross-range

Figure 3.9 represents the 2D spectral support of a SA signal for an arbitrary target location in the ROI for a piston transducer. This spectral support is also the 2D bandwidth of the SA signal s(t,u). Note that the bandwidth of the system in the spatial frequency ku domain is invariant in the temporal frequency mdomain.

42

-mmin

------ - ·--;-- - -- ·- !

-

----- --;·------!

-------------·- -

Figure 3.9: Piston transducer: Amplitude pattern A(m,kJ versus lUand ku

From (3.30) and (3.31), the support band of the amplitude pattern A(m, kJ for a concave transducer in the ku domain can be estimated as follows:

k
u

E

[

-2k

~D-~ +4x~

Dy

2k

'

~D: +4x~

Dy

]

43

y

Altllt\
r 5-in ~

---------------1

- ·sin 'f:t . m.

Figure 3.10: Concave transducer: Amplitude pattern a(m, x, y) versus wavelength and cross-range

The support of the ultrasound amplitude pattern in the spatial domain as a function of the ultrasound wavelength and cross-range y is shown in Figure 3.10. It is invariant in them domain. Figure 3.11 presents the 20 spectral support of an SA signal for an arbitrarily located point target for a concave transducer in the ( m, ku) domain. This spectral support is also the
20 bandwidth of the SA signal s(t, u) when a concave transducer is used.

44

-mmin

Figure 3.11: Concave transducer: Amplitude pattern A(m, kl) versus co and ku

The SA reconstruction results (3.43) showed how the data within these spectral regions are mapped into the target function spatial frequency via Stolt transform. Figure 3.12 and Figure 3.13 respectively show this spectral support mapping for a piston and a concave transducer.

45

Figure 3.12: Piston transducer: Target spectral support in spatial frequency (kx' k.) domain

46

...
·.

··.

B

······...

,I

.. .
·· f

l ·
I

· r

!

.'

I

_ .,.; -ll'- · I
..........

_

..

.~·,.:··"

.·

/

~

.-....

.. ~*;··

.., t ....

Figure 3.13: Concave transducer: Target spectral support in spatial frequency(kx,ky) domain

The inverse 2D Fourier transform of the shaded area in Figure 3.12 and Figure 3.13 dictates the shape of the point spread function of the SA imaging system. To develop an
47

analytical model for the PSF, one could approximate the target support region in Figure 3.12 and Figure 3.13 via a rectangle in the (kx,ky) domain with widths:

Bx = 2(kmax - kmin)

in the k, domain

for a piston transducer in the k y domain for a concave transducer

(3.49)

where kc is the wavelength at the central frequency of p(t). For a unit function G(kx,ky) = 1 in the spectral region bounded by the dashed lines (rectangle), its inverse Fourier transform is

g(x,y)=sinc( ~~}inc(;;)

(3.50)

This 2D sine pattern for the nth target is shown as a cross-shaped structure in Figure 3.14.

Yr

Figure 3.14: Target point spread function in spatial domain

48

The main lobes of the two sine functions in the (x, y) domain are, respectively, within±Dx and ±IJ y where

(3.51)

Which after substituting for (Ex, BY) become: trC
20Jo

Dx=

1r

kmax -kmin

=

DY
Dy=

4

for a piston transducer

(3.52)

Ac for a concave transducer 4sin¢d

where 2m0 is the baseband bandwidth of the ultrasonic pulse p(t) . The analysis provided thus far did not include the electrical part of the ultrasonic imaging model, in other words, the equations were relating the transmitted pressure to the received pressure. In a real imaging system, the user does not have direct access to these data and the output data is in the form of an electrical voltage. In the next section, an electromechanical model of the imaging system is studied and the complete SA algorithm based on this model is presented.

49 PROPERTY OF

RYERSON UNIVERSITY liBIWU'

3.5 Frequency domain representation of an ultrasonic imaging system
In a simple ultrasound pulse-echo system, such as that used in high-frequency imaging systems, ultrasonic pulses are transmitted from a fixed location and result in the generation of scattered and reflected signals along the transmission path. These scattered signals are detected by the same transducer as used for transmission. The developed SA algorithm in this thesis is based on a linear, time-invariant electromechanical model of the ultrasonic imaging system. Typically such models have an electrical voltage pulse as an input to the transducer which in response generates an ultrasonic pressure pulse. The output of this model would be the output voltage from the transducer caused by the backscattered pressure wave. This model was first introduced by Stephanishen [31, 32]. It employs the concept of spatial impulse response and linear systems theory to find the ultrasound field. The spatial impulse response gives the emitted ultrasound field at a specific point in space as function of time, when the transducer is excited by a Dirac delta function. The field for any kind of excitation can then be found by just convolving the spatial impulse response with the excitation function. The impulse response will vary as a function of position relative to the transducer, hence the name spatial impulse response. The received response from a small sphere (point scatterer) can be found by acoustic reciprocity. The spatial impulse response equals the received response for a spherical wave emitted by a point. Thus the total received response in pulse-echo can be found by 50

convolving the transducer excitation function with the spatial impulse response of the emitting aperture, with the spatial impulse response of the receiving aperture, and then taking into account the electromechanical transfer function of the transducer to yield the received voltage trace. Based on the above discussion, the SA signal derived in the previous section will be changed now to include the two-way electromechanical impulse response and electrical excitation of the transducer. The measured electrical signal Em (OJ, ku) can be obtained via:
P(OJ) = p 0 Ei(OJ)Hr (OJ) S(OJ, ku) = P(OJ)

I
11

<TnA(OJ, ku) exp [- j~4k

2

- k: x/1- jkuYn J

(3.53)

where p 0 is the medium density, H r (OJ) and H R (OJ) are pressure impulse response of the transducer in the frequency domain in transmit and receive mode respectively. Ei (OJ) is the Fourier transform of the excitation voltage ei(t), and Em(OJ,ku) denotes the 2D Fourier transform of the measured electrical voltage at time t and transducer position u . The following block diagram illustrates a summary of all the steps taken above.

Ei

HT

p

F
'

(Target)

Em

HR
frequency domain

s

Figure 3.15: Block diagram ofthe pulse-echo response ofthe ultrasound imaging system in the

51

The overall pressure impulse response of the transducer can be defined as: (3.54)

If p 0 and other constant coefficients are absorbed In the an , the SA signal In the (m,ku)domain finally can be expressed as follows:

E (0J,ku)= Ei(m)H(m)LanA(m,ku)exp[ -j~4k -k:xn- JkuYn
2
111

J

n

(3.55)

Em (m, ku) = Ei (m )H(m )A(m, ku )F(kx (m, ku ), ky (m, ku ))
Consequently, the Wavenumber reconstruction algorithm takes the following spatiotemporal matched filter form: (3.56)

Since the desired information is the object function of the ROI in the spatial domain, that is f(x,y), the acquired data in the (m,ku) should be mapped into (kx,ky) via the Stolt mapping. In practice, the measured data S(m,ku) is provided to the user in the form a 2D matrix of evenly spaced samples on a rectangular grid in the ( m, ku). However, due to nonlinear nature of Stolt mapping, the resultant matrix for F ( k x , kY) is unevenly spaced. Furthermore, the knowledge of F(kx, ky) on a uniform rectangular grid is needed to retrieve a sampled version of f(x,y) via 2D FFTs. The solution to this problem is an interpolation from the data on the nonlinear grid to a rectangular grid. There are several interpolation methods in SA imaging but the sine interpolation is used in this thesis. Prior to the interpolation, one more step should be performed. Suppose that the ROI is identified via the regionx E [Xc- X 0 ,Xc + X 0 ], where X c is the mean range and 2X0 is the size of the ROI in the range domain. Therefore the signal F(kx,ky) is a bandpass signal in the

kx domain, because its inverse Fourier transform is centered at x = X c. Recall that the

52

inverse Fourier transform of a lowpass signal in the kx domain has its spectrum centered at

x=O.
For the interpolation step, this signal has to be transformed to the lowpass. This is called baseband conversion of ROI and it is illustrated in the following diagram.
y

X

y

X

Figure 3.16: Baseband conversion of the ROI

The baseband conversion of a ROI is done via: Fb(kx,ky) = F(kx,ky)exp(fkxXJ (3.57)

Now, the origin in the spatial domain (x,y)domain is at the centre of the baseband object function h(kx,ky). The reconstruction equation for the lowpass object function can be rewritten as:

53

This reconstruction algorithm is called amplitude function method in this thesis, since the amplitude functionA(m,ku) should be known for the transducer prior to the reconstruction.

3.6 Synthetic aperture reconstruction via deconvolution
As it can be noticed from the inversion equation of the amplitude function method, before doing any reconstruction, the user should have an accurate knowledge of the transducer electromechanical impulse responses, excitation voltage pulse, and more importantly the amplitude function of the transducer. Measuring or simulating these parameters is not an easy task especially for a focused transducer. An alternative reconstruction algorithm is proposed in this thesis to solve this problem which does not introduce any approximation to the SA algorithm. This algorithm makes use of the response of the system to a reference point target located in the centre of the ROI (Xc, 0) and performs a 2D cross-correlation of this response and the measured response of the system from a predefined ROI. The measured signal from the reference point is called the reference signal and has all the effects of excitation, impulse responses, and amplitude pattern implicit in it. Thus by measuring this signal one has all the information needed for the reconstruction. Consider a ROI that consists of just one point target located at the centre of it. The reference measured signal E1110 in the ( m, ku) domain due to this target can be calculated by substituting (xn,Yn) = (Xc,O) in(3.55). The outcome is shown to be:

E1110 (m,ku)= Ei(m)H(m)A(m,ku)a0 exp[- j~4k

2

-k~ X cJ

(3.59)

Without loss of generality, one can assume that a 0 = 1 therefore, comparing (3.59) and (3.58) the following reconstruction equation can be obtained: 54

(3.60) The discussed algorithm is called the deconvolution method here. Notice that the mapping from (m,ku)to(kx, ky) domains is still done via the Stolt transformation.

3. 7 Synthetic aperture reconstruction via the virtual point method
One approach to deal with SA inversion equation when using a focused transducer is to do a reconstruction via a method called the virtual point. Using geometrical relations one can assume that the wavefront of a transducer is a point at the focus as shown in Figure 3.17 for a single-element concave transducer. The wavefront before the focal point is a converging spherical wave, and beyond the focal point is a diverging spherical wave. Because of the shape of its wavefront the focal point can be considered as a virtual point source of ultrasound energy.

Focal point

Waverr0f1t

Figure 3.17: Idealized wavefront of a concave transducer reprinted from [33]

55

The ideal transducer for the virtual source reconstruction is the one with a highly focused beam pattern. A typical F -number for such a transducer is about 1. When this condition is satisfied the reconstruction can be applied using the simple point transducer assumption discussed in 3.4.3 where the amplitude function was shown to be equal to one. Since all the wavefronts reach the focal point at the same time (with the same delay), applying a simple phase shift in the frequency domain will result in the virtual point reconstruction equation. Therefore the ROI still can be anywhere before or after the focus.

3.8 Synthetic aperture reconstruction via the virtual line method
Moderately focused transducers are the most commonly used in high-frequency imaging systems as they generate a beam pattern that stays focused within a longer area, i.e. larger depth of focus. This effect results in a more uniform lateral resolution in the vicinity of the focal point when the B-mode image is obtained via the conventional reconstruction algorithm. Consequently, such transducers are not ideal for the virtual point source reconstruction. In this section another method is proposed when this is the case. One can assume that the focus of the transducer can be treated as a virtual piston source which acts as a small unfocused transducer of the diameter equal to the beamwidth. Figure 3.18 compares two focused transducers ideal for the two discussed methods. The radiation pattern of this small transducer is similar to that of piston transducer of the same size. This suggests that the amplitude function of a piston transducer can be employed for the reconstruction where the ROI is located after the focus. Since the wavefronts do not reach the virtual line source at the 56

same time, a simple phase shift in the frequency domain cannot be used in the reconstruction equation. Therefore this method is cannot be used for the ROI before the focus.

Virtual point

Virtual line

Figure 3.18: Sketch of a highly focused transducer ideal for a virtual point reconstruction (left) versus a moderately focused transducer ideal for a virtual line reconstruction (right).

3.9 Summary
Thus far the complete model of the ultrasound imaging system has been presented. Based on this model, SA inversion equations have been derived for both focused (concave) and unfocused (piston) transducers. In the case of an unfocused transducer two SA methods are

57

proposed: amplitude function and deconvolution where as in the case of a focused transducer four methods are proposed: amplitude function, deconvolution, virtual point and virtual line. Next Chapter will discuss the methods used in this thesis to validate the hypothesis through a series of simulations and experiments.

58

Chapter 4 Methods
To test our hypothesis, simulations and experiments are performed to obtain the data needed for processing. Although the focus in this project is on the high-frequency imaging and as a result on the concave transducers, the simulations are done for both piston and concave transducers. However, the experiments are carried out using only the concave transducer available in our laboratory.

Figure 4.1: The procedure followed in this research to test the hypothesis

Conventional and several SA imaging algorithms (depending on the transducer type) are implemented on the simulated and measured data and their corresponding lateral resolutions have been calculated to investigate and compare the performance of each method. The 59

diagram presented in Figure 4.1 shows the general approach taken to validate the hypothesis in this research work. In this Chapter, the simulation and measurement parameters are introduced along with the requirements for the sampling in the range (time) and the cross-range domains.

4.1 Simulations
The simulations in this research work were done using Field II for both piston and concave transducers. The imaging medium was assumed to be loss-free. Also the frequency dependant attenuation was not included in any of the simulations.

4.1.1 Field II
Field II is a powerful program for simulating ultrasound transducer fields and ultrasound imaging using linear acoustics. The program is based on the Tupholme and Stepanishen method which is discussed in the previous Chapter. Field II is capable of simulating the emitted and pulse-echo mode fields for both the pulsed and continuous wave case for different transducer geometries. This software scanner is developed by Jorgen Arendt Jensen [34] and at the time being is a free toolbox which runs under MA TLAB. The user should define the geometry of the transducer, input voltage excitation to the transducer, electromechanical impulse response of the transducer for both transmit and receive and the object to image or the "phantom". With these set of data provided to the software, user will be able to calculate emitted field, pulse-echo field, ultrasound RF data, etc ...

60

Field II applies the excitation voltage on the terminals of the transducer. The electromechanical impulse response for the transmitting aperture is the impulse response from this voltage on the terminals to the acceleration of the front face of the transducer multiplied by the density of the medium. Accordingly, the impulse response for the receiving aperture is the impulse response from front face acceleration to voltage on the transducer terminals. In a Field II simulation, the transducer surface is divided into elements of rectangular or triangular shape and then the response of these elements are summed to yield the response. One of the parameters that should be defined before the simulation is the size of these elements. As a standard, the program uses rectangles. For a high precision, one should have small rectangles compared to the distance to the field point. The size of the rectangles must be chosen so that the field point lies in the far-field region. This is given by:

4Awhere lis the distance to the field point and w is the largest dimension of the rectangle. Since Field II currently does not have any commands for moving the transducer, linear scanning was realized by moving the target instead which will give the same effect. The electrical excitation used was a delta impulse and the electromechanical impulse responses of the transducer in both transmit and receive modes were modeled as a 2-cycle Hanning weighted sinusoidal pulse.

61

4.1.2 Simulated image of points phantom The use of the point scatterers as phantom for the imaging system is really advantageous since they nicely conform to the discrete model developed before and also provide the user with the PSF of the system at different spatial location in the ROI. As shown in the previously, investigating the PSF's is the proper method to study the lateral resolution at different depths. To quantify the lateral resolution, the full width at half maximum (FWHM) value of the pressure profile at the location of point will be used. The first step in a SA data simulation is to define a ROI in front of transducer. Suppose that the user is interested in imaging a ROI within the cross-range gate:

YE[-Ya,YaJ
where

(3.61)
(x, y) is observable to

Yo is a constant defined by the user. Given that a point target at

the transducer if it is located within the beam width B of the transducer at (0, u), the following interval can be identified as SA measurement domain:
u E [y- B,y+ B]

(3.62)

Then the SA interval over which the SA data contains contributions from the cross-range gate is:
u
E

[-L,L]

L=B+Ya
The effective ROI in the cross-range domain is denoted by I: and is defined as:

(3.63)

62

~

= 2B+Ya

(3.64)

4.1.3 Data Acquisition and signal processing
Based on the ultrasound system parameters, the constraints on SA data collection are analysed here. The 2D spectral properties of the SA signal will be employed extensively to set the proper time and space sampling criterion to prevent aliasing. Suppose that the ROI in is limited to the region
y
E

[-Yo, Yo]

in the

cross-range

domain,

and to

the

regionxE[Xc -X0 ,Xc+X0 ] in the range domain. The central point in the ROI, that
is (Xc, 0), is called the reference point.

4.1.3.1 Range (time) domain sampling

The time domain samples should be collected over the time domain interval that covers the returns from all of the scatterers within the ROI. Suppose that the closest and the farthest radial range distances of the ROI to the transducer surface are Then the first backscattered signal arrives at the time:
T = 2rmin
s

~nin and~nax,

respectively.

c

(3.65)

Furthermore, the backscattered signal from the farthest point target in the range domain terminates at:

T

=

f

2~nax +2T

c

p

(3.66)

63

where TP denotes the duration of the transmitted pressure pulse p(t). Recall from (3 .53) that
p(t) results from convolving excitation voltage and electromechanical impulse response of

the transducer, this implies that TPis equal to summation of duration of these signals. The above time interval for sampling the SA signal is called the range gate of the SA system. This range gate can be determined from the knowledge of ultrasound system parameters in particular the beamwidth of the transducer in the range and cross-range domains. As it was shown, if a piston transducer is used, these beamwidths change with the frequency. Suppose that the largest half-beamwidth in the cross-range domain is denoted as Bmax then the closest radial distance of the transducer to the ROI is: (3.67) And the farthest radial distance can be obtained from: (3 .68) The ultrasound signal is a bandpass signal with the central frequency of fc and half bandwidth of fo. There are two ways for sampling such signals. One is direct application of the Nyquist sampling frequency to the signal that results in sampling frequencies

!,. ~ 2(fc + fo) .This sampling frequency would lead to an unnecessary high sampling
frequency. An alternative method is by the frequency shift property of the Fourier transform and baseband conversion of the signal. It is obvious that there exist a lowpass complex signal corresponding to the original signal and this signal can be sampled by sampling frequencies
64

as low as 2 fo .This demodulation should practically performed by hardware and needs additional anti-aliasing filters. Since the ultrasound device used for the experimental part of this project does not use this technique, all the developed processing algorithms use the first method for either simulated or real data sampling.

4.1.3.2 Cross-range domain sampling

In section 3.4.9 was shown that the spectral support of SA signal at a temporal frequency
OJ

in the ku domain is:

Thus, the Nyquist sampling constraint in the u domain of the SA signal s( OJ, u) is:
D u~---

2;r

4ksin¢d

(3.69)

where ¢d denotes the divergence angle of the transducer. To select a cross-range sample spacing which is suitable at all available temporal frequencies, the above constraint must be satisfied for the worst case. This is discussed next for the piston and concave transducers.

4.1.4 Piston transducer

For a piston transducer, the divergence angle can be approximated via

65

The u domain Nyquist sampling criterion becomes
Du s - - 4A-/ DY
=

A,

(3 .70)

DY 4

where DY is the transducer diameter. It is evident from the 2D spectral support of the SA signal for the piston transducer in Figure 3.9 that this constraint is independent from the temporal frequency variations. 4.1.5 Concave transducer In the case of a concave transducer of diameter D the divergence angle, the divergence angle was shown to be:

¢d =arctan

(_!}_J 2xr

As it can be noticed from Figure 3.11, this angle is invariant in the temporal frequency domain therefore the worst case for the u domain sample spacing occurs at the highest temporal frequency. In this case the Nyquist constraint in the cross-range domain of the SA signal of a concave transducer is:
2:r Du s - - - 4kmax sin¢d
=-A..:..:..:..:mic:..:.._n_

(3.71)

66

4.2 Simulation parameters for a piston transducer
The transducer used in the simulations has a diameter of 4 mm and the central frequency of the broad-band transmitted pulse is 1.5 MHz. The spatial sampling space used in the simulations (
~u)

is 0.5 mm. Table 4.1 shows other parameters employed. Notation Value 1540 Unit m/s MHz MHz MHz
mm

Parameter name Speed of sound Sampling frequency for data simulation Excitation centre frequency Sampling frequency for data processing Wavelength at centre frequency Bandwidth

c
fs fc

66
1.5 20
~1

hp
A-

fo

0.7

MHz

Table 4.1: Simulation parameters for an unfocused transducer

It is worth noting that sampling frequency for the data simulation fs is different than

fsP which is the sampling frequency for the data processing. The criterion for the latter is
based on the Nyquist sampling theorem where as

fs

is assigned a much higher value to

handle the discontinuities in the spatial frequency response of the transducer. Generally, a higher fs results in a more accurate response however it may result in a very long simulation run-time.

67

It turns out in order to the size of the elements not be a factor in the shape of the

PSF's, the element size for the unfocused transducer has to be smaller than A I 38 which makes the run-time very long.

4.2.1 Amplitude function method
The amplitude function A( w, ku) for the piston transducer has been calculated based on (3.47).

4.2.2 Deconvolution method
The deconvolution method has been introduced as an alternative method to the amplitude function method. The reconstruction equation shown in (3.60) requires two sets of RF data, one is from a reference point at the centre of the imaging area and the other is the RF data from the desired target. The reference data will be used as a 2D matched filter for the target data and perform a cross correlation between these signals in the Fourier domain. When using a piston transducer, the reference point can be located anywhere in front of the transducer. However, the reference point should be in the middle of the ROI.

The simulated B-mode images reconstructed via the conventional, amplitude function and deconvolution methods using a piston transducer are presented in the next Chapter.

68

4.3 Simulation parameters for a concave transducer
The simulations are performed to generate RF data collected with a focused transducer. The transducer has a central frequency of 40 MHz and F-number of 2 which means the focus is 6 mm away from the transducer surface. Table 4.2 shows the parameters used in the simulations. Parameter name Speed of sound Sampling frequency for data simulation Excitation centre frequency Sampling frequency for data processing Wave length at centre frequency Divergence angle Bandwidth Notation Value 1540 600 40 200
~38

Unit m/s MHz MHz MHz
J.Jm

c
Is
fc

fsp
A¢d

~14

Deg MHz

fo

20

Table 4.2: Simulation parameters for a focused transducer

The spatial sample spacing has been calculated using (3.71). For the shown parameters the space between RF lines ( ~u ) is about 20 J.Jm .

69

Surprisingly, the size of the transducer surface elements used for the RF line simulations for a focused transducer was not a crucial factor as it was for the unfocused transducer. The elements size used in the focused transducer simulations was about A I 10 .

4.3.1 Amplitude function method

The reconstruction via the amplitude function method was discussed in the previous Chapter and the final inversion equation was shown in (3.58). Since there is not an analytical expression for the amplitude function in the (OJ, ku) domain for a concave transducer, the corresponding integration over a cross section of the transducer in the imaging plane has been calculated using the numerical methods.

4.3.2 Deconvolution method

The general implementation steps are similar to the method explained in 4.2.2. Since the resolution of a focused transducer is the best possible at the focus, it seems sensible to try the algorithm with a reference point located at the focus of the transducer to improve the resolution beyond the focus. The same algorithm has been implemented for a reference point located out of the focus of the transducer to investigate the performance of the method. Note that theoretically the reference point can be located anywhere in front of the transducer. The only constraint is that the reference point should be in the middle of the ROI.

70

4.4 Experimental parameters
The purpose of the experiments is to compare the lateral resolution of the images reconstructed from the simulated and the measured data. The measurements were carried out using a high-frequency scanner system (V evo 770 from VisualSonics Inc., Toronto). Two types of experimental data were obtained: 1) From a phantom composed of fine steel wires immersed in water and positioned parallel to each other at different depths that would act as point scatterers for the 2D imaging system. 2) From a freshly excised bovine liver tissue.

Parameter name Speed of sound Sampling frequency for data measurement Excitation centre frequency Sampling frequency for data processing

Notation

Value 1540 420 55 420
~28

Unit m/s MHz MHz

c
Is
fc

fsp
A,

MHz
J.lm

Wave length at centre frequency Divergence angle Bandwidth

¢d

~12

Deg MHz

fo

27.5

Table 4.3: Measurement parameters for the focused transducer

71

The transducer is a concave transducer type RMV 708. The relevant parameters of the transducer and the system are listed in Table 4.3. Since all the simulations were based on a linear scanning system, although V evo 770 performs sector scanning, all the reconstructions were done assuming a linear scanning. Note that this assumption is valid only if the shape of chosen RF box is very close to a rectangle not a trapezoid.

4.5 Summary
The hypothesis (page 10) is tested using simulations and experiments. The methods and parameters used in these steps were discussed in this Chapter along with the sampling requirements in the range (time) and cross-range domains ( u) for concave and piston transducers. These sampling criterions have been met in different sets of simulations and experiments which are performed to investigate the merit of the conventional and SA algorithms. The resulted B-mode images are presented in next Chapter.

72

Chapter 5 Results
5.1 Simulation results for a piston transducer
Figure 5.1 shows the simulated conventional B-mode image of three points (relevant simulation parameters in Table 4.1, page 67). Amplitude function and deconvolution methods were used to reconstruct the SA B-mode images of the same points. The corresponding SA images are presented in Figure 5.2 and Figure 5.3. As it can be noticed from these images, both SA methods improve the lateral resolution although the deconvolution method works better than the other two.

Conventional method

'E 30 .s

s

~ c:
C/)

40
50

:0 -ro

~

eo
70 -100 -50
0 lateral distance[mm]

50

100

Figure 5.1: Conventional B-mode image from points phantom.

73

5.1.1 Amplitude function method

E
(.)

Amplitude function method

E -; 30
(i)

~ 40
-100 -50

:0 50

-ro ~

0
lateral distance[mm]

50

100

Figure 5.2: B-mode image from points phantom reconstructed via the amplitude function method.

5.1.2 Deconvolution method

E ';' 30
40 C/) :0 50

E
(.)

Deconvolution method

s

~

-ro

-100

-50

0 lateral distance[mm]

50

100

Figure 5.3: B-mode image from points phantom reconstructed via the deconvolution method.

5.2 Simulation results for a concave transducer
In the following sections, B-mode images from several points phantoms have been reconstructed via different synthetic aperture algorithms and their performances have been compared using the lateral profile of the PSF at multiple depths. The lateral profiles are plotted from the logarithmic compressed data which have been normalized to their maximum value.

74

5.2.1 Amplitude function method

4 4.5

5

'"g
.§. 5.5
c:

~

u ~ 6.5

~

6

7

7.5
-3

-2

-1

0
lateral dis1ance(mm]

2

3

4

Figure 5.4: Conventional B-mode image of point phantom. The focus is at 6 mm.

Amplitude function method

4 4.5

5
.§. 5.5

'E
Q)

u

s
0
{h

6

~ 6.5

~

7 7.5
-3
0
lateral distance(mm)

2

3

4

Figure 5.5: B-mode image from point phantom reconstructed via the amplitude function method.

75

Figure 5.4 shows the conventional image while the SA image reconstructed us1ng the amplitude function method is shown in Figure 5.5. As it can be observed from this image, the amplitude function method leads to unacceptably high sidelobes. The simulated SA images, reconstructed via the alternative methods are presented in Figure 5.6 to Figure 5.1 0.

5.2.2 Deconvolution method

The following sections 5.2.2.1 and 5.2.2.2 include the simulation results for the two proposed deconvolution methods. Note that in all the presented B-mode images reconstructed via the deconvolution method, the reference point is located at the focus unless otherwise stated.

5.2.2.1 Deconvolution with a point at the focus
Here the reference point is positioned at the focus of the transducer. The ROI is centered on the focus. (Xc = 6mm, X 0 = 2mm and

Yo =2mm).

All the target points are located at the

lateral position 0 and equally spaced in the axial direction from 4.5 mm to 7.5 mm. Figure 5.6 shows the B-mode image reconstructed using the deconvolution method. Note that the lateral resolution is more uniform comparing to that of the conventional image in Figure 5.4.

5.2.2.2 Deconvolution with a point out of the focus
The reference point used for the deconvolution is positioned at 8 mm. The ROI is located from 4mm to 12mm in the axial direction and from -2 to 2 in the lateral direction. Point targets are positioned from 5 mm to 10 mm at every 0.5 mm in the axial direction where the lateral position is 0 for all of them.

76

Conventional method

4

4.5 5

E
u
<J,)

..§. 5.5

_g
:0
1.1>

6
6.5
7

~

12

7.5 -2

-3

-1

0
lateral distance(mm)

2

3

4

Deconvolution method

4

4.5
5

E
u
<J,)

§. 5.5
1i)

~

6

:0

~ 6.5
7

7.5

-3

-2

-1

0
lateral distance(mm]

2

3

4

Figure 5.6: B-mode image from point phantom reconstructed with the deconvolution method where the reference point considered at the focus (at 6mm)

77

Figure 5.7 shows both conventional and SA image reconstructed using the deconvolution method. Since the algorithm performs a matched filtering on the target signal, at points close to the reference point (Xc = 8mm) where the PSF of the targets is similar to that of the reference point, the performance of the algorithm in terms of lateral resolution improves significantly comparing to the conventional image.

Conventional image

Deconvolution method

E
~

7

.s
8 :e::
8
:.0
"(;

.s
(I;)

E

7

:s
"(;

~

c:

0

8

~

9

~

9

lateral distance[mm]

lateral distance(mm]

Figure 5.7: B-mode images from point targets. Conventional (left) and SA image reconstructed using the deconvolution with a reference point at 8 mm (right)

78

5.2.3 Virtual source method
Conventional method

6.5

7.5

8

.s
i5
(ij

'E 8.5
~
~ c

~

9.5
10

10.5

11

-2

-1

0
lateral distance[mm]

2

Virtual point method

6 .5 7

7.5

.s ~
(j)

'E 8.5

i5
(ij

~

9.5
10

10.5

11

-2

-1
lateral distance[mm]

Figure 5.8: Conventional versus virtual point method reconstructed images from points phantom

79

5.2.4 Virtual line method
Conventional method

7.5 8

.s
-5
~

E 8.5
g ~
Q)

9 9.5 10 10.5 11

:(

lateral distance[mm]

Virtual line method

6.5

7.5

'E .s
'0
~

8.5

g
9.5 10 10.5 11

~

iii

-2

-1

0
lateral distance[mm]

2

Figure 5.9: Conventional versus virtual line method reconstructed images from points phantom

80

Conventional method

.s.
"C

'E

8.5

.!!!

s

c:

~

9

~ 9.5
10 10.5

iii

11

-2

-1

0
lateral distance[mm)

2

Deconvolution method

.s.
~ c: as ]!
"C

'E

8.5 9 9.5 10 10.5 11

iii

~

-2

-1

0
lateral distance(mm]

2

Figure 5.10: Conventional versus deconvolution method reconstructed images from points phantom

81

In order to compare all four methods, the reconstruction via the deconvolution with a point at the focus has been presented for the same phantom in Figure 5.10.

5.3 Lateral profile

@7.3 mm 0 -20 -40 -60 0 0.5 1.5 2 @9mm 2.5 3 3.5 4

- Conventional - - Deconvolution V-line - - V-point

m
"'C "'C
::J

0

Q) -20

~ -40

- - Conventional - - Deconvolution - - V-Iine - -·-·- V-point

a.

<( -60
-2 0 -20 -40 -60 -2 -1.5 -1 -0.5 -1.5 -1 -0.5

E

0
@10mm

0.5

1.5

2

- - Conventional - - Deconvolution - - V-Iine - - V-point

0

0.5

1.5

2

Lateral distance [mm]

Figure 5.11: Lateral profiles of the points located at 7.3, 9, and 10 mm from the transducer surface.

In order to measure the lateral resolution in the simulated images shown in Figure 5.8 to Figure 5.10, the lateral profile of three of the points at depths 7.3, 9 and 10 were plotted. See Figure 5.11 for a comparison between the proposed methods.
82

The lines were drawn where the maximum amplitude of each PSF was located. Note that all the lines must include all the area that has amplitudes greater than 6 dB below the maximum otherwise the line would not show the accurate lateral resolution. Table 5.1 presents the lateral resolution of the B-mode images reconstructed via the discussed algorithms. Although the ultimate goal of this project was to improve the lateral resolution, the side lobe level has a significant role in the image quality and cannot be ignored. Here the side lobe width at -32 dB is introduced to quantify the performance of each method. Table 5.2 shows the side lobe width of the PSF' s at different depths. Lateral resolution (-6 dB) @7.3mm @9mm @ 10mm 350 J1 m 760 J1 m 880 J1 m 68 Jlm 66 Jlm 60 Jlm 65 Jlm 50 Jlm 44 Jlm 125 J1 m 110 j.Jm 100 J1 m Conventional Deconvolution Virtual point Virtual line

Table 5.1: Lateral resolution values calculated based on -6 dB drop of the maximum amplitude

Side lobe width (-32 dB) @7.3 mm @9 mm @10mm

Conventional

Deconvolution

Virtual point

Virtual line

0.54mm 0.9mm 1.08 mm

0.36mm 0.15mm 0.12mm

0.24mm 0.08 mm 0.08 mm

0.27 mm 0.22 mm 0.22 mm

Table 5.2: Side lobe width values calculated based on -32 dB drop of the maximum amplitude

83

5.4 Experimental results and verification of the simulations
To examine the quality of SA algorithms at a point far from the focus experiments were conducted. A steel wire immersed in a water container was used as a point target. The diameter of the wire was 10 1-1m. Note that the scanning path is perpendicular to the wire so that in a 2D B-mode image it would appear as a point. The reason for choosing a steel wire was the strong reflectivity of the steel. The B-mode images are reconstructed from the captured RF data using the derived SA algorithms. The conventional B-mode is shown in Figure 5.12. See Figure 5.14 for the Bmode image from the same phantom reconstructed via the deconvolution method (with a reference point out of the focus at 7.8 mm), Figure 5.16 for the virtual point reconstruction and Figure 5.18 for virtual line method. Based on the simulation results, a considerable improvement in the lateral resolution of the SA images over the conventional image was expected where the wire is located beyond the focal region. Since the same result was not observed from the simulated B-mode images from the point targets located close to the focal area, another set of experiments with some wires located close to the focus were carried out to investigate the agreement between the simulated and experimental results. The outcomes of these experiments are presented in 5.4.2. The figures below the mentioned images present their corresponding contour plots where -6 dB and -32 dB are shown in red and green respectively.

84

5.4.1 Single wire phantom

5.4.1 .1 Conventional method
conventional image

7 ..-·--·-·------.-

60

E'
E
0

7.2

50
40 30

-; 7.4
(;)

~ 7.6
7.8

~ ~

20
10 -1.5

8
8 . 2 ~-----~------~------~------~------~------L-----~------~

-2

-1

-0.5

0

0.5

1.5

2

lateral distance(mm]

Figure 5.12: Conventional B-mode image of a wire phantom in a water container

-6 db and -32 db contours: Conventional method 7
I I I I I I

I

'E 7.2 f-; 7.4 f(.)

-

E

-

(;;

ttl

c

7.6 f-

15

~

ro 7.8 f8f8.2 -2
I

':":_;:_-;;.~~~~- -·:~
I I I I I
I

-

-1 .5 -1 -0.5 0 0.5 1 1.5

2

lateral distance[mm]

Figure 5.13: Contour plot of the conventional B-mode image shown above

85

5.4.1.2 Deconvolution method

Deconvolution method with a point at 7.2 mm

E
Q)
(.)

7

~
r::::
C'O .......
t/)

60 40 20

7.5

:.0
C'O

~

8
-2
-1 .5 -1 -0.5 0 0.5 lateral distance[mm]

1

1.5

2

Figure 5.14: B-mode image of a wire phantom reconstructed via deconvolution method

-6 db and -32 db contours: deconvolution method
7~----~------~~-----~ ~ ----~ ~ ------~~------~ ~ ------~-----.

E' 7.2r--;; 7.4
(J

-

E

r-

~ 7.6(/)

-

'6 1ii

7.8 -

~

8
-2 -1 .5 -1 -0.5 0
lateral distance[mm]

0.5 1.5

8.2~-----~ ~ ----~------~----~ ~ ------~~------~----~----~

2

Figure 5.15: Contour plot of the B-mode image reconstructed via the deconvolution method

86

5.4.1.3 Virtual point method
Virtual point method

7

60

E
(.)

7.2

E -; 7.4
(;)

50
40
30

~ 7.6
7.8

~ ~

20
10 -1.5 -1

8

-0.5

0.5 0 lateral distance[mm]

1.5

2

Figure 5.16: B-mode image of a wire phantom reconstructed via virtual point method

-6 db and -32 db contours: virtual point method
7~----~------~------~------~----~~----~------~----~

'E 7.2
'Q;' 7.4
(.)

E

~ ., 7.6
a; 7.8
'6

. ~::. -

.. -""
·"

-

~

8
8.2~----~------~------~------~------~----~------~----~

-2

-1 .5

-1

-0.5

0
lateral distance[mm]

0.5

1.5

2

Figure 5.17: Contour plot of the B-mode image reconstructed via the virtual point method

87

5.4.1.4 Virtual line method
Virtual line method

7 ,-----r60

E
(.)

7.2

E -; 7.4

50

40
30

~ 7.6
C/)

~ ~

7.8

20
10 - 1.5

8
8 . 2 L-----~------~------~----~------~------~----~------~

-2

-1

-0.5

0 0.5 lateral distance[mm}

1.5

2

Figure 5.18: B-mode image of a wire phantom reconstructed via virtual line method

-6 db and -32 db contours: virtual line method 7
I I I I I I I

E' 7.2f'V'
(.)

-

E

7.4 f7.6
r-

.!
(/)

'6

a; 7.8,... 88.2 -2
I

-

-~

-·-::.. ~ ·-_.!.

-- ~ · ~

...:::, ~· -..

-

~

I

-1.5

-1

-0.5

0 0.5 lateral distance[mm]

1.5

2

Figure 5.19: Contour plot of the B-mode image reconstructed via the virtual line method

The lateral resolutions of the presented B-mode images were obtained using the -6 dB criterion as with the simulated data. By examining the lateral profile of each method plotted in Figure 5.20, the lateral resolution and side lobe width values were determined. These are presented in Table 5.3.

88

-10

- - Conventional - Deconvolution - - Virtual point ------ Virtual line

-20

m
-c -c
~

Q)

-30

:::l

<( -40

E

0.

-60 -2

-1.5

-1

-0.5

0

0.5

1.5

2

Lateral distance [mm]

Figure 5.20 Lateral profile of the single wire target

Conventional Lateral resolution (-6dB) Side lobe width (-32 dB) 1.3mm 780 11m

Deconvolution 40 fLm

Virtual point 68 fLm

Virtual line 110 11m

1.4mm

2.9mm

1.1 mm

Table 5.3: Lateral resolution and side lobe width values for the single wire target

Another set of experiments were carried out to obtain the RF data from the point targets close to the focus. These RF data were used to perform image reconstruction via the conventional and SA methods. The resulted B-mode images are presented in the following section. 89

5.4.2 Four wire phantom
conventional image

5

E

..§. 5.5
Q)

ro

c

0

00
"U

ro

6

4:

X

-1

-0.5

0.5 0 lateral distance[mm]

Figure 5.21: Conventional image of 4 wires in a water container

5.4.2.1 Deconvolution method
Deconvolution method

5

E

..§. 5.5
Q)

ro

c

0

00
"U

(ij

6

4:

X

6.5

-1

-0.5

0
lateral distance[mm]

0.5

Figure 5.22: B-mode image of 4 wires reconstructed via deconvolution method

90

5.4.2.2 Virtual point method
Virtual point method

5

E

£5.5
u c:
Q)

u;

('IS

'""0

(ij

6

6.5

-1

-0.5

0
lateral distance[mm]

0.5

Figure 5.23: B-mode image of 4 wires reconstructed via virtual point method

5.4.2.3 Virtual line method
Virtual line method 5

E

£5.5
Q)

'""0
('IS

('IS
( I)

u

c:

6

c:(

X

6.5

-1

-0.5

0
lateral distance[mm]

0.5

Figure 5.24: B-mode image of 4 wires reconstructed via virtual line method

91

The purpose of the experiments with the four wire phantom was to explore the quality of the SA reconstructions near the focal point. Figure 5.2lto 5.24 present the discussed B-mode images. The next sets of experiments were performed using an excised bovine liver tissue as target for the imaging system. The objective of these experiments was to observe the speckle pattern associated with the homogeneous liver tissue using the conventional and SA reconstruction algorithms. Note that the defined ROI for different algorithm are chosen based on their necessary requirements; for example for the virtual line reconstruction the ROI has to be located after the focus which is at 4.5 mm for the used transducer. As a result the area before the focus cannot be imaged.

5.4.3 Excised bovine liver target

conventJo nnl image

38
4 4.2 4.4

E
£4.6
Ill

u

I'll

c

4.8 5 5.2

~

iii

x <(

ia

5.4

5.6
5.8
-2

-1.5

-1

-0 .5

0 0.5 lateral distance(mmj

1.5

2

Figure 5.25: Conventional image of excised bovine liver

92

5.4.3.1 Deconvolution method
Deconvolution method 3.8

4
4.2

5.4 5.6 5.8 -2 -1 .5

-1

-0.5

0.5 0 fateral distance[mm)

1.5

2

Figure 5.26: 8-mode image of excised bovine liver reconstructed via deconvolution method

5.4.3.2 Virtual point method
Virtual point method

3.8
4

'E 4.2 .§.

g
.!

Q)

4.4

~ 4.6 ii ~ 4.8

5
5.2 -2
-1

-0.5

0 0.5 lateral dmance[mm]

1.5

2

Figure 5.27: B-mode image of excised bovine liver reconstructed via virtual point method

93

5.4.3.3 Virtual line method
Virtual line method

.§.
c:

'E
~
ell

5
5.2

]? 5.4
"0

~

5.6

5.8
-2

-1 .5

-1

-0.5

0
lateral distance[mm]

0.5

1.5

2

Figure 5.28: B-mode image of excised bovine liver reconstructed via virtual line method

5.5 Discussion of results
The conventional and SA B-mode Images obtained from the simulated RF data of an unfocused transducer (Figure 5.1- Figure 5.3) suggests the following: 1) Both deconvolution and amplitude function SA work better than the conventional algorithm in all regions. 2) The deconvolution method consistently generates a higher resolution than the amplitude function method. Since the focus in this project was on the high-frequency medical imaging applications, we have not conducted any experiments with a piston transducer. In our simulation and experimental results for a focused transducer, B-mode images reconstructed via conventional, deconvolution, amplitude function, virtual point and virtual line methods were acquired.

94

Among these methods, the amplitude function produced unacceptably high side lobes which severely degraded the B-mode image. As previously discussed, the frequency domain model developed in this study is defined over a 2D spatial domain that represents the imaging area. This is just a simplified version of a more realistic imaging geometry in 3D spatial domain. What was considered in our equations was just a cross section of the transducer in the imaging plane however it turns out that the 3D shape of the transducer has a key role in forming the beam pattern of the transducer. While this effect in a flat (piston) transducer is not as dramatic as the effect in the curved transducer, this is thought to be the main reason for the unsuccessful amplitude function reconstruction for a curved transducer. Our simulations suggest that SA approaches cannot improve the lateral resolution in the focal region. This matches our experimental results shown in Figure 5.21 to Figure 5.24. A possible reason might be that the beamwidth in this region becomes very narrow and by going farther in the synthetic aperture domain we do not acquire further more information from the overlapped ultrasound beam. Based on the simulation results presented in Table 5.1 the followings can be deduced: 1) Both the deconvolution and the virtual point methods result in a higher lateral resolution and a narrower side lobe width than the conventional one before and after the focus. 2) The virtual line method improves the lateral resolution and side lobe width comparing to the conventional method only in the region after the focus.
95

The experimental results from the single wire phantom confirm our findings for the lateral resolution improvement in the simulations. However the SA reconstructions from experimental data generally produced a higher side lobe width compared to the conventional method except the virtual line method. The virtual point reconstruction shown in Figure 5.16 looks very fuzzy that might be caused by any or all of the following reasons: 1) Moderate focus of the transducer (F -number =2.25) that is not quite proper for the virtual source assumption. 2) Attenuation causes the geometric focal point not to correspond to the real focal point so the real location of the virtual source is not exactly what is assumed to be and this accordingly results in a phase aberration effect. 3) Speed of sound in our implementation assumed to be 1540 m/s based on the VEVO 770 settings. This device is specifically designed for small animal imaging and the mentioned speed value probably has been set for that application. However the real speed of sound in the water is known to be less (~ 1500 m/s ). This may have caused an error in the virtual point reconstruction which is very sensitive to the phase change.
It is known that matched filter is the optimal filter for maximizing the SNR in the

presence of uncorrelated, additive random noise similar to what exists in the ultrasound signal. Therefore, it is expected that the proposed SA algorithms which involve a matched filtering with a reference signal would improve the SNR. 96

Our experiment with the liver target suggests a higher SNR in the deeper part of the SA images compared to the conventional method where the signal in these depths is very week. The smeared and elliptical speckle pattern observed in the virtual line method is thought to be due to bandpass filtering effect of the amplitude function applied in the reconstruction. Further investigation is needed in order to give a final opinion regarding the effects of the SA reconstruction on the SNR.

97

Chapter 6 Conclusion and future work
6.1 Summary
The synthetic aperture algorithms for high-frequency ultrasound imaging proposed in this thesis are based on the frequency domain model of the imaging system. The fundamental inversion equation common in all the discussed methods is adopted from the radar literature where it is generally called wavenumber or
OJ- K

algorithm. The algorithm obtains the 2D

FFT of the measured ultrasonic signal followed by the 2D matched filter and Stolt mapping. Then a 2D inverse FFT transforms the outcome to time-space domain. In this project, several SA algorithms were implemented for focused and unfocused single- element transducers. The performance of each method was evaluated based on the lateral resolution and side lobe width achieved in the simulated and experimental B-mode Images.

6.2 Conclusion
Frequency domain implementations of SA algorithm improve the lateral resolution in singleelement HFUI if the ROI is located outside of the focal region. However the improvements in the experimental results were not as large as suggested by the simulation results. For the targets located in the vicinity of the transducer focus , SA algorithms do not introduce an improvement to the lateral resolution comparing to the conventional image. To obtain more satisfactory result, there are more issues that need to be addressed such as high sidelobes and 3D nature of the imaging problem.

98

6.3 Future work
The following are the anticipated steps should be taken to improve the SA algorithms developed in this thesis: 1) Apply an arbitrary 2D window function of a varied length such as Hanning, Hamming, or Blackman to improve the current results. It is important to note that although any window function of such types suppresses the side lobes, they also result in loss of resolution. Figure 6.1 shows the target spectral support in (kx, ky) domain for a curved aperture and its corresponding 2D Hamming window function.

Figure 6.1: Depiction of target spectral support for a curved aperture (Left) .A varied length 2D Hamming window applicable to SAR reconstruction (Right) reprinted from[35]

2) Modify the 2D window function to a spatially variant apodization (SV A) function which is introduced by Stankwitz for SAR imaging[36]. The advantage of SVA is that it preserves the resolution and low side lobe of the other window functions. A more simplistic case of SVA called "multiapodization" has also been proposed in [35] which may be adopted in the next step for the current 2D framework. 3) Develop a new 3D frequency domain model of the system which considers a 3D beam pattern.

99

Bibliography

[1]

F. S. Foster, C. J. Pavlin, K. A. Harasiewicz, D. A. Christopher, and D. H. Turnbull, "Advances in ultrasound biomicroscopy," Ultrasound in Medicine and Biology, vol. 26, pp. 1-27, Jan 2000.
I. Daftari, D. Barash, S. Lin, and J. O'Brien, "Use of high-frequency ultrasound imaging to improve delineation of anterior uveal melanoma for proton irradiation," Physics in Medicine and Biology, vol. 46, pp. 579-590, Feb 2001.

[2]

[3]

D. H. Turnbull, B. G. Starkoski, K. A. Harasiewicz, J. L. Semple, L. From, A. K. Gupta, D. N. Sauder, and F. S. Foster, "40-100-Mhz B-Scan Ultrasound Backscatter Microscope for Skin Imaging," Ultrasound in Medicine and Biology, vol. 21, pp. 7988, 1995.
0. Aristizabal, D. A. Christopher, F. S. Foster, and D. H. Tumball, "Measuring blood flow in the mouse embryo," in Ultrasonics Symposium, 1997. Proceedings., 1997 IEEE, 1997, pp. 1489-1492 vol.2.

[4]

[5] [6]

D.Gabor, "A new microscopic principle," Nature, vol. 161, p., 1948. L. J. Cutrona, E. N. Leith, L. J. Porcello, and W. E. Vivian, "On the application of coherent optical processing techniques to synthetic-aperture radar," Proceedings of the IEEE, vol. 54, pp. 1026-1032, 1966. Wiley.C, "Pulsed Doppler radar methods and apparatus." vol. 3, 196,436,1965, U. S. Patent, Ed., 1965. Curtis.J, "Synthetic aperture fundamentals" in Radar Technology, Brookner.E, Ed. norwood: Artech House, 1977. J. L. Walker, "Range-Doppler Imaging of Rotating Objects," Aerospace and Electronic Systems, IEEE Transactions on, vol. AES-16, pp. 23-52, 1980. 100

[7]

[8]

[9]

[1 OJ

C. V. Jakowatz and P. A. Thompson, "A new look at spotlight mode synthetic aperture radar as tomography: imaging 3-D targets," Image Processing, IEEE Transactions on, vol. 4, pp. 699-703, 1995. M. Soumekh, Fourier array imaging. Englewood Cliffs, N.J.: PTR Prentice-Hall, 1994. P. D. Corl, P.M. Grant, and G. S. Kino, "A Digital Synthetic Focus Acoustic Imaging System for NDE," in 1978 Ultrasonics Symposium, 1978, pp. 263-268. M. Karaman, L. Pai-Chi, and M. O'Donnell, "Synthetic aperture imaging for small scale systems," Ultrasonics, Ferroelectrics and Frequency Control, IEEE Transactions on, vol. 42, pp. 429-442, 1995. G. R. Lockwood, J. R. Talman, and S. S. Brunke, "Real-time 3-D ultrasound imaging using sparse synthetic aperture beamforming," Ultrasonics, Ferroelectrics and Frequency Control, IEEE Transactions on, vol. 45, pp. 980-988, 1998. S. Nikolov, K. Gammelmark, and J. A. Jensen, "Recursive ultrasound imaging," in Ultrasonics Symposium, 1999. Proceedings. 1999 IEEE, 1999, pp. 1621-1625 vol.2. C. Passmann and H. Ermert, "A 100-MHz ultrasound imaging system for dermatologic and ophthalmologic diagnostics," Ultrasonics, Ferroelectrics and Frequency Control, IEEE Transactions on, vol. 43 , pp. 545-552, 1996. H. Ermert and R. Karg, "Multifrequency Acoustical Holography," Sonics and Ultrasonics, IEEE Transactions on, vol. 26, pp. 279-285, 1979. C. H. Frazier and W. D. O'Brien, Jr., "Synthetic aperture techniques with a virtual source element," Ultrasonics, Ferroelectrics and Frequency Control, IEEE Transactions on, vol. 45, pp. 196-207, 1998. K. Nagai and K. Nagai, "Fourier domain reconstruction of synthetic focus acoustic imaging system" Proceedings of the IEEE, vol. 72, pp. 748-749, 1984. L. J. Busse, "Three-dimensional imaging using a frequency-domain synthetic aperture focusing technique," Ultrasonics, Ferroelectrics and Frequency Control, IEEE Transactions on, vol. 39,pp.174-179, 1992. J. T. Ylitalo, J. T. Ylitalo, and H. Ermert, "Ultrasound synthetic aperture imaging: monostatic approach" Ultrasonics, Ferroelectrics and Frequency Control, IEEE Transactions on, vol. 41, pp. 333-339, 1994.

[11]

[12]

[13]

[14]

[15]

[16]

[17]

[18]

[19]

[20]

[21]

101

[22]

T. Stepinski and T. Stepinski, "An Implementation of Synthetic Aperture Focusing Technique in Frequency Domain," Ultrasonics, Ferroelectrics and Frequency Control, IEEE Transactions on, vol. 54, pp. 1399-1408, 2007. R. S. C. Cobbold, Foundations of biomedical ultrasound. New York: Oxford University Press, 2007. J. W. Goodman, Introduction to Fourier optics, 2nd ed. New York: McGraw-Hill, 1996. P.M. Morse and H. j. a. Feshbach, Methods of theoretical physics [by] Philip M Morse [and] Herman Feshbach. New York,: McGraw-Hill, 1953. M. Soumekh, Synthetic aperture radar signal processing with MA TLAB algorithms. New York: J. Wiley, 1999. P. T. Gough and D. W. Hawkins, "Unified framework for modem synthetic aperture imaging algorithms," International Journal of Imaging Systems and Technology, vol. 8,pp. 343-358,1997. C. Cafforio, C. Cafforio, C. Prati, and F. Rocca, "SAR data focusing using seismic migration techniques" Aerospace and Electronic Systems, IEEE Transactions on, vol. 27,pp. 194-207,1991. R. Bamler and R. Bamler, "A comparison of range-Doppler and wavenumber domain SAR focusing algorithms," Geoscience and Remote Sensing, IEEE Transactions on, vol. 30,pp. 706-713,1992. P. T. Gough, P. T. Gough, and D. W. Hawkins, "Imaging algorithms for a strip-map synthetic aperture sonar: minimizing the effects of aperture errors and aperture undersampling" Oceanic Engineering, IEEE Journal of, vol. 22, pp. 27-39, 1997. P. R. Stepanishen, "The Transient Response of Arrays of Transducers," The Journal of the Acoustical Society ofAmerica, vol. 50, pp. 964-974, 1971. P.R. Stepanishen, "The Time-Dependent Force and Radiation Impedance on a Piston in a Rigid Infinite Planar Baffle," The Journal of the Acoustical Society ofAmerica, vol. 49, pp. 841-849, 1971. S. Nikolov and J. A. Jensen, "Virtual ultrasound sources in high-resolution ultrasound imaging," in Medical Imaging 2002: Ultrasonic Imaging and Signal Processing, San Diego, CA, USA, 2002, pp. 395-405.

[23]

[24]

[25]

[26]

[27]

[28]

[29]

[30]

[31]

[32]

[33]

102

[34]

J. A. Jensen and J. A. Jensen, "A new approach to calculating spatial impulse responses," in Ultrasonics Symposium, 1997. Proceedings., 1997 IEEE, 1997, pp. 1755-1759 vol.2. L. Wang, X. Huang, Z. Zhou, and X. Sun, "Control sidelobes in UWB SAR images," in Geoscience and Remote Sensing Symposium, 2005. IGARSS '05. Proceedings. 2005 IEEE International, 2005, pp. 4630-4632. H. C. Stankwitz, R. J. Dallaire, and J. R. Fienup, "Nonlinear apodization for sidelobe control in SAR imagery," Aerospace and Electronic Systems, IEEE Transactions on, vol. 31, pp. 267-279, 1995.

[35]

[36]

103


