DAY-AHEAD ELECTRICITY PRICE AND SPIKE FORECASTING USING MACHINE LEARNING TECHNIQUES

by Harmanjot Singh Sandhu M.Tech., Punjab Technical University, Punjab, India, 2011 B.Tech. (Electronics & Comm. Eng.) Punjab Technical University, Punjab, India, 2002

A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of Doctor of Philosophy in the Program of Mechanical and Industrial Engineering

Toronto, Ontario, Canada, 2018 © H. S. Sandhu 2018

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A DISSERTATION

I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners.

I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

I understand that my dissertation may be made electronically available to the public.

ii

Day-ahead Electricity Price and Spike Forecasting Using Machine Learning Techniques

Doctor of Philosophy, 2018 Harmanjot Singh Sandhu Mechanical and Industrial Engineering Ryerson University

Abstract

Various machine learning-based methods and techniques are developed for forecasting day-ahead electricity prices and spikes in deregulated electricity markets. The wholesale electricity market in the Province of Ontario, Canada, which is one of the most volatile electricity markets in the world, is utilized as the case market to test and apply the methods developed. Factors affecting electricity prices and spikes are identified by using literature review, correlation tests, and data mining techniques. Forecasted prices can be utilized by market participants in deregulated electricity markets, including generators, consumers, and market operators. A novel methodology is developed to forecast day-ahead electricity prices and spikes. Prices are predicted by a neural network called the base model first and the forecasted prices are classified into the normal and spike prices using a threshold calculated from the previous year's prices. The base model is trained using information from similar days and similar price days for a selected number of training days. The spike prices are re-forecasted by another neural network. Three spike forecasting neural networks are created to test the impact of input features. The overall forecasting is obtained by combining the results from the base model and a spike forecaster. Extensive numerical experiments are carried out using data from the Ontario electricity market, showing significant improvements in the forecasting accuracy in terms of various error measures. iii

The performance of the methodology developed is further enhanced by improving the base model and one of the spike forecasters. The base model is improved by using multi-set canonical correlation analysis (MCCA), a popular technique used in data fusion, to select the optimal numbers of training days, similar days, and similar price days and by numerical experiments to determine the optimal number of neurons in the hidden layer. The spike forecaster is enhanced by having additional inputs including the predicted supply cushion, mined from information publicly available from the Ontario electricity market's day-ahead System Status Report. The enhanced models are employed to conduct numerical experiments using data from the Ontario electricity market, which demonstrate significant improvements for forecasting accuracy.

iv

Acknowledgements

I would like to express sincere gratitude to my supervisors, Professor Liping Fang, Department of Mechanical and Industrial Engineering, and Professor Ling Guan, Department of Electrical and Computer Engineering, for their continuous guidance, constant encouragement, invaluable supervision, critical thinking and kind understanding throughout the period of my PhD studies. I have learned valuable lessons and have nice memories from their distinct excellent qualities, vision, personalities and professionalism.

I am also thankful to my PhD Committee Members, Professor Guoqing Zhang, Department of Mechanical, Automotive and Materials Engineering, University of Windsor, Professor Bala Venkatesh, Department of Electrical and Computer Engineering, Ryerson University, Professors Ahmad Ghasempoor, Cory Searcy and Saeed Zolfaghari, Department of Mechanical and Industrial Engineering, Ryerson University, for their valuable comments and suggestions that improved the quality of this thesis.

I also want to acknowledge the unique research environment of Ryerson University and cordial help and support from all faculty and staff members of the Department of Mechanical and Industrial Engineering, Ryerson University, Toronto, Canada.

I am grateful to the members of the Ryerson Multimedia Laboratory in Toronto and thank you all for your friendship, unconditional support and valued assistance. In particular, I would like to thank Lei Gao for helping in the multi-set canonical correlation analysis (MCCA) algorithm. The valuable information and data provided by personnel of the Ontario Independent Electricity System Operator (IESO), specifically Ms. Karla Mann, is greatly appreciated.

I have no words to acknowledge the selfless sacrifices of my parents. I express my gratitude and love to my wife, son, daughter and all family members for continuous support and encouragement during my graduate studies.

v

Table of Contents

Declaration Abstract List of Tables List of Figures List of Nomenclature 1 Introduction

ii iii ix xi xiv 1

1.1 Electricity Markets ....................................................................................................... 1 1.2 Importance of Electricity Price Forecasting ................................................................. 3 1.3 Objectives of the Research ........................................................................................... 4 1.4 Organization of the Thesis............................................................................................ 4 2 Literature Review 6

2.1 Introduction .................................................................................................................. 6 2.2 Price Forecasting Techniques ....................................................................................... 6 2.3 Spike Forecasting Techniques .................................................................................... 10 2.4 Electricity Market Selection ....................................................................................... 13 2.5 Summary..................................................................................................................... 16 3 Overview of the Ontario Electricity Market 18

3.1 Introduction ................................................................................................................ 18 3.2 History of the Ontario Electric Power Industry .......................................................... 18 3.3 Current Ontario Electricity Market ............................................................................ 20 3.3.1 3.3.2 3.3.3 3.3.4 General Information ....................................................................................... 20 Market Clearing Prices ................................................................................... 22 Demand Response Programs .......................................................................... 24 Price Forecasting Horizon .............................................................................. 25

3.4 Participants of the Current Ontario Electricity Market .............................................. 26 3.4.1 3.4.2 Main Sectors ................................................................................................... 26 Participation in the Ontario Electricity Market .............................................. 27 vi

3.5 Prices and Demand of the Ontario Electricity Market ............................................... 29 3.5.1 3.5.2 Electricity Prices ............................................................................................. 29 Market Demand .............................................................................................. 30

3.6 Volatility Analysis ...................................................................................................... 31 3.7 Summary..................................................................................................................... 36 4 Day-ahead Price Forecasting 37

4.1 Introduction ................................................................................................................ 37 4.2 A Neural Network based Methodology for Forecasting Day-ahead Electricity Prices and Spikes ........................................................................................................ 37 4.3 Initial Electricity Price Forecasting ............................................................................ 40 4.2.1 4.2.2 4.2.3 Data Mining Process for Selecting Training Data Sets .................................. 40 Training Process of the Neural Network ........................................................ 44 Initial Price Forecasting Results ..................................................................... 47

4.4 Day-ahead Spike Forecasting ..................................................................................... 49 4.4.1 Framework of the Proposed Hybrid Method for Electricity Price and Spike Forecasting ........................................................................................... 51 4.4.2 Training Data Sets of Network 2, 3, and 4 ..................................................... 52

4.5 Combined Forecasting Results ................................................................................... 55 4.6 Method Effectiveness ................................................................................................. 62 4.7 Summary..................................................................................................................... 63 5 Day-ahead Electricity Price Forecasting Utilizing Multi-set Canonical Correlation Analysis and Neural Networks 65

5.1 Introduction ................................................................................................................ 65 5.2 Initial Electricity Price Forecasting Approach ........................................................... 67 5.3 Multi-set Canonical Correlation Analysis (MCCA)................................................... 70 5.3.1 5.3.2 Introduction to MCCA ................................................................................... 70 Selection of Input Features Using MCCA...................................................... 72

5.4 Results of Electricity Price Forecasting Utilizing MCCA ......................................... 80 5.5 Combined Forecasting Results of Electricity Prices and Spikes ................................ 91 5.6 Summary..................................................................................................................... 96 vii

6

Day-ahead Electricity Spike Price Forecasting Using Supply Cushion

98

6.1 Introduction ................................................................................................................ 98 6.2 Analysis of Explanatory Variables from the System Status Report ........................... 99 6.3 Spike Forecasting Using a Neural Network (Net 5) ................................................. 102 6.3.1 6.3.2 Training of Net 5 .......................................................................................... 103 Spike Forecasting Results............................................................................. 105

6.4 Numerical Experimental Results and Discussions ................................................... 106 6.5 Summary................................................................................................................... 115 7 Contribution and Future Work 116

7.1 Summary of Contributions ....................................................................................... 116 7.2 Future Work.............................................................................................................. 117 Appendcies Sample Represntative Data A.1 Sample Data Set for Price Forecasting Model Representing One of the Training Days ........................................................................................................... 119 A.2 Sample Calculations for Five Similar Price Days Corresponding to December 22, 2011 ................................................................................................... 120 A.3 Selection of 10 Peak Prices in Spike Forecasting Model - Net 3 ............................. 121 References 122 119

viii

List of Tables

3.1 Number of Spikes over 24 Hours in 2009 to 2014 ..................................................... 34 4.1 Forecasting Day-ahead Electricity Prices and Spikes using Neural Networks .......... 59 4.2 Comparison of Neural Networks based Methods in terms of MAPE, RMSE and MAE ........................................................................................................................... 61 4.3 Comparison of Spike Days MAPE to Illustrate the Effectiveness of the Method ..... 63 5.1 Comparisons with Other Forecasting Studies ............................................................ 69 5.2 Correlation between Different Similar Price Days with Seelcted Similar Days Corresponding to 45 Training Days ........................................................................... 76 5.3 Correlation between Different Similar Price Days with Seelcted Similar Days Corresponding to 55 Training Days ........................................................................... 77 5.4 Correlation between Different Similar Price Days with Seelcted Similar Days Corresponding to 60 Training Days ........................................................................... 78 5.5 Maximum Percentage Correlation and Corresponding Numbers of Similar Days and Similar Price Days for a Given Number of Training Days Using MCCA .......... 80 5.6 MAPEs for Different Days in the Year of 2012 with 3, 7, 10, 12 and 15 Hidden Neurons....................................................................................................................... 81 5.7 Various Forecasting Error Measures with 12 Hidden Neurons .................................. 87 5.8 Comparison of Error Measures with other Forecasting Studies ................................. 88 5.9 Comparison of MAPEs for the Selected Eight Days as Reported in Sandhu et al. (2016b) ....................................................................................................................... 89 5.10 Comparison of MAPEs for Selected 30 Days in the Year of 2012 as Reported in Chapter 4 .................................................................................................................... 90 5.11 Combined Forecasting Results by the Combination of Enhanced Base Model and Net 3 ........................................................................................................................... 92 5.12 Various Forecasting Error Measures Using the Combination of the Enhanced Base Model and Net 3 ......................................................................................................... 95 5.13 Comparison of MAPE and MAE Values to Illustrate the Effectiveness of the ix

Proposed Method ........................................................................................................ 96 6.1 Forecasting Day-ahead Electricity Prices and Spikes Using the Enhanced Base Model and Net 5 ....................................................................................................... 107 6.2 Combined Forecasting Results by the Combination of Enhanced Base Model with Net 3 and Net 5 ......................................................................................................... 112 6.3 Various Forecasting Error Measures Using the Combination of Enhanced Base Model and Net 5 ....................................................................................................... 114

x

List of Figures

1.1 Organization of the Dissertation ................................................................................... 5 2.1 Illustration of Spikes in the Prices of the Ontario Electricity Market ........................ 11 2.2 Graphical Representation of Relationships between Demand and Prices for the Year of 2011 in the Ontario Electricity Market .................................................................. 14 2.3 Graphical View of Relationships between Temperature and Electricity Prices ......... 15 2.4 Ontario Electricity Prices verses Time-of-use in 2011............................................... 16 3.1 Reorganization of Ontario Hydro by the 1998 Ontario Electricity Act ..................... 19 3.2 Installed Electricity Generation Capacities of Different Resources in Ontario in 2017 ............................................................................................................................ 21 3.3 Market Clearing Prices with respect to Demand and Supply ..................................... 23 3.4 Participation in the Ontario Electricity Market .......................................................... 28 3.5 Monthly Average HOEP from January 1, 2011 to December 31, 2013 ..................... 29 3.6 Monthly Maximum HOEP from January 1, 2011 to December 31, 2013 ................. 30 3.7 Monthly Average and Maximum Demand from January 1, 2011 to December 31, 2013 ............................................................................................................................ 31 3.8 Ontario Electricity Prices verses Demand in 2011 ..................................................... 32 3.9 Ontario Electricity Prices verses Time-of-use in 2011............................................... 32 3.10 Numbers of Spike Hours and Spike Days from 2009 to 2014 ................................... 33 3.11 Historical Volatilities of Each Hour for the Year of 2011 ......................................... 35 4.1 Outline of a Neural Network based Methodology for Forecasting Day-ahead Electricity Prices and Spikes ...................................................................................... 39 4.2 Selection of the Total Number of Training Days ....................................................... 41 4.3 Selection of the Number of Similar Days Corresponding to Each Training Day ...... 42 4.4 Selection of Total Number of Training Days and Number of Similar Days Corresponding to Each Training Day................................................................ 43 4.5 Trained Neural Network to Forecast Electrcity Prices ............................................... 45 xi

4.6 Selection of Hours on Timeline for the Forecasting and Past Days ........................... 46 4.7 Forecasting Results for January 3, 2012 (Tuesday) ................................................... 48 4.8 Forecasting Results for June 20, 2012 (Wednesday) ................................................. 48 4.9 Forecasting Results for October 7, 2012 (Sunday) .................................................... 49 4.10 Hybrid Neural Network-based Model to Forecast Day-ahead Prices ........................ 52 4.11 Neural Network, Net 2, to Forecast Day-ahead Spikes .............................................. 54 4.12 Illustration of Day-ahead Spike and Price Forecasting for January 3, 2012 .............. 56 4.13 Illustration of Day-ahead Spike and Price Forecasting for June 28, 2012 ................. 56 4.14 Illustration of Day-ahead Spike and Price Forecasting for July 6, 2012 .................... 57 4.15 Illustration of Day-ahead Spike and Price Forecasting for July 17, 2012 .................. 57 4.16 Illustration of Day-ahead Spike and Price Forecasting for August 4, 2012 ............... 58 5.1 Base Electricity Price and Spike Forecasting Model and its Enhancements.............. 66 5.2 Electricity Price Forecasting Using Net 1 .................................................................. 68 5.3 Process of Using MCCA to Select the Number of Training Days, Number of Similar Days, and Number of Similar Price Days ...................................................... 73 5.4 (a) Selection of the Total Numebr of Training Days .................................................. 74 (b) Selection of the Total Number of Similar Days Corresponding to Each Training Day ........................................................................................................................ 74 5.5 Correlation between Different Similar Price Days and Similar Days Given 55 Training days Using MCCA ....................................................................................... 79 5.6 Comparison of MAPEs with Different Numbers of Hidden Neurons for Four Representative Days ................................................................................................... 82 5.7 Price Forecasting for January 3, 2012 (Tuesday) with Different Number of Hidden Neurons....................................................................................................................... 83 5.8 Price Forecasting for March 2, 2012 (Friday) with Different Number of Hidden Neurons....................................................................................................................... 84 5.9 Price Forecasting for June 28, 2012 (Thursday) with Different Number of Hidden Neurons....................................................................................................................... 84 5.10 Price Forecasting for July 6, 2012 (Friday) with Different Number of Hidden Neurons....................................................................................................................... 85 5.11 Price Forecasting for October 6, 2012 (Saturday) with Different Number of Hidden xii

Neurons....................................................................................................................... 85 5.12 Comparison of Price Forecasting for January 3, 2012 (Tuesday) Using the Enhanced Base Model and the Combination of the Enhanced Base Model with Net 3 ............. 93 5.13 Comparison of Price Forecasting for June 28, 2012 (Thursday) Using the Enhanced Base Model and the Combination of the Enhanced Base Model with Net 3 ............. 94 5.14 Comparison of Price Forecasting for July 6, 2012 (Friday) Using the Enhanced Base Model and the Combination of the Enhanced Base Model with Net 3 ............. 94 6.1 Relationships between the Day-ahead Total Ontario Demand and HOEP for the Year of 2011 ............................................................................................................. 100 6.2 Relationships between the Predicted Supply Cushion and HOEP for the Year of 2011 .......................................................................................................................... 102 6.3 Enhanced Spike Forecasting Neural Network (Net 5) ............................................. 104 6.4 Electricity Price Forecasting for July 17, 2012 Using the Combination of the Enhanced Base Model and Net 5.............................................................................. 105 6.5 Electricity Price Forecasting for August 4, 2012 Using the Combination of the Enhanced Base Model and Net 5.............................................................................. 106 6.6 Results by Using the Enhanced Base Model with Combinations with Net 3 and Net 5 for January 3, 2012 ......................................................................................... 109 6.7 Results by Using the Enhanced Base Model with Combinations with Net 3 and Net 5 for March 4, 2012 ........................................................................................... 110 6.8 Results by Using the Enhanced Base Model with Combinations with Net 3 and Net 5 for June 28, 2012 ............................................................................................ 110 6.9 Results by Using the Enhanced Base Model with Combinations with Net 3 and Net 5 for July 17, 2012 ............................................................................................. 111 6.10 Results by Using the Enhanced Base Method with Combinations with Net 3 and Net 5 for August 4, 2012 .......................................................................................... 111

xiii

List of Nomenclature

  2
 ()     

Standard deviation of prices Mean price value calculated over a previous given period of time Error Variance Hourly price volatility for hour i over N time frames for k numbers of days Demand at hour t on day n Demand at spike price time Training days from the previous year, before the forecasting day Training days from the previous year, after the forecasting day Training days from the same year, before the forecasting day Euclidean distance Total number of hours for which the forecasted error is calculated Total number of similar days Similar days from the previous year, before the training day Similar days from the previous year, after the training day Similar days from the same year, before the training day Actual hourly prices Average of actual prices Forecasted hourly prices Price at hour t on day n Spike price Threshold value

d2011,- d2011,+ d2012,- ,  h N N P,- N P,+ NS    
 

  PTH

xiv

 +1

Average of the five selected similar price days at hour t + 1 Forecasted price at hour t Predicted Demand at spike hour t Predicted Supply Cushion at spike hour t Logarithmic return average Logarithmic return for hour i of the selected day d Similar days prior to the day before the training day in the same year Similar days before the training day in the previous year Similar days after the training day in the previous year Training days prior to the day before the forecasting day in the same year Training days before the forecasting day in the previous year Training days after the forecasting day in the previous year Autoregressive Integrated Moving Average Back-propagation Correlation Analysis Canadian Dollar Canonical Correlation Analysis Demand Response Dispatch Scheduling Optimizer Demand and Supply Plan Electricity Conservation and Supply Task Force Electrical Safety Authority Forecast Mean Square Error Generalized Autoregressive Conditional Heteroskedasticity xv

 
       

SD Y,- SD Y-1,- SD Y-1,+ TDY,- TDY-1,- TDY-1,+ ARIMA BP CA CAD CCA DR DSO DSP ECSTF ESA FMSE GARCH

HEC HEPCO HOEP Hr IESO IMO kWh MAPD MAPE MARS MCCA MCP MI MR MSE MW NEM Net 1 Net 2 Net 3 Net 4 Net 5 NIS NSA

Hydro Electric Commission Hydro-Electric Power Commission of Ontario Hourly Ontario Energy Prices Hour Independent Electricity System Operator Independent Market Operator Kilowatt Mean Absolute Percentage Deviation Mean Absolute Percentage Error Multivariate Adaptive Regression Splines Multi-set Canonical Correlation Analysis Market Clearing Prices Mutual Information Modified Relief Mean Square Error Megawatt National Electricity Market Neural Network 1 Neural Network 2 Neural Network 3 Neural Network 4 Neural Network 5 Net Interchange Schedule Numerical Sensitivity Analysis

xvi

OEFC OPA OPG OR PCA PDD PDF PDP PEO PJM POR PSC PTD RMSE RPP SD SOM SSR SVM TD TF TWh

Ontario Electricity Financial Corporation Ontario Power Authority Ontario Power Generation Operating Reserve Principal Component Analysis Pre-Dispatch Demand Probability Density Function Pre-Dispatch Prices Predicted Energy Offered Pennsylvania-New Jersey-Maryland Predicted Operating Reserve Predicted Supply Cushion Predicted Market Demand Root Mean Square Error Regulated Price Plan Similar days Self Organizing Map System Status Report Support Vector Machine Training days Transfer Function Terawatt

xvii

CHAPTER 1 Introduction

1.1

Electricity Markets Electricity may be considered as a special type of commodity whose generation and

consumption occur simultaneously. The generation can be controlled, but electricity cannot be easily stored (Kaminski, 2012). Therefore, the demand generated by the consumer market determines the level of electricity generation. Average world energy consumption is projected to increase by 48% from 2012 to 2040 with about 50% consumption in the industrial sector, which is a growth of 1.4% per year (EIA, 2016). Traditionally, generation and distribution of electricity were vertically integrated into state-owned or state-controlled utilities with supply overcapacity in many countries and regions. Major economies of the world have restructured electricity generation and distribution from vertically integrated operations to deregulated markets. Market competition increases the affordability and dependability of the services, and consumers of electricity can choose among a set of energy providers. Hourly, half-hourly, five-minute interval electricity prices are determined during a day, considering various economic and operational factors by operators in a deregulated market. Therefore, price uncertainty is a major challenge faced by operators in these competitive markets. The competitive electricity markets around the world may be categorized as singlesettlement electricity markets or two-settlement electricity markets depending upon the design and organizational implementation of generation and transmission systems (Veit et al., 2006). Electricity prices in a single-settlement market, also known as real-time market, are settled on hourly, half-hourly, or five-minute bases depending on the demand and available supply. On the other hand, electricity prices for demand and supply, in a two or multi-settlement electricity market, depend on the day-ahead and real-time operation of the market. In a two-settlement market, day-ahead electricity demand and available supply are used to determine electricity prices and the difference between the proposed and actual demand and supply is covered using a 1

real-time market. Trading of electricity in these competitive markets is carried out through spot markets, forward markets, or bilateral contracts. The spot market may have to buy energy or drop the generation facilities, according to the demand of the market in real time. These types of markets are more volatile and may lead to high prices during high demand periods. Incentives and special offers are given to promote the market participation. On the other hand, a multisettlement market allows users and generators to clear the market prices on day-ahead basis and can increase or decrease their offers or bids at a later stage. These adjustments are carried out in spot markets. The prices are more stable in multi-settlement markets, but incentives and opportunities for the participants are limited. Large electricity consumers try to minimize their electricity cost using various load management strategies to shift peak demand and generate electricity using on-site distributed generation facilities. Therefore, in order to optimize the operation of market participants, it is important to forecast the future electricity market prices. The Ontario power grid has significant direct and indirect interconnections with New York, the Midwest, New England and the Pennsylvania-New Jersey-Maryland (PJM) markets and is also connected to the power grids of Quebec and Manitoba. The Ontario electricity market, which is selected for this research, is a single settlement market and works only as a real-time market, while other neighboring North American electricity markets work as both day-ahead and real-time markets. This makes that the Ontario electricity market is more volatile (Zareipour et al., 2007b). In Ontario, only one generating company (Ontario Power Generation (OPG)), irrespective of the deregulation, has more than 70% of the generating capacity of the electricity market. To participate in the market as a wholesaler or retailer, participants have to meet certain terms and conditions. Large volumes of data have been collected by electricity markets. In smart grids massive data are collected from various sources like: data from behavioural activities of consumers; demand data generated by the market; pricing and bidding data; forced outage; control and management data for power generation, transmission and distribution; grid operating and instruction data; time-of-use data and weather data. Valuable information can be extracted from the collected data using various simulation and analytical techniques (Bastian et al., 1999; Shahidehpour et al., 2002). A competitive electricity market has massive data available for public to obtain historical information and to study. Datasets are available for past years and may include raw information for historical values of demand, prices, available supply, operating 2

reserves and climate variables such as temperature and humidity. This information is available on the hourly, half-hourly or five-minute basis in most of the electricity markets. These data sets can be analyzed using various machine learning techniques, including data mining, clustering, classification, artificial intelligence, and regression techniques to obtain useful knowledge and to develop new strategies for the electricity market.

1.2

Importance of Electricity Price Forecasting Forecasting of electricity prices is important for all market participants. In particular, all

industry stakeholders can use information to analyze cash flow, capital budgeting, rule-making and resource planning. In short term forecasting, over an hour to a few days, information is important for participants to optimize their bidding and offering strategies along with decisions when to shift to on-site generation facilities to maximize profits. Medium term and long term forecasting information is used for bilateral contracting, budgeting, maintenance scheduling, and resources planning. Price forecasting methods can be divided into two major categories: simulation based methods and analysis based methods. Simulation based methods can provide a more detailed review of the prices, but require insight details of physical processes of the market, such as demand bids, supply offers and market constraints (Amjady, 2012). Practically, market participants cannot use simulation based methods without analyzing these details. Analysis based methods, however, are more flexible, require less data detail and are adaptable to the conditions of market participants. These methods use historical data to forecast future prices. Electricity prices are affected by various controllable and uncontrollable factors. Some of these factors can be identified as: supply from different resources into the market, demand from consumers, market uncertainty, weather conditions such as temperature and humidity, and generators switching from low operating cost to high operating cost ones (Aggarwal et al., 2009). Various other factors are also responsible for price variations in a deregulated electricity market, such as: season of the year and time of day, industrial activities, price hikes in oil/gas, sudden breakdown of low cost operating generators, and uncertainty about the load (Mount and Oh, 2004). Sometime, suppliers deliberately increase prices by withholding the capacity to shift the supply-demand curve for economical gains (Guan et al., 2001; Duan et al., 2005).

3

1.3

Objectives of the Research The overall objective of this research is to develop machine learning-based methodologies

to forecast day-ahead (twenty-four hour ahead) electricity prices and spikes in deregulated electricity markets. The wholesale electricity market in the Province of Ontario, Canada, one of the most volatile electricity markets in the world, will be utilized as the case market to test and apply the methods and techniques developed in this thesis. Factors affecting electricity prices and spikes will be investigated by carrying out detailed reviews of the literature and analyzing data from the Ontario electricity market. Various machine learning methods and techniques will be used to forecast day-ahead prices and spikes. Performance of the methods and techniques developed in this thesis will be assessed by using various forecasting error measures and compared to results reported in the literature.

1.4

Organization of the Thesis This thesis is organized into seven Chapters, as shown in Figure 1.1. A detailed literature

review on electricity price and spike forecasting is reported in Chapter 2. A review of the Ontario electricity market, including analyses of prices and demand as well as price volatilities, is presented in Chapter 3. A novel methodology to forecast electricity prices and spikes is developed, tested, and applied in Chapter 4. The base model developed in Chapter 4 is enhanced by utilizing a popular technique used in data fusion in Chapter 5. The spike forecasting method presented in Chapter 4 is improved by mining the information from the System Status Report publicly available from the Ontario electricity market in Chapter 6. The contributions of this thesis and future research directions are presented in Chapter 7.

4

Figure 1.1. Organization of the Dissertation 5

CHAPTER 2 Literature Review

2.1

Introduction Research on electricity price forecasting has gained momentum in recent years and is

considered to be an important as well as challenging task (Mandal et al., 2006; Zareipour et al., 2007a). Various participants, including generators, consumers and independent system operators (ISOs), engage in daily activities of these markets. Consumers in deregulated markets have the choice of purchasing electricity from different suppliers. Price forecasting information can be used in short-term and medium-term planning for setting offers and for negotiating bilateral contracts (Mandal et al., 2006; Zareipour et al., 2007a; Abedinia et al., 2017). Long-term generation expansion planning is also influenced by price forecasting. Overestimation of load forecasting may require unnecessarily reserve supply and an increase in generation operating costs, which ultimately increase the overall electricity prices (Pai and Hong, 2005; Wang et al., 2012). Therefore, in a deregulated electricity market, accurate price forecasting is important for generators to submit offers to the market in terms of the amount of energy to be generated and the selling price. Consumers, on the other hand, submit buying bids to the market to satisfy the load and it is possible for consumers to decide to shift peak loads either by shifting work schedules or shifting to the on-site generation facilities (Weron, 2014). Meanwhile, independent system operators can use price forecasting information to implement various load management programs to shift the load and reduce the prices during peak hours.

2.2

Price Forecasting Techniques Several approaches have been reported in the literature in the context of electricity price

forecasting. Wang and Ramsay (1997) use neural network methods to predict the System Marginal Prices of England and Wales on a day-ahead basis. Martini et al. (2001) present a decision support simulation for a power trading (DESPOT), a simulation method, which is used 6

for the short-term wholesale electricity market of Italy to determine hourly prices, profits and bidding. The simulation model, as discussed in Chapter 1, can work satisfactory if market structure details are available. Hence, the simulation model by Martini et al. provides a detailed market operating structure and generation system representation of the Italian electricity market. Various analysis based approaches are reported in the literature: time series models using autoregressive integrated moving average (ARIMA) methods (Cuaresma et al., 2004; Conejo et al., 2005a; Conejo et al., 2005b; Khan et al., 2011; Zhang et al., 2012) and auto-regression methods (Ni and Luh, 2001); input/output hidden Markov models (Gonzalez et al., 2005; Bessec et al., 2016); transfer function (TF) models (Nogales et al., 2002; Conejo et al., 2005a; Nogales and Conejo, 2006); wavelet models and generalized autoregressive conditional heteroskedasticity (GARCH) models (Garcia et al., 2005; Aggarwal et al., 2009; Zhang et al., 2012); and neural network techniques (Wang and Ramsay, 1997; Zhang et al., 2003; Guo and Luh, 2004; Rodriguez and Anders, 2004; Conejo et al., 2005a; Hong and Lee, 2005; Zhang and Luh, 2005; Catalao et al., 2007; Mandal et al., 2007; Zareipour et al., 2007b; Vahidnasab et al., 2008; Aggarwal et al., 2009; Coelho and Santos, 2011; Amjady, 2012; Filho et al., 2014; Panapakidis and Dagoumas, 2016. Ni and Luh (2001) present an auto-regression model combining with a classification approach to predict the probability density function (PDF) of market clearing prices (MCP) for the New England electricity market. Many factors such as demand, historical prices, market import-export, fuel prices and weather information have impact on MCP, as argued in their study. Conejo et al. (2005a) present the prediction of the electricity prices of the PJM electricity market using three time series based strategies: the autoregressive integrated moving average (ARIMA) model, the dynamic regression model and the transfer function model. Further, they propose two other techniques of neural network and wavelet transformation for day-ahead price prediction. In the time series techniques, they consider similar days from the same week and select these similar days by comparing the selection error with the market clearing prices. Conejo et al. (2005b) propose a technique to forecast day-ahead prices for the electricity market of mainland Spain. They use a wavelet transformer as a pre-processor to improve the predicting behaviour of the ARIMA technique. Garcia et al. (2005) use the general autoregressive conditional heteroscedastic (GARCH) methodology for price forecasting of the mainland Spain

7

and California deregulated electricity markets. They compare the ARIMA model with the GARCH technique and observe that GARCH yields better results. Zhao et al. (2006) discuss the importance of feature pre-processing techniques and evaluate the empirical performance in time series forecasting. They opine that the selected features should be mutually independent and show good dependency with the class. They use 15 combinations with different search strategies and evaluation criteria and demonstrate that a genetic algorithm search with a wrapper model for feature selection gives the minimum value of mean absolute percentage error (MAPE). The data set employed in the study is from the national electricity market (NEM) in Australia. Further, they demonstrate that these models can combine with the support vector machine (SVM) for forecasting the electricity prices. Zareipour et al. (2006) present a regression approach for forecasting the hourly Ontario energy prices (HOEP). They use multivariate adaptive regression splines (MARS) over a threeweek period in 2004 in two different scenarios. In the first scenario, lagged values of HOEP are used to develop an adaptive nonlinear autoregressive model. In the second scenario, current and lagged 2 hour ahead pre-dispatch prices (PDP) and pre-dispatch demand (PDD) are also considered along with the first scenario using adaptive non-linear dynamic regression modeling. Swief et al. (2009) develop a SVM based model to forecast the load and prices separately by utilizing the k-nearest neighbour technique to pre-process the data set, which comes from the PJM electricity market. They also study the impact of price spikes on the selection of features. Zareipour et al. (2011) propose a different approach for forecasting short-term electricity prices from the Ontario and Alberta markets. They use two different methods based on the SVM technique to classify the prices below and above a threshold value. This method may be useful where numerical values of prices are not required. In their work, they use a kernel-based feature vector selection (KFVS) technique for feature selection. In the first case, they use different SVMs for the classification of prices at each hour during the day. In second method they also consider the autocorrelation of the prices and use the SVM in the same manner to classify the prices a day ahead. Huang et al. (2012) also discuss electricity price forecasting as a classification problem to classify forecasted prices above and below the threshold level. They use different classification methods such as decision trees, multilayer perceptrons (MLP), Bayes and k-nearest neighbour (kNN) with different feature selection techniques including: relief, correlation feature selection (CFS) and mutual interference (MI). They observe that for 8

classification of future prices, CFS and Bayes methods are better than other methods. In their work, they use a filter method to select the different features and argue that a filter method is faster as compared to the wrapper as the latter gives more accuracy on the cost of computational complexity. The data sets are taken from the New York, Ontario and Alberta electricity markets. Catalão et al. (2007) develop a three-layered Levenberg-Marquardt algorithm trained feed forward neural network for forecasting next week electricity prices of mainland Spain and California. Their study presents a comparison of MAPEs by neural network, ARIMA and naïve based approaches. It has been demonstrated that results from the neural network approach are better than ones by the other two techniques for the dataset from the year of 2000. Guo and Luh (2004) propose a committee machine approach consisting of multiple neural networks and use the probabilities of individual neural networks to choose the weighting coefficients for the combined neural network. Data sets of New England electricity market from May 1, 2001 to April 30, 2002 and May 1, 2002 to October 31, 2002 are selected for training and testing of the model. Mandal et al. (2007) present a neural network model based on the similar days method to predict 24 hour ahead PJM electricity prices. They argue that the similar days method makes the learning easy for the neural network and hence simplifies the model. In their study, they forecast electricity prices using two methods: one based on the average prices of similar days and the other based on a neural network having prices of similar days as part of inputs. A comparison of the two methods demonstrates that the neural network approach outperforms the similar day's method. Singhal and Swarup (2011) use a three-layer back propagation neural network to forecast day-ahead market clearing prices (MCPs). They train a neural network with the data for 6 months and forecast hourly prices for a day with normal trend, a day with small spikes and a day with large spikes. The training features selected are the time of use, historical prices and load demand data and the mean square error (MSE) and root mean square error (RMSE) are calculated as error measures. Vahidinasab et al. (2008) demonstrate day-ahead price forecasting in the PJM electricity market using a neural network method. They argue that the LevenbergMarquardt learning algorithm converges 10 to 100 times faster as compared to the backpropagation learning algorithm. Panapakidis and Dagoumas (2016) proposes a neural network model along with clustering algorithm, using no pre-processed data, to forecast day-ahead prices of PJM and Spain electricity 9

markets. They argue that neural network based models are more flexible and robust forecasting tools and are useful for market participants. It can be concluded from the above-cited studies that historical prices and demand are two important features for forecasting electricity prices. Moreover, neural network techniques have the ability to handle non-linear relationships accurately in many applications and may be considered as universal approximation models with the capability of high accuracy for large classes of functions (Zhang and Qi, 2005). Hence, in recent years, neural network techniques are used in many forecasting problems. Furthermore, neural networks do not require prior information on model structures and are trained using input and output information. Because of neural networks' better ability to handle non-linear relationships in many applications (Zhang and Qi, 2005), neural network models have recently often been utilized to forecast electricity price. Thus, in this thesis neural network techniques along with the data mining techniques at the pre-processing stage are used to forecast day-ahead electricity prices and spikes. Although, there are studies using neural network techniques, the literature on price forecasting is limited as compared to the load forecasting techniques. The reported error is much below in the case of load forecasting problems, less than 3%, as compared to price forecasting problems.

2.3

Spike Forecasting Techniques The problem of price spikes has been reported in almost all the electricity markets of the

world. Single settlement or real-time electricity markets are more volatile and lead to more complications for price forecasting (Veit et al., 2006; Weron, 2014). The main reason for the price spike is supply shortage. The severity of the occurrence of spikes may differ depending on the structure and operation of a market. Price spikes occur if the electricity prices show very sharp changes with the variation of demand. Any hockey stick-shaped supply curve may lead to sharp changes in the market clearing prices if the demand and supply curves intersect in the blade area. The idea of price spikes can be demonstrated using Figure 2.1 in which the illustration of high price spikes and low or negative price spikes is shown for the electricity market of Ontario. The mean price value  is calculated over a previous given period of time and then the threshold values above the mean and below the mean are computed by using the formula of  ± 2, where  denotes the standard deviation of prices. The prices that lie above the upper 10

threshold level are known as high price spikes and those that lie below the lower threshold level are known as low or negative price spikes.
80

70

High Spikes

60

Hourly Prices in CAD/MWh

Threshold
50 40

Mean

30

20

Low Spike
10 0

0

10

20

30

40

50

60

70

80

90

100

Hours

Figure 2.1 Illustration of Spikes in the Prices of the Ontario Electricity Market Several methods are reported in the literature in the context of spike forecasting for different electricity markets of the world: neural network-based methods (Wu et al., 2006; Amjady and Keynia, 2010; Amjady and Keynia, 2011;); support vector machine (SVM) methods (Wu et al., 2006; Zhao et al., 2007a); data mining techniques (Lu et al., 2005; Zhao et al., 2007b); autoregressive conditional hazard (ACH) models and dynamic logit models (Christensen et al., 2012; Eichler et al., 2013); and wavelet transform methods along with feature selection techniques (Amjady and Keynia, 2010). Most of these spike forecasting studies explored the National Electricity Market (NEM) of Australia, Queensland electricity markets of Australia, and PJM electricity markets. Lu et al. (2005) report a three-step framework for predicting the price spikes of Queensland market, Australia. In the first step, they used normal regional reference price (RRP) to determine price spike occurrences and then the forecasted normal prices are compared with the threshold value to determine the likelihood of spike having occurred at time t. In the next step, a Naïve Bayesian classifier is used to determine the range of the spikes. In the final step, the values of spikes are calculated using the k-nearest neighbor approach. Zhao et al. (2007a) use a 11

data set of Australia NEM

to demonstrate the price spike prediction using two different

techniques. In the first technique, SVM is used to predict the spikes and the price spikes are determined from the given test set. In the second technique an advanced price spike probability classifier is used in which the probability for each input vector for a spike is determined and compared with the threshold value. If it is larger than the threshold, a spike is considered to have occurred. A spike is determined even for non-spike predicted values with a probability higher than the threshold value. This is due to the fact that spike prediction cannot be considered as a balance classification problem. Huisman (2008) presents the results for the Dutch electricity market for the effect of weather conditions such as temperature on the occurrence of spikes. Three regime-switching models are used for day-ahead electricity prices. The first model is used as a benchmark without considering any features. In the second model, the influence of temperature is considered on price levels and the third model is an extension to the second model, in which the influence of temperature on transition probabilities between the regimes is considered. Weng et al. (2009) extend the work reported by Lu et al. (2005) by using the cloud model technique. In their research, they combine the spike prediction technique with a concept-tree approach, based on the cloud model for price spike forecasting with data reduction. In a work presented by Amjady and Keynia (2010), a new approach in which frequency domain along with the time domain is used for feature selection is discussed. These features are selected using wavelet and time domain variables. For forecasting, a probabilistic neural network technique is developed and is fed by the selected inputs to predict price spike occurrence. The data sets from the Queensland market, Australia, and PJM electricity market are used in their evaluation. Amjady and Keynia (2011) propose the extension of their previous approach by using a new feature selection technique based on information theoretic criteria, which selects the most informative features for electricity price spike forecasting. They also propose a probabilistic neural network and hybrid neuro-evolutionary system (HNES) to predict the occurrence and value of electricity price spikes simultaneously. The data set from the PJM deregulated electricity market is used in their work. In another approach by Christensen et al. (2012), time series of price spikes as a realization of a discrete-time point process is considered and an autoregressive conditional hazard (ACH) model is used for the modeling of this process. One-step ahead forecasting is presented for price spikes in NEM of Australia. Amjady (2012) 12

presents a probabilistic neural network technique to predict the occurrence of day-ahead spikes using seasonal, daily, and hourly information along with the existence of spike for the PJM electricity market. Only a classifier method to predict the forecasted value as a spike or normal price is presented. In another approach presented by Clements et al. (2013), Australian electricity market data have been explored using a kernel-based nearest-neighbour regression model to forecast the spike prices. Demand data and weather data like temperature variables are used to design an algorithm and they discuss that occurrence of spikes is a non-linear process. Manner et al. (2016) also demonstrate spike forecasting for the Australian electricity market. Their study extends the work presented by Eichler et al. (2014) in which probabilities of spikes occurrence are forecasted, using dynamic multivariate discrete models. Zhao et al. (2007a) discuss that spikes occur over a short period up to several hours and these hours cannot be longer that a day. It is concluded from the above studies that in recent years, attempts have been made to predict price spikes and different models have been developed depending upon the availability of supply and system demand. However, no satisfactory model has been developed that is capable of predicting the subsequent price spikes as most of these models consider the occurrence of price spikes as a non-memorable event (Christensen et al., 2012), especially for the highly volatile electricity markets. To the best of the author's knowledge, no work has been reported in the literature on the Ontario wholesale electricity market for spike forecasting.

2.4

Electricity Market Selection As discussed in Section 1.1, the Ontario electricity market is a single settlement market and

one of the most volatile markets (Zareipour et al., 2007b). The Hourly Ontario Energy Price (HOEP) is uniformly applicable to wholesale consumers in Ontario. Simulation based HOEPs are calculated by the Independent Electricity System Operator (IESO) and are published as PreDispatch Prices (PDPs) (Zareipour et al., 2007a). These prices are updated every hour up to 1hour ahead PDPs and deviate significantly from the real-time prices (Zareipour et al., 2007a). Studies cited above from the literature also reported less work on forecasting prices for the Ontario electricity market as compared to the PJM and Australian markets. In particular, no work

13

has been reported for price spike forecasting for the Ontario electricity market. Therefore, the Ontario electricity market is selected for study in this thesis. From the above cited studies in the literature, various factors may be considered responsible for a change in electricity prices. These factors include demand, supply, weather conditions such as temperature and humidity, season, time of day, industrial activities, price hikes in oil/gas, outage of low cost operating generators (Mount and Oh, 2004; Aggarwal et al, 2009). Moreover, sometimes suppliers withhold their capacity to shift the supply-demand curve to cause spikes (Guan et al., 2001; Duan et al., 2005). The demand generated by the consumer market is considered as the most important factor and determines the level of electricity generation. The influence of demand on electricity prices from the year of 2011 in the Ontario electricity market is illustrated in Figure 2.2. It is observed that the occurrence of spikes increases when the demand is high. Relationships between demand and prices are discussed in a study presented by Zhao et al. (2007a). The chances of spikes increase with the rise in demand and prices become more unstable as demonstrated in Figure 2.2. The probability of spike occurrence increases significantly when the demand is greater than 16,000 MW.
400

300

Electricity Prices in CAD

200

100

0

-100

-200

1.2

1.4

1.6

1.8

2

2.2

2.4 x 10
4

Hourly Electricity Demand (MW)

Figure 2.2. Graphical Representation of Relationships between Demand and Prices for the Year of 2011 in the Ontario Electricity Market

14

In Figure 2.3, relationships between temperature and electricity prices are shown. The prices are lower at moderate temperature and increase at very low or very high temperatures. Therefore, on-peak timing are shifted in winter or summer and accordingly the chances of spike occurrence.
400

300

Electricity Prices in CAD

200

Threshold Level = $71.26

100

0

-100

-200

-15

-10

-5

0

5

10

15

20

25

30

35

Temperature in °C

Figure 2.3. Graphical View of Relationships between Temperature and Electricity Prices Variations in the electricity prices over 24 hours of a day for all 365 days of the year of 2011 are shown in Figure 2.4. The occurrences of spikes also depend upon the time-of-use of electricity, hence most of the spikes occur during the peak load hours. Although, spikes have been recorded over the non-peak hours, but, the probability of their occurrences is very low.

15

600 500 400
Threshold Level = $71.26

Prices in CAD

300 200 100 0 -100 -200

2

4

6

8

10

12

14

16

18

20

22

24

Hours of the Day from the Year of 2011

Figure 2.4. Ontario Electricity Prices versus Time-of-use in 2011 The detailed operations and structure of the Ontario electricity market along with the conditions to participate in the market are described in Chapter 3. Chapter 3 also includes a discussion on the history of Ontario electricity market.

2.5

Summary In this Chapter, a detailed literature review on price forecasting techniques and spike

forecasting techniques for different electricity markets is reported. From the studies reviewed, it is concluded that price forecasting accuracies vary significantly across the electricity markets depending upon the market volatility and operating structure. Market demand and historical prices are considered as the important variables along with weather conditions such as temperature and humidity and season of the year for forecasting prices. The forecasting horizons in the above cited studies vary from one-hour ahead to several-hours ahead depending upon the availability of information on candidate variables before real-time. Although, price forecasting techniques reported above show improvements in the price forecasting accuracy, a significant improvement is required, as compared to load forecasting, to be achieved in price forecasting problems. Moreover, most of the studies reported normal price forecasting problems with much less literature on spike forecasting. Many studies are also carried out for multi-settlement 16

electricity markets operations. However, single-settlement electricity markets are more volatile. The Ontario electricity market is a single-settlement market. Moreover, no research work in the literature has been reported for the Ontario electricity market, one of the most volatile markets in the world, for spike forecasting. Hence, after reviewing the literature, to address these gaps, a novel methodology is proposed in this research based on neural networks to forecast day-ahead electricity prices and spikes in the wholesale Ontario electricity market. To further improve the proposed method, various machine learning techniques are used and the impact of different input features is studied.

17

CHAPTER 3 Overview of the Ontario Electricity Market

3.1

Introduction A detailed review of the Ontario electricity market is described in this Chapter. First, a

brief history of the Ontario electric power industry is presented. Second, the operation and participants of the current Ontario electricity market are discussed. Third, prices, demand, and volatilities of the Ontario market are analyzed.

3.2

History of the Ontario Electric Power Industry In 1903, a project was started at Niagara Falls and three syndicates were awarded

franchises to generate power in Ontario. In 1905, the Ontario Power Commission was formed to organize the project. This commission was later renamed as the Hydro-Electric Power Commission of Ontario (HEPCO) in 1906 and eventually as Ontario Hydro (Ontario Royal Commission on Electric Power Planning, 1980; Winfield et al., 2006). Ontario Hydro and some small municipal utilities were responsible for generation, transmission and distribution of the electricity to the customers before deregulation. The provincial government was responsible for the prices of electricity. In 1925, the Hydro Electric Commission (HEC) of Ontario built the world's largest hydroelectric plant at that time. To further meet the enhanced demand resulting from the economic boom in 1950's, thermal electricity generation plants were built by HEC (Ontario Royal Commission on Electric Power Planning, 1980; Winfield et al., 2006). Twenty nuclear power units were also installed across the province during the period from 1960 to 1990. In 1998, Ontario Hydro was divided into five companies and these five companies were launched on April 1, 1999 by the Ontario Electricity Act. These five companies have different responsibilities for the smooth operation of the electricity market. The names of these five companies as given in Figure 3.1 are (IESO, 2017a):  Ontario Power Generation (OPG), focusing on the generation of electricity, 18

   

Hydro One, focusing on the transmission and distribution of electricity, Independent Market Operator (IMO), later known as Independent Electricity System Operator (IESO) by the Electricity Act in 2004, focusing on the electricity system dispatch, Electrical Safety Authority (ESA), responsible for electric industry standards and safety and, Ontario Electricity Financial Corporation (OEFC), managing the financial services of Ontario Hydro.

Ontario Hydro

OPG
Figure 3.1

Hydro One

IESO

ESA

OEFC

Reorganization of Ontario Hydro by the 1998 Ontario Electricity Act

Moreover, the 1998 Ontario Electricity Act created the operation of an open wholesale market and retail choice at the consumer level offered by retailers such as the Canada Energy Wholesalers Limited. It also ensures access to the power transmission grid for new competitors in the generation of electricity. Electricity was provided at low cost by the Adam Beck generating station at Queenston Heights on the Niagara River in the first half of the 20th century. With the increase in demand, coal and nuclear generation facilities were added and the Power Corporation Act was enacted that required HEPCO later known as Ontario Hydro to provide power without making any profits (Dewess, 2005). According to the Demand and Supply Plan (DSP) report published by Ontario Hydro in 1989, demand would exceed the available supply in 1990 and this gap would increase to 9,700 MW in 2005 (Ontario Hydro, 1989). It was further estimated that in 2014 the gap between demand and available supply will be more than 21,300 MW. In order to overcome this increasing gap, new generation facilities must be set up. However, due to the recession and economic restructuring, electricity demand decreased in 1993 and no new generation facility was added (Ontario Hydro, 1997). 19

In 1995, the Ontario market was converted into a competitive market by a committee formed by the government, but this market became operational in May 2002. The wholesale and retail prices were capped by the 2002 Electricity Pricing, Conservation, and Supply (EPCS) Act and remained fixed until May 2006. The Canadian Nuclear Safety Commission, previously known as the Atomic Energy Control Board (AECB) of Canada, submitted a report in 1996 proposing to close seven nuclear units for rehabilitation with the demand to be fulfilled by thermal generation (Ontario Hydro, 1997). Public health concerns came up with the increase in the consumption of coal (OPHA, 2002) and consequently, the government decided to phase out coal by 2007 (Winfield et al., 2004). By the end of 2010 approximately 3,130 MW capacity of coal generation had been suspended. In 2012, the contribution of coal was recorded as less than three percent of the total electricity production in the province. The remaining 3,293 MW capacity of coal-fired generators in the province were eliminated by the end of 2014. At the end of 2003, the Electricity Conservation and Supply Task Force (ECSTF) was formed by the Ontario government to investigate the reason for the blackout in August 2003 and to submit recommendations for the electricity supply in the future. In addition, Ontario Power Authority has handled power system planning issues since 2003. Presently, Ontario is facing three major electricity challenges and its generation capacity needs to be replaced by 80% during the next 20 years (Chief Energy Conservation Officer, 2006). The major problems in the Ontario electricity sector are:    Coal was one of the major sources of power generation until 2007 and has been phased out. Many nuclear plants are leading towards shutdown in 2009 to 2025 due to aging. The peak-demand is increasing.

3.3

Current Ontario Electricity Market

3.3.1 General Information In the current Ontario electricity market, transmission and distribution systems have remained regulated and the Ontario Energy Board determines the transmission and distribution tariffs. Hydro One is the major transmission company and has been privatized recently by the 20

Government of Ontario. Irrespective of the deregulation in the generation system, OPG holds an overwhelming share of generation capacity - approximately 70% of the total 36,564 MW installed generation capacity across the province. As shown in Figure 3.2 the total installed generation capacity is (IESO, 2017b):       12,978 MW (36%) of nuclear power, 10,277 MW (28%) of gas and oil, 8,451 MW (23%) of hydro, 3,983 MW (11%) of wind, 495 MW (1%) of biofuel, and 380 MW (1%) of solar.
40

35

30

Installed Capacity 2017 (%)

25

20

15

10

5

0

Solar

Biofuel

Wind

Hydro

Gas/Oil

Nuclear

Type of Fuel

Figure 3.2 Installed Electricity Generation Capacities of Different Resources in Ontario in 2017 The Ontario electricity market is interconnected with five neighbouring markets: Quebec, Manitoba, Minnesota, Michigan and NewYork. Import and export of electricity from these markets are part of regular operations of the Ontario electricity market to provide operational and planning flexibility. Imports or exports are considered similar to supply or demand, but are organized one-hour before the pre-dispatch run of Dispatch Scheduling Optimizer (DSO), an algorithm used by the IESO to determine prices and schedules. To prevent the reliability risks, Net Interchange Schedule (NIS), defined as the total change between the imports and exports, across two

21

successive hours is limited to 700 MW. Total import and export for the year of 2016 is 8.0 TWh and 21.9 TWh, respectively (IESO, 2017c). The additional supply of energy that can be called on a short notice to fulfil unexpected demand hike in a real time market is known as Operating Reserve (OR). The Ontario electricity market has three classes of operating reserves and a dispatchable participant has to supply an equal or greater amount of energy into the real time market to offer operating reserve:    10- minute synchronized (spinning) reserve, 10-minute non-synchronized (non-spinning) reserve, and 30-minute (non- synchronized) reserve. These suppliers may offer on any or all the three types of operating reserve depending upon their capabilities to supply energy in 10 minutes or 30 minutes. These suppliers are paid with the last offer accepted in the market i.e. market clearing price (MCP). If a supplier is selected for the operating reserve, but energy is not required, they will be paid on a stand-by basis for the amount of energy called for operating reserves. If the operating reserve energy is used to settle the difference between demand and supply, participants are paid for the generation. Ontario IESO publishes historical data from May 2002 onwards. The data consist of hourly demand and electricity prices. These data are publicly assessable at www.ieso.ca and used as data sets for study in this thesis. IESO also publishes System Status Reports (SRS) containing forecasting details of demand, supply, imports, operating reserves, capacity excess and shortfall. These reports are published 24 hours in advance and can be updated upon change in forecasts. Some variables from SRS are also used in Chapter 6 of this thesis. 3.3.2 Market Clearing Prices In competitive markets, the prices of products depend on the supply and demand. In these markets as shown in Figure 3.3, with a decrease in price, demand for quantity increases and with an increase in price, quantity produced tends to increase. When production of the demanded quantity has enough incentive, prices will be stable.

22

Demand

Supply

Prices in CAD

Market Clearing Price

Electricity Generation

Figure 3.3 Market Clearing Prices with respect to Demand and Supply In the case of the electricity market, some generators have high running costs as compared to others and hence, electricity prices should cover this cost in order to operate these generators. On the other hand, for high electricity prices consumers tend to decrease their demand. The wholesale prices of electricity in Ontario, also called the Market Clearing Prices (MCPs), are determined by running the dispatch algorithm (Anders and Rodriguez, 2005). Every day, IESO issues estimated demand needed throughout the following day, up to a month ahead, including 1,400 MW of energy reserve for emergencies. Generators and importers give their offers for the prices and the quantity of electricity to be supplied to the IESO. Large consumers can also change their consumption patterns according to the price variations during the day. The IESO then matches supply and demand by running the algorithm in unconstrained and constrained mode. In the unconstrained mode, physical limitations of the electricity market system in Ontario are not considered. In the case of the constrained algorithm, these limitations are taken into consideration. The unconstrained mode gives the market clearing prices and constrained mode produces the dispatch instructions. IESO first accepts the lowest priced offers and then accepts the higher priced offers until the market demand is met (Anders and Rodriguez, 2005). All the suppliers are paid with the same price based on the last offer accepted. This price is known as MCP and is used for dispatchable participants. HOEP, which is an average of the MCP for each hour, is used to pay or charge non23

dispatchable participants (Anders and Rodriguez, 2005). There are also participants that do not have physical facilities to produce or consume electricity. These participants act as wholesalers that buy energy from the wholesale market and sell energy and services to other Ontario market participants. These participants can be defined as importers or exporters depending on whether they bring energy into Ontario from neighbouring markets or send energy out of Ontario to these directly interconnected electricity markets. Loads with consumption of 250,000 kWh/year or more are charged based on wholesale prices; otherwise retail electricity prices are applied. These retail prices are calculated based on the regulated price plan (RPP) mandated by the Electricity Act of 2004. These retail prices are further divided for consumers with smart meters as time-of-use prices. These consumers have to pay 18.0/kWh for on-peak, 13.2/kWh for mid-peak and 8.7/kWh for off-peak, prices implemented by local distribution companies. Small consumers who do not have interval meters have to pay tiered prices set by the Ontario Energy Board every six months. These prices are 10.3/kWh for below the 750 kWh threshold and 12.1/kWh above the threshold. There are also some small consumers who have retail contracts with different retailers and have to pay according to the contract terms. 3.3.3 Demand Response Programs Demand response can be defined as a set of time-dependent activities that reduce or shift electricity usage by end-use consumers from their normal consumption patterns. These activities are utilized to improve electric grid reliability, manage electricity costs, and provide systems that encourage load shifting or shedding during times when the electric grid is near its capacity or electric prices are high (US Department of Energy, 2006). Demand response can also be defined as incentive payment programs for end users, so they are encouraged to lower their power consumption during peak load hours. The Ontario Power Authority (OPA) has started Demand Response (DR) programs as DR1, DR2 and DR3 to reduce the peak demand requirements (Environmental Commissioner of Ontario, 2010). DR1 was launched in June 2006 and was designed for voluntary load shedding during the few hundred peak hours in a year. Participation in DR1 depends on the volition of the participating consumers. It was merged into DR3, which was launched in August 2008. The DR3 program is designed to reduce load during the few hundred peak hours of consumption during a 24

year. Participants must reduce electricity consumption when called on by the OPA through the Independent Electricity System Operator (IESO). The DR2 program was launched in July 2009 and is a mandatory load-shifting program similar to DR3. Participants have to shift their load from peak hour to non-peak hours over a day. Consumers can respond to the electricity market by taking various actions. Firstly, consumers can reduce their overall consumption of electricity by cutting the peak hour loads. In the second scenario, consumers can shift their load from peak hours to non-peak hours, hence consuming the same amount of electric energy but reducing the peak demand. In the third case, consumers can run on-site generators during the critical load hours to fulfill their electricity need thus reducing their demand requirements (Albadi and El-Saadany, 2008). 3.3.4 Price Forecasting Horizon Electricity price forecasting can be categorized into short term, medium term and long term forecasting. Short term involves price forecasting for few minutes to few days ahead and is used for day to day electricity market operation, medium term forecasting is from a few days to few months ahead and is used for risk management. Electricity market planning involves long term forecasting, which is a future prediction of prices over the quarters or years (Weron, 2014). The majority of studies in the literature (Catalão et al. 2007; Aggarwal et al. 2009; Bessec et al. 2016) focus on short term forecasting for its importance in daily market operations. Electricity markets have different short term forecasting horizons depending upon the availability of the input variables. In the Ontario wholesale electricity market dispatchable loads and generators submit offers or bids for the amount of energy to generate or consume. These offers are accepted, only if submitted at least 2 hours before the actual transmission, so as to recalculate MCP and add or drop generation facilities. To make the price forecasting information useful for these generators and loads it must be available 3 hours before the actual transmission of energy (Zareipour et al. 2007a; IESO rules at www.ieso.ca). On the other hand, information about input variables available after 24 hours is likely to change and will largely deviate from the actual values. Some important factors like operating reserves are calculated only 24 hours ahead the actual time. This information is important in the price forecasting problem and helps to improve the forecasting accuracy. Considering the importance of these parameters, in this thesis day-

25

ahead (24 hour-ahead) prices are forecasted in the wholesale electricity market of Ontario, Canada.

3.4

Participants of the Current Ontario Electricity Market

3.4.1 Main Sectors The electricity market of Ontario can be divided into three main sectors (Natural Resources Canada, 2006)  Residential Sector: In this sector about 33% of the total Ontario electricity consumption is utilized for heating, cooling and lighting of residential buildings and for the operation of household appliances. A slight decline of electricity consumption is noticed in this sector with the implementation of the smart grid.  Commercial Sector: This is the sector with the highest electricity consumption, and the consumption in this sector is growing. About 39% of the total Ontario electricity is consumed in this sector mainly for the heating, cooling and lighting of commercial space and offices.  Industrial Sector: About 28% of the total Ontario electricity consumption is used for manufacturing, mining, forestry and construction activities. The consumption in this sector remains almost stable. In Ontario, total electricity demand can be categorized into two parts: base load and peak load. The base load demand is approximately 13,000 MW and is considered as constant demand. This demand can be fulfilled by nuclear and hydroelectric power generation. These generation facilities operate at low cost and their output cannot be changed rapidly. At this time, it is expected that the total demand will not exceed 27,000 MW. The demand above the base load demand of 13,000 MW is considered to be the peak demand. Peak demand is not constant and varies over the time during a day, a season, and a year. Peak demand is fulfilled by oil or natural gas fired plants and from some of the hydroelectric plants with storage capacity. These plants have higher operating costs and can adjust their output according to rapid changes in demand due to the environment and other factors. Renewable sources of energy are also replacing coal and other fossil fuels to fulfill the electricity demand in the province. 26

Electricity demand in Ontario increased annually at the rate of 0.5% from 1993-2004 (Pollution Probe, 2006) and is increasing up to 0.9% annually 2006-2025, which is almost double the earlier demand increases. Many factors are responsible for the growth of electricity demand, including:       Population growth, Economic growth, Climate variability, Industrial activity, Electricity prices and, Lack of conservation and demand management activities.

3.4.2 Participation in the Ontario Electricity Market The wholesale electricity market and high voltage transmission grid of Ontario are administrated and directed by the IESO. The workings of the Ontario market can be explained with the help of Figure 3.4, which shows the participation of the generators and consumers in the electricity market. In the Ontario electricity market, there are two groups of participants: dispatchable and non-dispatchable, as described by Anders and Rodriguez (2005).

27

Fig. 3.4 Participation in the Ontario Electricity Market Dispatchable participants bid into the market and generation or consumption of a specified level can be achieved by delivering dispatch commands for every 5 minutes by these participants. Most of the generation facilities are dispatchable in the Ontario electricity market, heavy loads having a capacity of 1 MW or more are also considered as dispatchable loads. IESO sends dispatch instructions to dispatchable generators for each 5 minute period of the day and generators submit hourly offers of quantity to be generated and the price demanded. On the demand side, dispatchable loads submit bids to the IESO for purchasing their required amount of energy as the bidding price for each hour and IESO sends dispatch instructions for each 5 minute period of the day. Loads and generators have to follow standard dispatch instructions set by IESO to register as dispatchable loads or generators. Non-dispatchable market participants receive payment or are charged hourly for the production or consumption of electricity power in real time. The majority of the loads are nondispatchable in the Ontario electricity market also, generators having generation capacity of less 28

than 10 MW or those used for self-scheduling units are considered as non-dispatchable generators. Non-dispatchable generators submit only the estimate of energy that they can produce to IESO (Zareipour et al., 2007a). On the other hand, non-dispatchable loads do not submit any bids to IESO and consume energy at the hourly wholesale price.

3.5 3.5.1

Prices and Demand of the Ontario Electricity Market Electricity Prices The monthly average HOEP values for the period of January 1, 2011 to December 31, 2013

are shown in Figure 3.5. The average HOEP values are recorded to be decreased in 2012 and again rise in 2013. In general, the average prices are shown to be higher during summer months.
40

35

Monthly Average HOEP (CAD)

30

25

20

15

10

5

0 Jan 2011

Dec 2011 Jan 2012

Dec 2012 Jan 2013

Dec 2013

Months from January 2011 - December 2013

Figure 3.5 Monthly Average HOEP from January 1, 2011 to December 31, 2013 The maximum HOEP value of each month from January 1, 2011 to December 31, 2013 is displayed in Figure 3.6. The maximum HOEP values vary abruptly each month over every year. The recorded HOEP values for these years are higher during peak winter and summer months every year. The maximum recorded value is $583.71 for May 2013.

29

600

500

Monthly Highest HOEP (CAD)

400

300

200

100

0 Jan 2011

Dec 2011 Jan 2012

Dec 2012 Jan 2013

Dec 2013

Months from January 2011 - December 2013

Figure 3.6 Monthly Maximum HOEP from January 1, 2011 to December 31, 2013 3.5.2 Market Demand The highest recorded amounts of demand from 2011 to 2013 are in the month of July and the highest recorded amount each year was 25,450 MW, 24,636 MW and 24,927 MW, respectively. The maximum and average demand of each month during the period from January 1, 2011 to December 31, 2013 are shown in Figure 3.7. By examining Figures 3.5, 3.6 and 3.7, it can be observed that demand directly drives the electricity prices in the Ontario market.

30

3

x 10

4

Mean Maximum 2.5

2

Demand in MW

1.5

1

0.5

0 Jan 2011

Dec 2011 Jan 2012

Dec 2012 Jan 2013

Dec 2013

Months from January 1, 2011 - December 31, 2013

Figure 3.7 Monthly Mean and Maximum Demand from January 1, 2011 to December 31, 2013

3.6

Volatility Analysis A basic graph showing the influence of demand on electricity prices for the year of 2011 in

the Ontario electricity market is illustrated in Figure 3.8. It can be observed that the occurrence of spikes increases when the demand is high. Relationships between demand and prices are discussed in a study by Zhao et al. (2007a). Figure 3.8 shows that the probability of spike occurrence increases significantly when the demand is greater than 17,000 MW. Unfortunately, spikes are also reported at a lower demand around 15,000 MW. Therefore, the occurrence of spikes cannot be exactly determined from demand data.

31

600 500 400 300 200 100 0 -100 -200
Threshold = $71.26

Prices in CAD

1.4

1.6

1.8

2 2.2 Demand in Mega Watt

2.4

2.6

2.8 x 10
4

Figure 3.8 Ontario Electricity Prices versus Demand in 2011 Variations in the electricity prices over 24 hours of a day for all the 365 days of the year of 2011 were shown in Figure 2.4 and are displayed again in Figure 3.9 for convenience. The occurrences of spikes also depend upon the time-of-use of electricity, hence most of the spikes occur during the peak load hours. Although, spikes have been recorded over the non-peak hours, but, the probability of their occurrences is very low.
600 500 400
Threshold Level = $71.26

Prices in CAD

300 200 100 0 -100 -200

2

4

6

8

10

12

14

16

18

20

22

24

Hours of the Day from the Year of 2011

Figure 3.9 Ontario Electricity Prices versus Time-of-use in 2011 32

The number of spike hours in the Ontario electricity market is increasing. Data from 2009 to 2014 for the Ontario electricity market are given in Figure 3.10 by a bar graph. This shows that the number of spike hours and the number of days for which spikes occur increase from 40 hours and 26 days for the year of 2009 to 890 hours and 142 days for the year of 2014. The number of spikes over each hour for all the 24 hours are illustrated in Table 3.1 for the years of from 2009 to 2014. Table 3.1 illustrates that the probability of occurrence of spikes is high during the peak load hours.

Number of Spike Hours 1000 900 800 700 600 500 400 300 200 100 0 2009 2010 2011 40 26 133 59 118 61

Number of Spike Days 890

232 125 53 2012 2013 2014 114 142

Figure 3.10 Numbers of Spike Hours and Spike Days from 2009 to 2014 Electricity demand is highly correlated with the prices, as shown in Figure 3.8. Therefore, new generation facilities may be needed to fulfill the demand during these spike hours. These generation facilities are called on by IESO in short notice and their operating cost is very high. In a year, these facilities are operated only for a few hours over a few days, but have a significant impact on the electricity prices.

33

Table 3.1. Number of Spikes over 24 Hours in 2009 to 2014
Year 2009 2010 2011 2012 2013 2014 Year 2009 2010 2011 2012 2013 2014 Hr 1 1 1 1 2 3 29 Hr 13 2 15 5 10 7 30 Hr 2 0 0 1 0 0 23 Hr 14 1 10 8 8 5 26 Hr 3 0 0 0 0 0 21 Hr 15 0 11 7 8 6 25 Hr 4 0 0 0 0 1 20 Hr 16 1 10 8 9 9 30 Hr 5 0 0 1 0 0 23 Hr 17 1 8 14 11 12 44 Hr 6 1 0 1 0 2 33 Hr 18 2 11 11 9 26 50 Hr 7 2 0 1 1 6 45 Hr 19 3 15 13 22 33 59 Hr 8 5 0 4 5 12 49 Hr 20 2 10 9 15 25 54 Hr 9 5 1 3 1 9 46 Hr 21 0 9 5 3 17 56 Hr 10 4 6 3 3 12 42 Hr 22 0 0 2 1 11 47 Hr 11 7 10 9 7 15 44 Hr 23 0 2 5 0 8 32 Hr 12 3 12 7 8 11 37 Hr 24 0 2 0 2 2 25

Worldwide the Ontario electricity market is considered as one of the most volatile electricity markets (Zareipour et al., 2007b) and is interconnected with the neighbouring electricity markets of New York, New England, Midwest, and Pennsylvania-New JerseyMaryland (PJM) (Hong et al., 2002; Mandal et al., 2009). Zareipour et al. (2007b) presents a hourly price volatility analysis for the Ontario electricity market and neighbouring markets of New England, New York and PJM for the year of 2004. They argued that the Ontario electricity market is the most volatile among these neighbouring electricity markets. In relation to the aforementioned work, the present study shows the hourly price volatility analysis for the Ontario, New England, PJM, and Queensland Australia electricity markets. The price volatility of these markets is calculated and compared for the year of 2011 as illustrated in Figure 3.11. The hourly historical volatility for hour i, where i= 1, 2, ..., 24, for the selected week k, where k denotes the weeks in 2011, is calculated over N time period using Zareipour et al. (2007b), as follows:

34

0.9 0.8 0.7

0.5 0.4 0.3 0.2 0.1 0 Hour= 1,2,3,...,24 New England Hour= 1,2,3,...,24 PJM Hour= 1,2,3,...,24 Queensland Hour= 1,2,3,...,24 Ontario

Figure 3.11 Historical Volatilities of Each Hour for the Year of 2011

 () 

=1+(-1)( -  ) =  -1

 ×



 2

(3.1)

   and  = ln ( - -1 )

(3.2)

  where  represents the logarithmic return for hour i of the selected d day and  is the

logarithmic return average for hour i over N time frames. Hourly historical volatilities are calculated for all 24 hours of the day, for all 7 days of the week and for all 52 weeks in 2011. The average volatility indices of 52 weeks for each hour are defined as the hourly volatilities over a year and are shown in Figure 3.11. It can be observed that the hourly price volatility in the Ontario electricity market is the highest and the Queensland electricity market has the lowest hourly price volatility.

35

Hourly Volatilities

0.6

3.7

Summary The Ontario electricity market is discussed in this Chapter. How the Ontario market came

into existence and how the current Ontario electricity market operates are described. The main participants of the market are identified. Recent demand, prices, and price volatilities are analyzed.

36

CHAPTER 4 Day-ahead Price Forecasting

4.1

Introduction In this Chapter, a novel methodology is presented to forecast day-ahead electricity spikes

and prices using neural networks. Day-ahead electricity prices are forecasted by the first neural network trained using a data set consisting of similar price days. Next, spike prices are identified from the forecasted prices using a spike classifier, and these spikes are re-forecasted by using neural networks trained over historical spike hours. Finally, a data re-constructor is used to achieve the overall day-ahead electricity spike and price forecasting. Numerical experiments are conducted and significant improvements are achieved in terms of forecasting accuracy, using data from the wholesale electricity market of Ontario, Canada, one of the most volatile electricity markets in the world, as discussed in Chapter 3. This Chapter is based on three publications by Sandhu et al. (2014, 2016a, 2016b).

4.2

A Neural Network based Methodology for Forecasting Day-ahead Electricity Prices and Spikes To forecast day-ahead electricity prices and spikes for the Ontario electricity market, a

neural network based methodology integrating data mining techniques is proposed in this thesis, as shown in Figure 4.1:  Pre-processing: Based on the literature review in Chapter 2, discussion about the Ontraio electricity market, various correlation tests, candidate variables showing high correlation with the electricity prices are selected. Publicly available data from the wholesale electricity market of Ontario, Canada, are collected and pre-processed. The collected data sets may have some missing and negative values, which are replaced by the average values over those particular days. Price data from 2014 and after also have values of zero. Those values are replaced in the similar manner with the average values. The data collected from 37

the IESO website (ieso.ca) include historical and forecasted demand, prices, and reserve margins from May 2002 onwards. The weather data gathered from the Government of Canada website (climate.weather.gc.ca) include temperature, humidity, and dew point temperature for the location of Toronto Lester B. Pearson International Airport.  Mining: Using data mining techniques, training data sets are selected as a highly correlated number of days from the price data, and then corresponding to each hour in each similar day, a number of similar price days are selected. The values of other candidate variables are selected relative to these similar price days and data sets are prepared for the training of neural networks.  Neural Networks: First, a neural network-based model is developed and day-ahead electricity prices are initially forecasted. This neural network is trained with the similar price days, from the same year, starting from the day before the forecasting day, and from the previous year. Second, the forecasted prices that are greater than or equal to the spike threshold, which is calculated using the previous year's prices, are classified as spike prices using a spike detector and are separated from the normal prices. Third, these spike prices are re-forecasted using a new neural network-based model. To test the impact of input features, various neural network-based methods are developed for spike forecasting.  Post-processing: The re-forecasted spike prices are combined with the normal forecasted prices in a data re-constructor to achieve the overall day-ahead price and spike forecasting. The forecasting accuracy is evaluated by using various error measures and comparisons with existing studies are performed.

38

Figure 4.1. Outline of a Neural Network based Methodology for Forecasting Day-ahead Electricity Prices and Spikes Data mining techniques are used in this methodology to select the similar price days. In general, data mining may be defined as the process of discovering useful patterns in data. In the data mining process, different algorithms are used for the extraction of useful information and patterns from the raw datasets. With the advancement of technology, large amounts of data have been collected from different sources by various organizations. Data become useful after 39

analyzing the dependencies and finding correlations. Therefore, the patterns discovered using various models should be useful, understandable but unknown (Witten et al., 2011). Implicit knowledge within these databases for knowledge discovery have been adopted by different research fields (Figueiredo et al., 2005). The information gained through data mining may be used in business decisions and to identify niches in the market. Currently, data mining techniques are used in various fields, including marketing, customer relationship management, engineering, medicine, crime analysis, expert prediction, web mining, and mobile computing (Witten et al., 2011).

4.3

Initial Electricity Price Forecasting As discussed in Section 4.2 and illustrated in Figure 4.1, to forecast day-ahead hourly

electricity prices, a neural network-based method integrating a data mining technique is proposed in this thesis. The details on how to initially forecast day-ahead hourly electricity prices are developed in this section. 4.2.1 Data Mining Process for Selecting Training Data Sets The set of training data for a feed-forward neural network consists of the same type of days selected from the past as shown in Figure 4.2. For example, to forecast prices of a day in 2012, the training data set contains d2012,- days from the same year selected in reverse direction starting from the day before the forecasting day along with d2011,- days and d2011,+ from the previous year as days before and after the forecasting day. In order to determine how many days to select, a correlation test for the historical prices is carried out for the years of 2011 and 2012 with combinations of 30, 45, and 60 days. A window of 45 days shows high correlation and is selected in this work.

40

Selected 135 training days 90 training days from the previous year 45 training days from the same year

Time
Y-1,- - TDY-1, Y-1,+ TDY-1,+ Y,- - TDY,

Forecasting day (Previous Year)

Forecasting day Day before forecasting day

Figure 4.2. Selection of the Total Number of Training Days In total, 135 days (45 days from the same year and 90 days from the previous year) are selected as training days and denoted by di = d1, d2, ..., d135, where di is numbered in the reverse direction, starting from the day before the forecasting day. For example, 45 days are selected corresponding to January 6, 2012 from the same year, and 90 days are selected from the previous year, as d1 = January 5, 2012, the day before the forecasting day, up to d45 = November 22, 2011, and d46 = February 19, 2011, ..., d90 = January 6, 2011, d91 = January 5, 2011, ..., up to d135 = November 22, 2010, 45 days after January 6, 2011, including January 6, 2011 and 45 days before January 6, 2011. As shown in Figure 4.3, in a similar manner corresponding to each training day, N
P,- P,+ S

days

from the same year are selected starting from the day before the training day and from the previous year N days before and N days after the training day are chosen. Therefore,
P,+

corresponding to each training day, N = N S +N

+N

P,-

days are selected, where N = 90, and

are denoted by N1, N2,..., N90, starting in the reverse direction from the day before the training day. For example, for the training day d135 = November 22, 2010, to select 90 days, N S = 30 days from the same year are selected as N1 = November 21, 2010, the day before the selected training day, up to N30 = October 23, 2010. The remaining 60 days, N
P,+ P,-

and N

, are selected

from the previous year as 30 days after and including November 22, 2009, where N31 = December 21, 2009, ..., N60 = November 22, 2009, and 30 days before November 22, 2009, where, N61 = November 21, 2009, ..., and N90 = October 23, 2009. Similarly, for each of 135 training days, a set of N days is selected corresponding to the forecasting day of January 6, 2012. 41

90 similar days corresponding to each training day 60 similar days from the previous year 30 similar days from the same year

Time

SD Y,-

SD Y,-

SD Y,-

Training day (Previous Year)

Training day (d135) Day before training day

Figure 4.3 Selection of the Number of Similar Days Corresponding to Each Training Day To summarize the selection of the total number of training days and the total number of similar days corresponding to each training day, Figures 4.2 and 4.3 are combined into Figure 4.4. In Figure 4.4, a total of 135 training days as 45 days from the same year, starting in the reverse direction from the day before the forecasting day, and 90 days from the previous year as 45 days before and 45 days after and including the forecasting day is selected. Furthermore, corresponding to each selected training day, 90 similar days as 30 days from the same year starting from the day before the training day and 60 days from the previous year as 30 days before and 30 days after and including the particular training day are selected as shown in Figure 4.4.

42

Selected 135 training days

90 training days from the previous year
d2011 , - Days d2011 ,+ Days

45 training days from the same year
d2012, - Days

Time

Forecasting day (Previous Year) Time

Forecasting day Day before forecasting day

N P, - Days

N P, + Days

N S Days

Training day (Previous Year)

Training day (d135) Day before training day

d2011, - = d2011, + = d2012, - = 45 and N P, - = N P, + = N S = 30

Figure 4.4 Selection of the Total Number of Training Days and the Number of Similar Days Corresponding to Each Training Day In the next step, Euclidean distance is calculated for each hour of these selected N days with respect to the corresponding training day (Mandal et al., 2007). The difference in price of these selected N days at hour t, t = 1, 2, ..., 24, with respect to the corresponding training day is  - 
-

, j = 1, 2, ..., 90, where  denotes the price at hour t on day n. Therefore, the

differences for all 90 days are:
 -1   ,  - -2 , ... ,  - -90]  = [ -  

(4.1)

Similarly, at hour t-1, the differences in price are:
 -1  -2  -90  -1 = [-1 - -1 , -1 - -1 , ... , -1 - -1 ] 

(4.2)

Accordingly, Euclidean distance for price is given as:
 - 2 - 2   ,  = ( ) + (  -  -1 -   -1 )

for j = 1, 2, ..., 90.

(4.3)

The difference in price of the selected training day and N1 day at hour t is  - -1 , as given in Eq. (4.1). Similarly, the difference in price of the selected training day and N2 day at 43

hour t is represented by  - -2 . The difference between the selected training day and N days are calculated for all N = 90 days. This process is continued for each hour of the day, for all 135 training days. In a similar manner, the differences in price at hour t-1 are calculated as shown in Eq. (4.2). In the following step, to facilitate neural network training, the number of data points is further reduced and five days--with the smallest Euclidean distances in terms of price corresponding to the selected training day for each hour--are selected. Thus, corresponding to each selected training day for each hour of the day, a set of five days is selected. To prepare the complete training data set, the same process is repeated for all the selected 135 training days, and 135 × 24 × 5 data points are created. 4.2.2 Training Process of the Neural Network Neural networks are data-driven, nonlinear networks that can adapt their synaptic weights during the learning process and have the ability to analyze unknown situations (Ramos and Martinez, 2013). The prices over the forecasting day may be predicted as  , the average of five selected similar price days at hour t, but the mean absolute percentage error (MAPE) is large. Therefore, day-ahead hourly electricity prices are forecasted using a feed-forward neural
 network, as shown in Figure 4.5, to improve the forecasting accuracy, where  denotes the  demand at hour t on day n and  +1 represents the forecasted price at hour t+1 on day n.

44



 +1

  +1

. . .

 

Figure. 4.5. Trained Neural Network to Forecast Electricity Prices The mean square error (MSE) is minimized by training the neural network and is given by the following equation:
1 24    2 MSE =135×24 135 =1 =1(  -  ) ,

(4.4)

   where   denotes the predicted price at hour t on day n and  is the actual price at hour t on

day n. The neural network is trained by adjusting weights and biases to minimize the difference between the predicted output and the target value and to reduce the error to a significance level of 10-8. Neural network terminates the training if the total number of iterations reaches 2,000 or error reaches the predefined level. Back-propagation (BP) with the Levenberg-Marquardt optimization algorithm is used to train the neural network as it converges very fast. LevenbergMarquardt may require more memory space than a gradient-descent based training method, but the study in discussion has reduced the training data set in the data mining step and the results of Levenberg-Marquardt are better with the same number of iterations. A tangential sigmoid function is used to normalize the inputs for the hidden layer and the outputs are renormalized to obtain numerical values. Various values of the learning rate and momentum of the backpropagation algorithm are tested randomly. The learning rate and momentum of the backpropagation algorithm are selected as 0.01 and 0.1, respectively, to accelerate the learning process.

45

The neural network is trained over all the selected 135 days for 24 hours of each day with a
  training data set consisting of +1 ,  , and  as the average of five similar days at hour t + 1,

price and demand on hour t of the selected training day. The number of hidden layer neurons is selected by using the equation of 2v + 1, where v is the number of inputs applied to the neural network. In the output layer one neuron is selected because only one output is forecasted sequentially. Future electricity prices are forecasted over the next 24 hours with price  at time t, the
 demand  at time t, and the average of five similar price days +1 corresponding to the

forecasting day as the inputs to the trained neural network. Similar prices days corresponding to the forecasting day at hour t+1 are given by equation:
 (     )/5  +1 = -23 + -47 + -71 + -95 + -119

(4.5)

The timeline shown in Figure 4.6 represents how the forecasting day and previous day hours are selected. The present and future hours of the forecasting day are denoted as t and t +1, t +2, ..., t +24 respectively. The past hours of the day before the forecasting day are given as t -1, t -2, ..., t -23.
9/9/2017 - 9/16/2017 9/9/2017 - 9/16/2017

Day Before the Forecasting Day

Forecasting Day

Time

t - 23

t-2

t-1

t

t+1

t+2

t+3

t + 24

Figure. 4.6. Selection of Hours on Timeline for the Forecasting and Past Days.
  In a similar fashion, to predict the price at t +2 hour of the forecasting day, +1 , +1 , and  +2 as the forecasted price at t +1 hour, forcasted demand available from the IESO website and

the average of five similar price days, at hour t +2, corresponding to the forecasting day,
 respectively, are used as the input data set. +2 is given by:  (      )/5 +2 = -22 + -46 + -70 + -94 + -118

(4.6)

46

For all 24 hours of the forecasting day, the same process is carried out and prices over a day on an hourly basis are predicted. The input data set is different for each forecasting day; therefore, the whole process has to be repeated for different forecasting days. The forecasting accuracy is measured in terms of MAPE, RMSE (root mean square error) and MAE (mean absolute error), as defined by: MAPE =   =1
1 1 | - |   


(4.7)

 2 RMSE =    =1( -   )  MAE =   =1| -   | 1 

(4.8) (4.9)

where the total number of hours are h, for which MAPE, RMSE and MAE are calculated. In this thesis, h = 24, as these errors are calculated over a day. The actual and forecasted hourly prices   are represented by  and   , respectively, for i = 1, 2,..., 24, and  represents the average of the actual prices over 24 hours. 4.2.3 Initial Price Forecasting Results The day-ahead electricity prices for weekdays and weekends in 2012 are forecasted over the selected 30 days from all of the seasons. The day of January 3, 2012, with the MAPE value of 26.05% is shown in Figure 4.7. A feed-forward neural network using a data mining technique is trained with the training set over 135 days to obtain these results. Actual electricity prices are shown by solid lines and the dotted line represents the forecasted electricity prices over a day.


47

140

120

Actual Prices Forecasted Prices

MAPE = 26.05%

100

Prices in CAD

80

60

40

20

2

4

6

8

10

12 14 Hours of Day (January 3, 2012)

16

18

20

22

24

Figure 4.7. Forecasting Results for January 3, 2012 (Tuesday) In a similar manner, forecasting results for June 20, 2012, a weekday, and October 7, 2012, a weekend day, are illustrated in Figures 4.8 and 4.9 respectively. The MAPE value for June 20, 2012 is 14.79% and for October 7, 2012 is 6.34%, as displayed in Figure 4.8 and Figure 4.9. It is observed that forecasted prices largely deviates from the actual prices on abrupt changes.
110 100 Actual Prices Forecasted Prices

MAPE = 14.79%
90 80

Prices in CAD

70 60 50 40 30 20 10

2

4

6

8

10

12

14

16

18

20

22

24

Hours of Day (June 20, 2012)

Figure 4.8. Forecasting Results for June 20, 2012 (Wednesday)

48

Similarly, day-ahead electricity price forecasting is attained for another 27 selected days from all the seasons of the year of 2012. The forecasted hourly prices for six representative days are given in Table 4.1. The forecasting performance as measured in terms of MAPE, RMSE, and MAE for all of the 30 selected days is shown in Table 4.2. As can be seen from Table 4.1, the forecasted values follow the actual price values closely for medium and low electricity prices. Significant improvements in terms of forecasting accuracy as measured by MAPE are achieved for the low to medium price range (Sandhu et al., 2014). However, with the increase in electricity prices, especially spike prices, the forecasted values deviate from the actual values noticeably. This method is unable to catch abrupt changes in prices. Therefore, a different approach is developed in the next section to forecast these spike prices.
32 30 28 26 Actual Prices Forecasted Prices

MAPE = 6.34%

Prices in CAD

24 22 20 18 16 14

2

4

6

8

10 12 14 Hours of Day (October 7, 2012)

16

18

20

22

24

Figure 4.9. Forecasting Results for October 7, 2012 (Sunday)

4.4

Day-ahead Spike Forecasting The Ontario electricity market is more volatile than its neighbouring markets due to its

single-settlement operation (Zareipour et al., 2007b). Historical and real-time Hourly Ontario Energy Prices (HOEP) are published by Independent Electricity System Operator (IESO) on its website. An examination of these historical prices shows that spike prices are much higher than 49

the average normal prices. For example, on May 11, 2011, at 1600 hours the electricity price was $558.24/MWh, which is 15.4 times higher than the average electricity price of $36.25/MWh in 2010. The occurrences of these abnormal high prices in an electricity market are considered as price spikes. In this thesis, price spikes are separated from normal electricity prices using a spike detecting classifier. A threshold level is calculated using the previous year's prices and the price values of the year under study above or equal to this threshold level are considered as spikes. These spike prices are re-forecasted to improve the overall forecasting accuracy. The threshold level for 2012 is calculated using the price data from the previous year of 2011, and similarly, the threshold level for 2011 is calculated using price data from 2010. Formally, let  be the mean of the selected data set of historical HOEP, and  be the standard deviation of the selected data set. The threshold level of the sample set can be calculated as (Lu et al., 2005): PTH =  + 2 (4.10)

where PTH is the threshold value of the selected data set. Any HOEP value greater than or equal to PTH (HOEP  PTH) is considered to be a spike. To detect the spikes in 2012, the mean and standard deviation of prices over all the hours in 2011 are calculated and the threshold level is determined using Eq. (4.10). Many of the studies on forecasting price spikes (Lu et al., 2005; Wu et al., 2006; Zhao et al., 2007a; Zhao et al., 2007b; Amjady et al., 2010; Amjady and Keynia, 2011; Christensen et al., 2012; Eichler et al., 2013) argue that occurrences of these spikes are random, but the probability of their occurrences is higher if the available supply is less than demand or if the reserve margin is very low. Occurrences of electricity price spikes are affected by many factors. Important short-term factors include weather conditions (temperature, humidity, and dew point temperature), breakdown of low-cost generation facilities, low reserve margins, limitations of transmission lines, and generation capacity constraints (Lu et al., 2005; Zhao et al., 2007a; Amjady and Keynia, 2011; Christensen et al., 2012). Long-term factors--such as increases in natural gas and oil prices, inflation rates, shutting down of generators due to aging, and economic growth--may increase the overall electricity prices (Lu et al., 2005; Amjady and Keynia, 2011; Christensen et al., 2012). However, electricity price spikes over a day are mainly affected by short-term factors (Zhao et al., 2007a). Spikes may occur for several hours, but normally not for more than a day (Zhao et al., 2007a; Amjady et al., 2010). The occurrence of spikes depends upon the system demand and 50

available supply. During peak hours, normally day time, demand increases and higher cost operating generators become operative. These generators greatly influence the prices and hence spikes occur (Christensen et al., 2012). The threshold value could be different for different seasons and for different electricity markets. Spike hours are increasing every year in the Ontario electricity market. Hence, new generation facilities are required during these spike hours to meet the demand. As these spikes occur only for a few hours over a year, new facilities will operate only for a few hours over a few days in a year, but will greatly influence electricity prices. In this Chapter, the data set is selected with historical prices, demand, temperature, dew point temperature, and relative humidity as important features for forecasting price spikes. The data sets of historical prices and demand are available for public access on the IESO website (ieso.ca) and the data sets of temperature, dew point temperature, and relative humidity are taken from the Government of Canada website (climate.weather.gc.ca) for the location of Toronto Lester B. Pearson International Airport. 4.4.1 Framework of the Proposed Hybrid Method for Electricity Price and Spike Forecasting The day-ahead forecasted electricity prices as discussed in Section 4.3 can be classified as spike and normal prices. As defined in Eq. (4.10), the forecasted prices that are greater than or equal to the spike threshold are considered as spike prices. The neural network presented in Section 4.3 is not able to forecast spike prices well. Therefore, a new approach is developed in this section to forecast the spike prices. Whenever a spike is detected by the classifier, the model is switched from the neural network presented in Section 4.3, called Network 1 (Net 1), to another neural network. The new neural network is trained over spike hours from the day before the forecasting day to the previous two years. To examine the impact of different input features, experiments are conducted with the following three new neural networks:  Network 2 (Net 2): The selected input features for each detected spike hour are demand and five spike prices occurring at the same hour as the detected spike hour identified from the day before the forecasting day up to the previous two years.   Network 3 (Net 3): The selected input features are similar to Net 2 with the replacement of five spike prices by ten spike prices. Network 4 (Net 4): The selected input features are historical demand, temperature, dew point temperature, and humidity for the detected spike hour. 51

The proposed hybrid method for electricity price and spike forecasting is shown in Figure 4.10. First, Net 1 as presented in Section 4.3 is utilized to forecast day-ahead prices. Second, a spike occurrence predictor is used to separate the spikes and normal prices. Third, the detected spike prices are re-forecasted using one of Net 2, Net 3, and Net 4 in order to improve the accuracy of forecasting. Finally, a data re-constructor is used to combine the results of reforecasted spike prices and the normal prices forecasted by Net 1 to achieve overall day-ahead price forecasting. Essentially, in the new hybrid method, Net 1 is used to forecast day-ahead prices unless a spike is predicted by the classifier. On occurrence of spikes, Net 1 is replaced by Net 2, Net 3, or Net 4 and the spikes are re-forecasted.

Figure 4.10. Hybrid Neural Network-based Model to Forecast Day-ahead Prices 4.4.2 Training Data Sets of Networks 2, 3, and 4 Different input features are selected for the training of Net 2, Net 3 and Net 4. To train Net 2 and Net 3, historical demand and spikes are selected as input features, whereas historical demand, temperature, dew point temperature, and humidity are the selected input features for the training of Net 4. As an example, Net 2 is shown in Figure 4.11. For each detected hour in a 52

forecasting day, Net 2 is trained over all the spike hours occurring from the day before the forecasting day up to the previous two years. For a particular spike hour, the training data set is composed of demand and five spike prices, denoted by  , i = 1, 2, ..., m, and m = 5, occurring at the particular spike hour from the day before up to the previous two years counted from the forecasting day. For example, to forecast the spike price at 1400 hours on January 3, 2012, all spike hours over all the days for 24 hours a day from January 2, 2012, the day before the forecasting day, up to January 6, 2010 are used to train Net 2. A spike hour occurring from January 5, 2010 to January 1, 2010 is not used as a training data point since it does not have five input spike prices. A spike hour occurring from January 6, 2010 up to the day before the forecasting day may not have corresponding five spike prices. In this case, the five maximum prices at the same hour are used as the input spike prices. To forecast the spike price at 1400 hours on January 3, 2012, demand forecasted by the IESO at this hour along with the first five spike prices occurring at 1400 hours, counted backward from January 2, 2012 to January 6, 2010, are applied as the inputs to the trained Net 2, and the spike price at 1400 hours on January 3, 2012 is re-forecasted.

53

 1

 2

 3

 4



 5

 

Figure 4.11. Neural Network, Net 2, to Forecast Day-ahead Spikes The training data set for Net 3 is selected in a similar manner as for Net 2 with the replacement of five spikes by ten spikes, denoted by  , i = 1, 2, ..., m, and m = 10. To avoid not having a sufficient number of input spike prices, a spike hour occurring from January 10, 2010 to January 1, 2010 is not used as a training data point. In Net 4, historical demand, temperature, dew point temperature, and humidity over all the spike hours from the day before the forecasting day up to the previous two years are selected for training. The trained Net 4 is used to re-forecast a detected spike price on the forecasting day when fed with these input features corresponding to the forecasting spike hour. The training of Net 2, Net 3 and Net 4 is carried out by utilizing the Levenberg-Marquardt optimization algorithm.

54

4.5

Combined Forecasting Results The wholesale electricity market of Ontario, Canada, is used to test the forecasting

methods developed in this Chapter. Day-ahead prices and spikes are forecasted for the selected days in 2012 and the data for training are obtained from ieso.ca and climate.weather.gc.ca for 2010 to 2012 (available to the public). 30 days are selected over all the seasons in 2012 for dayahead forecasting and the results are reported in Tables 4.1 and 4.2. The detailed results for six representative days are shown in Table 4.1 while Table 4.2 displays the forecasting performance for all of the 30 days. Each day has 24 data points (hours) and Net 1 is used to forecast dayahead prices for these selected days over all the hours as displayed in Table 4.1 for six representative days under the column entitled "Net 1". The forecasted prices greater than or equal to the 2012 threshold of $71.26 are classified as spikes and are re-forecasted as shown in Net 2, 3, and 4 columns. These re-forecasted spike prices follow the actual prices better. Overall day-ahead electricity price and spike forecasting is achieved by combining the results of Net 2, 3, or 4 with Net 1. Most of the spikes occur during the peak hours of the day as illustrated in Table 4.1. There is no spike in any season in the morning before 11:00 hours and in the evening after 22:00 hours. On July 6, 2012, the maximum number of spikes--a total of 11--occurred, followed by July 17, 2012 and August 4, 2012, with 10 and nine spikes respectively. Numerical experiments show that Net 2, 3, and 4 are able to reduce the forecasting error significantly. Day-ahead hourly forecasting for January 3, 2012 is shown in Figure 4.12. It is observed that the overall MAPE decreases from 26.05% to 20.24%. As shown in Figure 4.12, the results during spike hours as reforecasted by the proposed hybrid method follow the actual prices much more closely.

55

140 Actual Prices Net 1 (MAPE = 26.05) Net 1 + Net 2 (MAPE = 23.27) Net 1 + Net 3 (MAPE = 22.50) Net 1 + Net 4 (MAPE = 20.24)

120

100

HOEP in CAD

80

60

40

20

2

4

6

8

10

12 14 Hours of Day (January 3, 2012)

16

18

20

22

24

Figure 4.12. Illustration of Day-ahead Spike and Price Forecasting for January 3, 2012 The forecasted results for June 28, 2012 are displayed in Figure 4.13. On June 28, 2012, only three spikes hours are classified from the forecasted results of Net 1 and MAPE reduces from 6.87% to 5.16%.
120 Actual Prices Net 1 (MAPE = 6.87) Net 1 + Net 2 (MAPE = 6.14) Net 1 + Net 3 (MAPE = 5.48) Net 1+ Net 4 (MAPE = 5.16)

100

80

HOEP in CAD

60

40

20

0

2

4

6

8

10

12 14 Hours of Day (June 28, 2012)

16

18

20

22

24

Figure 4.13. Illustration of Day-ahead Spike and Price Forecasting for June 28, 2012

56

Similarly, the results for July 6, 2012, July 17, 2012 and August 4, 2012, as the days with the highest number of spike hours, are presented in Figure 4.14, Figure 4.15, and Figure 4.16, respectively. The MAPE for July 6, 2012 is reduced from 15.63% to 11.24%, with a combination of Net 4 and Net 1. An improvement of 28.08% is recorded over Net 1 for July 6, 2012. July 17, 2012 shows an MAPE improvement of 47.21%, as display in Figure 4.15, and August 4, 2012, in Figure 4.16, shows a 28.42% improvement over Net 1 with the combination of Net 1 and Net 4.
120 Actual Prices Net 1 (MAPE = 15.63) 100 Net 1 + Net 2 (MAPE = 14.19) Net 1 + Net 3 (MAPE = 12.33) Net 1 + Net 4 (MAPE = 11.24) 80

HOEP in CAD

60

40

20

0

2

4

6

8

10

12 14 Hours of Day (July 6, 2012)

16

18

20

22

24

Figure 4.14. Illustration of Day-ahead Spike and Price Forecasting for July 6, 2012
160 Actual Prices 140 Net 1 (MAPE = 27.94) Net 1 + Net 2 (MAPE = 17.69) Net 1 + Net 3 (MAPE = 16.14) 120 Net 1+ Net 4 (MAPE = 14.75)

HOEP in CAD

100

80

60

40

20

2

4

6

8

10

12 14 Hours of Day (July, 17, 2012)

16

18

20

22

24

Figure 4.15. Illustration of Day-ahead Spike and Price Forecasting for July 17, 2012 57

180 Actual Prices Net 1 (MAPE = 24.10) Net 1 + Net 2 (MAPE = 21.04) Net 1 + Net 3 (MAPE = 20.07) Net 1 + Net 4 (MAPE = 17.25)

160

140

120

HOEP in CAD

100

80

60

40

20

2

4

6

8

10

12 14 Hours of Day (August 4, 2012)

16

18

20

22

24

Figure 4.16. Illustration of Day-ahead Spike and Price Forecasting for August 4, 2012

58

Table 4.1. Forecasting Day-ahead Electricity Prices and Spikes using Neural Networks
Hour

January 3, 2012
Actual 28.34 27.69 25.31 25.22 25.88 26.66 31.16 34.77 35.89 33.82 32.96 29.05 31.62 31.48 47.13 44.83 58.15 115.2 91.28 135.30 124.70 41.33 32.09 29.16 Net 1 30.25 30.14 28.79 28.65 28.72 28.97 33.59 36.87 37.29 36.37 36.16 33.29 34.57 34.46 38.97 37.86 45.78 79.46 76.89 94.79 93.23 78.49 70.12 62.79 79.00 82.98 109.5 114.21 88.22 81.30 84.26 112.89 116.37 88.59 92.76 86.79 119.40 115.40 82.37 Net 2 Net 3 Net 4 Actual 20.28 21.64 18.59 19.5 16.4 20.34 27.24 31.15 47.59 56.88 38.29 50.51 88.81 66.28 108.24 44.68 95.06 95.79 97.89 62.70 46.38 28.95 26.06 24.13

June 20, 2012
Net 1 22.89 23.28 20.16 20.48 18.24 19.63 24.87 28.55 41.98 52.86 45.19 49.55 76.49 70.70 88.92 68.49 81.59 86.79 89.26 79.83 58.22 38.76 32.11 27.14 84.00 88.56 92.32 77.47 83.92 89.46 94.16 75.18 86.87 91.36 93.08 72.89 95.89 101.68 99.28 81.76 80.37 82.59 Net 2 Net 3 Net 4 Actual 14.17 16.64 12.47 12.65 13.06 4.38 15.80 21.06 22.71 28.24 31.31 29.16 31.50 30.70 38.82 93.76 100.10 71.86 45.37 44.38 47.15 56.56 31.39 21.70

June 28, 2012
Net 1 14.41 15.89 13.34 13.43 12.78 4.00 15.68 20.00 21.90 25.2 31.9 31.73 31.42 31.04 37.44 78.79 91.36 76.77 42.19 46.21 45.60 53.58 36.06 20.42 81.78 94.26 76.58 82.36 96.25 73.65 84.12 96.82 73.23 Net 2 Net 3 Net 4

1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24

59

Table 4.1. Forecasting Day-ahead Electricity Prices and Spikes using Neural Networks (cont.)
Hour

July 6, 2012
Actual 21.13 20.92 19.87 17.43 16.55 18.93 24.39 25.16 30.47 59.01 107.06 77.16 119.04 96.24 96.33 94.72 93.17 64.23 43.37 88.85 86.84 53.90 53.17 22.36 Net 1 23.59 22.89 22.09 19.38 19.24 20.63 21.94 23.88 27.49 42.68 75.21 79.96 97.26 89.57 90.29 89.64 89.88 80.29 69.58 82.59 82.05 78.91 62.15 32.65 84.62 84.37 71.21 84.98 85.33 65.28 86.24 85.46 62.34 85.24 83.16 104.59 103.76 100.35 99.28 100.54 84.65 85.39 81.12 109.65 102.39 98.90 98.05 99.21 79.36 87.27 80.76 112.76 101.25 99.87 98.59 97.92 75.29 Net 2 Net 3 Net 4 Actual 28.44 25.88 24.99 23.79 23.94 24.18 25.33 28.32 32.39 65.05 87.79 120.40 138.30 103.30 105.10 144.30 147.70 149.20 148.20 96.49 69.71 39.28 41.45 35.51

July 17, 2012
Net 1 26.33 24.26 24.11 24.06 24.08 24.12 24.49 26.79 29.86 48.22 67.59 79.46 86.33 75.22 76.43 89.76 95.78 103.70 103.50 90.78 78.65 68.46 68.78 54.12 88.54 108.72 102.39 103.00 121.36 131.28 133.33 135.29 124.67 92.64 91.58 112.79 101.22 101.31 124.68 131.87 136.59 138.64 119.65 85.69 90.27 115.50 99.56 101.70 129.40 135.80 139.50 140.80 112.70 82.49 Net 2 Net 3 Net 4 Actual 32.93 27.42 26.32 25.67 25.94 25.47 26.03 27.46 27.34 31.90 35.54 41.12 71.91 32.05 43.46 89.15 97.32 30.31 29.20 31.66 30.82 25.26 22.88 20.74

July 18, 2012
Net 1 30.36 28.13 27.04 26.11 26.15 25.83 25.94 26.97 26.94 31.18 34.22 39.25 66.43 34.21 41.83 73.58 79.85 32.59 31.08 31.88 31.09 27.16 23.54 21.82 73.29 82.69 76.89 83.76 74.82 85.24 Net 2 Net 3 Net 4

1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24

60

Table 4.2. Comparison of Neural Networks based Methods in terms of MAPE, RMSE and MAE
Day MAPE 26.05 8.35 11.87 13.44 10.19 15.81 13.46 26.90 42.16 15.51 12.20 14.79 6.87 15.63 16.26 27.94 6.89 9.14 21.27 8.24 21.77 24.10 11.21 21.96 11.33 15.18 34.37 12.58 12.61 6.34 Net 1 RMSE 18.76 3.64 3.23 3.50 2.54 4.15 2.73 8.90 64.89 3.64 2.45 9.46 4.06 12.49 8.00 27.76 5.05 2.46 7.30 2.97 8.55 21.56 8.00 9.49 4.40 5.70 11.85 3.32 3.07 1.75 MAE 12.36 2.71 3.05 3.21 2.25 3.87 2.66 6.90 27.09 3.55 2.44 7.11 2.40 8.80 6.35 20.13 2.52 2.20 5.93 2.18 6.80 14.73 3.76 5.91 2.90 3.92 6.15 2.70 2.68 1.50 Net 1 + Net 2 MAPE RMSE MAE 23.27 17.45 11.04 8.35 3.64 2.71 11.87 3.23 3.05 13.44 3.50 3.21 10.19 2.54 2.25 15.81 4.15 3.87 13.46 2.73 2.66 26.90 8.90 6.90 37.61 52.29 21.46 15.51 3.64 3.55 12.20 2.45 2.44 12.90 8.22 6.20 6.14 3.36 2.14 14.19 10.8 8.00 14.40 6.64 5.62 17.69 17.18 12.74 6.60 4.70 2.41 9.14 2.46 2.20 21.27 7.30 5.93 8.24 2.97 2.18 21.77 8.55 6.80 21.04 19.31 12.86 9.62 6.67 3.23 21.96 9.49 5.91 11.33 4.40 2.90 15.18 5.70 3.92 34.37 11.85 6.15 12.58 3.32 2.70 12.61 3.07 2.68 6.34 1.75 1.50 16.35 15.53 5.76 14.66 8.08 12.08 8.57 5.31 10.91 Net 1 + Net 3 MAPE RMSE MAE 22.50 17.03 10.68 8.35 3.64 2.71 11.87 3.23 3.05 13.44 3.50 3.21 10.19 2.54 2.25 15.81 4.15 3.87 13.46 2.73 2.66 26.90 8.90 6.90 29.45 40.29 17.06 15.51 3.64 3.55 12.20 2.45 2.44 12.09 7.75 5.81 5.48 3.02 1.91 12.33 9.63 6.94 14.83 6.84 5.79 16.14 15.59 11.63 6.07 4.08 2.22 9.14 2.46 2.20 21.27 7.30 5.93 8.24 2.97 2.18 21.77 8.55 6.80 20.07 18.58 12.26 8.78 6.12 2.94 21.96 9.49 5.91 11.33 4.40 2.90 15.18 5.70 3.92 34.37 11.85 6.15 12.58 3.32 2.70 12.61 3.07 2.68 6.34 1.75 1.50 14.77 15.01 8.92 12.89 7.49 18.50 7.72 5.03 15.60 Net 1 + Net 4 MAPE RMSE MAE 20.24 15.14 9.60 8.35 3.64 2.71 11.87 3.23 3.05 13.44 3.50 3.21 10.19 2.54 2.25 15.81 4.15 3.87 13.46 2.73 2.66 26.90 8.90 6.90 27.37 37.83 15.94 15.51 3.64 3.55 12.20 2.45 2.44 11.58 7.43 5.56 5.16 2.71 1.80 11.24 8.91 6.33 14.15 6.59 5.52 14.75 14.5 10.63 6.13 1.73 1.30 9.14 2.46 2.20 21.27 7.30 5.93 8.24 2.97 2.18 21.77 8.55 6.80 17.25 16.81 10.54 7.97 5.67 2.67 21.96 9.49 5.91 11.33 4.40 2.90 15.18 5.70 3.92 34.37 11.85 6.15 12.58 3.32 2.70 12.61 3.07 2.68 6.34 1.75 1.50 13.58 14.61 11.35 11.73 7.10 22.74 6.99 4.78 19.80

Jan 3, 2012 Jan 4, 2012 Jan 5, 2012 Jan 6, 2012 Jan 7, 2012 Jan 8, 2012 Mar 2, 2012 Mar 3, 2012 Mar 4, 2012 Mar 5, 2012 Mar 6, 2012 Jun 20, 2012 Jun 28, 2012 Jul 6, 2012 Jul 16, 2012 Jul 17, 2012 Jul 18, 2012 Jul 19, 2012 Jul 20, 2012 Jul 21, 2012 Jul 22, 2012 Aug 4, 2012 Aug 24, 2012 Oct 1, 2012 Oct 2, 2012 Oct 3, 2012 Oct 4, 2012 Oct 5, 2012 Oct 6, 2012 Oct 7, 2012 Average 19.19 18.00 10.52 (Spike Days) Average 16.48 9.19 5.96 (All Days) Improvement over Net 1 (%)

61

4.6

Method Effectiveness To provide a comparison of different spike re-forecasting methods, MAPEs, RMSEs and

MAEs for all of the 30 selected days are shown in Table 4.2. Net 1 performs well during the normal price range. At price spikes, the prices forecasted by Net 1 deviate from the actual prices significantly. For spike price re-forecasting, Net 3 using the ten past spike prices and demand performs better than Net 2 utilizing the five past spike prices and demand. Comparing the combination of Net 1 and Net 2 with Net 1, the overall average MAPE is reduced from 16.48% to 15.53%, a reduction of 5.76%; comparing Net 1 and Net 3 with Net 1, the reduction is 8.92%. To further increase the forecasting accuracy, weather data are also considered for the training of Net 4. The training data set for Net 4 consists of demand, temperature, dew point temperature, and humidity corresponding to spike hours from the same year and from the previous two years. The proposed method with Net 4 significantly reduces the MAPE for these selected days in 2012, as shown in Table 4.2. The overall average MAPE value for the 30 selected days in 2012 is reduced from 16.48% to 14.61%, a reduction of 11.35%. The proposed hybrid neural networkbased method, combining results from two neural networks, improves the overall forecasting accuracy. A combination of Net 1 with Net 2, Net 3 or Net 4 also reduces the forecasting error in terms of RMSE and MAE. Combining the results of Net 1 and Net 4 improves RMSE from 9.19% to 7.10% and MAE from 5.96% to 4.78%, a reduction of 22.74% and 19.80%, respectively, as shown in Table 4.2. A comparison with other methods is shown in Table 4.3 to illustrate the effectiveness of the proposed method. The MAPE values for day-ahead spike forecasting of the PJM electricity market in the year of 2008 calculated using the principal component analysis (PCA), numerical sensitivity analysis (NSA), correlation analysis (CA), modified relief (MR), mutual information (MI), two stage correlation analysis (CA-CA), two stage mutual information (MI-MI), modified relief-mutual information (MR-MI), and mutual information-interaction gain (MI-IG) methods (Amjady and Keynia, 2011) are compared with the proposed method in Table 4.3. The proposed method outperforms all these techniques.

62

Table 4.3. Comparison of Spike Days MAPE to Illustrate the Effectiveness of the Method Methodology Principal Component Analysis Numerical Sensitivity Analysis Correlation Analysis Modified Relief Mutual Information Two Stage Correlation Analysis Two Stage Mutual Information Modified Relief-Mutual Information Mutual Information-Interaction Gain Net 1 + Net 3 in this Chapter Net 1 + Net 4 in this Chapter MAPE (Spike Days) 31.1 30.2 32.4 26.4 25.6 24.2 20.2 19.2 16.1 14.8 13.6

4.7

Summary A novel methodology based on neural networks is developed in this Chapter to forecast

the day-ahead electricity spikes and prices. A base neural network (Net 1) is trained and used to forecast electricity prices. The forecasted prices are classified into normal and spike prices based 63

on a threshold defined by the previous year's prices. Another neural network (Net 2, Net 3, or Net 4) is trained and utilized to re-forecast the spike prices. Three spike forecasting neural networks are developed to examine the impact of input features. The method presented in this Chapter is used to forecast electricity prices and spikes in the Ontario wholesale electricity market. Because of its single-settlement operation, the wholesale electricity market of Ontario, Canada, is one of the most volatile electricity markets in the world. The numerical results demonstrate significant improvements in the forecasting accuracy as measured by MAPE, RMSE and MAE. In particular, the average MAPE, RMSE and MAE of numerical experiments covering 30 days from different seasons are reduced from 16.48%, 9.19%, and 5.96% achieved by Net 1, to 15.53%, 8.08%, and 5.31% by a combination of Net 1 and Net 2, 15.01%, 7.49%, and 5.03% by Net 1 and Net 3, and 14.61%, 7.10%, and 4.78% by Net 1 and Net 4, respectively. The main contribution of the proposed methodology is the ability to forecast day-ahead normal and spike prices by using simple neural network models trained with inputs selected with data mining techniques. The proposed methodology can be utilized by market participants in forecasting day-ahead electricity prices.

64

CHAPTER 5 Day-ahead Electricity Price Forecasting Utilizing Multi-set Canonical Correlation Analysis and Neural Networks

5.1

Introduction In Chapter 4, a new methodology to forecast day-ahead electricity prices and spikes is

developed. Simple correlation tests are employed to select the numbers of training days, similar days corresponding to each training day, and similar price days to build training data sets for the base neural network (Net 1) that is used to forecast day-ahead electricity prices. These initial results are further improved by detecting the spikes and re-forecasting the spike prices utilizing other neural networks, called Net 2, Net 3 and Net 4, trained over spike hours using various input features from the previous two years. Overall day-ahead forecasting is achieved by reconstructing the spike prices with normal prices. As shown in Figure 5.1, the base model is enhanced in Chapter 5 while the spike forecasting method is further improved in Chapter 6.

65

Figure 5.1. Base Electricity Price and Spike Forecasting Model and its Enhancements In Chapter 5, to improve the performance of Net 1, a systematic technique used to achieve data fusion, called multi-set canonical correlation analysis (MCCA), is introduced and utilized to select the optimal numbers of training days, similar days corresponding to each training day, and similar price days for each forecasting day. To further develop the selected model, experiments are conducted with different numbers of hidden neurons in the hidden layer of the neural 66

network. The error measures of mean absolute percentage error (MAPE), forecast mean square error (FMSE), mean absolute error (MAE), and mean absolute percentage deviation (MAPD) are used to evaluate the performance of forecasting models. In Chapter 6, further enhancement of the spike forecasting method is presented by using another neural network called Net 5 to re-forecast spike prices by selecting candidate variables from the System Status Reports (SSR). These reforecasted spike prices are re-constructed along with normal prices from the enhanced base model to achieve overall day-ahead forecasting.

5.2

Initial Electricity Price Forecasting Approach In Chapter 4, a neural network, Net 1, is used to forecast day-ahead electricity prices

initially. More specifically, as shown in Figure 5.2, day-ahead electricity prices are forecasted using a three layer feed forward neural network trained over the price and demand data. In this case, the demand at t - 1 hour, price at t -1 hour and average price of five similar price days, at t hour, where t = 1, 2, 3, ..., 24, are used as the neural network inputs to forecast the electricity price at t hour in a forecasting day. Similarly, price at t+1 hour of the selected forecasting day is
 predicted with   as the forecasted price at t hour, demand  at t hour and the average price  of five similar price days +1 at t+ 1 hour as the input features.

67

 -1

 -1

 



Figure 5.2. Electricity Price Forecasting Using Net 1

The selected training data are TDY,- days prior to the day before the forecasting day in the same year and TDY-1,- days before and TDY-1,+ days after the forecasting day in the previous year. Using simple correlation tests, it is determined that the set of TDY,-=TDY-1,+=TDY-1,- = 45 days are highly correlated (Sandhu et al., 2014, 2016a, 2016b). To train the neural network a total of TD = 135, where TD = TDY,-+TDY-1,++TDY-1,-, training days are selected and are denoted by d1, d2, ..., d135, where di is numbered backwards, starting from the day before the forecasting day. For example, to select the training days corresponding to March 5, 2012, the selected days are d1 = March 4, 2012, the day before the forecasting day, up to d45 = January 20, 2012, for a total of 45 days from the same year. The remaining 90 days are selected as 45 days after March 5, 2011 including March 5, 2011, and 45 days before March 5, 2011. Therefore, d46 = April 18, 2011, ..., d90 = March 5, 2011, d91 = March 4, 2011, ..., and d135 = January 19, 2011. In the next step, to simplify the training process of the neural network, similar price days are calculated by first selecting SD Y,- similar days from the day before the training day in the same year and SD Y-1,- similar days before and SD Y-1,+ similar days after the training day from the previous year. Corresponding to each training day, SD = 90 similar days are selected, where SD = SD Y,- + SD Y-1,-+ SD Y-1,+ and SD Y,- = SD Y-1,-= SD Y-1,+ = 30 days. For these selected similar days Euclidean distance is calculated with respect to the corresponding training day at each hour (Sandhu et al., 2014, 2016a, 2016b). In the following step, similar price days are determined 68

using the smallest Euclidean distances, as calculated in Chapter 4, in respect of the price corresponding to the selected training day for each hour. Neural network training is carried out over all the selected 135 training days for 24 hours in each day. The initial forecasting results for 30 selected days in 2012 for the Ontario electricity market based on analysis of simple correlation tests of the data are reported in Chapter 4. A comparison with five other studies, two published in journal papers (Rodriguez and Anders, 2004; Mandal et al., 2013) and three appeared in conference papers (Shrivastava et al., 2011; Mandal et al., 2012; Azmira et al., 2013), for the Ontario electricity market is shown in Table 5.1. Forecasting accuracy, as defined in Eq. (5.1), is calculated in terms of MAPE. MAPE =   =1 where  ,
1 | - |  


(5.1)

   represent actual, forecasted and average of the actual prices,   , and 

respectively, for i = 1, 2,..., 24, and over h = 24 hours. In Shrivastava et al. (2011), all of the seven days are selected from one week in the winter season in 2010. Eight days, with two days from each season and these two days are further chosen as one weekend and one weekday, are selected in 2010 in Mandal et al. (2012) and Mandal et al. (2013). In Chapter 4 and Sandhu et al. (2016a), 30 days, of which 11 are spike days in actual prices, from all of the seasons in 2012 and a mix of weekdays and weekends are chosen.
Table 5.1. Comparisons with Other Forecasting Studies Authors Rodriguez and Anders (2004) Shrivastava et al. (2011) Mandal et al. (2012) Mandal et al. (2013) Azmira et al. (2013) Chapter 4 Numbers of Cases Studied Neurons selected: 4, 8 and 12 Cases: 3 Days: 7 from the year of 2010 Days: 8 from the year of 2010 Days: 8 from the year of 2010 Cases: 6 Hidden Neurons: 2 Days: 30 from the year of 2012 MAPE over a Day 23.3% (best value) Case 2: 10.10% (average value) 7.81% (average value) 6.98% (average value) 18.74% (best value) 15.01% (average value)

69

In this Chapter, the model developed in Chapter 4 is enhanced using a popular technique used in data fusion, called multi-set canonical correlation analysis (MCCA). The correlations between the numbers of selected training days, similar days and similar price days are calculated using MCCA and the optimal training data sets are selected. Further, numbers of hidden neurons in the hidden layer are examined to avoid under fitting or over fitting of the neural networks. Significant improvements are achieved over the base neural network (Net 1) presented in Chapter 4, in terms of various forecasting error measures.

5.3

Multi-set Canonical Correlation Analysis (MCCA)

5.3.1 Introduction to MCCA The method developed in this chapter is applied to forecast day ahead prices for the Ontario wholesale electricity market, which is one of the most volatile electricity markets in the world, as discussed in Chapter 3 (Zareipour et al., 2007b). The forecasting process is carried out in two steps. First, an MCCA algorithm is utilized to select the optimal numbers of training days, similar days, and similar price days. Second, a feed forward neural network is used to forecast the day-ahead electricity prices. The neural network is trained with the training days highly correlated in a window, as determined by the MCCA algorithm in the first step. To improve the forecasting accuracy for the problem on hand, selections of input features are analyzed in this Chapter based on the following considerations:     How to select the optimal number of training days, How to choose the optimal number of similar days corresponding to each training day, How to select the best number of similar price days, and How to choose the optimal number of hidden neurons. To address the first three issues, MCCA is used at the data mining stage for selecting training data sets. The fourth issue is tackled by numerical experiments. In general, MCCA is used for features fusion in the field of pattern recognition and cross-set correlation to find similar images as reported in the literature (Yuan et al., 2011; Zhao et al., 2011). To the best of the author's knowledge, no work is reported on the use of the MCCA method in the electricity price

70

forecasting problem. This is the first time that the MCCA method is used to select the optimal data sets to train neural networks for forecasting day-ahead electricity prices. MCCA is an extension to canonical correlation analysis (CCA) for multiple data sets and used in the field of artificial intelligence, educational research, management science, and medical sciences to analyze multidimensional relations between multiple independent and multiple dependent variables (Correa et al., 2010; Yuan et al., 2011; Zhao et al., 2011). Canonical correlation technique expresses the linear correlation between two highdimensional datasets X and Y using their auto-covariances and cross-covariances (Nielsen, 2002). Several linear combinations between two sets of variables are calculated. These combinations are known as canonical variables and correlation in these canonical variables is known as canonical correlation. To examine the canonical relationship between a set of two variables X1, X2, ... , Xp and Y1, Y2, ... , Yp with sample mean zero for all the variables, two linear combinations are formed as follows P1 = a11X1 + a12X2 + ... + a1mXm Q1 = b11Y1 + b12Y2 + ... + b1nYn (5.2) (5.3)

for corr(P1, Q1) = R1 to be the maximum. In the next step another set of canonical variables is identified as P2 = a21X1 + a22X2 + ... + a2mXm Q2 = b21Y1 + b22Y2 + ... + b2nYn (5.4) (5.5)

for corr(P2, Q2) = R2 to be the maximum with corr(P1, P2) = 0 and corr(Q1, Q2) = 0. In the similar manner remaining canonical variables are identified. The total number of canonical variables  min (m, n), where m and n are the number of variables in X and Y. Two-set canonical correlation analysis can be extended to multi-set canonical correlation analysis, if real random variables are given in n sets X1, X2, ..., Xn , with dimensions m1, m2, ..., mn , the objective of MCCA is to search for directions U = (U1, U2, ..., Un) , where
  U1 = 1 1 , var(U1) = 1 11 1   U2 = 2 2 , var(U2) = 2 22 2 .   Un =   , var(Un) =   
. .

(5.6) (5.7) (5.8) 71

with dispersion matrix:
  1 11 1 1 12 2   2 21 1 2 22 2 . = . .   [ 1 1 2 2 2 . . . . . .  1 1   2 2 

(5.9)
. . .     ]

 where var(Ui) denotes the variance of Ui, ij = cov(Xi, Xj) and    = cov(Ui, Uj). The  dispersion matrix is symmetric  =  . MCCA is formulated as a generalized eigenvalue

problem. The objective of MCCA is to find optimal vectors a1, a2, ..., an to maximize the correlation. 5.3.2 Selection of Input Features Using MCCA MCCA is used to find the correlation of different sets of days corresponding to the forecasting day. Experiments have been conducted with various selections of the number of training days, number of similar days corresponding to each training day, and number of similar price days. The process of using MCCA to select the optimal numbers of training days, similar days, and similar price days is shown in Figure 5.3. Corresponding to a selected forecasting day, 30, 35, 40, 45, 50, 55 and 60 training days are selected from the same and the previous years, starting from the day before the forecasting day. In the next step, 30, 31, ..., 65 similar days are selected from the same and the previous years corresponding to each training day. Then, to select similar price days, the minimum Euclidian distance is calculated and 3, 5, 10 and 15 days are examined. Correlation tests are executed using MCCA with different groupings of training days, similar days and similar price days and the group with the maximum correlation is selected. This process is repeated for each selected forecasting day and a new set of these days is selected as the input to the neural network.

72

Figure 5.3. Process of Using MCCA to Select the Number of Training Days, Number of Similar Days, and Number of Similar Price Days. In the case of the Ontario electricity market for the year of 2012, correlation tests are carried out for 30, 35, 40, 45, 50, 55 and 60 training days with the combinations of 30, 31, 32,..., 65 similar days and combinations of 3, 5, 10 and 15 similar price days using MCCA, from the same and the previous year, corresponding to each forecasting day. The MCCA algorithm selects TDY,- = TDY-1,+ = TDY-1,- = 55, a total of 165 days as the set of highly correlated training days, as shown in Figure 5.4(a). Moreover, MCCA chooses SD
Y,- Y-1,- Y-1,+

= SD

= SD

= 50 days as the

set of highly correlated similar days, for a total of SD = 150 days, where SD = SD Y,- + SD Y-1,-+ SD Y-1,+, corresponding to each training day, and are denoted by SD1, SD2,..., SD150, where SDj is numbered backwards, starting from the day before the training day, as shown in 5.4(b). For example, to select the set of similar days corresponding to d165 = November 12, 2010, the selected days are SD1 = November 11, 2010, the day before the selected training day, up to SD50 = September 23, 2010, for a total of 50 days from the same year. The remaining 100 days are selected as 50 days before November 12, 2009, and 50 days after November 12, 2009 including 73

November 12, 2009. Therefore, SD51 = December 31, 2009, ..., SD100 = November 12, 2009, SD101 = November 11, 2009, ..., and SD150 = September 23, 2009.

Selected 165 training days 110 training days from the previous year

55 training days from the same year

Time
TD
Y-1,-

TD

Y-1,+

TD

Y,-

(a)

Forecasting day (Previous Year)

Forecasting day

Day before forecasting day

150 similar days corresponding to each training day 100 similar days from the previous year 50 similar days from the same year

Time

SD Y,-

SD Y,-

SD Y,-

(b)

Training day (Previous Year)

Training day (d165) Day before training day

Figure 5.4. (a) Selection of the Total Number of Training Days; (b) Selection of the Total Number of Similar Days Corresponding to Each Training Day In the succeeding step, the price and demand values are different at each hour and all of the 150 similar day data points are required as an input vector to the neural network. Hence, in order to further reduce the number of data points, similar price days are selected by MCCA in groups of 3, 5, 10 and 15. A set of 5 similar price days reveals the maximum correlation and is selected by MCCA as the set of similar price days corresponding to each hour for a given training day. This process is continued for all the selected 165 training days and the training data set is prepared, which consists of 165×24×5 data points. Three representative tables showing the 74

effectiveness of MCCA with the selected number of similar days and selected number of similar price days corresponding to a set of selected training days are presented in Table 5.2, Table 5.3 and Table 5.4 with 45 training days, 55 training days and 60 training days, respectively. A highly correlated matrix, as shown in Table 5.3, is formed by MCCA with 55×50×5 days, where 55 are the number of selected training days, 50 are the number of similar days corresponding to each training day, and 5 are the number of similar price days. The value in each cell of Tables 5.2, 5.3, and 5.4 denotes the percentage correlation. If these selected numbers of days are decreased or increased, correlation decreases.

75

Table 5.2. Correlation between Different Similar Price Days with Selected Similar Days Corresponding to 45 Training Days

Selected Similar Days 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65

Similar Price Days 3 Days 73.46 77.50 73.61 76.59 73.13 73.72 72.55 75.46 76.10 75.28 74.55 75.87 75.89 76.07 75.81 77.67 73.25 76.26 73.42 72.72 75.64 74.70 74.75 75.97 76.62 74.10 75.97 74.50 77.05 77.00 73.54 75.68 75.49 75.24 77.22 73.59 5 Days 77.54 75.95 82.52 80.16 78.84 80.11 79.36 80.18 79.35 80.77 79.18 82.95 76.75 75.85 75.88 75.51 78.24 78.59 77.93 81.11 80.02 81.18 82.46 82.78 76.54 76.11 80.57 75.75 79.20 79.24 81.89 78.88 78.15 80.37 80.93 79.16 10 Days 81.13 79.35 83.27 80.36 78.40 84.79 80.19 81.98 84.19 81.23 84.63 81.55 84.15 84.34 81.98 78.18 80.98 81.82 80.43 79.77 85.40 81.87 85.99 81.52 84.92 81.57 85.28 84.80 81.40 79.94 85.11 86.54 80.95 84.04 81.95 85.50 15 Days 79.38 75.17 80.03 80.93 77.60 80.19 78.12 75.08 75.40 76.85 79.24 79.78 79.53 76.23 77.74 74.63 74.78 74.95 78.75 77.47 75.33 77.47 75.03 74.38 79.95 77.92 80.51 78.88 78.08 79.71 80.15 80.92 74.00 80.06 78.29 80.93

76

Table 5.3. Correlation between Different Similar Price Days with Selected Similar Days Corresponding to 55 Training Days

Selected Similar Days 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65

Similar Price Days 3 Days 83.14 84.52 85.28 84.89 83.27 83.24 85.33 85.72 84.60 83.33 85.48 84.01 83.88 85.24 83.03 83.15 85.00 84.81 84.58 85.19 85.12 85.34 83.86 85.08 84.67 84.19 83.18 85.34 84.01 84.82 85.22 83.31 83.38 84.65 84.46 85.67 5 Days 90.20 89.94 87.21 87.29 87.35 90.19 90.77 89.73 87.53 89.89 87.44 87.47 89.56 88.32 89.62 90.00 89.33 89.96 87.94 89.94 90.88 90.47 87.34 88.47 88.48 89.74 89.39 90.16 88.47 87.82 87.35 90.09 87.82 88.55 89.21 87.92 10 Days 86.93 86.45 85.46 87.35 85.30 85.88 85.71 86.59 85.27 86.22 85.31 85.34 87.35 85.87 86.81 87.89 86.30 87.08 87.27 86.30 86.97 85.33 87.80 85.56 85.80 87.39 86.46 87.31 86.19 85.82 85.11 87.02 86.29 86.36 86.83 85.18 15 Days 82.95 84.32 84.09 82.38 82.39 82.28 82.02 83.27 83.97 84.17 83.59 82.33 83.90 82.38 82.40 82.30 82.43 82.50 82.59 82.95 82.95 82.65 82.75 84.68 84.11 83.67 82.55 82.64 82.23 84.74 84.12 83.67 82.94 82.50 83.87 84.96

77

Table 5.4. Correlation between Different Similar Price Days with Selected Similar Days Corresponding to 60 Training Days

Selected Similar Days 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65

Similar Price Days 3 Days 76.51 76.77 77.19 76.22 78.05 77.21 78.95 77.21 77.86 76.46 77.14 76.48 78.27 78.61 77.05 78.06 76.88 77.59 78.50 77.79 77.01 76.90 77.36 77.27 77.08 77.67 78.23 77.27 77.29 76.37 76.07 76.87 76.95 77.96 78.87 78.81 5 Days 80.83 79.96 82.06 82.04 81.96 81.97 79.42 81.73 80.85 79.85 79.39 82.29 79.70 79.65 81.66 82.58 81.07 81.81 79.61 82.81 81.16 81.72 79.15 82.24 81.99 79.48 81.10 80.30 81.19 80.60 80.66 79.72 80.02 79.08 82.69 81.61 10 Days 83.73 80.65 83.68 83.18 82.31 81.76 81.03 83.01 80.91 80.26 83.07 82.68 82.86 82.57 81.68 81.56 83.26 81.27 83.26 83.16 83.41 82.02 82.54 83.80 81.78 80.24 83.47 82.52 81.42 83.99 80.90 82.61 82.42 81.55 80.57 80.10 15 Days 79.26 78.55 80.18 79.11 80.52 80.20 79.71 78.53 80.87 78.80 80.77 78.67 79.12 78.26 79.92 78.54 78.14 80.17 79.04 79.98 79.15 79.88 78.06 80.73 80.40 80.24 80.44 79.15 79.85 79.73 79.59 78.83 78.75 79.35 78.68 80.41

78

A mesh graph representing the data in Table 5.3 is given in Figure 5.5 and demonstrates that a selection of 55 training days with 50 similar days and 5 similar price days has the highest peak corresponding to the percentage correlation in the mesh.

Figure 5.5. Correlation between Different Similar Price Days and Similar Days Given 55 Training Days Using MCCA Given each of 30, 35, 40, 45, 50, 55 and 60 training days, the maximum correlation and corresponding numbers of similar days and similar price days as determined using MCCA are given in Table 5.5. It is observed that the correlation increases with an increase in the number of training days until the maximum correlation is reached with 55 training days. A further increase in the number of training days decreases the correlation. Table 5.5 shows that the selection of 55 training days with 50 similar days and 5 similar price days represents 90.88% correlation, which is the highest correlated data set. The enhanced base neural network model trained over this highly correlated data set outperforms that of Net 1, which is discussed in Chapter 4.

79

Table 5.5. Maximum Percentage Correlation and Corresponding Numbers of Similar Days and Similar Price Days for a Given Number of Training Days Using MCCA

Number of Training Days 30 35 40 45 50 55 60

Maximum correlation 70.98 74.89 77.81 86.54 88.00 90.88 83.99

Number of Similar Days 39 37 55 61 59 50 59

Number of Similar Price Days 10 5 5 10 10 5 10

5.4

Results of Electricity Price Forecasting Utilizing MCCA The price forecasting based on the training data sets built by utilizing information from

MCCA is demonstrated for a set of 30 different days from all the seasons in the year of 2012. Further, these days are selected from weekdays and weekends as shown in Table 5.6. In Table 5.6, spike days are highlighted. To check the effectiveness of the enhanced base model, MAPE over each day is calculated with different numbers of hidden neurons - 3, 7, 10, 12 and 15 neurons. The minimum MAPE is observed with 12 neurons in most days, whereas, in a few days including January 4, 2012 (Wednesday), January 7, 2012 (Saturday), March 2, 2012 (Friday), March 6, 2012 (Tuesday), July 19, 2012 (Thursday), and October 7, 2012 (Sunday) the minimum MAPE is achieved with 10 hidden neurons. It is observed that a neural network with 12 hidden neurons, trained over a data set selected by using MCCA, is capable of forecasting electricity prices with 93.34% accuracy for non-spike days and an overall forecasting accuracy of 90.77%. Although, there are better results in a few days with 10 hidden neurons, the neural network with 12 hidden neurons is selected overall.

80

Table 5.6. MAPEs for Different Days in the Year of 2012 with 3, 7, 10, 12 and 15 Hidden Neurons

Days
January 3, 2012 (Tuesday) January 4, 2012 (Wednesday) January 5, 2012 (Thursday) January 6, 2012 (Friday) January 7, 2012 (Saturday) January 8, 2012 (Sunday) March 2, 2012 (Friday) March 3, 2012 (Saturday) March 4, 2012 (Sunday) March 5, 2012 (Monday) March 6, 2012 (Tuesday) June 20, 2012 (Wednesday) June 28, 2012 (Thursday) July 6, 2012 (Friday) July 16, 2012 (Monday) July 17, 2012 (Tuesday) July 18, 2012 (Wednesday) July 19, 2012 (Thursday) July 20, 2012 (Friday) July 21, 2012 (Saturday) July 22, 2012 (Sunday) August 4, 2012 (Saturday) August 24, 2012 (Friday) October 1, 2012 (Monday) October 2, 2012 (Tueday) October 3, 2012 (Wednesday) October 4, 2012 (Thursday) October 5, 2012 (Friday) October 6, 2012 (Saturday) October 7, 2012 (Sunday)

MAPEs with Different Number of Hidden Neurons 3 Neurons 7 Neurons 10 Neurons 12 Neurons 15 Neurons
32.66 15.89 17.92
31.40

26.21 8.12 10.67
10.60

22.11 5.98 8.58
6.65

20.26 6.24 6.78
3.46

23.06 7.65 8.14
7.82

19.87 25.87 18.70 34.26 46.78 25.06 18.69 19.75
27.84

10.02 13.18 11.42 23.29 41.96 15.89 11.78 13.89
9.56

6.34 8.76 3.20 13.64 31.48 12.43 6.98 13.63
8.74

7.16 6.56 4.92 8.24 29.94 7.68 7.24 12.74
3.87

7.98 9.78 12.64 14.16 31.88 11.49 8.45 14.06
5.97

21.56 19.60 41.24
32.84

16.49 17.61 29.91
18.63

15.02 15.63 25.62
14.74

13.16 14.78 24.12
6.89

14.68 16.10 26.73
8.92

16.92 28.78 17.21

8.46 18.67 11.65

5.49 14.21 8.92

6.28 6.49 7.38

7.32 10.26 8.10

25.83
50.10

19.07
33.21

13.94
28.56

7.72
21.92

10.38
22.53

34.7 27.95
21.25 22.35

9.44 15.52
10.45 14.21

7.79 8.23
7.63 11.66

4.00 6.47
5.21 8.16

8.12 9.92
6.34 9.25

26.72
23.12 22.67 13.14

15.12
11.24 11.84 6.12

8.20
9.08 9.11 3.19

4.02
6.38 5.19 3.59

6.96
8.76 6.78 3.89

Average (Overall) Average (Spike Days) Average (Non-Spike Days)

26.02
34.16 22.53

15.81
22.14 13.09

11.85
18.63 8.95

9.23
15.21 6.66

11.60
17.33 9.15

81

The selection of different numbers of neurons in the hidden layer of a neural network plays a vital role and incorrect selection may cause under fitting or over fitting of neural networks, resulting in higher forecasting errors. Figure 5.6 shows a comparison of MAPEs with various numbers of hidden neurons for the four representative days of winter and summer seasons from the year of 2012, including January 3, 2012 (Tuesday), March 3, 2012 (Saturday), July 17, 2012 (Tuesday) and July 22, 2012 (Sunday). Further, these days are selected as weekdays and weekends to demonstrate variations in MAPEs for spike and normal days. It is observed from Figure 5.6 that MAPE values are higher, for all representative days, if 3 neurons are selected in the hidden layer. MAPEs decrease with an increase in the number of neurons in the hidden layer and the minimum MAPE values are achieved for 12 neurons. A further increase in the number of neurons may result in an over fitting of the neural network, hence, an increase in MAPEs is observed for 15 neurons.

Figure 5.6. Comparison of MAPEs with Different Numbers of Hidden Neurons for Four Representative Days

82

Forecasting results for the next 24 hours are graphically represented for some selected days in Figures 5.7 to 5.11. The day of January 3, 2012 is shown in Figure 5.7 and the results are obtained using the feed forward neural network along with an MCCA algorithm. The neural network is trained with the training set over 165 days selected with MCCA and the results are given for 10, 12 and 15 neurons in the hidden layer. The minimum MAPE of 20.26% is noted for 12 neurons in the hidden layer, which is an improvement of 22.23% from Net 1, presented in Sandhu et al. (2016a).
140

120

Actual Prices 10 Neurons with MAPE 22.11% 12 Neurons with MAPE 20.26% 15 Neurons with MAPE 23.06%

100

HOEP in CAD

80

60

40

20

2

4

6

8

10

12 14 Hours of Day (January 3, 2012)

16

18

20

22

24

Figure 5.7. Price Forecasting for January 3, 2012 (Tuesday) with Different Numbers of Hidden Neurons

83

30

25

HOEP in CAD

20

15

10 Actal Prices 10 Neurons with MAPE 3.2 % 12 Neurons with MAPE 4.92 % 15 Neurons with MAPE 12.64 %

5

2

4

6

8

10

12

14

16

18

20

22

24

Hours of Day (March 2, 2012)

Figure 5.8. Price Forecasting for March 2, 2012 (Friday) with Different Numbers of Hidden Neurons
110 100 90 80 Actual Prices 10 Neurons with MAPE 8.74% 12 Neurons with MAPE 3.87% 15 Neurons with MAPE 5.97%

HOEP in CAD

70 60 50 40 30 20 10 2 4 6 8 10 12 14 16 18 20 22 24

Hours of Day (June 28, 2012)

Figure 5.9. Price Forecasting for June 28, 2012 (Thursday) with Different Numbers of Hidden Neurons

84

120 Actual Prices 10 Neurons with MAPE = 15.02 % 12 Neurons with MAPE = 13.16 % 15 Neurons with MAPE = 14.68 %

100

80

HOEP in CAD

60

40

20

0

2

4

6

8

10

12

14

16

18

20

22

24

Hours of Day (July 6, 2012)

Figure 5.10. Price Forecasting for July 6, 2012 (Friday) with Different Numbers of Hidden Neurons

35

Actual Prices 10 Neurons with MAPE 9.11% 12 Neurons with MAPE 5.19% 15 Neurons with MAPE 6.78%

30

HOEP in CAD

25

20

15

2

4

6

8

10

12

14

16

18

20

22

24

Hours of Day (October 6, 2012)

Figure 5.11. Price Forecasting for October 6, 2012 (Saturday) with Different Numbers of Hidden Neurons Day-ahead price forecasting for the day of March 2, 2012 is shown in Figure 5.8 with a minimum MAPE of 3.2%, when a number of 10 neurons is selected in the hidden layer. The MAPE is reduced from 13.46% obtained with Net 1, in Chapter 4, with a reduction of 72.66%. 85

The forecasting of prices for the day of June 28, 2012 is illustrated with different numbers of hidden neurons along the actual prices in Figure 5.9. A minimum MAPE of 3.87% is obtained with 12 hidden neurons and is improved from 6.87%, given by Net 1 in Chapter 4. Similarly, July 6, 2012 (Friday) and October 6, 2012 (Saturday) from the summer and fall seasons in the year of 2012 are selected and electricity prices are forecasted over the 24 hours as shown in Figures 5.10 and 5.11, respectively. The MAPE values of 13.16% and 5.19% are reported with 12 neurons in the hidden layer, with a reduction of 15.80% and 58.84%, respectively, from Net 1 in Chapter 4, presented in Sandhu et al. (2016a). In a similar manner, 30 days in total are selected for all the seasons of 2012. These days are chosen as weekdays and weekends as shown in Table 5.6. Performance of the forecasting is also measured using various other criteria, as shown in Table 5.7, including mean absolute error (MAE), forecast mean square error (FMSE), and mean absolute percentage deviation (MAPD). Error variance 2 is also calculated in order to further test the robustness (Mandal et al., 2013). These measures are defined as follows: MAE FMSE = =
 |  =1( -   )|   1  (  -   )  =1 
  =1 | - |   =1 ( )  

1



(5.11) (5.12)

2

MAPD =
1

(5.13)
2  100



2

=

  | - | ( =1   

-

)

(5.14)

where,  and   represent the actual and forecasted hourly prices, respectively, for i = 1, 2,...,  denotes the average of the actual prices over 24 hours. h indicates the total number of 24, and  hours for which the forecasted error is calculated. Therefore the value of h is taken as 24.



86

Table 5.7 Various Forecasting Error Measures with 12 Hidden Neurons Forecasting Error Measures Selected Days MAE FMSE MAPD 9.64 15.06 0.20 January 3, 2012 (Tuesday) 2.02 2.72 0.06 January 4, 2012 (Wednesday) 1.74 1.88 0.07 January 5, 2012 (Thursday) 0.83 0.99 0.03 January 6, 2012 (Friday) 1.58 1.99 0.07 January 7, 2012 (Saturday) 1.61 1.73 0.07 January 8, 2012 (Sunday) 0.97 1.16 0.05 March 2, 2012 (Friday) 2.12 3.79 0.08 March 3, 2012 (Saturday) 16.16 37.44 0.30 March 4, 2012 (Sunday) 1.76 1.79 0.08 March 5, 2012 (Monday) 1.45 1.46 0.07 March 6, 2012 (Tuesday) 6.12 8.83 0.13 June 20, 2012 (Wednesday) 1.35 3.04 0.04 June 28, 2012 (Thursday) 7.41 11.35 0.13 July 6, 2012 (Friday) 5.77 10.14 0.15 July 16, 2012 (Monday) 17.38 26.81 0.24 July 17, 2012 (Tuesday) 2.52 5.05 0.07 July 18, 2012 (Wednesday) 1.50 1.60 0.06 July 19, 2012 (Thursday) 1.81 3.19 0.06 July 20, 2012 (Friday) 1.96 2.91 0.07 July 21, 2012 (Saturday) 2.47 3.75 0.08 July 22, 2012 (Sunday) 13.39 21.79 0.22 August 4, 2012 (Saturday) 1.34 2.66 0.04 August 24, 2012 (Friday) 1.82 3.12 0.06 October 1, 2012 (Monday) 1.34 2.58 0.05 October 2, 2012 (Tueday) 2.11 3.77 0.08 October 3, 2012 (Wednesday) 0.81 1.26 0.04 October 4, 2012 (Thursday) 1.37 1.88 0.06 October 5, 2012 (Friday) 1.10 1.29 0.05 October 6, 2012 (Saturday) 0.85 0.99 0.04 October 7, 2012 (Sunday) Average (Overall) 3.74 6.20 0.09 Average (Spike Days) 8.37 14.67 0.15 Average (Non-Spike Days) 1.76 2.57 0.07

2 0.90 0.09 0.10 0.03 0.11 0.09 0.05 0.15 1.98 0.13 0.12 0.36 0.03 0.38 0.48 1.28 0.10 0.09 0.09 0.12 0.13 1.06 0.04 0.09 0.06 0.15 0.04 0.09 0.06 0.03 0.28 0.68 0.11

Table 5.7 illustrates MAE, FMSE, MAPD, and error variance 2. Further, these forecasting error measures are calculated with 3, 7, 10, 12 and 15 hidden neurons and the best results are observed with 12 hidden neurons for various days from different seasons over the year of 2012.

87

In this Chapter, HOEP values are forecasted for a day-ahead with significant improvement in forecasting performance. A comparison of various forecasting performance measures with other studies is given in Table 5.8 for the Ontario electricity market. The average errors over the 24 hours are revealed with 12 hidden neurons, considering the best combination of the number of neurons as represented in Table 5.6. Compared to the other studies on the Ontario electricity market a significant improvement in mean absolute percentage error is recorded in the present study.
Table 5.8. Comparison of Error Measures with other Forecasting Studies Authors
Rodriguez and Anders (2004) Shrivastava et al. (2011) Mandal et al. (2012) Mandal et al. (2013) Azmira et al. (2013) This Chapter

Method
Neural network and fuzzy logic SVM Fuzzy ARTMAP (FA) and firefly (FF) Fuzzy ARTMAP (FA) and firefly (FF) Neural network

MAPE
23.3 (best value) 10.10 (average value, Case 2) 7.81 (average value) 6.98 (average value) 18.74 (best value) 6.66 (average value of 21 non-spike days)

FMSE
NC* NC* NC*

MAE
NC*

MAPD
NC* NC* NC* NC* NC*

2
NC* NC* NC*

24.2 NC*

3.31 NC*

2.46 NC*

0.004 NC*

Neural network with MCCA, 12 neurons in the hidden layer * Not Calculated

2.57

1.76

0.07

0.11

A comparison of MAPEs, calculated with Network 1, for the selected eight days in the year of 2012 as reported in Sandhu et al. (2016b) is given in Table 5.9. For example, in the present study, the MAPE improvements of 19.39% for the eight days and 63.70% for the case of August 24, 2012, a spike price day, are shown with respect to the initial results.

88

Table 5.9. Comparison of MAPEs for the Selected Eight Days as Reported in Sandhu et al. (2016b)

Days January 3, 2012 (Tuesday) June 20, 2012(Wednesday) June 28, 2012 (Thursday) July 6, 2012 (Friday) July 17, 2012 (Tuesday) July 18, 2012 (Wednesday) August 4, 2012 (Saturday) August 24, 2012 (Friday) Average

MAPEs Sandhu et al. (2016b) Network 1 26 14.8 6.87 15.6 27.9 6.9 24.1 11.02 16.65

This Chapter Using 12 Neurons 20.26 12.74 3.87 13.16 24.12 6.89 21.92 4.00 13.37

Similarly, a comparison of the MCCA method presented in this Chapter with the study presented in Sandhu et al. (2016a) and discussed in Chapter 4, where the same days are selected in the year of 2012 is given in Table 5.10. A comparison with Net 1 from Chapter 4 shows that the overall average MAPE is reduced from 16.48% to 9.23%, as obtained with 12 neurons and using the MCCA method. An improvement of 38.51% and 36.82% is also achieved compared to the results of Net 1 combined with Net 3 and Net 1 combined with Net 4, respectively, as given in Table 5.10.

89

Table 5.10. Comparison of MAPEs for Selected 30 Days in the Year of 2012 as Reported in Chapter 4

Days of Year 2012
January 3, 2012 (Tuesday) January 4, 2012 (Wednesday) January 5, 2012 (Thursday) January 6, 2012 (Friday) January 7, 2012 (Saturday) January 8, 2012 (Sunday) March 2, 2012 (Friday) March 3, 2012 (Saturday) March 4, 2012 (Sunday) March 5, 2012 (Monday) March 6, 2012 (Tuesday) June 20, 2012 (Wednesday) June 28, 2012 (Thursday) July 6, 2012 (Friday) July 16, 2012 (Monday) July 17, 2012 (Tuesday) July 18, 2012 (Wednesday) July 19, 2012 (Thursday) July 20, 2012 (Friday) July 21, 2012 (Saturday) July 22, 2012 (Sunday) August 4, 2012 (Saturday) August 24, 2012 (Friday) October 1, 2012 (Monday) October 2, 2012 (Tueday) October 3, 2012 (Wednesday) October 4, 2012 (Thursday) October 5, 2012 (Friday) October 6, 2012 (Saturday) October 7, 2012 (Sunday)

Net 1 26.05 8.35 11.87 13.44 10.19 15.81 13.46 26.90 42.16 15.51 12.20 14.79 6.87 15.63 16.26 27.94 6.89 9.14 21.27 8.24 21.77 24.10 11.21 21.96 11.33 15.18 34.37 12.58 12.61 6.34 16.48

Net 1 + Net 2 23.27 8.35 11.87 13.44 10.19 15.81 13.46 26.90 37.61 15.51 12.20 12.90 6.14 14.19 14.40 17.69 6.60 9.14 21.27 8.24 21.77 21.04 9.62 21.96 11.33 15.18 34.37 12.58 12.61 6.34 15.53

Net 1 + Net 3 22.50 8.35 11.87 13.44 10.19 15.81 13.46 26.90 29.45 15.51 12.20 12.09 5.48 12.33 14.83 16.14 6.07 9.14 21.27 8.24 21.77 20.07 8.78 21.96 11.33 15.18 34.37 12.58 12.61 6.34 15.01

Net 1 + Net 4 20.24 8.35 11.87 13.44 10.19 15.81 13.46 26.90 27.37 15.51 12.20 11.58 5.16 11.24 14.15 14.75 6.13 9.14 21.27 8.24 21.77 17.25 7.97 21.96 11.33 15.18 34.37 12.58 12.61 6.34 14.61

MCCA
20.26 6.24 6.78
3.46

7.16 6.56 4.92 8.24 29.94 7.68 7.24 12.74
3.87

13.16 14.78 24.12
6.89

6.28 6.49 7.38

7.72
21.92

4.00 6.47
5.21 8.16

4.02
6.38 5.19 3.59

Average (Overall)

9.23

90

5.5

Combined Forecasting Results of Electricity Prices and Spikes Observing the results from Table 5.10, the neural network trained with the data sets

selected using the MCCA method outperforms the neural network trained using simple correlation tests. There is a scope for further improvement in the forecasting performance, if the neural network combined with MCCA method is used as the base model to forecast the electricity prices initially and the spike prices are re-forecasted using Net 3 as shown in Figure 5.1. Table 5.11 shows the MAPEs for the base model enhanced by MCCA and a combination of the enhanced base model with Net 3, where a data re-constructor is used to combine the forecasted normal prices using the enhanced base model with the re-forecasted spike prices using Net 3. As shown in Table 5.11, the average MAPE is reduced from 9.23% to 7.92%, a reduction of 14.19%.

91

Table 5.11 Combined Forecasting Results by the Combination of Enhanced Base Model and Net 3
MAPEs with 12 Neurons Days January 3, 2012 (Tuesday) January 4, 2012 (Wednesday) January 5, 2012 (Thursday) January 6, 2012 (Friday) January 7, 2012 (Saturday) January 8, 2012 (Sunday) March 2, 2012 (Friday) March 3, 2012 (Saturday) March 4, 2012 (Sunday) March 5, 2012 (Monday) March 6, 2012 (Tuesday) June 20, 2012 (Wednesday) June 28, 2012 (Thursday) July 6, 2012 (Friday) July 16, 2012 (Monday) July 17, 2012 (Tuesday) July 18, 2012 (Wednesday) July 19, 2012 (Thursday) July 20, 2012 (Friday) July 21, 2012 (Saturday) July 22, 2012 (Sunday) August 4, 2012 (Saturday) August 24, 2012 (Friday) October 1, 2012 (Monday) October 2, 2012 (Tueday) October 3, 2012 (Wednesday) October 4, 2012 (Thursday) October 5, 2012 (Friday) October 6, 2012 (Saturday) October 7, 2012 (Sunday) Average (Overall) Average (Spike Days) Average (Non-Spike Days) MCCA 20.26 6.24 6.78 3.46 7.16 6.56 4.92 8.24 29.94 7.68 7.24 12.74 3.87 13.16 14.78 24.12 6.89 6.28 6.49 7.38 7.72 21.92 4.00 6.47 5.21 8.16 4.02 6.38 5.19 3.59 9.23 15.21 6.66 MCCA + Net 3 17.61 6.24 6.78 3.46 7.16 6.56 4.92 8.24 28.72 7.68 7.24 10.70 3.30 6.35 14.78 11.12 6.07 6.28 6.49 7.38 7.72 9.82 4.00 6.47 5.21 8.16 4.02 6.38 5.19 3.59 7.92 10.85 6.66 14.19 28.66

Improvement over MCCA (Overall) (%) Improvemrnt over MCCA (Spike Days) (%)

92

Illustrations of price forecasting results by both the enhanced base model and the combination of the enhanced base model with Net 3 which is trained over the spike prices as discussed in Chapter 4 are shown in Figures 5.12 to 5.14. The results for the day of January 3, 2012 is given in Figure 5.12, with the MAPE is reduced from 20.26% to 17.61%. The results for June 28, 2012 and July 6, 2012 are presented in Figures 5.13 and 5.14, respectively. The MAPEs are reduced from 3.87% and 13.16% to 3.30% and 6.35%, with a reduction of 14.73% and 51.75%, respectively. The results are calculated for all the selected 30 days in the year of 2012 and are shown in Table 5.11.
140

120

Actual Prices MCCA Method (MAPE = 20.26%) MCCA + Net 3 Method (MAPE = 17.61%)

100
HOEP in CAD

80

60

40

20

2

4

6

8

10 12 14 Hours of Day (January 3, 2012)

16

18

20

22

24

Figure 5.12. Comparison of Price Forecasting for January 3 , 2012 (Tuesday) Using the Enhanced Base Model and the Combination of the Enhanced Base Model with Net 3

93

120 Actual Prices MCCA Method (MAPE = 3.87 %) MCCA + Net 3 Method (MAPE = 3.30 %)

100

80

HOEP in CAD

60

40

20

0

2

4

6

8

10

12

14

16

18

20

22

24

Hours of Day (June 28, 2012)

Figure 5.13. Comparison of Price Forecasting for June 28, 2012 (Thursday) Using the Enhanced Base Model and the Combination of the Enhanced Base Model and Net 3
120 Actual Prices MCCA Method (MAPE = 13.16 %) MCCA + Net 3 Method (MAPE = 6.35 %)

100

80

HOEP in CAD

60

40

20

0

2

4

6

8

10

12

14

16

18

20

22

24

Hours of Day (July 6, 2012)

Figure 5.14. Comparison of Price Forecasting for July 6, 2012 (Friday) Using the Enhanced Base Model and the Combination of the Enhanced Base Model and Net 3 Various other forecasting error measures as discussed in Section 5.4 are also calculated for the combination of enhanced base model and Net 3. The results are displayed in Table 5.12 and show an overall improvement over the enhanced base model. The combination of enhanced base 94

model with Net 3 also outperforms the enhanced base model, in terms of forecasting error measures, for the spike days. Table 5.12 Various Forecasting Error Measures Using the Combination of the Enhanced Base Model and Net 3
Selected Days January 3, 2012 (Tuesday) January 4, 2012 (Wednesday) January 5, 2012 (Thursday) January 6, 2012 (Friday) January 7, 2012 (Saturday) January 8, 2012 (Sunday) March 2, 2012 (Friday) March 3, 2012 (Saturday) March 4, 2012 (Sunday) March 5, 2012 (Monday) March 6, 2012 (Tuesday) June 20, 2012 (Wednesday) June 28, 2012 (Thursday) July 6, 2012 (Friday) July 16, 2012 (Monday) July 17, 2012 (Tuesday) July 18, 2012 (Wednesday) July 19, 2012 (Thursday) July 20, 2012 (Friday) July 21, 2012 (Saturday) July 22, 2012 (Sunday) August 4, 2012 (Saturday) August 24, 2012 (Friday) October 1, 2012 (Monday) October 2, 2012 (Tueday) October 3, 2012 (Wednesday) October 4, 2012 (Thursday) October 5, 2012 (Friday) October 6, 2012 (Saturday) October 7, 2012 (Sunday) Average (Overall) Average (Spike Days) Improvement on Enhanced Base Method (Overall) (%) Improvement on Enhanced Base Method (Spike Days) (%) Forecasting Error Measures MAE FMSE MAPD 2 8.36 13.38 0.18 0.68 2.02 2.72 0.06 0.09 1.74 1.88 0.07 0.10 0.83 0.99 0.03 0.03 1.58 1.99 0.07 0.11 1.61 1.73 0.07 0.09 0.97 1.16 0.05 0.05 2.12 3.79 0.08 0.15 15.50 37.63 0.29 1.82 1.76 1.79 0.08 0.13 1.45 1.46 0.07 0.12 5.14 7.67 0.11 0.25 1.15 2.57 0.03 0.02 3.57 5.95 0.06 0.09 5.77 10.14 0.15 0.48 8.01 12.21 0.11 0.27 2.22 4.08 0.06 0.08 1.50 1.60 0.06 0.09 1.81 3.19 0.06 0.09 1.96 2.91 0.07 0.12 2.47 3.75 0.08 0.13 6.00 8.21 0.10 0.21 1.34 2.89 0.04 0.04 1.82 3.12 0.06 0.09 1.34 2.58 0.05 0.06 2.11 3.77 0.08 0.15 0.81 1.26 0.04 0.04 1.37 1.88 0.06 0.09 1.10 1.29 0.05 0.06 0.85 0.99 0.04 0.03 2.94 4.95 0.08 0.19 5.70 10.51 0.11 0.38 21.32 31.91 20.12 28.36 12.59 27.41 31.43 43.46

95

To illustrate the effectiveness of the proposed method, a comparison of MAPE and MAE values for the day-ahead spike forecasting of the South Australian electricity market in the year of 2009 as reported by Wang et al. (2014) is shown in Table 5.13. Wang et al. (2014) uses ARIMA (A), back propagation neural network (B), and Kalman filtering (K) methods as well as traditional (T) and weighted (C) combinations of these methods. In terms of MAPE and MAE measures, the proposed method in this Chapter outperforms all these techniques. Table 5.13 Comparison of MAPE and MAE Values to Illustrate the Effectiveness of the Proposed Method Methodology ARIMA BP Kalman A-B (using T) A-B (using C) B-K (using T) B-K (using C) A-K (using T) A-K (using C) A-B-K (using T) A-B-K (using C) Enhanced Base Model + Net 3 in this Chapter (Spike Days) MAPE 20.05 25.32 21.01 25.19 24.10 21.12 20.19 21.12 20.80 21.12 20.79 10.85 MAE 7.93 7.81 6.04 7.72 7.15 6.30 6.18 6.32 6.13 6.32 6.12 5.70

5.6

Summary In this Chapter, a popular technique used in data fusion, multi-set canonical correlation

analysis (MCCA), is introduced for the first time into the electricity price forecasting problem. MCCA is used to select the training data sets for a neural network by determining the optimal numbers of training days, similar days, and similar price days. The neural network is further explored with different numbers of neurons in the hidden layer. The experiments show that the network with 12 neurons in the hidden layer outperforms the network with 3, 7, 10, or 15 96

neurons. The wholesale electricity market of Ontario, Canada, is used to test the enhanced base model for forecasting the prices initially and the combination of the enhanced base model and Net 3 for forecasting the prices and spikes. Significant improvements are achieved over the existing studies with various forecasting performance measures. The results with the combination of the enhanced base model with Net 3 represent a significant reduction in the average MAPE from 15.21% to 10.85% for spike days and 9.23% to 7.92% overall. Furthermore, the combination of the enhanced base model with Net 3 reduces the average MAPE over the enhanced base model by 28.66% and 14.19% for spike days and for all the selected 30 days, respectively.

97

CHAPTER 6 Day-ahead Electricity Spike Price Forecasting Using Supply Cushion

6.1

Introduction A base model and three spike forecasters are presented in Chapter 4 to predict normal

electricity prices and spikes. The base model is enhanced using multi-set canonical correlation analysis (MCCA) in Chapter 5. The Ontario electricity market is used to test the models developed. In this Chapter, an improved price spike forecasting model is developed by mining data from the Ontario electricity market. In particular, relevant data from the Ontario electricity market are investigated and candidate variables are identified. Data available from the System Status Report (SSR) are mined in this Chapter to examine the behavior of the hourly Ontario energy prices (HOEPs). The neural network called Net 3 discussed in Chapter 4 is enhanced with the addition of a set of selected candidate inputs, including supply cushion, to forecast the spike prices. Various forecasting accuracy measures are calculated to evaluate the performance of the enhanced model. The main objective of this Chapter is to mine relevant Ontario electricity market data and use the neural network based forecasting methods developed in the previous Chapters to forecast the 24-hour ahead electricity prices and spikes. First, the neural network trained by the data sets built by using the MCCA, as described in Chapter 5, is used as the enhanced base model in Chapter 6 and day-ahead electricity prices are forecasted. Second, a classifier is employed to determine spikes in the forecasted prices. Third, the spike forecasting model called Net 3 in Chapter 4 is re-designed with the addition of a set of inputs, now called Net 5, and is used to reforecast the spike prices. Finally, forecasted prices and re-forecasted spikes are combined together using a data re-constructor to obtain day-ahead forecasted electricity prices.

98

6.2

Analysis of Explanatory Variables from the System Status Report The System Status Report (SSR) published by IESO provides forecasting information on

the Ontario electricity demand and supply, operating reserves, energy imports, capacity excess or shortfall, and minimum operating reserve requirements. It also furnishes information on the planned transmission and generation outages. A SSR is released at least 24 hours in advance corresponding to each day and is updated in case of changes in the system status or forecasts. The SSRs are published at ieso.ca and are used in this Chapter to identify a set of explanatory candidate variables for electricity price spike forecasting. The hourly Ontario energy prices (HOEPs) are uniform all over the province of Ontario, Canada. The wholesale customers are billed for HOEPs and forecasting for HOEPs is challenging for market participants as well as for IESO (MSP, 2014). A simulation-based forecasting known as pre-dispatch prices (PDPs) is published by IESO and is updated hourly until real-time (Zareipour et al., 2007a). One-hour-ahead PDP is sent by IESO to the Ontario market participants as the final price before real-time. These one-hour-ahead PDPs, published in the historical market data, significantly deviate from the actual prices. A calculation of MAPE shows an error of 20.59% between PDPs and actual prices over the period of January 1, 2009 to December 31, 2011. As discussed in Chapter 3 and reported in various other studies (Zhao et al., 2011; Motamedi et al., 2012). Demand is considered as one of the main factors involved in determining the electricity prices. Day-ahead SSRs publish the forecasted day-ahead total Ontario demand, which consists of the demand by the Ontraio consumers plus exports and losses. As shown in Figure 6.1, the day-ahead total Ontario demand and HOEP show a direct correlation. The calculated linear correlation coefficient between the HOEP and the total Ontario demand in SSRs, available before real-time, is 0.64. Therefore, HOEPs can be considered having a good dependency on demand. MAPE as defined in Eq. (6.1) is calculated to check the deviation between real time historical demand and forecasted historical demand:  =
100  ×24 ×24  =1 |, - , | ,

(6.1)

99

where , and , are the forecasted and actual values of demand at hour t, respectively, and N is the number of days in the studied year (N = 365 for 2011). Day-ahead SSR demand, compared with the actual demand and total Ontario demand (demand plus exports and losses), has the MAPEs of 3.2% and 5.4% for the year of 2011. Thus, in place of historical real time demand, the day-ahead SSR forecasted demand is included as an explanatory candidate variable for the neural network for spike forecasting in this Chapter. It should be pointed out that, in Chapters 4 and 5, historical demand data are used whenever they are available at the time of forecasting. When historical demand data are not available at the time of forecasting, day-ahead SSR forecasted demand is utilized.
600

500

400

Electricity Prices in CAD

300

200

100

0

-100

-200

1

1.5

2

2.5 x 10
4

Total Ontario Demand (MW)

Figure 6.1. Relationships between the Day-ahead Total Ontario Demand and HOEP for the Year of 2011 Operating reserve can be defined either a standby power source or a demand reduction that can be called on with a short notice to cover up any unexpected mismatch between generation and consumption. IESO uses the operating reserve market to meet the unexpected demand requirements in the real-time energy market. The operating reserve can be classified into three classes that can be offered by dispatchable generators and dispatchable loads:   10-minute synchronized (spinning) reserve, 10-minute non-synchronized (non-spinning) reserve, and 100



30-minute (non-synchronized) reserve. Dispatchable generators or loads can make offers in the operating reserve market, if energy

provided is within the time frame specified by the class of operating reserve (either 10 minutes or 30 minutes) and participants are able to sustain supplying operating reserve energy for up to an hour with equal or greater amounts of energy supplied to the real-time market. Dispatchable participants may offer into one or all three classes of operating reserve. If the offer made by a participant in the operating reserve market is selected, but not activated, a stand-by payment will be issued for every selected megawatt. Operating reserves play an important role in the electricity market and may be considered as responsible for price spikes. For example, on January 29, 2014 at 8:00 am, the HOEP, as discussed in Chapter 3, an hourly average of market clearning prices which are calculated at an interval of 5 minutes, was reported as $611.38/MWh (MSP, 2014). The hourly average demand at 8:00 am was reported as 23,048 MW, which is 400 MW lower than the demand forecasted at the five periods prior to 8:00 am, at an interval of 5 minutes each. Typically the price should be lower in real-time as compared to the pre-dispatch prices. The estimated prices was less than real-time prices, as expected, up to 7:45 am, but rose to $1,999 from 7:50 am to 8:00 am, whereas demand decreased by 70 MWs from 7:45 am to 7:50 am. This price spike was reported as a result of shortage of offers for 30 minutes operating reserves. The operating reserve information, hence, is crucial in forecasting spike prices and is used in this Chapter to calculate the Supply Cushion. Supply cushion (SC) is calculated in terms of actual energy offered, total demand (TD) of the market and operating reserve (OR). The chances of occurrence of spikes are higher for low SC and vice-versa. In this Chapter, actual values are replaced with predicted values from SSRs and predicted supply cushion is calculated using Eq. (6.2). Supply data in SSR reports do not show linear correlations with HOEPs. Hence, the concept of Predicted Supply Cushion (PSC) is used as one of the candidate variables in this Chapter and is defined as follows (Zareipour et al., 2006):  =
-(+) +

× 100

(6.2)

where PEO is the predicted energy offered, PTD is the predicted market demand, and POR is the predicted operating reserve, as observed from SSRs. Figure 6.2 shows relationships between the Predicted Supply Cushion and HOEP for the Year of 2011. The calculated linear correlation 101

coefficient between the HOEP and predicted supply cushion is -0.62. It was observed in Zareipour et al. (2006) that price spikes are more likely when the PSC is below 10%. Therefore, PSC is added as an explanatory candidate variable.
400

300

Electricity Prices in CAD

Threshold Level = $71.26

200

100

0

-100

-200

0

10

20

30

40

50

60

70

80

Predicted Supply Cushion (%)

Figure 6.2. Relationships between the Predicted Supply Cushion and HOEP for the Year of 2011 The information on planned outage of generating facilities is also available in SSRs. The physical operating structure of the Ontario electricity market has an indirect influence on the behavior of HOEPs. For example, chances of occurrence of spikes increase if the low cost generation facilities are to be replaced with high cost generation facilities, due to the outage of low cost facilities, especially during low demand hours (MSP, 2014). A correlation with the HOEP is calculated for the outage data from SSRs, with a coefficient of 0.24. Therefore, the information on planned outage is not considered as a candidate variable in the neural network design.

6.3

Spike Forecasting Using a Neural Network (Net 5) Neural networks for forecasting are capable of achieving considerable accuracy with

adequate learning and smartly selecting inputs as well as the numbers of hidden layers and neurons in the hidden layers (Jiang and Ma, 2016). Therefore, in this Chapter, the enhanced base 102

model discussed in Chapter 5 is used to forecast the day-ahead electricity prices. In particular, as shown in Figures 5.4(a) and 5.4(b) in Chapter 5, the enhanced base neural network is trained using the data sets built by utilizing the MCCA algorithm. TDY,-=TDY-1,+=TDY-1,- = 55 for a total number of 165 training days, SD Y,- = SD
Y-1,- Y-1,+

= SD

= 50 for a total of 150 similar days

corresponding to each training day, and 5 similar price days for each similar day are selected. The results forecasted by the enhanced base model are classified as normal or spike prices using a spike classifier. The spike threshold is defined as PTH =  + 2 (6.3)

where  in the mean and  be the standard deviation of HOEPs from the previous year. The price values above this threshold level are considered as spike prices and are re-forecasted using an enhanced spike forecasting model called Net 5, trained using a new set of candidate variables. Whenever a spike is detected by the classifier, the model switches from the enhanced base model to enhanced spike forecasting model. 6.3.1 Training of Net 5 The enhanced spike forecasting model, Net 5, is shown in Figure 6.3 and is trained by using the ten spike prices occurring at the same hour as the detected spike hour identified from the day before the forecasting day up to the previous two years as well as the day-ahead forecasted demand and the predicted supply cushion using the SSR information. The results of enhanced spike forecasting model are combined with the results of enhanced base model using a data re-constructor and overall day-ahead price and spikes are forecasted with improved forecasting accuracy.

103

 1

 2

Figure. 6.3. Enhanced Spike Forecasting Neural Network (Net 5) For each detected spike hour in a forecasting day, Net 5 is trained over all the spike hours occurring from the day before the forecasting day up to the previous two years. For a particular
 spike hour, the training data set is composed of the predicted demand  , predicted supply  cushion  and 10 spike prices, denoted by  , i = 1, 2, ..., m, and m = 10, occurring

at the particular spike hour from the day before the forecasting day up to the previous two years. For example, to forecast the spike price at 12:00 hours on January 6, 2012, all spike hours over all the days for 24 hours a day from January 5, 2012, the day before the forecasting day, up to January 11, 2010 are used to train Net 5. A spike hour occurring from January 10, 2010 to January 1, 2010 is not used as a training data point since it does not have ten input spike prices.

. . .
 10    



104

A spike hour occurring from January 11, 2010 up to the day before the forecasting day may not have corresponding ten spike prices. In this case, the ten maximum prices at the same hour are used as the input spike prices. To forecast the spike price at 12:00 hour on January 6, 2012, the predicted demand and supply cushion from the day-ahead SSR at this hour along with the first ten spike prices occurring at 12:00 hour, counted backward from January 5, 2012 to January 11, 2010, are applied as the inputs to the trained neural network, and the spike price at 12:00 hour on January 6, 2012 are re-forecasted. 6.3.2 Spike Forecasting Results A total of 30 days are selected for the year of 2012, over different seasons and 24-hour ahead prices are forecasted using the enhanced base model. Nine days, out of the selected 30 days, are classified as spike days and the prices for spike hours on these nine days are reforecasted in this Chapter using Net 5. The forecasting results for two representative days showing the deviation from the actual prices are displayed in Figure 6.4 and Figure 6.5 for the day of July 17, 2012 and August 4, 2012, respectively.
160 Actual Prices Enhanced Base Method + Net 5 (MAPE = 10.57%)

140

120

HOEP in CAD

100

80

60

40

20

2

4

6

8

10

12 14 Hours of Day (July 17, 2012)

16

18

20

22

24

Figure 6.4. Electricity Price Forecasting for July 17, 2012 Using the Combination of the Enhanced Base Model and Net 5

105

180 160 Actual Prices Enhanced Base Method + Net 5 (MAPE = 9.27%)

140 120

HOEP in CAD

100

80 60

40

20

2

4

6

8

10 12 14 Hours of Day (August 4, 2012)

16

18

20

22

24

Figure 6.5. Electricity Price Forecasting for August 4, 2012 Using the Combination of the Enhanced Base Model and Net 5 For July 17, 2012, the MAPE is reduced from 24.12% obtained with the enhanced base model to 10.57% achieved by the combination of the enhanced base model and Net 5. The MAPE for August 4, 2012 is reduced from 21.92% to 9.27%, which is a reduction of 57.71%.

6.4

Numerical Experimental Results and Discussions Spike prices are forecasted using Net 5 and a data re-constructor is used to combine the

results with the enhanced base model. Nine days are detected as spike price days from the forecasted prices of the selected 30 days by the enhanced base method. As discussed in Chapter 5, the day of July 16, 2012 is not classified as a spike day by the enhanced base method in contrast to the results obtained by using Net 1 in Chapter 4. A comparison of MAPEs is presented in Table 6.1 for eight representative spike days. The MAPE results, discussed in Chapter 5 using the combination of the enhanced base method with Net 3 are compared with the results from the combination of the enhanced base model and Net 5. Results for eight days are shown in Table 6.1 and improvements are achieved in terms of forecasting accuracy using Net 5. The maximum improvement of 14.47% is accomplished for the day of January 3, 2012 and no improvement is observed for August 24, 2012. 106

Table 6.1. Forecasting Day-ahead Electricity Prices and Spikes Using the Enhanced Base Model and Net 5
January 3, 2012 Enhanced Base Actual Net 5 Method + Net 3 March 4, 2012 Actual Enhanced Base Method + Net 3 Net 5 Actual June 20, 2012 Enhanced Base Method + Net 3 Net 5 Actual June 28, 2012 Enhanced Base Method + Net 3 Net 5

28.34 27.69 25.31 25.22 25.88 26.66 31.16 34.77 35.89 33.82 32.96 29.05 31.62 31.48 47.13 44.83 58.15 115.20 91.28 135.3 124.7 41.33 32.09 29.16 MAPE Improvement Over the Enhanced Base Method + Net 3 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24

HOUR

29.31 28.92 27.56 27.42 27.76 28.72 32.68 35.09 35.72 34.38 33.12 32.24 33.69 32.42 39.16 36.42 48.72 81.30 84.26 112.89 116.37 65.14 60.62 58.42 17.61

93.15 88.64 122.36 117.58

18.22 18.32 22.15 22.25 22.34 20.88 20.76 19.26 20.53 20.56 20.76 21.01 20.75 20.74 19.87 20.28 20.83 41.47 263.82 389.66 183.88 26.53 20.89 19.37

15.07

19.09 19.21 22.96 23.12 23.18 21.74 21.68 21.02 21.52 21.49 21.62 22.48 21.72 21.77 20.97 21.38 21.79 38.24 152.69 255.91 176.49 71.11 57.86 37.11 28.72 5.61%

159.68 271.39 192.79

20.28 21.64 18.59 19.50 16.4 20.34 27.24 31.15 47.59 56.88 38.29 50.51 88.81 66.28 108.24 44.68 95.06 95.79 97.89 62.7 46.38 28.95 26.06 24.13

27.11

21.98 23.56 21.04 21.15 17.92 19.57 24.98 29.64 40.12 50.24 39.12 47.65 63.24 57.41 101.68 61.54 83.92 89.46 94.16 67.38 48.66 30.87 28.64 25.44 10.70 6.36%

104.26 85.29 92.67 94.87

14.17 16.64 12.47 12.65 13.06 4.38 15.80 21.06 22.71 28.24 31.31 29.16 31.50 30.70 38.82 93.76 100.11 71.86 45.37 44.38 47.15 56.56 31.39 21.70

10.02

13.69 15.92 12.76 12.94 13.01 5.31 14.97 20.88 22.39 28.19 31.08 29.12 31.21 30.94 37.14 82.36 96.25 73.65 46.42 44.45 47.10 54.91 32.04 22.14 3.30 8.79%

83.67 97.24 73.49

3.01

14.42%

107

Table 6.1. Forecasting Day-ahead Electricity Prices and Spikes Using the Enhanced Base Model and Net 5 (cont.)
HOUR
July 6, 2012
Actual Enhanced Base Method + Net 3 Net 5 Actual

July 17, 2012
Enhanced Base Method + Net 3 Net 5 Actual

August 4, 2012
Enhanced Base Method + Net 3 Net 5 Actual

August 24, 2012
Enhanced Base Method + Net 3 Net 5

21.13 1 20.92 2 19.87 3 17.43 4 16.55 5 18.93 6 24.39 7 25.16 8 30.47 9 59.01 10 11 107.06 12 77.16 13 119.04 14 96.24 15 96.33 16 94.72 17 93.17 64.23 18 43.37 19 20 88.85 21 86.84 53.90 22 53.17 23 22.36 24 MAPE Improvement Over the Enhanced Base Method + Net 3

20.84 20.42 19.64 17.73 16.98 18.92 23.86 24.56 29.24 47.35 85.39 81.12 109.65 102.39 98.9 98.05 99.21 65.22 46.38 84.98 85.33 56.33 55.21 25.38 6.35 4.09%

88.27 81.24 110.68 91.82 91.87 90.28 88.89

85.31 84.29

28.44 25.88 24.99 23.79 23.94 24.18 25.33 28.32 32.39 65.05 87.79 120.42 138.32 103.26 105.14 144.32 147.66 149.16 148.18 96.49 69.71 39.28 41.45 35.51

6.09

27.15 25.11 24.09 22.98 23.21 23.84 24.52 27.38 30.54 51.36 66.85 91.58 112.79 101.22 101.31 124.68 131.87 136.59 138.64 119.65 67.89 42.82 43.33 36.49 11.12 4.95%

92.86 114.86 106.38 106.87 124.89 132.45 137.88 139.54 117.46

27.44 26.45 27.47 27.32 25.37 24.32 25.77 23.79 24.81 45.76 58.58 54.06 84.14 92.38 100.75 162.07 157.31 94.57 109.79 151.33 49.97 25.89 23.77 23.33

10.57

26.23 25.86 26.35 26.24 24.82 23.94 25.12 22.89 24.23 39.88 46.38 45.23 64.83 83.59 89.36 144.24 143.73 103.89 114.56 145.4 59.61 29.34 27.52 25.64 9.82 5.60%

83.82 91.78 147.62 144.85 105.46 112.92 146.28

25.00 21.71 18.64 13.79 19.17 19.35 18.3 20.89 22.67 23.40 26.88 25.31 31.56 31.76 77.52 135.89 97.72 28.91 28.47 25.73 22.65 26.43 20.62 22.36

9.27

25.00 21.71 18.64 13.79 19.17 19.35 18.3 20.89 22.67 23.40 26.88 25.31 31.56 31.76 75.82 129.58 109.79 28.91 28.47 25.73 22.65 26.43 20.62 22.36 4.00 0%

75.98 128.62 108.96

4.00

108

Forecasting results with accompanying MAPEs for selected five representative days using the enhanced base model and combinations of the enhanced base model with Net 3 and Net 5 are displayed in Figures 6.6 to 6.10. Results for the day of January 3, 2012 is presented in Figure 6.6. The MAPEs are improved from 20.26% with the enhanced based model, to 17.61% with the combination of the enhanced base model and Net 3, and to 15.07% when Net 5 is combined with the enhanced base model.
140 Actual Prices Enhanced Base Method (MAPE = 20.26%) Enhanced Base Method + Net 3 (MAPE = 17.61%) Enhanced Base Method + Net 5 (MAPE = 15.07%)

120

100

HOEP in CAD

80

60

40

20

2

4

6

8

10 12 14 Hours of Day (January 3, 2012)

16

18

20

22

24

Figure 6.6. Results by Using the Enhanced Base Model with Combinations with Net 3 and Net 5 for January 3, 2012 In a similar manner, results for other selected days are presented in Figures 6.7 to 6.10. The day of March 4, 2012 is shown in Figure 6.7 with an improvement of MAPEs from 28.72% to 27.11%, an improvement of 5.61% from the combination of enhanced base model and Net 3 to enhanced base model and Net 5.

109

400 350 Actual Prices Enhanced Base Method (MAPE = 29.94%) Enhanced Base Method + Net 3 (MAPE = 28.72%) Enhanced Base Method + Net 5 (MAPE = 27.11%)

300 250

HOEP in CAD

200

150 100

50

0

2

4

6

8

10 12 14 Hours of Day (March 4, 2012)

16

18

20

22

24

Figure 6.7. Results by Using the Enhanced Base Model with Combinations with Net 3 and Net 5 for March 4, 2012
120 Actual Prices Enhanced Base Method (MAPE = 3.87%) Enhanced Base Method + Net 3 (MAPE = 3.30%) Enhanced Base Method + Net 5 (MAPE = 3.01%)

100

80

HOEP in CAD

60

40

20

0

2

4

6

8

10 12 14 Hours of Day (June 28, 2012)

16

18

20

22

24

Figure 6.8. Results by Using the Enhanced Base Model with Combinations with Net 3 and Net 5 for June 28, 2012 The days of June 28, 2012, July 17, 2012, and August 4, 2012 are shown in Figure 6.8, Figure 6.9, and Figure 6.10 with the MAPE improvements of 8.79%, 4.95% and 5.60%,

110

respectively, from the combination of enhanced base model and Net 3 to enhanced base model and Net 5.
160 Actual Prices Enhanced Base Method (MAPE = 24.12%) Enhanced Base Method + Net 3 (MAPE = 11.12%) Enhanced Base Method + Net 5 (MAPE = 10.57%)

140

120

HOEP in CAD

100

80

60

40

20

2

4

6

8

10

12 14 Hours of Day (July 17, 2012)

16

18

20

22

24

Figure 6.9. Results by Using the Enhanced Base Model with Combinations with Net 3 and Net 5 for July 17, 2012
180 160 Actual Prices Enhanced Base Method (MAPE = 21.92%) Enhanced Base Method + Net 3 (MAPE = 9.82%) Enhanced Base Method + Net 5 (MAPE = 9.27%)

140 120

HOEP in CAD

100

80 60

40

20

2

4

6

8

10 12 14 Hours of Day (August 4, 2012)

16

18

20

22

24

Figure 6.10. Results by Using the Enhanced Base Model with Combinations with Net 3 and Net 5 for August 4, 2012

111

Table 6.2 Combined Forecasting Results by the Combination of Enhanced Base Model with Net 3 and Net 5
Days January 3, 2012 (Tuesday) January 4, 2012 (Wednesday) January 5, 2012 (Thursday) January 6, 2012 (Friday) January 7, 2012 (Saturday) January 8, 2012 (Sunday) March 2, 2012 (Friday) March 3, 2012 (Saturday) March 4, 2012 (Sunday) March 5, 2012 (Monday) March 6, 2012 (Tuesday) June 20, 2012 (Wednesday) June 28, 2012 (Thursday) July 6, 2012 (Friday) July 16, 2012 (Monday) July 17, 2012 (Tuesday) July 18, 2012 (Wednesday) July 19, 2012 (Thursday) July 20, 2012 (Friday) July 21, 2012 (Saturday) July 22, 2012 (Sunday) August 4, 2012 (Saturday) August 24, 2012 (Friday) October 1, 2012 (Monday) October 2, 2012 (Tueday) October 3, 2012 (Wednesday) October 4, 2012 (Thursday) October 5, 2012 (Friday) October 6, 2012 (Saturday) October 7, 2012 (Sunday) Average (Overall) Average (Spike Days) Average (Non-Spike Days) Enhanced Base Method + Net 3 17.61 6.24 6.78 3.46 7.16 6.56 4.92 8.24 28.72 7.68 7.24 10.70 3.30 6.35 14.78 11.12 6.07 6.28 6.49 7.38 7.72 9.82 4.00 6.47 5.21 8.16 4.02 6.38 5.19 3.59 7.92 10.85 6.66 Enhanced Base Method + Net 5 15.07 6.24 6.78 3.46 7.16 6.56 4.92 8.24 27.11 7.68 7.24 10.02 3.01 6.09 14.78 10.57 5.45 6.28 6.49 7.38 7.72 9.27 4.00 6.47 5.21 8.16 4.02 6.38 5.19 3.59 7.68 10.07 6.66 3.03% 7.19%

Improvement over Enhanced Base Model + Net 3 (Overall) Improvement over Enhanced Base Model + Net 3 (Spike Days)

112

The comparison of MAPEs by the combination of enhanced base model and Net 5 with the combination of enhanced base model and Net 3 for all the selected 30 days in 2012 is displayed in Table 6.2. The improvements of 3.03% overall and 7.19% for the spike days are obtained by the combination of enhanced base model and Net 5 over the combination of enhanced base model and Net 3. The forecasting performance of the method is also measured using various other criteria, as discussed in Chapter 5, including mean absolute error (MAE), forecast mean square error (FMSE), and mean absolute percentage deviation (MAPD). Error variance 2 is also calculated in order to further test the robustness (Mandal et al., 2013). Improvements over the combination of the enhanced base model and Net 3 are observed for all measuring criteria, as demonstrated in Table 6.3. The performance criteria are defined as follows:

MAE FMSE

= =

  |  =1( -   )|  2

1

(6.4) (6.5)

  1  (  -   )  =1 
  =1 | - |   =1 ( )  

MAPD =
1

(6.6)
2  100



2

=

  | - | ( =1   

-

)


(6.7)

The actual and forecasted hourly prices are represented by  and   , respectively, for i =  denotes the average of the actual prices over h = 24 hours. 1, 2,..., 24, and 

113

Table 6.3 Various Forecasting Error Measures Using the Combination of the Enhanced Base Model and Net 5
Selected Days January 3, 2012 (Tuesday) January 4, 2012 (Wednesday) January 5, 2012 (Thursday) January 6, 2012 (Friday) January 7, 2012 (Saturday) January 8, 2012 (Sunday) March 2, 2012 (Friday) March 3, 2012 (Saturday) March 4, 2012 (Sunday) March 5, 2012 (Monday) March 6, 2012 (Tuesday) June 20, 2012 (Wednesday) June 28, 2012 (Thursday) July 6, 2012 (Friday) July 16, 2012 (Monday) July 17, 2012 (Tuesday) July 18, 2012 (Wednesday) July 19, 2012 (Thursday) July 20, 2012 (Friday) July 21, 2012 (Saturday) July 22, 2012 (Sunday) August 4, 2012 (Saturday) August 24, 2012 (Friday) October 1, 2012 (Monday) October 2, 2012 (Tueday) October 3, 2012 (Wednesday) October 4, 2012 (Thursday) October 5, 2012 (Friday) October 6, 2012 (Saturday) October 7, 2012 (Sunday) Average (Overall) Average (Spike Days) Average (Non-Spike Days) Improvement over the Enhanced Base Model + Net 3 (Overall) (%) Improvement over the Enhanced Base Model + Net 3 (Spike Days) (%) Forecasting Error Measures FMSE MAPD 11.56 0.15 2.72 0.06 1.88 0.07 0.99 0.03 1.99 0.07 1.73 0.07 1.16 0.05 3.79 0.08 34.53 0.27 1.79 0.08 1.46 0.07 7.42 0.1 2.26 0.03 5.42 0.06 10.14 0.15 11.6 0.11 3.38 0.05 1.6 0.06 3.19 0.06 2.91 0.07 3.75 0.08 7.74 0.09 2.84 0.04 3.12 0.06 2.58 0.05 3.77 0.08 1.26 0.04 1.88 0.06 1.29 0.05 0.99 0.04 4.69 0.08 9.64 0.10 2.57 0.07 5.25 8.28 0.00 9.09

MAE 7.15 2.02 1.74 0.83 1.58 1.61 0.97 2.12 14.63 1.76 1.45 4.81 1.05 3.42 5.77 7.61 1.99 1.5 1.81 1.96 2.47 5.66 1.34 1.82 1.34 2.11 0.81 1.37 1.1 0.85 2.82 5.30 1.76 4.08 7.02

2 0.5 0.09 0.1 0.03 0.11 0.09 0.05 0.15 1.62 0.13 0.12 0.22 0.02 0.08 0.48 0.25 0.07 0.09 0.09 0.12 0.13 0.19 0.04 0.09 0.06 0.15 0.04 0.09 0.06 0.03 0.18 0.33 0.11 5.26 13.16

114

6.5

Summary In this Chapter, publicly available information as contained in the System Status Report

(SSR) from the Ontario electricity market is evaluated and mined to identify explanatory candidate variables to improve HOEP forecasting accuracy. A range of market information is studied in detail, and two explanatory variables, the day-ahead SSR forecasted demand and predicted supply cushion (PSC), are selected based on the correlation criterion. PSC is calculated from the information available in SSR and PDP reports published by IESO, which is an important explanatory variable along with the predicted demand and prices. A spike forecasting neural network called Net 3 discussed in Chapter 4 is enhanced and a new neural network trained by using the ten spike prices, day-ahead forecasted demand, and predicted supply cushion, called Net 5, is developed. The numerical experimental results in this Chapter demonstrate a significant improvement in the accuracy of the forecasted HOEPs than any other reported HOEP forecasts. In this Chapter, the combination of Net 5 with the enhanced base method shows improvements over the methods discussed in Chapters 4 and 5. In particular, in terms of MAPE, the improvements of 3.03% overall and 7.19% for spike days are achieved as compared to the combination of enhanced base model and Net 3 presented in Chapter 5.

115

CHAPTER 7 Contributions and Future Work

7.1

Summary of Contributions The overall contribution of this dissertation is the development of various machine

learning-based methods to forecast day-ahead electricity prices and spikes in deregulated electricity markets. The methods developed are tested and applied to forecast electricity prices and spikes for the wholesale electricity market in the Province of Ontario, Canada, one of the most volatile electricity markets in the world. Forecasting spike prices for the Ontario wholesale electricity market is reported for the first time in the literature (Sandhu et al., 2016a). The specific contributions in this thesis are summarized as follows: 1. A comprehensive review of the Ontario electricity market including rules and regulations to participate in the market is presented. Volatility analysis for prices is carried out for the Ontario electricity market, in comparison to other major electricity markets of the world. It is shown that the Ontario electricity market is one of the most volatile electricity markets in the world. 2. A novel methodology based on neural networks is developed to forecast day-ahead electricity spikes and prices. First, a base neural network model (Net 1), trained using information from similar days and similar price days identified by correlation tests, is created and electricity prices are forecasted. Second, the prices above a threshold level, calculated from the previous year's prices, are classified as spike prices, and are reforecasted using another neural network. To test the impact of input features, three spike forecasting neural networks (Net 2, Net 3, and Net 4) are developed. Third, the overall forecasting for electricity prices and spikes is achieved by combining the results from the base model and a spike forecasting model. The idea of switching from one neural network to another to forecast spike prices is novel. Various forecasting error measures are calculated to assess the performance of the methods developed. The numerical

116

experimental results employing data from the Ontario electricity market show significant improvements in the forecasting accuracy in terms of various error measures. 3. To improve the performance of the base model (Net 1), multi-set canonical correlation analysis (MCCA), a popular technique for data fusion, is utilized to select the optimal numbers of training days, similar days, and similar price days. Furthermore, to avoid the over fitting and under fitting of neural networks, the optimal number of neurons in the hidden layer is also determined. This is the first time that MCCA is introduced into the electricity price forecasting problem. Similarly, the overall forecasting for electricity prices and spikes is obtained by re-constructing the results from the enhanced base model and a spike forecasting model (Net 3). The Ontario electricity market is utilized as the case market to carry out extensive numerical experimental studies, which demonstrate significant improvements in terms of forecasting performance. 4. Information contained in the System Status Report available publicly from the Ontario electricity market is mined to improve the price spike forecasting. A new neural network (Net 5), having inputs of the past ten spike prices and two additional variables, the forecasted demand and the predicted supply cushion based on information available from the day-ahead SSR information, is developed to forecast the price spikes. Data from the Ontario electricity market is used to conduct numerical experiments, which demonstrate significant improvements in the forecasting accuracy.

7.2

Future Work As summarized in the previous section, various machine learning-based methods to

forecast day-ahead electricity prices and spikes in deregulated electricity markets are developed and presented in this dissertation. The wholesale electricity market in the Province of Ontario, Canada, one of the most volatile electricity markets in the world, is utilized to test and apply the methods developed. The methods developed in this research are trained using the publicly available data from the Ontario electricity market. These methods may be applied to other electricity markets using different sets of data and may need to be re-trained using appropriate data sets. The new training data sets may be selected using different numbers of training days

117

with different numbers of similar days and similar price days corresponding to each training day. Further research may be pursued in the following directions:  In this thesis, spikes are classified using Eq. (4.10) based on the commonly utilized definition in the literature and the prices above the threshold price, PTH =  + 2, are considered as the spike prices. It would be worthwhile to investigate how the forecasting accuracy will be impacted if the classification methodology is changed, e.g. defining PTH =  + 1.5.  The price and spike forecasting methodology developed can be applied to study other electricity markets, including spot markets in multi-settlement electricity markets, which are used in settling the differences between the demand and supply in real time.  This thesis focuses on day-ahead electricity price and spike forecasting. Methods can be developed to forecast week-ahead electricity prices and spikes and their accuracy can be assessed by applying the methods developed to electricity markets.  It would be worthwhile to investigate in detail how the information on day-ahead forecasting can be utilized by various participants including generators, consumers, and market operators, in electricity markets.  The methods and techniques developed in this thesis are based on supervised machine learning and data mining techniques to achieve day-ahead forecasting. Methods can be developed using unsupervised machine learning techniques, e.g., self-organizing map (SOM) and k-mean clustering, along with data mining techniques, in the initial stage to form various clusters and next supervised machine learning techniques can be developed to obtain day-ahead electricity price and spike forecasting.  Methods can be developed to handle data streaming using big data technologies such as Apache Spark and Apache Kafka, in the initial stage and cascaded neural networks in the following stage to forecast market clearing prices at an interval of 5-minutes and averaging prices over 12 intervals to forecast HOEP.

118

Appendices Sample Representative Data

A.1

Sample Data Set for Price Forecasting Model Representing One of the Training Days

The data set for the 15th training day corresponding to January 6, 2012 is as follows: Hours of Training Day (December 22, 2011) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 Price at Hour 't' (CAD) 29.43 22.68 22.20 18.40 18.23 19.14 24.11 27.37 23.98 26.72 24.10 23.72 24.91 23.53 21.90 24.79 22.24 28.32 30.82 31.03 30.72 28.86 27.69 25.96 Demand at Hour 't' (MW) 15446 14387 13980 13654 13520 13575 14258 15646 17138 17432 17335 17171 17021 16992 16890 16965 17253 18153 19267 19122 18834 18621 18035 17022 Average of Similar Price Days at Hour 't+1' 24.55 22.15 19.71 18.20 18.21 23.41 27.10 25.70 25.99 26.88 25.86 25.39 25.07 24.39 25.53 24.29 28.35 30.04 30.42 30.72 28.98 27.66 26.53 23.41

119

A.2

Sample Calculations for Five Similar Price Days Corresponding to December 22, 2011

For Hour 1 Similar Price Days Price Values November 26, November 28, December 19, 2011 2011 2010 25.33 19.34 25.99 December 7, 2011 26.64 December 18, 2011 25.47

Average over Five Similar Price Days

24.55

For Hour 2 Similar Price Days Price Values November 30, November 30, December 20, 2011 2010 2011 22.55 22.36 23.70 Jannuary 5, 2011 20.91 December 6, 2011 21.24

Average over Five Similar Price Days

22.15

For Hour 3 Similar Price Days Price Values November 30, 2010 19.30 December 7, 2011 18.62 December 2, 2010 18.51 November 30, December 12, 2011 2010 20.81 21.30

Average over Five Similar Price Days

19.71

120

A.3

Selection of 10 Peak Prices in Spike Forecasting Model - Net 3

For the spike detected at 13:00 hour on June 28, 2012 Inputs of Net 3
 1  2  3  4  5  6  7  8  9  10

Spike Days Corresponding to 13:00 Hour August 8, 2011 August 5, 2011 July 21, 2011 June 30, 2011 June 8, 2011 June 7, 2011 May 11, 2011 April 3, 2011 August 9, 2010 August 11, 2011

Prices in CAD 256.00 101.93 98.59 86.56 147.75 188.25 558.24 90.23 141.56 115.21

121

References

Abedinia, O., N. Amjady and H. Zareipour (2017). A new feature selection technique for load and price forecast of electricity power systems. IEEE Transactions on Power Systems, 32 (1), pp. 62­74. Aggarwal, S.K., L.M. Saini and A. Kumar (2009). Day-ahead price forecasting in Ontario electricity market using variable-segmented support vector machine-based model. Electric Power Components and Systems, 37, pp. 495­516. Albadi, M.H. and E.F. El-Saadany (2008). A summary of demand response in electricity markets. Electric Power Systems Research, 78 (11), pp. 1989-1996. Amjady, N. and F. Keynia (2010). Electricity market price spike analysis by hybrid data model and feature selection technique. Electric Power System Resesearch, 80 (3), pp. 318­327. Amjady, N. and F. Keynia (2011). A new prediction strategy for price spike forecasting of dayahead electricity markets, Applied Soft Computing, 11, pp. 4246-4256. Amjady, N. (2012). Short-Term Electricity Price Forecasting. In J.P.S. Catalao (Ed.), Electric Power Systems Advanced Forecasting Techniques and Optimal Generation Scheduling. Boca Raton, FL: CRC Press, pp. 4.1-4.58 Anders, G.J. and C. Rodriguez (2005). Energy price forecasting and bidding strategy in Ontario power system market. Proceedings of the IEEE Conference on Power Technology, St. Petersburg, Russia, June 27-30, 7 pages. Azmira, W.A. R, T.K. A Rahman, Z. Zakaria and A. Ahmad (2013). Short-term electricity price forecasting using neural network. Proceedings of the 4th International Conference on Computing and Informatics, Sarawak, Malaysia, August 28-30, pp. 103-108. Bastian, J., J. Zhu, V. Banunarayanan and R. Mukerji (1999). Forecasting energy prices in a competitive market. IEEE Journal on Computer Applications in Power, 12 (3), pp. 40-45.

122

Bessec, M., J. Fouquau and S. Meritet (2016). Forecasting electricity spot prices using timeseries models with a double temporal segmentation. Applied Economics, 48 (5), pp 361378. Catalão, J.P.S., S.J.P.S. Mariano, V.M.F. Mendes and L.A.F.M. Ferreira (2007). Short-term electricity prices forecasting in a competitive market: A neural network approach. Electric Power Systems Research, 77 (10), pp. 1297-1304. Chief Energy Conservation Officer (2006). Ontario - A New Era in Electricity Conservation, the 2016 Annual Report,

http://www.oca.state.pa.us/dsr%20group/Background%20and%20Reference/Ontario%20 2079_CECOAR2006.pdf (accessed on April 24, 2013). Christensen, T.M., A.S. Hurn and K.A. Lindsay (2012). Forecasting spikes in electricity prices. International Journal of Forecasting, 28 (2), pp. 400­411. Coelho, L.S. and A.P. Santos (2011). A RBF neural network model with GARCH errors: Application to electricity price forecasting. Electric Power System Research, 81, pp. 74­ 83. Clements, A., J. Fuller and S. Hurn (2013). Semi-parametric forecasting of spikes in electricity prices. Economic Record, 89 (287), pp. 508-521. Conejo, A.J., J. Contreras, R. Espinola and M.A. Plazas (2005a). Forecasting electricity prices for a day-ahead pool-based electric energy market. International Journal of Forecasting, 21, pp. 435-462. Conejo, A.J., M.A. Plazas, R. Espinola and A.B. Molina (2005b). Day-ahead electricity price forecasting using the wavelet transform and ARIMA models. IEEE Transactions on Power Systems, 20 (2), pp. 1035-1042. Correa, N.M., T. Eichele, T. Adali, Y.O. Li and V.D. Calhoun (2010). Multi-set canonical correlation analysis for the fusion of concurrent single trial ERP and functional MRI. Neuroimage, 50 (4), pp. 1438-1445. Cuaresma, J.C., J. Hlouskova, S. Kossmeier and M. Obersteiner (2004). Forecasting electricity spot prices using linear univariate time-series models. Applied Energy, 77 (1), pp. 87106. 123

Dewess, D.N. (2005). Electricity restructuring and regulation in the provinces: Ontario and beyond. Presented at the CCGES Transatlantic Energy Conference, Toronto, Canada, September 9-10, 30 pages. Duan, G., Z.Y. Dong and X.F. Wang (2005). Composite auction method for suppressing unreasonable electricity price spikes in a competitive electricity market. IEE Proceedings Generation, Transmission and Distribution, 152 (4), pp. 460-468. EIA (2016). International Energy Outlook 2016, Washington D.C.: U.S. Energy Information Administration. Available at: https://www.eia.gov/outlooks/archive/ieo16/ (accessed on August 18, 2017). Eichler, M., O. Grothe, H. Manner and D. Tuerk (2013). Models for short-term forecasting of spike occurrences in Australian electricity markets: A comparative study, The Journal of Energy Markets, 7 (1), pp. 55­81. Environmental Commissioner of Ontario (2010). Re-thinking energy conservation in Ontario Results. Available at: http://www.eco.on.ca/uploads/Reports-Energy-Conservation/2010/Energy-conservationReport-2010-Fall.pdf (accessed on July 24, 2013). Figueiredo, V., F. Rodrigues, Z. Vale and J.B. Gouveia (2005). An electric energy consumer characterization framework based on data mining techniques. IEEE Transactions on Power Systems, 20 (2), pp. 596-602. Filho, J.C.R., C.M. Affonso and R.C.L. Oliveira (2014). Energy price prediction multi-step ahead using hybrid model in the Brazilian market, Electric Power Systems Research, 117, pp. 115-122. Garcia, R.C., J. Contreras, M. Akkeren and J.B.C. Garcia (2005). A GARCH forecasting model to predict day-ahead electricity prices. IEEE Transactions on Power Systems, 20 (2), pp. 867-874. Gonzalez, A., A. Roque and J. Garcia-Gonzalez (2005). Modeling and forecasting electricity prices with input/output hidden Markov models. IEEE Transactions on Power Systems, 20 (1), pp. 13­24.

124

Guan, X., Y.C. Ho and D. Pepyne (2001). Gaming and price spikes in electric power markets. IEEE Transactions on Power Systems, 16 (3), pp. 402- 408. Guo, J. and P. Luh (2004). Improving market clearing price prediction by using a committee machine of neural networks. IEEE Transactions on Power Systems, 19 (4), pp. 18671876. Hong Y.-Y. and C.-Y. Hsiao (2002). Locational marginal price forecasting in deregulated electricity markets using artificial intelligence. IEE Proceedings Generation Transmission and Distribution, 149 (5), pp. 621­626. Hong, Y.-Y. and C.-F. Lee (2005). A neuro-fuzzy price forecasting approach in deregulated electricity markets, Electric Power Systems Research, 73 (2), pp. 151­157. Huang, D., H. Zareipour, W.D. Rosehart and N. Amjady (2012). Data mining for electricity price classification and the application to demand-side management. IEEE Transactions on Smart Grid, 3 (2), pp. 808-817. Huisman, R. (2008). The influence of temperature on spike probability in day-ahead power prices. Energy Economics, 30, pp. 2697-2704. IESO (2017a). Overview of the IESO - Administered Markets. http://www.ieso.ca/-

/media/files/ieso/document-library/training/tg-overview-of-the-ieso-administeredmarkets.pdf?la=en (assessed on October 12, 2017). IESO (2017b). 18-Month Outlook: An Assessment of the Reliability and Operability of the Ontario Electricity System from July 2017 to December 2018.

http://www.ieso.ca/en/sector-participants/planning-and-forecasting/18-month-outlook (assessed on September 5, 2017). IESO (2017c). http://www.ieso.ca/en/power-data/supply-overview/imports-and-exports (assessed on September 2, 2017). Jiang, P. and X. Ma (2016). A hybrid forecasting approach applied in the electrical power system based on data preprocessing, optimization and artificial intelligence algorithms. Applied Mathematical Modelling, 40, pp. 10631-10649. Kamisski, V. (2012). Energy Markets. London, UK: Risk Books.

125

Khan, M.S., M.P. Moghaddam and M.K. Sheikh-El-Eslami (2011). Price forecasting of dayahead electricity markets using a hybrid forecast method, Energy Conversion and Management, 52, pp. 2195­2169. Lu, X., Z.Y. Dong and X. Li (2005). Electricity market price spike forecasting with data mining techniques, Electric Power System Research, 73 (1), pp. 19­29. Mandal, P., T. Senjyu, N. Urasaki, T. Funabashi and A.K. Srivastava (2006). Short-term price forecasting for competitive electricity market. Proceedings of the 38th North American IEEE Conference on Power Symposium, Carbondale, United States, September 17-19, pp. 137-141. Mandal, P., T. Senjyu, N. Urasaki, T. Funabashi and A.K. Srivastava (2007). A novel approach to forecast electricity price for PJM using neural network and similar days method. IEEE Transactions on Power Systems, 22 (4), pp. 2058-2065. Mandal P., A. Srivastava and J-W. Park (2009). An effort to optimize similar days parameters for ANN-based electricity price forecasting, IEEE Transactions on Industry Applications, 45 (5), pp. 1888­1896. Mandal P., A.U. Haque, J. Meng, R. Martinez and A.K. Srivastava (2012). A hybrid intelligent algorithm for short-term energy price forecasting in the Ontario market. Proceedings of the IEEE General Meeting of Power and Energy Society. San Diego, CA, July 22-26, 7 pages. Mandal P., A.U. Haque, J. Meng, A.K. Srivastava and R. Martinez (2013). A novel hybrid approach using wavelet, firefly algorithm, and fuzzy ARTMAP for day-ahead electricity price forecasting. IEEE Transactions on Power Systems, 28 (2), pp. 1041-1051. Manner, H., D. Turk and M. Eichler (2016). Modeling and forecasting multivariate electricity price spikes. Energy Economics, 60, pp. 255-265. Martini, A., P. Pelacchi, L. Pellegrini, M.V. Cazzol, A. Garzillo and M. Innorta (2001). A simulation tool for short-term electricity markets. Proceedings of the IEEE Conference on Power Industry Computer Applications, Sydney, Australia, May 20-24, pp. 112-117. Motamedi, A., H. Zareipour and W.D. Rosehart (2012). Electricity price and demand forecasting in smart grids. IEEE Transactions on Smart Grid, 3 (2), pp. 664-674. 126

Mount, T. and H. Oh (2004). On the first price spike in summer. Proceedings of the 37th Annual Hawaii International Conference on System Sciences, Big Island, Hawaii, January 5-8, 10 pages. MSP (2014), Monitoring Reports on the IESO-administrated Electricity Markets. Market Surveillance Panel, Ontario, April 2015, available [online] at

www.oeb.ca/oeb/_Documents/MSP/MSP_Report_Nov2013-Apr2014_20150420.pdf (accessed on August 20, 2017) Natural Resources Canada (2006). Canada's Energy Outlook: The Reference Case. Analysis and Modeling Division, Natural Resources Canada, Ottawa, Ontario. available at: http://www.nrcan.gc.ca/node/788 (accessed on May 28, 2013). Ni, E. and P.B. Luh (2001). Forecasting power market clearing price and its discrete PDF using a Bayesian-based classification method. Proceedings of the IEEE Conference on Power Engineering Society Winter Meeting, Columbus, Ohio, January 28-February 1, pp. 15181523. Nielsen, A.A. (2002). Multiset canonical correlations analysis and multispectral, truly multitemporal remote sensing data. IEEE Transactions on Image Processing, 11 (3), pp. 293-305. Nogales, F.J., J. Contreras, A. Conejo and R. Espinola (2002). Forecasting next-day electricity prices by time series models. IEEE Transactions on Power Systems, 17 (2), pp. 342-348. Nogales, F.J. and A.J. Conejo (2006). Electricity price forecasting through transfer function models. Journal of the Operational Research Society, 57, pp. 350-357. Ontario Hydro (1989). Providing the Balance of Power: Ontario Hydro's Plan to Serve Customers' Electricity Needs, Vol. 4. Ontario Hydro, Toronto, Ontario. Ontario Hydro (1997). Ontario's Nuclear Generating Facilities: A History and Estimate of Unit Lifetimes and Refurbishment Costs. Nuclear Asset Optimization Plan, Appendix 2, Ontario Hydro, Toronto, Ontario. Ontario Royal Commission on Electric Power Planning (1980). Concepts, Conclusions and Recommendations, Vol. 1. Queen's Printer for Ontario, Toronto, Ontario.

127

OPHA (2002). Beyond Coal: Power, Public Health and the Environment. Ontario Public Health Association (OPHA), Ontario. Pai P.F. and W.C. Hong (2005). Forecasting regional electricity load based on recurrent support vector machines with genetic algorithms. Electric Power Systems Research, 74, pp. 417425. Panapakidis, I.P. and A.S. Dagonumas (2016). Day-ahead electricity price forecasting via the application of artificial neural network based models. Applied Energy, 172, pp. 132-151. Pollution Probe (2006). The Electricity Supply/demand Gap and the Role of Efficiency and Renewable in Ontario. ICF Consulting, Available at http://www.pollutionprobe.org/old_files/Reports/elec_supplydemandICF.pdf (accessed on April 25, 2013). Ramos, E.G. and F.V. Martinez (2013). A review of artificial neural networks: How well do they perform in forecasting time series. Journal of Statistical Analysis, 6 (2), pp. 7-15. Rodriguez, C.P. and G.J. Anders (2004). Energy price forecasting in the Ontario competitive power system market. IEEE Transactions on Power Systems, 19 (1), pp. 366-374. Sandhu, H.S., L. Fang and L. Guan (2014). Forecasting day-ahead electricity prices using data mining and neural network techniques. Proceedings of the 11th International Conference on Service Systems and Service Management, Beijing, China, pp. 1024­1029. Sandhu, H.S., L. Fang and L. Guan (2016a). Forecasting day-ahead price spikes for the Ontario electricity market. Electric Power Systems Research, 141, pp. 450-459. Sandhu, H.S., L. Fang and L. Guan (2016b). Day-ahead electricity spike price forecasting using a hybrid neural network-based model. In Smart City 360°, First EAI International Summit, Smart City 360°, Bratislava, Slovakia and Toronto, Canada, October 13-16, 2015. Lecture Notes of the Institute for Computer Sciences, Social Informatics and Telecommunications Engineering (LNICST), Volume 166, Springer, Heidelberg, Germany, pp. 431-442. Shahidehpour, M., H. Yamin and Z. Li (2002). Market Operations in Electric Power Systems: Forecasting, Scheduling, and Risk Management. New York, USA: Wiley.

128

Shrivastava, N.A., S. Ch and B.K. Panigrahi (2011). Price forecasting using computational intelligence techniques: A comparative analysis. Proceedings of the International Conference on Energy, Automation and Signals (ICEAS). Bhubaneswar, Odisha, December 28-30, 6 pages. Singhal, D. and K.S. Swarup (2011). Electricity price forecasting using artificial neural networks. Electrical Power and Energy Systems, 33, pp. 550-555. Swief, R.A., Y.G. Hegazy, T.S. Abdel Salam and M.A. Bader (2009). Support vector machines (SVM) based short term electricity load-price forecasting. Proceedings of the IEEE Power Tech Conference, Bucharest, Romania, June 28-July 2, 5 pages. US Department of Energy (2006). Benefits of Demand Response in Electricity Markets and Recommendations for Achieving Them. Report to the United States Congress, available at: http://eetd.lbl.gov/sites/all/files/publications/report-lbnl-1252d.pdf (accessed on

November 20, 2012). Vahidinasab, V., S. Jadid and A. Kazemi (2008). Day-ahead price forecasting in restructured power systems using artificial neural networks. Electric Power Systems Research, 78 (8), pp. 1332-1342. Veit, D.J., A. Weidlich, J. Yao and S.S. Oren (2006). Simulating the dynamics in two-settlement electricity markets via an agent-based approach. International Journal of Management Science and Engineering Management, 1 (2), pp. 83-97. Wang, A. and B. Ramsay (1997). Prediction of system marginal price in the UK power pool using neural networks. Proceedings of the International Conference on Neural Networks. Houston, Texas, June 12, pp. 2116-2120. Wang, J., L. Li, D. Niu and Z. Tan (2012). An annual load forecasting model based on support vector regression with differential evolution algorithm. Applied Energy, 94, pp. 65-70. Wang, J., L. Xiao and J. Shi (2014). The combination forecasting of electricity price based on price spikes processing: a case study in south Australia. Abstract and Applied Analysis, 12 pages. Weng, Y., L. Shi and J.H. Zhao (2009). Price spike forecasting using concept-tree approach based on cloud model. Proceedings of the IEEE Conference on Computer, 129

Communication, Control and Management, Sanya, China, vol. 2. August 8-9, 2009, pp. 352-355. Weron, R. (2014). Electricity price forecasting: A review of the state-of-the-art with a look into the future. International Journal of Forecasting, 30, pp. 1030-1081. Winfield, M.S., M. Horne, T. McClenaghan and R. Peters (2004). Power for the Future: Towards a Sustainable Electricity System for Ontario. Canadian Environmental Law Association: Pembina Institute. Available: http://cela.ca/pdf/energyreport-fullreport.pdf (accessed on January 22, 2013). Winfield, M.S., R. Peters and M. Horne (2006). The Ontario Power Authority Supply Mix Report: A review and Response, Vol. 3. Available at http://www.pembina.org/pub/210 (accessed on January 22, 2013). Witten, I.H., E. Frank and M.A. Hall (2011). Data Mining: Practical Machine Learning Tools and Techniques, Third Edition. Burlington, USA: Morgan Kaufmann. Wu, W., J. Zhou, L. Mo and C. Zhu (2006). Forecasting electricity market price spikes based on Bayesian expert with support vector machines. In X. Li, O.R. Zaiane and Z. Li (Eds.), Advanced Data Mining and Applications, Berlin: Springer, 4093, pp. 205­212. Yuan, Y.H., Q.S. Sun, Q. Zhou and D.S. Xia (2011). A novel multiset integrated canonical correlation analysis framework and its application in feature fusion. Pattern Recognition, 44, pp. 1030-1040. Zareipour, H., C.A. Cañizares, K. Bhattacharya and J. Thoson (2006). Applicatin of publicdomain market information to forecast Ontario's wholesale electricity prices. IEEE Transaction on Power Systems, 21 (4), pp. 1707-1717. Zareipour, H., C. Canizares and K. Bhattacharya (2007a). The operation of Ontario's competitive electricity market: Overview, experience and lessons. IEEE Transactions on Power Systems, 22 (4), pp. 1782-1793. Zareipour, H., K. Bhattacharya and C. Canizares (2007b). Electricity price volatility: The case of Ontario. Energy Policy, 35 (9), pp. 4739-4748.

130

Zareipour, H., A. Janjani, H. Leung, A. Motamedi and A. Schellenberg (2011). Classification of future electricity market prices. IEEE Transactions on Power Systems, 26 (1), pp. 165173. Zhang, L., P.B. Luh and K. Kasiviswavathan (2003). Energy clearing price prediction and confidence interval estimation with cascaded neural networks. IEEE Transactions on Power Systems, 18 (1), pp. 99­105. Zhang, G.P. and M. Qi (2005). Neural network forecasting for seasonal and trend time series. European Journal of Operation Research, 160 (2), pp. 501-514. Zhang, L. and P.B Luh (2005). Neural network-based market clearing price prediction and confidence interval estimation with an improved extended Kalman filter method. IEEE Transactions on Power Systems, 20 (1), pp. 59­66. Zhang, J., Z. Tan and S. Yang (2012). Day-ahead electricity price forecasting by a new hybrid method. Computers and Industrial Engineering, 63, pp. 695­701. Zhao, J.H., Z.Y. Dong and Z. Xu (2006). Effective feature preprocessing for time series forecasting. In X. Li, O.R. Zaiane and Z. Li (Eds.), Advanced Data Mining and Applications, vol. 4093, pp. 769-781. Berlin, Germany: Springer. Zhao, J.H., Z.Y. Dong, X. Li and K.P. Wong (2007a). A framework for electricity price spike analysis with advanced data mining methods. IEEE Transactions on Power Systems, 22 (1), pp. 376­385. Zhao, J.H., Z.Y. Dong and X. Li (2007b). Electricity market price spike forecasting and decision making. IET Generation Transmission and Distribution, 1 (4), pp. 647­654. Zhao, C., F. Gao, D. Niu and F. Wang (2011). A two-step basis vector extraction strategy for multiset variables correlation analysis. Chemo Metrics and Intelligent Laboratory Systems, 107, pp. 147-154.

131

