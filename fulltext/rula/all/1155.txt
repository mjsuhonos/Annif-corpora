Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2010

Detection and monitoring for cancer and abnormal vasculature by photoacoustic signal characterization of structural morphology
Jason Zalev
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Physics Commons Recommended Citation
Zalev, Jason, "Detection and monitoring for cancer and abnormal vasculature by photoacoustic signal characterization of structural morphology" (2010). Theses and dissertations. Paper 560.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

DETECTION AND MONITORING FOR CANCER AND ABNORMAL VASCULATURE BY PHOTOACOUSTIC SIGNAL CHARACTERIZATION OF STRUCTURAL MORPHOLOGY

by Jason Zalev Bachelor of Electrical Engineering

A thesis presented to Ryerson University in partial fulfillment of the requirements for the degree of Master of Science in the Program of Biomedical Physics

Toronto, Ontario, Canada, 2010
© Jason Zalev 2010

Author Declaration

I hereby declare that I am the sole author of this thesis. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

Jason Zalev

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

Jason Zalev

ii

Abstract

Detection and Monitoring for Cancer and Abnormal Vasculature by Photoacoustic Signal Characterization of Structural Morphology
Jason Zalev Master of Science, Biomedical Physics Ryerson University, 2010

Photoacoustic systems can produce high-resolution, high-contrast images of vascular structures. To reconstruct images at very high-resolution, signals must be collected from many transducer locations, which can be time consuming due to limitations in transducer array technology. In this thesis, a method is presented to discriminate between normal and abnormal tissue based on the structural morphology of vasculature and permits data to be acquired quickly. To demonstrate that the approach may be useful for cancer detection, a special simulator that produces photoacoustic signals from 3D models of vascular tissue is developed. Validation of the simulator is performed against a derived exact equation for finite-length cylindrical photoacoustic sources and through FEM models. Results show that it is possible to differentiate tissue classes even when it is not possible to resolve individual blood vessels. Performance of the algorithm remains strong as the number of transducer locations decreases and in the presence of noise.

iii

Acknowledgements

I would like to thank my supervisor Dr. Michael C. Kolios for all of his help and support over the past two years. His guidance has always served to steer my research in the right direction. I would also like to thank Dr. Yuan Xu and Dr. J. Carl Kumaradas for their support and guidance and as members of my thesis committee. Special thanks go to Arthur Worthington for assisting with experimental setup; Dr. Raffi Karshafian for his input and knowledge in modeling vasculature; Adrian Mariampillai for sharing his 3D datasets of micro-vasculature; Dr. Min Rui for providing photoacoustic microscopy images; Eric Strohm for providing several parameter values of the photoacoustic microscope; Dr. Omar Falou for his assistance with FEM modeling; Leo Zambito and Matt Forrest for their computer and IT support; Tess Sy for her administrative assistance; and to the Ryerson Opto-acoustics Group for all of their help and support. Funding for this research has been provided by The National Sciences and Engineering Research Council of Canada (NSERC); The Canadian Institutes of Health Research (CIHR); The Canada Research Chairs Program (CRCP); and Ryerson University.

iv

To my wife Shawna

v

vi

Table of Contents
Introduction About this work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Problem Statement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Objective . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Significance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Outline . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Related Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 Background and Theory 1.1 Photoacoustic Imaging . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1.1.1 1.1.2 Optical Absorption and Thermoelastic Stress Confinement 1.1.2.1 1.1.2.2 1.1.2.3 1.1.3 1.1.3.1 1.1.3.2 1.1.4 1.1.4.1 1.1.4.2 1.2 1.2.1 1.2.2 1.2.3 1.3 1 1 2 3 3 3 4 5 5 . . . . 11

Photoacoustic Wave Propagation . . . . . . . . . . . . . . . . . . . 11 Homogeneous Media . . . . . . . . . . . . . . . . . . . . . 11 Heterogeneous Media . . . . . . . . . . . . . . . . . . . . 13 Dispersive Media . . . . . . . . . . . . . . . . . . . . . . . 13 Frequency Response . . . . . . . . . . . . . . . . . . . . . 14 Transducer Models . . . . . . . . . . . . . . . . . . . . . . 14 Universal Backprojection . . . . . . . . . . . . . . . . . . 16 Resolution and Bandwidth . . . . . . . . . . . . . . . . . 17

Ultrasonic Transducers . . . . . . . . . . . . . . . . . . . . . . . . . 14

Image Reconstruction . . . . . . . . . . . . . . . . . . . . . . . . . 16

The Morphology of Vascular Tissue . . . . . . . . . . . . . . . . . . . . . . 19 Angiography and Vascular Imaging . . . . . . . . . . . . . . . . . . 19 Characteristics of Normal and Abnormal Vasculature 1.2.3.1 . . . . . . . 20 Vascular Modeling . . . . . . . . . . . . . . . . . . . . . . . . . . . 21 Fractal Trees . . . . . . . . . . . . . . . . . . . . . . . . . 22

Automated Tissue Segmentation and Classification . . . . . . . . . . . . . 27 vii

1.3.1

Feature Extraction Methods . . . . . . . . . . . . . . . . . . . . . . 27 1.3.1.1 1.3.1.2 1.3.1.3 1.3.1.4 Frequency Domain Classification . . . . . . . . . . . . . . 27 Fractal and Statistical Methods . . . . . . . . . . . . . . 28 Vessel Tortuosity Metrics . . . . . . . . . . . . . . . . . . 29 Wavelet Based Classification Methods . . . . . . . . . . . 30 . . . . . . . . . . . . . . . . . . . . . 33

1.3.2 1.3.3

Feature Vector Construction 1.3.3.1

Training of the Classifier . . . . . . . . . . . . . . . . . . . . . . . . 34 The Support Vector Machine . . . . . . . . . . . . . . . . 34 37 Fractal Tree Model . . . . . . . . . . . . . . . . . . . . . . . . . . . 37 Acquired 3D Data Tissue Model . . . . . . . . . . . . . . . . . . . 43 Simulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44 2.2.1.1 2.2.1.2 Point Detector . . . . . . . . . . . . . . . . . . . . . . . . 44 Area Detector . . . . . . . . . . . . . . . . . . . . . . . . 47 Finite Element Simulations . . . . . . . . . . . . . . . . . 50 Exact Solution for Finite-Length Cylindrical Source . . . 54

2 Methods 2.1 2.1.1 2.1.2 2.2 2.2.1

Model of Vascular Tissue . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

Photoacoustic Wave Simulation . . . . . . . . . . . . . . . . . . . . . . . . 44

2.2.2

Validation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50 2.2.2.1 2.2.2.2

2.3

Classification and Reconstruction . . . . . . . . . . . . . . . . . . . . . . . 55 2.3.1 2.3.2 Image Reconstruction . . . . . . . . . . . . . . . . . . . . . . . . . 55 The Classification Algorithm . . . . . . . . . . . . . . . . . . . . . 56 2.3.2.1 2.3.2.2 2.3.2.3 Feature Vector Creation . . . . . . . . . . . . . . . . . . . 56 Training of the Classifier . . . . . . . . . . . . . . . . . . 57 Testing of the Classifier . . . . . . . . . . . . . . . . . . . 57 61 Finite Element Simulations . . . . . . . . . . . . . . . . . . . . . . 61 3.1.1.1 3.1.1.2 3.1.2 3.1.3 3.1.2.1 3.1.3.1 3.1.3.2 Spherical Geometry . . . . . . . . . . . . . . . . . . . . . 61 Cylindrical Geometry . . . . . . . . . . . . . . . . . . . . 64 Exact Finite-Length Cylinder Equation . . . . . . . . . . 64 Tree Mode . . . . . . . . . . . . . . . . . . . . . . . . . . 64 Matrix Mode . . . . . . . . . . . . . . . . . . . . . . . . . 67 viii

3 Results 3.1 3.1.1

Validation of Photoacoustic Simulator . . . . . . . . . . . . . . . . . . . . 61

Exact Solution Validation . . . . . . . . . . . . . . . . . . . . . . . 64 Point Detector Simulator Validation . . . . . . . . . . . . . . . . . 64

3.2

Reconstruction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67 3.2.1 3.2.2 Resolution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67 B-mode reconstruction . . . . . . . . . . . . . . . . . . . . . . . . . 67 Frequency Domain Methods . . . . . . . . . . . . . . . . . . . . . . 74 3.3.1.1 3.3.2 3.3.2.1 3.3.2.2 3.3.2.3 3.3.2.4 Simulated Data . . . . . . . . . . . . . . . . . . . . . . . 74 Performance of the Classification Algoirthm Classification of Acquired 3D Datasets . . . . . . . 74 WPD Feature Vector . . . . . . . . . . . . . . . . . . . . . . . . . . 74 Performance in the Presence of Noise . . . . . . . . . . . 75 . . . . . . . . . . 75 Area Detector . . . . . . . . . . . . . . . . . . . . . . . . 80 81

3.3

Classification . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74 3.3.1

4 Discussion and Analysis 4.1 4.2 4.3 4.4 4.5 4.6 4.7

Classification . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81 Vascular Tissue Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83 Wave Propagation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84 Validation of Photoacoustic Simulations . . . . . . . . . . . . . . . . . . . 86 Reconstruction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89 Fractal Considerations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91 Wavelets in Photoacoustic Imaging . . . . . . . . . . . . . . . . . . . . . . 92 93

5 Conclusion 5.1 5.2 5.3

Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93 Summary of Contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . 94 Future Research . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94 94

References

A Spatial Weighting Functions For Universal Back Projection Algorithm105 B Derivation for the Exact Solution of a Finite-Length Cylindrical Photoacoustic Source 107

ix

x

List of Tables
1.1 1.2 1.3 1.4 1.5 2.1 2.2 2.3 2.4 2.5 3.1 3.2 Typical depth penetration and resolution of imaging modalities Typical vessel sizes . . . . . . . . . . . . . . . . . . . . . . . . . Parameters of a fractal tree pattern . . . . . . . . . . . . . . . . Fractal parameters for structural morphology . . . . . . . . . . Information cost functions . . . . . . . . . . . . . . . . . . . . . List of datasets used for classification . . . . . . . . Simulators developed for photoacoustic simulations Test configurations used in simulation . . . . . . . Reconstruction test configurations . . . . . . . . . List of classification tests . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6 19 24 25 33 38 44 50 55 60

Performance of FEM simulations . . . . . . . . . . . . . . . . . . . . . . . 64 Sensitivity and selectivity of the classifier . . . . . . . . . . . . . . . . . . 74

xi

xii

List of Figures
1.1 1.2 1.3 1.4 1.5 1.6 1.7 2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8 2.9 3.1 3.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9 3.10 3.11 3.12 3.13 3.14 3.15 3.16 Photoacoustic microscopy image of a single cell . . . . . . . Functional photoacoustic imaging for clinical use with linear Normal and abnormal micro-vessels . . . . . . . . . . . . . . Geometry of fractal tree branching pattern . . . . . . . . . Two-dimensional fractal trees and diameter asymmetry . . Discrete wavelet transform (DWT) decomposition . . . . . Wavelet packet transform (WPT) decomposition . . . . . . . . . . array . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8 10 21 23 26 31 31 39 41 48 49 52 53 53 56 59 62 63 65 66 68 69 70 71 72 73 75 76 76 77 77 77

Simulated vascular tissue . . . . . . . . . . . . . . . . . . . . . . . . . Simulated vascular tissue varying branching angle range . . . . . . . . Configuration used in the point detector simulation. . . . . . . . . . . Large area integrating planar detector . . . . . . . . . . . . . . . . . . FEM simulation of spherical optical absorber . . . . . . . . . . . . . . FEM simulation of spherical optical absorber with axial symmetry . . FEM simulation of cylindrical optical absorber under axial symmetry . Phases of classification algorithm . . . . . . . . . . . . . . . . . . . . . Noise added to a transducer signal . . . . . . . . . . . . . . . . . . . . Pressure waveforms from spherical source . . . . . Wave propagation from spherical optical source . . Wave propagation from cylindrical optical source . Pressure waveforms from cylindrical source . . . . Simulation of single cylinder . . . . . . . . . . . . . Simulation of small tree . . . . . . . . . . . . . . . Backprojection quality and number of transducers Reconstructed tissue from linear phased array . . . Reconstructed tissue from sparse array . . . . . . . Spectrogram of simulated tissue . . . . . . . . . . . Classification of simulated tissue . . . . . . . . . . Classification of simulated tissue with 30dB SNR . Classification of simulated tissue with 10dB SNR . Classification of simulated tissue with 3dB SNR . . Classification of simulated tissue with -3dB SNR . Classification of acquired 3D data . . . . . . . . . . xiii . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3.17 Reconstruction and configuration for acquired data classification . . . . . 78 3.18 Classification of Acquired 3D data . . . . . . . . . . . . . . . . . . . . . . 79 3.19 Classification with area detector . . . . . . . . . . . . . . . . . . . . . . . 80 A.1 Normalized spatial weighting of various transducers . . . . . . . . . . . . . 106 B.1 B.2 B.3 B.4 Intersection of a spherical wavefront (left) and a cylinder (right) Intersections of sphere and cylinder . . . . . . . . . . . . . . . . . Surface area of sphere-cylinder intersection . . . . . . . . . . . . Extra surface area due to finite ends . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108 110 111 112

xiv

Nomenclature
 2 |·|
· · ·

temporal convolution or 3D spatial convolution factor of two down-sampling absolute value Euclidean norm ceiling function floor function gradient operator SVM weight vector constant of attenuation [Np] isobaric thermal expansion coefficient [1/ C] speed of sound [m/s] specific heat capacity [J/K] Dirac impulse function transducer electromechanical impulse response Fourier transform operator inverse Fourier transform operator laser energy fluence profile [J/cm2 ] SVM decision function xv

  0  c Cp  (t) em (t) F F -1 (x) f (z)

fs (t) (x) g (x, t) H H (x) j k KGRBF Klinear µa (x) P p(x, t) p 0 ( x)  (z) Sg FSTFTg t vout (t) Vtest Vtraining (x, t)  x z

force acting on transducer surface [N/m2 ] Gr¨ uneisen parameter Green's function solution to photoacoustic wave equation Hilbert transform optical energy density [J/cm3 ]  imaginary unit ( -1) spatial frequency Gaussian radial basis function SVM kernel linear SVM kernel optical absorption profile [cm-1 ] power spectrum pressure [Pa] initial pressure distribution [Pa] SVM classification strength spectrogram short-time Fourier transform time [s] transducer voltage output [V] classification test set classification training set velocity potential [m/s] temporal frequency spatial position SVM feature vector

xvi

Introduction
About this work
This work investigates using a functional classifier for detecting cancer and vascular disease through photoacoustic methods. The primary focus is on examining the effect of changes in vascular morphology on photoacoustic signals. In this work, theoretical models are used to test if changing specific morphological parameters in vasculature will lead to detectable changes in photoacoustic signals and to devise a method for discriminating between different tissues. It is known that normal vascular tissue has a highly organized branching structure whereas abnormal tissue, as in cancer, usually has an erratic branching pattern [1­3]. It has been predicted that photoacoustic methods will soon enter mainstream use for clinical cancer detection because of a strong affinity for imaging vascular structures [4]. The underlying physics of photoacoustic imagery allows very high resolution images of these structures to be produced, and for multi-wavelength systems, the ability to measure the concentration of oxygen in blood. Although images of micro-vasculature can be produced in-vivo, the formation of such images is currently quite time consuming which is a major limitation of photoacoustic microscopy [5]. As an alternative to resolving vascular structures, current quantitative functional photoacoustic methods can detect regions of tissue with high blood concentration and high blood oxygenation that may indicate the presence of cancer [4, 6, 7]. However, in quantitative approaches, the underlying vascular structure is not necessarily resolvable. In other work, photoacoustic methods are being used to detect metastasized melanoma in blood [8]; however, it is only the presence or absence of an indicative optical absorber in circulating blood cells and not reconstructive imaging that is used for this type of test. To the author's best knowledge, the mechanism of using detectable changes in photoacoustic signals related to explicit structural changes in vascular morphology has never 1

INTRODUCTION been exploited as a quantitative method for subresolution photoacoustic tissue classification with application toward the detection of cancer or other vascular abnormality. In addition, the author is unaware of any published work involving large scale photoacoustic simulation of vascular networks or the reconstruction of images from such simulations.

Problem Statement
There are several difficulties to overcome with current high-resolution photoacoustic imaging systems. Adequate data acquisition is one of the current bottlenecks in the process. Fully reconstructing 3D micro-vascular images may require measurements from a large number of transducer locations. However, when the number of transducer locations is reduced, the system resolution is also reduced. High resolution images require high-frequency transducers. Limitations in highfrequency transducer array technology require that mechanical scanning is performed across the tissue sample, which can be a time-consuming process. Also, limitations in laser pulse-repitition rate can impose an excessive delay between subsequent measurements. When quantitative functional measurements are used to measure blood oxygenation and concentration of a region, the actual structural morphology of the tissue is not explicitly evaluated.

Motivation for Hypothesis
It is known that the information content of a transducer signal is related to the frequency response and field profile of the transducer (see Section 1.1.4.2). However, as the number of transducer sampling locations becomes sparse, thereby reducing the system resolution, the information content from each individual signal remains the same. Methods from compressive sensing have shown that there is a great deal of information regarding high resolution detail contained in just a few transducer samples [9, 10]. However, in reconstructed images, most of the sub-resolution information is lost after image reconstruction [11]. It is also known that self similar fractal structures have unique spatial frequency characteristics [12] that would lend themselves to multi-scale wavelet analysis. Since fractal geometry can be used to model normal and abnormal vascular tissue [2, 13, 14], an approach using wavelet packet classification may be able detect sub-resolution vascular features from raw data prior to reconstruction. 2

INTRODUCTION

Hypothesis
Based on structural morphology, it is possible to distinguish between normal and abnormal vascular tissue using photoacoustic methods without reconstructing all of the vessel structures that contribute to the photoacoustic signal.

Objective
The objective of this work is
 to determine if cancer can be detected photoacoustically based on its vascular

structural morphology, and
 to develop a method suitable for classification of such tissue.

Significance
This work provides analysis regarding the effect that structural morphology has on photoacoustic signals. A method for simulating large scale photoacoustic models of vascular tissue is developed, which may find application in further related research. This work suggests that tissue classification with sparse transducer arrangement is possible even when images cannot be reconstructed.

Outline
In Chapter 1, the background and theory related to the methods used in this thesis are provided. Section 1.1 discusses photoacoustic imaging. Section 1.2 discusses the vasculature in normal and abnormal tissue. Section 1.3 discusses current methods for tissue classification. In Chapter 2, the methods used in this thesis are described. Section 2.1 describes the models used for vascular tissue and how they were generated or obtained. Section 2.2 discusses the photoacoustic wave simulations that are implemented in this thesis and how they are validated. Section 2.3 describes the classification algorithm that is developed to classifiy tissue. Chapter 3 provides results and analysis. Chapter 4 contains relevant discussion. Chapter 5 is the conclusion. 3

INTRODUCTION

Related Work
There are thousands of published works involving biomedical tissue classification and similar problems in engineering and geophysics. Frequency domain tissue classification is the most common approach used in ultrasound [11, 15]. In this work, simple wave propagation methods are used to simulated large vascular networks modeled by fractal tree shapes. Another study [16] used fractal trees to model radar backscatter from forest canopies to determine species of plant life. In the work of Karshafian [2], fractal trees are used to model the flow and ultrasound backscatter of ultrasound contrast agents through vascular networks. This approach uses feature vectors extracted from dual-tree wavelet packet decomposition [17]. Wavelet packets are a common method for producing feature vectors for classification [18]. The support vector machine approach, which is used in this thesis, is a common method used to produce a classifier from a set of example features [19].

4

Chapter 1

Background and Theory
1.1 Photoacoustic Imaging

Photoacoustic imaging (a.k.a optoacoustic imaging) involves the generation of ultrasound waves from a short laser pulse. In layperson's terms the process is analogous with using the noise of thunder that is heard following a bolt of lightening to determine its distance. In photoacoustic imaging distances are also calculated by measuring the time delay between an optical stimulus and an acoustic response. In photoacoustic imaging, a laser pulse heats an optically absorbing medium causing a rapid thermal expansion. This creates a source of pressure that propagates through the medium as an acoustic wave. Ultrasonic transducers that are positioned at several locations on the boundary of the medium are able to detect the acoustic wave as a time-domain photoacoustic signal, known as a radio-frequency line or an RF-line. Since the acoustic wave travels at the  1500m/s) through the medium, the RF-lines can be used to create a speed of sound (= 3D spatial map proportional to the optical absorption strength of the medium.

Comparison of Imaging Modalities The laser pulses used in photoacoustic imaging are not a form ionizing radiation, making it a safe imaging technology. In X-ray, CT, and PET, the patient is exposed to ionizing radiation that can damage DNA or cause cancer. The resolution and depth penetration of the common imaging modalities are summarized in Table 1.1. These properties make each imaging modality suitable for a specific set of tasks. In terms of cost, photoacoustic imaging would be in line with the cost of ultrasound imaging, which is considered relatively inexpensive. MRI imaging machines can cost in 5

CHAPTER 1. BACKGROUND AND THEORY excess of 1 million US dollars. MRI also does not use ionizing radiation so it is very safe. Imaging Method Computed Tomography (CT) Magnetic Resonance Imaging (MRI) Ultrasound (@ 5 MHz) Optical Coherence Tomography (OCT) Confocal Microscopy Photoacoustic Tomography (PAT) (@ 5 MHz) Photoacoustic Microscopy (PAM) (@ 50 MHz) Photoacoustic Microscopy (PAM) (@ 200 MHz) Photoacoustic Microscopy (PAM) (@ 1000 MHz) Typical Resolution 0.5 mm 0.2 mm 1 mm 0.01 mm 0.001 mm 1 mm 0.01 mm 0.005 mm 0.0005 mm Typical Depth > 300 mm > 300 mm 100 mm 1.5 mm 0.2 mm 50 mm 3 mm 0.2 mm 0.02 mm

Table 1.1: depth penetration and resolution of imaging modalities. Sources: [4, 20­24].

Photoacoustic Imaging of Vascular Structures

Photoacoustic imaging has three

main physical characteristics that give it a unique advantage for imaging vascular structures in tissue. First, the vascular images that are produced will endogenously have a natural high-contrast. This is because the light-absorption (and hence the photoacoustic signal strength) from blood is much greater than in the surrounding tissue. This causes the detected pressure wave from the blood vessels to be much stronger than from the other structures. This is contrary to standard pulse-echo ultrasound imaging, where blood vessels will usually have a low image contrast. Second, with photoacoustics, high-resolution is possible at greater depths than what is attainable using optical imaging methods. This is because the acoustic scattering in tissue is much less than the optical scattering. In tissue, photons cannot penetrate deeply without scattering, which has a blurring effect in other optical methods. However, in photoacoustic imaging, optical scattering can actually help in forming the image because it leads to a more uniform illumination of the tissue. Photoacoustic microscopes have been used to image micro-vascular structures on the order of 10µm and are capable of resolving sub-cellular structures smaller than 0.5µm. Rui et al. [24] have been able to photoacoustically image a single biological cell (see Figure 1.1). Third, since optical absorption is dependent on the wavelength of light (see Figure 1.2b), multi-wavelength photoacoustic systems can be used in functional imaging to measure molecular concentrations including blood oxygen saturation levels [7]. 6

1.1. PHOTOACOUSTIC IMAGING For these reasons, it has been predicted that photoacoustic imaging will emerge as a mainstream method for detecting certain forms of cancer [4]. Limitations of Photoacoustic Imaging Laser light has limited depth penetration in

tissue. This introduces a limit on how deep photoacoustics can penetrate into tissue (see Table 1.1). Furthermore, attenuation of an acoustic wave increases at high frequencies so this places a further limit on the depth penetration, with high-resolution systems being able to penetrate less deeply. Another current major limitation is that data acquisition in is time consuming due to limitations in laser pulse repetition rates and transducer array technology. A single transducer element usually must be mechanically scanned across a sample which is a slow process [25]. It is difficult to fabricate high frequency transducer arrays that have the performance needed to image micro-vascular structures. CMUT technology [26, 27] and Fabry-Perot transducers [5] may offer significant advantages to piezo-electric transducers, however there are still technological limitations so data acquisition remains time consuming. Furthermore, pulse repetition rates of lasers suitable for photoacoustic imaging are relatively slow [5]. Although the technology is developing rapidly, it is still a limiting factor. Before photoacoustic microscopy can be applied to clinical examinations of microvasculature, technologies for quickly processing data acquired from photoacoustic microscopes must be developed. Current Clinical Applications of Photoacoustics Photoacoustic methods can be

used to detect metastasized melanoma cells circulating in the blood [8]. These cells, which would not otherwise be circulating in the blood stream, contain high amounts of melanin that causes them to absorb light strongly at specific wavelengths. The photoacoustic contrast from melanin is apparent in Figure 1.1. When blood is circulated through a controlled fluidic system one cell at a time, the laser illumination of a melanoma cell produces a detectable spike in the time-domain photoacousitc signal indicating its presence [8]. In several systems undergoing clinical trials, transducer arrays have been successfully applied to photoacoustic imaging. Seno Medical Instruments (San Antonio, TX) has developed a photoacoustic imaging system that uses a dual-wavelength laser in conjunction with a linear transducer array to detect regions of increased blood oxygenation in breast tissue [6, 28] (see Figure 1.2). Benign growths and malignant tumours have different blood volumes and oxygen concentrations as shown in Figure 1.2c. The approach is able 7

CHAPTER 1. BACKGROUND AND THEORY

(a) Optical Image of Cell

(b) Photoacoustic Microscope @1 GHz

(c) Photoacoustic Microscope @400 MHz

(d) Photoacoustic Microscope @200 MHz

Figure 1.1: Photoacoustic images of a melanoma cell using a photoacoustic microscope. The melanin pigmentation in the cell produces a strong photoacoustic signal due to its optical absorption properties. As the acoustic transducer frequency increases, the image resolution improves but the penetration depth is reduced. Images courtesy of M. Rui, Ryerson University, Toronto, ON

8

1.1. PHOTOACOUSTIC IMAGING to locate regions of suspicious tissue that cannot be detected from standard ultrasound. It uses a functional quantitative imaging approach and does not reconstruct the finest details of the vascular structure. The system of Ephrat et al. [29] uses a sparse 3D transducer array is for breast tissue imaging. The system can achieve resolutions of up to 1mm. Algorithms based on compressive sensing, iterative reconstruction, and matrix optimization allow images to be produced using few transducers. Similar quality reconstruction would not be possible with backprojection algorithms. The work of Zhang et al. [20] uses photoacoustic microscopy with a Fabry-Perot transducer and multi-wavelength laser for in-vivo functional imaging. Blood oxygenation of 10µm capillary structures are detectable.

9

(a) a multi-wavelength laser is used to measure blood volume and oxygenation

(b) Absorption spectra in tissue

(c) Typical absorption for tumors

(d) Breast tumor reconstruction.  = 757nm

(e) Breast tumor reconstruction.  = 1064nm

Figure 1.2: Functional imaging method of Seno Medical Instruments. Images courtesy of Seno Medical Instruments, San Antonio, TX

1.1. PHOTOACOUSTIC IMAGING

1.1.1

Optical Absorption and Thermoelastic Stress Confinement

When a brief laser pulse illuminates a medium with an energy fluence (x), the optical energy absorbed by the medium is H (x) = µa (x)(x), (1.1)

where µa (x) is the optical absorption profile. µa (x) may depend on the wavelength of the laser as shown in Figure 1.2b. It is assumed that the laser pulse duration is short enough that there will be thermoelastic stress confinement, where thermal conduction and stress propagation are negligible during the laser firing. Under this condition, an initial excess pressure will be created in the medium according to p0 (x) = (x)H (x). The parameter (x) = capacity. If the tissue is illuminated equally everywhere, such that (x) is constant, this is called the wide-field photoacoustic assumption.
 (x)c2 (x) Cp (x)

(1.2)

is known as the Gr¨ uneisen parameter, where  (x) is

the thermal expansion coefficient, c is the speed of sound and Cp (x) is the specific heat

1.1.2
1.1.2.1

Photoacoustic Wave Propagation
Homogeneous Media Photoacoustic wave propagation in homogeneous media

Simiplfied wave equation

is governed by the differential equation  2 - c2 2 p(x, t) = p0 (x)  (t), t2 t (1.3)

where p(x, t) is pressure, c is the speed of sound,  (t) is the Dirac impulse function, and p0 (x) is the initial pressure when the laser is fired at time t0 = 0. This model assumes that the laser pulse is instantaneous, so that there will be thermoelastic stress confinement and that there is no motion within the system. 11

CHAPTER 1. BACKGROUND AND THEORY Forward solution Solving (1.3) under basic assumptions yields the forward solution for p(x, t). If the laser is fired at t0 , the pressure at any time and position is p(x, t) =  g (x - x , t)p0 (x ) dx t  = g (x, t)  p0 (x) , t

(1.4a)

where the Green's function solution g (x, t) is g (x, t) = 1  ( x - ct) . c2 4 x (1.4b)

Laser pulse profile If the laser pulse profile hpulse (t) is not an instantaneous Dirac impulse then the pressure is given by


ppulse (x, t) =
-

p(x, t - t)hpulse (t ) dt

(1.5)

= p(x, t)  hpulse (t).

Velocity potential The quantity (x, t) is known as the velocity potential. It is related to the pressure by 1  (x, t) = p(x, t). t (x) The longitudinal velocity of a particle in the medium is given by v(x) = -(x). (1.6)

Spatial Frequency Domain (k-space)

It is also relevant to discuss photoacoustic

wave propagation in the spatial-frequency domain which is known as k-space [30­32]. By taking the 3D spatial Fourier transform of (1.3) it becomes 2 + c2 k t2
2

p ^(k, t) = p ^0 (k)

  (t). t

(1.7)

Solving (1.7) the k-space formulation of (1.4) is [31]
-1 p(x, t) = kF {p ^0 (k) cos(ct k )} , x

(1.8)

where p ^ {p0 (x)}. 0 (k) = xF k 12

1.1. PHOTOACOUSTIC IMAGING 1.1.2.2 Heterogeneous Media

The photoacoustic wave equation for heterogenous media is given by 2 1 p(x, t) - (x) c2 (x) · p(x, t) t2 (x) = (x)  H (x, t), t (1.9)

where H (x, t) is the time varying absorbed energy density and (x) is the density of the medium. Bojarski [30] and Cox et al. [32] use a discretized pseudospectral model for simulating wave propagation in heterogeneous media is developed where at each time step the solution is obtained by switching between spatial and k-space domain solutions. The method has advantages over other finite difference based approaches, in terms of computation requirements.

1.1.2.3

Dispersive Media

In tissue, the speed of sound and the attenuation are dependent on the frequency of the propagating wave. It is common for tissue to be modeled as power law media where the frequency dependent acoustic attenuation is given by ( ) = 0 | |y , where y is the power-law exponent and 0 is a constant of attenuation [33­35].

Exact power-law media photoacoustic wave equation The wave equation for exact power-law dispersive media has recently been solved with Green's function solutions by Kelly et al. [35]. It will reduce to the Szabo wave equation [36] under appropriate assumptions. The exact power-law wave equation of Kelly et al. [35] with an added photoacoustic source term on the right hand side is 2 -
2  y+1  2y 1 2 20 0 - - c2 t2 c cos(y/2) ty+1 c cos2 (y/2) t2y

p(x, t) = (x)

 H (x, t). t (1.10)

Dispersive k-space propagator Treeby et al. [34] uses a wave equation much simpler than (1.10) suitable for modeling acoustic wave propagation in tissue. A relatively simple k-space propagator similar to (1.8) is developed as   -jct k  -jct k    1+2j0 c 1-2j0 c 1 -1  e e   p(x, t) = kF p ( k ) + . 0 2 x  1 + 2j0 c 1 - 2j0 c  13

(1.11)

CHAPTER 1. BACKGROUND AND THEORY

1.1.3

Ultrasonic Transducers

Ultrasonic transducers produce electrical signals from detected acoustic waves. The electrical signal from a single transducer is known as a radio-frequency line or RFline. Ultrasound transducer arrays are available in many configurations. A linear array consists of many directional transducers arranged in a line so that scanning can be done electronically rather than mechanically. A phased array is an array of omni-directional transducers that are capable of electronically steering, focusing and beamforming. An image produced by the (log-compressed) brightness of beamformed RF lines is called a B-mode image. When a single transducer is mechanically scanned in the xy plane, it is called a cross-sectional scan or C-scan. Transducers have been traditionally piezoelectric. Fabry-Perot transducers, are now being used for photoacoustic microscopy [5]. CMUT transducers are micro-machined and can be fabricated with many closely spaced elements [26]. High frequency transducers are arrays for micro-ultrasound imaging have also been recently developed [37]. Another type of transducer is the Fabry-Perot interferometer, which consists of a thin polymer film that can be optically scanned to measure pressure. It generally has a much better frequency response than other types of transducers [5]. 1.1.3.1 Frequency Response

Assuming that each point on the surface of the transducer acts similarly, the voltage output from a transducer (i.e. the detected pressure) can be modeled as [38] vout (t) = em (t)  fs (t), fs (t) =
S

(1.12a) (1.12b)

p(x, t) dS,

where em (t) is the electro-mechanical impulse response of the transducer, fs (t) is the force acting on the transducer surface, and p(x, t) is the pressure at the transducer surface1 . 1.1.3.2 Transducer Models

The two transducers modeled in this thesis are the ideal point detector and the large area integrating planar detector. They are described below.
1 The equation fs (t) = [39]. S

w(x)p(x, t) dS is also commonly used where w(x) is a weighting function

14

1.1. PHOTOACOUSTIC IMAGING Ideal Point Detector If a transducer is modeled as point detector located at xi with frequency response em (t), the detected pressure is found from (1.4) and (1.12) as pi (t) = vout (t) = em (t) 
S

p(x, t) dS (1.13)

= em (t)  p(xi , t) For an ideal transducer, em (t) =  (t). Large Area Integrating Plane Detector of parea (t) = vout (t) = em (t) 
S

If a planar transducer is large enough to

be considered an infinite plane then (1.4) and (1.12) yield a simplified solution [40, 41]

p(x, t) dS (1.14) p0 (x) dx1 dx2
R2 x3 =ct

= em (t) 

Conceptually, this is the integral of p0 (x) over a cross-sectional plane parallel to the transducer at depth ct (see Figure 2.4). The simplicity of this model can be useful for certain simulations and in extracting specific parameters for tissue classification. By taking measurements from many angles (or mathematically rotating the coordinate system), it is possible to reconstruct images using a Radon transform based method similar to CT reconstruction [41].

15

CHAPTER 1. BACKGROUND AND THEORY

1.1.4

Image Reconstruction

Image reconstruction is the process of forming a spatial map of a sample or subject using data obtained from sensor measurements. When the raw data is acquired from measuring instruments the reconstructed image matrix must be calculated using a reconstruction algorithm. In photoacoustic imaging there are several possible algorithms for reconstructing images. These include several variants of backprojection [40, 42­44], time-reversal reconstruction [45­47], iterative approaches [48], frequency domain techniques [40, 49], limited view backprojection [50], techniques involving compressive sensing [10, 51], and several others. Various coding schemes can also be used to improve performance such as the work of Mienkina et al. [52]. Each algorithm has different performance, signal-to-noise ratio characteristics and computational resource requirements. 1.1.4.1 Universal Backprojection

The universal backprojection algorithm [42] allows reconstruction from arbitrarily positioned transducer measurement locations. The reconstructed initial pressure p0 (x) can be found in discretized form [42] by p0 (x) := with bi (t) = pi (t) - ct  pi (t), t ( x - xi ) i (x) = ns , i· |x - xi |3
N

1 (x)

bi
i

x - xi c

i (x),

(1.15a)

(1.15b) (1.15c) (1.15d)

(x) =
i=1

i (x),

where pi (t) is the measured transducer pressure signal from location xi and ns i is the normal of transducer i. If the transducer is non-directional then ns i = will reduce to
1 x-xi
2

x-xi x-xi

and i (x)

. To better illustrate this process, the normalization terms (x)

and i (x) for some common geometries are shown in Figure A.1. Xu and Wang [42] shows that the continuous form of (1.15) reduces to the specific reconstruction equations for cylindrical [53], spherical [44] and planar [42] geometries.

16

1.1. PHOTOACOUSTIC IMAGING 1.1.4.2 Resolution and Bandwidth The resolution of an imaging system is the minimum

Axial and Lateral Resolution

distance that two objects must be spaced apart to be detected as separate objects. The axial resolution for photoacoustic imaging is given by [54]
axial

= 2amin  3

c fmax

,

(1.16a)

where fmax is the maximum cutoff frequency of the ultrasound transducer and amin is radius of the smallest spherical absorber that can be resolved. The lateral resolution for a curved transducer array is given by [54]
lateral

 1.22

ac z  amin , arcsin(D/z ) D

(1.16b)

where ac is the smallest detectable acoustic wavelength, z is the radius of curvature of the transducer and D is the aperture radius. Point Spread Function Xu and Wang [55] and Anastasio et al. [56, see eq. 30] show a ^ m ( ) = F spatial point spread function is related to the frequency response E t {em (t)} of the transducer by PSF( x ) =
1 x  ^ 0  Em ( ) sin(

x ) d . This is a result that
em (t) x

 follows from using (1.4) to obtain P SF ( x )  p(x, t) = t

 p0 (x) . When a

transducer with a lowpass frequency response is used, this can be used to derive (1.16). When a bandpass transducer is used, the PSF will be modulated and spatial domain side lobes will result. Xu and Wang [55] and Anastasio et al. [56] also demonstrate the effect of the aperture size on the image resolution and show that a larger sized transducer reduces the image resolution. Effect of Number of Transducers on Resolution In general, as the number of sampled transducer locations becomes increasingly sparse, it becomes more difficult to maintain the same resolution. This is seen in Figure 3.7. It is generally recommend for ultrasound that transducer elements must be spaced apart no further than min /2 where min is the minimum wavelength to be detected, otherwise sidelobe distortions will form when the image is reconstructed through backprojection [33]. Furthermore, in a sparse array, the ratio of the side lobe power to the main lobe power is proportional to 1/N , where N is the number of transducers [33]. The ratio needs to be as small as possible to accurately reconstruct images without side lobe artifacts. 17

CHAPTER 1. BACKGROUND AND THEORY Sub-resolution Imaging and Compressive Sensing To reconstruct images at very

high-resolution, signals must be collected from a large number of transducer locations, which can be time consuming due to limitations in transducer array technology. However, most of the information contained in transducer measurements is redundant. Compressive sensing is an approach that allows accurate reconstruction to be performed at the expense of computational resources [9]. In compressive sensing, a best-fit optimization problem is solved to match the measured data to the closest representation on a set of orthonormal basis functions. Because an optimization problem is solved, rather than the evaluation of a mathematical equation through superposition, only the minimum amount of data required for its unique solution is need to reconstruct an image. Compressive sensing has shown promising results in photoacoustic imaging [10, 57]. In sub-resolution imaging, it is possible to reconstruct an image at a limit beyond the maximum system resolution when proper assumptions are made about what states are possible for sub-voxel structures [58]. Quantitative pieces of information may allow inferences to be made about sub-voxel structures and where sub-voxel objects are located. Aguet et al. [59] use a sub-resolution approach involving steerable wavelets to localize molecular dipoles that may only exist in a few possible states.

18

1.2. THE MORPHOLOGY OF VASCULAR TISSUE

1.2

The Morphology of Vascular Tissue

In this section, the morphological characteristics of vascular tissue and the differences between normal and abnormal tissue are described. These morphological characteristics can be prominent indicators of cancer and other vascular diseases. Section 1.2.1 provides a brief overview of angiography, the circulatory system and methods for vascular imaging. In section 1.2.2, the morphological differences between normal tissue and abnormal tissue are described. Section 1.2.3 discusses several methods for creating simulated models of vascular tissue.

1.2.1

Angiography and Vascular Imaging

The Circulatory System The circulatory system consists of a network of vessels that pump blood throughout the body. It is broken down into the pulmonary system and the systemic system. In the pulmonary system, blood travels from the right side of heart to the lungs and back to the left side of the heart [60]. In the systemic system, blood travels from the left side of the heart through the body and back to the right side of the heart. In both systems blood travels through vessels categorized into arteries, arterioles, capillaries, venules and veins. Arteries carry blood away from the heard and veins carry blood toward the heart. Capillaries connect the arterial network to the venous network and are where the oxygen is released in the tissue. The typical sizes of these vessels are shown in Table 1.2. Vessels generally smaller than 50 µm are known as micro-vasculature. Vessels Aorta Arteries Arterioles Capillaries Venules Veins Venae cavae Typical Diameter 4 - 20 mm 50 µm - 4 mm 10-50 µm 7-9 µm 10-50 µm 50 µm - 4.5 mm 5 - 15 mm

Table 1.2: Vessels and their typical sizes. The aorta and venae cavae are the largest artery and vein in the body. Adapted from [60].

Methods for Vascular Imaging Angiography is the viewing and analysis of blood vessels and vascular structures. The term was originally intended for use with x-ray scans after injection of contrast agents. More recently, the term has been applied for 19

CHAPTER 1. BACKGROUND AND THEORY other imaging methods used to view vasculature as well. The term micro-angiography is used for imaging small vessels and capillaries. There are several methods for imaging vascular structures in tissue such as magnetic resonance angiography (MRA) [61], computed tomography angiography (CTA) and micro-computed tomography (µCT) [61], power Doppler and contrast enhanced ultrasound methods [62], positron emission tomography (PET) [61], fluorescent imaging, confocal microscopy [63], and photoacoustic tomography [4, 7]. Some ex-vivo methods for study and analysis include histological slides [14, 64, 65], and vascular casting [66]. For diagnosing cancer by analyzing vascular structure, most research has been focused on the micro-vasculature [61]. Traditionally, it has been very difficult to acquire in-vivo images of these capillary structures. Somewhat larger vessels can be detected using MRA and µCT [67]. Although it is not possible to visualize the capillaries using µCT and MRA, cancer can still be detected for large tumors using vessel tortuosity metrics (Section 1.3.1.3) [67]. Recent technologies, such as frequency domain optical coherence tomography [68, 69] produce very high resolution images of vascular structrues (see Figure 1.3). Accordingly, vessel tortuosity metrics are now being applied to investigate vasculature at the capillary levels from in-vivo scans.

1.2.2

Characteristics of Normal and Abnormal Vasculature
Angiogenesis is the process of new blood vessel formation.

Angiogenesis and cancer

The process is most active during fetal development and in the placenta during pregnancy [70]. After birth, the process of angiogenesis contributes mildly to organ growth, however most organ growth does not consist of generating new vessels [70]. In adults angiogenesis mainly occurs in wound repair and in the female cycling ovary [70]. The formation of new vessels requires a finely tuned balance between numerous stimulatory and inhibitory signals [70]. There have been over 70 different disorders found that are related to an impairment in this balance [70]. Tumors are populations of cells that have lost the ability to regulate growth and therefore grow uncontrollably in response to stimulatory signals [71]. Angiogenesis is a natural process and does not directly initiate cancer malignancy. However, when the process is impaired, it can promote tumor progression and metastasis [70]. Structure of tumor tissue As with normal tissue, tumors require oxygen, nutrients,

and must remove their wastes. However, tumors are structurally abnormal at the cellular and tissue levels [71]. They contain abnormal and disfunctioning blood vessels and have little resemblance to normal vessels [1]. 20

1.2. THE MORPHOLOGY OF VASCULAR TISSUE Often regions inside of the tumor may be hypoxic having reduced oxygen levels [72]. To gain oxygen and nutrients, a tumor cell may begin to induce its own blood supply. The tumor may form blood vessels from existing capillaries or may grow around other blood vessels [71]. These changes are due to the release of growth factors such as VEGF, FGF and IL-8 that affect the vasculature physiologically and morphologically [1, 67, 70­73]. Tumor vessels tend to tangle and connect randomly [1]. These cancer vessels have a high tortuosity, which is a measure of the curvyness of the vessels [1, 67]. Figure 1.3 shows in-vivo micro-vascular images of healthy tissue and abnormal tissue structure. The region of tissue shown in Figure 1.3b is clearly different from Figure 1.3a. After successfully treatment, it is possible for the vessels to revert back to functioning and more normal blood vessel structure [73].

(a) typical region of tissue

(b) region containing tumor

Figure 1.3: Normal and abnormal micro-vessels in mouse skin acquired with optical coherence tomography (OCT). 3D datasets courtesy of A. Mariampillai and A. Vitkin, Princess Margaret Hospital, Toronto, ON

1.2.3

Vascular Modeling

There are numerous methods for generating and representing models of vascular structures in tissue. The goal of these approaches is to emulate the tissue with parameters based on actual physical manifestations of vascular tissue. Some methods attempt to simulate vascular geometry by simulating the process of angiogenesis and vessel forma21

CHAPTER 1. BACKGROUND AND THEORY tion [74, 75]. The growth of the vascular network of a 3D whole organ with blood flow and hemodynamic considerations is modeled by Kretowski et al. [75]. Kurz and Godde [76] and [77] simulate angiogenisis and vascular remodelling using a cellular automaton approach. Turing [78] used activator inhibitor models keep track of the exchange of chemical signals. Differential equation methods are studied by Meinhardt [79]. The method of Wang et al. [80] generates a realistic looking vascular branching pattern by using Markov probability models based on actual vasculature. Several authors including Zamir [3] and Karshafian [2] have used fractals to model renal vascular tissue. An attempt to accurately represent the shapes of traced out vascular networks was proposed by Tyrrell et al. [81]. Real-time vascular illustration methods involving visual enhancements such as hatching and shadow like depth indicators which may be useful to clinicians and researchers are studied by Ritter et al. [82]. 1.2.3.1 Fractal Trees

Zamir [3] modeled vascular tissue as a fractal tree consisting of many branching vessel segments. A fractal tree is a mathematical structure that is formed by iteratively applying a branching pattern to the result from the previous iteration. For each iteration, the pattern is specified as a relationship between the parent segment, the left child segment and the right child segment. Here, the terms "left" and "right" are mathematical conventions and do not necessarily correspond to the physical directions for which they are named. A single iteration of the fractal tree pattern is shown in Figure 1.4. Three segments are connected in a Y-shaped configuration. Each segment is a finite-length right circular cylinder with length L and diameter D. The child segments meet the parent segment at a junction located at the posterior end of the parent segment. The angle at which a child branch diverges from the parent segment is called . The rotation of a child branch with respect to a reference plane through the parent is given by the angle . Table 1.3 describes the parameters relating the left and right child segments to the parent segment. The subscripts parent segment. Zamir [3] used morphological parameters based on physical manifestations of tissue to describe vasculature. The diameter asymmetry (also called the bifurcation index) is defined as  := DR , DL 0    1. 22 (1.17)
P, L

and

R

denote when the parameter belongs to the

parent, the left child or the right child. For example, DP refers to the diameter of the

1.2. THE MORPHOLOGY OF VASCULAR TISSUE

Figure 1.4: Iteration of fractal tree pattern to model vascular morphology. The posterior end of the parent segment splits into the left and right child segments. Each child segment becomes a parent segment in the succeeding iteration. The parameters are described in Table 1.3.

It is the ratio of the diameters of the two child branches. Using the hemodynamic energy minimizing constraints, DL and DR can be found from DP by [3, 83] DL = and DR = DP  . (1 +  3 )1/3 (1.18b) DP , (1 +  3 )1/3 (1.18a)

The ratios of the child segment lengths to the parent segment length are known as the distance factors L and R which are defined [2, 3] by LL LP LR R := LP L := 23 (1.19a) (1.19b)

CHAPTER 1. BACKGROUND AND THEORY Description Parent Branch Diameter Left Child Branch Diameter Right Child Branch Diameter Parent Branch Length Left Child Branch Length Right Child Branch Length Left Child Branch Angle Right Child Branch Angle Left Child Orientation Right Child Orientation Parameter DP DL DR LP LL LR L R L R

Table 1.3: Parameters describing the fractal pattern of a vascular tree

Karshafian [2] sets the distance factor of the left and right branches equal to each other so that L = R =  . However, Zamir [3], used distance factors that were set equal to the child-parent diameter ratios as L = DL /DP and 2 = DL /DP as a consequence of hemodynamic constraints. If the branching is almost symmetric (  1), both methods are approximately the same. Hemodynamic energy minimizing constraints will be satisfied when the branching angles obey [3, 83] cos L = cos R = (1 +  3 )4/3 + 1 -  4 2(1 +  3 )2/3 (1 +  3 )4/3 +  4 - 1 . 2(1 +  3 )2/3 (1.20a) (1.20b)

However, Karshafian [2] used probability distributions based on tissue measurements to define L and R because cancerous tissue does not readily obey equation (1.20). The parameters used by Karshafian [2] are summarized in 1.4. The fractal pattern is repeated upon multiple iterations. To indicate the iteration number for each parameter, the superscript
[1] [n]

is used. In this notation, DP , LP , P

[1]

[1]

[1]

and P are the parameters for the root iteration of the fractal tree. The child of a given iteration becomes the parent in the succeeding iteration level. This leads to the recursive 24

1.2. THE MORPHOLOGY OF VASCULAR TISSUE Description Bifurcation Index Distance Factor Branching Angle Branch Orientation Parameter     Normal Tissue 0.95 0.9 25°- 27° 0°- 360° Abnormal Tissue 0.95 0.9 25°- 140° 0°- 360°

Table 1.4: Parameters for structural morphology used for generation of fractal trees in [2]. A uniform probability distribution is used to induce randomness into the branching structure.

binary-tree relationships defined between the parent and child segments by DP DP
[2n]

 DL ,  DR ,
[n]

[n]

LP LP

[2n]

 LL ,  LR ,
[n]

[n ]

P P

[2n]

 L ,  R ,
[n]

[n]

P P

[2n]

 L ,  R .
[n]

[n]

(1.21a) (1.21b)

[2n+1]

[2n+1]

[2n+1]

[2n+1]

Figure 1.5 shows 2D fractal trees for several values of  .

25

CHAPTER 1. BACKGROUND AND THEORY

(a)  = 0.4

(b)  = 0.7

(c)  = 0.9

(d)  = 1

Figure 1.5: 2D Fractal trees generated using equations (1.18), (1.19) and (1.20) for several values of diameter asymmetry parameter  .

26

1.3. AUTOMATED TISSUE SEGMENTATION AND CLASSIFICATION

1.3

Automated Tissue Segmentation and Classification

Tissue characterization is the process of determining which of several classes of tissue a particular sample belongs to. For example, tissue characterization could involve determining if a sample of tissue is healthy or diseased or if it is muscle tissue or adipose tissue [11]. Image segmentation is the process of outlining the boundaries and measuring sizes of tissue regions and structures [11]. Tissue characterization is related to tissue segmentation; however, in tissue characterization, boundaries do not need to be detected. In tissue segmentation, the tissue does not need to be identified or diagnosed [11]. Most ultrasound image segmentation methods are developed from B-mode (log-compressed) images and not unprocessed RF-signals [11, 84]. Tissue characterization is most often done on the RF signal or envelope-detected RF signal [11]. It is not possible to define "healthy" across all types of tissue because different healthy regions and types of tissue will have different statistical parameters; however, it is possible to find a statistical disparity to use for segmentation of different regions [61].

1.3.1
1.3.1.1

Feature Extraction Methods
Frequency Domain Classification

Ultrasound tissue characterization is most commonly performed in the frequency domain. Common tissue characterization parameters such as the integrated backscatter (IBS) coefficient and the mean central frequency (MCF) can be measured from the power spectrum of a signal [15, 85, 86]. Power Spectrum The power spectrum of a signal f (t) is defined as P{f (t)}( ) := |Ft {f (t)}( )|2 . (1.22)

Short-Time Fourier Transform (STFT) of a signal f (t) is defined as

The short-time Fourier transform (STFT)

FSTFTg {f (t)}(,  ) := Ft {g (t -  )f (t)}( ),

(1.23)

where g (t) is a window function, and  is the shift. The window function is used to localize the region of interest where the analysis is performed. 27

CHAPTER 1. BACKGROUND AND THEORY Spectrogram The spectrogram of a signal f (t) is defined as Sg {f (t)}(,  ) := |FSTFTg {f (t)}(,  )|2 . Hilbert Envelope The hilbert transform of a function is defined as H{f (t)} = 1  f (t) t -1 = F t j sgn( )Ft {f (t)} (1.24)

(1.25)

The hilbert envelope and hilbert phase are Henv {f (t)} = |f (t) + j H{f (t)}| H {f (t)} = tan-1 (H{f (t)} , f (t)) 1.3.1.2 Fractal and Statistical Methods (1.26a) (1.26b)

Fractal parameters have been used as a means to classify textures in medical images [13]. In [14, 64, 87] 2D fractal dimension is used to characterize histological slides prepared from slices of vascular tissue. Fractal Dimension The fractal box counting dimension of a multidimensional function f (x) is related to N (f ), the number of boxes that are required to cover it at a given scale. D = lim ln N (f ) 0 ln(1/ ) (1.27)

Fractional Brownian Motion (fBm) Commonly, an N-dimensional image (or 1dimensional signal) will be modeled to fit a fractional Brownian motion (fBm) [12, 88, 89]. A N-dimensional fBm field BH (x) is characterized by having variogram BH that obeys the relation [88, 89] BH ( x - x ) = 2 x - x
2H

(1.28)

where H is a fixed constant known as the Hurst parameter. The Hurst parameter is related to the fractal dimension by D = N + 1 - H . The variogram f (h) is a a measure of spatial correlation of an N-dimensional function f (x). It is defined as f (h) = 1 2|Nh | |f (x) - f (x )|2
(x,x )Nh

(1.29)

28

1.3. AUTOMATED TISSUE SEGMENTATION AND CLASSIFICATION where where |Nh | is the number of spatial coordinates from the domain of function f that are separated by a Euclidean distance h, with Nh = {(x, x )  Dom(f ) × Dom(f ) : x-x 1.3.1.3 = h} . Vessel Tortuosity Metrics

The vasculature can also be characterized by analyzing the properties of vessels from a structural point of view. In vessel segmentation and centerline extraction, the paths of vessels are extracted from a reconstructed image of vascular tissue. Several methods for extracting and analyzing vascular structures are discussed in the literature [90­93]. Metrics can be created to characterize or discriminate between normal and abnormal vasculature. Some of the parameters studied are the vessel count, which is the number of individual vessels contained within a region of interest; the average radius of vessels within a region of interest; the sum-of-angles, where the change in angle between successive vessel tangents are added together at regular intervals along a vessel path; and the inflection count measure which is related to the number of maxima on the vessel path [93].

29

CHAPTER 1. BACKGROUND AND THEORY 1.3.1.4 Wavelet Based Classification Methods

Wavelet methods are used for tissue classification in this thesis. A brief description of some of the basic theoretical concepts is provided to explain how wavelet packets relate to pattern classification.

Wavelet Filters

In discrete wavelet methods, a low-pass filter h[n] is selected so that

its z-transform H (z ) satisfies the quadrature mirror condition H (z )H (z -1 ) + H (-z )H (-z -1 ) = 1. A corresponding high-pass filter g [n] is then defined by its z-transform [94] G(z ) := zH (-z -1 ). (1.31) (1.30)

The condition (1.30) assures that the signal is decomposed into a set of orthogonal basis functions that are useful for signal processing.

Discrete Wavelet Transform (DWT) The DWT of a signal si is given by si+1 [n] := di+1 [n] :=  2(h  (si )2 )[k ] =  2
k

h[k ]si [2n - k ] , g [k ]si [2n - k ] .
k

(1.32a) (1.32b)

  2(g  (si )2 )[k ] = 2

The DWT filter stucture is shown in Figure 1.6.

Wavelet Packet Transform (WPT) The wavelet packet transform (WPT) is commonly used in classification algorithms. The WPT can be thought of as an extension of the DWT. In the WPT the outputs of the DWT highpass filters are further processed through a filter tree as in Figure 1.7. Wavelet packet decomposition filters wp,q [n] are recursively defined as [18] wp+1,2q [n] := wp+1,2q+1 [n] :=   2(h  (wp,q )2 )[k ] = 2(g  (wp,q )2 )[k ] =   2
k

h[k ]wp,q [2n - k ] , g [k ]wp,q [2n - k ] .
k

(1.33a) (1.33b)

2

30

1.3. AUTOMATED TISSUE SEGMENTATION AND CLASSIFICATION with w0,0 [n] :=  [n] for p  Z+ and q = 0..2p-1 . The output signals after each block are then defined by sp,q [n] := (wp,q  s)[n] as shown in Figure 1.7. The original signal input to the WPT is s0,0 [n] := s[n]. (1.34)

Figure 1.6: The Discrete Wavelet Transform (DWT) decomposition filter tree. The h[n] and g [n] blocks are the low-pass and high-pass filters. dp [n] are called the detail coefficients and sp [n] called the approximation coefficients.

Figure 1.7: The Wavelet Packet Transform (WPT) decomposition filters. The h[n] blocks are the low-pass filters and g [n] blocks are the high-pass filters. The signal sp,q [n] = (wp,q  s)[n] is shown as output from each stage of the WPT for p = 0..3, q = 0..2p - 1 . The dotted line indicates the boundaries of the DWT from Figure 1.6 where sp = sp,0 and dp = sp,1 .

For classification algorithms, usually only wavelet decomposition blocks are used. However, the WPT and DWT decomposition are fully reversible. Recomposition blocks similar to Figure 1.7 and Figure 1.6 may be used to produce the original signal from the decomposed signal. Often, processing is performed during wavelet decomposition for purposes of noise-reduction and compression. 31

CHAPTER 1. BACKGROUND AND THEORY Dual-Tree Complex Wavelet Transforms invariant2 . The DWT and WPT are not shift-

This means that a single sample delay could significantly alter the output of

these transforms. By making use of separate real and complex filter banks, it is possible to gain nearly ideal shift-invariance. The the Complex Dual-Tree approach [95] can be applied to the DWT [95] or the WPT [17, 18]. One approach that guarantees filters with analytic properties is called the Dual-Tree Complex Wavelet Packet Transform (DTCWPT) [17]. Analytic signal filters are necessary to effectively extract the envelope of a signal or wavelet packet. In the complex dual-tree approach, an additional imaginary filter tree duplicates real filter tree of Figure 1.7. In the imaginary tree, the real high- and low-pass filters h[n] and g [n] from the DWT block (inside the dotted line in Figure 1.7) are replaced with their hilbert transforms h [n] := H{h[n]} and g [n] := H{g [n]}. The extension filters (outside of the dotted line in Figure 1.7) must be equal for the real and imaginary trees, but may be different from the filters in the DWT section. The input to the imaginary filter tree is given an additional one sample delay as a pre-filter to meet the requirements giving analytic signal properties. The outputs after each block in the real and imaginary filter trees are denoted by sp,q [n] and sp,q [n]. Due to the analytic properties of the transform, an envelope and phase analogous with (1.26) can be defined as senv p,q [n] = |sp,q [n] + jsp,q [n]|,
-1 s p,q [n] = tan (sp,q [n], sp,q [n]).

(1.35a) (1.35b)

2 The continuous wavelet transform (CWT) is shift-invariant, but requires more computational resources for pattern classification

32

1.3. AUTOMATED TISSUE SEGMENTATION AND CLASSIFICATION

1.3.2

Feature Vector Construction

Feature vectors have been extracted using wavelet packet methods in many applications [18, 94, 96, 97]. A feature vector zi of length 2p is created by applying an information cost function (see Table 1.5) to each of the 2p wavelet packets. The specific feature vectors formulation used in this thesis is described in more detail in Section 2.3.2.1. Information Cost Functions
N

energy

C E ( u) =

u2 i
i ui =0

(1.36a)

log energy

C e ( u) =
i ui =0

ln u2 i
2 u2 i ln ui i N (1/p)

(1.36b)

Shannon entropy

CH (u) =

(1.36c)

p

-norm

C p (u) =
i N

|ui |

p

(1.36d)
2

variance

CV (u) =
i

1 ui - N

un
n

(1.36e)

Table 1.5: Information cost functions.

33

CHAPTER 1. BACKGROUND AND THEORY

1.3.3
1.3.3.1

Training of the Classifier
The Support Vector Machine

A common method used for pattern classification is the support vector machine (SVM)3 . The support vector machine (SVM) is a method used to produce a classifier from a set of initial measurements that either belong or do not belong to a specific category defined for the problem at hand. The classifier can then be used to test if any future measurement belongs to the specific category. Training Set The set of N examples Vtraining := {(z1 , y1 ), . . . , (zN , yN )} (1.37)

is known as the training set. It describes the initial measurements that are used for training the SVM classifier. Each example (zi , yi ) contains a feature vector zi  Rn consisting of n values that describe a single measurement. The binary value yi  {-1, +1} is called a class label. It is assigned to each example and signifies if zi is a member of the specific category defined for the problem. It is assigned values by the rule  +1 if z belongs to the category i yi = -1 if z does not belong to the category i The method used for generating feature vectors is given in Section 2.3.2.1. Decision Function function
N

(1.38)

The SVM attempts to construct a classifier based on the decision

f (z) := sgn
i=1

yi i K (z, zi ) + b ,

f : Rn  {-1, 1}

(1.39)

where  = (1 , ..., l ) is a weight vector, b is a bias constant, N is the number of examples, sgn(x) is the signum4 function, yi is the class label and K (z, zi ) is a chosen kernel function. The term
N

 (z) :=
i=1
3

yi i K (z, zi ) + b

(1.40)

For this section, mathematical notation similar to Scholkopf et al. [19] is used. +1, x  0, 4 The signum function is defined by sgn(x) = -1, otherwise.

34

1.3. AUTOMATED TISSUE SEGMENTATION AND CLASSIFICATION inside the brackets of (1.39) is called the classification strength. It represents the strength of the classifier for any particular feature vector z being tested. The vector  in (1.39) can be manipulated allowing f to constitute a wide range of possible functions. This is the mechanism for tuning the classifier. The range of decision functions f that are possible depends the kernel function K that is selected.

Maximization

The goal of the SVM is to find the best possible values of  to use in

equation (1.39). This occurs by finding values for  that maximize
N

W () =
i=1

i -

1 2

N

N

i j yi yj K (zi , zj )
i=1 j =1 N

(1.41)

subject to 0  i  , i = 1, . . . , N and
i=1

i yi = 0, with  a constant [19]. Any value

of zi where i = 0 is called a support vector.

Solvers

An optimization problem must be solved to generate a best-fit classifier for

the training examples given. Many possible solvers are available to optimize minimize (1.41). SVMPerf [98] and NSVM [99] are two solvers with implementations in Matlab. The details of the optimization and maximization are beyond the scope of this work.

Linear Kernel

The linear kernel is given by Klinear (z, zi ) := z · zi . (1.42)

In this case (1.39) will reduce to
N

f (z) = sgn
i=1

yi i (z· zi ) + b .

(1.43)

By assigning
N

w :=
i=1

yi  i z i ,

equation (1.43) can be rewritten as fw,b (z) := sgn(w · z + b), 35 (1.44)

CHAPTER 1. BACKGROUND AND THEORY where w is the normal of a hyperplane that separates the two classes and b is the bias offset of the hyperplane [19]. Equation (1.44) is a simple method for classifying a dataset from a given feature vector z. Non-linear Kernel It is not always possible to separate the two classes using effectively a single hyperplane as in (1.44). Instead, a non-linear kernel can be used. There are several common choices for non-linear kernel functions (see [19]). The classifier is called a Gaussian radial basis function (GRBF) when KGRBF (z, zi ) := e-|z-zi |
2 /

,

(1.45)

with  a chosen constant. This kernel may be used when feature vectors exist in clusters that are not partitionable by (1.44). Classification and the Test Set After the minimization of (1.41), the decision func-

tion of (1.39) may be used to classify a feature vector z. The classification strength  (z) (1.40) may be related to how strongly the feature vector belongs to a category. A set of measured feature vectors that are different from the original training set which are used to test the performance of the classifier is called the test set. Section 2.3.2 describes how the support vector machine is used to classify photoacoustic signals.

36

Chapter 2

Methods
2.1 Model of Vascular Tissue

In this work vascular tissue is studied using two models. The first model involves simulating blood vessel networks with fractal trees as described in Section 1.2.3.1. For this model, the tissue is generated using published parameters and is able to represent specific types of tissue to a considerable degree of realism. Vasculature generated by the fractal tree model is shown in Figure 2.1. The second model for studying the morphology of vascular tissue uses 3D datasets of micro-vasculature acquired in-vivo with optical coherence tomography. These datasets represent the arrangement of blood vessels from normal and cancerous tissue. The classification algorithm will be tested on these realistic datasets to demonstrate its applicability for actual tissue morphology. In addition to these two tissue models, simple spherical and cylindrical source geometry are also used to model photoacoustic sources for the purposes of validation and testing. The models and datasets that are used in this work are summarized in Table 2.1.

2.1.1

Fractal Tree Model

Simulation of vascular networks using fractal trees is a convenient method for generating datasets of tissue. The mathematical structure of the fractal tree model allows specific morphological parameters to be varied in a deliberate way which is beneficial for performing controlled testing. 37

CHAPTER 2. METHODS Dataset DS-SIM1 DS-SIM2 DS-SIM3 DS-SIM4 DS-SIM5 DS-SIM6 DS-SIM7 DS-SIM8 DS-SIM9 DS-OCT1 DS-OCT2 SPH-R CYL-R-L TREE-N Description Simulated Tissue Branching angles 25°-27°(normal) Branching angles 25°-30° Branching angles 25°-35° Branching angles 25°-45° Branching angles 25°-60° Branching angles 25°-80° Branching angles 25°-100° Branching angles 25°-140°(abnormal) Branching angles 25°-160° Acquired Real-Tissue Datasets Normal Abnormal Source Distributions Sphere (radius R) Finite Cylinder (length L, radius R) Arbitrary Fractal Tree (depth N ) N/A N/A N/A 1 1 20 20 20 20 20 20 20 20 20 Quantity

Table 2.1: Model Tissue Datasets. There are two models of vascular tissue: simulated and acquired.

Normal or Abnormal Tissue

The criteria for normal and abnormal tissue are based on Table 1.4. Normal tissue has branching angles ranging from 25-27°. Abnormal tissue has branching angles ranging from 25-140°. The most significant difference between the tissues is related to the branching angle distribution. To test the variation in the branch angle distribution, the range of branching angles is varied between normal and abnormal tissue, as shown in Figure 2.2. The parameters  = 0.95 and  = 0.9 (Section 1.2.3.1) are held fixed. Twenty fractal tree datasets of each variation listed in Table 2.1 are generated, labeled as DS-SIM1 to DS-SIM9. Each tree in each dataset is unique because a random number generator is involved in creating the geometry. Normal tissue is represented by DS-SIM1 and abnormal tissue is represented by DS-SIM8. 38

2.1. MODEL OF VASCULAR TISSUE

(a) Normal Tissue

(b) Abnormal Tissue

Figure 2.1: Simulated vascular tissue geometry. For normal tissue, the branch angle range varies from 25 to 27 . For abnormal tissue, it varies from 25 to 140 .

Assumptions for Fractal Tree Tissue Model The assumptions listed below are used when simulating tissue with the fractal tree model and are further discussed in Chapter 4. The assumptions related to the photoacoustic wave propagation model are provided in Section 2.2. i. The parameters used represent real tissue. A fractal tree, at best, is only an approximation for real tissue. It is assumed that the parameters used for generating the fractal tree (Section 2.1.1) will be sufficient to accurately model vascular tissue. ii. Non-specific tissue type. The parameters for generating tissue are based on a specific type of tissue (kidney). It is assumed that the ability to discriminate abnormal from normal will translate to other types of tissue that can be generated from different morphological parameters. iii. Cylindrical vessel shape. It is assumed that vessels consist of perfect cylindrical segments. Actual vessels do not conform to such an ideal shape, have a varying radius and follow a curved trajectory. iv. Scale independence. It is assumed that the morphological fractal parameters are scale independent. Thus each iteration of the fractal tree obeys the same statistical rules and can be modeled by the same morphological parameters. 39

CHAPTER 2. METHODS v. Bifurcating junctions. It is assumed that at each branching junction, a parent segment bifurcates into two child segments. Hence, there are no trifurcations and no "dead-end" junctions where only one child segment is formed. vi. Branching angle most significant geometric discriminator. It is assumed that the most significant parameter that changes between healthy and abnormal tissue is the branching angle distribution [3, 100]. vii. Branching angles are uniformly distributed. It is assumed that the tissue will have uniformly distributed branching angles. viii. One sided vascular network. It is assumed that the fractal tree produced represents an arterial network. The venous network is not modeled as a separate interconnected fractal geometry. ix. Constant blood oxygenation. The oxygenation of blood is assumed to be constant. x. Ideal optical properties. It is assumed that the optical properties of the tissue follow the wide-field photoacoustic assumption (Section 1.1.2.1) where the entire tissue is illuminated everywhere uniformly from a single laser pulse. It is assumed that blood is the only absorber in tissue so that µa,blood profile is given by  µ a,blood µa ( x) = 0 x is in a vessel, otherwise. µa,tissue  0. The optical absorption

The laser energy fluence can be set to the constant (x) = Cp/c2 µa,blood so that the initial excess pressure p0 (x)  {0, 1}. xi. Ideal mechanical properties. It is assumed that the tissue is acoustically homogeneous. The effects of dispersion are not modeled.

Implementation The mathematical representation of the fractal tree consists of an array of startingpoints [P ], an array of end-points [Q], and an array of diameters [DP ]. Together, the geometry and positioning of all the cylindrical segments is fully defined. The procedure for generating the fractal tree is described in Algorithm 2.1. The input parameters Lp , (min , max ), (Dmin , Dmax ), and (min , max ) and define the initial segment length, the distance factor distribution, the diamater distribution, 40
[1]

2.1. MODEL OF VASCULAR TISSUE

Figure 2.2: Simulated tissue varying branching angle range. Top left moving to bottom right. Normal tissue appears progressively more abnormal as the maximum branching angle chagnes from 27 to 160 . The surrounding sphere indicates the region of interest of the simulation.

and the branching distribution. The input parameter N defines the number of iterations in the fractal tree. First, the root cylinder is defined. The starting point P [1] of the root vessel is initialized to the origin (0, 0, 0) (line 1). The root vessel's end point Q[1] is initialized to a z-axis coordinate given by (0, 0, LP ) (line 2). up is a reference vector that is used to track the vessel orientation (line 3). Each segment i is now processed in a loop (line 4). There are 2N -1 segments to process. An inner loop (line 5) is used to process the left branch (j = 0) and the right branch (j = 1). Equation (1.21) is used for the numbering of each segment. The diameter of each child segment DP branch angle
[2i+j ] P [2i+j ] [1] [1]

is calculated by equation (1.18) (line 6). The
[2i+j ]

is assigned a uniformly distributed random branch angle from the is assigned

range (min , max ) based on Table 1.4 (line 8). The orientation angle P 41

CHAPTER 2. METHODS Algorithm 2.1 GenerateFractalTree Input: LP , DP , N, (min , max ), (min , max ), (Dmin , Dmax ) Output: [P ], [Q], [LP ], [DP ], [P ], [P ]
1: 2: 3: 4: 5: 6: 7: 8: 9: 10: 11: 12: 13: 14: 15: 16: 17:
[1] [1]

P [1]  (0, 0, 0) Q[1]  (0, 0, LP ) up  (1, 0, 0) for i = 1 to 2N -1 - 1 do for j = 0 to 1 do DP
[2i+j ] [1] [1]

 DP

[ i]

j (1+ 3 )1/3

rand(Dmin , Dmax )

[2i+j ] P  rand(0, 2 ) [2i+j ] P  rand(min , max ) [2 i + j ] P  Q [i ]

ut 

Q [i ] - P [i ] [i ] LP [i ] un  up × ut [2i+j ]

(wx , wy , wz )  cos(P Q[2i+j ]  P [2i+j ] + up
[2i+j ] [2i+j ] [i ]

) sin(P

[2i+j ]

), sin(P

[2i+j ]

) sin(P

[2i+j ]

), cos(P

[2i+j ]

)

Q [i ] - P [i ]

un  cos-1 (wz )

ut  tan-1 (wy ,wx )

rand(min , max )

 

LP

un  cos-1 (wz ) Q[2i+j ] - P [2i+j ]

up

ut  tan-1 (wy ,wx )

end for end for

by (1.20) (line 9). The start point of the child segment is positioned at end point of the parent segment. The unit vector ut represents the direction of the parent segment (line 10). The unit vector un is the normal of the reference plane incident with ut and up (line 11). The vector w = (wx , wy , wz ) is defined (line 12) as the orientation of the child segment in spherical coordinates in a world reference frame with respect to the reference vector (0, 0, 1). w must be rotated to correspond the local reference frame of the parent segment and scaled by the distance factor  (line 13). In this notation, the operator [w]
[ i] x  [ i]

stands for the right-handed rotation of vector w about vector x by angle . The vector up is simply the vector (1, 0, 0) in the local reference frame and must continuously be
2i+j tracked (line 14). The parent length LP is calculated (line 15).

The mathematics can be worked out using standard algebra and geometry. In Matlab the operator [w]
x 

is implemented using a quaternion rotation algorithm. Quater42

2.1. MODEL OF VASCULAR TISSUE nion rotations allow many point to be rotated simultaneously at low computational cost. This was useful for the actual drawing the 3D vascular trees because each cylindrical segment is rendered as many Matlab patches consisting of numerous points.

2.1.2

Acquired 3D Data Tissue Model

In the second tissue model, tissue is modeled using 3D datasets of micro-vasculature obtained in-vivo from mouse skin using optical coherence tomography1 [69]. These datasets represent the geometry of the micro-vessels with very high contrast. Figure 1.3 shows these datasets for normal tissue and abnormal tissue with a cancerous tumor. Each dataset is 800 × 800 × 128 voxels encoded as 256 shades of grey. The imaging method can examine the tissue up to a depth of 2 mm. The dataset is preprocessed with sigmoid thresholding procedure to make vessel structures have a more uniform heat absorption profile for photoacoustic simulation. The thresholding function f (x) = 1 + arctan(ax + b)/ was used where a and b are constants chosen to maximize the vessel contrast. In Figure 3.18a-b, 2D cross-sectional slices are shown after thresholding. Assumptions for the Acquired 3D Data Tissue Model The following assumptions are used with the acquired 3D data tissue model. i. Exact optical absorption geometry. It is assumed that the post-processed data represents the exact optical absorption profile of the vascular geometry and that no artifacts have been introduced by reconstruction and post-processing. ii. Constant blood oxygenation. It is assumed that the blood oxygen saturation of arteries and veins is the same and constant within the vessel region of the tissue. iii. Representative datasets. It is assumed that the data is representative of all normal and abnormal tissue even though only two datasets are used.

1 Datasets reconstructed from photoacoustic microscopy could have also been suitable; however OCT datasets were chosen due to their availability.

43

CHAPTER 2. METHODS

2.2

Photoacoustic Wave Simulation

This section discusses the design, implementation and testing of photoacoustic simulators that are used in this thesis. Section 2.2.1 focuses on the implementation of the simulators that were developed to model the photoacoustic wave propagation from vasculature. Section 2.2.2 describes the methods that were used for validating these simulators, including finite-element modeling and closed form solutions for simple geometries.

2.2.1

Simulation

Three simulations using two separate transducer models are used to implement the simulators used to study photoacoustic wave propagation in tissue and vasculature. Table 2.2 lists the simulators that were developed. The point detector transducer mathematical model is described in Section 2.2.1.1. The large area integrating transducer model is described in Section 2.2.1.2. Method Point Detector (Tree Mode) Point Detector (Matrix Mode) Area Detector Purpose Photoacoustic simulations from large vascular trees Photoacoustic simulations from 3D matrix of initial pressure Simplified mathematical model for signal characterization
Table 2.2: Simulators developed for photoacoustic wave propagation. Tree mode is used for simulating large vascular tree models, while matrix mode is used for simulations of dense 3D datasets.

Section 2.2.1.1.1 2.2.1.1.2 2.2.1.2

2.2.1.1

Point Detector

A point detector is an ideal omni-directional transducer that measures a pressure signal at a given position with respect to time according to equation (1.13). A 3rd -order Butterworth filter with a 3dB cutoff frequency of 250MHz is applied to each point-detector signal to approximate the frequency response of an actual system. For this implementation, the point detector simulator operates in two modes: tree mode and matrix mode. The tree mode simulation (Section 2.2.1.1.1) is used to simulate the pressure signal at x0 resulting from the laser illumination of a fractal tree produced as output from 44

2.2. PHOTOACOUSTIC WAVE SIMULATION Algorithm 2.1 (page 42). By simulating the signal directly from this geometry, the entire matrix of points for the region-of-interest does not need to be stored in computer memory for the simulation. This allows a more efficient simulation with higher resolution than would otherwise be possible. In matrix mode (Section 2.2.1.1.2), the entire region-of-interest for the simulation is stored in memory as a 3D matrix array. This makes it possible to simulate geometries that are not limited to cylindrical segments as in the tree mode simulator. 2.2.1.1.1 Point Detector - Tree Mode In tree mode, the simulator operates on

a fractal tree with cylindrical-segment geometry that can be created by Algorithm 2.1. The tree geometry is completely defined by T := (P [i] , Q[i] , DP ) : i  Z, 2lmin -1  i  2lmax - 1 ,
[ i] [ i]

(2.1)

where P [i] , Q[i] and DP are the start point, end point and diameter of each cylinder. The notation Ti := (P [i] , Q[i] , DP ) represents the ith cylindrical segment in tree T . The binary-tree numbering scheme of (1.21) provides an explicit relation between the parent of a segment Ti and whether Ti is a left or right child of its parent. To avoid the dominant effect from the largest root branches, the simulation is limited to the range of branching level iterations lmin to lmax . In effect, this causes each segment from level lmin to appear as the root of a separate tree. Using this convention, multiple separately rooted trees can be placed into a single simulation, and a forest of trees rather than a single tree can be simulated to provide a more homogeneous vascular network. Algorithm 2.2 describes the photoacoustic simulator for large vascular trees. Each cylinder is broken down into many individual photoacoustic point sources (lines 1-2). The distance of each point source to the transducer is calculated (line 3). Using equation (1.4b) the contribution from each photoacoustic point source is added to the photoacoustic signal (line 4). Filtering is then performed to take the partial derivative and perform smoothing (line 8). The filter h1 [t] = [1, -1] is used to take the derivative. A smoothing function h2 [t] is used to give each point source with an approximate localized spatial distribution. To cause the point sources to approximate a solid object, a raised cosine function is used so that h2 [t] = (cos(2t/nh -  ) + 1)/2 for t = 0 .. nh - 1 with nh = 2 3l/(ct) and where l is the expected value of the distance between point sources. Figure 2.3 shows the two configurations that are used for generating photoacoustic signals.
[ i]

45

CHAPTER 2. METHODS

Algorithm 2.2 SimulateTree(T, x0 ) Input: {P } , {Q} , {DP } , x0 Output: s0 [t] For each cylindrical segment:
1:

for i = 2lmin -1 to 2lmax - 1 do Generate list M of individual photoacoustic point sources:

2:

M  GetCylinderPointSources(Ti ) Calculate the distance of x0 to each photoacoustic source in M: X  { m - x0 : m  M} Add the contribution from each photoacoustic source:

3:

4: 5: 6: 7:

for t = tmin to tmax by t do
t  x  t+t

s[t] 
xX

1 4c2 t

end for end for Take the derivative and perform smoothing using convolution filters:

8:

return s[t]  h1 [t]  h2 [t]

Algorithm 2.3 SimulateMatrix(p0 (x), x0 ) Input: p0 (x), x0 Output: s0 [t] For each spatial location in the tissue:
1:

for x  M do Calculate the sample number based on the source location:

2:

n  ( x - x0 /c - tmin )/t + 1 Add the contribution from the point source by superposition: s[n]  s[n] + end for Take the derivative and perform smoothing using convolution filters:
p0 (x) 1 4c2 x-x0

3: 4:

5:

return s[t]  h1 [t]  h2 [t]

46

2.2. PHOTOACOUSTIC WAVE SIMULATION 2.2.1.1.2 Point Detector - Matrix Mode In matrix mode, the point detector

uses a 3D matrix array that describes the initial pressure profile immediately after the laser has fired for each point in the simulated medium. In this mode, it is possible to use the actual geometry from datasets of 3D reconstructed medical images as input to the simulator. Each point in the matrix is treated as a separate photoacoustic source. The resulting pressure at position x0 can be computed from (1.13) as described in Algorithm 2.3. 2.2.1.2 Area Detector

The area detector operates by using planar transducer assumed to be large enough that it can be considered an infinite plane. In this case, the photoacoustic signal can be computed according to (1.14). This is simply the integral of the p0 (x) over a slicing plane parallel to the transducer at depth ct, as shown in Figure 2.4. The electromechanical response of the transducer is assumed to be ideal with em (t) =  (t). The simulator operates on the fractal tree geometry produced by Algorithm 2.1. At each sampling time, the contribution from each cylindrical segment intersecting the slicing plane is added to the signal. Algorithm 2.5 is used to determine if a cylinder intersects a given position on the plane [101]. ^ , x0 ) Algorithm 2.4 SimulateAreaDetectorTree(Ti , n For each sampling time:
1:

for t = tmin to tmax do For each point in the parallel plane at distance ct from the transducer: ^ = ct} do for x  {z : (z - x0 ) · n Add the contribution from each intersecting cylindrical segment: ^ , x) s0 [t] = P0 CylinderHitTest(Ti , n
i

2:

3: 4: 5: 6:

end for end for return s0 [t]

^ , x) Algorithm 2.5 CylinderHitTest(Ti , n
1: 2: 3:

k1  Q[i] - P [i] k2  x - P [ i] return 0 
^ k 2 ·n ^ k 1 ·n

 1 and

k2

2 -k

k1

1 · k2 2



(D[i] )2 4

47

CHAPTER 2. METHODS

(a) Linear array n = 16

(b) Planar array nx = 8,

ny = 8

Figure 2.3: Configuration used in the point detector simulation.

48

2.2. PHOTOACOUSTIC WAVE SIMULATION

(a) A cross sectional slicing plane

(b) Slicing plane showing the region of interest

(c) A cross sectional slice of the region of interest

Figure 2.4: Configuration used in area detector simulation. A slicing plane at depth ct consists of point sources that contribute to the transducer signal at time t. The transducer (not shown) is parallel to the slicing plane. The intersections of the cylindrical segments with the region of interest are shown in (c)

49

CHAPTER 2. METHODS

2.2.2

Validation

The photoacoustic simulators of Section 2.2.1 are validated using two methods. In the first method, a software package is used to perform a reference simulation via the finite element method. This is described in Section 2.2.2.1. In the second method, the simulator output is compared against a derived closed form solution for the photoacoustic signal or a finite-length cylindrical source as described in Section 2.2.2.2. Table 2.3 lists the tests that are performed for validation of the simulators. Test Validation TST-V-T1 TST-V-T2 TST-V-M1 TST-V-F1 TST-V-F2 TST-V-F3 TST-V-E1 CYL-2-100 TREE SPH-10 SPH-10 SPH-1 CYL-2-100 CYL-2-100 Point Detector (Tree Mode) Point Detector (Tree Mode) Point Detector (Matrix Mode) FEM-3D, Sphere FEM-2D+AS, Sphere FEM-2D+AS, Cylinder Exact Equation Cylinder Datasets Method Section Methods, Results 2.2.1.1.1, 3.1.3.1.1 2.2.1.1.1, 3.1.3.1.2 2.2.1.1.2, 3.1.3.2 2.2.2.1.1, 3.1.1.1.1 2.2.2.1.1, 3.1.1.1.2 2.2.2.1.2, 3.1.1.2.1 2.2.2.2, 3.1.2.1

Table 2.3: Test configurations used in simulation. Each test makes use of a dataset listed in Table 2.1.

2.2.2.1

Finite Element Simulations

To validate the functionality of the simulator, the finite element method (FEM) is used to solve the equation (1.3) for simple geometries. It is necessary to validate the simulator against a known solution to ensure that it is producing proper output to within a reasonable degree of certainty. Comparing the functionality of the simulator against a FEM model for the same geometry should demonstrate that the simulator is behaving as expected. The simulations are performed using the COMSOL2 software package. COMSOL has a built in module for simulating acoustic wave propagation. Subdomains, which are regions with specified boundaries, can be defined and assigned initial and boundary conditions. Due to the nature of the transient acoustic wave simulation, it is difficult to simulate an entire vascular tree using FEM methods. For 3D simulation, the FEM method requires large computational resources in terms of both memory and processing power. If this
2

COMSOL Multiphysics v3.5a, COMSOL Inc., Burlington, MA

50

2.2. PHOTOACOUSTIC WAVE SIMULATION were not the case, a custom simulator would not be required, and a FEM simulator could simulate the entire vascular geometry. Hence, only small geometries are simulated using the FEM simulator. 3D FEM simulation can be made much more efficient in certain situations. If a 3D model consists of an axis of symmetry, then it is possible to reduce the computation by one effective spatial dimension. This is done by running the simulator under a special mode for systems with axial symmetry. The methods for generating simulation results to be used in validation with spherical and cylindrical geometries are discussed in this section. The results from these simulations will be provided in Section 3.1.1.

2.2.2.1.1

Spherical Geometry

The absorbing sphere is given an initial pressure

to represent the effect of heating immediately following homogeneous optical absorption from the instantaneous firing of the laser pulse. The initial spherical pressure profile is  P 0 p0,sphere (x) = 0 x  R, otherwise.

(2.2)

To describe the spherical profile in software for TST-V-F1, the FEM model, is split into two subdomains bounded by SP H 1 and SP H 2 as shown in Figure 2.5. For the inner subdomain, the initial pressure is P0 kPa. For the outer subdomain, the initial pressure is 0 kPa. The medium is water with speed of sound 1500 m/s and density 1000 kg/m3 . The outer boundary has spherical wave absorbing boundary conditions. Sampling transducer locations are defined to measure the time domain photoacoustic signal. The 3D ideal spherical absorber has a known exact solution of [102]   0,
x -ct 2 x

psphere (x, t) =

|( x - ct)|,

-R  x - ct  R, otherwise.

(2.3)

Since the 3D sphere has radial symmetry, it is possible to reduce it to a 2D (or a 1D) FEM model. For TST-V-F2, the same simulation is set up for 2D axial symmetry as shown in Figure 2.6. The absorbing sphere is given an initial pressure according to (2.2). The FEM model is again split into two subdomains. For the inner subdomain, the initial pressure is P0 kPa. For the outer subdomain of the initial pressure is 0 kPa.

51

CHAPTER 2. METHODS

(a)

(b)

Figure 2.5: FEM Simulation of 3D spherical optical absorber. R = 1mm. (a) The simulation geometry is shown. The inner subdomain bounded by SP H 1 represents the spherical source with initial pressure P0 kPa. The outer boundary SP H 2 encloses the subdomain of the medium which has initial pressure 0 kPa. The medium is water with speed of sound 1500 3 m/s and density 1000 kg/m . The outer boundary has spherical wave absorbing boundary conditions. (b) The geometry is meshed into 82356 tetrahedral finite elements with 115536 degrees-of-freedom.

2.2.2.1.2

Cylindrical Geometry The geometry for the cylindrical source is shown

in Figure 2.7. It is simulated with 2D axial symmetry. The initial pressure immediately after the laser pulse is fired is given by  P 0 p0,cylinder (x) = 0 - - - -  x · (1, 1, 0)  R otherwise. and - - - -  x · (0, 0, 1) 
L 2,

(2.4)

The FEM model, is split into two subdomains. For the inner subdomain, the initial pressure is P0 kPa. For the outer subdomain of the initial pressure is 0 kPa. The medium is water with speed of sound 1500 m/s and density 1000 kg/m3 . The outer boundary has spherical wave absorbing boundary conditions. Sampling transducer locations are used to meausure the time domain photoacoustic signal. The results are plotted in Figure 3.3 and Figure 3.4.

52

2.2. PHOTOACOUSTIC WAVE SIMULATION

(a)

(b)

Figure 2.6: FEM Simulation of sphere with 2D axial symmetry. R = 1mm. (a) The simulation geometry is shown. The axis-of-symmetry passes through x = 0. The small inner semi-circle encloses a subdomain with initial pressure P0 kPa. The outer semi-circle bounds the subdomain of the medium and has initial pressure 0 kPa. The medium is water with 3 speed of sound 1500 m/s and density 1000 kg/m . The outer boundary has spherical wave absorbing boundary conditions. (b) The geometry is meshed into 51163 triangular finite elements with 102792 degrees-of-freedom.

(a)

(b)

Figure 2.7: FEM Simulation of finite-length cylinder under 2D axial symmetry. L = 2mm, R = 0.1mm. a) The simulation geometry is shown. The axis-of-symmetry passes through x = 0. The shaded rectanglar subdomain represents a cylinder with initial pressure P0 kPa. The outer sphere is the subdomain of the medium and has initial pressure 0 kPa. 3 The medium is water with speed of sound 1500 m/s and density 1000 kg/m . The outer boundary has spherical wave absorbing boundary conditions. b) The geometry is meshed into 69572 triangular finite elements with 139727 degrees-of-freedom.

53

CHAPTER 2. METHODS 2.2.2.2 Exact Solution for Finite-Length Cylindrical Source An

Derivation of solution for finite-length cylindrical photoacoustic source

exact solution for the finite-length photoacoustic cylindrical source problem is derived in terms of elliptic integrals in Appendix B. The symbolic mathematics software package Maple3 is used to assist with the derivation. The finite-length photoacoustic source problem can also be solved by numerical methods which may be time consuming to evaluate. It is known that there is no closed form solution for this problem in terms of basic mathematical functions4 . In Appendix B, the exact solution is reduced to terms of elliptic integrals which can be computed efficiently. The pressure p(x, t) waveform from a finite-length cylindrical photoacousic source is given by equation (B.5). In TST-V-E1, equation (B.5) is tested against the output from FEM and tree-mode simulators as shown in Figure 3.4.

Maple v13.2, MapleSoft Inc., Waterloo, Ontario This means an expression consisting of a finite number of exponential, polynomial, addition, and multiplication terms.
4

3

54

2.3. CLASSIFICATION AND RECONSTRUCTION

2.3
2.3.1

Classification and Reconstruction
Image Reconstruction

Reconstructed images are produced using the output of the photoacoustic simulators developed in Section 2.2. Image reconstructing is performed using an implementation of the universal backprojection algorithm described in Section 1.1.4.1. A list of the image reconstructions that are performed are given in Table 2.4. In test TST-R-M1, the 3D matrix-mode simulator is used to study the effect that the number of transducers has on the reconstructed image resolution. The transducers are located in a circular ring arrangement around a thin layer of tissue. The image is reconstructed with 12, 20, 30, 40, 60, 90, 120 and 360 transducers. Results are shown in Figure 3.7. For test TST-R-T1 and test TST-R-T2, reconstructions from the tree-mode simulator are performed to study photoacoustic image formation from the simulated vasculature. Test TST-R-T1 examines the reconstruction of a three-dimensional tree in the two-dimensional plane of a linear array transducer. The results are plotted in Figure 3.8. Test TST-R-T2 examines the reconstruction of a three-dimensional vascular tree from a sparse 2D-array transducer. The results are plotted in Figure 3.9. Test Reconstruction TST-R-M1 TST-R-T1 TST-R-T2 DS-OCTx DS-SIMx DS-SIMx Point Detector (Matrix Mode) Point Detector (Tree Mode) Point Detector (Tree Mode) 2.3.1, 3.2.1 2.3.1, 3.2.2 2.3.1, 3.2.2 Datasets Method Section

Table 2.4: Test configurations used in reconstruction.

55

CHAPTER 2. METHODS

2.3.2

The Classification Algorithm

The classification algorithm is broken down into two phases that are shown in Figure 2.8. Phase I, is the training phase, where a classifier is learned from a set of representative measurements of the data. In Phase II, the learned classifier is used to discriminate between measurements in a test set that were not part of the original training set.

Figure 2.8: Phases of classification algorithm

2.3.2.1

Feature Vector Creation

In both phases, feature vectors must be constructed from the sampled transducer RF signals. The feature vector, designated zs(t) , must be created on a sliding window in the transducer signal centered at time t. A window sampling duration Tw is defined. The number of samples in the window is Nw = Tw /t, where t is the period of each sample. The entire transducer signal s(t) undergoes dual-tree wavelet packet decomposition as outlined in Section 1.3.1.4. Prior to windowing, the q = 2p - 1 packet envelopes senv p,q [n] are then extracted for a specified filter level p using (1.35a). The feature vector for level p, noted zp s(t) , is creating by applying an information cost function C (u) from (1.36) to each packet envelope according to
p zp s(t) = {C (uq ) : q = 1 . . . 2 - 1} ,

uq =

senv p,q [n] : n 

t/t t/t + Nw , p 2 2p

(2.5) .
q

p,0 p,1 p,2 -1 The feature vector is then taken as zs(t) := zp ). Hence, a s(t) = (zs(t) , zs(t) , . . . , zs(t)

feature vector zs(t) is the ordered set consisting of the information cost function applied 56

2.3. CLASSIFICATION AND RECONSTRUCTION to a window centered at t on each packet envelope. A feature vector thereby can be constructed at any value of t. Noise Reduction An approach similar to Learned and Willsky [96] is used for noise

reduction. Several feature vectors znoise,i are generated from pure white-noise. An av1 ¯noise = N erage noise vector z i znoise,i is then calculated. Each feature in z is then ¯noise . normalized by the corresponding feature in z Packet Normalization To ensure that all packets have the same energy, packets are normalized by z = z/ z . 2.3.2.2 Training of the Classifier

The support vector machine of Section 1.3.3.1 is used to create a decision function. To train the classifier, M transducer signals are obtained from a set of measurements representative of signals that would be encountered during regular use. These signals are used to construct the training set. For each transducer signal sm (t) there are Nm window positions centered at mn that are spaced apart by Tstep , where mn = m0 +(n - 1)Tstep . The class labels ym from (1.38) are assigned the value +1 for normal tissue, and -1 for abnormal tissue. The training set (1.37) is then written Vtraining = {(zsm (mn ) , ym ) : m = 1 . . . M, n = 1 . . . Nm }. (2.6)

The training set is fed to the SVM5 to obtain an optimal classifier  (z) of (1.40). 2.3.2.3 Testing of the Classifier

Table 2.5 lists the classification tests that are performed. Classification of simulated tissue For TST-C-T1, datasets are generated for the fractal tree data. Each fractal tree is simulated with 64 transducers as shown in Figure 2.3b. The training set uses 16 simulated trees for each of the 9 branching angle configurations DS-SIM1 to DS-SIM9 as listed in Table 2.1. The remaining simulated trees are used to construct the test set. From each tree, 10%  7 of the transducer signals are
5 The Matlab implementation NSVM by G. Fung and O. L. Mangasarian is used for the linear kernel. SVMPerf 3.0 by T. Joachims is used for the GRBF kernel.

57

CHAPTER 2. METHODS selected at random. This gives a total number of RF-line measurements in the test set of M = 4 × 9 × 7 = 252. A window size corresponding to a distance of 256µm is selected, with a step size corresponding to 128µm. This results in 64 sampling windows per transducer signal. Windows where the simulated data is all zero are dropped. Hence, the training set consists of over 10000 feature vectors. The filter level p = 6 is chosen. Each feature vector will thus have 26 = 64 features. Feature vectors corresponding to measurements from DS-SIM1 through DS-SIM3 are assigned ym = +1. Measurements from DS-SIM4 through DS-SIM9 are assigned ym = -1. The classifier is then created using the GRBF kernel (1.45) with the SVMPerf solver. The quality of the solution is related to the run-time duration of the solver. The maximum solver run-time is set to 15 minutes. To measure the output of the solver, 4 trees from the normal tissue dataset DS-SIM1 and the abnormal dataset DS-SIM8 are generated. 7 transducer signals from each tree are selected at random. Feature vectors are created according to the same process as the training set. The classifier strength (1.40) for each transducer is averaged and plotted. Results are shown in Figure 3.11. Sensitivity and Selectivity are calculated as Sensitivity = True Positives True Positives + False Negatives True Negatives Sensitivity = True Negatives + False Positives (2.7a) (2.7b)

To test if the two classes are distinguishable using (1.40), the Welsh test [103] is used to calculate Hotelling's T 2 statistic for two independent samples with unequal variances. The p-value corresponding to the T 2 statistic is also calculated. The p-value indicates the probability that the null hypothesis is true, which is that the mean classifier strength for each is class is not significantly different. If the p-value is less than 5% then it will be concluded that the null hypothesis is false and therefore the classes are distinguishable. Classification in the presence of noise For TST-C-T2 white noise is added to each

transducer signal in the test set of TST-C-T1 to examine the algorithm in the presence of noise. Signal to noise ratios +30dB, +10dB, +3dB and -3dB are used. Figure 2.9 shows a transducer signal with different signal to noise ratios. Results are plotted shown in Figures 3.12 to 3.15 Classification of Acquired 3D Data The acquired 3D data (Section 2.1.2) is tested in a C-scan configuration, to simulate an actual tissue microscopy scan. The tissue 58

2.3. CLASSIFICATION AND RECONSTRUCTION

0 0.1 0.11 0.12 0.13 0.14

SNR 30dB original

0 0.1 0.11 0.12 0.13 0.14

SNR 10dB original

0 0.1 0.11 0.12 0.13 0.14

SNR 3dB original

0 0.1 0.11 0.12 0.13 0.14

SNR -3dB original

time[µs]
Figure 2.9: Noise added to a transducer signal

datasets are 5mm × 5mm × 0.2mm in size. A laser pulse illuminates a 1.2mm × 1.2mm × 0.2mm subregion of the tissue with a gaussian fluence profile as shown in Figure 3.17a and 3.17c. 4 transducers located 0.56mm from the center of the laser detect the photoacoustic signal. To observe the ability of the 4 transducers to reconstruct the geometry, a reconstruction of an image slice is performed (Figure 3.17d). A similar reconstruction using 256 transducers is also performed (Figure 3.17e). The tissue is scanned in the x and y directions at 17 × 17 = 289 positions. Data is acquired from all 4 transducers in each scan. The matrix mode point detector is used to simulate the photoacoustic signals. The classifier is trained using 10% of the transducer signals from a 2mm × 2mm region of normal tissue and abnormal tissue. Normal tissue is assigned ym = +1, abnormal tissue is assigned ym = -1. The average classifier strength from each transducer is plotted (Figure 3.16). This is mapped into the 2D C-scan locations where the signals were obtained and plotted 59

CHAPTER 2. METHODS Test Classification TST-C-T1 TST-C-T2 TST-C-M2 TST-C-A1 DS-SIMx DS-SIMx DS-OCTx DS-SIMx Classification of simulated tissue Classification in the presence of noise Classification using Acquired 3D Data Classification using Area Detector 3.3.2.1 3.3.2.2 3.3.2.3 3.3.2.4 Datasets Description Section

Table 2.5: Classification tests performed.

(Figure 3.18). Classification using the Area Detector For TST-C-A1, the area detector is used

to test the classification algorithm. The linear SVM kernel (1.42) is used. 15 datasets for each branch angle configuration are used to train the classifier. Feature vectors corresponding to measurements from DS-SIM1 through DS-SIM3 are assigned ym = +1. Measurements from DS-SIM4 through DS-SIM9 are assigned ym = -1. The results are plotted in Figure 3.19.

60

Chapter 3

Results
This chapter provides results and output produced by the methods of Chapter 2. The results of this chapter will be analyzed and discussed in Chapter 4.

3.1
3.1.1
3.1.1.1

Validation of Photoacoustic Simulator
Finite Element Simulations
Spherical Geometry TST-V-F1 The purpose of TST-V-F1 is to examine the output of 3D FEM

3.1.1.1.1

wave simulation from a known source geometry. A 3D FEM simulation for a spherical photoacoustic source is performed according to Section 2.2.2.1.1. Figure 3.1a shows the pressure from transducer location x0 = (0, 0, 2) mm . Table 3.1 lists the computational resource usage of the simulation. An n-shape profile is observed; however, it is seen that the signal contains a high amount of noise compared to the exact solution of 3.1d.

3.1.1.1.2

TST-V-F2

The purpose of TST-V-F2 is to examine the output of 2D+AS

wave simulation from a known source geometry. The 2D+AS FEM simulation is performed according to Section 2.2.2.1.1. Figure 3.1b shows the pressure from transducer location x0 = (0, 0, 2) mm, and Figure 3.2 shows the wave propagating at several significant time instants. Table 3.1 lists the simulation computational resource usage. It is seen that the signal contains a small amount of noise and is very close to the exact solution of 3.1d. From Figure 3.2, the wave is seen to propagate radially outward at the speed of sound. 61

CHAPTER 3. RESULTS

0.4 pressure [kPa] 0.2 0 -0.2 -0.4 1 2 3 4 5 6 time [us] 7 8 9 10

(a) 3D FEM
0.4 pressure [kPa] 0.2 0 -0.2 -0.4 1 2 3 4 5 6 time [us] 7 8 9 10

(b) 2D+AS FEM
0.4 pressure [kPa] 0.2 0 -0.2 -0.4 0 2 4 time [us] 6 8 10

(c) Point Detector (Matrix Mode)
0.4 pressure [kPa] 0.2 0 -0.2 -0.4 1 2 3 4 5 6 time [us] 7 8 9 10

(d) Exact solution

Figure 3.1: Simulated pressure waveforms from a spherical photoacoustic source. An "N-shape" profile is observed. R = 1 mm. The transducer is located at x0 = (0, 0, 2) mm.

62

(a) t = 0µs

(b) t = 0.5µs

(c) t = 0.8µs

(d) t = 1.0µs

(e) t = 2.0µs

(f ) t = 4.0µs

Figure 3.2: FEM pressure wave simulation from spherical photoacoustic source. R = 1mm. If a transducer detects the pressure wave at a given spatial location, an "N-shape" waveform will be observed as in Figure 3.1b.

CHAPTER 3. RESULTS 3.1.1.2 3.1.1.2.1 Cylindrical Geometry TST-V-F3 TST-V-F3 is performed to generate the photoacoustic signal

for a finite-length cylindrical geometry as a reference to validate the simulator and the derived analytical solution. The 2D+AS FEM simulation is performed according to Section 2.2.2.1.2. Figure 3.4a and 3.4c show the pressure from sampled transducer locations. Figure 3.3 shows the wave propagating at several time instants, and Table 3.1 lists the simulation computational resource usage. There are perturbances at the tail end of the pressure signal resulting from the finite ends of the cylinder. The radiating wave propagating from the cylinder ends is seen in Figure 3.3. When z = 0.0mm the perturbances combine into a single bump, because the wave from both cylinder ends reach the transducer at the same time. Description Number of elements Degrees-of-freedom Amount of memory used Simulation time TST-V-F1 82356 115536 1131 MB 1726 min TST-V-F2 51163 102792 396 MB 108 min TST-V-F3 69572 139727 489 MB 87 min

Table 3.1: FEM Performance. CPU: Dual Core 2.00GHz Intel Pentium, 2GB RAM. OS: Windows XP 32-bit.

3.1.2
3.1.2.1

Exact Solution Validation
Exact Finite-Length Cylinder Equation The purpose of this test TST-V-E1 is to compare the derived exact solution

TST-V-E1

to the 2D FEM output and the simulator output. The analytic solution of Section 2.2.2.2 derived in Appendix B is computed and compared against output from the tree mode simulator and FEM output. Figures 3.4a and 3.4c show the pressure from sampled transducer locations. It is seen that the shape of the waveform matches the FEM solution.

3.1.3
3.1.3.1

Point Detector Simulator Validation
Tree Mode TST-V-T1 TST-V-T1 is performed to validate the tree-mode photoacous-

3.1.3.1.1

tic simulator. The output for an individual cylindrical segment is simulated using treemode simulator (Section 2.2.1.1.1) and compare result against other reference outputs. 64

(a) t = 0µs

(b) t = 0.1µs

(c) t = 0.2µs

(d) t = 0.3µs

(e) t = 0.4µs

(f ) t = 1.1µs

Figure 3.3: FEM pressure wave simulation from cylindrical photoacoustic source. L = 2mm, R = 0.1mm.

CHAPTER 3. RESULTS

0.4 pressure [kPa] 0.2 0 -0.2 -0.4 0 0.5 1 time [us] 1.5 2 FEM exact

(a) FEM and Exact Solutions. x = 0.3mm, y = 0.0mm, z = 0.1mm
0.4 pressure [kPa] 0.2 0 -0.2 -0.4 0 0.5 1 time [us] 1.5 2

(b) Tree Mode Simulator. x = 0.3mm, y = 0.0mm, z = 0.1mm
0.4 pressure [kPa] 0.2 0 -0.2 -0.4 0 0.5 1 time [us] 1.5 2 FEM exact

(c) FEM and Exact Solutions. x = 1.0mm, y = 0.0mm, z = 0.0mm
0.4 pressure [kPa] 0.2 0 -0.2 -0.4 0 0.5 1 time [us] 1.5 2

(d) Tree Mode Simulator. x = 1.0mm, y = 0.0mm, z = 0.0mm

Figure 3.4: Pressure waveforms from cylindrical source. The output from the FEM solution, the exact solution, and the tree mode simulation are compared.

66

3.2. RECONSTRUCTION The output is shown in Figure 3.4b and Figure 3.4d. The expected waveform is seen to match the reference outputs. 3.1.3.1.2 TST-V-T2 The purpose of TST-V-T2 is to examine the output from a

simple tree geometry. The output from the tree-mode simulator is produced in a linear array configuration, for a small fractal tree according to Section 2.2.1.1.1. The output is shown in Figure 3.5 and Figure 3.6. In Figure 3.5, it is seen that the orientation of a single cylinder plays a critical role in the shape of the detected waveform. To match the known equation of the infinite cylinder, the transducer must be located between the planes defining the cylinder ends. Figure 3.6 shows RF-lines produced from a single Y-shaped bifurcation and a small fractal tree. 3.1.3.2 Matrix Mode TST-V-M1 is performed to validate the matrix mode simulator. Sim-

TST-V-M1

ulation is performed according to Section 2.2.1.1.2 with a spherical source geometry. The output is compared against other reference outputs as shown in Figure 3.1c. The shape of the waveform matches the exact solution; however the n-shape profile is slightly smoother (i.e. high frequencies are filtered).

3.2
3.2.1

Reconstruction
Resolution
The purpose of TST-R-M1 is to examine the effect of the number of

TST-R-M1

transducers on resolution from backprojection. The matrix mode simulator is used on the normal OCT dataset DS-OCT1. Transducers are placed in a circular arrangement around the data. The image is reconstructed for 12, 20, 30, 40, 60, 90, 120 and 360 transducers. Output is shown in Figure 3.7. It is seen that the reconstructed image quality is reduced when fewer transducers are used. When very few transducers are used, artifacts are introduced into the reconstructed image.

3.2.2

B-mode reconstruction
The purpose of TST-R-T1 is to visualize reconstructed images from the

TST-R-T1

tree-mode simulator using a linear phased array. In this test, normal and abnormal tree datasets are simulated using the tree simulator. The simulated fractal branch iteration level range is from lmin = 8 to lmax = 12. The linear array configuration of Figure 67

(a) in linear array axis

(b) upright

Figure 3.5: Photoacoustic simulation of a single cylinder. The RF-lines from each transducer in the linear array are shown.

3.2. RECONSTRUCTION

(a) depth = 2

(b) depth = 4

Figure 3.6: Photoacoustic simulation of a small fractal trees. The RF-lines from each transducer in the linear array are shown.

69

CHAPTER 3. RESULTS

2

2

2

1 y[mm] y[mm]

1 y[mm] -2 -1 0 x[mm] 1 2

1

0

0

0

-1

-1

-1

-2 -2 -1 0 x[mm] 1 2

-2

-2 -2 -1 0 x[mm] 1 2

(a) n = 12

(b) n = 20

(c) n = 30

2

2

2

1 y[mm] y[mm]

1 y[mm] -2 -1 0 x[mm] 1 2

1

0

0

0

-1

-1

-1

-2 -2 -1 0 x[mm] 1 2

-2

-2 -2 -1 0 x[mm] 1 2

(d) n = 40

(e) n = 60

(f ) n = 90

2

2

2

1 y[mm] y[mm]

1 y[mm] -2 -1 0 x[mm] 1 2

1

0

0

0

-1

-1

-1

-2 -2 -1 0 x[mm] 1 2

-2

-2 -2 -1 0 x[mm] 1 2

(g) n = 120

(h) n = 360

(i) original

Figure 3.7: The quality of image reconstruction as number of transducers is varied. When fewer transducers are used, the ability to resolve small structures is reduced. n indicates the number of transducers.

70

3.2. RECONSTRUCTION

(a) normal tissue configuration
6 5.5 5 4.5 z [mm] 4 3.5 3 2.5 2 -4 -3 -2 -1 x [mm] 0 1 2 3 z [mm] 6 5.5 5 4.5 4 3.5 3 2.5 2 -4

(b) abnormal tissue configuration

-3

-2

-1 x [mm]

0

1

2

3

(c) normal tissue cross-section
6 5.5 5 4.5 z [mm] 4 3.5 3 2.5 2 -4 -3 -2 -1 x [mm] 0 1 2 3 z [mm] 6 5.5 5 4.5 4 3.5 3 2.5 2 -4

(d) abnormal tissue cross-section

-3

-2

-1 x [mm]

0

1

2

3

(e) normal tissue reconstruction

(f ) abnormal tissue reconstruction

Figure 3.8: Reconstructed images using phased array. (a) and (b) transducer locations showing imaging plane. (c) and (d) cross sections of imaging plane. (e) and (f ) reconstructed images using universal backprojection algorithm. n = 64 transducers. lmin = 8,lmax = 12.

71

CHAPTER 3. RESULTS

(a) normal tissue configuration

(b) abnormal tissue configuration

4 3 2 1 z [mm] 0 -1 -2 -3 -4 -4 z [mm] -2 0 x [mm] 2 4

4 3 2 1 0 -1 -2 -3 -4 -4

-2

0 x [mm]

2

4

(c) normal tissue cross-section
x 10 4 3 2 0.5 1 z [mm] 0 -1 -0.5 -2 -3 -4 -4 -1 -2 -3 -4 -4 z [mm] 0 1
6

(d) abnormal tissue cross-section
x 10 4 1 1 3 2 0.8 0.6 0.4 0.2 0 -1 -0.4 -0.6 -0.8 -1 0 -0.2
6

-2

0 x [mm]

2

4

-2

0 x [mm]

2

4

(e) normal tissue reconstruction

(f ) abnormal tissue reconstruction

Figure 3.9: Reconstructed tissue from a sparse array. (a) and (b) transducer locations showing imaging plane. (c) and (d) cross sections of imaging plane. (e) and (f ) reconstructed images using universal backprojection algorithm. n = 64 transducers. lmin = 10,lmax = 14 depth.

72

3.2. RECONSTRUCTION 2.3a is used with n = 64 transducers. Images are reconstructed using the universal backprojection algorithm (Section 1.1.4.1). A cross-section of the 3D image, showing what a perfect reconstruction would look like is shown in Figure 3.8c-d Output is shown in Figure 3.8e-f. It can be observed that artifacts from out of plane vessels enter the image plane. It appears that vessels oriented in particular directions do not get reconstructed as well as other vessels. TST-R-T2 The purpose of this test is to visualize reconstructed images from tree-

mode simulator using a sparse 2D planar array configuration. Normal and abnormal tree datasets are simulated using the tree simulator. The simulated fractal branch iteration level range is from lmin = 10 to lmax = 14. The 2D planar array configuration of Figure 2.3b is used with n = 64 transducers. Images are reconstructed using universal backprojection (Section 1.1.4.1). A cross-section of the 3D image, showing what a perfect reconstruction would look like is shown in Figure 3.9c-d. Figure 3.9 show the reconstructed images. It appears that vessels are not properly reconstructed due to the sparseness of the array.

0

0

0.5

1

1.5

2 time [us]

2.5

3

3.5

0.5

1

1.5

2 2.5 time [us]

3

3.5

4

(a) normal tissue signal
200 180 160 140 frequency [MHz] 120 100 80 60 40 20 0 0.5 1 1.5 2 time [us] 2.5 3 3.5 frequency [MHz] 200 180 160 140 120 100 80 60 40 20 0 0.5

(b) abnormal tissue signal

1

1.5

2 2.5 time [us]

3

3.5

4

(c) normal tissue spectrogram

(d) abnormal tissue spectrogram

Figure 3.10: Spectrogram of an RF signal from tissue simulated with a fractal tree. (a) and (b) show the RF signal of normal and abnormal tissue. (c) and (d) show their spectrograms.

73

CHAPTER 3. RESULTS

3.3
3.3.1
3.3.1.1

Classification
Frequency Domain Methods
Simulated Data

TST-C-S1 The purpose of TST-C-S1 is to examine the spectral properties of vascular tissue. The spectrogram and frequency response (Section 2.3.2) are computed for simulated data. Figure 3.10 shows the spectrogram of photoacoustic RF signal generated from normal and abnormal vascular tissue. From Figure 3.10, it is not apparent whether there are clear differences in the spectral signals for the simulated tissue.

3.3.2
3.3.2.1

WPD Feature Vector
Performance of the Classification Algoirthm In TST-C-T1, the performance of the classification algorithm is tested.

TST-C-T1

Tissue is simulated and classified according to the procedure outlined in Section 2.3.2.3. Sensitivity and selectivity metrics are calculated according to (2.7) and provided in Table 3.2. To test if the classifier is able to detect a significant difference between each cases, the T 2 test for two independent samples with unequal variances and the corresponding p-value are calculated. Figure 3.11 shows the performance of the classifier for four separately generated trees of healthy and abnormal tissue. The average classifier strength for the transducer signals is indicated by the height of the bar graph. For the tested datasets, the classifier is able to distinguish between normal and abnormal tissue well. Some abnormal tissue is weakly characterized as normal tissue. The p-value shows that there is a low probability that resulting difference is not significant. SNR Original +30 dB +10 dB +3 dB -3 dB TN 22 24 25 0 0 FP 6 4 3 28 28 FN 1 1 11 0 0 TP 27 27 17 28 28 Sensitivity 96.4% 96.4% 60.7% 100% 100% Selectivity 78.6% 85.7% 89.2% 0% 0% T2 16.88 104.77 20.16 2.64 0.00 p-value 0.0039% 0.0000% 0.0007% 10.4134% 100.0000%

Table 3.2: Sensitivity and selectivity of the classifier. The T 2 test for two independent samples with unequal variances and the corresponding p-value are calculated. The p-value indicates the probability that the two classes have no classifiable difference. A p-value less than 5% will indicate a statistical significance.

74

3.3. CLASSIFICATION 3.3.2.2 Performance in the Presence of Noise In TST-C-T2, it is examined how the classifier performs when noise is

TST-C-T2

introduced into the signal. The signals in the test set from TST-C-T1 are have white noise added to give SNR ratios of +30dB, +10dB, +3dB and -3dB as described in Section 2.3.2.3. Sensitivity and selectivity metrics are calculated and shown in Table 3.2. Figure 3.12, Figure 3.13, Figure 3.14 and Figure 3.15 plot bar graphs of the classifier strengths for the noisy signals from TST-C-T1. To test if the classifier is able to detect a significant difference between each cases, the T 2 test for two independent samples with unequal variances is calculated. It can be seen the classifier performs well in small amounts of noise (Figure 3.12 and Figure 3.13). As the noise increases, the performance is reduced. At +10dB SNR, some normal tissue is weakly classified as abnormal. At +3dB SNR, the classifier cannot detect any abnormal tissue. The p-value shows that the resulting difference has a high probability of being not significant for +3dB and -3dB. The result is significant for +30dB and +10dB.
True Negative:22, False Positive:6 0.6 0.4 0.2 0 -0.2 -0.4 0.6 0.4 0.2 0 -0.2 -0.4 False Negative:1, True Positive:27

5

10

15 (a) 25° to 27°

20

25

5

10 15 20 (b) 25° to 140°

25

Figure 3.11: Classification of photoacoustic signal in test set for TST-C-T1. Four fractal trees of each tissue type were generated. Seven transducer classification are shown for each tree. A positive test result (classification strength less than zero) indicates that the test detects abnormal tissue, and a negative test result (classification strength greater than zero) indicates that abnormal tissue was not detected. Branch angle distribution for (a) normal tissue (b) abnormal tissue.

3.3.2.3

Classification of Acquired 3D Datasets

TST-C-M1 Classification of Acquired 3D Datasets The purpose of this test is to simulate the classifier on photoacoustic signals obtained in a C-scan mode. The transducer is scanned across many positions in the xy plane and at each position, a subregion of the tissue is illuminated using the profile of Figure 3.17a. 75

CHAPTER 3. RESULTS
True Negative:24, False Positive:4 0.6 0.4 0.2 0 -0.2 -0.4 0.6 0.4 0.2 0 -0.2 -0.4 False Negative:1, True Positive:27

5

10

15 (a) 25° to 27°

20

25

5

10 15 20 (b) 25° to 140°

25

Figure 3.12: Classification of simulated tissue with 30dB SNR on data from Figure 3.11.
True Negative:25, False Positive:3 0.6 0.4 0.2 0 -0.2 -0.4 0.6 0.4 0.2 0 -0.2 -0.4 False Negative:11, True Positive:17

5

10

15 (a) 25° to 27°

20

25

5

10 15 20 (b) 25° to 140°

25

Figure 3.13: Classification of simulated tissue with SNR=10dB on data from Figure 3.11.

Signals are recored from 4 transducers at each position. The classifier is trained and tested as described in Section 2.3.2.3. The average classifier strength from each spatial position in the C-scan is plotted to form a parametric images as shown in Figure 3.16. The test setup is described in Figure 3.17. Figure 3.18 shows a 2D C-scan style plot of the classifier strength. This shows that the abnormal tissue is discriminated from the normal tissue. Figure 3.17d and Figure 3.17e show that when only 4 transducers are used, the ability to reconstruct a 2D slice of tissue is not possible, although when 256 transducers are used the vasculature can be reconstructed. To test if the classifier is able to detect a significant pattern between the two cases, the T 2 test for two independent samples with unequal variance is calculated to be T 2 = 1259.9. This corresponds to a p-value of 0.00% which shows that the datasets of Figure 3.16 are significantly different.

76

3.3. CLASSIFICATION
True Negative:0, False Positive:28 0.6 0.4 0.2 0 -0.2 -0.4 0.6 0.4 0.2 0 -0.2 -0.4 False Negative:0, True Positive:28

5

10

15 (a) 25° to 27°

20

25

5

10 15 20 (b) 25° to 140°

25

Figure 3.14: Classification of simulated tissue with SNR=3dB on data from Figure 3.11.
True Negative:0, False Positive:28 0.6 0.4 0.2 0 -0.2 -0.4 0.6 0.4 0.2 0 -0.2 -0.4 False Negative:0, True Positive:28

5

10

15 (a) 25° to 27°

20

25

5

10 15 20 (b) 25° to 140°

25

Figure 3.15: Classification of simulated tissue with -3dB SNR on data from Figure 3.11.
Negative:1150, Positive:6 Negative:678, Positive:478

10

10

5

5

0

0

-5 200 400 600 normal 800 1000

-5 200 400 600 abnormal 800 1000

Figure 3.16: Classification Strength Acquired 3D data. Data is plotted in the order obtained from C-scan in the xy plane. This data is used to create the parametric images in Figure 3.18.

77

CHAPTER 3. RESULTS

0 0.05 0.1 0.15 -0.6 -0.4 -0.2 0 mm 0.2 0.4 0.6

0.8 0.6 0.4 0.2

mm

(a) Gaussian pulse profile (side view)

0.6 0.4 0.2 y[mm] 0 -0.2 -0.4 -0.6 -0.5 0 x[mm] 0.5 y[mm]

0.6 0.4 0.2 0 -0.2 -0.4 -0.6 -0.5 0 x[mm] 0.5

(b) 1.5 × 1.5mm2 tissue region. depth = 0.1mm.

(c) illuminated by Gaussian profile

0.6 0.4 0.2 y[mm] 0 -0.2 -0.4 -0.6 -0.5 0 x[mm] 0.5 y[mm]

0.6 0.4 0.2 0 -0.2 -0.4 -0.6 -0.5 0 x[mm] 0.5

(d) reconstruction. n = 4 transducers.

(e) reconstruction. n = 256 transducers.

Figure 3.17: Reconstruction and setup of OCT data test. Figure (a) shows the Gaussian optical illumination profile used to illuminate a 3D tissue subregion. Figure (b) shows a 2D cross-sectional slice of the 3D region. Figure (c) shows the initial pressure at t = 0 generated by the Gaussian shaped optical heating profile. Figure (d) shows the attempted reconstruction of the 2D slice when 4 transducers (directly above the circular artifacts) record the data from the region. Figure (e) shows the reconstruction when 256 transducers record the data.

78

3.3. CLASSIFICATION

-2.5 -2 -1.5 -1 -0.5 mm 0 0.5 1 1.5 2 2.5 -2 -1 0 mm 1 2 mm

-2.5 -2 -1.5 -1 -0.5 0 0.5 1 1.5 2 2.5 -2 -1 0 mm 1 2

(a) Normal Tissue Slice. depth = 0.875mm.

(b) Abnormal Tissue Slice. depth = 0.875mm.

-2

-2

-1 y[mm] 0 y[mm] -2 -1 0 x[mm] 1 2

-1 0

1

1

2

2 -2 -1 0 x[mm] 1 2

-3

-2

-1

0

1

2

3

-3

-2

-1

0

1

2

3

(c) Classifier Strength on Normal Tissue

(d) Classifier Strength on Abnormal Tissue

Figure 3.18: Classification of acquired 3D data. Figures (a) and (b) show 2D crosssectional slices of the of the dataset projections of Figure 1.3 (post-thresholding). (c) and (d) parametric images of classifier strength (Figure 3.16) applied to photoacoustic signals from C-scan of the 3D tissue as described in Figure 3.17. There were 289 C-scan regions simulated, each recorded data with 4 transducers. The classifier was trained on a subset of the recorded data from each tissue type.

79

CHAPTER 3. RESULTS 3.3.2.4 Area Detector Area detector

TST-C-A1

In TST-C-A1, the classifier strength using the linear kernel is examined. Simulations using the area detector are performed according to Section 2.3.2.3. Simulated test sets DS-SIM1 to DS-SIM9 are used. The results are shown in Figure 3.19. It appears that there is a trend for the classifier strength to be lower as the tissue becomes more abnormal.
2 0 -2 -4 -6 -8 (a) 25° to 27° 2 0 -2 -4 -6 -8 (b) 25° to 30° 2 0 -2 -4 -6 -8 (c) 25° to 35°

2 0 -2 -4 -6 -8 (d) 25° to 45°

2 0 -2 -4 -6 -8 (e) 25° to 60°

2 0 -2 -4 -6 -8 (f) 25° to 80°

2 0 -2 -4 -6 -8 (g) 25° to 100°

2 0 -2 -4 -6 -8 (h) 25° to 140°

2 0 -2 -4 -6 -8 (i) 25° to 160°

Figure 3.19: Classifier strength using the area detector. Five trees from each tree configuration (DS-SIM1 to DS-SIM9) were tested. The x-axis shows the classifier strength for each sliding window position. Vertical lines separate each tree in each configuration.

80

Chapter 4

Discussion and Analysis
This chapter discusses and analyzes the results of Chapter 3.

4.1

Classification

Performance of classification algorithm
The classification algorithm is tested on the simulated tissue model, and on the acquired 3D data model which is based data acquired from real tissue. From Figure 3.11 it can be seen that a classifier can be constructed that will discriminate between photoacoustic signals of the normal and abnormal tissue models. Figures 3.12-3.15 examine the effects of white noise on the signals. It can be seen from Table 3.2 that noise reduces the performance of the algorithm. With no noise the classifier performs with a sensitivity of 96.4%, a selectivity of 78.6% and a p-value of 0.0039%. With a SNR of +30dB the classifier performs with a sensitivity of 96.4%, a selectivity of 85.7% and a p-value of 0.0000%. With a SNR of +10dB the classifier performs with a sensitivity of 60.7%, a selectivity of 89.2% and a p-value of 0.0007%. However, when the SNR is only +3dB the classifier performance is greatly reduced with a sensitivity of 100%, a selectivity of 0% and a p-value of 10.4%. At -3dB the classifier performs with a sensitivity of 100%, a selectivity of 0% and a p-value of 100%. The classifier is designed to give a positive test result if abnormal tissue is detected. If abnormal or unknown tissue is detected, the result from the classifier is positive. This was achieved because the bias of the classifier (b in equation (1.40)) has a value skewed towards abnormal tissue. This can be seen from Figure 3.15, where there is so much noise in the signal that unbiased classifier does not detect if the tissue is normal or abnormal. If the bias term was equal to zero in this case, then  would be close to zero. However, 81

CHAPTER 4. DISCUSSION AND ANALYSIS due to the bias  approaches -0.55 as shown in Figure 3.15. When the noise is added to the signal, the classifier is able to perform properly, making more false positives and false negatives. There is room improvement in the classifier. The SVM was allowed to search for a decision function for only a short time, so the classification strength is not as good as it could be. Also, the chosen wavelets, the window size, the step size, chosen wavelet packet filter basis, and the training set could be improved upon to generate a more accurate classifier by further fine-tuning. The simulated tissue may also be less discriminatable in some ways than for an actual in-vivo case. In real tissue, there may be large differences in geometry (see Figure 3.18ab) and blood oxygenation (see Figure 1.2c) which would likely help the performance of the classifier. To test the simulations on a more realistic tissue geometry, 3D OCT datasets were used. Figures 3.18 and 3.16 show that the a classier can be constructed able to detect abnormal tissue. As seen in Figure 3.18, a 2D parametric image can be created that used the classifier. Although only two datasets for 3D geometry were available, the classifier performs well to discriminate between them as seen from Figure 3.18. It should be noted that even though the tissue can be discriminated using there RF data, there is insufficient information to resolve the vascular structures as shown in Figure 3.17ad. The classification method outlined in Section 2.3.2 is able to adapt to many different types of input signals. It simply requires a training set to learn from, and detectable differences in the signal. Furthermore, although the basic SVM mechanism is used to discriminate only between two categories, multiple classifiers can be combined and used to discriminate between multiple categories. From equation (2.5), it is seen that the windowing does not need to be done until after the WPD is performed. This is computationally advantageous because it allows the filter tree structure of Figure 1.7 to be used once per RF-line and not once per feature vector. In addition, the approach uses a sliding window on the envelope of the DTCWPD [17] signals, which may be a new approach to feature vector generation. The large area integrating transducer model was also used to classify photoacoustic signals from vasculature. The model was tested as the branching angle was varied from healthy tissue to abnormal tissue for 9 different classes. Figure 3.19 shows that as the tissue becomes more abnormal, the classifier strength also follows this trend. The large area transducer model will be discussed further in Section 4.3 and Section 4.6. 82

4.2. VASCULAR TISSUE MODEL

Spectral Methods
Frequency domain methods are common for ultrasound tissue classification [11, 15, 84]. The performance of spectral methods were not formally tested in this thesis. Initial attempts to use spectral methods indicated that the frequency domain power spectra of the of the simulated normal and abnormal tissue models were similar. Figure 3.10 shows the spectrogram of a normal and abnormal simulated tissue signal. Although a frequency domain approach may have been able to detect differences in the fractal tissue model, the applicability the method would need to reevaluated for each type of tissue that was classified. It was not expected that the method would be applicable to any tissue besides kidney, since the fractal parameters were based on kidney tissue. The approach of Section 2.3.2 is flexible enough to detect many sorts of differences when they exist. Nonetheless, wavelet packets can be expressed in the frequency domain, although the method is very different from common frequency domain methods.

4.2

Vascular Tissue Model

The vascular tissue models are now discussed. Fractal trees are able to approximate specific tissue types to a considerable degree of realism. However, this is only an approximation of actual vascular geometry. Healthy kidney tissue, in particular, obeys a highly regular fractal pattern that can be modeled closely [3]. It may be an oversimplification, however, to assume that the fractal pattern holds across all scales. Further simulation could be done where the tissue model incorporates changing morphological parameters at each scale. Pulmonary tissue, which also has a highly fractal structure, is much less suitable for photoacoustic study because acoustic waves can not propagate freely into the air that flows through this type of tissue. Vessels in other tissue types also obey fractal laws, but may have a higher degree of randomness and less regular branching intervals; however, the space filling properties are fractal [13, 14]. Other types of tissue have branching patterns that have been characterized and may be simulated by the methods presented in this thesis. For example, the morphological branching parameters of colon endothelial tissue, is characterized by Konerding et al. [66]. This type of tissue could be suitable for clinical photoacoustic probing as it is more accessible than kidney tissue. Since the penetration depth of photoacoustic imaging is limited, to access kidney tissue in-vivo may require an intra-venous photoacoustic probe [27], although there still may be some difficulty imaging an entire kidney away from large vessels. Ideally, the methods used in this thesis would be applicable to detecting cancers 83

CHAPTER 4. DISCUSSION AND ANALYSIS via micro-vascular structures in skin or endothelial tissue which are accessible; or for analyzing signals of larger vessels and larger tumors deep within tissue that cannot be fully resolved using a linear array. Histological slides are also used to characterize tissue based on fractal patterns [13, 14, 64, 87]. As will be discussed in Section 4.6, the fractal dimension of the 3D tissue should relate to the fractal dimension of a 1D photoacoustic signal. In real tissue the spatial positioning of the vessels follow a probability distribution. If the simulated tissue closely approximates this distribution, the model could be considered statistically accurate for photoacoustic purposes. Since it is difficult to duplicate this statistical distribution using mathematical models, an acquired 3D dataset was used to provide more realistic geometry as input to the classification algorithm. As an alternative, the method of Wolbarst and Hendee [21] could be used to generate more accurate vascular models, however it is more convenient to use the acquired 3D datasets. Instead of using models of OCT data, acquired data from photoacousitc microscopy could have been used. In this case, the dataset would have not been called a model, but rather, experimentally obtained in-vivo measurements. The OCT datasets were chosen due to their availability and because of their high image contrast and resolution. By using simulated signals, the effects related to vessel geometry are isolated from other tissue effects; hence, the analysis is on the structural morphology of the issue, and not on functional parameters such as blood volume and oxygen saturation. Although photoacoustic signals generated from real tissue in-vivo are expected to be significantly different from tissue models, the classification methods of Section 2.3.2 can still be applied to in-vivo photoacoustic signals. In fact, other parameters that vary in the normal and abnormal classes of real tissue such as blood oxygenation, vascular density, etc. (see Figure 1.2c) should actually help the classifier algorithm's performance, by imposing further differences in the signals. This may enhance existing photoacoustic systems, especially multi-wavelength systems, which are already able to detect regions of suspicious tissue to a limited degree.

4.3

Wave Propagation

The wave propagation from the simple geometries and from the vascular trees are now discussed. 84

4.3. WAVE PROPAGATION

2D Acoustic wave profiles
Figure 3.2 shows propagating acoustic waves at several time instants for the spherical source geometry. It is instructive to observe how the n-shaped profile of Figure 3.1 results when a point detector is located at a fixed position outside of the absorbing sphere. Figure 3.3 illustrates the wave propagation from a finite-cylinder. This figure shows why there is a perturbance at the tail end of the plot in Figure 3.4. It can also be seen that that when the point detector is located between the planes capping the cylinder ends, the wave propagates according to the infinite-cylinder equation; the finite-cylinder ends, however, radiate outward and interfere with the pressure wave which is the detectable perturbance at the tail end of the signal.

RF-lines
The RF-lines from a linear phased array transducer are simulated in Figure 3.8 and Figure 3.9. In comparing Figure 3.8c and Figure 3.8d, it can be seen that the orientation of a finite cylinder plays a critical role on the recieved photoacoustic signal. This can also be concluded from Figure 3.3. Only when the cylinder is oriented in a particular way does the waveform resemble the infinite-cylinder case. This may also be related to an effect seen in Figure 3.8 where cylindrical segments of particular orientations do not get reconstructed well. Figure 3.6 shows the RF-lines produced by small fractal trees. These also show that the photoacoustic signals are dependent on the orientation of the fractal trees.

Forward Solution Simulations
The simplified photoacoustic model of equation (1.3) is now analyzed. Here, the laser pulse is modeled an instantaneous impulse. This is not true for any laser; however, high powered lasers with shorter pulse-widths and high repetition rates suitable for photoacoustic imaging are continually improving, becoming less costly and more available. Hence, this approximation continues to better represent actual imaging devices. To model a non-instantaneous laser pulse, the time-domain photoacoustic signal must be convolved with the temporal laser pulse profile as in (1.5). Hence, if the laser pulse profile is known, it is not difficult to deal with non-ideal laser pulse profiles in simulation. Thermoelastic confinement is also dependent on the pulse duration of the laser. This changes with the resolution requirements of the geometry being imaged; however, it is not difficult in practice to choose a laser with short enough pulse duration that thermal confinement will be obeyed for the necessary scale and frequency range being imaged. 85

CHAPTER 4. DISCUSSION AND ANALYSIS The acoustic parameters are assumed to be homogeneous in the simulation. This assumption is reasonable because there is much less acoustic impedance between blood vessels and other tissue compared to the optical contrast. In pulse-echo ultrasound imaging, there is little contrast from blood except when imaging flow using Doppler or when ultrasound contrast agents are used. Minor acoustic inhomogeneities would cause minor perturbations in the pressure wave, however the main incident wave is expected to change only slightly. It is expected that the SVM training mechanism will be able to account for any such changes if necessary. It would be possible to using the heterogeneous wave equation (1.9) for simulating tissue, however the size of the simulation for 3D models, and the solution speed was not practical for this analysis. The K-Wave Toolbox1 [104] was examined as a method to simulate dispersion and heterogeneity; however, it was found that these simulations would be computationally intensive compared to the simpler methods of this study. The effect of dispersive and frequency dependent attenuation in tissue was not modeled in this thesis. The dispersive k-space models of Treeby and Cox [34] from equation (1.11) would allow the simulation of 3D tissue for approximately modeling tissue-realstic dispersion.

4.4

Validation of Photoacoustic Simulations

To validate the photoacoustic simulations, the simulator output is compared against other references. These references include the exact-solutions and also FEM simulations for simple spherical and cylindrical source geometries.

FEM Simulations
The FEM model is implemented as a transient simulation of an acoustic pressure wave propagating from an initial source distribution. This is different from FEM (or FDM) simulations that are implemented using phasors in a time-harmonic analysis to model the steady-state behaviour of an acoustic system. Time-harmonic analysis is useful for simulating transducer field profiles or the frequency responses of ultrasound contrast agents, for example. In general, time-harmonic analysis involves a steady-state sinusoidal frequency domain input. The amplitude and phase at each spatial position for the resulting steady-state sinusoidal output is what is calculated. By performing the time-harmonic analysis over many frequencies, the frequency response of a system can be found.
1

K-Wave Toolbox, B. E. Treeby and B. T. Cox, 2009

86

4.4. VALIDATION OF PHOTOACOUSTIC SIMULATIONS For the transient FEM simulations performed in this thesis, the time-domain pressure solution at each FEM node is computed in successive time-steps. The accuracy of the solution is reduced with time as errors accumulate2 at every time step. By reducing the duration of each time-step, the solution accuracy will increase, but the simulation run-time will also increase. Using a higher number of elements (i.e. a finer mesh) in the simulation increases the accuracy of the solution; however, adding more elements will also increase the simulation run-time, and the amount of memory required for the simulation. To ensure that the FEM simulator is itself generating accurate output, the spherical source geometry is used. The photoacoustic signal produced from a spherical absorber has a well known exact solution (see 2.3). Figure 3.1 compares the output for several simulations of spherical absorbers. It is apparent in Figure 3.1a that the output of the 3D FEM simulation TST-V-F1 had a poor signal-to-noise ratio (i.e. the output was corrupted with errors). This is not a limitation of the method itself, but a limitation of the computational resources that were available to run the simulation (see Table 3.1). With the computational resources at hand, it would be a challenge to improve the accuracy from the 3D simulator to a level that would be sufficient for further validation of the photoacoustic simulators. FEM simulation using 2D+AS for models with axial symmetry in TST-V-F2 and TST-VF3 produces much more accurate results (see Figure 3.1b). For this reason 2D+AS FEM model was used to validate the wave propagation from the finite-length cylindrical source. The major limitation of the 2D+AS simulations is that models must have axial symmetry. This prevents simulation of bifurcating (Y-shaped) vessels, or larger trees which do not have axial symmetry. However, the Green's function solution to the photoacoustic wave equation (1.4b), obeys the principles of linear superposition. This means that the photoacoustic wave produced by a system with many separate absorbers is the sum of the contributions from each absorber treated separately. Thus, (assuming regions of overlap are not counted more than once) the photoacoustic signal for the complete fractal tree can be calculated by adding together the contribution of each cylindrical segment. Hence, validation of the large fractal tree simulator follows from the validation of individual finite-length photoacoustic segments. The effect of overlap between segments in the fractal tree simulator could be handled by further expanding on the simulation algorithm; however, these effects are assumed to be much less prominent than using a fractal tree as an approximation for real tissue in
2 FEM Solvers usually ensure that the accumulated error is bounded and can produce estimates on the maximum overall error. They may also automatically choose the optimal time stepping interval.

87

CHAPTER 4. DISCUSSION AND ANALYSIS the first place. In comparing the 2D+AS model (Figure 3.1b), the matrix mode point detector (Figure 3.1c), and the exact solution (Figure 3.1d) the output indicates that these models are behaving as expected, and successfully pass validation testing. The tree-mode point detector simulation is compared against the exact solution for the finite cylinder and the 2D+AS FEM solution in Figure 3.4. These plots also demonstrate matching output and therefore also successfully pass validation testing.

Exact Solutions
The N-shape profile produced by the exact solution for the photoacoustic pressure signal from a spherical optical absorber (Figure 3.1d) is well known [102, 105]. The exact solution for a finite-length solid cylindrical photoacoustic source is less well understood. It is known that this problem has no closed form solution in terms of basic mathematical functions. Photoacoustic wave propagation from infinite cylinders has been well studied [53, 102, 105]. Hoelen and Mul [102] used approximations for signals from non-solid infinite cylinders with axially symmetric absorption profiles to model blood vessels. The finite-length photoacoustic cylinder problem was studied by Remillard [106] where the sound propagation from a bolt of lightening was modeled as a cylindrical source. It was noted that the solution was elliptical, and could be calculated by numerical methods capable of solving elliptic equations. A far-field approximation was also provided in [106] to account for the effects from the cylinder ends. Plots resembling Figure 3.4 were produced. Accordingly, it was not a necessity to reduce the photoacoustic finite-cylinder in terms of elliptic integrals to generate output for this thesis; however it may be of significant interest, in particular for finding better approximations to the finite-length cylindrical source problem, for improving their speed of calculation, analyzing asymptotic cases, or in cases where reduced form exact solutions are needed. In terms of other related problems, ultrasound scattering from a finite-length cylinder has been studied by Ye [107], Williams et al. [108], Stanton [109], South [110] and several others. Many of these problems investigate other processes such as the vibration modes of the cylinder and the effects pertaining to the incident ultrasonic waves; It is possible that in one of these studies, the mathematics for solving the exact finite-length phototoacoustic cylindrical source problem were encountered as a sub-problem; however, the direct solution of the photoacoustic source problem does not appear to be explicitly isolated or mentioned. 88

4.5. RECONSTRUCTION The finite-length cylindrical antenna (the exact wire-kernel problem) is a well studied problem in electromagnetics. It is related to the solid finite-length photoacoustic cylinder problem; however, in a electrical conductor the current travels at the surface of the cylinder, and the problem involves the potential and not its derivative. Hence, the electromagnetic problem is akin to finding the photoacoustic velocity potential of a finitelength cylindrical shell and not a solid cylinder. The exact solution for this problem was first found by Wang [111] in the frequency-domain. Further methods for evaluating it have been explored by Werner [112]. Davies and Duncan [113] analyzed the stability of the time domain solution and it was shown to be stable; however, there still remain open questions involving stability requirements on the continuity of the inputs for generating well-posed solutions. Stability and numerical analysis for the photoacoustic problem is also not performed in this thesis. Further reduction of the formulation in Appendix B will have to be done for asymptotic cases where number get very large or small. It is difficult to judge the significance of reducing the finite-cylinder problem to terms of elliptic integrals. Nevertheless, the method used does appear to be a new approach and may lead to further insight on the problem. As a second result, the solution of the infinite cylinder problem is put in terms of complete elliptic integrals which appears to be a new presentation.

4.5

Reconstruction

Number of Transducers
In general, as the number of sampled transducer locations becomes increasingly sparse, it becomes more difficult to maintain high image resolution. This is apparent from Figure 3.7, where transducers are located in a circular arrangement around a thin threedimensional photoacousitc source. As the number of transducers is reduced, the resolution is greatly decreased. The effect is also seen in Figure 3.17 where 4 transducers are not enough to reconstruct a slice of tissue, however 256 transducers will reconstruct it. The relationship relating the number of transducers to the maximum image quality apparently still has many questions in photoacoustic imaging [40]. There is however known relationships relating the transducer bandwitdh, and the aperature size (and even the uniqueness of reconstruction based on transducer positionings) to the maximum achievable resolution [40, 55, 56]. As mentioned in Section 1.1.4.2, the power of the side lobes is inversely proportional to the number of transducers [33]. Studies have also been performed on limited view photoacoustic tomography where the transducer do not 89

CHAPTER 4. DISCUSSION AND ANALYSIS encircle the entire object [50]. The relationship between the number of transducers and the image resolution is important for this thesis because the performance of the classifier is being evaluated on sub-resolution image structures. When too few transducers are used, low image resolution will result, however that the classifier may still differentiate between tissue, even when the images formed have too low of a resolution to be distinguishable.

Tissue Reconstruction
Figure 3.9 shows reconstruction for a sparse array of transducer points. In Figure 3.9ef, the vessels are not resolvable because the transducers are too sparse. However, the classification algorithm is still able to classify the tissue for the configuration shown (see Figure 3.11). Figure 3.8 shows a reconstruced image 2D slice where the transducers are packed more densely. It is possible to make out the structures in this case (note: for this simulation the vascular structures are larger because lmin and lmax simulate different vessel iteration levels). Figure 3.8 examines the effects of reconstructing 2D image plane from 3D tissue using linear array. Artifacts related to the out-of-plane 3D geometry are introduced into the reconstructed image. Out-of-plane cylindrical segments are seen to enter into the reconstructed plane. The orientation of the cylindrical segments also affects how well they are reconstructed. Segments lying perpendicular to the linear array do not appear well reconstructed compared to the other segments. This may be related to the orientation dependent phenomenon noted in Figure 3.5. In Figure 3.9 the effect of a sparse planar 2D transducer array is examined. This configuration was used for the classifications performed in Section 2.3.2. In the reconstructions, there is no visual indicator to distinguish normal and abnormal tissues. However the classifier is able to distinguish the tissues in these sets. The streaks in the image are artifacts related to the sparse transducers arrangement.

Reconstruction as an Optimization Problem
It is possible that other reconstruction methods [10, 29] may perform better reconstruction than backprojection, although it is likely that the simulated details are too small even for these methods. High-frequency attenuation in tissue also will prevent small details from being imaged at depth (this attenuation was not modeled in this thesis). The compressive sensing approach of Provost and Lesage [10] involves large computational resources to maximize an optimization problem to find the best fit image for the 90

4.6. FRACTAL CONSIDERATIONS observed data. This can result in a higher resolution than backprojection [9]. The limits to this are not endless, however. For example if only one transducer was used, the image could not be reconstructed; however, using a single transducer the algorithm may be able to find the position and orientation of a known object following certain constraints.

Frequency-response and field-profile
Photoacoustic signals can contain information with high frequency content resulting from the laser impulse. This is not generally true in standard ultrasound because the pulseecho response of tissue is nearly linear, so the frequency spectrum of the back-scattered signal is proportional to the frequency spectrum of the band-pass transmit pulse. Transducer frequency-response and field-profile are the main constraints on the smallest observable feature for a particular transducer as determined by equation (1.16). Since transducer sparsity does not effect the frequency content of an individual transducer signal, the same small spatial details may be captured, although not necessarily localized. However, the SNR would also be further reduced in this case, but this could be partly remedied by averaging signals from multiple laser firings.

4.6

Fractal Considerations

In frequency domain analysis using Fourier methods, periodic signals have distinct properties. An expectation of this study was that the highly regular fractal pattern in the structural morphology of blood vessels would lead to photoacoustic signals with distinct frequency domain characteristics. Additionally, wavelet multi-resolution analysis analyzes signals at different scales; so a spatial distribution with fractal properties would be expected to produce photoacoustic signals that can be readily analyzed by wavelet methods. One interesting observation in the mathematics for the area detector model (equation 1.14) is that it may be possible to relate the 3D fractal dimension directly to the 1D photoacoustic signal. Fractal dimensions, which are commonly used for the characterization of tissues in 2D histological slides [14, 64, 87, 114], can thus relate directly to photoacoustic signals. It is common to model tissue as fractional Brownian motion or a fractional Brownian sheet [12]. If it is assumed that the 2D slides can be modeled this way then 1.14 can be used with stochastic calculus [115] to integrate over a 2D plane at a depth of ct to calculate the 1D photoacoustic fBm signal. Alternately, the stochastic wave equation [116, 117] could be used to find the expected 1D photoacoustic signal from tissue modeled as a 3D fBm. 91

CHAPTER 4. DISCUSSION AND ANALYSIS

4.7

Wavelets in Photoacoustic Imaging

Wavelets are a common method for tissue classification; however they are starting to be used more in image reconstruction. [10] use the compressive sensing approach which makes use of wavelet representations of the reconstructed image. The approach described by Vonesch and Unser [118] will likely speed up this process significantly. Radial wavelets may find use in photoacoustic imaging for reconstruction and classification. The work of Rauhut and Rosler [119] and Cui and Peng [120] develop radial wavelets and discusses their relationship with the spherical-mean transform. Since the spherical-mean transform is related to the photoacoustic pressure, the mathematics described are relevant toward photoacoustic (and ultrasound) imaging. The relationship between wavelets operating on photoacoustic RF-lines and their corresponding representation as 3D spatial radial wavelets can be deduced from these techniques. The spatial profile of each wavelet packet from equation (1.33) could thus be calculated. The radial wavelets of Cui and Peng [120] and Rauhut and Rosler [119] only span the space of 3D radial functions, and not the entire space of integrable 3D functions. Romero et al. [121] discusses conditions for radial wavelet bases that span the entire set of integrable 3D functions. The mathematics of Rauhut and Rosler [119] may yield useful relationships in photoacoustics for the wavelets of Romero et al. [121]. Steerable wavelets are also an emerging trend in signal processing. Unser and Ville [122] develops a methodology for creating a steerable wavelet basis from any single radial wavelet. It may be possible to combine these steerable wavelets with the methods of Donoho [123] to produce highly effective algorithms for photoacoustic (and ultrasound) image reconstruction. Similar techniques have been already been used in CT reconstruction algorithms. Steerable wavelets in CT reconstruction make use of the relationship between the Radon transform and the Riesz transform, which is described by De Knock [124]. De Knock [124] also discusses further mathematics regarding the spherical-mean transform useful to steerable wavelets.

92

Chapter 5

Conclusion
5.1 Conclusions

In this work, a method was put forward for the classification of photoacoustic signals. It has been shown that the method has the potential to distinguish between different classes of detectable signals. Based on simulations, the method is able to detect the differences between normal and abnormal vasculature based on structural morphology. Simulations have shown that as the tissue becomes more abnormal, the classifier discriminates tissue more strongly. In addition, the classifier performs well even when the individual vessels of the tissue cannot be resolved. The performance of the classifier has been characterized in the presence of noise using RF data from seven transducers. With a SNR of +30dB the classifier performs with a sensitivity of 96.4%, a selectivity of 78.6% and a p-value of 0.0000%. With a SNR of +10dB the classifier performs with a sensitivity of 60.7%, a selectivity of 89.2% and a p-value of 0.0007%. However, when the SNR is only +3dB the classifier performance is greatly reduced with a sensitivity of 100%, a selectivity of 0% and a p-value of 10.4%. A p-value of less than 5% indicates that there is a statistical significance whereby the null-hypothesis can be rejected. The classifier is able to learn from a set of example signals what the difference between classes are. It is thereby able to adapt to different situations for other tissue classification problems. It is likely that photoacoustic signals from in-vivo tissue will have features that allow them to be even more distinguishable than the current classifier, by combining the approach with functional imaging where blood oxygenation is measured. From the analysis performed in this thesis, it does appear that the structural morphology plays a role in the detectable features of the photoacoustic signal. It is hopeful 93

CHAPTER 5. CONCLUSION the signal differences related to structural morphology can be combined with existing methods for functional classification (such as blood oxygenation and blood volume) to produce even stronger methods for detection of vascular abnormality. A method for simulating photoacoustic signals from large scale vascular tissue models has been put forward in this thesis. Vascular geometry was modeled as a fractal with cylindrical vessel segments. In addition, the exact solution for a photoacoustic wave from a finite-length cylindrical source was reduced to terms of elliptic integrals. Finite element models are used to validate the simulators used in this thesis. The FEM models were not suitable for large scale tissue simulation due to high computational requirements.

5.2

Summary of Contributions

Significant contributions in this research include
 studying the effect of the structural morphology of vasculature on photoacoustic

RF signals;
 developing a method for photoacoustic simulation and modeling of large scale vas-

cular structures in tissue;
 developing a classification algorithm based on the wavelet packet transform and

support vector machines for classifying photoacoustic RF signals;
 showing that it is possible to classify vascular tissue based on structural morphology

using photoacoustic methods without resolving vascular structures; and
 deriving the exact solution for the finite-length cylindrical source problem in terms

of elliptic integrals.

5.3

Future Research

Future research includes
 testing the classifier on clinically acquired photoacoustic data;  further optimizing the SVM classifier with a larger training set;  creating parametric images of a tissue based on the classifier strength; and  incorporating inhomogeneous tissue models into the simulation.

94

Bibliography
[1] R. K. Jain, "Taming Vessels to Treat Cancer," Scientific American, vol. 1, pp. 56­63, 2008. [2] R. Karshafian, "Modelling the structure of the tumour vasculature and its effect on Doppler ultrasound signals," Master's Thesis, University of Toronto, 2001. [3] M. Zamir, "Arterial branching within the confines of fractal L-system formalism," Gen. Physiol., vol. 118, no. 3, pp. 267­275, 2001. [4] L. V. Wang, "Prospects of photoacoustic tomography," Medical Physics, vol. 35, no. 12, pp. 5758­5767, 2008. [5] E. Zhang, J. Laufer, and P. Beard, "Backward-mode multiwavelength photoacoustic scanner using a planar FabryPerot polymer film ultrasound sensor for high-resolution threedimensional imaging of biological tissues," Applied Optics, vol. 47, no. 4, pp. 561­577, 2008. [6] S. Ermilov, A. Stein, A. Conjusteau, R. Gharieb, R. Lacewell, T. Miller, S. Thompson, P. Otto, B. Mccorvey, T. Khamapirad, M. Leonard, A. Oraevsky, S. M. Instruments, and S. Antonio, "Detection and noninvasive diagnostics of breast cancer with two-color laser optoacoustic imaging system," Proc SPIE, vol. 6437, 2007. [7] H. F. Zhang, K. Maslov, M. Sivaramakrishnan, G. Stoica, and L. V. Wang, "Imaging of hemoglobin oxygen saturation variations in single vessels in vivo using photoacoustic microscopy," Applied Physics Letters, vol. 90, 2007. [8] G. Gutierrez-Juarez, S. K. Gupta, and M. Al-shaer, "Detection of Melanoma Cells In Vitro Using an Optical Detector of Photoacoustic Waves," Life Sciences, vol. 281, no. 3, pp. 274­281, 2010. [9] E. Candes, J. Romberg, and T. Tao, "Robust Uncertainty Principles : Exact Signal Reconstruction from Highly Incomplete Frequency Information," IEEE Trans. Inf. Theory, vol. 52, no. 2, 2006. [10] J. Provost and F. Lesage, "The Application of Compressed Sensing for Photoacoustic Tomography," IEEE Trans. Medical Imaging, vol. 28, no. 4, pp. 585­594, 2009.

95

BIBLIOGRAPHY
[11] J. A. Noble, "Ultrasound image segmentation and tissue characterization," Proc IMechE, Part H: J. Engineering in Medicine, vol. 224, no. 2, pp. 307­316, 2010. [12] P. D. Tafti, D. Van De Ville, and M. Unser, "Innovation Modelling and Wavelet Analysis of Fractal Processes in Bio-imaging," in ISBI, 2008, pp. 1501­1504. [13] J. W. Baish and R. K. Jain, "Fractals and Cancer," Cancer Research, vol. 60, no. 7, pp. 3683­3688, 2000. [14] F. Grizzi, C. Russo, P. Colombo, B. Franceschini, E. E. Frezza, E. Cobos, and M. Chirivainternati, "Quantitative evaluation and modeling of two-dimensional neovascular network complexity: the surface fractal dimension," BMC Cancer, vol. 9, 2005. [15] M. C. Kolios, G. J. Czarnota, M. Lee, J. W. Hunt, and M. D. Sherar, "Ultrasonic Spectral Parameter Characterization of Apoptosis," Ultrasound in Med. & Biol, vol. 28, no. 5, pp. 589 ­597, 2002. [16] J. M. Martinez, N. Floury, T. L. E. Toan, and M. Hallikainen, "Measurements and Modeling of Vertical Backscatter Distribution in Forest Canopy," IEEE Trans. Geoscience and Remote Sensing, vol. 38, no. 2, pp. 1­37, 2000. [17] I. Bayram and I. W. Selesnick, "On the Dual-Tree Complex Wavelet Packet," IEEE Trans Signal Processing, vol. 56, no. 6, pp. 2298­2310, 2008. [18] R. R. Coifman and M. V. Wickerhauser, "Entropy-based algorithms for best basis selection," IEEE Transactions on Information Theory, vol. 38, no. 2, pp. 713­718, 1992. [19] B. Scholkopf, K. Sung, C. J. C. Burges, F. Girosi, P. Niyogi, T. Poggio, and V. Vapnik, "Comparing Support Vector Machines with Gaussian Kernels to Radial Basis Function Classifiers," IEEE Trans Signal Processing, vol. 45, no. 11, pp. 2758­2765, 1997. [20] E. Z. Zhang, J. G. Laufer, R. B. Pedley, and P. Beard, "In vivo high-resolution 3D photoacoustic imaging of superficial vascular anatomy," Physics in Medicine And Biology, vol. 54, pp. 1035­1046, 2009. [21] A. B. Wolbarst and W. R. Hendee, "Evolving and Experimental Technologies in Medical Imaging," Radiology, vol. 238, no. 1, pp. 16­39, 2006. [22] C. S. Levin, "Primer on molecular imaging technology," European Journal of Nuclear Medicine and Molecular Imaging, vol. 32, no. 14, 2005. [23] E. M. Strohm and M. C. Kolios, "Measuring the Mechanical Properties of Cells using Acoustic Microscopy," in 31st Annual Internation Conference of the IEEE EMBS, 2009, pp. 6042­6045.

96

BIBLIOGRAPHY
[24] M. Rui, W. Bost, E. C. Weiss, R. Lemor, and M. C. Kolios, "Photoacoustic Microscopy and Spectroscopy of Individual Red Blood Cells," in OSA - Optics & Photonics Congress: BIOMED/DH 2010, 2010, pp. 3­5. [25] S. Hu and L. V. Wang, "Photoacoustic imaging and characterization of the microvasculature," Journal of Biomedical Optics, vol. 15, no. 1, 2010. [26] S. Vaithilingam, I. O. Wygant, S. Sifferman, X. Zhuang, Y. Furukawa, O. Oralkan, S. Keren, S. S. Gambhir, and B. T. Khuri-Yakub, "Tomographic Photoacoustic Imaging Using Capacitive Micromachined Ultrasonic Transducer (CMUT) Technology," in IEEE Ultrasonics Symposium, 2006, pp. 397­400. [27] S. Emelianov, B. Wang, J. Su, A. Karpiouk, E. Yantsen, K. Sokolov, J. Amirian, R. Smalling, and S. Sethuraman, "Intravascular Ultrasound and Photoacoustic Imaging," in 30th Annual International IEEE EMBS Conference, Vancouver, 2008, pp. 2­5. [28] T. Khamapirad, P. M. Henrichs, K. Mehta, T. G. Miller, A. T. Yee, and A. A. Oraevsky, "Diagnostic imaging of breast cancer with LOIS : Clinical feasibility," in Proc. SPIE, Photons Plus Ultrasound, vol. 5697, 2005, pp. 35­44. [29] P. Ephrat, A. Seabrook, L. Keenliside, F. S. Prato, and J. J. L. Carson, "Three-dimensional photoacoustic imaging by sparse-array detection and iterative image reconstruction," Journal of Biomedical Optics, vol. 13, no. 5, 2008. [30] N. Bojarski, "The k-space formulation of the scattering problem in the time domain," J. Acoust. Soc. Amer, vol. 72, no. 2, pp. 570­584, 1982. [31] B. T. Cox and P. C. Beard, "Fast calculation of pulsed photoacoustic fields in fluids using k-space methods," J. Acoust. Soc. Am, vol. 117, no. 6, pp. 3616­3627, 2005. [32] B. T. Cox, S. Kara, S. R. Arridge, and P. C. Beard, "k-space propagation models for acoustically heterogeneous media: Application to biomedical photoacoustics," J. Acoust. Soc. Am., vol. 121, no. 6, pp. 3453­3464, 2007. [33] R. S. C. Cobbold, Foundations of Biomedical Ultrasound. Oxford University Press, 2006. [34] B. E. Treeby and B. T. Cox, "Fast , tissue-realistic models of photoacoustic wave propagation for homogeneous attenuating media," in Proc. SPIE, Photons Puls Ultrasound, vol. 7177, 2009. [35] J. F. Kelly, R. J. Mcgough, and M. M. Meerschaert, "Analytical time-domain Greens functions for power-law media," J. Acoust. Soc. Am, vol. 124, no. 5, pp. 2861­2872, 2008. [36] T. L. Szabo, "Time domain wave equations for lossy media obeying a frequency power law," J. Acoust. Soc. Am, vol. 96, no. 1, pp. 491­500, 1994.

97

BIBLIOGRAPHY
[37] F. S. Foster, J. Mehi, M. Lukacs, D. Hirson, C. White, C. Chaggares, and A. Needles, "A New 15-50 MHz Array-Based Micro-Ultrasound Scanner for Preclinical Imaging," Ultrasound in Med & Biol., vol. 35, no. 10, pp. 1700­1708, 2009. [38] J. A. Jensen, "A model for the propagation and scattering of ultrasound in tissue," Journal of Acoustical Society of America, vol. 89, no. 1, pp. 182­190, 1991. [39] A. Lhemery, "Impulse Response Method to Predict echo-responses from Targets of Complex Geometry. Part I: Theory," J. Acoust. Soc. Am., vol. 90, no. 5, 1991. [40] P. Kuchment and L. Kunyansky, "Mathematics of Photoacoustic and Thermoacoustic Tomography," arXiv:0912.2022v1, 2009. [41] M. Haltmeier, O. Scherzer, P. Burgholzer, and G. Paltauf, "Thermoacoustic computed tomography with large planar receivers," Inverse Problems, vol. 20, pp. 1663­1673, 2004. [42] M. Xu and L. V. Wang, "Universal back-projection algorithm for photoacoustic computed tomography," Physical Review E, vol. 71, no. 1, 2005. [43] P. Liu, "Image Reconstruction from Photoacoustic Pressure Signals," SPIE, vol. 2681, no. May 2010, pp. 285­296, 1996. [44] D. Finch, S. Patch, and Rakesh, "Determining a function from its mean values over a family of spheres," SIAM J. Math. Anal., vol. 35, no. 5, pp. 1213­1240, 2004. [45] M. Fink, "Real time inverse filter focusing through iterative time reversal," J. Acoust. Soc. Am., vol. 115, no. 2, 2004. [46] M. Fink, D. Cassereau, A. Derode, C. Prada, P. Roux, M. Tanter, J. Thomas, and F. Wu, "Time-reversed acoustics," Rep. Prog. Phys, vol. 63, pp. 1933­1995, 2000. [47] M. Fink, "Time-reversal waves and super resolution," Journal of Physics: Conference Series, vol. 124, 2008. [48] G. Paltauf, J. A. Viator, S. A. Prahl, and S. L. Jacques, "Iterative reconstruction algorithm for optoacoustic imaging," J. Acoust. Soc. Am, vol. 112, no. 4, 2002. [49] D. Modgil and P. J. La Rivi` ere, "Implementation and comparison of reconstruction algorithms for two-dimensional optoacoustic tomography using a linear array," J. Biomedical Optics, vol. 14, no. August 2009, pp. 1­9, 2010. [50] Y. Xu, L. V. Wang, G. Ambartsoumian, and P. Kuchment, "Reconstructions in limitedview thermoacoustic tomography," Med. Phys, vol. 31, no. 4, pp. 724­733, 2004. [51] D. Modgil, M. A. Anastasio, and P. J. La Rivi` ere, "Image reconstruction in photoacoustic tomography with variable speed of sound using a higher-order geometrical acoustics approximation," Journal of Biomedical Optics, vol. 15, no. 2, 2010.

98

BIBLIOGRAPHY
[52] M. P. Mienkina, C. Friedrich, N. C. Gerhardt, M. F. Beckmann, M. F. Schiffner, M. R. Hofmann, and G. Schmitz, "Multispectral photoacoustic coded excitation imaging using unipolar orthogonal Golay codes," Optics Express, vol. 18, no. 9, pp. 9076­9087, 2010. [53] Y. Xu, M. Xu, and L. V. Wang, "Exact frequency-domain reconstruction for thermoacoustic tomography II: Cylindrical geometry," IEEE Trans. Med. Imag, vol. 21, no. 7, pp. 829­833, 2002. [54] A. A. Oraevsky and A. A. Karabutov, Optoacoustic Tomography. Boca Raton, Fla.: CRC Press, 2003, ch. 34. [55] M. Xu and L. V. Wang, "Analytic explanation of spatial resolution related to bandwidth and detector aperture size in thermoacoustic or photoacoustic reconstruction," Phy. Rev. E, vol. 67, no. 5, 2003. [56] M. A. Anastasio, J. Zhang, D. Modgil, and P. J. L. Rivi, "Application of inverse source concepts to photoacoustic tomography," Inverse Problems, vol. 23, pp. 21­35, 2007. [57] F. J. Herrmann, "Compressive sampling meets seismic imaging," in SIAM Conference on Imaging Science, 2008. [58] S. Baker and T. Kanade, "Limits on Super-Resolution and How to Break Them," in IEEE Computer Society Conference on Computer Vision and Pattern Recognition, vol. 2, 2000, p. 2372. [59] F. Aguet, S. Geissbuhler, I. Marki, T. Lasser, and M. Unser, "Super-resolution orientation estimation and localization of fluorescent dipoles using 3-D steerable filters," Optics Express, vol. 17, no. 8, pp. 2378­2388, 2009. [60] C. R. Ethier and C. A. Simmons, Introductory Biomechanics From Cells to Organisms, 1st ed. New York: Cambridge University Press, 2007. [61] E. Bullitt, D. A. Reardon, and J. K. Smith, "A review of micro- and macrovascular analyses in the assessment of tumor-associated vasculature as visualized by MR," NeuroImage, vol. 37, pp. 116­119, 2007. [62] F. S. Foster, P. N. Burns, D. H. Simpson, S. R. Wilson, D. A. Christopher, and D. E. Goertz, "Ultrasound for the visualization and quantification of tumor microcirculation," Cancer and Metastasis Reviews, vol. 19, pp. 131­138, 2000. [63] H. A. Collins, M. Khurana, E. H. Moriyama, A. Mariampillai, E. Dahlstedt, M. Balaz, M. K. Kuimova, M. Drobizhev, V. X. D. Yang, D. Phillips, A. Rebane, B. C. Wilson, and H. L. Anderson, "Blood-vessel closure using photosensitizers engineered for two-photon excitation," Nature Photonics, vol. 2, no. 7, 2008.

99

BIBLIOGRAPHY
[64] A. D. Ieva, F. Grizzi, P. Gaetani, U. Goglia, and M. Tschabitscher, "Euclidean and fractal geometry of microvascular networks in normal and neoplastic pituitary tissue," Neurosurgical Review, vol. 31, pp. 271­281, 2008. [65] R. A. Krasnoperov and D. Stoyan, "Spatial Correlation Analysis of Isotropic Microvessels : Methodology and Application to Thyroid Capillaries," Annals of Biomedical Engineering, vol. 34, no. 5, pp. 810­822, 2006. [66] M. A. Konerding, E. Fait, and A. Gaumann, "3D microvascular architecture of precancerous lesions and invasive carcinomas of the colon," British Journal of Cancer, vol. 84, no. 2, pp. 1354­1362, 2001. [67] E. Bullitt, K. Muller, I. Jung, W. Lin, and S. Aylward, "Analyzing Attributes of Vessel Populations," Med Image Anal, vol. 9, no. 1, pp. 39­49, 2005. [68] B. J. Vakoc, R. M. Lanning, J. A. Tyrrell, T. P. Padera, L. A. Bartlett, T. Stylianopoulos, L. L. Munn, G. J. Tearney, D. Fukumura, R. K. Jain, and B. E. Bouma, "Three-dimensional microscopy of the tumor microenvironment in vivo using optical frequency domain imaging," Nature Medicine, vol. 15, no. 10, pp. 1219­1224, 2009. [69] A. Mariampillai, B. A. Standish, E. H. Moriyama, M. Khurana, N. R. Munce, M. K. K. Leung, J. Jiang, A. Cable, B. C. Wilson, I. A. Vitkin, and V. X. D. Yang, "Speckle variance detection of microvasculature using swept-source optical coherence tomography," Optics Letters, vol. 33, no. 13, pp. 1530­1532, 2008. [70] P. Carmeliet, "Angiogenesis in life, disease and medicine," Nature, vol. 438, no. 12, pp. 932­936, 2005. [71] M. Papetti and I. M. Herman, "Mechanisms of normal and tumor-derived angiogenesis," Americal Journal of Cell Physiology, vol. 282, pp. 947­970, 2002. [72] G. D. Yancopoulos, S. Davis, N. W. Gale, J. S. Rudge, S. J. Wiegand, and J. Holash, "Vascular-specific growth factors and blood vessel formation," Nature, vol. 407, no. 9, pp. 242­248, 2000. [73] R. K. Jain, "Normalization of Tumor Vasculature : An Emerging Concept in Antiangiogenic Therapy," Science, vol. 307, no. 58, pp. 58­62, 2005. [74] M. A. Herrero, A. Kohn, and J. M. Peres-Pomares, "Modelling Vascular Morphogenesis: Current Views on Blood Vessels Development," Mathematical Models and Methods in Applied Sciences, vol. 19, pp. 1483­1537, 2009. [75] M. Kretowski, Y. Rolland, J. B´ ezy-wendling, and J.-l. Coatrieux, "Physiologically Based Modeling of 3-D Vascular Networks and CT Scan Angiography," IEEE Transactions on Medical Imaging, vol. 22, no. 2, pp. 248­257, 2003.

100

BIBLIOGRAPHY
[76] H. Kurz and R. Godde, "Structural and Biophysical Simulation of Angiogenesis and Vascular Remodeling," Developmental Dynamics, vol. 220, no. 2, pp. 387­ 401, 2001. [77] R. M. H. Merks and J. A. Glazier, "Dynamic mechanisms of blood vessel growth," Nonlinearity, vol. 19, pp. C0­C10, 2006. [78] A. M. Turing, "The Chemical Basis of Morphogenesis," Philosophical Transactions of the Royal Society of London, vol. 237, no. 641, pp. 37­72, 1952. [79] H. Meinhardt, "Morphogenesis of Lines and Nets," Differentiation, vol. 6, pp. 117­123, 1976. [80] L. Wang, A. Bhalerao, and R. Wilson, "Analysis of Retinal Vasculature Using a Multiresolution Hermite Model," IEEE Trans Medical Imaging, vol. 26, no. 2, pp. 137­152, 2007. [81] J. A. Tyrrell, E. Tomaso, D. Fuja, R. Tong, K. Kozak, R. K. Jain, and B. Roysam, "Robust 3-D Modeling of Vasculature Imagery Using Superellipsoids," IEEE Trans. Medical Imaging, vol. 26, no. 2, pp. 223­237, 2007. [82] F. Ritter, C. Hansen, and V. Dicken, "Real-Time Illustration of Vascular Structures," Computer, vol. 12, no. 5, pp. 877­884, 2006. [83] C. D. Murray, "The physiological principle of minimum work applied to the angle of branching of arteries," Journal of Gener Physiology, vol. 9, no. 4, pp. 835­841, 1926. [84] I. Dydenko, D. Friboulet, J. Gorce, J. D, B. Bijnens, and I. E. Magnin, "Towards ultrasound cardiac image segmentation based on the radiofrequency signal," Medical Image Analysis, vol. 7, pp. 353­367, 2003. [85] J. W. Hunt, A. E. Worthington, A. Xuan, M. C. Kolios, G. J. Czarnota, and M. D. Sherar, "A Model Based Upon Pseudo Regular Spacing of Cells Combined wiht the Randomization of the Nuclei can explain the Significant Changes in High-Frequency Ultrasound Signals During Apoptosis," Ultrasound in Med. & Biol, vol. 28, no. 2, pp. 217­226, 2002. [86] S. Brand, E. C. Weiss, R. M. Lemor, and M. C. Kolios, "High Frequency Ultrasound Tissue Characterization and Acoustic Microscopy of Intracellular Changes," Ultrasound in Med. & Biol, vol. 34, no. 9, pp. 1396 ­1407, 2008. [87] O. Heymans, S. Blacher, F. Brouers, and G. E. Pi´ erard, "Fractal Quantification of the Microvasculature Heterogeneity in Cutaneous Melanoma," Dermatology, vol. 198, no. 2, pp. 212­217, 1999. [88] P. D. Tafti, D. Van De Ville, and M. Unser, "Invariances, Laplacian-Like Wavelet Bases, and the Whitening of Fractal Processes," IEEE Transactions on Image Processing, vol. 18, no. 4, pp. 689­702, 2009.

101

BIBLIOGRAPHY
[89] G. Mcgarry and M. Deriche, "Modelling mammographic images using fractional brownian motion," in IEEE TENCON - Speech and Image Technologies for Computing and Telecommunications, 1997, pp. 299­302. [90] D. Eberly, "Fast Algorithms for Ridge Construction," SPIE Vision Geometry III, vol. 2356, no. 1994, pp. 231­242, 1994. [91] Y. Fridman, "Extracting Branching Object Geometry via Cores," Ph.D. dissertation, University of North Carolina, 2004. [92] A. F. Frangi, W. J. Niessen, K. L. Vincken, and M. A. Viergever, "Multiscale vessel enhancement filtering," MICCAI'98, vol. 1496, pp. 130­137, 1998. [93] S. R. Aylward and E. Bullitt, "Initialization, noise, singularities, and scale in height ridge traversal for tubular object centerline extraction," IEEE Trans. Med. Imag, vol. 21, no. 2, pp. 61­75, 2002. [94] M. Unser, "Texture Classification and Segmentation Using Wavelet Frames," IEEE Trans Image Processing, vol. 4, no. 11, pp. 1549­1560, 1995. [95] N. G. Kingsbury, "Complex wavelets for shift invariant analysis and filtering of signals," J. Appl. Comput. Harmon. Anal, vol. 10, pp. 234­253, 2001. [96] R. Learned and A. Willsky, "A Wavelet Packet Approach to Transient Signal Classification," Applied and Computational Harmonic Analysis, vol. 2, pp. 265­278, 1995. [97] C. Taswell, "Near-best basis selection algorithms with non-additive information cost functions," in Proc. IEEE-SP TFTSA, 1994. [98] T. Joachims, T. Finley, and C. J. Yu, "Cutting-Plane Training of Structural SVMs," Machine Learning, vol. 77, no. 1, pp. 27­59, 2009. [99] G. Fung and O. L. Mangasarian, "Finite Newton Method for Lagrangian Support Vector Machine Classification," 2002. [100] R. Karshafian, P. N. Burns, and M. Henkelman, "Fractal Modeling of Microbubble destruction-reperfusion in unresolved vessels," in IEEE Ultrasonics Symposium, 2001, pp. 1669­1673. [101] M. Held, "ERIT - A Collection of Efficient and Reliable Intersection Tests," Journal of Graphic Tools, vol. 2, no. 4, pp. 25­44, 1998. [102] C. G. A. Hoelen and F. F. M. D. Mul, "A new theoretical approach to photoacoustic signal generation," J. Accoust. Soc. Am, vol. 106, no. 8, pp. 695­706, 1999.

102

BIBLIOGRAPHY
[103] B. L. Welch, "The generalization of 'student's' problem when several different population variances are involved," Order A Journal On The Theory Of Ordered Sets And Its Applications, vol. 34, no. 2, pp. 28­35, 1947. [104] B. E. Treeby and B. T. Cox, "k-Wave : MATLAB toolbox for the simulation and reconstruction of photoacoustic wave fields," Journal of Biomedical Optics, vol. 15, no. 4, pp. 1­12, 2010. [105] G. J. Diebold and T. Sun, "Properties of photoacoustic waves in one, two and three dimensions," Acustica, vol. 80, pp. 339­351, 1994. [106] J. Remillard, "Pressure disturbances from a finite cylindrical source," J. Acoust. Soc. Am, vol. 59, no. 4, pp. 744­748, 1976. [107] Z. Ye, "A novel approach to sound scattering by cylinders of finite length," J. Acoust. Soc. Am, vol. 102, no. 2, pp. 877­884, 1997. [108] W. Williams, N. G. Parke, D. A. Moran, and C. H. Sherman, "Acoustic Radiation from a Finite Cylinder," Journal of the Acoustical Society of America, vol. 36, no. 12, pp. 2316­ 2322, 1964. [109] T. K. Stanton, "Sound scattering by cylinders of finite length I: Fluid cylinders," J. Acoust. Soc. Am, vol. 83, no. 1, pp. 55­63, 1988. [110] N. South, "The Sound radiation Efficiency of Finite Length Acoustically Think Circular Cylindrical Shells Under Mechanical Extitation I: Theoretical Analysis," Journal of Sound and Vibration, vol. 232, no. 2, pp. 431­447, 2000. [111] W. X. Wang, "The exact kernel for cylindrical antenna," IEEE Trans on Antennas and Propagation, vol. 39, no. 4, pp. 434­435, 1991. [112] D. H. Werner, "An Exact Formulation for the Vector Potential of a Cylindrical Antenna with Uniformly Distributed Current and Arbitrarv Radius," IEEE Trans Antennas and Propagation, vol. 41, no. 8, pp. 1009­1018, 1993. [113] P. J. Davies and D. B. Duncan, "The stability of numerical approximations of the time domain current induced on thin wire and strip antennas," Applied Numerical Mathematics, vol. 55, no. 1, pp. 48­68, 2005. [114] V. Ng and A. Coldman, "Diagnosis of Melanoma with Fractal Dimensions," in IEEE TENCON'93, 1993, pp. 514­517. [115] G. Terdik and W. A. Woyczynski, "Notes on fractional Ornstein sheets," Publ. Math, vol. 66, no. 1-2, pp. 153­181, 2005. Uhlenbeck random

[116] P. Chow, "Spherical mean solutions of stochastic wave equation," Stochastic Analysis and Applications, vol. 18, no. 5, pp. 737­754, 2000.

103

BIBLIOGRAPHY
[117] R. M. Balan and C. A. Tudor, "The Stochastic Wave Equation with Fractional Noise : a random field approach," ArXiv preprint, 2009. [118] C. Vonesch and M. Unser, "A Fast Multilevel Algorithm for Wavelet-Regularized Image Restoration," IEEE Trans Image Proc., vol. 18, no. 3, pp. 509­523, 2009. [119] H. Rauhut and M. Rosler, "Radial Multiresolution in Dimension Three," Constructive Approximation, vol. 22, pp. 193­218, 2005. [120] L. Cui and L. Peng, "Biorthogonal radial multiresolution in dimension three," Journal of Computational and Applied Mathematics, vol. 224, no. 2, pp. 581­591, 2009. [121] J. R. Romero, S. Alexander, S. Baid, S. Jain, and M. Papadakis, "The geometry and the analytic properties of Isotropic Multiresolution Analysis," Advances in Comp. Math., vol. 31, pp. 283­328, 2009. [122] M. Unser and D. V. D. Ville, "Wavelet Steerability and the Higher-Order Riesz Transform," IEEE Trans. Image Proc., vol. 19, no. 3, pp. 636­652, 2010. [123] D. L. Donoho, "Nonlinear Solution of Linear Inverse Problems by Wavelet-Vaguelette Decomposition," Applied and Computational Harmonic Analysis, vol. 2, no. 2, pp. 101­126, 1992. [124] B. De Knock, "Multidimensional distributions and generalized Hilbert transforms in Clifford analysis," Ph.D. dissertation, Universiteit Gent, 2008. [125] F. Lamarche and C. Leroy, "Evaluation of the Volume of Intersection of a Sphere with a Cylinder by Elliptic Integrals," Computer Physics Communications, vol. 59, pp. 359­369, 1990. [126] P. F. Byrd and M. D. Friedman, Handbook of Elliptic Integrals for Engineers and Scientistis, 2nd ed. New York-Heidelberg-Berlin: Springer, 1971.

104

Appendix A

Spatial Weighting Functions For Universal Back Projection Algorithm

105

APPENDIX A. SPATIAL WEIGHTING FUNCTIONS FOR UNIVERSAL BACK PROJECTION ALGORITHM

(a) circular, omni-directional, n = 1

(b) circular, directional, n = 1

(c) linear, omni-directional, n = 1

(d) linear, directional, n = 1

(e) linear, omni-directional, n = 5

(f ) linear, directional, n = 5

Figure A.1: Normalized spatial weighting functions. Each plot shows n (x)/(x) (in dB ) s (x-xi ) for tranducer n, where (x) = i i (x) and i (x) = ni · |x-xi |3 . For a non-directional transducer, ns i =
x-x x-x

.

106

Appendix B

Derivation for the Exact Solution of a Finite-Length Cylindrical Photoacoustic Source
The photoacoustic pressure p(x, t) can be obtained from a source distribution's sphericalmean, which is related to its integration over a spherical surface of radius ct centered at x. It is known that no closed form solution exists in terms of basic mathematical functions for the photoacoustic wave from a finite-length cylindrical source. This derivation is inspired by [125] where the exact solution for the volume of intersection between a solid sphere and a solid infinite-length cylinder were reduced into terms of elliptic integrals. Instead of finding the volume of intersection as in [125], this approach uses the surface area of intersection between a solid finite-length cylinder and a spherical shell. The surface area of a function f (x, y ) above a region S is f x
2

1+
S

+

f y

2

dx dy.

First, the area of intersection between a spherical wavefront and an infinite-length cylinder will be derived as shown in Figure B.1. Let r = ct be the radius of the wavefront centered at the origin. Let R be the radius of the infinite cylinder. The minimum distance from the origin to the cylindrical axis is called b. The sphere x2 + y 2 + z 2 = r2 can be written as f (x, y ) = ± r2 - x2 - y 2 . 107

APPENDIX B. DERIVATION FOR THE EXACT SOLUTION OF A FINITE-LENGTH CYLINDRICAL PHOTOACOUSTIC SOURCE accordingly, f (x, y ) = x x r2 - x2 - y2 , f (x, y ) = y y r2 - x2 - y 2 .

Hence the total area A = A(r, R, b) above and below region S is f x r
S 2

A=2
S

1+

+

f y

2

dx dy

=2

r2

- x2 - y 2

dx dy.

Switching to polar coordinates, with  = x2 + y 2 , this becomes A=2
S

r r2 - 2

 d d.

The region S must now be described. If b = 0 then S is a circular region centered at the origin and A can be directly solved as
2 a 0

A(r, R, 0) = 2
0

r r2 - 2

 d d = 4 arcsin

a , r

where a is min(r, R).

Figure B.1: Intersection of a spherical wavefront (left) and a cylinder (right)

When b = 0, the problem is less simple. Performing integration in polar coordinates yields the region shown in Figure B.2. When b - R < 0, a circular section of area A0 is missing from S . However, this missing section has the same form as the area that was just calculated for b = 0. Hence,    0,   R  b,
R-b r

A0 =

4 r arcsin    2 2 r,

,

0 < R - b < r, otherwise.

108

The remainder of the region is bounded from  = |b - R| to r and by  = - to  . The angle  can be found from the cosine law as  = arccos for region S is
r  2 +b2 -R2 2b

. By symmetry,

the area is double that of the region bounded from  = 0 to  . Hence, the surface area

2
|b-R| 0 r

=
|b-R|

d d r2 - 2 2 + b2 - R2 r arccos 2b r2 - 2

r

(B.1) d,

which can be rewritten using integration by parts as - 2 arccos ... 2 + b2 - R2 2b
min(r, b+R) min(r, b+R)

r

r2 - 2
=|b-R|

-2
|b-R|

r 

r2 - 2 2 - b2 + R2

(2 - R2 - 2bR - b2 )(R2 - 2bR + b2 - 2 )

d

= A1 + A2 , so that the total area of intersection is A = A0 + A1 + A2 .

The term A1 reduces to  -2r A1 = 0,

r2 - (R - b)2 ,

0 < R - b < r, otherwise.

To solve the term A2 we substitute µ := 2 so that dµ = 2 d. Thus,
min(r2, (b+R)2 )

A2 = -
(b-R)2

r µ

r2 - µ(µ - b2 + R2 )

(µ - R2 - 2bR - b2 )(R2 - 2bR + b2 - µ)

dµ

Defining k1 := b2 - R2 , k2 := (b - R)2 and k3 := (b + R)2 this becomes
min(r2, k3 )

A2 = 2
k2

(µ - k1 ) µ

r2 (r2 - µ)

(µ - k2 ) (k3 - µ)

dµ

(B.2)

109

APPENDIX B. DERIVATION FOR THE EXACT SOLUTION OF A FINITE-LENGTH CYLINDRICAL PHOTOACOUSTIC SOURCE A2 can be solved by using the tabulated formulas for elliptic integrals in [126], or with the help of Maple as   0,           2 r(k1 +r2 -k3 )  r(k2 -k3 ) k2 -r2 r2 -k2   K E - 2  k - k k  2 3 3 -k2 k - k k - k 3 2 3 2   3 2 2 -k r 2 k r k - r 2 1 2 . . . - k k -k  A2 = k2 , k3 -k2 , 2 3 2         2 r(k2 -r2 )  k3 -k2 k3 -k2 +2 rk1    K - E  2 r -k2 r2 -k2  r2 -k2 2 -k r  2    -k3 2 r3 k1 3 -k2  ... -  , k  k2k , r2 -k2 2 2
k2 r -k2

r  |b - R|,

|b - R| < r  R + b,

otherwise,

where K(), E(), and (, ) are the complete elliptic integrals of the first, second and third kinds defined from their incomplete versions by K() = F(1, ), E() = E(1, ), (, ) = (1, , ), 1   d , 1 -  2 1 - 2  2 0  z 1 - 2  2  E(z, ) = d , 1 - 2 0 z 1   (z, , ) = d . 2 2 1 - 2  2 0 (1 -   ) 1 -  F(z, ) =
z

Figure B.2: Intersections of sphere and cylinder. There are four ways that a sphere of radius r can intersect an infinite cylinder of radius R. The sphere of radius is shown centered at the origin. The distance from the center of the sphere to the axis of the cylinder is called b.

110

The photoacoustic pressure for the infinite cylinder is given by P = 1  A 4c2 t r =
r=ct

1  A0 + A1 + A2 4c2 t r

r=ct

= P0 + P1 + P2 which results in P0 =  
c2 t 



k2 , c2 t2 -k2

0 < R - b < ct, otherwise,

 0,  - 
2 t , c2 t2 -k2

0 < R - b < ct, otherwise, ct  |R - b|,

P1 =   0,        

 0,

P2 =



t

2           t

c2 t2 -k2

K

c2 t2 -k2 k3 -k2

-

k1 k2 

k2 -k3 k2 ,

c2 t2 -k2 k3 -k2

,

|b - R|  ct  R + b,

2 k2 -k3

K

c2 t2 -k2 k3 -k2

-

k1 k2 

k2 -c2 t2 , k2

c2 t2 -k2 k3 -k2

,

otherwise.

Figure B.3: Surface area of sphere-cylinder intersection. h1 and h2 define the start and end of the cylinder at a position on its axis. d1 and d2 are the positions on the cylinder axis that the sphere intersects.

This is an alternate derivation for the known exact solution of an infinite-cylindrical 111

APPENDIX B. DERIVATION FOR THE EXACT SOLUTION OF A FINITE-LENGTH CYLINDRICAL PHOTOACOUSTIC SOURCE

Figure B.4: The shaded surface area must be subtracted from the calculation. It must be done separately for each cylinder end.

photoacoustic source (see [53, 102, 105]). However when the cylinder is finite-length, then region S is no longer the same as in (B.1). To find the exact area (or pressure), an excess amount A (or P ) must be subtracted from the infinite-length case to account for the ends. The geometry is shown in Figure B.3 and Figure B.4 where h1 and h2 indicate the start and end positions of the cylinder on its coordinate axis. The exact area Aexact (r, R, b, h1 , h2 ) and pressure Pexact (t, R, b, h1 , h2 ) are Aexact = A - A (h1 ) - A (-h2 ), Pexact = P - P (h1 ) - P (-h2 ), where    0, d2  h,       A , d1 < h < d2 ,   A (h) = A -d1  h  d1 , 2,    A     2 - A , -d2  h  -d1 ,    A, h  -d2 , and
  A = A 0 + A1 + A2 ,    P  = P0 + P1 + P2 ,

(B.3a) (B.3b)

   0, d2  h,       P , d 1 < h < d2 ,   P (h) = P -d1  h  d1 , 2,    P     2 - P , -d2  h  -d1 ,    P, h  -d2 ,

112

with d1 = max(

r2 - (b + R)2 , 0) and d2 = min(

r2 - (b - R)2 , r), as shown

in Figure B.3. To calculate A and P  , the integration in (B.1) is performed from   = |b - R| to r2 - h2 as shown in Figure B.4.
  The terms A 0 , A1 and A2 are given by

   r2 -h2 4r arcsin , 0 < R - b < r 2 - h2 , r  A0 = A , otherwise. 0   -h2 +k1 -2hr arccos r2  r2 - h2 , , | b - R | < 2 2 2b -h +r A 1 = A1 + 0, otherwise. A 2
r2 -h2

=2
k2

(µ - k1 ) µ  r2

r 2 ( r 2 - µ)

(µ - k2 ) (k3 - µ) h2

dµ 

=

- - k2 k3 - k2  , k3 - k2 r2 - k2   2r(r2 - k2 )  r2 - h2 - k2 k3 - k2  , ... +  2 E k3 - k2 r 2 - k2 r - k2   2 - r2 + k 2 r3 k1 h k - k k - k 2 3 2 2 3 ... -  2  - . , , k3 - k2 k2 r 2 - k2 k2 r - k2 2k1 r F r2 - k2

 , P  and P  are given by The terms P0 1 2

 P0

=

 

 h , t c2 t2 -h2 c2

0<R-b< otherwise.



c2 t2 - h2 , 

P , 0 = P1 +  

 P1

2 (h2 -c2 t2 )

(2
(c

ht h2 -c2 t2 +k1 ) t2 -h2 -k3 )(h2 -c2 t2 +k2 )

, |b - R | <

c2 t2 - h2 ,

 0, 
 P2 =

h2 - c2 t2 + k2 k3 - k2  , 2 2 k2 - k3 c2 t2 - k2 c t - k2  k1 t h2 - c2 t2 + k2 k2 - k3 , , ... -  2 2  k2 - k3 k2 k2 c t - k2 t F ... + ht h2 - c2 t2 + k1 2 (h2 - c2 t2 )

otherwise. 

k3 - k2  c2 t2 - k2 .



(c2 t2 - h2 - k3 ) (h2 - c2 t2 + k2 ) 113

APPENDIX B. DERIVATION FOR THE EXACT SOLUTION OF A FINITE-LENGTH CYLINDRICAL PHOTOACOUSTIC SOURCE The pressure p(x, t) can be found for an arbitrarily positioned cylinder. If the ends of the cylinder is located at positions q2 and q1 , with length L = q2 - q1 , the start and end heights of the cylinder are (see [101])  |(q2 -q1 ) · (q1 -x)|   , (q2 - q1 ) · (q1 - x) > L2 ,  L  · (q2 -x)| , h1 = |(q2 -q1 )L (q2 - q1 ) · (q1 - x) < 0,   |(q -q ) · (q -x)|  1 - 2 1 , otherwise, L and  |(q2 -q1 ) · (q2 -x)|   ,  L  |(q2 -q1 ) · (q1 -x)| h2 = , L    | ( q - q ) · ( q - x ) | 2 1 2  , L The distance from x to the cylinder axis is b= q1 - x
2

(q2 - q1 ) · (q1 - x) > L2 , (q2 - q1 ) · (q1 - x) < 0, otherwise.

- ((q2 - q1 ) · (q1 - x))2 /L2 .

Hence, from (B.3a) the spherical-mean M is calculated by M(x, r) = 1 Aexact (r, R, b, h1 , h2 ), 4r2 (B.4)

and from (B.3b), the photoacoustic pressure is p(x, t) = Pexact (t, R, b, h1 , h2 ). (B.5)

114

