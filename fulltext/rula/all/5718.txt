FPCB ACTUATOR DRIVEN MICROMIRROR BASED AVAILABILITY INDICATOR AND LASER PATTERN POINTER

By Hui Zuo

Bachelor of Engineering, China Agricultural University, Beijing, 1994 Master of Engineering, China Agricultural University, Beijing, 1997

A thesis presented to Ryerson University

in partial fulfillment of the requirements for the degree of Master of Applied Science in the Program of Mechanical and Industrial Engineering

Toronto, Ontario, Canada, 2015

©Hui Zuo 2015

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A THESIS

I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners.

I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

I understand that my thesis may be made electronically available to the public.

ii

FPCB ACTUATOR DRIVEN MICROMIRROR BASED AVAILABILITY INDICATOR AND LASER PATTERN POINTER
Hui Zuo Master of Applied Science Program of Mechanical and Industrial Engineering Ryerson University, 2015

Abstract
The thesis presents a FPCB (Flexible Printed Circuit Board) actuator driven micromirror and the laser pattern generating technology for availability indicator and laser pattern pointer. The FPCB micromirror consists of a FPCB electrostatic parallel plate actuator and a bonded silicon mirror plate. It has the advantages of much larger aperture size, higher surface quality and lower cost than conventional MEMs micromirrors. The FPCB micromirror resonates at its first bending mode. Two FPCB micromirrors are positioned orthogonally to reflect a laser beam. By controlling the vibration frequency and magnitude of these two micromirrors, laser patterns of rotating ellipse or static circle, horizontal or vertical line can be generated and projected to a remote surface, e.g., a translucent or a presentation screen. Based on the FPCB micromirror, an availability indicator is developed, which can solve the wiring problem plaguing existing availability indicators. A laser pattern pointer is also developed which has much better visibility than conventional laser pointers with highlighting functions.

iii

Acknowledgements
Foremost, I would like to express my great gratitude my supervisor Professor Siyuan He for giving me the opportunity and support to pursue my Master of Applied Science program. With his consistent guidance, encouragement and motivation during the research and thesis writing I can succeed to finish the program in one year.

Beside my supervisor I would also like to acknowledge the rest of my thesis committee members : Dr. Vincent Chan and Dr. Krishnan Venkatakrishnan to participate in my final defense.

I would also like to thank Peng Yang and CMC Microsystems for their technical help and support.

I would also like to thank Kangaroo Design Inc. for the project support and their help for printing 3D mechanical parts.

I would also like to show my appreciation to my labmates Yuan Xue, Chao fan and Xuming Gao for being great graduate friends and their help when I needed. They gave me very warm welcome when I joined the group and helped me settle down very quickly in the MEMS research lab.

Finally, I send my greatest gratitude and appreciation to my wife, Gongcheng Li, without her support and encouragement, I would never have been able to back to school for pursuing my MASc degree after graduating over 17 years.

iv

Table of Contents
Author's Declaration .................................................................................................................... ii Abstract ....................................................................................................................................... iii Acknowledgements ...................................................................................................................... iv Chapter 1. Introduction ............................................................................................................. 1 1.1 1.2 1.3 1.4 Availability indicator........................................................................................................ 1 Laser pointer ..................................................................................................................... 4 Laser pattern generation and projection technology ........................................................ 7 Thesis objective and outline ........................................................................................... 12

Chapter 2. Design of FPCB micromirror .............................................................................. 14 2.1 2.2 Structure and working principle introduction ................................................................ 15 Modeling ........................................................................................................................ 18 Static force and deformation ................................................................................... 18 Forced resonant vibration ....................................................................................... 20 Rotation angle and gap determination .................................................................... 21 Resonant frequency................................................................................................. 22 Stress ....................................................................................................................... 23

2.2.1 2.2.2 2.2.3 2.2.4 2.2.5 2.3

Advantages of FPCB micromirror ................................................................................. 23 Cost ......................................................................................................................... 23 Aperture size ........................................................................................................... 23

2.3.1 2.3.2

2.3.3 Surface quality ............................................................................................................. 24 Chapter 3. Laser pattern generation ...................................................................................... 25 3.1 3.2 3.3 Generating straight laser line.......................................................................................... 25 Generating static laser circle/ellipse ............................................................................... 25 Generate rotating ellipse laser pattern ............................................................................ 27 v

Chapter 4. Prototype and test ................................................................................................. 30 4.1 4.2 FPCB micromirror.......................................................................................................... 30 Mirror plate surface finishing ......................................................................................... 30 Roughness ............................................................................................................... 31 Radius of curvature ................................................................................................. 31

4.2.1 4.2.2 4.3 4.4

PCB micromirror scanning angle test ............................................................................ 33 PCB micromirror moving trajectory test ........................................................................ 38

Chapter 5. Laser projection availability indicator................................................................ 40 5.1 5.2 Design and working principle ........................................................................................ 40 Driving circuit ................................................................................................................ 42 Digital control circuit .............................................................................................. 43 High voltage amplifier circuit ................................................................................. 44 Control program ...................................................................................................... 46

5.2.1 5.2.2 5.2.3 5.3

Prototype and test ........................................................................................................... 47 Laser availability indicator ..................................................................................... 47 Generating rotating ellipse ...................................................................................... 47

5.3.1 5.3.2 5.4

Result of laser availability indicator............................................................................... 52

Chapter 6. Laser pattern pointer ............................................................................................ 53 6.1 6.2 6.3 6.4 6.5 Design and working principle of laser pattern pointer ................................................... 53 Benefit of the laser pattern pointer ................................................................................. 54 Driving circuit ................................................................................................................ 55 Control program ............................................................................................................. 58 Prototype and test ........................................................................................................... 60

Chapter 7. Conclusions and future work ............................................................................... 66 7.1 Conclusions .................................................................................................................... 66 vi

7.2

Recommendations .......................................................................................................... 67

References ..................................................................................................................................... 68 Appendix A: Mechanical drawing of laser projection availability indicator ................................ 75 Appendix B: Schematic and components list of laser indicator control circuit ............................ 80 Appendix C: Schematic and components list of high voltage amplifier ...................................... 83 Appendix D: C language program of availability indictor ........................................................... 86 Appendix E: Mechanical drawing of laser pattern pointer ........................................................... 88 Appendix F: Schematic and components list of laser pointer control circuit ............................... 93 Appendix G: C language program of laser pattern pointer ........................................................... 98

vii

List of Tables
Table 1. The impact of interruptions on the enterprise [1] ............................................................ 1 Table 2. FDA Laser hazard classes [80] ........................................................................................ 6 Table 3. FPCB micromirror dimension (unit: mm) ..................................................................... 17 Table 4. Electrostatic force VS applied voltage........................................................................... 19 Table 5. Static displacement simulation result ............................................................................ 20

viii

List of Figures
Figure 1-1. Busylight presence indicator [4] ................................................................................. 2 Figure 1-2. Busylight Omega presence indicator [4] ..................................................................... 2 Figure 1-3. MyFocus LED indicator[5] ......................................................................................... 3 Figure 1-4. LED based availability indicator ................................................................................. 3 Figure 1-5. Laser pointer [79] ........................................................................................................ 4 Figure 1-6. Kensington wireless presenter [12] ............................................................................. 5 Figure 1-7. Wireless laser presenter............................................................................................... 5 Figure 1-8. Laser availability indicator .......................................................................................... 7 Figure 1-9. Laser projection pattern............................................................................................... 8 Figure 1-10. Projected laser spot or laser pattern with the same power of 0.065mw and the same camera setting such as the aperture speed of 1/25 second. (a) Directly projected laser spot with the size of about 1~2 mm (b) Directly projected laser spot with size of 20mm through a laser beam expander (c) Projected ellipse laser pattern with the size of 30 mm ..................................... 9 Figure 1-11. Two galvanometer mirrors scanning system [23] ................................................... 10 Figure 1-12. Two-dimensional resonant micro scanning mirror [30].......................................... 10 Figure 1-13. Laser pointer with digitally controlled and scalable patterns [44] .......................... 12 Figure 2-1. (a) Polymer magnetic scanners mechanical schematics (b) Electromagnetic actuation force [53] ....................................................................................................................................... 14 Figure 2-2. FPCB micromirror. (a) FPCB (b) Mirror plate (c) Aluminum plate (d) Assembled FPCB micromirror ........................................................................................................................ 16 Figure 2-3. Basic flexible circuit construction [55] ..................................................................... 16 Figure 2-4. (a) Original position (b) Deformed position due to electrostatic force ..................... 17 Figure 2-5. Parallel plate capacitor system [58] .......................................................................... 18 Figure 2-6. Static displacement simulation (a) Meshed model. (b) Displacement result. ........... 20 Figure 2-7. Graph of amplitude versus frequency for a damped oscillator when a periodic driving force is present [59]. ......................................................................................................... 21 Figure 2-8. Simulated resonant frequency and model. ................................................................ 22 Figure 3-1. Configuration to form a straight laser line with one FPCB micromirror .................. 25 Figure 3-2. Configuration to form a laser circle or ellipse with two FPCB micromirrors. ......... 26 Figure 3-3. Static laser pattern ..................................................................................................... 26 ix

Figure 4-1. FPCB micromirror prototype .................................................................................... 30 Figure 4-2. Roughness of mirror plate test profile plot ............................................................... 31 Figure 4-3. Measured 3D model of mirror plate .......................................................................... 31 Figure 4-4. Mirror plate curvature profile plot ............................................................................ 32 Figure 4-5. Measured 3D model of MEMS micromirror plate .................................................... 32 Figure 4-6. MEMS micromirror plate curvature profile plot ....................................................... 33 Figure 4-7. Setup of the measurement system ............................................................................. 33 Figure 4-8. Prototype 1 micromirror optical rotation angle/driving signal frequency ................ 34 Figure 4-9. Prototype 2 micromirror optical rotation angle/driving signal frequency. ............... 35 Figure 4-10. Prototype1 micromirror optical rotation angle/driving voltage. ............................. 35 Figure 4-11. Prototype2 micromirror optical rotation angle/driving voltage. ............................. 36 Figure 4-12. Prototype 3 micromirror optical rotation angle/driving signal frequency. ............. 36 Figure 4-13. Prototype 4 micromirror optical rotation angle/driving signal frequency. ............. 37 Figure 4-14. Prototype 3 micromirror optical rotation angle/driving voltage. ............................ 37 Figure 4-15. Prototype 4 micromirror optical rotation angle/driving voltage. ............................ 37 Figure 4-16. Set up of the measurement system for laser spot moving trajectory....................... 38 Figure 4-17. PSD result for laser spot moving trajectory ............................................................ 39 Figure 5-1. Working principle of FPCB micromirror based laser projection availability indicator ....................................................................................................................................................... 40 Figure 5-2. Diagram of control circuit for availability indicator ................................................. 41 Figure 5-3. Control circuit 1 PCB layout of availability indicator: (a) Top component side. (b) Bottom solder side ........................................................................................................................ 42 Figure 5-4. Control circuit 1 finished PCB: (a) Top component side (b) Bottom solder side ..... 43 Figure 5-5. High voltage amplifier PCB layout: (a) Top component side. (b) Bottom solder side ....................................................................................................................................................... 44 Figure 5-6. High voltage amplifier circuit finished PCB: (a) Top component side. (b) Bottom solder side ..................................................................................................................................... 45 Figure 5-7. Control software flow chart for availability indicator ............................................... 46 Figure 5-8. Prototype of the laser availability indicator .............................................................. 48 Figure 5-9. Angle of the ellipse changing with time periodically ............................................... 49 Figure 5-10. The long and short axis of the rotating ellipse ........................................................ 50 x

Figure 5-11. Modeled rotating laser pattern in one period. Both horizontal and vertical axes are laser spot scanning displacement on the screen with unit of mm. ................................................ 50 Figure 5-12. Experimental results of the projected rotating laser pattern in one period. ............ 51 Figure 5-13. Projected laser pattern on rear projection screen by laser availability indicator ..... 52 Figure 6-1. FPCB micromirror for laser pattern pointer. ............................................................. 53 Figure 6-2. FPCB micromirror laser optical system model for laser pattern pointer .................. 54 Figure 6-3. Model of laser pattern pointer device........................................................................ 55 Figure 6-4. Diagram of control circuit for laser pattern pointer .................................................. 55 Figure 6-5. DC/DC boost converter with charge pump circuit schematic ................................... 56 Figure 6-6. Control circuit PCB layout of laser pattern pointer: (a) Top component side. (b) Bottom solder side ........................................................................................................................ 57 Figure 6-7. Laser pattern pointer finished PCB: (a) Top component side. (b) Bottom solder side. ....................................................................................................................................................... 58 Figure 6-8. Control software flow chart for laser pattern pointer ................................................ 59 Figure 6-9. FPCB micromirror laser optical system prototype for laser pattern pointer ............. 60 Figure 6-10. Prototype of laser pattern pointer device ................................................................ 61 Figure 6-11. Projected horizontal laser line (a) Short line (b) Middle long line (c) Long line.... 62 Figure 6-12. Projected vertical laser line (a) Short line (b) Middle long line (c) Long line ........ 63 Figure 6-13. Projected laser circle (a) Small circle (b) Middle size circle (c) Large size circle . 64 Figure 6-14. Projected rotating laser ellipse (a) Small size (b) Middle size (c) Large size ......... 65

xi

Chapter 1. Introduction
1.1 Availability indicator
Availability indicator is a device to show if you are available or not by switching between green and red color lights, e.g., green light means that somebody can have a conversation with you while red color indicates that you should not be interrupted. The research [1] reveals that interruptions consumed 28% of knowledgeable workers' time based on surveys and interviews conducted by Basex over 18 months in the United States in 2005. This translates into 28 billion worker hours lost annually, which is equivalent to $588 billion cost with an average salary of $21/hour for the knowledge worker. For instance, Table 1 illustrates the cost of interruptions for an imaginary professional services company with 10,000 employees. As shown in the table, this company loss almost $400 million per year from unnecessary interruptions which close to a third of the cost of worker's salary.
Table 1. The impact of interruptions on the enterprise [1]

On the other hand, when peripheral tasks interrupt the primary tasks, it requires 3% ~ 27% more time to get the task completed. In the meanwhile mistakes and the anxiety are increased twice with 31%~106% more annoyance than when those peripheral tasks are implemented in the interval between primary tasks [2][3]. Thus the availability indicator is a very useful tool in avoiding interruptions to increase the work productivity and improve the employee satisfaction. The workers can change their status from busy to available by switching the availability indicator lights color from red to green after they finish a primary task. It will keep the workers to focus on the primary task for a necessary longer time without interruption. The current availability indicators are LED based in the market, e.g., the Kuando Busylight 1

presence indicator from Plenom [4] as shown in Figure 1-1. The Busylight presence indicator has five different colors to show busy, busy in a call, do not disturb, away and available which is powered via a 3 meters long USB data cable and attached on the monitor with a double adhesive 3M tape. It is designed for an open plan office environment. In addition, the Busylight has announced a new design for cubicle environments which need an extra-large light as shown in Figure 1-2.

Figure 1-1. Busylight presence indicator [4]

Figure 1-2. Busylight Omega presence indicator [4]

The company, Kangaroo Design Inc. [5], has developed a product called MyFocus system for increasing productivity in collaborative work environment. MyFocus system includes a software to control the blocking/unblocking of communications such as incoming emails, phone calls and messages, etc. and a hardware component that visually signals an individual's availability according to each individual's priority. The LED indicator as shown in Figure 1-3 is a ring with a group of LEDs (red/green) inside. With a single toggle, users will be able to open lines for 2

collaboration and discussion or indicate their unavailability in order to focus on certain tasks without being interrupted.

Figure 1-3. MyFocus LED indicator[5]

Some other LED based availability indicators can be found in the market, e.g., USB light indicator from Luxafor [6] as shown in Figure 1-4(a), Busy light for Lync from Blynclight [7] as shown in Figure 1-4(b).

(a) USB light indicator [6]

(b) Busy light for Lync [7]

Figure 1-4. LED based availability indicator

All these current LED based availability indicator requires a cable to connect with the control computer and power source. They face a serious wiring problem when the office has a lot of cubicles or rooms instead of an open area as shown in their advertisements. The indicator usually needs to be mounted on a cubicle glass wall or the glass window of a door where both the user and others can see it, which is a few meters away from the power source and the toggle (being pressed to control the indictor to show availability) which are close to the user. Wires are required to 3

transfer control signal and power from the power source and toggle to the indicator. The wire connection not only adds the cost, but also makes the office environment cumbersome and inelegant, especially for offices with a large number of cubicles which requires a lot of indicators. The requirement of wiring has become an obstacle to accept the product of availability indicator.

1.2 Laser pointer
Nowadays more and more people are relying on computer PowerPoint slideshow software to give a public presentation [8], especially through projecting the presentation slides on a wall size screen for a large number of audience. While a laser pointer or laser pen for presentation has been developed as interaction device [9][10][11] to help the presenter to draw the audience's attention by positioning the laser point on what the presenter describes. A laser pointer as shown in Figure 1-5 is a handheld laser module which contains a small laser diode and emits an intense beam of laser light with different colors.

Figure 1-5. Laser pointer [79]

The laser pointer usually is integrated with the control key as a laser presenter to control the PowerPoint slideshow page down and page up. For example, Kensington Wireless Presenter with red laser pointer [12] as shown in Figure 1-6 puts your audience to focus on what matters most of your presentation. It features with plug & play 2.4GHz of wireless technology which allows you to control the slide forward or back without unnecessary cables up to 60 feet away. The ergonomically style shape fits comfortably in the palm of human hand. 4

Figure 1-6. Kensington wireless presenter [12]

(a) Wireless presenter R400 [13]

(b) SP600 Smart-pointer [14]

(c) HiRO H50181 presenter [15]

(d) Remote point Ruby presenter [16]

Figure 1-7. Wireless laser presenter

The laser presenters in the market are of many brand names from many different manufactures with various designs (functions, colors, shapes, materials, sizes and price), e.g., Wireless Presenter R400 from Logitech [13] , SP600 Smart-Pointer (Black) 2.4Ghz RF Wireless Presenter from Satechi [14], HiRO H50181 4 in 1 2.4 GHz WiFi Black Presenter Green Laser Pointer from Hiro Inc. [15], Remote point Ruby Presenter from SMK-Link Electronics [16] as shown in Figure 1-7, etc.. 5

The laser pointer usually is low powered laser and do not pose a serious risk of eye injury unless it is misused intentionally. According to laser safety regulation from the U.S. Food and Drug Administration (FDA), the laser is classed as Table 2 [17] which also includes the roughly equivalent International Electrotechnical Commission (IEC) classes. Usually the laser pointer is restricted to either class 3A (<5.0mW) or class 2 (<1.0mW) according to the local regulation. For example, in the US and Canada class 3A is permitted for the application in laser pointer. In Australia and most of European countries class 2 is the maximum allowed class.
Table 2. FDA Laser hazard classes [80] Max Laser power

Class Class FDA IEC I IIa, II 1, 1M

Laser Product Hazard

Product Examples

IIIa

IIIb

IV

Considered non-hazardous. Hazard increases if viewed  laser printers, CD players 0.4mW with optical aids, including magnifiers, binoculars, or  DVD players telescopes. 2, Hazard increases when viewed directly for long periods 1.0mW  bar code scanners 2M of time. Hazard increases if viewed with optical aids. Depending on power and beam area, can be momentarily hazardous when directly viewed or when staring directly 3R 5.0mW  laser pointers at the beam with an unaided eye. Risk of injury increases when viewed with optical aids. Immediate skin hazard from direct beam and immediate  laser light show ,projectors 3B 500mW eye hazard when viewed directly.  industrial lasers, research lasers  laser light show projectors, Immediate skin hazard and eye hazard from exposure to industrial lasers, research 4 >500mW either the direct or reflected beam; may also present a fire lasers, medical device lasers for hazard. eye surgery or skin treatments

Almost all commercial laser pointers give one small laser dot to indicate the focus location of the presentation. However, it is not very visible and takes some time for audience to locate the laser dot on the new slide, especially when the slide is very bright. The center of the laser spot is glare which is not comfortable and the outside is blur which is not look nice and clean. In addition, the current laser pointer cannot highlight an area, or a line or a column. The presenter has to wave the laser pen to make a circle, a horizontal/vertical line manually to help audience locate the laser dot or highlight a certain area/line/column. On the other hand, the enforcement is often not very strict and also due to the visibility problem, the manufacture of laser pointer increase the laser output power to higher the laser point brightness and increase the laser spot visibility to gain the market share. Lucid Optical Services Ltd. [18] presented a study of laser pointer safety in 2010, which 20 low cost laser pointer were purchased 6

to test the output power. Only one of them had a power of less than 1mW as required for class 2 laser pointer. 16 of 20 laser pointers had over 5mW maximum output laser power for Class 3R devices. The laser pointer are also useful tools for lecturer in classroom, conventions, meetings and seminars, which has become more and more popular. Because of the low cost and widespread supply, the laser pointer are widely purchased and used by large populated general public, including children, and used in ways not recommended by the manufacturers. Consequently, a lot of laser pointer related eye injuries [19][20][21][22] were reported around the world. Transient exposure to the laser light is unlikely to cause long term damage, but longer exposure may lead to permanent retinal injury. They also could result in a painful red eye or dazzle. If the laser pointer was shot at the eyes of a driver or a pilot, this dazzle could be very dangerous. Because of the widespread availability of the laser pointer which children can purchase it easily, they treat the laser pointer as a new toy. They could stare at directly the laser beam for the longest time to win their game. This would be damage their vision even with class 2 laser pointer, which are allowed all around the world.

1.3 Laser pattern generation and projection technology
Availability indicator 2 Availability indicator 1

Projected laser pattern 2-Available

Projected laser pattern 1-Busy

Figure 1-8. Laser availability indicator

This thesis proposes a solution, i.e., generating and projecting laser pattern, to solve the problem

7

plaguing the availability indicator, i.e., the wiring problem, and the problem with the current laser pointers, i.e., low visibility with low laser power and no highlighting function. The availability indicator is placed close to the toggle and power source such as on the user's table, computer or wall as shown in Figure 1-8. It generates a bright red/green laser pattern and projects it onto a remote surface which is a few meters away and could be a cubicle glass wall or a glass window of a door with a small translucent film attached if the glass is very transparent. The projected laser pattern has a size of a few centimeters which can be seen from both side of the screen. So it does not require to install loner cable to connect with the control computer or power source. Furthermore, the laser pattern projection technology can well solve the wiring problem of the traditional LED based availability indicator.

(a) Horizontal laser line

(b) Vertical laser line

(c) Laser circle pattern

(d) Laser ellipse pattern

Figure 1-9. Laser projection pattern

For the laser pointer by projecting a laser pattern, e.g., horizontal line, vertical line, circle or ellipse as shown in Figure 1-9, even a rotating laser pattern on the big screen can increase the visibility and draw the audience attention with keeping the laser output power in a safety class. 8

The moving beam can also avoid that someone stare into the beam intentionally for a longer time, especially for the children. Considering laser safety and comfort, low laser power is used. To make the projected laser pattern very visible, the sign must be big enough, e.g., a few centimeters and bright. With lower laser power (1mW), it is difficult to meet both the size and brightness requirements if a laser spot is directly projected as shown in Figures. 1-10(a) and 1-10(b).

(a)

(b)

(c)

Figure 1-10. Projected laser spot or laser pattern with the same power of 0.065mw and the same camera setting such as the aperture speed of 1/25 second. (a) Directly projected laser spot with the size of about 1~2 mm (b) Directly projected laser spot with size of 20mm through a laser beam expander (c) Projected ellipse laser pattern with the size of 30 mm

In Figure 1-10, all photos are taken with the same projected laser beam power (0.065mw), same camera setting such as aperture and speed, same distance between the display screen and laser, same ambient illumination. Figure 1-10(a) and 1-10 (b) are directly projected laser spots. Figure 1-10 (a) is bright but the size is too small, which is not visible when it is projected on a cubicle wall, a door windows or a bright screen. Figure 1-10 (b) is larger but too dim, which spreads the laser power to a 2cm are through a beam expander. This thesis proposes to generate a laser pattern such as an ellipse shape with high frequency and project it on a see-through and reflective surface to solve this problem, i.e., satisfying both the size and brightness requirements. At any moment, all the laser power is focused on one small point (about 1~2 mm in diameter) which is bright. At the same time, this laser spot follows a trajectory of an ellipse with the size of a few centimeters and a high frequency (refreshing rate >60Hz). Thus a bright and steady laser ellipse is formed as shown in Figure 1-10 (c) which is bright and large. In addition, the ellipse laser pattern can rotate to be more visible and more attractive to the audience. Normally in order to generate a laser pattern, two galvanometer mirrors are used to steer a laser 9

beam [23]. A galvanometer mirror projection system includes a motor, an encoder, a mirror and a servo circuit board, which is very complex, expensive and bulky [24][25] as shown in Figure 111.

Figure 1-11. Two galvanometer mirrors scanning system [23]

MEMS micromirrors can replace galvanometer mirrors in the applications which can tolerate relatively small aperture (<1mm) and rotation angle to scan laser beam to form patterns [26][27][28][29]. A MEMS micromirror [30] as shown in Figure 1-12 includes a silicon based actuator and a mirror plate that has a much compact size than a galvanometer mirror. It is fabricated using micromachining technology in a clean room and can be driven by various mechanism actuators such as electrostatic [31][32][33], thermal [34][35], magnetic [36][37] and piezoelectric [38][39].

Figure 1-12. Two-dimensional resonant micro scanning mirror [30]

Electrostatic actuators can be fabricated with a simple MEMS process and consume relatively 10

low power, but it generates small displacement with high actuation voltage. However, the electrostatic actuation's fast response time (less than 0.1ms), low power consumption, and the easiness of integration and normal testing electrical control system make it one of the best choices for micromirror actuation. The parallel-plate electrostatic actuator is relatively simple design structure in terms of design and fabrication; however, it suffers from the pull-in effect, which limits its scanning angle. To overcome the pull-in effect, comb drive actuators have been developed which is regarded as the most feasible technique for obtaining large angular motion with linear displacement verse the driving voltage. A MEMS thermal actuator is a micromechanical device that typically generates motion by different thermal expansion. It usually consists of two micro actuators which operates on the basis of heating thermal expansion. Because the expansion rates are different between the cold and hot arms or two different materials, this different expansion results in the beam bending motion according to different structures. However, in general, thermal actuation have higher power consumption and slow response time. The electromagnetic actuation provides relatively large torque with increased volume due to extra permanent magnet integration and larger driving current. A micromirror can be driven in two ways by electromagnetic actuation, either by using Lorentz force to move a patterned coil by exerting external magnetic field or by repulsive/attractive forces to repel/attract the magnetic material which is attached to the mirror on its surface. The piezoelectric actuation takes advantage of the corresponding physical deformation property when electrical voltage is applied. The piezoelectric actuation can generate a large force density at a low actuation voltage and linear voltage­rotation characteristics, however a complex fabrication process and structural deformation during the actuation are required for the thin-film piezoelectric material. All of these MEMS micromirrors are not suitable for the availability indicator application because of: 1) Small thickness. Normally a MEMS micromirror has a thickness of several µm to several tens of µm due to the fabrication limitation. The low thickness causes low static flatness of the mirror plate after fabrication due to the residual stress gradient [40][41], and dynamic deformation [42][43] when the micromirror oscillates; 2) Small aperture. A MEMS micromirror usually has an aperture of < 1mm, which requires more optics to reduce the laser beam to be 11

smaller than the micromirror aperture and need much more time to alignment the laser optical system; 3) Relative high cost. Generally MEMS micromirrors have low cost when the volume is high such as more than 10, 000~100,000 depending on the process.

Figure 1-13. Laser pointer with digitally controlled and scalable patterns [44]

A MEMS scanning micromirror based Taiwanese company, Opus Microsystems Corporation [44], claimed the world first laser pointer with digitally controlled and scalable patterns as shown in Figure 1-13 in 2008. It can generate larger circle/ellipse laser pattern (~24cm diameter), smaller circle/ellipse laser pattern (~8cm diameter), and longer (~24cm) and shorter (~8cm) laser underline at 3 meters distance using MEMS scanning micromirrors. The four different laser pattern is switched through a thumb navigation control pushbutton. However it is hard to find this product in the market, even on their website product list which seems it did not become a commercial product. The reason should be the high cost. Two 1D micromirrors or one 2D micromirror cost around $30 based on the high volume price. So the cost will be increases by 30-100% based on the existing laser pointer. Thus, the proposed solution must be of very low cost, e.g., increase the cost of <5~10%. In addition, the attempted laser pointer cannot generate a rotating ellipse which is better in terms of increasing visibility.

1.4 Thesis objective and outline
The objectives of the thesis are as follows. 1. Develop a novel micromirror which has much larger aperture, much higher surface quality and much lower cost than conventional MEMs micromirrors. It should be driven by 12

electrostatics force to have low power consumption. 2. Develop the laser pattern generating technology using the novel micromirror. These laser patterns include static circle, rotating ellipse, horizontal or vertical line. 3. Develop a laser availability indicator using the micromirror developed in this thesis, which is able to generate laser pattern and project it to a remote translucent surface to solve the wiring problem associated with the current availability indicators. 4. Develop a presentation laser pattern pointer using the micromirror developed in this thesis. The laser pattern pointer is able to significantly improve the visibility using laser pattern instead of a laser dot with the laser power equal or less than that used in the existing laser presenter. Such that the audience can easily and quickly locate the laser pattern even the presentation slide is very bright without waving the laser pointer manually by the presenter. In addition, the laser pattern pointer should provide the highlight function, i.e., using size adjustable circle, horizontal or vertical line to highlight an area, a row or a column. The thesis is organized as follows: The design of FPCB micromirror is introduced in Chapter 2. The modeling of generating rotating ellipse is presented in Chapter 3. Chapter 4 shows the prototype of FPCB micromirror and test result. Chapter 5 and Chapter 6 describe the design, prototype and test results of availability indicator and laser pattern pointer respectively. Conclusions are summarized in Chapter 7.

13

Chapter 2. Design of FPCB micromirror
This thesis proposes the FPCB (flexible printed circuit board) micromirror technology to replace the MEMS micromirrors in the application of laser pattern projection. The FPCB micromirror consists of a FPCB electrostatic rotation parallel plate actuator and a silicon mirror plate. The silicon mirror plate is bonded with the FPCB actuator after they are fabricated separately. Since the polyimide, the FPCB substrate material, was invented in the early 1960's, it has found numerous uses in MEMS technology which could serve as photoresistor, sacrificial layer, structure layer or substrate [45]. It can also be found in different sensor based MEMS application, for example, temperature sensing array on a flexible polyimide substrate [46][47], polyimide flexible tactile sensor skin [48], miniature electrocardiography sensor [49], flexible sensor and actuator system for space inflatable structures [50]. A double size FPCB was proposed to use as a flexible thermoelectric generator [51].

Figure 2-1. (a) Polymer magnetic scanners mechanical schematics (b) Electromagnetic actuation force [53]

14

The polyimide material is also used as actuator application, for instance, an optical scanner fabricated using photolithography on a polyimide substrate [52] and polymer (Polyimide is a polymer of imide monomers) magnetic scanners as shown in Figure 2-1 for bar code application [53]. The scanning polymer magnetic micromirror which is used in a barcode reading system could be used to generate laser pattern. However it consumes an actuation power of 168mW, needs an external coil to generate the driving magnetic field and is fabricated with molded polymers and electroplated magnetic films for magnetic actuation instead of a commercial process. So it has bigger size and more cost than the FPCB micromirror proposed in this thesis. Through the literature review of FPCB MEMS application, this thesis might be the first report on FPCB electrostatic actuator micromirror based on low cost mature commercial FPCB fabrication process. The silicon mirror plate is fabricated using simple and low cost process, i.e., coating a polished silicon wafer with aluminum film and dicing it. The mirror plate has the thickness of a silicon wafer (several 100 µm) and a large aperture (a few mm) with very high surface quality, i.e., as high as the polished silicon wafer. The FPCB micromirror has much high surface quality, much larger aperture and much lower cost even for small volume than conventional MEMS micromirrors, all of these advantages make it suitable for the application of generating laser pattern for laser availability indicator and laser pattern pointer.

2.1 Structure and working principle introduction
The FPCB micromirror consists of a rotation electrostatic parallel plate actuator [54] and a silicon mirror plate coated with aluminum as shown in Figure 2-2. The rotation actuator includes a rotating electrode, fixed electrode, two bending beams served as the rotation springs and an anchor pad, as shown in Figure 2-2. The rotation electrode, the two bending beams and the anchor pad are made of FPCB which is a Polyimide based thin film with copper coating fabricated through commercial FPCB process. Figure 2-3 shows the basic flexible circuit construction [55]. The copper coating pad serves as moving electrode in the parallel plate actuator and gets driving voltage through the copper coating layer of the anchor pad with soldering wire on it. The fixed electrode is an aluminum plate with a slightly higher support pad which is fabricated together with all the mechanical parts for the availability indicator. 15

Figure 2-2. FPCB micromirror. (a) FPCB (b) Mirror plate (c) Aluminum plate (d) Assembled FPCB micromirror

Figure 2-3. Basic flexible circuit construction [55]

The silicon mirror plate is fabricated using two simple steps, i.e., coating a polished silicon wafer with 100 nm aluminum and dicing it. After being fabricated, it is bonded on the top of the FPCB moving electrode as shown in Figure 2-2 (d). The mirror plate can be easily fabricated to be several hundred micrometers thick with very high surface quality. 16

Table 3. FPCB micromirror dimension (unit: mm) FPCB Anchor pad Symbol Value a 3.0 Rotation electrode Rotation electrode Beam distance b 4.0 w 4.0 h 1.66 Beam dimension i xg 0.34 x 1.7(Design 1) 0.34 x 2.7 (Design 2) Mirror Length of each side Symbol Value f 3.3 t 0.35 lxc 6.0 x 3.4 e 4.3 d 0.3(Design 1) 0.2(Design 2) Thickness Length x Width Fixed electrode Support pad Gap

Table 3 lists all dimensions of the FPCB micromirror for two designs which will be used in the application of laser availability indicator (Design 1) and laser pattern pointer (Design 2). The difference between these two designs are the length of the spring beam and the gap of parallel plate. The FPCB has a polyimide base layer and coating with a thin copper layer. The thickness of FPCB is 60µm. The silicon mirror plate is 350µm thick with the flatness and roughness as good as those of a polished silicon wafer.

Figure 2-4. (a) Original position (b) Deformed position due to electrostatic force

FPCB anchor pad is bonded to the supporting pad of the aluminum plate. When applying a voltage between the moving copper electrode and the fixed electrode of the aluminum plate the 17

mirror plate is attracted to the fixed electrode due to the electrostatics force [56][57] as shown in Figure 2-4. The polyimide layer provides electrical isolation between the moving copper electrode and the fixed electrode. The FPCB is operated in resonant mode by applying sinusoidal or square wave driving single which significantly amplifies the static rotation angle. The movement of mirror plate can be controlled by applying different driving signal.

2.2 Modeling
2.2.1 Static force and deformation The parallel plate electrostatic actuator [54] consists of a fixed and a moving conductive electrode plate as shown in Figure 2-5 [58]. The moving electrode is suspended with the spring beam. When a voltage is applied between these two electrodes, an electrostatic force is generated which attract the plates towards to each other.

Figure 2-5. Parallel plate capacitor system [58]

The electrostatic force can be calculated through the Eq. (1).   = 1 0    2 2 (0 + )2 (1)

Where 0 is the permittivity of free space (0 = 8.85 × 10-12  /),  is the relative permittivity of the dielectric ( = 1.0 if air is the dielectric material), and A is the overlapping surface area of the electrodes which is  = 0.004 × 0.004 = 1.6 - 052 for these designs. The electrostatic static forces are calculated and listed in Table 4.

18

Table 4. Electrostatic force VS applied voltage Voltage DC/V 10 20 30 40 50 60 70 80 90 100 110 120 130 140 150 160 170 180 190 200 Design 1 Gap 0.0003m 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 Force N 0.3mm gap 7.867E-08 3.147E-07 7.080E-07 1.259E-06 1.967E-06 2.832E-06 3.855E-06 5.035E-06 6.372E-06 7.867E-06 9.519E-06 1.133E-05 1.329E-05 1.542E-05 1.770E-05 2.014E-05 2.273E-05 2.549E-05 2.840E-05 3.147E-05 Force mN 0.3mm gap 0.000079 0.000315 0.000708 0.001259 0.001967 0.002832 0.003855 0.005035 0.006372 0.007867 0.009519 0.011328 0.013295 0.015419 0.017700 0.020139 0.022735 0.025488 0.028399 0.031467 Design 2 Gap 0.0002m 0.0002 0.0002 0.0002 0.0002 0.0002 0.0002 0.0002 0.0002 0.0002 0.0002 0.0002 0.0002 0.0002 0.0002 0.0002 0.0002 0.0002 0.0002 0.0002 0.0002 Force N 0.2mm gap 1.770E-07 7.080E-07 1.593E-06 2.832E-06 4.425E-06 6.372E-06 8.673E-06 1.133E-05 1.434E-05 1.770E-05 2.142E-05 2.549E-05 2.991E-05 3.469E-05 3.983E-05 4.531E-05 5.115E-05 5.735E-05 6.390E-05 7.080E-05 Force mN 0.2mm gap 0.000177 0.000708 0.001593 0.002832 0.004425 0.006372 0.008673 0.011328 0.014337 0.017700 0.021417 0.025488 0.029913 0.034692 0.039825 0.045312 0.051153 0.057348 0.063897 0.070800

In order to find the micromirror scanning angle with applied driving voltage, a simulation model was built in Solidworks according to the dimensions listed in Table 3 for these two designs and meshed by 0.2mm X 0.01mm as shown in Figure 2-6(a). The thickness were set to 0.05mm and 0.01mm for the polyimide layer and the copper layer respectively according the measurement of the FPCB sample. The Young's modulus used in the simulation are 2.5GPa for the FPCB based layer which is made of Polyimide material, and 110GPa for the copper layer. The static displacement results are shown in Figure 2-6(b) and the detail displacement and mechanical scanning angle for a specific applied driving voltage are listed in Table 5. According to the static displacement simulation result, the rotation angle of FPCB micromirror is not large enough to reach 0.86 o which will generate a 6cm size laser pattern at one meter away, especially for the lower driving voltage.

19

(a)

(b) Figure 2-6. Static displacement simulation (a) Meshed model. (b) Displacement result. Table 5. Static displacement simulation result Voltage DC/V 10 50 100 150 180 200 Design 1 Force N 0.3mm gap 7.867E-08 1.967E-06 7.867E-06 1.770E-05 2.549E-05 3.147E-05 Displacement mm 3.750E-05 9.377E-04 3.750E-03 8.438E-03 1.215E-02 1.500E-02 Displacement Angle/degree 3.58E-04 8.96E-03 3.58E-02 8.06E-02 1.16E-01 1.43E-01 Design 2 Force N 0.2mm gap 1.770E-07 4.425E-06 1.770E-05 3.983E-05 5.735E-05 7.080E-05 Displacement mm 1.725E-04 4.311E-03 1.725E-02 3.881E-02 5.588E-02 6.898E-02 Displacement Angle/degree 1.41E-03 3.53E-02 1.41E-01 3.18E-01 4.58E-01 5.65E-01

2.2.2 Forced resonant vibration To increase the vibration amplitude of the FPCB micromirror, it can work at resonant scanning mode by applying a periodic driving force instead of a static force. Figure 2-7 shows the graph of amplitude versus frequency for the forced oscillator with different damping coefficient b [59]. The amplitude will increase dramatically when the driving force is close to the natural frequency(0 ). This phenomenon is called resonance.

20

Figure 2-7. Graph of amplitude versus frequency for a damped oscillator when a periodic driving force is present [59].

2.2.3 Rotation angle and gap determination The step height of the fixed electrode is the gap between the rotation and fixed electrode of the FPCB micromirror. The gap is determined according to two factors, i.e., 1) The "pull-in" effect associated with the electrostatic rotation actuator [60][61]; and 2) The un-flatness of the bending beams caused displacement of the rotation FPCB electrode tip. Factor 1: Due to the "pull-in" effect and the resonating vibration of the FPCB electrostatic rotation actuator, the gap between the fixed and rotation electrodes to avoid "pull-in" is  = ( + )  tan(  ) 0.731 (1)

Where  is the rotation angle,  is the gap and ( + ) is the moving electrode length plus the beam length. 0.731 is the ratio of the maximum rotation angle [61] without causing "pull-in" to the angle when the rotation electrode tip touches the fixed electrode for a resonant rotation actuator. For the availability indicator application, in order to generate the laser pattern and project it to the screen one meter away with the size of 6cm, the FPCB micromirror needs to rotate 1 6  = ± arctan ( )  0.86° 4 100 (2)

In the Eq. (2), because the FPCB micromirror is working in resonant vibration mode and 21

scanning in both direction and the optical scanning angle doubles the mechanical rotation angle,  equals to quarter of the optical scanning angle. ( + ) is 5.7mm in the design 1, so the corresponding gap should be 0.12 mm from Eq. (1). For the laser pattern pointer application, it only requires half of the scanning angle as availability indicator due to the longer distance from the laser pattern pointer to the screen, so the rotation angle should be 0.34o. Therefore ( + ) is 6.7mm in the design 2 and the corresponding gap is 0.07 mm from Eq. (1). Factor 2: The deformation of the FPCB beams causes vertical displacement of the rotation electrode tip, the maximum value of which is less than 0.1 mm by approximate experimental measurement. Thus for the presented prototype the value of gaps were taken as d=0.3 mm for design 1 and d=0.2mm for design 2. They will be safe in avoiding the "pull-in" effect with considering the effect of the deformation of the FPCB. 2.2.4 Resonant frequency

Figure 2-8. Simulated resonant frequency and model.

The resonant vibration mode of the FPCB micromirror is simulated in Solidworks with all detail dimensions as shown in Table 3. Figure 2-8 shows the simulation result for the first mode with the frequency of 89.81Hz for design 1 and 58.22Hz for design 2 respectively which are high enough to form a static image without flashing. The Young's modulus and the model dimension used for the polyimide and the copper are same as section 2.2.1 for the simulation of the static force

22

displacement. 2.2.5 Stress The maximum stress in the polyimide layer is simulated by applying a force on the rotation electrode with the angle of 0.86° according to Eq. (2). The corresponding maximum stress is 28MPa which is much less than the yield strength of the polyimide material- 80MPa [62] .

2.3 Advantages of FPCB micromirror
The proposed FPCB micromirror has much lower cost, lager aperture size and also higher surface quality than conventional MEMS micromirrors. 2.3.1 Cost The FPCB is fabricated using a very low cost and mature commercial process. The FPCB technology can print electronics circuit on flexible plastics substrate, such as polyimide or polyester film which can be bend during its use. Right now FPCB are widely used in most of consumer products, industrial and medical devices where flex interconnections are required in a compact package, for example cellphone, laptop computer, iPAD.... It is also ease for manufacture and assembly with only around 3 cent/cm2 cost. That means it only costs 1 cent for a 4mm X 8mm FPCB actuator. The silicon mirror plate is fabricated using simple and low cost process, i.e., coating a polished silicon wafer with metal film and dicing it. A 6 inch wafer which costs around $3-5 /pieces can be diced to around 1500 pieces of 3.3mm X 3.3mm size silicon mirror plates. Through the MEMS process 10 pieces silicon wafer can be coated together in one chamber using evaporating coating machine and then dicing them. The processing takes around 10 hours which is estimated to cost $1000 (at $100 hourly rate). That means each 3.3mm X 3.3mm size silicon mirror plate will only cost $(1000 + 5 × 10)/(1500 × 10) = $0.07 . Therefore each FPCB micromirror costs less than 10 cents, which is much lower than the conventional MEMS micromirror that costs around $20-30. 2.3.2 Aperture size The FPCB micromirror can have larger aperture size due to the separate fabrication process. The FPCB actuator and the silicon mirror are fabricated individually and boned together with epoxy 23

later. Hence it becomes possible to select a larger size mirror plate which is 3.3mm X 3.3mm in the FPCB micromirror design. On the contrary, the MEMS micromirror integrates the mirror plate and the actuator structure together in a 4X4mm size space. Usually the actuator take much space of the design and the rest of 1-2mm can be used as the mirror plate. Moreover due to the limitation of the fabrication process the mirror plate size is limited. For example, the MciraGemSi process [63] limit the maximum trench size to 1.5mm, which will limit the maximum mirror plate size to 1.5mm width. So the MEMS micromirror usually has 1-2mm size aperture or smaller. With the larger aperture size, higher surface quality in terms of flatness and surface finishing is easy to achieve. In addition, it does not require extra optics to reduce the laser beam size to fit the micromirror size and nor much effort to align the laser optical system. 2.3.3 Surface quality With the a few hundred um of thickness of the silicon wafer, it is easy to get high quality surface finish with existing fabrication process. A few nm or 0.1nm range surface roughness can be achieved easily and usually with tens of meters radius of curvature which is much larger than that of the MEMS based micromirror which is around less a few meter [64]. The design of FPCB micromirror allows to take advantage of this high quality silicon wafer mirror plate due to the separated fabrication process. In contrast, the conventional MEMs micromirror is fabricated based on either surface-micromachining technology [65][66] or siliconon-insulator(SOI) [67] bulk micromachining technology [68][69][70]. The surface-

micromachining technology has a limitation of each layer on the substrate less than 2-3um[71]. So it is hard to get thicker mirror plate, which leads to low flatness, e.g., 18 ~80mm of radius of curvature [72][41] due to the residual stress difference between thin-film mirror plate and the coated metal layer[73]. SOI based micormirror can have thicker mirror plate (usually 30-50um thickness) with a thin metal layer, e.g., 40-60 nanometers of gold or aluminum film [74]. The different residual stresses in the metal film and the SOI device layer causes the deformation of the mirror plate. The SOI micormirrors have radius of curvature 1-4 meters [41][75][76]. To compensate the difference between the metal layer and the SOI plate, the reflective metal can be applied to both side of the SOI plate[77]. But this will increase the cost of micromirror significantly.

24

Chapter 3. Laser pattern generation
For both applications of laser availability indicator and laser pattern pointer, to solve their existing problem a laser pattern needs to be generated and projected with the laser light source and FPCB micromirror system. This Chapter will introduce the principle of forming a laser pattern with the FPCB micromirrors.

3.1 Generating straight laser line
To generate a straight laser line on the screen, the FPCB micromirror needs to be positioned in 45º angle with the laser beam as shown in Figure 3-1. When the micromirror vibrates in a high frequency a straight laser line will be generated on the screen. The length of laser line is proportional to the FPCB micromirror scanning angle. If it vibrates at its natural frequency a longer laser line will be formed.

Laser line Screen

FPCB micromirror

Laser module Figure 3-1. Configuration to form a straight laser line with one FPCB micromirror

3.2 Generating static laser circle/ellipse
Two identical FPCB micromirrors are positioned orthogonally as shown in Figure 3-2, i.e., one is to generate the horizontal (x-axis) displacement of the laser beam on the screen and the other is to generate vertical (y-axis) displacement. These two displacements follow Eqs. (3) and (4). 25

 = ()   = ( + ) 2

(3) (4)

Laser circle or ellipse Vertical y-FPCB micromirror

Laser module

Screen Horizontal x-FPCB micromirror Figure 3-2. Configuration to form a laser circle or ellipse with two FPCB micromirrors.

Where  is the laser spot displacement in horizontal direction generated by the x-axis micromirror.  is the displacement along y-axis generated by the y-axis micromirror.  is the mirror vibration frequency. Figure 3-3 shows the patterns generated from Eq. (3) and (4) with  = 3,  = 2 for ellipse and  = 2,  = 2 for circle modelled by Maple software. A static circle or ellipse laser pattern is generated as long as the vibration frequencies of the x-axis and y-axis micromirrors are the same.
3 2 1 0 -3 -2 -1 -1 -2 -3 0 1 2 3 -3 -2 -1 -1 -2 -3 3 2 1 0 0 1 2 3

(a) Ellipse with M=3 and N=2

(b) Circle with M=N =2

Figure 3-3. Static laser pattern

26

3.3 Generate rotating ellipse laser pattern
If the two FPCB micromirrors vibrate at slightly different frequencies, a rotating ellipse laser pattern can be generated. The following is the derivation. The two micromirrors vibrate following the Eqs. (5) and (6) with different frequencies.  = [(0 + )]   = [(0 - ) + ] 2 (5) (6)

Where 0 is the base frequency and r is the biased frequency. A general ellipse equation [78] can be written as.  2 +  +  2 +  +  +  = 0 (7)

Where , , , ,  and  are coefficients. The following equation is obtained by the square of Eq. (5) + the square of Eq. (6).  2  2 + = 1 + (20 )(2) 2  2 Multiply Eqs. (5) and (6) leads to (20 ) = 2 - (2) 

(8)

(9)

Submitting Eq. (9) into Eq. (8) results in 1 2 2 (2) 1 2  -  +  + 2 (2) - 1 = 0 2   2 Comparing Eq. (10) and (7) the coefficients of Eq. (10) can be found as  = 1 2 (2) 1 ,  = - ,  = ,  = 0,  = 0, 2   2  = 2 (2) - 1 = - 2 (2) A general ellipse can be written as ( - 0 )2 ( - 0 )2 + =1 2  2 27

(10)

(11)

(12)

 =

1  ( ) 2  - 

(13)

Where  and  are the radius of the two axes of the ellipse. (0 , 0 ) is the center of the ellipse.  is the angle of the ellipse. These variables can be obtained as 0 = - =0 2

(14)

-  0 = =0 2  -   =   

(15)

(16)

-   =    Where  =  2  +  + 2 ,   = 0,   = 2  -  +  2 ,   =  Substituting Eq. (11) to Eq. (13), the following equation is obtained. 1 2(2)  = [ ] 2 2 -  2 Substituting Eq. (11) to Eq. (18) and the result into Eqs. (16) and (17) leads to 2  2  2 (2)  =  2   2  - 2(2) + 2 2 

(17)

(18)

(19)

(20)

2  2  2 (2)  =  2 2    + 2(2) + 2  2 

(21)

Eq. (19) shows the angle of the ellipse is a periodic function of time with the period of 28

 =

 

(22)

The radius of the ellipse are the periodic function of time with period of , =  2

(23)

In order to generate a rotating ellipse, the following condition needs to be met.   0

(24)

So with the two FPCB micromirrors and the laser optical system, different laser pattern can be generated through controlling the movement of the mirror plate. When the driving frequencies of these two micromirror are slightly different, a rotating laser ellipse will be formed.

29

Chapter 4. Prototype and test
Four FPCB micromirror prototypes (two for design 1 and two for design 2) were made for testing analysis of the rotation performance. Two critical parameters, natural resonant frequency and rotation angle with different driving voltages, were found from the experiments. The moving trajectory of the laser spot caused by the vibration of the FPCB micromirror was also measured with different driving signals by a Position Sensitive Detector.

4.1 FPCB micromirror

Figure 4-1. FPCB micromirror prototype

After the FPCB and the mirror plate had been fabricated separately, epoxy was used to bond the mirror plate to the FPCB as well as the anchor pad of the FPCB to the support pad of the aluminum fixed electrode. Figure 4-1 shows the finished FPCB micromirror prototype.

4.2 Mirror plate surface finishing
The mirror plate surface quality was measured by the ZYGO 3D Optical Surface Profiler which can profile heights ranging from less than 1nm up to 20000 µm at high speeds, independent of surface texture. With ZYGO's Coherence Scanning Interferometry (CSI) technology, it easily measures a wide range of surfaces, including smooth, rough, flat, sloped, and stepped surfaces with less than 0.1nm vertical resolution. 30

4.2.1 Roughness

Figure 4-2. Roughness of mirror plate test profile plot

Figure 4-2 presents the test result on a small area (0.5mm x 0.5mm) of the mirror plate from ZYGO profiler which shows that the roughness of the mirror plate prototype is around 2nm. 4.2.2 Radius of curvature

Figure 4-3. Measured 3D model of mirror plate

The 3D model tested by the ZYGO profiler is shown in Figure 4-3. And Figure 4-4 shows the detail profile plot which illustrate that the arc height is 56nm with 3.0mm arc width. Therefore the calculated radius of curvature for the mirror plate is 20 meters. It is much longer than the MEMS micromirror plate. Two MEMS micromirror plates were tested with the same machine. Both the 31

radius of curvature are less than 20 centimeter which is 100 times shorter than the FPCB mirror plate.

Figure 4-4. Mirror plate curvature profile plot

To compare the FPCB micromirror plate with the conventional MEMS micromirror plate, a 1.5mm x 1.5mm SOIMUMPs based MEMS micromirror plate with metal coating was tested by the same ZYGO profiler with the same setting and lens. Figure 4-5 and Figure 4-6 show the 3D model and the detail profile plot respectively. The arc height is 2.67um with 1.34mm arc width, which shows that radius of curvature are around 8.4 centimeter.

Figure 4-5. Measured 3D model of MEMS micromirror plate

32

Figure 4-6. MEMS micromirror plate curvature profile plot

4.3 PCB micromirror scanning angle test

Functional generator FPCB micromirror Testing grid paper

Power supply

Generated laser line High voltage amplifier Red laser module

Figure 4-7. Setup of the measurement system

The measurement set up is shown in Figure 4-7 to test the performance of the FPCB micromirror. A grid paper was used as the projection screen to measure the laser line length. The micromirror 33

scanning angle can be calculated by measuring the laser spot displacement on the grid paper and the distance between the screen and the micromirror. In the measurement, a function generator was used to generate the control signal for convenience in varying the frequency and control voltage. And then the 3.0V level control signal was amplified to 200V level signal to drive the electrostatic parallel plate of the FPCB micromirror through a general high voltage amplifier. A driving signal with frequencies from 0 to 200Hz and fixed voltages of 100V and 180V were applied to these four FPCB micromirror prototypes. The results of design 1 are shown in Figures 4-8 and 4-9. According to the testing results, the first mode resonant frequency is 85Hz for the prototype 1 and 91Hz for the prototype 2. The difference in resonant frequency of these two prototypes of design 1, the discrepancy between the simulated resonant frequency and the tested one, and the difference between rotation angles of them can be attributed to the following reasons, i.e., 1) The bonding of the anchor pad of the FPCB to the support pad of the aluminum fixed electrode is manual and is not consistent and accurate. For example, if the anchor pad is beyond the edge of the support pad, the effective stiffness of the assembled FPCB micromirror would be lower than the designed value; 2) The mirror plate is bonded to the FPCB manually which is not accurate and consistent. As a result, different prototypes have different moment of inertia, which affects the resonant frequency; and 3) The FPCB beams have deformation after fabrication, which affects the gap and then affect the electrostatic torque and rotation angle. This deformation is not consistent in the different prototypes.
5

Optical rotation angle (°)

4 3 2 1 0 0 40 80 120 160 200 Driving signal frequency(Hz) Prototype 1 micromirror Vol=180V Vol=100V

Figure 4-8. Prototype 1 micromirror optical rotation angle/driving signal frequency

34

2.5

Mirror rotation angle(°)

2 1.5 1 0.5 0 0 40

Prototype 2 micromirror Vol=180V Vol=100V

80 120 160 Driving Signal Frequency(Hz)

200

Figure 4-9. Prototype 2 micromirror optical rotation angle/driving signal frequency.

The rotation angle of each micromirror with different driving voltages at its resonant frequency was measured as shown in Figures 4-10 and 4-11. The maximum optical rotation angles are 5.26° and 2.69° for the prototype 1 and prototype 2 micromirrors respectively at 200V driving voltage. The significant difference in rotation angle between two micromirrors is because the deformation of the FPCB beams causes a smaller gap of the prototype 1 micromirror than that of the prototype 2 micromirror. It should be noticed that the optical rotation angle in Figures 4-8~4-11 is the total angle by summing the plus and minus angles of the micromirror. Each micromirror consumes power of less than 0.2mW. The power was calculated through measuring the current across a 150KOhm resistor connected with the FPCB micromirror serially.
6

Mirror rotation angle(°)

5 4 3 2 1 0 0 40 80 120 160 200 Applied driving voltage(V) Prototype 1 micromirror Freq=85Hz

Figure 4-10. Prototype1 micromirror optical rotation angle/driving voltage.

35

3

Mirror rotation angle(°)

2.5
Prototype2 micromirror 2 1.5 1 0.5 0 0 40 80 120 160 200 Applied driving voltage (V) Freq=91Hz

Figure 4-11. Prototype2 micromirror optical rotation angle/driving voltage.

With the same measurement setup, the test results for prototype 3 and prototype 4 of design 2 is shown in Figure 4-12 to Figure 4-15. The test result shows that the design 2 micromirror have lower natural resonant frequency which are 53Hz and 50Hz for prototype 3 and prototype 4 respectively due to their longer spring beam than design 1. They also have larger rotation angle which are 5.88° and 6.22° respectively because of the design of low spring beam stiffness and smaller parallel plate gap.
6

Mirror rotation angle(°)

5 4 3 2 1 0 Prototype 3 micromirror Vol=180V Vol=100V

0

40

80 120 160 Driving signal frequency/Hz

200

Figure 4-12. Prototype 3 micromirror optical rotation angle/driving signal frequency.

36

6

Mirror rotation angle(°)

5 4 3 2 1 0 0

Prototype 4 micromirror Vol=180V Vol=100V

40 80 120 160 Driving Signal Frequency/Hz

200

Figure 4-13. Prototype 4 micromirror optical rotation angle/driving signal frequency.

7

Mirror rotation angle(°)

6 5 Prototype 3 micromirror Freq=53Hz

4
3 2 1 0 0

40

80 120 160 Applied driving voltage/V

200

Figure 4-14. Prototype 3 micromirror optical rotation angle/driving voltage.

6

Mirror rotation angle(°)

5 4 3 2 1 0 0

Prototype 4 micromirror Freq=50Hz

40

80 120 160 Applied driving voltage/V

200

Figure 4-15. Prototype 4 micromirror optical rotation angle/driving voltage.

37

4.4 PCB micromirror moving trajectory test
Oscilloscope

PSD

Functional generator

Power supply

FPCB micromirror

Laser module

High voltage amplifier circuit

Figure 4-16. Set up of the measurement system for laser spot moving trajectory

The measurement of last section only shows the relationship between the driving voltage and the optical scanning angle with different frequencies. In order to form a proper circle or ellipse laser pattern which was descripted in last chapter, a sinusoidal laser moving trajectory is required. Therefore a Position Sensitive Detector (PSD) was used to replace the display screen to find the laser spot moving trajectory. The test system was set up as shown in Figure 4-16. In this test setup, the high voltage amplifier circuit developed for the availability indictor was used to amplify the low voltage control signal generated from functional generator. A sinusoidal wave and different duty cycle square wave driving signal with the natural resonant frequency were applied to the FPCB micromirror to verify the laser spot moving trajectory shown in Figure 4-17. The yellow line is the laser spot moving track and the green line is the control signal wave. According to the test results, the laser spot follows a sinusoidal trajectory regardless of the driving signal. So the FPCB micromirror can be driving with either a sinusoidal wave driving 38

signal or a square wave for simplifying the control circuit and software.

(a) Sinusoidal driving signal

(b) 50% duty cycel square wave driving signal

(c) 30% duty cycel square wave driving signal

(d) 70% duty cycel square wave driving signal

Figure 4-17. PSD result for laser spot moving trajectory

39

Chapter 5. Laser projection availability indicator
Based on the laser generation and projection technology introduced above, in this Chapter I will describe the design of the laser projection availability indicator to solve the wiring problem of existing availability indicator in the market. The working principle will be explained first. And then I will describe the design of the mechanical part, the driving circuit, the control software and the test result of a prototype.

5.1 Design and working principle

Figure 5-1. Working principle of FPCB micromirror based laser projection availability indicator

The FPCB micromirror based laser projection availability indicator consists of a red and a green laser, two FPCB micromirrors, a laser beam combiner and control/driving circuit as shown in Figure 5-1. The red and green lasers are combined via a 552nm dichroic laser beam combiner. These two lasers are switched on or off to indicate unavailable or available. The two FPCB micromirrors resonate and scan the laser beam horizontally and vertically to generate the laser pattern. If the two FPCB micromirrors vibrate at the same frequency, a static circle or ellipse is generated. If the vibration frequencies of the two micromirrors are adjusted to be different, a 40

rotating ellipse is generated. The detailed model of generating rotating ellipse laser pattern is explained above. The laser modules are a 1mW red and 1mW green laser from World Star Technologies with a single 5.0V operating voltage. Both of them are the Class 2 safe laser for the human eyes. The laser beam combiner was selected from Edmund optics which are designed to efficiently combine laser beams at an 45º angle of incidence. It features greater than 98% reflection and greater than 95% transmission and yielding exceptionally low loss. It transmits the longer red color 635nm laser and reflect shorter green 520nm laser. The detail mechanical drawing can be found in Appendix A. This FPCB micromirror based availability indicator is small enough to be placed on top of the users' monitor, table or be mounted on the wall close to user, the power source and control computer. It can project a red or green color pattern on the cubicle wall or the door window of an office room to indicate busy or available. By this way, only a very short cable is required to power the availability indicator and the laser pattern can be generated on the screen a few meters away. Thus it does not require long a cable mounted on the existing finished office environment. The remote surface can be either opaque or translucent film as long as the projected pattern can be seen by both the users and others. Attaching a translucent film on the glass window of cubicle or door will convert it to a projection screen easily.

Figure 5-2. Diagram of control circuit for availability indicator

41

5.2 Driving circuit
The diagram of the control circuit is shown in Figure 5-2 which includes two control circuits. Control circuit 1 is the main control board of the device. The ARM core microcontroller communicates with the computer to get the control commands and to send back the status of the availability indicator through the USB interface which also provides 5V power supply. The indicator can also be operated in standalone mode by the pushbutton to switch the projected laser pattern color. The DAC converter controlled by the microcontroller generates two channels of low voltage (3.0V range) sinusoidal or square wave control signals. Similar to other electrostatic parallel plate actuator, it requires high driving voltage with low current. The two low voltage signals are amplified to high voltage level which could be as high as 200V through the high voltage amplifier in circuit 2, to drive the two FPCB micromirrors. The projected laser pattern could be a static circle or ellipse or a rotating ellipse with rotating period adjustable according to equations of the previous section.

(a)

(b)
Figure 5-3. Control circuit 1 PCB layout of availability indicator: (a) Top component side. (b) Bottom solder side

42

5.2.1 Digital control circuit The control circuit 1 is the main control circuit including power source, communication interface, microcontroller, DAC converter and laser on/off switches. The mini USB port is used as the device power supply and also serve as the communication port with computer to get control commands and send the working status. The power from a standard USB port is 500mA which is sufficient for the laser indicator device which usually consume 140mA to 200mA.

JTAG/SWD interface

Laser module connector

Microcontroller

Pushbutton connector

FPCB micromirror connector

USB interface

(a)

(b)
Figure 5-4. Control circuit 1 finished PCB: (a) Top component side (b) Bottom solder side

43

STM32L151CBT6 was chosen as the microcontroller which is ultra-low power 32 bit ARMbased Cortex-M3 MCU with 128KB flash, 16KB SRAM and 4KB EEPROM. It offers a 12bit ADC, two channels 12bit DAC and also contains standard and advanced communication interface: I2C and SPIs, USARTs and USB. The ARM-based Cortex-M3 MCU incorporates a 3 stage pipeline and uses a Harvard architecture with separate local instruction and data buses as well as a third bus for peripherals. This makes most instructions, including multiply, being one clock cycle execution. Therefore it outperforms most other microcontroller products. With the two embedded DAC channels, two arbitrary signal waveforms can be generated to control the two FPCB micromirrors. The detail circuit schematic are shown in Appendix B. The PCB layout using OrCAD PCB Editor software is shown in Figure 5-3 with 40mm X 20mm size. Figure 5-4 shows the finished PCB with all components soldered. 5.2.2 High voltage amplifier circuit The circuit 2 is the high voltage amplifier circuit which is designed as an independent circuit because it also can be used as a universal high voltage amplifier for any device which needs high voltage signal with only one 5.0V power supply. It is also convenient to connect with a function generator to generate the control signal for the prototype experiment. For instance, when the FPCB micromirror was tested by the control signal generated from a function generator, it can convert the 3.0V range low voltage signal to 200V range high voltage signal to drive the FPCB micromirror.

(a)

(b)

Figure 5-5. High voltage amplifier PCB layout: (a) Top component side. (b) Bottom solder side

44

This circuit contents two main components, which are the 5V to 200V DC/DC converter and the high operation voltage operational amplifier. To get arbitrary high voltage control signal, a 4 channel HV264 amplifier from Supertex Inc. was selected. It operates on a 200V high voltage supply and a 5.0V low voltage supply with internal fixed gain of 66.7V/V and typical output slew rate of 9.0V/us. In addition, due to its TSSOP24 package this driver only has 35mm X 25mm dimension. 5SM200S high voltage DC/DC converter from Pico Electronics was used to create 200V power supply for the amplifier. This device is a single integrated SMD PCB mount module with only a single 5V input. The detail circuit schematic for this high voltage amplifier is shown in Appendix C. The PCB layout of the high voltage amplifier circuit using Eagle PCB software is shown in Figure 5-5.
5V power supply connector 5V to 200V DC/DC converter

Signal connector from digital control circuit HV264 High voltage operational amplifier

Connector for FPCB control signal

(a)

(b)
Figure 5-6. High voltage amplifier circuit finished PCB: (a) Top component side. (b) Bottom solder side

45

Figure 5-6 shows the finished PCB with all components soldered. 5.2.3 Control program The control software was developed in Ride7 Integrated Development Environment (IDE) with GNU C programming language. This software tools integrated seamlessly with the free GNU C compiler for ARM core Microcontroller provide start-to-finish control of application development including code editing, compilation, optimization and debugging.
MCU configuration

I/O configuration Initialize run states & parameters

True Run state 1 False Run state 2 False Run state 3 False Red rotating laser ellipse True True

Green static laser ellipse

Red static laser ellipse

Green rotating laser ellipse

False Pushbutton True Switch run states

Figure 5-7. Control software flow chart for availability indicator

Figure 5-7 shows the embedded control software flowchart. Detecting the status of the push button, the availability indictor switches the projected laser color to indicate busy or available and also change between the static and rotating laser ellipse pattern. To form a static laser ellipse, the control singles which were generated by the two channels DAC on the microcontroller were both 46

88.0Hz square wave signals with different driving voltage. In contrast, a slightly different driving frequency which was 0.05Hz between x-FPCB micromirror and y-FPCB micromirror will form a rotating laser ellipse according the analysis of Chapter 3. The software adjust the control signal scanning frequency by changing the counted cycle numbers. For example, for an 88.0Hz frequency signal the period of switching the DAC output voltage equals to half of the cycle 1/(2 × 88)  5.68. And the software needs around 2.272us to finish a running cycle, therefore when the counter for the running cycle reaches 2500 the DAC will switch the output voltage between zero and the full control voltage. If both switched counting number for x-FPCB micromirror and y-FPCB micromirror are 2500, a static laser pattern will be projected. On the contrary, if the switched counting number is 2535 for x-FPCB micromirror and 2465 for y-FPCB micromirror, a 10sec period rotating laser pattern will be generated. The GNU C based C language code for the control software of laser availability indicator can be found in Appendix D.

5.3 Prototype and test
5.3.1 Laser availability indicator The FPCB micromirror prototype 1 and prototype 2 of design 1 were used in building the laser availability indicator. Figure 5-8 shows the prototype of the laser availability indicator. The dimensions of the device are 60mm width, 70mm length and 20 mm height. A laser beam combiner is positioned at 45° to both lasers. It reflects the shorter wavelength (520nm) green laser and transmits the longer wavelength (635nm) red laser. Due to the large size of the micromirror (3.3mm x 3.3 mm) no beam size reducer is needed and the beam alignment is very convenient. The indicator is powered through the standard USB interface, which is also used to communicate with the control computer for switching the laser color to show available or unavailable. 5.3.2 Generating rotating ellipse According to the model of generating rotating ellipse in Chapter 3 and the testing results of Figures 4-8~4-9, the base frequency is

47

0 =

85 + 91 × 2 = 552.9 2

(25)

The biased frequency is set to be  = 0.05 × 2

(26)

(a) Assembled laser availability indicator

(b) Integrated in a small box with control pushbutton Figure 5-8. Prototype of the laser availability indicator

In the test, the display screen is one meter away from the micromirrors. In order to obtain a visible laser pattern with size of about 3 cm, i.e., the longest axis is about 3 cm, the x-axis and yaxis laser spot displacements were chosen to be  = 15 and  = 10 . The corresponding 48

voltages for x-axis and y-axis micromirrors are 146V and 153V respectively. From Eq. (19) the angle of the rotating ellipse is  = 1 2 × 15 × 10(2 × 0.05 × 2) [ ] 2 152 - 102

(27)

which is depicted in Figure 5-9.
0.7 0.5

Angle (rad)

0.3 0.1 -0.1 0 -0.3 -0.5 -0.7 Time (second) 5 10

Figure 5-9. Angle of the ellipse changing with time periodically

The period of rotating ellipse from Eq. (22) is  =   = = 10  2 × 0.05

(28)

Substituting M, N and r into Eq. (20) and (21) the radius of the ellipse can be calculated as 22500 2 (2)  =  100 2  - 300(2) + 2252 

(29)

22500 2 (2)  =  1002  + 300(2) + 225 2 

(30)

which are depicted in Figure 5-10. The radius of the ellipse is a periodic function of time with the period half of the rotating angle, i.e., the ellipse rotates every 360º, and the radius changes twice.

49

20

Laser spot scanning radius/mm

Long radius 10

Short radius

0 0 2 4 6 8 Time/second 10 12

Figure 5-10. The long and short axis of the rotating ellipse

Figure 5-11. Modeled rotating laser pattern in one period. Both horizontal and vertical axes are laser spot scanning displacement on the screen with unit of mm.

50

Figure 5-11 shows the modeled projected rotating ellipses in one period from Eq. (5) and (6). The starting time and time interval between images were set to be the same as those of the experimental testing images for comparison.

Figure 5-12. Experimental results of the projected rotating laser pattern in one period.

The experimental testing results were obtained using camera with the function of automatic and continuous recording images as shown in Figure 5-12. A digital stopwatch was put beside the screen. The measured laser pattern and the modeled results match very well. A slight discrepancy is because the captured image cannot show the millisecond time accurately.

51

5.4 Result of laser availability indicator
The project display screen can be a rear projection plate or see-through reflective film, which is translucent. The translucent film can be attached to a glass window of the door or a cubicle wall. Figure 5-13 shows that the indicator displays and projects the laser pattern on a rear projection screen plate. The laser pattern can also be switched to be green. With this laser availability indicator, no wire is needed to connect the displayed sign with a power/control source which is needed in traditional availability indicators. Since no literatures have been found on the FPCB micromirror, the reliability including the fatigue life of FPCB as vibrating structure is under investigation. Thus far the FPCB micromirror has been continuously running for 100 days, equivalent to 760 million cycle vibration without any performance deterioration.

Figure 5-13. Projected laser pattern on rear projection screen by laser availability indicator

52

Chapter 6. Laser pattern pointer
To increase the laser pointer visibility within the laser safety class, the FPCB micromirror based lase pattern technology using in the application of availability indicator introduced above can be used in the design for laser pattern pointer. The principle of the FPCB micromirror and the laser pattern generation technology is the same as the availability indicator. However, the laser pointer is a handheld device which requires a much lower driving voltage, typically using a battery. Therefore the FPCB micromirror of design 2 with longer spring beam and smaller gap to increase its rotation angle was used in the laser pattern pointer application. A double concave lenses was also added to magnify the laser scanning angle. In addition, a high voltage DC/DC converter with boost converter and charge pump circuit was designed, instead of the 5SM200S DC/DC converter which consumes too much power. Without any load it consumes around 85mA current which is not suitable for battery driven devices.

6.1 Design and working principle of laser pattern pointer

FPCB micromirror holder and fixed aluminum plate

Vertical y-FPCB micromirror

Horizontal x-FPCB micromirror

0.2mm gap

Figure 6-1. FPCB micromirror for laser pattern pointer.

The FPCB micromirror holder and the fixed aluminum plate is shown as Figure 6-1. The aluminum part serve as the fixed electrode of the parallel plate and also the FPCB micromirror holder to mount it on the base. The horizontal and the vertical micromirror share the same holder 53

for easy fabrication. The laser optical system for laser pattern pointer includes a red laser, two FPCB micromirrors and a double concave lens as shown in Figure 6-2. The double concave lens is used to magnify the laser scanning angle which will lower the driving voltage to get the same scanning angle. The mechanical drawing for the laser optical system can be found in Appendix E.

Double concave lens

Horizontal x-FPCB micromirror

Mounting base

Vertical y-FPCB micromirror Red laser Figure 6-2. FPCB micromirror laser optical system model for laser pattern pointer

The whole device was enclosed in a 36mm x 26mm x 114mm box which is suitable for human handheld as shown in Figure 6-3. A navigation switch with 7 function tact and scroll wheel from C&K Components was selected to control the laser pointer to switch between line, ellipse and rotating pattern and change the laser pattern size with the multi pushbutton easily. It is compact and slim with multiple functions in one component.

6.2 Benefit of the laser pattern pointer
1) Higher visibility using the same or lower laser power within the safety class for the application of laser pointer, easier and quicker for the audience to locate the focus area on the screen without waving the laser pointer manually by the presenter, since a laser pattern such as a circle or rotating ellipse instead of a laser dot is projected. 2) The presenter can highlight some specific area on a big screen with the laser horizontal or 54

vertical line or circle. 3) To add the laser pattern projection function, it only costs $10 more and consumes 22mA more power than the conventional laser presenter with the similar size dimension package.
Scroll navigation control pushbutton

Control circuit

Laser FPCB micromirror optical system

Battery holder

On/Off switch Figure 6-3. Model of laser pattern pointer device

6.3 Driving circuit
3.3V Voltage Regulator 2 X 3.6V batteries
3.0-14V to 34V DC/DC converter 5.0V Voltage Regulator Charge pump voltage converter Navigation pushbutton To Horizontal micromirror

SWD interface debug/programming

ARM core Microcontroller

To Red Laser

Laser on/off Switch

High Voltage Amplifier
To vertical micromirror Figure 6-4. Diagram of control circuit for laser pattern pointer

55

The diagram of digital driving circuit for the laser pattern pointer is shown in Figure 6-4. To share the same development platform with availability indicator the laser pointer takes the same ARM core microcontroller which is STM32L151CBT6, the ultra-low power 32 bit ARM-based Cortex-M3 MCU. A 5 pins SWD (Serial Wire Debug) connector replaced the 20 pins JTAG IDC connector as the debug and programming interface to save the PCB space.

Figure 6-5. DC/DC boost converter with charge pump circuit schematic

A high voltage DC/DC converter was designed, based on a boost converter and charge pump circuit as shown in Figure 6-5. A boost step up controller for DC/DC converter with maximum 40V output voltage is unusually popular and easily purchased from a component distributor. LM2733Y from Texas Instruments was selected as the boost converter control IC which operates at a fixed frequency (600 kHz) using current mode control for fast response over wide input voltage. It can tolerate 2.7-14V input voltage range which is suitable for the battery powered device when the output voltage of the battery drops with use. However 40V voltage is not enough for FPCB micromirror driving. So a four Cockcroft Walton stages voltage multiplier charge pump circuit was add to generate a higher voltage. Each stage will increase the voltage one time. According the test results the four stages could be reduce to two or three stages to lower the 56

maximum output voltage which equals to  = ( 29 + 1) × 1.23 × (1 + ) 28

(31)

So it also can be adjusted through changing the value of resistor R29. In this practical design,  = ( 348 + 1) × 1.23 × (1 + 4) = 170.8 13

(32)

The detail circuit schematic for the whole laser pattern pointer is shown in Appendix F. The PCB layout using OrCAD PCB Editor Software is shown in Figure 6-6 with 84mm X 28mm size.

(a)

(b) Figure 6-6. Control circuit PCB layout of laser pattern pointer: (a) Top component side. (b) Bottom solder side

Figure 6-7 shows the finished PCB with all components soldered.

57

Navigation pushbutton

(a) Battery connector Power switch FPCB Micromirror and laser connector SWD programming/debug interface connector

DC/DC converter with charge pump circuit

High voltage amplifier

Microcontroller

(b) Figure 6-7. Laser pattern pointer finished PCB: (a) Top component side. (b) Bottom solder side.

6.4 Control program
The control software was developed in Ride7 Integrated Development Environment (IDE) with GNU C programming language. Figure 6-8 shows the embedded control software flowchart. The laser pattern pointer can generate four different patterns, - horizontal line, vertical line, static circle, ellipse and rotating ellipse. For each of the laser pattern, the length of the line or the size of the ellipse can be adjusted through increasing or decreasing the driving voltage with up/down 58

pushbutton. Pushing the center pushbutton will switch the laser on/off and left/right pushbutton changes the laser projected pattern.
MCU configuration

I/O configuration Initialize run states & parameters

Run state 1 False Run state 2 False Run state 3 False Rotating laser ellipse

True

Horizontal laser line

True

Vertical laser line

True

Statics laser ellipse

PB Up False PB Down

True

Increase micromirror driving voltage

True

Decrease micromirror driving voltage

False
PB Right False PB Left False True PB Center False Figure 6-8. Control software flow chart for laser pattern pointer Switch laser On/Off True Switch run states down True Switch run states up

To generate a laser line, only one sinusoidal is required to drive one FPCB micromirror 59

(horizontal or vertical) and the other direction FPCB micromirror is fixed to ground. The method of forming a static or rotating circle or ellipse is same as the application in the availability indicator with different control signal frequency because of their different natural resonant frequency. The C language code based on GNU C compiler for the control software of laser pattern pointer can be found in Appendix G.

6.5 Prototype and test
FPCB micromirror prototype 3 and prototype 4 of design 2 were used to build the laser pattern pointer optical system as shown in Figure 6-9 according to the design model.
Horizontal x-FPCB micromirror Double concave lens

Mounting base

Red laser

Vertical y-FPCB micromirror

Figure 6-9. FPCB micromirror laser optical system prototype for laser pattern pointer

Figure 6-10 shows the prototype of the laser pattern pointer. The whole device was integrated in a plastic box with the dimension of 36mm width, 26 mm height and 114mm length. Two 3.6V 1.2Ah primary lithium high density 1/2AA size batteries-LS14250 which would fit in an AA size battery holder were selected to drive the device. To measure the laser pattern pointer power consumption, it was powered through a benchtop power supply with current display instead of the batteries. It consumes 22mA with laser off and 37mA with laser on while setting the driving voltage to 7.2V, the same voltage as two 3.6V batteries. Therefore for the 1200mAH battery it can work for 1200/37 = 32.4 continuously without any break. 60

Control circuit

Scroll navigation control pushbutton

Laser FPCB micromirror optical system Battery and holder On/Off switch (a) Assembled laser pattern pointer

(b) Laser pattern pointer integrated in a handheld box Figure 6-10. Prototype of laser pattern pointer device

With 45V driving voltage and 51.5Hz control signal frequency, the laser pattern pointer can projected a 3cm size pattern on a screen 2 meters away. A few pictures of the projected pattern on a PowerPoint slide show screen from the prototype of laser pattern pointer were taken. Figure 611 shows the projected horizontal laser line with shorter, middle and longer length on a real PowerPoint slideshows. The different size vertical line and circle is shown in Figure 6-12 and Figure 6-13 respectively. The Figure 6-14 shows the different size rotating laser ellipse which was taken using the continuous shooting mode of the digital camera. Picture 1 to picture 4 show a sequence of 4 shots which indicates the rotating laser ellipse. 61

(a)

(a)

(b) (b)

(c) (c)

Figure 6-11. Projected horizontal laser line (a) Short line (b) Middle long line (c) Long line

62

(a)

(b)

(c)

Figure 6-12. Projected vertical laser line (a) Short line (b) Middle long line (c) Long line

63

(a)

(b)

(c)

Figure 6-13. Projected laser circle (a) Small circle (b) Middle size circle (c) Large size circle

64

1

2

(a)

3

4

1

2

(b)

3

4

1

2 (c)

3

4

Figure 6-14. Projected rotating laser ellipse (a) Small size (b) Middle size (c) Large size

65

Chapter 7. Conclusions and future work
7.1 Conclusions
The objectives were achieved as follows. 1. Developed a FPCB micromirror based on commercial flexible printed board process, which has much lower cost with much larger aperture size and higher surface quality than conventional MEMs micromirrors. Various prototypes were developed. The maximum optical rotation angles are 5.26° and 2.69° for the prototype 1 and prototype 2 respectively with the resonant frequency in the range of 80~90 Hz. The prototype 3 and prototype 4 have the resonant frequency from 50~60 Hz and optical rotation angle of 5.88° and 6.22° respectively. 2. Developed the laser pattern generating technology using the two FPCB micromirrors positioned orthogonally. Through controlling the resonant frequency and magnitude of each micromirror, various laser patterns can be generated. For example, a static circle can be generated by controlling the two micromirrors to vibrate at the same frequency with the same magnitude. A rotating ellipse is generated through vibrating the two micromirrors in slightly different frequencies with the rotating period adjustable by tuning the frequency difference. A horizontal or vertical line can be generated by tuning the vibration magnitude of either micromirror to zero. 3. Developed a laser availability indicator which integrated two FPCB micromirrors, a red laser, a green laser, a laser beam combiner and control/driving circuit which includes a microcontroller, high voltage converter and a multi-channel amplifier. Software was also developed and embedded in the microcontroller. The prototype has been fabricated and tested. The indicator generated a sharp rotating ellipse laser pattern and projected to a remote translucent film. It well solved the wiring problem with existing availability indicators. The fatigue life of the FPCB micromirror has been tested. Thus far the FPCB micromirror has been continuously running for 100 days that is equivalent to about 760 million vibration cycles without any performance deterioration. 4. Developed a laser pattern pointer which integrated a red laser, an amplification lens, two 66

FPCB micromirrors, driving and controlling circuits and an assembling box with multibutton. The prototype was developed and tested. It can generate rotating ellipse and horizontal/vertical line with the laser pattern size tunable. The prototype was integrated in a 36mm x 26mm x 114mm size box. This laser pattern pointer has better visibility than conventional laser pointers for the audience to easily and quickly locate the laser spot on the presentation screen. In addition, the laser pattern pointer provides function to highlight a line, a column or an area by switching between laser patterns of circles and horizontal or vertical line with size adjustable by pressing two buttons. The prototype of the pattern laser pointer can continuously works for 32.4 hours.

7.2 Recommendations
The FPCB micromirror, laser availability indicator and the laser pattern pointer could be improved in the following ways. 1: Because the FPCB micromirror is assembled by manually bonding a mirror plate to the FPCB actuator and manually bonding an aluminum plate to form the gap, there are variations in vibration resonant frequency and magnitude in prototypes. In the future designs, the parallel plate gap could be formed by fabricating a hard supporter at the anchor pad backside. So manually bonding the FPCB to the aluminum plate will not affect the stiffness of the beam spring. In addition, a mechanism needs to be developed to bond the silicon mirror plate to the FPCB actuator to ensure accurate positioning of the mirror plate relative to the FPCB actuator. 2: The laser driver could be integrated in the driving circuit to shrink the laser module length which is the main factor determining the size of the laser availability indicator. With this improvement, the indicator can be packaged in much smaller size, i.e., 60mm x 40mm x 20mm. The current size is 60mm x 70mm x 20 mm. 3: The driving voltage of the laser pattern pointer should be reduced to less than 36V which is preferred for a handheld device, instead of the current 100~200V. A novel electrostatic actuator should be developed to reduce the driving voltage, such as using an innovative fixed electrode surface or larger electrode area.

67

References
[1] J. B. Spira and J. B. Feintuch, "The Cost of Not Paying Attention: How Interruptions Impact Knowledge Worker Productivity," Basex Knowdge, no. September, p. 21, 2005. [2] B. P. Bailey and J. a. Konstan, "On the need for attention-aware systems: Measuring effects of interruption on task performance, error rate, and affective state," Comput. Human Behav., vol. 22, no. 4, pp. 685­708, 2006. [3] B. P. Bailey, J. a. Konstan, and J. V. Carlis, "Measuring the effects of in terruptions on task performance in the user interface," Smc 2000 Conf. proceedings. 2000 ieee Int. Conf. Syst. man Cybern. 'cybernetics Evol. to Syst. humans, Organ. their complex Interact. (cat. no.0 , vol. 2, pp. 757­762, 2000. [4] [5] [6] [7] [8] Plenom a/s, "Kuando Busylight." 2015. Available: http://www.busylight.com. Kangaroo Design, "MyFocus LED indicator," 2015. Available: http://www.canfocus.com/. luxafor, "USB light indicator." 2015. Available: http://luxafor.com/. Blynclight, "Busy light for Lync," p. http://www.blynclight.com. X. Cao, E. Ofek, and D. Vronay, "Evaluation of alternative presentation control techniques," Proc. ACM CHI 2005 Conf. Hum. Factors Comput. Syst., vol. 2, no. Figure 1, pp. 1248­1251, 2005. [9] B. a. Ahlborn, D. Thompson, O. Kreylos, B. Hamann, and O. G. Staadt, "A practical system for laser pointer interaction on large displays," Proc. ACM Symp. Virtual Real. Softw. Technol. - VRST '05, p. 106, 2005. [10] D. R. Olsen and T. Nielsen, "Laser pointer interaction," Proc. SIGCHI Conf. Hum. Factors Comput. Syst., vol. 01, pp. 17­22, 2001. [11] D. Cavens, F. Vogt, S. Fels, and M. Meitner, "Interacting with the big screen: pointers to ponder," Hum. Perform., vol. 020, no. 604, pp. 678­679, 2002. [12] Kensington Computer Products Group, "Wireless Presenter with Red Laser," 2015. Available: http://www.kensington.com. [13] Logitech, "Wireless Presenter R400," 2015. Available: http://www.logitech.com.

68

[14]

Satechi, "SP600 Smart-Pointer (Black) 2.4Ghz RF Wireless Presenter," 2015. Available : http://www.satechi.net.

[15]

Hiro Inc., "HiRO H50181 4 in 1 2.4 GHz WiFi Black Presenter Green Laser Pointer," 2015. Available: http://www.hiroinc.com.

[16] [17]

SMK-Link Electronics, "Remote point Ruby Presenter," 2015. Available: http://www.smklink.com. FDA, "Laser Hazard Classes," 2015. Available: http://www.fda.gov/Radiation EmittingProducts/RadiationEmittingProductsandProcedures/HomeBusinessandEntertainment/LaserProducts andInstruments/ucm451697.htm.

[18]

Lucid Optical Services, "Study of Laser Pointer Safety," 2015. Available: http://www.lucidos.co.uk/led laser-safety/laserpointers/laser-pointer-study/.

[19]

K. Boosten, R. Van Ginderdeuren, W. Spileers, I. Stalmans, M. Wirix, J. Van Calster, and R. Stalmans, "Laser-induced retinal injury following a recreational laser show: two case reports and a clinicopathological study.," Bull. Soc. Belge Ophtalmol., no. 317, pp. 11­16, 2011.

[20]

J. K. Luttrull and J. Hallisey, "Laser pointer -induced macular injury," Am. J. Ophthalmol., vol. 127, no. 1, pp. 95­96, 1999.

[21]

H. Moseley, F. M. Tulley, and C. N. J. McGhee, "The potential hazard of laser pointers," Lasers Med. Sci., vol. 18, no. 1, pp. 63­67, 2003.

[22]

K. Schulmeister and M. Jean, "The risk of retinal injury from Class 2 and visible Class 3R lasers, i ncluding medical laser aiming beams," Med. Laser Appl., vol. 25, no. 2, pp. 99­110, 2010.

[23]

A. Purkhet, O. Halabi, T. Fujimoto, and N. Chiba, "Accurate and Efficient Drawing Method for Laser Projection," J. Soc. Art Sci., vol. 7, no. 4, pp. 155­169, 2008.

[24]

Thorlabs, "Thorlabs Galvanometers," 2015. Available: https://www.thorlabs.de/newgrouppage9.cfm?objectgroup_id=6057.

[25]

Y. Maeda, M. Iwasaki, and S. Member, "Improvement of Adaptive Property by Adaptive Deadbeat Feedforward Compensation Without Convex Optimization," IEEE Trans. Ind. Electron., vol. 62, no. 1, pp. 466­474, 2015.

[26]

C. Da Liao and J. C. Tsai, "The evolution of MEMS displays," IEEE Trans. Ind. Electron., vol. 56, no. 4, pp. 1057­1065, 2009.

69

[27]

J. Chong, S. He, and R. Ben Mrad, "Development of a vector display system based on a surfacemicromachined micromirror," IEEE Trans. Ind. Electron., vol. 59, no. 12, pp. 4863­4870, 2012.

[28]

L. Li, V. Stankovic, L. Stankovic, L. Li, S. Cheng, and D. Uttamchandani, "Single pixel optical imagi ng using a scanning MEMS mirror," J. Micromechanics Microengineering, vol. 025022, 2011.

[29]

F. Chao, S. He, J. Chong, R. Ben Mrad, and L. Feng, "Development of a micromirror based laser vector scanning automotive HUD," 2011 IEEE Int. Conf. Mechatronics Autom. ICMA 2011, pp. 75­79, 2011.

[30]

M. Scholles, a. Brauer, K. Frommhagen, C. Gerwig, H. Lakner, H. Schenk, and M. Schwarzenberg, "Ultra compact laser projection systems based on two-dimensional resonant micro scanning mirrors," Proc. SPIE, vol. 6466, p. 64660A­64660A­12, 2007.

[31]

S. He and R. Ben Mrad, "Large-stroke microelectrostatic actuators for vertical translation of micromirrors used in adaptive optics," IEEE Trans. Ind. Electron., vol. 52, no. 4, pp. 974­983, 2005.

[32]

S. He, R. Ben Mrad, and J. Chong, "Repulsive-force out-of-plane large stroke translation micro electrostatic actuator," J. Micromechanics Microengineering, vol. 21, no. 7, p. 075002, 2011.

[33]

M.-H. Jun, S. Moon, B. H. Lee, and J.-H. Lee, "A gimbal-less two-axis electrostatic scanner with tilted stationary vertical combs and serially connected springs via a microassembly process," J. Micromechanics Microengineering, vol. 24, no. 9, p. 095008, 2014.

[34]

L. Liu, S. Pal, and H. Xie, "MEMS mirrors based on a curved concentric electrothermal actuator," Sensors Actuators, A Phys., vol. 188, pp. 349­358, 2012.

[35]

D. S. Chen, P. F. Yeh, Y. F. Chen, C. W. Tsai, C. Y. Yin, R. J. Lai, and J. C. Tsai, "An Electrothermal actuator with two degrees of freedom serving as the arm of a MEMS grip per," IEEE Trans. Ind. Electron., vol. 61, no. 10, pp. 5465­5471, 2014.

[36]

I.-J. Cho and E. Yoon, "A low-voltage three-axis electromagnetically actuated micromirror for fine alignment among optical devices," J. Micromechanics Microengineering, vol. 19, no. 8, p. 085007, 2009.

[37]

K. H. Koh, Y. Qian, and C. Lee, "Design and characterization of a 3D MEMS VOA driven by hybrid electromagnetic and electrothermal actuation mechanisms," J. Micromechanics Microengineering, vol. 22, no. 10, p. 105031, 2012.

[38]

W. Liao, W. Liu, Y. Zhu, Y. Tang, B. Wang, and H. Xie, "A tip -tilt-piston micromirror with symmetrical lateral-shift-free piezoelectric actuators," IEEE Sens. J., vol. 13, no. 8, pp. 2873­2881, 2013.

70

[39]

T. Naono, T. Fujii, M. Esashi, and S. Tanaka, "A large-scan-angle piezoelectric MEMS optical scanner actuated by a Nb-doped PZT thin film," J. Micromechanics Microengineering, vol. 24, no. 1, p. 015010, 2014.

[40]

T. Sasaki and K. Hane, "Deformation of varifocal mirror with narrow frame by SOI wafer residual stress," Electron. Commun. Japan, vol. 95, no. 8, pp. 26­33, 2012.

[41]

G. D. J. Su, H. Toshiyoshi, and M. C. Wu, "Surface -micromachined 2-D optical scanners with highperformance single-crystalline silicon micromirrors," IEEE Photonics Technol. Lett., vol. 13, no. 6, pp. 606­ 608, 2001.

[42]

D. Enguang, M. a. Matin, and Y. Guan, "Research on the dynamic performance of MEMS micromirrors," Microw. Opt. Technol. Lett., vol. 35, no. 2, pp. 111­113, 2002.

[43]

J. P. Zhao, H. L. Chen, J. M. Huang, and A. Q. Li u, "A study of dynamic characteristics and simulation of MEMS torsional micromirrors," Sensors Actuators, A Phys., vol. 120, no. 1, pp. 199­210, 2005.

[44]

Opus Microsystems, "laser pointer with digitally controlled and scalable patterns," 2015. Available: http://www.opusmicro.com.tw.

[45]

W. C. Wilson and G. M. Atkinson, "Review of Polyimides Used in the Manufacturing of Micro Systems," no. April, pp. 1­16, 2007.

[46]

S. Xiao, L. F. Che, X. Li, and Y. Wang, "A cost -effective flexible MEMS technique for temperature sensing," Microelectronics J., vol. 38, no. 3, pp. 360­364, 2007.

[47]

S. Y. Xiao, L. F. Che, X. X. Li, and Y. L. Wang, "A novel fabrication process of MEMS devices on polyimide flexible substrates," Microelectron. Eng., vol. 85, no. 2, pp. 452­457, 2008.

[48]

J. Engel, J. Chen, and C. Liu, "Development of polyimide flexible tactile sensor skin," J. Micromechanics Microengineering, vol. 13, no. 3, pp. 359­366, 2003.

[49]

H. L. Kim, Y. H. Kim, and Y. J. Kim, "Miniature electrocardiography sensor usi ng a flexible printed circuit and MEMS technology," IEEE Int. Conf. Multisens. Fusion Integr. Intell. Syst. , no. 1, pp. 545­550, 2008.

[50]

S. Tung, S. R. Witherspoon, L. a Roe, A. Silano, D. P. Maynard, and N. Ferraro, "A MEMS -based flexible sensor and actuator system for space inflatable structures," Smart Mater. Struct., vol. 10, no. 6, pp. 1230­ 1239, 2001.

[51]

J. Y. Kim, K. E. Lee, S. Han, and N. Team, "Developmemnt of Flexible Thermoelectric Generator Using."

71

[52]

J. M. Zara and S. W. Smith, "Optical scanner using a MEMS actuator," Sensors Actuators, A Phys., vol. 102, no. 1­2, pp. 176­184, 2002.

[53]

A. D. Yalcinkaya, O. Ergeneman, and H. Urey, "Polymer magnetic scanners for bar code applications," Sensors Actuators, A Phys., vol. 135, no. 1, pp. 236­243, 2007.

[54] [55] [56]

C. Liu, Foundations of MEMS (2nd Edition), 2 edition. Prentice Hall, 2011. Teledyne Electronics Technologies, "Flexible Circuit Design Guide." 2000. S. R. Bhalotra, J. D. Mansell, H. L. Kung, and D. a. B. Miller, "Parallel -plate MEMS mirror design for large on-resonance displacement," 2000 IEEE/LEOS Int. Conf. Opt. MEMS (Cat. No.00EX399) , vol. 2, no. 1, 2000.

[57]

P. B. Chu, P. R. Nelson, M. L. Tachiki, and K. S. J. Pister, "Dynamics Of Polysilicon Parallel -plate Electrostatic Actuators," Proc. Int. Solid-State Sensors Actuators Conf. - TRANSDUCERS '95, vol. 2, pp. 216­220, 1995.

[58] [59]

N. Dechev, "Lecture 6: Electrostatic Sensors and Actuators," Univ. Victoria. S. Pulleys, R. Batteries, S. Ac, C. Inductors, V. Ammeters, O. Lenses, and I. Mirrors, Principles of Physics: A Calculus-Based Text, Fourth. 2012.

[60]

J. I. Seeger, J. I. Seeger, B. E. Boser, and B. E. Boser, "Parallel -plate driven oscillations and resonant pullin," Energy, pp. 313­316, 2002.

[61]

G. N. Nielson and G. Barbastathis, "Dynamic pull-in of parallel-plate and torsional electrostatic MEMS actuators," J. Microelectromechanical Syst., vol. 15, no. 4, pp. 811­821, 2006.

[62]

W. C. Leong, M. Z. Abdullah, and C. Y. Khor, "Application of flexible printed circuit boar d (FPCB) in personal computer motherboards: Focusing on mechanical performance," Microelectron. Reliab., vol. 52, no. 4, pp. 744­756, 2012.

[63] [64]

CMC Mcirosystems, "MicraGEM-Si Platform Design Handbook." pp. 1­17, 2014. F. Senger, U. Hofmann, T. v. Wantoch, C. Mallas, J. Janes, W. Benecke, P. Herwig, P. Gawlitza, M. OrtegaDelgado, C. Grune, J. Hannweber, and a. Wetzig, "Centimeter -scale MEMS scanning mirrors for high power laser application," vol. 9375, p. 937509, 2015.

72

[65]

J. M. Bustillo, R. T. Howe, and R. S. Muller, "Surface micromachining for microelectromechanical systems," Proc. IEEE, vol. 86, no. 8, 1998.

[66]

J. J. Sniegowski and M. S. Rodgers, "Multi-layer enhancement to polysilicon surface-micromachining technology," Int. Electron Devices Meet. IEDM Tech. Dig., pp. 903­906, 1997.

[67]

G. Bomchil, A. Halimaoui, and R. Herino, "Porous silicon: the material and its application in silicon -oninsulator technologies," Appl. Surf. Sci., vol. 42, pp. 604­613, 1989.

[68]

P. J. French and P. M. Sarro, "Surface versus bulk micromachining: the contest for suitable applications," J. Micromechanics Microengineering, vol. 8, no. 3, pp. 250­250, 1999.

[69]

G. T. a Kovacs, N. I. Maluf, and K. E. Petersen, "Bulk micromachining of silicon," Proc. IEEE, vol. 86, no. 8, pp. 1536­1551, 1998.

[70]

M. Hoffmann and E. Voges, "Bulk silicon micromachining for MEMS in optical communication systems," J. Micromechanics Microengineering, vol. 12, no. 4, pp. 349­360, 2002.

[71]

Y. Bai, "Design , Fabrication , and Characterization of a 2-D SOI MEMS Micromirror with Sidewall Electrodes for Confocal MACROscope Imaging," 2010.

[72]

T. G. Bifano, H. T. Johnson, P. Bierden, and R. K. Mali, "Elimination of stress -induced curvature in thinfilm structures," J. Microelectromechanical Syst., vol. 11, no. 5, pp. 592­597, 2002.

[73]

G. D. J. Su, H. Toshiyoshi, and M. C. Wu, "Surface -micromachined 2-D optical scanners with highperformance single-crystalline silicon micromirrors," IEEE Photonics Technol. Lett., vol. 13, no. 6, pp. 606­ 608, 2001.

[74]

P. Gomez and P. D, "State-of-the-art of MEMS Technology for Design and Fabrication of Micro-Mirrors," Adv. Electron. Syst., 2003.

[75] [76]

V. Milanovi and V. Milanovi, "Multilevel Beam SOI-MEMS for Optical Applications," pp. 281­285, 2002. V. Milanovic, M. Last, and K. Pister, "Monolithic silicon micromirrors with large scanning angle," Opt. MEMS 2001, pp. 1­2, 2001.

[77]

J. L. Davidson, Microfabricated Systems and MEMS VII: Proceedings of the International Symposium . The Electrochemical Society, 2004.

73

[78]

F. D. Demana, B. K. Waits, G. D. Foley, S. Gibbons, P. Mcmahon, K. Smith-tarbox, J. O. Brien, M. Durnwald, K. Greig, C. Fell, and J. Boehme, "Precalculus: Graphical, Numerical, Algebraic 8 . 4 Translation and Rotation of Axes," in Precalculus, no. Example 1, 2011, pp. 612­618.

[79] [80]

J. Peng, "Q-LINE Laser pointers." 2014. FDA, "Laser Hazard Classes," 2015. .

74

Appendix A: Mechanical drawing of laser projection availability indicator

75

76

77

78

79

Appendix B: Schematic and components list of laser indicator control circuit

80

81

Item

Quantity

Reference C1,C4,C6,C9,C 11,C12,C13,C1 4 C2 C3,C5 C7,C8 C10 D1 D2,D7 D3,D5,D6 J1 J2 J6 J7 J8 Q1,Q2,Q3 R6,R7,R12,R1 3,R14,R15,R23 R1,R8,R10,R1 1,R16,R19,R20 R21 U1 U2 U3 U4

Part

PCB Footprint

Manufacturer

Manufacturer Part Number

1 2 3 4 5 6 7 8 9 10 11 12 13 14

8 1 2 2 1 1 2 3 1 1 1 1 1 3

0.1UF 16V 10% 100UF 16V 1UF 16V 10% 22PF 50V 5% 10UF 16V 10% TL4050B25IDBZ R B0540W-7-F LED 532530570 SBH11-PBPCD10 UX60-MB-5ST 532530270 532530670 SI2302CDS

smd0603 smd6032 smd0603 smd0603 smd0603 sot23-3 SOD123 LED0603 53253-5P conn5020 UX60MB-5ST 53253-2P 53253-6P sot23-3

Kemet Kemet Kemet Kemet Taiyo Yuden Texas Instruments Diodes Incorporated Lite-On Inc Molex Inc Sullins Connector Hirose Electric Molex Inc Molex Inc Vishay Siliconix

C0603C104K4RACTU T491C107K016AT C0603C105K4PACTU C0603C220J5GACTU LMK107BBJ106MAHT TL4050B25IDBZR B0540W-7-F LTST-C191KGKT 532530570 GRPB102VWVN-RC UX60-MB-5ST 532530270 532530670 SI2302CDS-T1-E3

16

7

10K 1/10w 1%

smd0603

Panasonic

ERJ-3EKF1002V

17 18 19 20 21 22

7 1 1 1 1 1

1K 1/10w 1% 1.5k 1/10w 1% DAC124S085 STM32L151CBT 6 MCP1702 USBLC6-2 ABM38.000MHZ-D2YT

smd0603 smd0603 MSOP10 TQFP48 sot23-3 SOT23-6

Panasonic Panasonic Texas Instruments STMicroelectroni cs Microchip Technology STMicroelectroni cs

ERJ-3EKF1001V ERJ-3EKF1501V DAC124S085CIMM/NOPB STM32L151CBT6 MCP1702T-3302E/CB USBLC6-2SC6

23

1

Y1

ABM3

Abracon LLC

ABM3-8.000MHZ-D2Y-T

82

Appendix C: Schematic and components list of high voltage amplifier

83

84

Item Quantity Reference R18, R19, R21, 1 4 R22 2 3 C1, C3, C6 3 1 C5 4 1 C2 R13, R14, R15, R16, R17, R20, 8 R23, R24 R1, R2, R3, R4, 6 R12 4 2 2 1 1 1 1 R7, R8, R9, R10 J1, J2 J3, J4 R11 IC3 R6 C4

Part 0 0.1UF 16V 10% 0.1UF 250V 10% 100UF 16V

PCB Footprint SMD0805 smd0603 smd1206 smd6032

Manufacturer Panasonic Kemet Kemet Kemet Rohm Semiconductor Panasonic Rohm Semiconductor Molex Inc Molex Inc Panasonic Pico Electronics Panasonic Kemet Comchip Technology Fairchild Semiconductor Microchip Technology Lite-On Inc Fairchild Semiconductor NXP Semiconductors STMicroelectron ics

Manufacturer Part Number ERJ-6GEY0R00V C0603C104K4RACTU C1206C104KARACTU T491C107K016AT

5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20

150K 1/10w 1% 1K 1/10w 1% 2.0K 532530270 532530570 4.99k 1/10w 1% 5SM200S 8.45K 1/10w 1% 1UF 250V 10% CGRM4004-G FDC6318P HV264TS-G LED MMBT3906LT1S MD PESD24VL2BT USBLC6-4SC6

smd0805 smd0603 smd0805 53253-2P 53253-5P smd0603 SM5200S smd0603 smd1825 SOD123 SOT23-6 TSSOP24 LED0603 SOT23-BEC SOT23 SOT23-6

ESR10EZPF1503 ERJ-3EKF1001V ESR10EZPF2001 532530270 532530570 ERJ-3EKF4991V 5SM200S ERJ-3EKF8451V C1825C105KARACTU CGRM4004-G FDC6318P HV264TS-G LTST-C191KGKT MMBT3906 PESD24VL2BT,215 USBLC6-4SC6

1 D2 1 Q2 1 IC2 1 LED1 1 Q1 1 D1 1 IC1

85

Appendix D: C language program of availability indictor
/*=============================================== * DESCRIPTION: * This program is for laser availability indicator. * Copyright (c) MEMS lab, 2015 *================================================*/ /* Includes --------------------------------------*/ #include "stm32l1xx.h" #include "stm32l1xx_dac.h" /* board defines ---------------------------------*/ typedef __IO uint32_t vu32; typedef __IO uint16_t vu16; typedef __IO uint8_t vu8; typedef uint32_t u32; typedef uint16_t u16; typedef uint8_t u8; //LEDs port and pins #define LEDS_GPIO #define LEDS_RCC_GPIO #define LED0_PIN #define LED1_PIN #define LEDS_BOTH_PINS // Push #define #define #define (GPIOB) (RCC_AHBPeriph_GPIOB) (GPIO_Pin_0) (GPIO_Pin_1) (LED0_PIN|LED1_PIN) u16 DACVal1Switch=DelayCTime,DACVal2Switch=DelayCTime; u16 RunState=1; u16 PhaseDelayv=PhaseDelay; #ifdef DEBUG debug(); #endif /*!< At this stage the microcontroller clock setting is already configured, this is done through SystemInit() function which is called from startup file (startup_stm32l1xx_md.s) before to branch to application main. To reconfigure the default setting of SystemInit() function, refer to system_stm32l1xx.c file */ SystemInit(); RCC_AHBPeriphClockCmd( LEDS_RCC_GPIO, ENABLE ); // Configure LED pins as output push-pull GPIO_InitStructure.GPIO_Pin = LEDS_BOTH_PINS; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT; GPIO_InitStructure.GPIO_OType = GPIO_OType_PP; GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL; GPIO_InitStructure.GPIO_Speed = GPIO_Speed_40MHz; GPIO_Init( LEDS_GPIO, &GPIO_InitStructure );

button port and pin BP_GPIO (GPIOA) BP_RCC_GPIO (RCC_AHBPeriph_GPIOA) BP_PIN (GPIO_Pin_2)

/* defines ---------------------------------------*/ #define PhaseDelay 100 #define DelayCTime 2500 /* function prototypes --------------------------*/ void void void void RCC_Configuration( void ); NVIC_Configuration( void ); Delay( vu32 nCount ); DAC_Config(void);

RCC_AHBPeriphClockCmd( BP_RCC_GPIO, ENABLE ); // Configure BP pin as input GPIO_InitStructure.GPIO_Pin = BP_PIN; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN; GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL; GPIO_InitStructure.GPIO_Speed = GPIO_Speed_40MHz; GPIO_Init( BP_GPIO, &GPIO_InitStructure ); DAC_Config();

/* global variables -----------------------------*/ /* These variables could (and should, maybe) be defined as local to the main function, but declaring them as global and volatile helps for debugging. */ GPIO_InitTypeDef GPIO_InitStructure; DAC_InitTypeDef DAC_InitStructure; vu16 bpinput = 0; /* functions -------------------------------------*/ /************************************************** * Function Name : main * Description : Main program. * Input : None * Output : None * Return : None ***************************************************/ int main( void ) { u16 DACVal1=0,DACVal2=0; u16 DACVal1Count=0,DACVal2Count=0; DACVal1Switch=DelayCTime+PhaseDelay; DACVal2Switch=DelayCTime; GPIO_Write( LEDS_GPIO, 0x01 ); while ( 1 ) { // Switch run states while push-button is down bpinput = (( GPIO_ReadInputData( BP_GPIO ) ) & ( BP_PIN ) ); if ( !bpinput ) { RunState++; if(RunState>=5) RunState=0; DACVal1Count=0; DACVal2Count=0; switch(RunState) { case 0: DACVal1Switch=DelayCTime+PhaseDelay; DACVal2Switch=DelayCTime;

86

GPIO_Write( LEDS_GPIO, 0x00 ); break; case 1: DACVal1Switch=DelayCTime+PhaseDelay; DACVal2Switch=DelayCTime; GPIO_Write( LEDS_GPIO, 0x01 ); break; case 2: DACVal1Switch=DelayCTime+PhaseDelay; DACVal2Switch=DelayCTime; GPIO_Write( LEDS_GPIO, 0x02 ); break; case 3: DACVal1Switch=DelayCTime+PhaseDelay; DACVal2Switch=DelayCTime-10; GPIO_Write( LEDS_GPIO, 0x01 ); break; case 4: DACVal1Switch=DelayCTime+PhaseDelay; DACVal2Switch=DelayCTime-10; GPIO_Write( LEDS_GPIO, 0x02 ); break; default : RunState=0; break; } do { bpinput = (( GPIO_ReadInputData( BP_GPIO ) ) & ( BP_PIN ) ); Delay( 0x100 ); } while ( !bpinput ); } // increment counter variable DACVal1Count++; if(DACVal1Count>=DACVal1Switch) { DACVal1Count=PhaseDelay; if(DACVal1==0x00) {DACVal1=0xe00; } else {DACVal1=0x00;} DAC_SetChannel1Data(DAC_Align_12b_R, DACVal1); } DACVal2Count++; if(DACVal2Count>=DACVal2Switch) { DACVal2Count=0; if(DACVal2==0x00) {DACVal2=0xe00; } else {DACVal2=0x00;} DAC_SetChannel2Data(DAC_Align_12b_R, DACVal2); } } } /**

* @brief Configures the DAC channel 1 with output buffer enabled. * @param None * @retval None */ void DAC_Config(void) { /* Enable GPIOA clock */ RCC_AHBPeriphClockCmd(RCC_AHBPeriph_GPIOA, ENABLE); /* Configure PA.04 (DAC_OUT1) in analog mode ------------------------*/ GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AN; GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL; GPIO_InitStructure.GPIO_Pin = GPIO_Pin_4; GPIO_Init(GPIOA, &GPIO_InitStructure); /* Enable DAC clock */ RCC_APB1PeriphClockCmd(RCC_APB1Periph_DAC, ENABLE); /* DAC channel1 Configuration */ DAC_InitStructure.DAC_Trigger = DAC_Trigger_None; DAC_InitStructure.DAC_WaveGeneration = DAC_WaveGeneration_None; DAC_InitStructure.DAC_OutputBuffer = DAC_OutputBuffer_Enable; /* DAC Channel1 Init */ DAC_Init(DAC_Channel_1, &DAC_InitStructure); DAC_Init(DAC_Channel_2, &DAC_InitStructure); /* Enable DAC Channel1 */ DAC_Cmd(DAC_Channel_1, ENABLE); DAC_Cmd(DAC_Channel_2, ENABLE); } /*************************************************** * Function Name : assert_failed * Description : Reports the name of the source file and the source line number * where the assert error has occurred. * Input : - file: pointer to the source file name * - line: assert error line source number * Output : None * Return : None ***************************************************/ void assert_failed( u8* file, u32 line ) { // User can add his own implementation to report the file name and line number, //ex: printf("Wrong parameters value: file %s on line %d\r\n", file, line) // Infinite loop while ( 1 ) { } } /*************************************************** * Function Name : Delay * Description : Inserts a delay time. * Input : nCount: specifies the delay time length. * Output : None * Return : None ***************************************************/ void Delay( vu32 nCount ) { for ( ; nCount != 0; nCount-- ); }

87

Appendix E: Mechanical drawing of laser pattern pointer

88

89

90

91

92

Appendix F: Schematic and components list of laser pointer control circuit

93

94

95

Item 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15

Quantity 4 5 1 3 4 1 1 7 2 4 1 1 1 1 1

Reference C1,C9,C13,C18 C2,C3,C8,C11,C15 C5 C7,C10,C14 C12,C16,C17,C27 C19 C20 C21,C23,C24,C25,C 26,C28,C31 C29,C30 D1,D2,D3,D4 D5 D7 D6 J1 J2

Part 0.1UF 100V 10% 0.1UF 250V 10% 1UF 250V 10% 10UF 16V 10% 1UF 16V 10% 4.7UF 50V 10% 82PF 50V 5% 0.1UF 16V 10% 22PF 50V 5% BAV99 CGRM4004-G B0540W-7-F LED Slide Switch 532530270

PCB Footprint smd0603 smd1206 smd1825 smd0603 smd0603 smd1206 smd0603 smd0603 smd0603 sot23-3 SOD123 SOD123 LED060 3 RPTH 532532P DF135P1.25DSA (50) TSWB3 N VLS301 2T4R7M1R 0 sot23-3 sot23-3 smd0603 smd0805 smd0603

Manufacturer Murata Electronics Kemet Kemet Taiyo Yuden Kemet Kemet Kemet Kemet Kemet Fairchild Semiconductor Comchip Technology Diodes Incorporated Lite-On Inc TE Connectivity Molex Inc

Manufacturer Part Number GRM188R72A104KA35D C1206C104KARACTU C1825C105KARACTU LMK107BBJ106MAHT C0603C105K4PACTU C1206C475K5RACTU C0603C820J5GACTU C0603C104K4RACTU C0603C220J5GACTU BAV99 CGRM4004-G B0540W-7-F LTST-C191KGKT 1825160-1 532530270

16 17

2 1

J3,J4 J5

DF13-5P1.25DSA(50) TSWB3N

Hirose Electric C&K Components

DF13-5P-1.25DSA(50) TSWB3NCB222LFS

18 19 20 21 22 23

1 1 1 4 2 1

L1 Q1 Q2 R1,R2,R5,R26 R3,R4 R6 R7,R8,R11,R12,R13 ,R14,R15,R16,R17, R18,R19,R20,R21,R 22,R23,R24,R25 R9 U1 U5

4.7uH 20% 1A SI2333CDS SI2302CDS 1K 1/10w 1% 150K 348K

TDK Corporation Vishay Siliconix Vishay Siliconix Panasonic Rohm Semiconductor Panasonic

VLS3012T-4R7M1R0 SI2333CDS-T1-E3 SI2302CDS-T1-E3 ERJ-3EKF1001V ESR10EZPF1503 ERJ-3EKF3483V

24 25 26 27

17 1 1 1

10K 1/10w 1% 13K 1/10W 1% HV264TS-G STM32L151CBT 6

smd0603 smd0603 TSSOP2 4 TQFP48

Panasonic Panasonic Microchip Technology STMicroelectronics

ERJ-3EKF1002V ERJ-3EKF1302V HV264TS-G STM32L151CBT6

96

Item

Quantity

Reference

Part

PCB Footprint

Manufacturer

Manufacturer

28 29 30

1 1 1

U2 U3 U4

MCP1702-33 MCP1702-50 LM2733Y ABM38.000MHZ-D2YT

sot23-3 sot23-3 SOT23-5

Microchip Technology Microchip Technology Texas Instruments

MCP1702T-3302E/CB MCP1702T-5002E/CB LM2733YMF/NOPB

31

1

Y1

ABM3

Abracon LLC

ABM3-8.000MHZ-D2Y-T

97

Appendix G: C language program of laser pattern pointer
/*============================== *DESCRIPTION: *This program is for laser pattern pointer. * Copyright (c) MEMS lab, 2015 *=============================*/ /* Includes ----------------------*/ #include "stm32l1xx.h" #include "stm32l1xx_dac.h" /* board defines ----------------*/ typedef __IO uint32_t vu32; typedef __IO uint16_t vu16; typedef __IO uint8_t vu8; typedef uint32_t u32; typedef uint16_t u16; typedef uint8_t u8; //LEDs port and pins #define LEDS_GPIO #define LEDS_RCC_GPIO (RCC_AHBPeriph_GPIOB) #define LED0_PIN #define LED1_PIN #define LEDS_BOTH_PINS (GPIOB) (GPIO_Pin_6) (GPIO_Pin_7) (LED0_PIN|LED1_PIN) vu16 jstkinput = 0; vu16 bpinput = 0;

/* functions -----------------------------*/ /******************************************* * Function Name : main * Description : Main program. * Input : None * Output : None * Return : None *******************************************/ int main( void ) { u16 DACVal1=0,DACVal2=0,LaserOnOff=0; u16 DACVal1Count=0,DACVal2Count=0; u16 DACVal1Switch=DelayCTime,DACVal2Switch=Delay CTime; u16 RunState=3,DrivingVol=0x500; u16 PhaseDelayv=PhaseDelay; #ifdef DEBUG debug(); #endif /*!< At this stage the microcontroller clock setting is already configured, this is done through SystemInit() function which is called from startup file (startup_stm32l1xx_md.s) before to branch to application main. To reconfigure the default setting of SystemInit() function, refer to system_stm32l1xx.c file */ SystemInit(); RCC_AHBPeriphClockCmd( LEDS_RCC_GPIO, ENABLE ); // Configure LED pins as output pushpull GPIO_InitStructure.GPIO_Pin = LEDS_BOTH_PINS; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT; GPIO_InitStructure.GPIO_OType = GPIO_OType_PP; GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL; GPIO_InitStructure.GPIO_Speed = GPIO_Speed_40MHz; GPIO_Init( LEDS_GPIO, &GPIO_InitStructure );

// Push button port and pin #define BP_GPIO (GPIOB) #define BP_RCC_GPIO (RCC_AHBPeriph_GPIOB) #define BP_PIN (GPIO_Pin_12) #define BP_LEFT_PIN (GPIO_Pin_14) #define BP_RIGHT_PIN (GPIO_Pin_2) #define BP_UP_PIN (GPIO_Pin_11) #define BP_DOWN_PIN (GPIO_Pin_15) #define BP_ALL_PINS (BP_PIN|BP_LEFT_PIN|BP_RIGHT_PIN|BP_UP_PIN|B P_DOWN_PIN)

/* Example defines -----------------------*/ #define PhaseDelay 250 #define DelayCTime 308 /* function prototypes -------------------*/ void void void void RCC_Configuration( void ); NVIC_Configuration( void ); Delay( vu32 nCount ); DAC_Config(void);

/* global variables ----------------------*/ /* These variables could (and should, maybe) be defined as local to the main function, but declaring them as global and volatile helps for debugging. */ GPIO_InitTypeDef GPIO_InitStructure; DAC_InitTypeDef DAC_InitStructure; RCC_AHBPeriphClockCmd( BP_RCC_GPIO, ENABLE ); // Configure BP pin as input GPIO_InitStructure.GPIO_Pin = BP_ALL_PINS; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN;

98

GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL; GPIO_InitStructure.GPIO_Speed = GPIO_Speed_40MHz; GPIO_Init( BP_GPIO, &GPIO_InitStructure ); DAC_Config();

case 2: DACVal1Switch=DelayCTime+PhaseDelay; DACVal2Switch=DelayCTime; break; case 3: DACVal1Switch=DelayCTime+PhaseDelay;

DACVal1Switch=DelayCTime+PhaseDelay; DACVal2Switch=DelayCTime; DACVal2Switch=DelayCTime; GPIO_Write( LEDS_GPIO, 0x80 ); while ( 1 ) { // Stop all toggling while pushbutton is down bpinput = ((~( GPIO_ReadInputData( BP_GPIO ) )) & ( BP_ALL_PINS ) ); switch ( bpinput & ( BP_ALL_PINS ) ) { case BP_PIN: // Center button is pressed to switch laser on/off . if(LaserOnOff==0) {GPIO_Write( LEDS_GPIO, 0x80 );LaserOnOff=1;} else {GPIO_Write( LEDS_GPIO, 0x00 );LaserOnOff=0;} do { bpinput = (( GPIO_ReadInputData( BP_GPIO ) ) & ( BP_ALL_PINS ) ); Delay( 0x300 ); } while ( bpinput != 0xD804 ); break; case BP_LEFT_PIN: // Left button is pressed to change run states. RunState++; if(RunState>=5) RunState=0; DACVal1Count=0; DACVal2Count=0; switch(RunState) { case 0: DACVal1Switch=DelayCTime+PhaseDelay; DACVal2Switch=DelayCTime; break; case 1: DACVal1Switch=DelayCTime+PhaseDelay; DACVal2Switch=DelayCTime; break; break; case 4: DACVal1Switch=DelayCTime+PhaseDelay; DACVal2Switch=DelayCTime-2; break; default : RunState=0; break; } do { bpinput = (( GPIO_ReadInputData( BP_GPIO ) ) & ( BP_ALL_PINS ) ); Delay( 0x300 ); } while ( bpinput != 0xD804 ); break; case BP_RIGHT_PIN: // Right button is pressed to change run states. if(RunState>0) {RunState--;} else { RunState=4;} DACVal1Count=0; DACVal2Count=0; switch(RunState) { case 0: DACVal1Switch=DelayCTime+PhaseDelay; DACVal2Switch=DelayCTime; break; case 1: DACVal1Switch=DelayCTime+PhaseDelay; DACVal2Switch=DelayCTime; break; case 2: DACVal1Switch=DelayCTime+PhaseDelay; DACVal2Switch=DelayCTime; break; case 3: DACVal1Switch=DelayCTime+PhaseDelay;

99

DACVal2Switch=DelayCTime; break; case 4: DACVal1Switch=DelayCTime+PhaseDelay; DACVal2Switch=DelayCTime-2; break; default : RunState=0; break; } do { bpinput = (( GPIO_ReadInputData( BP_GPIO ) ) & ( BP_ALL_PINS ) ); Delay( 0x300 ); } while ( bpinput != 0xD804 ); break; case BP_UP_PIN: // Up button is pressed to increase pattern size. if(DACVal2Count==0) { if(DrivingVol<0xe00) {DrivingVol=DrivingVol+0x5;} } break; case BP_DOWN_PIN: // Down button is pressed to decrease pattern size. if(DACVal2Count==0) { if(DrivingVol>0x100) {DrivingVol=DrivingVol-0x5;} } break; default : // No buttons are pressed (or several, which is a hardware error) if(DACVal2Count==0) { if(DrivingVol<0xe00) {DrivingVol=DrivingVol+0x0;} } break; } // increment counter variable DACVal1Count++; DACVal2Count++; switch(RunState) {

case 0: if(DACVal1Count>=DACVal1Switch) { DACVal1Count=PhaseDelay; DACVal1=0x00; DAC_SetChannel1Data(DAC_Align_12b_R, DACVal1); } if(DACVal2Count>=DACVal2Switch) { DACVal2Count=0; DACVal2=0x00; DAC_SetChannel2Data(DAC_Align_12b_R, DACVal2); } break; case 1: if(DACVal1Count>=DACVal1Switch) { DACVal1Count=PhaseDelay; if(DACVal1==0x00) {DACVal1=DrivingVol; } else {DACVal1=0x00;} DAC_SetChannel1Data(DAC_Align_12b_R, DACVal1); } if(DACVal2Count>=DACVal2Switch) { DACVal2Count=0; DACVal2=0x00; DAC_SetChannel2Data(DAC_Align_12b_R, DACVal2); } break; case 2: if(DACVal1Count>=DACVal1Switch) { DACVal1Count=PhaseDelay; DACVal1=0x00; DAC_SetChannel1Data(DAC_Align_12b_R, DACVal1); } if(DACVal2Count>=DACVal2Switch) { DACVal2Count=0; if(DACVal2==0x00) {DACVal2=DrivingVol; } else {DACVal2=0x00;} DAC_SetChannel2Data(DAC_Align_12b_R, DACVal2); } break; case 3: if(DACVal1Count>=DACVal1Switch) { DACVal1Count=PhaseDelay; if(DACVal1==0x00) {DACVal1=DrivingVol; } else {DACVal1=0x00;}

100

DAC_SetChannel1Data(DAC_Align_12b_R, DACVal1); } if(DACVal2Count>=DACVal2Switch) { DACVal2Count=0; if(DACVal2==0x00) {DACVal2=DrivingVol; } else {DACVal2=0x00;} DAC_SetChannel2Data(DAC_Align_12b_R, DACVal2); } break; case 4: if(DACVal1Count>=DACVal1Switch) { DACVal1Count=PhaseDelay; if(DACVal1==0x00) {DACVal1=DrivingVol; } else {DACVal1=0x00;} DAC_SetChannel1Data(DAC_Align_12b_R, DACVal1); } if(DACVal2Count>=DACVal2Switch) { DACVal2Count=0; if(DACVal2==0x00) {DACVal2=DrivingVol; } else {DACVal2=0x00;} DAC_SetChannel2Data(DAC_Align_12b_R, DACVal2); } break; default : RunState=0; break; } Delay( 0x30 ); } } /** * @brief Configures the DAC channel 1 with output buffer enabled. * @param None * @retval None */ void DAC_Config(void) { /* Enable GPIOA clock */ RCC_AHBPeriphClockCmd(RCC_AHBPeriph_GPIOA, ENABLE); /* Configure PA.04 (DAC_OUT1) in analog mode -------------------------*/

GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AN; GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL; GPIO_InitStructure.GPIO_Pin = GPIO_Pin_4; GPIO_Init(GPIOA, &GPIO_InitStructure); /* Enable DAC clock */ RCC_APB1PeriphClockCmd(RCC_APB1Periph_DAC, ENABLE); /* DAC channel1 Configuration */ DAC_InitStructure.DAC_Trigger = DAC_Trigger_None; DAC_InitStructure.DAC_WaveGeneration = DAC_WaveGeneration_None; DAC_InitStructure.DAC_OutputBuffer = DAC_OutputBuffer_Enable; /* DAC Channel1 Init */ DAC_Init(DAC_Channel_1, &DAC_InitStructure); DAC_Init(DAC_Channel_2, &DAC_InitStructure); /* Enable DAC Channel1 */ DAC_Cmd(DAC_Channel_1, ENABLE); DAC_Cmd(DAC_Channel_2, ENABLE); } /******************************************* * Function Name : assert_failed * Description : Reports the name of the source file and the source line number * where the assert error has occurred. * Input : - file: pointer to the source file name * - line: assert error line source number * Output : None * Return : None *******************************************/ void assert_failed( u8* file, u32 line ) { // User can add his own implementation to report the file name and line number, //ex: printf("Wrong parameters value: file %s on line %d\r\n", file, line) // Infinite loop while ( 1 ) { } } /******************************************* * Function Name : Delay * Description : Inserts a delay time. * Input : nCount: specifies the delay time length. * Output : None * Return : None *******************************************/ void Delay( vu32 nCount ) { for ( ; nCount != 0; nCount-- ); }

101

