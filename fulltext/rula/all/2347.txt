Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2012

Intelligent Control of Satellite Formation Flying
Junquan Li
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Aerospace Engineering Commons Recommended Citation
Li, Junquan, "Intelligent Control of Satellite Formation Flying" (2012). Theses and dissertations. Paper 1590.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

Intelligent Control of Satellite Formation Flying

by Junquan Li Master of Applied Science University of Science and Technology Beijing, China 2006

A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of DOCTOR OF PHILOSOPHY in the Program of Aerospace Engineering

Toronto, Ontario, Canada, 2012

c Junquan Li 2012 All rights reserved

iii

Author's Declaration
I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners.

I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

I understand that my dissertation may be made electronically available to the public.

v

Abstract
Intelligent Control of Satellite Formation Flying Junquan Li, Doctor of Philosophy, Aerospace Engineering Ryerson University, Toronto, March 2012

Small satellites flying in formation present a more efficient and affordable way of achieving the same or better performance than a large satellite because of low cost, high density of functionality and a short development cycle. A key technology for achieving mission objectives is the attitude and orbit control system. The overall objective of this dissertation research focuses on developing advanced control strategies and fault tolerant control for satellite formation flying. It is necessary to design and operate the satellite formation flying system to reduce fuel consumption and improve control accuracy. This is a very challenging task due to the nonlinear nature of satellite formation dynamics and the risk of thrusters' failures and sensors' faults in the absence of hardware redundancy. A class of nonlinear leader-follower satellite formation flying systems subject to uncertain thrusters' and sensors' faults and external J2 disturbances has been studied applying fault detection and identification and second order sliding mode control methodologies. New fault detection and identification and fault tolerant control algorithms were compared with model based fault detection and identification and fault tolerant control algorithms in presence of large initial errors, timevarying external disturbances, and parameter uncertainties. The faults considered were modeled as constant or ramp faults. Numerical results demonstrated the effectiveness of the proposed active fault tolerant control under actuators' and sensors' faults. It has been shown that the proposed second order sliding mode control scheme can guarantee local asymptotic stability after system faults. Simulation results confirmed that the suggested control methodologies yield high formation keeping precision and effectiveness for leaderfollower formation flying systems. The tracking errors of the proposed second order sliding

vi mode control, adaptive fuzzy sliding mode control, chattering free sliding mode control and classic sliding mode control resulting from the thruster faults are within 2 m, 4 m, 10 m and 1 m, respectively. The fuel consumption of the proposed second order sliding mode control was the least. It is also necessary to design a fault tolerant satellite attitude control system to reduce fuel consumption and improve control performance accuracy. The proposed fault tolerant attitude control algorithms were based on first order and higher order sliding mode control theory as well as fuzzy logic systems to achieve real time autonomous fault tolerant control. These algorithms were applied to attitude synchronization in both leader-follower formation flying and decentralized formation flying. Attitude synchronization during formation flying was examined considering actuator dynamics while decentralized attitude synchronization was studied using graph theory with quaternion kinematics. The proposed fault tolerant control algorithm was compared with the existing satellite attitude system controllers in the literature and it was found that the proposed algorithm resulted in three axis attitude stabilization within 0.041 in all axes for the fault cases. The reaction wheels' Coulomb friction, saturations, noise, dead-zones, bias fault and external disturbances are considered. Finally, a nonlinear adaptive fuzzy sliding mode controller was tested using embedded nanosatellite hardware on a frictionless spherical air bearing system. The test results showed attitude errors of 0.8 using the proposed controller while a proportional integral derivative controller resulted in 5 attitude errors.

vii

Acknowledgements

The author would like to express her utmost gratitude to her advisor, Dr. Krishna Dev Kumar, for his guidance during the process of this dissertaton work. The author is also grateful to Dr. Yaodong Pan, and Dr. Anmin Zou for their discussion and support for this dissertation. The author acknowledges the financial support from Ryerson University. The author acknowledges the testing support from Space Engineering Lab in York University, especially of Dr. Regina Lee, Mark Post, and Tyler Ustrzycki. Finally, the author wishes to express her deep gratitude to her family for their continuous and loving support in every step of this journey.

ix

Dedication

To My Father and My Mother

xi

List of Publications

Articles published in refereed journals: 1. Li, J., Pan, Y., Kumar, K.D., "Design of Asymptotic Second-order Sliding Mode Control for Satellite Formation Flying", AIAA Journal of Guidance, Control, and Dynamics, Vol. 35, No, 1, pp. 309-316, 2012. 2. Li, J., Kumar, K.D., "Fault Tolerant Attitude Synchronization Control during Formation Flying", Journal of Aerospace Engineering, Vol. 24, No. 3, pp. 251-263, 2011. 3. Li, J., Kumar, K.D., "Decentralized Fault Tolerant Control for Satellite Attitude Synchronization", IEEE Transactions on Fuzzy Logic Systems, Vol. 20, No. 3, pp. 1-15, 2012. Articles submitted to refereed journals: 1. Li, J., Kumar, K.D., "Fault Detection and Fault Tolerant Control of Satellite Formation Flying", submitted on March 10th 2012, IEEE Transactions on System Man and Cybernetics Part C.

Articles published in refereed conference proceedings: 1. Li, J., Kumar, K.D., "Formation Flying Control of Small Satellites", Proceedings of AIAA Guidance, Navigation, and Control Conference, Toronto, Canada, August 2-5, 2010.

2. Li, J., Kumar, K.D., "Design of Adaptive Fuzzy Terminal Sliding Mode Control for Formation Flying," Proceedings of the 15th Canadian Aeronautics and Space

xii Institute (CASI) ASTRO Conference, Toronto, Canada, May 4-6, 2010.

3. Li, J., Kumar, K.D., "Fault Tolerant Attitude Control during Formation Flying ", Advances in Astronautical Sciences, Proceedings of the 20th AAS/AIAA Space Flight Mechanics Meeting - AAS 10-111, San Diego, CA, February 14-17, 2010.

4. Li, J., Kumar, K.D., "Decentralized Fuzzy Fault Tolerant Control for Multiple Satellites Attitude Synchronization ," 2011 IEEE International Conference on Fuzzy Systems, Taipei, Taiwan, June 27-30, 2011.

5. Li, J., Kumar, K.D., "Intelligent Fault Detection, Identification and Control of Satellite Formation Flying", 8th International Conference on Informatics in Control, Automation and Robotics, Noordwijkerhout, The Netherlands, July 28-31, ICINCO 2011.

Articles accepted by refereed conference: 1. Li, J., Post, M. A., Lee, R., Kumar, K.D., "Nanosatellite Nonlinear Attitude Control Testing on an Air Bearing System," Proceedings of the 16th Canadian Aeronautics and Space Institute (CASI) ASTRO Conference, Quebec City, Canada, April 24-26, 2012.

Contents

Author's Declaration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Abstract . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Dedication . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . List of Publications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . List of Figures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . List of Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Nomenclature . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 Introduction 1.1 Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1.1.1 1.1.2 1.2 Faults in Satellite Attitude and Orbit Control System . . . . . . . . Small Satellite Formation Flying and Attitude Control System . . .

iii v vii ix xi xvii xxvii xxxi 1 2 2 7 10 10 11 16 21 21 22 23 26

Literature Review and Background . . . . . . . . . . . . . . . . . . . . . . 1.2.1 1.2.2 1.2.3 1.2.4 Fault Detection, Isolation and Control . . . . . . . . . . . . . . . . Satellite Formation Flying . . . . . . . . . . . . . . . . . . . . . . . Satellite Attitude Control Systems during Formation Flying . . . . Nano/picosatellite Attitude Control System Testing Methodology .

1.3

Research Objectives and Contributions . . . . . . . . . . . . . . . . . . . . 1.3.1 1.3.2 Objectives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Research Contributions . . . . . . . . . . . . . . . . . . . . . . . . .

1.4

Dissertation Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2 Design of Adaptive Fuzzy Terminal Sliding Mode Control for Formation Flying 2.1 2.2 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29 29 30

xiv 2.2.1 2.2.2 2.2.3 2.2.4 2.3 System Model and Equations of Motion

Contents
. . . . . . . . . . . . . . . 30 33 34 35 36 36 41 47 47 68 80

Problem Formulation . . . . . . . . . . . . . . . . . . . . . . . . . . Basic Fuzzy Logic System . . . . . . . . . . . . . . . . . . . . . . . Adaptive Fuzzy Sliding Mode Control . . . . . . . . . . . . . . . . .

Adaptive Fuzzy Terminal Sliding Mode Fault Tolerant Control Design . . . 2.3.1 2.3.2 Fully Actuated Control and Stability Analysis . . . . . . . . . . . . Under-actuated Control and Stability Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2.4

Results and Discussions 2.4.1 2.4.2

Fully Actuated SFF . . . . . . . . . . . . . . . . . . . . . . . . . . . Under-actuated SFF . . . . . . . . . . . . . . . . . . . . . . . . . .

2.5

Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3 Design of Asymptotic Second-order Sliding Mode Control for Formation Flying 3.1 3.2 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Asymptotic 2nd SMC Architecture . . . . . . . . . . . . . . . . . . . . . . 3.2.1 3.2.2 3.3 Problem Formulation . . . . . . . . . . . . . . . . . . . . . . . . . . Design of Chattering-free SMC and Stability Analysis . . . . . . . . 81 81 82 82 86 91 92 92 93 100 101 101 102 103 104

Application to Satellite Formation Flying . . . . . . . . . . . . . . . . . . . 3.3.1 3.3.2 3.3.3 Formation Keeping . . . . . . . . . . . . . . . . . . . . . . . . . . . Formation Maneuvers . . . . . . . . . . . . . . . . . . . . . . . . . . Formation Keeping under Faults . . . . . . . . . . . . . . . . . . . .

3.4

Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4 Attitude Synchronization Control of Formation Flying 4.1 4.2 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . System Model and Equations of Motion . . . . . . . . . . . . . . . . . . . . 4.2.1 4.2.2 Kinematics and Dynamics of Rigid Spacecraft with Quaternion . .

Relative Attitude Kinematics and Dynamics . . . . . . . . . . . . .

Contents
4.2.3 4.3 Relative Attitude Tracking Error Kinematics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

xv 106 107 109 110 110 111 113 118 121 121 140 143 143 144 144 146 148 148 149 151 151 152 154 155 157 159 160 169

Design of Fault Tolerant Control 4.3.1 4.3.2 4.3.3 4.3.4 4.3.5

Mathematical Model for Relative Attitude Controller . . . . . . . . Adaptive Fuzzy Terminal Sliding Mode Control Design . . . . . . . Terminal Sliding Surface . . . . . . . . . . . . . . . . . . . . . . . . Fuzzy Logic System . . . . . . . . . . . . . . . . . . . . . . . . . . . Stability Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4.4

Results and Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.4.1 4.4.2 Fault-free Condition . . . . . . . . . . . . . . . . . . . . . . . . . . Fault Condition . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4.5

Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5 Decentralized Attitude Synchronization of Formation Flying 5.1 5.2 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.2.1 5.2.2 5.2.3 5.2.4 5.2.5 5.3 Attitude Dynamics and Kinematics . . . . . . . . . . . . . . . . . . Attitude Tracking for Station Keeping and Formation Keeping . . . Reference Attitude Tracking . . . . . . . . . . . . . . . . . . . . . . Mathematical Model for Controller Design . . . . . . . . . . . . . . Consensus Tracking . . . . . . . . . . . . . . . . . . . . . . . . . . .

Design of Nonsingular Fast Fuzzy Terminal Sliding Mode Control . . . . . 5.3.1 5.3.2 5.3.3 5.3.4 Nonsingular Fast Terminal Sliding Mode . . . . . . . . . . . . . . . Fault Estimation by Fuzzy Logic System . . . . . . . . . . . . . . . Nonsingular Fast Fuzzy Terminal Sliding Mode Controller . . . . . Stability Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5.4

Results and Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.4.1 5.4.2 5.4.3 Ideal Conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Realistic Conditions

Different Information Topology . . . . . . . . . . . . . . . . . . . .

xvi 5.5

Contents
Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 172

6 Fault Detection, Identification and Fault Tolerant Control of Formation Flying 6.1 6.2 6.3 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Problem Statement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Fault Detection and Accommodation Scheme . . . . . . . . . . . . . . . . . 6.3.1 6.3.2 6.4 Fault Detection, Identification and Stability Analysis . . . . . . . . Fault Accommodation and Stability Analysis . . . . . . . . . . . . . 173 173 175 177 177 186 190 192 192 201 207 209 209 211 211 213 215 217 225 225 245 247 247 251 251

Results and Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6.4.1 6.4.2 6.4.3 Fault Free . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Actuator Fault . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Sensor Fault . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6.5

Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

7 Experimental Testing 7.1 7.2 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Fault Tolerant Control Design of Attitude Control System . . . . . . . . . 7.2.1 7.2.2 7.2.3 7.3 Satellite Dynamics and Kinematics . . . . . . . . . . . . . . . . . . NFFTSMC Control Design . . . . . . . . . . . . . . . . . . . . . . . Numerical Results and Discussion . . . . . . . . . . . . . . . . . . .

Experimental Testing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7.3.1 7.3.2 Control Software . . . . . . . . . . . . . . . . . . . . . . . . . . . . Results and Discussion . . . . . . . . . . . . . . . . . . . . . . . . .

7.4

Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

8 Conclusions 8.1 8.2 8.3 Contributions Outline . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Limitations of the Control Methods . . . . . . . . . . . . . . . . . . . . . . Future Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Contents
References

xvii 255

List of Figures

1.1 1.2 1.3

AOCS Failure Distributions [Tafazoli 2009]. . . . . . . . . . . . . . . . . . Different Cases of Relative Motion Dynamics System [Fontdecaba 2008]. . Scattered Areas of Fault Tolerant Control Research and Decomposition of Fault Tolerant Control [Patton 1997]. . . . . . . . . . . . . . . . . . . . . .

3 7

10 27 31 48

1.4 2.1 2.2 2.3

Organization Chart of Dissertation . . . . . . . . . . . . . . . . . . . . . . Geometry of Orbits Motion of Leader and Follower Satellite . . . . . . . . Gaussian Membership Functions . . . . . . . . . . . . . . . . . . . . . . . . AFTSMC controller: Relative position errors and thrust demand of formation keeping, thruster fault case A, fault case B happened permanently after 2 orbits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

52

2.4

AFTSMC controller: 3D trajectory of the follower spacecraft over 20 orbits of formation keeping, thruster fault A happened permanently after 2 orbits 53

2.5

AFTSMC controller: 3D trajectory of the follower spacecraft over 20 orbits of formation keeping, thruster fault B happened permanently after 2 orbits 54

2.6

AFTSMC controller: Fault estimation and J2 disturbances of formation keeping, thruster fault A happened after 2 orbits . . . . . . . . . . . . . . . 55

2.7

AFTSMC controller: Fuel consumption of formation keeping, thruster fault A happened permanently after 2 orbits . . . . . . . . . . . . . . . . . . . . 56

2.8

PD controller: 3D trajectory of the follower spacecraft over 20 orbits of formation keeping, thruster fault A happened permanently after 2 orbits ( + denotes the leader spacecraft) . . . . . . . . . . . . . . . . . . . . . . . . 57

2.9

AFTSMC controller: Relative position errors and thrust demand of formation keeping with AFTSMC controller using 3 mN and 5 mN thrusters, respectively . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58

xx

List of Figures
2.10 AFTSMC controller: Fuel consumption for the fault case with AFTSMC controller using 3 mN and 5 mN thrusters, respectively . . . . . . . . . . . 2.11 AFTSMC controller: Relative position errors and thrust demand of formation keeping under sensors jam, sensors degrade, sensors experience periodic additive fault permanently and fault free case . . . . . . . . . . . . . . . . 2.12 AFTSMC controller: Fuel consumption of formation keeping under all sensors jam, sensors degrade, sensors experience periodic additive fault permanently and fault free case . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.13 AFTSMC controller and PD controller: Relative position errors and thrust demand of formation keeping, sensors degrade 10% after 2 orbits . . . . . . 2.14 AFTSMC controller and PD controller: Fuel consumption of formation keeping, sensors degrade 10% after 2 orbits . . . . . . . . . . . . . . . . . . . . 2.15 AFTSMC controller and PD controller: Relative position errors and thrust demand of formation keeping, all sensors experience periodic additive fault permanently after 2.0 orbits . . . . . . . . . . . . . . . . . . . . . . . . . . 2.16 AFTSMC controller and PD controller: Fuel consumption of formation keeping, all sensors experience periodic additive fault permanently after 2.0 orbits 65 2.17 AFTSMC controller: Relative position errors and thrust demand of formation maneuvering . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.18 AFTSMC controller: Fuel consumption of formation maneuvering . . . . . 2.19 Relative position errors and thrust demand for formation keeping for circular reference orbit fully actuated SFF system . . . . . . . . . . . . . . . . . . . 2.20 Relative position errors and thrust demand for circular reference orbit formation keeping when two thrusters jam during 4.5 - 5.5 orbits for underactuated SFF system . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.21 3D trajectory for circular reference orbit formation keeping when two thrusters jam during 4.5 - 5.5 orbits for under-actuated SFF system . . . . 72 71 70 66 67 64 63 62 61 60 59

List of Figures
2.22 Fuel consumption for circular reference orbit formation keeping when two thrusters jam during 4.5 - 5.5 orbits for under-actuated SFF system . . . . 2.23 Sliding surfaces and Fuzzy parameter estimated for circular reference orbit formation keeping when two thrusters jam during 4.5 - 5.5 orbits for underactuated SFF system . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.24 Relative position errors and thrust demand for formation maneuvers for circular reference orbit under-actuated SFF system . . . . . . . . . . . . . 2.25 3D trajectory for formation maneuvers for circular reference orbit underactuated SFF system . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.26 Relative position errors and thrust demand for circular reference orbit formation keeping when two sensors jam during 2.5 - 3.0 orbits for under-actuated SFF system . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.27 3D trajectory for circular reference orbit formation keeping when two sensors jam during 2.5 - 3.0 orbits for under-actuated SFF system . . . . . . . . . 3.1 Relative position error, thrust demand and fuel consumption for formation keeping e=0 (2nd SMC-dash-dot lines; AFTSMC-dash lines; Chattering Free SMC-dot lines; SMC-solid lines) . . . . . . . . . . . . . . . . . . . . . . . . 3.2 Relative position error, thrust demand and fuel consumption for formation maneuvering (2nd SMC-dash-dot lines; AFTSMC-dashed lines; Chattering SMC free-dot lines; SMC-solid lines) . . . . . . . . . . . . . . . . . . . . . 3.3 Relative position error, thrust demand and fuel consumption for formation keeping, thruster fault after 1 orbit e=0 (2nd SMC-dash-dot lines; AFTSMCdashed lines; Chattering Free SMC-dot lines; SMC-solid lines) . . . . . . . 3.4 Relative position error, thrust demand for formation keeping e=0.7 (ASMCsolid lines; NTSMC-dash lines) 3.5 . . . . . . . . . . . . . . . . . . . . . . . .

xxi

73

74

75

77

78

79

95

96

97

98

Relative position error, thrust demand for formation keeping e=0.7 (2nd SMC-solid lines) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99

xxii 4.1 4.2 4.3

List of Figures
Desired Relative Attitude during Formation Flying . . . . . . . . . . . . . Ryerson University Picosatellite with Reaction Wheels . . . . . . . . . . . Four Reaction Wheel Layout for Attitude Synchronization Control during Formation Flying . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106 108 103 105

4.4 4.5

Fault tolerant control methodology for satellite attitude system

. . . . . .

Fault tolerant AFTSMC control fault free case (case 1), with gravity gradient torque disturbances: quaternion . . . . . . . . . . . . . . . . . . . . . . . . 122

4.6

Fault tolerant AFTSMC control fault free case (case 1), with gravity gradient torque disturbances: angular velocity . . . . . . . . . . . . . . . . . . . . . 123

4.7

Fault tolerant AFTSMC control fault free case (case 1), with gravity gradient torque disturbances: wheel velocity . . . . . . . . . . . . . . . . . . . . . . 124

4.8

Fault tolerant AFTSMC control fault free case (case 1), with gravity gradient torque disturbances: wheel torque . . . . . . . . . . . . . . . . . . . . . . . 125

4.9

Fault tolerant AFTSMC control fault free case (case 2), with gravity gradient torque and external disturbances: quaternion . . . . . . . . . . . . . . . . . 126

4.10 Fault tolerant AFTSMC control fault free case (case 2), with gravity gradient torque and external disturbances: angular velocity . . . . . . . . . . . . . . 4.11 Fault tolerant AFTSMC control fault free case (case 2), with gravity gradient torque and external disturbances: wheel velocity . . . . . . . . . . . . . . . 4.12 Fault tolerant AFTSMC control fault free case (case 2), with gravity gradient torque and external disturbances: wheel torque . . . . . . . . . . . . . . . 4.13 Fault tolerant AFTSMC control fault free case (case 2), with gravity gradient torque and external disturbances: sliding surface . . . . . . . . . . . . . . . 4.14 Fault tolerant AFTSMC control wheel failure case (case 3), with gravity gradient torque and external disturbances, after 0.0018 orbit, wheel 2 fails permanently and wheels 3 and 4 wheel degrade by 80% and 60%: quaternion 131 130 129 128 127

List of Figures
4.15 Fault tolerant AFTSMC control wheel failure case (case 3), with gravity gradient torque and external disturbances, after 0.0018 orbit, wheel 2 fails permanently and wheels 3 and 4 wheel degrade by 80% and 60%: angular velocity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.16 Fault tolerant AFTSMC control wheel failure case (case 3), with gravity gradient torque and external disturbances, after 0.0018 orbit, wheel 2 fails permanently and wheels 3 and 4 wheel degrade by 80% and 60%: wheel velocity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.17 Fault tolerant AFTSMC control wheel failure case (case 3), with gravity gradient torque and external disturbances, after 0.0018 orbit, wheel 2 fails

xxiii

132

133

permanently and wheels 3 and 4 wheel degrade by 80% and 60%: wheel torque134 4.18 Fault tolerant AFTSMC control wheel failure case (case 3), with gravity gradient torque and external disturbances, after 0.0018 orbit, wheel 2 fails permanently and wheels 3 and 4 wheel degrade by 80% and 60%: sliding surface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.19 Fault tolerant AFTSMC control wheel failure case (case 4), with gravity gradient torque and external disturbances, at 0s, wheel 2 fails permanently and wheel 3 degrades by 90%: quaternion . . . . . . . . . . . . . . . . . . 4.20 Fault tolerant AFTSMC control wheel failure case (case 4), with gravity gradient torque and external disturbances, at 0s, wheel 2 fails permanently and wheel 3 degrades by 90%: angular velocity . . . . . . . . . . . . . . . . 4.21 Fault tolerant AFTSMC control wheel failure case (case 4), with gravity gradient torque and external disturbances, at 0s, wheel 2 fails permanently and wheel 3 degrades by 90%: wheel velocity . . . . . . . . . . . . . . . . . 4.22 Fault tolerant AFTSMC control wheel failure case (case 4), with gravity gradient torque and external disturbances, at 0s, wheel 2 fails permanently and wheel 3 degrades by 90%: wheel torque . . . . . . . . . . . . . . . . . 139 138 137 136 135

xxiv

List of Figures

4.23 Fault tolerant AFTSMC control wheel failure case (case 4), with gravity gradient torque and external disturbances, at 0s, wheel 2 fails permanently and wheel 3 degrades by 90%: sliding surface . . . . . . . . . . . . . . . . . 5.1 Undirected Graph of Four Satellites and Virtual Leader Satellite, Case 1 (Left) and Case 3 (Right) . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.2 Formation-keeping Tracking Errors using NFFTSMC for three vector quaternion components, qv ij denotes the error for each pair of satellites i and j (Case 1: fault free case without external disurbances) . . . . . . . . . . . . 5.3 Station-keeping Tracking Error, Wheel Speed, Wheel Voltage, Wheel Torque and Angular Velocity Simulation Results of Satellite 1 using NFFTSMC with four reaction wheels per satellite (Case 1: fault free case without external disturbances) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.4 Formation-keeping Tracking Errors using NFFTSMC for three vector quaternion components, qv ij denotes the error for each pair of satellites i and j (Case 2: fault case with external disturbances) . . . . . . . . . . . . . . . . 5.5 Station-keeping Tracking Error, Wheel Speed, Wheel Voltage and Wheel Torque Simulation Results of Satellite 1 using NFFTSMC with four reaction wheels per satellite (Case 2: fault case with external disturbances) . . . . . 5.6 Station-keeping Tracking Error and Wheel Torque Simulation Results of Satellites 2, 3 and 4 using NFFTSMC with four reaction wheels per satellite (Case 2: fault case with external disturbances) . . . . . . . . . . . . . . . . 5.7 Station-keeping Tracking Error and Wheel Torque Simulation Results of Satellites 2, 3 and 4 using NFFTSMC with four reaction wheels per satellite (Case 2: fault case with external disturbances) [Zoom-in Results] . . . . . . 5.8 Angular Velocity Errors using NFFTSMC for four satellites, ie denotes the angular tracking error for each satellite i (Case 2: fault case with external disturbances) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 167 166 165 164 163 162 161 160 140

List of Figures
5.9 Formation-keeping Tracking Errors using the Proposed Control Law without FLS for three vector quaternion components, qv ij denotes the error for each pair of satellites i and j (Case 2: fault case with external disurbances) . . . 5.10 Formation-keeping Tracking Error Simulation Results using NFFTSMC for three vector quaternion components, qv ij denotes the error for each pair of satellites i and j (Case 3: fault case with external disturbances and a different information topology) . . . . . . . . . . . . . . . . . . . . . . . . . 5.11 Station-keeping Error Simulation Results using NFFTSMC with three vector and one scalar quaternion components per satellite (Case 3: fault case with external disturbances and a different information topology) . . . . . . . . . 6.1 Fault diagnosis and control methodology for nonlinear system (SFF: satellite formation flying; FTC: fault tolerant control) . . . . . . . . . . . . . . . . . 6.2 6.3 6.4 SFF 3D Trajectory, Relative Position Errors and Control Input . . . . . .

xxv

168

170

171

174 193 194

SFF 3D Trajectory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Relative Position Errors, Control Input and Residual using Proposed FDI/FTC Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

195 196 197

6.5 6.6 6.7

Constant Thruster Fault Isolation using Proposed FDI Method . . . . . . . Fuzzy Estimation with Constant Thruster Fault . . . . . . . . . . . . . . . SFF 3D Trajectory, Relative Position Errors and Control Input using FDI/FTC in [Edwards et al. 2007] . . . . . . . . . . . . . . . . . . . . . . .

198 199 202 203 204

6.8 6.9

Constant Thruster Fault Fault Isolation using FDI in [Edwards et al. 2007] SFF 3D Trajectory using Proposed FDI/FTC Method . . . . . . . . . . .

6.10 Relative Position Errors and Control using Proposed FDI/FTC Method . . 6.11 Residual using Proposed FDI Method for Ramp Sensor Fault . . . . . . . . 6.12 SFF 3D Trajectory, Relative Position Errors and Control Input using the FDI method in [Alwi et al. 2008] . . . . . . . . . . . . . . . . . . . . . . . 6.13 Fault Isolation Method using Proposed FDI and FDI in [Alwi et al. 2008] .

205 206

xxvi 7.1

List of Figures
Angular Tracking Error, Quaternion Tracking Error, Angular Velocity Tracking Error Fault Tolerance Results using NFFTSMC Controller and NFTSMC Controller : t=70s, Actuator Fault; t=80s, Actuator noise . . . . . . . . . . 218

7.2

Wheel Voltage, Wheel Speed and Wheel Torques Fault Tolerance Results using NFFTSMC Controller and NFTSMC Controller: t=70s, Actuator Fault; t=80s, Actuator noise . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 219

7.3

Quaternion Tracking Error and Wheel Torques Results using NFFTSMC controller and NTSMC Controller: t=70s, Actuator Fault; t=80s, Actuator noise . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 220

7.4

Quaternion Tracking Error, Angular Velocity Tracking Error Fault Tolerance Results using 2nd SMC Controller and 3rd SMC Controller : t=70s, Actuator Fault; t=80s, Actuator noise . . . . . . . . . . . . . . . . . . . . . . . . . . 221

7.5

Wheel Voltage, Wheel Speed and Wheel Torques Fault Tolerance Results using 2nd SMC Controller and 3rd SMC Controller: t=70s, Actuator Fault; t=80s, Actuator noise . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 222 223 223 224 227 228 229 230 231

7.6 7.7 7.8 7.9

Spherical Air Bearing System Model . . . . . . . . . . . . . . . . . . . . . Spherical Air Bearing Setup with Electronics System and Control System . Software Flow Chart of Spherical Air Bearing System . . . . . . . . . . . . Nanosatellite 90 Degrees Slew . . . . . . . . . . . . . . . . . . . . . . . . .

7.10 Nanosatellite Tracking Error during 90 Degrees Slew . . . . . . . . . . . . 7.11 Nanosatellite Control during 90 Degrees Slew . . . . . . . . . . . . . . . .

7.12 Nanosatellite PWM Signal during 90 Degrees Slew . . . . . . . . . . . . . . 7.13 Nanosatellite 180 Degrees Slew with Actuator Faults . . . . . . . . . . . .

7.14 Nanosatellite Tracking Error during 180 Degrees Slew with Actuator Faults 232 7.15 Nanosatellite Control during 180 Degrees Slew with Actuator Faults . . . . 7.16 Nanosatellite Torque during 180 Degrees Slew with Actuator Faults . . . . 7.17 Nanosatellite PWM Signal during 180 Degrees Slew with Actuator Faults . 233 234 235

7.18 Nanosatellite 90 Degrees Slew with AFSMC, 2nd SMC and 3rd SMC in 180 s237

List of Figures
7.19 Nanosatellite Tracking Error during 90 Degrees Slew with AFSMC, 2nd SMC and 3rd SMC in 180 s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7.20 Nanosatellite Control during 90 Degrees Slew with AFSMC, 2nd SMC and 3rd SMC in 180 s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

xxvii

238

239

7.21 Nanosatellite 90 Degrees Slew with AFSMC, 2nd SMC and 3rd SMC in 250 s240 7.22 Nanosatellite 90 Degrees Slew tracking errors with AFSMC, 2nd SMC, 3rd SMC and PID in 360 s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7.23 Nanosatellite Control Input using AFSMC, 2nd SMC, 3rd SMC and PID in 360 s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7.24 Fuzzy Logic System with AFSMC in 360 s . . . . . . . . . . . . . . . . . . 7.25 Sliding Motion of AFSMC, 2nd SMC and 3rd SMC in 360 s . . . . . . . . 242 243 244 241

List of Tables

1.1 1.2 1.3 1.4 2.1 2.2 2.3 3.1 4.1 4.2 5.1 5.2 6.1 6.2 6.3 7.1 7.2 7.3 7.4 7.5

Summary of On-orbit Failures of Thruster Systems . . . . . . . . . . . . . Summary of On-orbit Failures of Sensor and Attitude Control Systems . . Summary of Canadian Small Satellites . . . . . . . . . . . . . . . . . . . . Summary of Control Performance for Satellite Formation Flying . . . . . . Fully Actuated AFTSMC Controller Parameters for Numerical Analysis . . Spacecraft Orbital Parameters and System Parameters . . . . . . . . . . . Under-actuated AFSMC Controller Parameters for Numerical Analysis . . Satellite Orbital Parameters and System Parameters . . . . . . . . . . . .

5 6 8 8 50 51 69 91 119 119 158 159 190 191 192 215 215 216 216

Satellite Attitude Parameters and System Parameters . . . . . . . . . . . . Fault Tolerant Controller Parameters for Numerical Analysis . . . . . . . . Microsatellites Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . NFFTSMC Controller Parameters for Numerical Analysis . . . . . . . . . . Satellite Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Second Order Sliding Mode Controller Parameters for Numerical Analysis . Second Order Sliding Mode Observer Parameters for Numerical Analysis . Satellite Parameters for ACS . . . . . . . . . . . . . . . . . . . . . . . . . . NFFTSMC Controller Parameters for Numerical Analysis . . . . . . . . . . 2nd SMC Controller Parameters for Numerical Analysis . . . . . . . . . . . 3rd SMC Controller Parameters for Numerical Analysis . . . . . . . . . . . Summary of Tracking Error Performance for NFFTSMC, 2nd SMC and 3rd SMC Controller without Fault and Reaction Wheel Friction (t=500s) . . .

217

7.6

Summary of Tracking Error Performance for NFFTSMC, 2nd SMC and 3rd SMC Controller with Multiple Faults and Reaction Wheel Friction (t=500s) 217

xxx 7.7 7.8

List of Tables
PID Controller Parameters for Numerical Analysis . . . . . . . . . . . . . . AFSMC Controller Parameters for Numerical Analysis . . . . . . . . . . . 227 227

Nomenclature
List of symbols

a e ex ey ez i mF rF rL rdc rdpc  X, Xd x, y, z    u  Jsi mi
B iBI

Semi-major axis of the reference orbit, km Eccentricity of the reference orbit Relative radial position tracking error, km Relative along track position tracking error, km Relative cross track position tracking error, km Inclination of the reference orbit, deg Mass of the follower satellite, kg Radial position of the follower satellite from the Earth center, km Radial position of the leader satellite from the Earth center, km Nominal radius of the desired circular formation, km Nominal radius of the desired projected circular formation, km The desired projected circular formation phase, deg State vector, Desired state vector Relative position coordinates (radial, along track, cross track) Longitude of the ascending node, deg Argument of perigee, deg True anomaly Formation flying control force, N Sliding Surface Moment of inertia of ith satellite, kgm2 Mass of satellite, kg Angular velocity relative to inertial frame, rad/s Moment of inertia of ith reaction wheel, kgm2 Angular velocity of ith reaction wheel, rad/s Attitude control torque, Nm

Jwi i rwi , u

xxxii W i dW i q ¯i q ¯d qvi ,  q4i ,  eai f ¯ A µi  Gravity gradient torque, Nm External disturbances, Nm Unit quaternion of ith satellite Desired quaternion of satellite Quaternion of ith satellite, vector component Quaternion of ith satellite, scalar component Input voltage of reaction wheel, V Coulomb friction of reaction wheel, Nm Information exchange weighted adjacency matrix Fuzzy membership function Fuzzy basis function

Lists of abbreviations ACS AOCS Attitude Control System Attitude and Orbit Control System

AFSMC Adaptive Fuzzy Sliding Mode Control ASMC CanX ECI FDI FTC GN&C HIL IMU LEO LVLH MIMO Adaptive Sliding Mode Control Canadian Advanced Nanospace eXpermiment Earth Centered Inertial Fault Detection and Isolation Fault Tolerant Control Guidance, Navigation, & Control Hardware-In-Loop Inertial Measurement Unit Low Earth Orbit Local Vertical Local Horizontal Multiple Input Multiple Output

xxxiii NEMO Naval EarthMap Observer NTSMC Nonsingular Terminal Sliding Mode Control PWM RWA SFF SMC TSMC UUB VSC Pulse Width Modulation Reaction Wheel Assembly Spacecraft Formation Flying Sliding Mode Control Terminal Sliding Mode Uniformly Ultimately Bounded Variable Structure Control

2ndSMC Second order Sliding Mode Control 3rdSMC Third order Sliding Mode Cotrol

Chapter 1

Introduction

Autonomous multiple satellite formation flying will be a very important technology for many future missions. Satellite Formation Flying (SFF) was proposed by the United State Air Force (USAF) Scientific Advisory Board in the late 1990s. Formations of satellites have many benefits including enhanced quality, added dimensions of observation, system robustness and lower life cycle cost. Civilian commercial and military requirements, and the development of scientific needs in biology, ecology, geology, planetary sciences, and astronomy have been driving the demand for distributed satellite systems, and in particular for satellite formation flying systems. Space agencies, including, NASA, ESA, CSA, and JAXA, have been developing reliable autonomous multiple satellite formation flying. Reliability is a critical design attribute for systems operating in remote or inhospitable environments. Because physical access to these high-value assets is difficult or impossible, maintenance cannot be relied upon to compensate for substandard reliability. Designing high-reliability into these systems is an essential engineering and financial imperative [Castel & Saleh 2009]. Failures in space systems can be hazardous to the spacecraft industry and to society. Analysis of a large number of orbital failures has shown that although only 6% are due to launch failures, the launch failure is the highest space mission failure cost at 42% [Tafazoli 2009]. Fault diagnostic and fault tolerant control systems are possible solutions to accomplish a particular mission. Such systems have been used in space vehicles, robotics and other military and industrial settings. The behavior of many space systems is complex. Control of dynamic space systems requires advanced, automated, integrated control and monitoring systems. A survey [Tafazoli 2009] shows 32% of all spacecraft failures are due to failures in the attitude and orbit control systems of the spacecraft. Re-

2 cently, innovative small satellite (micro/nano/pico-satellite) designs have pioneered many advances in satellite technology. There has been substantial progress in the design of new sensing and actuation devices for nano/picosatellites, thereby increasing the demand for performance and capability of attitude sensors and actuators on board small satellites. The development of practical viable autonomous satellite fault tolerant control algorithms for micro/nano/pico-satellites has not kept pace with new capabilities enabled by novel hardware designs and increased computational power. This thesis chronicles the investigation process and results for micro/nano/pico-satellite formation flying and sparse aperture techniques for satellite attitude and orbit control systems that can implement fault tolerance. The following sections outline the motivation, aim, and objectives of the study and provide a more detailed thesis overview.

1.1
1.1.1

Motivation
Faults in Satellite Attitude and Orbit Control System

Researchers have often sought fault-avoidance techniques such as enhancements in design and fabrication, and elaborate and intensive testing to improve the reliability of spacecraft attitude orbit control systems (AOCS). However, failures do occur in various subsystems during their long operational life leading to malfunction of the entire control system. Therefore, it is important to design a fault tolerant control system that operates satisfactorily, not only in the absence of, but also in the presence of, system component failures. More recent research has revolved around specific spacecraft subsystems. For example, Roberston and Stoneking [Robertson & Stoneking 2003] studied failures in attitude control subsystems. Tafazoli [Tafazoli 2009] analyzed not just a single subsystem's failures but the comparative contribution of various subsystems to spacecraft on-orbit failures. Spacecraft failures between 1981 and 2005 had been studied by [Robertson & Stoneking 2003, Tafazoli 2009]. Based on Satellite News [Digest 2011] and other reports by [Robertson & Stoneking 2003, Ellery et al. 2008, Tafazoli 2009, Xu et al. 2011], satellite failures between

3 Jan. 1994 and Sep. 2011 are listed in Tables 1.1 and 1.2. The column labeled "Impact" can either consist of total loss, partial loss, mission interruption, shortened life, or performance loss. A total loss resulted if a satellite failed so that it could no longer perform the mission, or if it was deactivated or taken out of service due to an anomaly. A shortened life is equivalent to a total loss, although the loss has not yet occurred. The analysis did not include anomalies that resulted in loss of redundancy, or a minor interruption in the mission due to an operational work-around or software patching. Anomalies that occurred within the planned satellite operational checkout phase were not recorded unless they had an effect on the ability to perform the subsequent mission. A mission interruption was only recorded if it occurred for a substantial time period (more than a week) [Robertson & Stoneking 2003]. An AOCS failure can heavily cripple a space-

Figure 1.1: AOCS Failure Distributions [Tafazoli 2009].

craft (shown in Fig. 1.1). For a large portion of AOCS failures, the component causing the failure is unknown, due to lack of information. Nevertheless, almost 50% of AOCS failures are attributed to a combination of the following components: gyroscopes, momentum wheels and thrusters. Space is considered to be a dangerous environment. Heat transfer by radiation, a strong ultraviolet light from the Sun, nuclear radiation and even specks of dust in space will cause satellite subsystem (gyroscopes, momentum wheels and thrusters)

4 failure. One satellite's failure will affect other satellites' activities. For example, Galaxy 15's failure in geostationary orbit forced several other satellites to take evasive maneuvers in order to avoid interference from Galaxy 15. Fault tolerant control algorithms have been developed and applied to the satellites with failures. 1. In 2001, Far Ultraviolet Spectroscopic Explorer (FUSE) satellite had a failure with the loss of two of its four reaction wheels required for attitude control [Kruk et al. 2002]. Engineers modified the flight control law and established fine pointing capability [Roberts et al. 2004]. Later in 2004, the third reaction wheel failed. It took the engineers ten months to update the flight control algorithms. The mission lasted for another three years before all four reaction wheels died. 2. Radarsat1, made by the Canadian Space Agency and launched in November 1995 had a fault in November 2002. The deteriorating attitude control system affected the delivery of precise imaging to global clients. The engineer updated the control law very quickly and fixed the problem. 3. European Remote Sensing 2 satellite was successfully re-programmed to operate without gyroscopes. The last of the spacecraft's six gyros failed on 13 January 2001. Teams from ESTEC (ESA's Research and Technology Centre), ESOC (European Space Operations Centre) and Astrium came up with new navigation techniques so the ERS-2 satellite could outlast the failed gyroscopes (Satellite News [Digest 2011]). With increasing emphasis placed on reliability and safety, examples described above clearly motivate the need for development of FTC algorithms capable of overcoming sensor/actuator faults to prevent mission failure. AOCS are becoming more and more sophisticated with increasingly complex system configurations. Autonomously controlling these systems under a wide variety of operating conditions is a challenging task.

5 Table 1.1: Summary of On-orbit Failures of Thruster Systems Satellite/Launch/Failure Aritemis/7, 1992/7, 1993 Cause of Anomaly Blockage in xenon flow to ion thruster created stuck-closed failure Iridium 27/ 9, 1997/9, 1997 Thruster anomaly depleted operational fuel Nozomi/ 7, 1998/12, 1998 Consumed more fuel than expected during Earth swingby due to thruster valve stuck partially open. Galaxy 8i/ 12, 1997/9, 2000 EchoStar VI/ 7, 2000/4, 2001 Three of four xenon ion thrusters failed. One station keeping thruster and a pair of transponders were rendered unusable. Shortened Life Mission Interruption Mission Interruption Total loss Impact Mission Interruption

6 Table 1.2: Summary of On-orbit Failures of Sensor and Attitude Control Systems Satellite/Launch/Failure Anik E2 /4,1991/1,1994 STEP 0/5,1994/5,1994 Cause of Anomaly Magnetic storm destroyed ACS. Noisy earth sensor affects pointing accuracy. STEP 2/3,1994/7,1994 GPS BII-07/3,1990/5,1996 IMU (gyro) fails. 3-axis stabilization failure due to a second reaction wheel failure. Lewis/8,1997/8,1997 Design error in ACS; failure to monitor spacecraft during initial operations Terriers/5,1999/5,1999 ACS polarity error controlling magnetic torquer coil. Yohkoh/8,1991/12,2001 Attitude control system could not handle an eclipse sunset. TOPEX/8,1992/10,2005 Nro-L21/12,2006/12,2006 Pitch reaction wheel stalled. Attitude Control and Telemetry units share a common date bus and on board software fault. Sterkh1/1,2009/1,2010 Could not properly align its solar panels with the Sun owing to a malfunction of the satellite's flight control system. Galaxy 15/10,2005/4,2010 Aura/ 7,2004/3,2010 Reaction wheels faults Guidance/navigation telemetry indicates a disturbance of 875 Arcsec Mission Interruption Mission Interruption Total loss Total loss Total loss Total loss Total loss Total loss Mission Interruption Total loss Impact Mission Interruption Performance Loss

7

1.1.2

Small Satellite Formation Flying and Attitude Control System

1.1.2.1

Small Satellite Formation Flying

A key element of small satellite missions is to embrace cutting-edge technology and innovative design, and accept the risk this entails. The largest satellites are the size of a double-decker bus and can cost billions of dollars. Generally the smallest commercial satellites are over 50kg, and typically over 100kg. Very small spacecraft, however, those in the 1kg to 50kg range, have a cost low enough that failures are not financially crippling. Advanced technologies can be tried and operational experience accrued. In turn, advanced technologies that are developed in this thesis will endow the small spacecraft with the capabilities of much larger spacecraft.

Figure 1.2: Different Cases of Relative Motion Dynamics System [Fontdecaba 2008].

8 Space missions with relative motion dynamics systems (shown in Fig. 1.2) that use a certain number of satellites to accomplish the same goal, are of four types: formation flying missions, space rendez-vous, space debris and asteroids. The dynamics of relative motion of satellites within a cluster have made use of the Hill's equations [Hill 1878], the Clohessy-Wiltshire (CW) equations [Clohessy & Wiltshire 1960], the Lawden equations [Lawden 1954] and Tschauner-Hempel equations [Tschauner 1967]. Environmental forces such as gravitational perturbation, atmospheric drag, solar radiation pressure and electromagnetic forces [Chobotv 2002] will cause the formation to deviate from the desired trajectory. Two criteria are usually used to differentiate between them: the Guidance, Navigation, Control (GNC) system of the mission, and the relative dynamics between the satellites [Fontdecaba 2008]. Table 1.3: Summary of Canadian Small Satellites Satellite Power Mass ACS stability Volume Payload Mass CanX-2 2 - 7w 3.5kg 2 degrees 10×10×34cm 1kg Ryerson Satellite < 3.4w 1kg 1 degrees 10×10×10cm 0.5kg NEMO 80w 15kg 2 degrees 20×29×40cm 8kg YUSEND 4w 1.33kg 2 degrees 10×10×10cm 0.5kg

Table 1.4: Summary of Control Performance for Satellite Formation Flying Research Approach PD Lyapunov Velocity SMC ASMC Adative Neural Network Setting Time Middle High Middle Middle High Power Consumption Low Middle High High High Max Error Low High Middle Middle Middle

9 The issues for future small satellite formation flying missions are: control laws need to be evaluated in terms of efficiency, precision, and propellant consumption; navigation in formation flying is specific and it is not easy to measure precisely the distance between satellites; satellite formation flying will have complicated perturbations. However, several examples of small-satellite missions already exist, or are being developed. CanX-4 and CanX-5 are a pair of Canadian formation-flying nanosatellites (7.5kg) designed to demonstrate formation flying with digital elevation map height errors on the order of 1m in the flat-terrain case [Peterson et al. 2009]. Both of those satellite carry multistatic interferometric synthetic aperture radar (InSAR) payloads. Another famous small satellite (3.4kg) formation flying test-bed is Synchronized position-Hold, Engage, Reorient Experimental Satellites (SPHERES) developed at Massachusetts Institude of Technology and tested on the International Space Station. Novel control technology has been tested in this system and these technologies are essential to NASA formation flying missions [Ramirez et al. 2010]. In order to enable advanced micro/nano/pico-satellite formation flying, the tasks of orbit and attitude control should be studied with a focus on decentralized formation control with minimal information passage between the individual satellites.

1.1.2.2

Small Satellite Attitude Control System

The first small satellite UoSAT - 1 (50kg) was launched in October, 1981. The project was led by Martin Sweeting from University of Surrey. Another very sucessful small satellite was Clementine (227kg) for lunar observations in January 1994 [Laboratory 1994]. The total cost of the project was 75 million dollars. The ACS accuracy was 0.03 degree. Several nanosatellites and picosatellite being developed in Canada are listed in Table 1.3. YUSEND is a nanosatellite built by York University, Canada and will be launched in 2013. Those small satellites save time, money, and fuel, enabling scientists to gather information more cheaply and more reliably. The most accurate attitude control systems use momentum wheels or reaction wheels to obtain pointing accuracies of 0.0001 degree or better. However, these devices may be subjected to higher failure rates. The attitude of the satellite is

10 modeled using Euler parameters, quaternions, and Gibbs vector. Disturbances depend on the missions and orbital element of the satellite [Roth 2009]. New techniques will be required to improve ACS accurary and robustness.

1.2
1.2.1

Literature Review and Background
Fault Detection, Isolation and Control

Figure 1.3: Scattered Areas of Fault Tolerant Control Research and Decomposition of Fault Tolerant Control [Patton 1997]. Fault tolerant control (FTC) research is described in Fig. 1.3 and the main areas of fault tolerant control research are consisting of Fault Detection and Isolation (FDI), Robust Control, and Reconfigurable Control, with the unrelated option of supervision. These three areas can be combined as well. Active control methods include FDI (also known as System Identification), and control reconfiguration or restructuring, which can be projection based or adapted while on-line. FDI research is a very mature field providing many powerful quantitative and/or qualitative modelling tools and artificial intelligence tools [Patton 1997,Hwang et al. 2010]. Robust control [Wu & Saif 2007] and reconfigurable control [Richter et al. 2011] have attracted the attention of many researchers. FDI can avoid

11 the development of more serious faults. The combination of FDI/control reconfiguration is a complex issue [Patton 1997]. Most of the research on reconfigurable control is focused on the availability of a perfect FDI. Little attention has been paid to the design of the overall system and interaction between FDI and reconfigurable control. Therefore, this dissertation will focus on the combination of FDI and reconfiguration control [Patton 1997] (also called "Intelligent Control"). The control reconfiguration is based on stored control laws tailored to each anticipated fault condition [Rauch 1994]. In this dissertation, we will focus on the combination of FDI and reconfigurable active and passive controllers, with the addition of robust control for passive cases, as shown by the shaded area in the Venn diagram and organization chart. Faults can be classified as: (1) Defect, (2) Fault, (3) Failure, (4) Malfunction. The faults addressed in this dissertaton are recoverable fault type 1, 2 and 3. In general, FDI methods can be divided into two groups (Group No 1: use the plant model or Group No 2: do not use the plant model). In Group 1, the methods (also called analytical redundancy) are parity space (10%), observer (40%), parameter estimation (37%), neural network (6%), and others. In Group 2, the methods are physical redundancy, limit value checking, frequency analysis of measureed signals (5%), and expert systems (based on IfThen rules). Identifying the best FDI method is not an easy task and generally depends on the application. The criteria for FDI performance are fault detection time, false alarm rate, number of undetected faults and ability to isolate the fault [Samy et al. 2011]. FDI methods used in this thesis are the Fuzzy Logic Systems methods [Wang & Mendel 1992] and the sliding mode observer [Edwards et al. 2007].

1.2.2

Satellite Formation Flying

Satellite formation flying (SFF) has been identified as a significant technology for many different space missions. Precise spacecraft formations require the ability to keep each spacecraft in precise relative orbits (formation keeping), and the ability to change the relative orbits (reconfiguration). Low thrust control systems for autonomous coordinated

12 multiple spacecraft formation flying have been studied in great detail. In spite of the fact that precision formation flying has not yet been demonstrated, a profusion of research into the associated guidance, control and dynamics challenges exists. There are two control approaches for maintaining a formation in LEO: controlling the orbital elements of a formation [Schaub et al. 2000] and tracking specific reference trajectories in a relative Cartesian frame. One formation-keeping approach is to control the relative motion of the constituent satellites in a local-vertical/local-horizontal Cartesian reference frame. Controllers on the follower satellites in the formation actively track a set of established reference trajectories in the Hill frame [Hill 1878, Eyer 2009]. Many SFF control strategies have been developed, such as linear-quadratic regulator (LQR), intelligent control, adaptive control, adaptive learning control, synchronization control, and so on. These controllers are designed for either translational motion or rotational motion. These include linear control and nonlinear control methods which may be adaptive or non-adaptive. A PD controller with feedback linearization and Lyapunov-based control laws was suggested for optimum power consumption and tracking performance [Kristiansen & Nicklasson 2009]. Lyapunov-based nonlinear adaptive controllers was applied to SFF [de Queiroz et al. 2000, Wong et al. 2002, Kristiansen & Nicklasson 2009]. A neural network-based adaptive controller was suggested by [Gurfil & Kasdin 2003] for SFF in deep space missions. Lim and Bang [Lim & Bang 2009] developed a controller using an adaptive control technique for SFF under a thrust misalignment model and bounded disturbances using an electric propulsion system. This adaptive controller was shown to be more efficient than the backstepping controller with respect to fuel consumption during formation maneuvers in the presence of thrust misalignment. Based on the literature review, the performance of these control algorithms is listed in Table 1.4. The fault tolerant control of large satellites has been studied and verified for decades. Adaptive sliding mode control (SMC) was developed by [Godard & Kumar 2010] as a fault tolerant controller without fault detection and isolation (FDI) for nanosatellite formation flying, where a nonlinear SFF model was used. [Massey & Shtessel 2005] proposed

13 a first order sliding mode controller with sliding mode disturbance observer and compared it with the super twisting sliding mode controller and the integrated second-order sliding mode controller for SFF. The simulation results showed that this method is effective in reducing the tracking errors of the follower satellite, and it results in lower fuel consumption than the other two sliding mode controllers. In this dissertation, a new second order sliding mode controller will be studied. Second order sliding mode control (2nd SMC) [Elimali & Olgac 1992, Wang et al. 2007, Defoort et al. 2009a] has been applied to MIMO nonlinear systems, and an asymptotic 2nd SMC algorithm without using derivatives was proposed [Pan et al. 2011] such that a 2nd sliding mode (SM) was reached asymptotically with a first order SM controller (1st SMC). The asymptotic convergence to the 2nd SM also happened in a 1st SMC system with fast dynamic actuators [Fridman 1993]. However, this algorithm can only be implemented in those systems where the coefficient of the derivative term in the dynamical equation describing the convergence to the sliding mode is positive, which is a necessary condition for the 2nd SM to be reached asymptotically. The stability of an asymptotic 2nd SM cannot be proved directly by SM control theory because the 2nd SM can not be reached in finite time with a 1st SMC. Fault tolerant control of micro/nano/pico-satellite formation flying with input constraints is still an open problem. Individual research has been carried out on fault tolerant control systems [Benosman & Lum 2010], and the systematic concepts and design terminology are not yet standardized. Most of the references use adaptive control or sliding mode control as fault tolerant control techniques. Tao and Kokotovic [Tao & Kokotovic 1992] presented a robust adaptive controller which is capable of achieving good tracking performance for linear plants with unknown hysteresis. Tang et al. [Tang et al. 2007] developed a direct adaptive approach under actuator failures for a nonlinear MIMO aircraft system. There is a need to examine the physical properties of actuators to choose an appropriate actuation scheme and to investigate the stability of zero dynamics for cases with compensable failure patterns. Similarly, Lim and Bang [Lim & Bang 2009] studied a controller using adaptive control techniques for satellite formation flying under a thrust misalignment model and

14 bounded disturbances using an electric propulsion system. The advantage of adaptive control to deal with actuator faults is that no FDD (fault detection and diagnosis) is needed. Tandale and Valasek [Tandale & Valasek 2006] developed a variable structure model reference controller, based on a mathematical actuator failure model for F-16 aircraft, which can handle parametric uncertainties, large initial condition errors, and actuator failures while maintaining adequate tracking performance. Diao and Passino [Diao & Passino 2001] explored a stable fault tolerant adaptive fuzzy neural network control for a turbine engine. They use intelligent control to accommodate system faults while depending on fault detection and diagnosis for fault information. However, such methods involve a large number of fault diagnosis systems for a highly nonlinear system and would not be practical for some cases. Alwi et al. [Alwi et al. 2008] considered a combination of a sliding mode controller and control allocation for fault tolerant control which is applied to a B747 aircraft model. The online sliding mode control allocation scheme shows that faults and even certain total actuator failures can be handled directly without reconfiguring the controller. However, the design methods are not simple. The range of application is limited where the effect of the faults is highly nonlinear. Most references use fuzzy logic systems as fault diagnosis methods. Fuzzy systems are able to approximate with accuracy for any real continuous function on a compact set. The dynamic changes due to faults are represented by a fuzzy logic system based on an adaptive corrective control law. The reason for sliding mode as FDI is the sliding motion will be broken and a residual is generated with the fault information when the faults happen in the system. The fault accommodation used in this dissertation is based on a fuzzy logic system and sliding mode control for a nonlinear systems. Adaptive fuzzy systems have been proven to be universal approximations [Wang 1997]. This type of system was designed using fuzzy logic to adaptively approximate the unknown nonlinear functions and to use adaptive laws for updating the parameters of fuzzy systems while operating based on Lyapunov stability theory [Labiod et al. 2005] . Adaptive fuzzy sliding mode control (AFSMC) has been widely used to deal with target-tracking problems. Lin and Hsu [Lin & Hsu 2002] used AFSMC to force a missile as close as possible to the instan-

15 taneous line of sight joining the ground tracker and the target. The adaptive fault tolerant fuzzy tracking controller has been used for the near-space vehicle in the reference [Jiang et al. 2010]. The adaptive fuzzy sliding mode control law has been used for networked flexible spacecraft during a large angle slew maneuver with time delay in reference [Dong et al. 2009]. Terminal sliding mode control has been used for spacecraft formation flying in reference [Hui & Li 2009]. Su et al. [Su et al. 2009] provided theoretical and experimental work based on variable structure control (SMC) with a fuzzy logic system for tracking control of the inverted pendulum. Also, nonlinear hyper-plane based sliding modes offer a wide variety of design alternatives with fast and finite time convergence [Man et al. 1994, Wu et al. 1998, Feng et al. 2002b]. To the best of our knowledge, no reference has applied an adaptive fuzzy terminal sliding mode control (AFTSMC) to spacecraft formation flying with thruster or sensor faults. SFF can be evaluated as an underactuated system if the configuration of thrusters (characterized by the failure of one or more pairs of thrusters) cannot provide three independent control thrusts in the radial, along-track, and cross-track directions, respectively. Underactuated formation flying systems have been studied in these references [Leonard et al. 1989, Kumar et al. 2007]. There are no general and effective control design methods for this problem. In this dissertation, this issue will be studied using adaptive fuzzy terminal sliding mode control. For larger faults during the SFF mission, the only solution is to use integrated systems with FDI and FTC. Dynamic neural network based fault detection and isolation has been employed for a pulsed plasma thruster in satellite formation flying [Valdes & Khorasani 2010]. A high order sliding mode observer has been considered to address actuator fault estimation in satellite formation flying [Edwards et al. 2007]. However, closed-loop control stability has not been included. A robust fault detection and diagnosis scheme has been proposed for a cluster of micro-satellites with actuator faults [Wu & Saif 2007]. Cooperative fault accommodation [Azizi & Khorasani 2008] based on a twolevel framework (formation-level fault recovery and fault diagnosis and identification) has been studied for satellite formation flying. According to recent survey papers by [Benos-

16 man 2010,Hwang et al. 2010], many interesting results have been obtained so far. But there is no work that treats both problems together (nonlinear fault detection and diagnosis and nonlinear fault tolerant control) in an effective applicable method. None of the existing designs accommodate uncertainty in the nominal dynamics and simultaneously adapt to both unknown plant parameters and unknown thruster and sensor faults. Real-life applications of those nonlinear fault tolerant control theories are also missing from the recent work. For example, Demetriou and Polycarpou [Demetriou & Polycarpou 1998] proposed a general framework for the detection, diagnosis and accommodation of a class of actuator faults. Huang and Tan [Huang & Tan 2008] developed a fault diagnosis and accommodation system for robotic systems. The primary focus of this dissertation is on developing an intelligent diagnosis and fault tolerant control system for satellite formation flying. The intelligent diagnosis and control system must have the ability to adapt to mostly nonlinear process behavior and perform a fault diagnosis to request maintenance and a decision.

1.2.3

Satellite Attitude Control Systems during Formation Flying

Formation flying missions may be divided into earth observation and space observation types. Synthetic aperture radar (SAR) is an example of an earth observation mission where the control objective is usually to point the payload at the same location on the Earth, requiring relative attitude to be either constant or tracking a time-varying signal depending on formation configuration and orbit. Space observation missions may also focus on astronomical and astrophysical research outside our solar system (e.g. DARWIN and TPF). The control objective usually involves formation attitude tracking while keeping relative satellite attitudes fixed. With the development of on-orbit servicing, circumnavigation of a target for proximity inspection has become a key concern for spacecraft mission design. The design of attitude control systems should be able to provide rapid attitude acquisition, tracking, and pointing capabilities, while the equations that govern large angle maneuvers are highly coupled and nonlinear. Relative attitude synchronization and angular velocity synchronization must be performed accurately while tolerating actuator faults, a typical

17 kind of fault for missions using reaction wheels and control moment gyroscopes. Faults are not always physically measurable and observable, cannot always be modeled accurately, and when modeled cannot be handled effectively by traditional control methods [Narendra & Balakrishnan 1997]. Reconfigurable control has been successfully used in unmanned aerial vehicles [Ellen et al. 2005] and F/A 18 aircraft [Ward & Monaco 2005]. Considerable research has focused on fault tolerant controller design with actuator fault detection and recovery schemes for underwater vehicles and satellites [Talebi & Patel 2006, Podder & Sarkar 2001, Zhu et al. 2002, Soylu et al. 2008, Jiang et al. 2009]. In one example, fault tolerant control of a minisatellite by four reaction wheels [Lin et al. 2008] is based on dynamic inversion and time-delay control theory, but without external disturbances. In another, an indirect robust adaptive fault tolerant controller [Cai et al. 2008] can handle unexpected disturbances, subsystem failures and limited resources, but for a single microsatellite with six thrusters. Adaptive control generally has bad impulse response and long tracking error settling times, and the large changes in control gain may damage the system more than the fault itself. Therefore, fault tolerant control design requires an extremely accurate and fast estimation of the dynamics caused by faults and disturbances [Alwi et al. 2008]. The problem of synchronized formation rotation and attitude control was explored in [Wang et al. 2005], but the dynamics model assumed no gravity and disturbances. A chattering-free sliding mode control for a six-DOF formation flying mission was developed by [Xu et al. 2005], where both position and attitude states were controlled using only thrusters. Another six-DOF controller was developed by [Krogastad & Gravdahl 2006] to synchronize the motion of a leader-follower formation of spacecraft with constant disturbances. Integrator backstepping and passivity controllers for formation coordination are explored by [Kristiansen et al. 2008], and Euler-Lagrange system theory was used to obtain three nonlinear control solutions. In [Mehrabian et al. 2009], formation keeping relative attitude synchronization and relative angular velocity synchronization were proposed, again assuming a gravity-free and disturbance-free environment. Although various control schemes have been proposed for fault-tolerant attitude control of satellites, none of the

18 literature discussed above has validated the performance of the algorithms on a reaction wheel assembly (RWA) or thrusters. Decentralized multi-agent cooperative control, including consensus control, formation control and flocking has been studied extensively. A decentralized attitude controller for satellite synchronization is beneficial for practical uses such as satellite surveillance, pointing control, formation flying and space based interferometry. The benefits of using a decentralized attitude controller are to avoid a complete redesign of the control system when new subsystems are added, and also to guarantee the stability of the whole system [Bakule 2008,Das & Lewis 2010]. Consensus tracking control for a group of spacecraft is more challenging if only a subset of group agents has access to the virtual leader. Another challenge is the design of reliable systems that are able to provide good performance even in the presence of uncertainties and faults [Panagi & Polycarpou 2011]. Decentralized control design had previously been used in spacecraft formation flying and spacecraft attitude control [VanDyke & Hall 2006, Ren 2007, Changa et al. 2009, Ren 2010]. Additional work on a decentralized approach to attitude coordination was given in [Abdessameud & Tayabi 2008,Mehrabian et al. 2009]. The existing attitude synchronization or coordination literature addresses important issues relating to attitude control of multiple spacecraft, such as the adaptation of the control system to modeling uncertainties, robustness to attenuate external disturbances, communication delay, and actuator saturation constraint accommodation. However these works do not address the problem of fault tolerance with actuator dynamics and none of them deals with small satellite formation flying systems. Fault detection and isolation (FDI) and fault-tolerant control (FTC) problems have been extensively studied for decades [Jiang et al. 2011]. Most traditional attitude faulttolerant control reconfiguration techniques rely on failure detection and isolation [Wu & Bai 2010, Jiang et al. 2011]. For example, in [Boskovi et al. 1999], the authors presented a fault detection and isolation (FDI) scheme based on the concept of Multiple Models, Switching, and Tuning (MMST) to detect faults and failure of thrusters for a spacecraft attitude control system (ACS). A iterative nonlinear neuron proportional, integral, and

19 derivative (INPID) observer was developed by [Wu & Saif 2006] for the detection and diagnosis of thruster faults on board a spacecraft. The parameters of the observer input are updated based on the proportional, integral, and derivative information of the fault estimation error. In [Tudoroiu & Khorasani 2007], the authors developed an interacting multiple model algorithm for detection and diagnosis of faults in a reaction wheel associated with the attitude control system of a satellite. Reconfigurable attitude control system design for spacecraft based on FDI approaches and system redesign is fairly complex and depends strongly on the efficacy of the fault detection algorithm. Also, explicit failure identification and system redesign may require substantial on-board computational resources, which is contrary to the prevailing cost reduction measures undertaken by most commercial and military satellite markets. Hu [Hu 2010] proposed a robust adaptive sliding mode fault tolerant controller with L2-gain performance for a single flexible spacecraft using redundant reaction wheels. In [Mahmoud 2009], a robust fault tolerant controller based on LMI optimization is proposed for discrete systems with parameter uncertainties. An alternative approach to reconfigurable ACS design is based on adaptive or approximation control theory, where the controller parameters are constantly updated based on adaptive or other estimates of the altered dynamics after failure [Tong et al. 2008]. Neural networks and fuzzy logic systems have been proposed as tools for approximating any well defined function over a compact set to arbitrary accuracy [Wang & Mendel 1992,Yu et al. 2005]. The fuzzy logic system is a very powerful technique for controlling systems with large uncertainties and strong nonlinearities. For example, a fuzzy controller with the minimum number of fuzzy rules and appropriate type of Gaussian and triangular membership functions has been used for precision control and real-time application [Green & Sasiadek 2006]. Neural networks for adaptive approximation have been successfully applied to the design of nonlinear fault tolerant controllers [Panagi & Polycarpou 2011]. In [Lin & Chen 2007], a cerebellar model articulation controller was used as a robust fault-tolerant controller for a biped robot. In the reference [Lin & Wang 2010], a decentralized observer-based fuzzy neural sliding mode control scheme was used for interconnected

20 unknown chaotic systems. Sliding mode control has attracted a great deal of attention for addressing uncertain nonlinear system control problems [Pang & Tang 2010, Xiang & Huangpu 2010]. Compared with traditional linear hyperplane sliding mode control, TSMC (terminal sliding mode control) can provide faster convergence and more precision. The use of TSMC allows high precision and stability in attitude tracking for a group of spacecraft. TSMC has been applied to single robotic agents in [Feng et al. 2002a], but not to multiple coordinated agents. However, there are two problems with TSMC: singularities in the system, and the requirement of bounded uncertainty. The first problem has been solved by nonsingular terminal sliding mode control (NTSMC) and the second problem could be solved by an uncertainty estimator. In the reference [Yang & Yang 2011], it is proven that nonsingular fast sliding mode terminal control can eliminate the singularity problem completely. Therefore, a nonsingular terminal sliding mode controller with a fuzzy logic system is proposed in this research as a fault-tolerant control strategy. Inspired by the works of [Yang & Yang 2011, Chen & Lin 2011], a nonsingular fast terminal fuzzy sliding mode controller (NFFTSMC) will be proposed for distributed cooperative attitude synchronization in this dissertation. The proposed attitude control system can provide precise 3-axis attitude tracking control of satellites in the presence of actuator faults and external disturbances. A fault diagnosis system is capable of detecting and isolating the faults in the system. But none of the existing fault diagnosis and fault tolerant control methodologies can meet all the requirements due to the variety of fault types. However, it is possible to design a novel fault tolerant control for satellite attitude system to improve control accuracy. To achieve fast tracking during formation flying, the control gain needs to be increased, which is not unrealistic in practice for small satellites. Consequently, it is very important to develop a new control algorithm with fast stability convergence and limited energy consumption. Higher order sliding mode control has desirable properties such as robustness and greater accuracy than first order sliding mode [Defoort et al. 2009b]. A quasi-continuous higher order sliding mode controller has recently been used for spacecraft attitude tracking

21 maneuvers [Pukdeboon et al. 2010]. Close examination of the existing literature indicates a lack of high order sliding mode fault tolerant control research as well as no comparative results with a nonsingular fast terminal fuzzy sliding mode controller (NFFTSMC) for actuator/controller faults and input constraints.

1.2.4

Nano/picosatellite Methodology

Attitude

Control

System

Testing

A software-in-the-Loop System and Hardware-in-the-Loop (HIL) satellite attitude control system simulator usually will be used for verification of control system software. Usually, the digital simulation results show that the nano/picosatellite attitude control scheme is implemented and the control precision is satisfied to meet the payload requirements. The feasibility and reliability of the nano/picosatellite attitude control scheme is also verified by digital or HIL simulation. According to future payload requirements, the real-time simulation for nano/picosatellite three-axis attitude stable control is very important and still under development. Air-bearing-based satellite simulators are widely used to verify the control techniques [Schwartz et al. 2003]. In the reference [Meissner 2009], a spherical air bearing system provides a torque-free environment for an 8 kg satellite with reaction wheel. The feedback and feedforward control algorithms have been tested in Naval Postgraduate School [Kim & Agrawal 2009]. A PID controller has been tested for a nanosatellite with a spherical air bearing system in Canada [Ustrzycki 2011]. In the reference [Ure et al. 2011], a reconfigurable fault-tolerant attitude control architecture and the associated Software and Hardware-in-the-Loop Test System for three-axis active control has been proposed at MIT. However, advanced control alogrithms have not been explored in detail.

1.3

Research Objectives and Contributions

To address the problems presented, this dissertation concentrates on the development of better performance fault tolerant control laws for satellite formation flying and attitude

22 control systems. From a practical viewpoint, the principal aim is to design automated nonlinear fault tolerant control systems that integrate the tasks of fault detection and isolation and control system reconfiguration for fault handling.

1.3.1
1.3.1.1

Objectives
Objectives for Satellite Formation Flying

1. [OBJECTIVE 1] To develop, evaluate and validate analytical and time varying formation flying dynamics models for multiple spacecraft operating in different orbits in LEO so that their relative motion can be calculated when they are subject to a range of external disturbances. 2. [OBJECTIVE 2] To develop robust, stable and practical control laws which will enable precise relative position maintenance of the satellite formation in the presence of disturbances. 3. [OBJECTIVE 3] To calculate the fuel required to maintain these orbits. 4. [OBJECTIVE 4] To extend the control laws for underactuated SFF to meet more detailed mission requirements, including maneuvering to perform specific imaging and spectroscopy tasks. 5. [OBJECTIVE 5] To apply novel fault detection, isolation and fault tolerant control algorithms for sensor and thruster fault problems during SFF. 1.3.1.2 Objectives for Satellite Attitude Control

1. [OBJECTIVE 6] To develop, evaluate and validate analytical and time varying satellite attitude dynamics models and tasks required during formation flying. 2. [OBJECTIVE 7] To develop robust, stable and practical control laws which will enable precise relative attitude maintenance within the satellite formation in the presence of disturbances.

23 3. [OBJECTIVE 8] To extend the control laws for decentralized SFF to meet more detailed mission requirements, including graph theory and consensus tracking. 4. [OBJECTIVE 9] To apply and test novel fault tolerant control algorithms for actuator fault problems.

1.3.2

Research Contributions

This research contributes to the field of fault tolerant control for satellite formation flying and AOCS systems. Novel fault tolerant control algorithms are developed with actuator, sensor, and plant fault tolerance and integrated with fault detection and isolation of actuator and sensor faults. The results presented in this thesis have been published or submitted for publication. Each subsequent chapter consists of an adapted version of one or more such publications. Specifically, the key contributions of the research are as follows: 1. Pico-satellites Formation Control using Novel Adaptive Fuzzy Terminal Sliding Mode Control ([OBJECTIVE 1], [OBJECTIVE 2],

[OBJECTIVE 4], Chapter 2) This dissertation begins by presenting a novel adaptive fuzzy terminal sliding mode control methodology for pico-satellites, where the satellites are under formation control subject to uncertain thruster/sensor faults and external J2 disturbances. The faults considered are modeled as loss of effectiveness, periodic additive faults and lock-in-place faults which happen at an unknown time. Formation keeping and maneuvering with full-actuated and under-actuated thrusters has been simulated with this novel control algorithm. Simulation results confirm that the suggested control methodologies yield high formation keeping precision and effectiveness for maneuvering of pico-satellites in formation flying. The numerical results demonstrate the effectiveness of the proposed adaptive fuzzy terminal sliding mode controller with a PD controller under thruster/sensor faults. The new design is applicable to a MIMO nonlinear system with thruster fault or failure.

24 2. Pico-satellites Formation Control using Novel Second Order Sliding Mode Control ([OBJECTIVE 2], [OBJECTIVE 3], Chapter 3) Chapter 3 focuses on an alternative control approach to the one described in Chapter 2. A new second order sliding mode (2nd-SM) control algorithm of MIMO nonlinear systems is proposed and applied for low thrust multiple pico-satellite formation flying. Using uncertainty and estimated online accidental or degradation faults in satellite thrusters, an effective variable structure technique is used to compensate for the effects of the faults. The local asymptotic stability of the chattering-free SM control is given by Lyapunov function. The proposed control law is also compared with ASMC, NTSMC, AFTSMC, SMC and PD controllers. The crucial contribution of this control law is the lower fuel consumption and high formation keeping precision under the thruster fault conditions compared with most of other control laws. 3. Pico-satellites Attitude Synchronization during Formation Flying Dynamics Development and Fault Tolerant Control ([OBJECTIVE 6], [OBJECTIVE 7], Chapter 4)) Pico-satellites attitude synchronization in the local vertical local horizontal (LVLH) frame using four reaction wheels is examined in Chapter 4. Existing literature proposes only satellite attitude fault tolerant control without actuator dynamics or satellite attitude synchronization during formation flying without fault tolerance. It is very important for precise satellite formation flying to keep each satellite in accurate relative attitude synchronization, and to maintain relative angular velocity synchronization. The adaptive fuzzy terminal sliding mode control is proposed for a formation flying tracking system which includes acquisition, tracking and pointing. The relative attitude of the leader and follower spacecraft under gravity gradient torque and external periodic disturbances is modelled and controlled by four reaction wheels. Simulation results (under actuator faults like wheel failure and wheel degradation) show that the proposed control method has the advantages of high tracking accuracy, low computation load, robustness, and ease of engineering application.

25 4. Decentralized Micro-satellites Attitude Synchronization Using AFTSMC and Graph Theory ([OBJECTIVE 8], Chapter 5) The performance of the proposed decentralized adaptive fuzzy terminal sliding mode control is examined in Chapter 5. This nonsingular fast terminal sliding mode control based on consensus theory is designed for distributed cooperative attitude synchronization. It solves synchronization issues with multiple satellites by using information topology. In order to achieve the capability of fault management without the involvement of ground station operators, the proposed control laws do not require an explicit fault detection and isolation mechanism. In the attitude control system of each satellite four reaction wheels are placed in a pyramid configuration. Numerical simulation results including actuator dynamics and initial conditions uncertainties show that the proposed strategy with FLS can compensate for the fault. The system continues to operate satisfactorily with wheel voltage or wheel speed faults and the closed loop distributed tracking control system is proven to be stochastically stable. Several simulations for multiple non-identical micro-satellites are presented and compared with the existing decentralized fault tolerant controllers to illustrate the effectiveness of the proposed fault tolerant control methodology. 5. Intelligent Fault Detection, Identification and Control of Pico-satellites Formation Flying ([OBJECTIVE 5], Chapter 6) A new integrated fault detection, identification and formation flying control is examined in Chapter 6. The proposed fault detection and identification methods and second order sliding mode control (from Chapter 3) is evaluated. The thruster and sensor faults considered are modeled as constant, time-varying and ramp faults which can occur randomly. Simulation results compare the existing sliding mode observer-based fault detection and isolation methods with the fuzzy logic system based fault detection and isolation method. It is also confirmed that the suggested control methodologies yield high formation keeping precision and effectiveness for leader-follower formation flying systems. These results demonstrate the effectiveness of the proposed active

26 fault tolerant control system under thruster and sensor faults. The new methodology is applicable to a wide range of thruster and sensor faults in uncertain systems. 6. Nanosatellite Fault Tolerant Attitude Control System on an Air Bearing System([OBJECTIVE 9], Chapter 7) The performance of the proposed attitude fault tolerant control strategies (AFTSMC, 2ndSMC, and 3rdSMC), in the presence of actuator faults is examined in Chapter 7. Simulation results confirm that a fault tolerant control methodology yields higher precision and consume less energy. The techniques are validated by experiment using an air bearing system.

1.4

Dissertation Overview

This section outlines the structure of this dissertation (shown in Fig. 1.4). Chapter 2 describes the AFTSMC fault tolerant control design of full-actuated and under-actuated satellite formation flying systems under the influence of thruster faults and other external perturbations. A novel second order control methodology for satellite formation flying is presented in Chapter 3. Chapter 4 details the results of satellite attitude fault tolerant control during leader-follower formation flying. This is followed by the results of decentralized satellite attitude control with thruster faults in Chapter 5. Satellite formation flying with large sensor and thruster faults, based on a fault tolerant control law and FDI developed using a second order sliding mode technique is presented in Chapter 6. Chapter 7 examines the satellite attitude system performance in the presence of faults using several fault tolerant control alogrithms. Experimental results are conducted on an air-bearing satellite simulator. Chapter 8 summarizes conclusions and contributions of this thesis, and suggests areas for future research.

27

Figure 1.4: Organization Chart of Dissertation

Chapter 2

Design of Adaptive Fuzzy Terminal Sliding Mode Control for Formation Flying

2.1

Introduction

Satellite formation flying (SFF) is defined as two or more satellites flying in a co-operative manner in prescribed reference orbits at fixed separation distance for a given period of time. Centralized formation is one of the classifications based on the control architecture, wherein there is a leader satellite and all other satellites follow the leader satellite. This configuration is also known as Leader-Follower formation. Depending on the purpose of the formation, different reference trajectories are designed to produce different formation geometries. In this chapter we derive the mathematical formulation of the SFF system, including the relations for the different reference trajectories, mathematical formulation of the perturbations affecting the SFF system and examine the effect of these perturbing forces on the SFF system. Fault tolerance of systems without FDI for nonlinear SFF is an important problem to be studied. In this chapter, the main contribution of the proposed adaptive fuzzy terminal sliding mode control method is to focus on a good tracking control methodology with no requirement for fault detection and diagnosis. The stability of the system during faults is guaranteed by the Lyapunov theorem. This chapter applies to nonlinear spacecraft formation flying, which has not been studied in detail in this context. To the best of our knowledge, no reference has applied an adaptive fuzzy terminal sliding

30 mode control (AFTSMC) for spacecraft formation flying with thruster or sensor faults. The chapter is organized as follows. Section 2.2 illustrates the problems of spacecraft formation flying. Section 2.3 formulates a fault tolerant AFTSMC control framework with a detailed proof of stability for spacecraft formation flying systems. Section 2.4 presents a detailed assessment of the system performance under the proposed control strategies, with the results of computer simulations incorporating different fault scenarios for formation flying systems. The conclusions of the present study are provided in Section 2.5.

2.2
2.2.1

Preliminaries
System Model and Equations of Motion

The investigation is initiated by formulating the complete nonlinear equations of motion of SFF systems to develop a mathematical model that facilitates the design of adaptive fuzzy sliding mode control methodologies. The proposed system is comprised of a leader spacecraft in an elliptical planar trajectory with the Earth's center at one of its foci and a follower spacecraft moving in a desired relative trajectory about the leader spacecraft (Fig. 2.1). The orbital motion of the leader spacecraft is defined by a radial distance rL from is attached to the center of the Earth and rL  R3 , rL = [ rL 0 0 ]T defines the position vector of the leader spacecraft with respect to the inertial coordinate frame. The motion of the follower spacecraft is described relative to the leader spacecraft using a relative frame S - xyz fixed at the center of the leader spacecraft with the x-axis pointing along the local vertical, the z -axis taken normal to the orbital plane, and the y -axis representing the third axis of the right-handed S - xyz frame.   R3 ,  = [ x y z ]T defines the relative position of the follower spacecraft from the origin of the leader spacecraft coordinate frame. The spacecraft is modeled as point masses and therefore the rotational dynamics of the leader and follower spacecraft is not taken into account. The orbital equations of motion for the leader spacecraft and the full nonlinear translational dynamics of the follower spacecraft


the center of the Earth and a true anomaly . The inertial coordinate system O - XY Z


31

Follower Satellite y Inertial Y Reference Frame Earth O X Z
Figure 2.1: Geometry of Orbits Motion of Leader and Follower Satellite relative to the leader satellite taking into account the thrust and disturbance forces can be written in the following form [Godard & Kumar 2010]: 2 + µ = 0 r ¨L - rL  2 rL ¨ + 2 r rL  L = 0 1 1 y 2 x + y ¨ + µ rL + x - 1 x ¨ - 2 -  Ux + Dx = 3 2 rF rL mF mF x ¨ -  2 y + µ y = 1 Uy + 1 Dy y ¨ + 2  + x 3 rF mF mF µ 1 1 z ¨+ 3 z = Uz + Dz rF mF mF (2.1) (2.2) (2.3) (2.4) (2.5)

 S

r


x Leader Satellite

rL

z Reference Line

where rF = [(rL + x)2 + y 2 + z 2 ], Dj is the net disturbance force on the follower, and uF j are the components of the follower control input vector. The disturbances in Eqs. (2.1)-(2.5) are time-varying disturbances attributed to a gravitational field, solar radiation pressure, and third body perturbations. These gravity perturbations can deviate an uncontrolled spacecraft from its nominal orbit. In LEO, Earth oblateness [Sabol et al. 2001] is by far the most dominant perturbation. It is assumed that the leader spacecraft remains in an unperturbed elliptical orbit subject to its own controller and therefore no control force is acting on the leader satellite.

32 In order to apply the adaptive fuzzy terminal sliding mode control law to SFF, we define X1 = [x, y, z ]T . Then we write the SFF dynamics model, Eqs. (2.1)-(2.5) as  1 = X2 , X  2 = f (X ) + g (X )u(t) + D (t), X     r L +x 1 2   ¨ 2 y  +  x - y - µ r3 - µ r2 u   Fx  F L    x ¨ + 2 y - µ 3 y , u(t) = uFy  where X = [X1 , X2 ]T , f (X ) =  -2 ,  - x rF     µ u Fz - rF 3z
1 I , mF 3×3

(2.6)

g (X ) =

and D (t) =

1 mF

[Dx

Dy

Dz ]T .

 d ) are taken as the In the present investigation, the desired or commanded states (Xd , X solution of the linearized form of the relative equations of motion, Eqs. (2.1)-(2.5). Two different types of desired trajectories are considered: 1. Circular Formation (CFO) : In this formation, the leader and the follower spacecraft maintain a constant separation from each other and the formation is mathematically
2 defined as x2 + y 2 + z 2 = rdc . The equations of the desired circular trajectory are

given as    m t +    sin   x    r   d  dc  m t +  =  2 cos  yd   2        z  m t +  3 sin  d     

(2.7)

2. Projected Circular Formation (PCO) : In this formation, the leader and the follower spacecraft maintain a fixed relative distance only on the y - z plane, and the formation

2 is mathematically defined as y 2 + z 2 = rdpc . The corresponding projected circular

formation trajectory equations are given as      x    d   r dpc = yd   2     z  
d



m t +  sin  m t +   m t +  

   2 cos  2 sin

    

(2.8)

33 where rdc and rdpc are the circular and projected circular formation sizes respectively,  is m is the mean angular the phase angle between the leader and the follower spacecraft, and  velocity and equal to µe /a3 (µe is the gravitational parameter of the Earth; a is the semi-

major axis of the orbit of the leader satellite). Finally, the control objective is to compute the thrust u required to drive the follower spacecraft to a desired formation trajectory (Eqs. (2.7-2.8)) with respect to the leader satellite in the presence of a J2 geopotential disturbance that can gradually disperse the formation if it is left uncontrolled.

2.2.2

Problem Formulation

Rewrite the MIMO formation flying system (2.6) as       X (t) O O  (t) =  2  +  3×3  u(t) +  3×3  X f (X ) g (X ) D (t) X (t) =  function. 0 < g 0 I3 < g < g 1 I3 . where g0 and g1 are positive constants. Define a linear switching function as  (t) = Me(t) + e  (t),  X1 (t) 

(2.9)

X2 (t) It is assumed that the system matrix g (X )  R3×3 is an unknown smooth and bounded

  R6 , X1 (t)  R3 , X2 (t)  R3 , D (t)  R3 , f (X )  R3 and u(t)  R6 .

(2.10)

which ensures that the reduced-order system on the sliding mode  = 0 is asymptotically stable, where M  R3×3 is a diagonal constant matrix with positive diagonal elements Mi (i = 1, 2, 3) and  (t)  R3 , and e(t)  R3 is the tracking error defined as e(t) = X1 (t) - xd (t). where xd (t)  R3 is the desired trajectory. x ¨d (t) is the second derivative of xd (t).

34 The system model given in Eq. (2.9) with thruster fault is represented as       X (t) O O  (t) =  2  +  n×n  (u + (t - tf )  u) +  3×3  X f (X ) g (X ) D (t)

(2.11)

where (t-tf ) represents the fault time profile and tf denotes the unknown fault-occurrence time. u represents the thruster fault and is bounded. |  u| < d1 (2.12)

where d1 is a positive constant. The system given in Eq. (2.9) with sensor fault is represented as  (t) =  X  X2 (t) ^) f (X  +  O n ×n ^) g (X  u +   O3×3 D (t)   (2.13)

^ =X +X X

^ is the sensor-measured spacecraft state and X represents the sensor fault and where X is bounded.

2.2.3

Basic Fuzzy Logic System

A fuzzy system is a collection of IF-THEN fuzzy rules as Rk : IF x1 is Ak 1, and, ··· , xn is Ak n, T HEN y is B k .

The output of the fuzzy system (using singleton fuzzification, product inference and center average defuzzification) can be written as yout =
P l l=1 F (X ) P l=1 N i=1 N i=1

µl Ail (xi )
i

µl Ail (x )

= T 

(2.14)

where P is the total fuzzy rules number; the membership functions µA1l (x1 ) , ..., µAnN (xn ) (N is the number of membership functions) as Gaussian functions,  is fuzzy basis function  l (x) =
N i=1 µAil (xi ) P N l=1 i=1 µAil (xi )

.

35 Remark. Fuzzy logic system cannot guarantee the closed loop system stability [Wong & Tam 1998]. The most famous time domain stability analysis method is Lyapunov method. One of the solutions is to use the combination of fuzzy logic system and sliding mode control methodology [Wong & Tam 1998]. The stability proof can be provided by Lyapunov method.

2.2.4

Adaptive Fuzzy Sliding Mode Control

A general sliding mode control law can be derived as u = g (X )-1 [¨ xd - M e  - f (X ) - D (t) -  sgn( )] (2.15)

System functions f , g , and disturbance D are usually difficult to obtain. The indirect adaptive fuzzy sliding mode control law ( [Wang et al. 2001]) is given as ^(X | f ) - h ^ ( | h ) ¨d - M e -f u=g ^(X | g )-1 x (2.16)

T h h ( ) to approximate f (X ), g (X ), and the switching-type control law  sgn( ).

T ^(X | f ) = T f (X ), g ^ ( | h ) = where we use fuzzy system f ^(X | g ) = g g (X ) and h f

Define the optimal parameters of fuzzy systems
 ^(X | f ) - f (X ) f = arg min sup f f w ¯F X Dx  ^(X | g ) - g (X )| g = arg min sup |g g w ¯G X Dx  ^ ( | h ) - h( ) h = arg min sup h h w ¯h Dx

(2.17) (2.18) (2.19)

It is assumed that there exists an optimal fuzzy logic system to learn the nonlinear terms f (X ), g (X ) and the switching-type control law  sgn(i ) in Eq. (2.16) such that
 f (X ) - f  (X | f ) = w F (X )  g (X ) - g  (X | g ) = w G (X )  h( ) - f  ( | h ) = w h ( )

(2.20)

36 where wF , wG and wh are approximation errors and bounded in the compact set Ux , i,e., wF  w ¯F , wG  w ¯G and wh  w ¯h . Approximation errors can be reduced by

increasing the number of fuzzy rules. Conversely, if the number of fuzzy rules is too large, a fuzzy logic system will induce an over-fitting problem.

2.3

Adaptive Fuzzy Terminal Sliding Mode Fault Tolerant Control Design

2.3.1

Fully Actuated Control and Stability Analysis

The AFTSMC overall design can be divided into two main steps. Step 1 involves the construction of a sliding surface containing tracking errors to ensure that once the system is restricted to the sliding surface the follower spacecraft can be expected to be in the desired trajectory. Step 2 entails the derivation of parameter adaptation laws and fuzzy logic feedback control gains that can drive the relative state trajectory to the sliding surface and maintain it in the manifold. Nonlinear hyper-plane based sliding modes offer a wide variety of design alternatives with fast and finite time convergence. Define a terminal sliding surface, and rewrite Eq. (2.10) as the following
p

 = Me + e  + C0 e q

(2.21)

where C0  R3×3 is a constant, diagonal, positive-definite, control design matrix. and p and q are the positive odd integers (p < 2q ). p p   = Me +e ¨ + C 0 e q -1 e  q Next, we derive the adaptive fuzzy terminal sliding control laws as ^(X | f ) - h ^ ( | h ) - K1  ¨d - E - f u=g ^(X | g )-1 x (2.23) (2.22)

37 p p  . This control term Eq. (2.23) is not well defined when the where E = M e  + C 0 e q -1 e q estimated matrix g ^(X | g ) is nonsingular. Since the matrix is generated online via the estimation of the parameters g , to implement this control law, additional precautions have to be taken to guarantee that g remains in the feasible region in which g ^(X | g ) is regular. In order to overcome this problem, we consider ^(X | f ) - h ^ ( | h ) - K1  ^T (X | g ) 0 I + g ^(X | g )^ g T (X | g )]-1 [¨ xd - E - f uf = g (2.24) where K1 = diag {k11 , k22 , k33 }, I = diag {1, 1, 1} and 0 is a small positive constant. Even though the control law Eq. (2.24) is always well defined, it cannot guarantee the stability of the closed loop system. This is due to the approximation of g -1(X | g ) by the regularized inverse and the unavoidable reconstruction errors of the unknown functions f (X ) and g (X ). Therefore, we append to the control law Eq. (2.24) a robustifying control term ur as follows u = uf - ur (2.25)

The controller Eq. (2.25) is the sum of two control terms: a modified certainty equivalent control term:   (w ¯F + w ¯ G uf + w ¯ h + u0 ) g0  2 +  and a robustifying control term: ur = ^(X | f ) - h ^ ( | h ) - K1  ] u0 = 0 [0 I + g ^(X |  )^ g T (X | g )]-1 [¨ xd - E - f (2.26)

(2.27)

where  is a design time varying parameter defined below. The adaptive parameters f , g , h and design parameter  are updated by the following adaptive laws: f = f ,    = -0 g = g uf ,   (w ¯F + w ¯ G uf g0  2 h = h ,  +w ¯ h + u0 ) + (2.28) (2.29)

where  > 0,  > 0,  > 0, 0 > 0, 0 > 0. Theorem 1: Consider the system Eq. (2.11). The adaptive fuzzy terminal sliding fault tolerant control laws defined by Eqs. (2.24-2.27), with adaptive control laws given by Eqs. (2.28) and (2.29) guarantees the following properties:

38 1. All signals due to thrusters/sensors fault in the closed-loop system are bounded. 2. The tracking error is UUB (Converges to a small neighborhood around zero by appropriately choosing the design parameters). ^ ) = u f (X ^ ) - u r (X ^ ) as the fault tolerant control Proof of Theorem 1: We denote u1 (X law considering the sensor fault and u2 (X ) = uf (X ) - ur (X ) as the fault tolerant control law without considering the fault. We use the mean value theorem to bound the nonlinear vector as follows: ^ - X  GM  X g ( u 1 - u 2 )  GM X Rewriting Eq. (2.22), we obtain the following equation ¨ -x   = X ¨d + E = -x ¨d + E + f (X ) + g (X )(u1 +   u) + D (t) = -x ¨d + E + f (X ) + g (X )(u1 - u2 ) + g (X )(u2 +   u) + D (t)  -x ¨d + E + f (X ) + GM X + g (X )(u2 +   u) + D (t) (2.31) Using the fact g ^(X | g )^ g T (X | g )[0 I + g ^(X | g )^ g T (X | g )]-1 = I - 0 [0 I + g ^(X | g )^ g T (X | g )]-1 (2.32) ^(X | f )) - h ^ ( | h ) - K1  - u0 g ^(X | g )uf = x ¨d - E - f ^ (t) < D ^ M and k = D ^ M + , Eq. (6.68) can be written as Denote D ^ (t)    -x ¨ d + E + f (X ) + (g (X ) - g ^(X | g ))uf + g ^(X | g )uf - g (X )ur + g (X )  u + D ^(X | f )) - h ^ ( | h ) - K1  - u0 + f (X ) + (g (X ) - g  -f ^(X | g ))uf - g (X )ur ^ (t) + g (X )  u + D ^(X | f ) + (g (X ) - g ^ ( | h )  -K1  + f (X ) - f ^(X | g ))uf - g (X )ur - h ^ (t) - u0 + g (X )  u +D
 ^(X |  ) - f ^(X | f ) + wF + (^  -K1  + f g (X | g )-g ^(X | g ) + wG )uf - g (X )ur f

(2.30)

(2.33)

^ ( | h ) + D ^ (t) - u0 + g (X )  u -h

(2.34)

39 Multiplying  T to Eq. (2.34) gives
 ^(X |  ) - f ^(X | f )) +  T wF +  T (^ T    - T K1  +  T (f g (X | g )-g ^(X | g ) + wG )uf f

^ ( |   ) -  T h ^ ( | h ) -  T h ^ ( |   ) -  T g (X )u r +  T h h h ^ (t) -  T u0 +  T g (X )  u + T D (2.35)

 Define fi , gij and hi represent the fuzzy parameter errors such that fi = f - fi , i   gij = g - gij , and hi = h - hi . ij i

Rewrite Eq. (2.35) as
  

    - K1  +


T

T

T f i f i ( )i
i=1

+ w+
i=1 j =1

T

T gij gij ( )i uf j

(2.36)

+
i=1

T ^ T^  T T T T hi hi (i )i +  D (t) -  h( | h ) -  u0 -  g (X )ur +  g (X )  u

where  T w =  T wf +  T wG uf +  T wh .  = 3 for SFF. We consider a Lyapunov function candidate defined as 1 T  + V = 2


i=1

1 T  f + i f i i





i=1 j =1

1 T  g + ij gij ij



i=1

1 T 1 hi hi + 2 i 0

(2.37)

Thus, the time derivative of V is obtained as


 = T  V +
i=1

1 T   f + i f i i





i=1 j =1

1 T   g + ij gij ij



i=1

1 T  1 hi hi +   i 0

(2.38)

^ ( |  ) = k sgn( ), substituting Eq. (2.36) into Eq. (2.38), we obtain Since h h


 V

 - K1  +
 

T

i=1

1 T  f ) + T w  (i fi ( )i +  i i f i

(2.39)

+
i=1 j =1 

1 T  g ) +  T (D ^ (t) - k sgn( ))  (ij gij ( )i uj +  ij ij gij

+
i=1

1 T  h ) -  T (uo) -  T g (X )ur + 1  hi (i i hi (i ) +   +  T g (X )  u i i 0

40 The time derivative of V can be written as  V 0 + V 1 + V 2 + V 3  V
2

(2.40)

 0 = - T K1  < -min (K1 )  V

(2.41)

 1 =  T (D ^ (t) - k sgn( )) +  T g (X )  u < -  +  g1 d1 V


(2.42)

2 = V
i=1

1 T f ) +  (i fi ( )i +  i i f i






i=1 j =1

1 T g )  (ij gij ( )i uj +  ij ij gij (2.43)

+
i=1

1 T h )  (i i hi (i ) +  i i hi  3 =  T w -  T uo -  T g (X )ur + 1  V  0

(2.44)

 f i = - f i ,   g = - g , and   hi = - hi . Using Eq. (2.28) and are constant numbers,  ij ij rewritten Eq. (2.43) can get 2 = 0 V Using Eq. (2.26), we can write ¯F + w ¯ G uf + w ¯ h + u0 ) -  T g (X )u r   (w We use the inequality  T g (X )  g 0 
2

f =   -  f ,  g =   -  g , and  h =   -  h . Since  ,  and  Rewritten  i i ij gij ij i i gij fi hi fi hi

(2.45)

  (w ¯F + w ¯ G uf + w ¯ h + u0 ) (2.46) 2 g0  + 

(2.47)

Substituting the adaptive law Eq. (2.29) into Eq. (2.44) 1  3   T g (X )u r +  T (w  =0 V ¯F + w ¯ G uf + w ¯h + u0 ) +  0 From the above Eqs. (2.12), (2.41) and (2.42), we obtain 0 + V  1 < -min (K1 )  V
2

(2.48)

+  (g1 d1 - )

(2.49)

41 Based on Eqs. (2.45), (2.48) and (2.49), Eq. (2.40) can be written as  < -min (K1 )  V < -min (K1 )
2

+  (g1 d1 - ) < -min (K1 )  g1 d1 2min (K1 )
2

2

+  g1 d1

(2.50)

 -

+
(g1 d1 )2 . 4min (K1 )

and min (K1 ) is the minimum eigenvalue of matrix K1 .  = outside the following compact set  :  = |0   g1 d1 min (K1 )

 is strictly negative V

(2.51)

We can conclude that  decreases whenever  is outside the compact set  and hence  is UUB. Since all signals involved in the proposed fault tolerant system are bounded in the closed-loop system, we can conclude that the control input is also bounded. Remark. In this chapter, 2q > p is used to avoid singularities [Stonier & Stonier 2004].

2.3.2

Under-actuated Control and Stability Analysis

Consider a SFF system whose dynamical equations can be expressed as Eq. 2.9. When u = [uf1 u f2 ··· ufn-1 ufn ], if ufi = 0, SFF system is an under-actuated system.

For under-actuated systems, SMC design starts with building an m sliding surface in the system state space. The motion of the system along the sliding mode is expected to meet the control requirements with desired robustness to bounded disturbances and parametric uncertainties. For the control problem, we utilize the vector containing the trajectory tracking errors, e(t) = x(t) - xd (t), to design a linear sliding surface S given by,  = C e (t) (2.52)

The sliding surface  is a (n - m) dimensional manifold,   R(n-m)×1 where C  Rm×n is

42 a constant gain matrix, and e(t)  Rm×1 is the trajectory error vector. e (t) = x - xd x  -x d  C C12 0  11   0 0 C21 C=  .. .  0 0  0 0 0
n -1 ··· x  n -1 - x d T

0 C22 .. . 0

0 0 0

0 0 0

       

(2.53)

Cmn1 Cmn2

Thus, we define the sliding vector as

 = [^ 1 ,  ^2 , · · · ,  ^i , · · · ,  ^m ]T

(2.54)

If the component i is not actuated, it needs to be redesigned in terms of the actuated components, along with any actuated components that are coupled to it, while the rest of the components can be left alone. In general, we can redefine the under-actuated components as a function of the components coupled to them. For example,  ^i = 1 1 + 2 2 + · · · + i i (2.55)

where all actuated sliding surfaces in Eq. (2.55) are coupled to the under-actuated sliding surface i . For example, the under-actuated sliding surface 1 will only be coupled to 2 . The redesigned two new sliding surfaces will be:  ^1 =  ^2 = 1 1 + 2 2 (2.56)

Since we assumed ufi = 0, in order to have good performance for an under-actuated system, it is quite important to redesign all of the sliding surfaces coupled to the underactuated sliding surface. Until now, there has been little research done on solving this problem. For example, in designing a suitable control algorithm for an under-actuated formation flying system, we derive a control law that can drive the follower spacecraft to a desired trajectory and maintain it there by only two of the thrusters. For a spacecraft position in coupled x and y, if any of the x or y thrusters are under-actuated, we have

43 to redesign a new sliding surface which couples the under-actuated sliding surface and actuated sliding surface. From the under-actuated system, the AFSMC control law will drive the plant trajectory to the nonlinear switching surface defined in Eq.(2.54) and maintain a sliding mode condition. According to the traditional SMC design method, since F (X ) and G(X ) are unknown, we can select the control law as ^ ( )-1 (X ¨d - E - F ^ ( ) - H ^ (i )) uF = G ^ ( ) and G ^ ( ) are estimation functions of F ( ) and G( ), respectively. where F For an under-actuated system, the unknown functions F (^  ), G(^ ) can be approximated by universal approximation theorem. We can rewrite them as the following:
T ^ (^ F  | F ) = F  (^  ), T ^ (^ G  | G ) = G  (^  ),

(2.57)

(2.58)

^ (^ ^ (^ The collection of IF-THEN rules for F  , t), G  , t) is the following: Rk : IF  ^1 is Ak 1, and, ··· , and,  ^m ··· ,  ^m ··· , is Ak m, T HEN (2.59)

^1 (^ F 1 | F1 ) is B1 k , Rk : IF  ^1 is Ak 1, and,

^n (^ F m | Fn ) is Bm k . is Ak m, T HEN (2.60)

··· , and,

^ 1 (^ G 1 | G1 ) is B1 k ,

^ n (^ G m | Gn ) is Bm k .

where we use m-1 actuated sliding modes and 1 under-actuated sliding mode input for the fuzzy logic systems. ^ (^ The collection of IF-THEN rules for H i , t) is the following: Rk : IF  ^i is Ak i T HEN ^ i (^ H i | Hi ) is Bik (2.61)

where we use m-1 actuated sliding modes and 1 under-actuated sliding mode input for this fuzzy logic system.

44 Consider an under-actuated system, the AFSMC control law u which is not coupled with an under-actuated thruster can use the fully actuated system's control law. However, for an under-actuated system, the AFSMC control law u which is coupled with the underactuated thruster has to be rewritten. In order to simplify the problem, let us assume uf1 = 0. Then 1 is the under-actuated sliding surface. Only 1 and 2 are coupled. Then we only need to redesign  ^1 =  ^2 =  ^h = 1 1 + 2 2 and use u  to control the coupled under-actuated and actuated sliding surfaces:

 ^h = 1 1 + 2 2

(2.62)

u =u F + u R

(2.63)

^ T (^ ^ (^ ^ T (^ u F = G  | G )[0 Ip + G  | G )G  | G )]-1 (uq )

(2.64)

uq =

1 ¨ ^1 (^ ^ 1 (^ ¨3 -E2 -F ^2 (^ ^ 2 (^ (X1 -E1 -F  | F1 ) -H h | H1 ))+(X  | F2 ) -H h | H2 )) (2.65) 2  ^ h | ^h |T (1 w ¯F + w ¯ G |u  F | + |u 0 |) 2 ) 2 (0  ^h + 

u R =

(2.66)

^ (^ ^ T (^ u 0 = 0 [0 Ip + G  | G )G  | G )]-1 (uq )

(2.67)

 F = 1  F  ^h   G =   G u  ^h  F  H = 1   H  ^h  where l (^  h ) =
N i=1 M i=1

(2.68)

µAil (^ h ) N h ) i=1 µAil (^

(2.69)

45

| ^h |T (1 w ¯F + w ¯G |u  F | + |u 0 |)    = -0 2  0  ^h +  where  > 0,  > 0,  , 0 > 0, and 0 > 0.

(2.70)

Theorem 2: For the under-actuated SFF, if the AFSMC control law which is coupled with an under-actuated thruster is defined as Eqs. (2.63-2.67), and the parameter adaptation laws are designed as Eqs. (2.68-2.70), then the system will reach the coupled sliding manifold given by Eq. (2.62). The AFSMC control law u which is not coupled with an under-actuated thruster will use the fully actuated system's control law in Eqs. (2.24-2.27) and Eqs. (2.28-2.29). Furthermore, the tracking errors will converge asymptotically to zero. Proof : Now consider the following Lyapunov function for an under-actuated system. si is a fully actuated sliding surface. According to Theorem 1, si will converge to zero in finite time. For the under-actuated and actuated coupled sliding surface s ^h , we use Eq. (2.62). ^  h = 1   1 + 1  2 The time derivative of the component i can be expressed as
n  ^ ^ ^  h = 1 (f i ( | fi ) - fi ( | fi ) + wfi +  (^ gij ( | g ) ij

(2.71)

(2.72)

j =1

^ i (i |  ) - h ^ i (i | h ) + Di (t) - h ^ i (i |  )) |i=1 -g ^ij ( | gij ) + wgij )0 + h hi i hi
n  ^ ^ + 2 (f i ( | fi ) - fi ( | fi ) + wfi + j =1  ^ i (i |  ) (^ gij (s | g )-g ^ij ( | gij ) + wgij ) u+h hi ij

^ i (i | h ) + Di (t) - h ^ i (i |  )) |i=2 -h i hi
n

=

1 ( T fi  fi ( ) +

+ w fi +
j =1

T  ^ ( T gij gij ( ) + wgij )0 + hi hi (i ) + Di (t) - hi (i | hi )) |i=1 n  ^ ( T u + T gij gij ( ) + wgij ) hi hi (i ) + Di (t) - hi (i | hi )) |i=2

2 ( T fi  fi ( )

+ w fi +
j =1

 where fi , gij and hi represent the fuzzy parameter errors such that fi = f - fi , i   - hi . gij = g - gij , and hi = h ij i

46 We can write Eq. (2.72), Eq. (2.63)- Eq. (2.67) into the following terms: T    ) + wf +  T   h ) + D1 (t) ^  h = 1 ( 1 f1 f1 (^ h1 h1 (^
n

(2.73) T    ) + wg ) ( u gij gij (^ ij

^ 1 (^  )) + 2 ( T    ) + wf + -h h |  h1 f2 f2 (^ 2 T   h ) + D2 (t) - h ^ 2 (^  )) + h |  h2 h2 (^ h2 Using  ^h gij (^  ) ur  | ^h | (1 w ¯ f + 2 w ¯gij |u  f | + |u  o |) - we have  ^h gij (^  ) ur  0  ^h Define Vi = 1 2 1 T  1 T   ^h +   f + f1  f1 + 2 1 2 f 2 2
n

j =1

  | ^h | (1 w ¯ f + 2 w ¯gij |u  f | + |u  o |) 0  ^h
2

+ 

(2.74)

2

(2.75)

j =1

1 T  1 T  1 T  1 2  gij gij +  h2 h2 +  h1 h1 + ij 1 2 0 (2.76)

Thus, the time derivative of Vi is given by 1 T  1 T   i =  ^   V ^h  h +  f + f1  f1 + 1 2 f 2 2 This yields i  V
n

j =1

1 T  1  1   T   + 1    gij g T    (2.77) ij h1 h1 + h2 h2 + ij 1 2 0
n 2 -ki  ^h

(2.78)

i=1

 i is negative semi-definite and Vi  L , which implies that the signals  Hence, V ^h (t), (t),  F ,  G ,  H are bounded. This implies the boundedness of h^ F ,  G ,  H , X , u  . Since Vi (t) is a non-increasing function of time and bounded from below, limt Vi (t) = V () exists.
0  m i=1 2 ki  ^h (t)dt  V (0) - V () < 

(2.79)

^ which implies that  ^h (t)  L2 . Since  ^h (t)  L2 L and  h  L , by using Barbalat's lemma, we conclude that  ^h (t)  0 as t  . Therefore, the tracking errors and their derivatives converge asymptotically to zero.

47

2.4
2.4.1

Results and Discussions
Fully Actuated SFF

In this section, we apply the proposed general fault tolerant control algorithm to SFF. To implement the adaptive fuzzy terminal sliding mode control law, we define the fuzzy sets over the interval of 1 , 2 , 3 . Five to eleven fuzzy rules can successfully deal with all different faults dealt with in this chapter. But more rules will need more computing time. The triangular membership functions cost higher control gain. Seven Gaussian membership functions (shown in Fig. 2.2) defined for each variable Ai (i = 1, 2, · · · , 7), are given as follows: µA1 (i ) = (1 + exp[5(i + 0.9 × a)])-1 , µA3 (i ) = exp - µA5 (i ) = exp - i + 0.3 × a b i - 0.3 × a b
2

µA2 (i ) = exp - µA4 (i ) = exp - µA6 (i ) = exp - i b

i + 0.6 × a b
2

2

,
2

,

i - 0.6 × a b

2

µA7 (i ) = (1 + exp[5(i - 0.9 × a)])-1
p p

(2.80)

where a and b are different constant numbers designed according to i (i = 1, 2, 3). We
q q +e  x , 2 = M2 ey + C02 ey +e  y and 3 = use three sliding surfaces 1 = M1 ex + C01 ex p q M3 ez + C03 ez +e  z instead of position states x, y , and z to design the membership functions.

We take the design parameters of the AFTSMC controller with fault accommodation as given in Table 2.1. Proportional and differential parameters can be achieved through the LQR method [Wang & Yang 2003] by using kpx,y,z = -0.0002, kdx,y,z = -0.02. To study the effectiveness and performance of the proposed controllers on the spacecraft formation, the detailed response is numerically simulated using the set of governing system equations of motion (Eqs. (2.1)-(2.5)) in conjunction with the proposed control laws (Eqs. (2.24-2.27)). The desired states of the system are given by Eq. (2.7) or (2.8) for circular formation and projected circular formation, respectively. The SFF system parameters and

48

Fuzzy Rule Set 1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0 -3 Rule 1 Rule 2 Rule 3 Rule 4 Rule 5 Rule 6 Rule 7

-2

-1

0

1

2

3

Figure 2.2: Gaussian Membership Functions

the orbital parameters for the leader spacecraft used in the numerical simulations are given in Table 2.2. The performance evaluation of the proposed controllers presented in this section is divided into three subcategories. First, we present the effectiveness of the controllers for formation keeping with fault and formation maneuvering using the proposed control strategies. Then, we present some quantitative analysis on fuel-consumption and steady-state stabilization errors for the proposed controller and for the PD controller. In this section, we demonstrate the performance of the proposed controllers when thruster/sensor faults occur in the system. The desired formation considered for ideal formation keeping is a projected circular formation The phase angle () between the leader and follower satellite is assumed to be zero. The initial states for the numerical simulation

49 are computed by substituting t = 0 in Eq. (2.8) and adding a 1 km position offset on x, y , and z . The initial velocity components for all states are calculated by taking the time derivative of Eq. (2.8) and substituting t = 0. We consider several fault scenarios in this study, as follows: 1. Thruster  periodic additive fault :  uF i t < tf uF i = u + K + K sin(K t) t  t Fi a b c f 0.6. 3. Sensor degradation : Xi = ^ lXi , where the degradation can be in the range 0 < ^ l  0.1. ¯ si (tf ), where X ¯ si (tf ) denotes the sensor output value at the time 4. Sensor jam : Xi = X instant tf of the failure. 5. Sensor periodic additive fault :  Xi t < tf Xi = X + K + K sin(K t) t  t i a b c f


2. Thruster degradation : Ui = ^ lUi , where the degradation can be in the range 0 < ^ l

The cost required for formation keeping and formation maneuvers is calculated as the result of the integral J=
0

mF [(

uF 2 uF 2 u Fx 2 ) + ( y ) + ( z ) ]d mF mF mF

(2.81)

where uFx , uFy and uFz are forces along x, y and z axes. mF denotes the mass of the follower satellite. 2.4.1.1 Formation Keeping

Thruster periodic additive faults are considered for spacecraft formation flying. The faults are injected after 2 orbits for the case where initial offset errors are 1km. Two scenarios are considered: Fault A: Ka = 9 × 10-5 , Kb = 0, and Kc = 0. Fault B: Ka = 0, Kb = Kc = 9 × 10-5 .

50 Table 2.1: Fully Actuated AFTSMC Controller Parameters for Numerical Analysis Name Sliding Surface 1 Sliding Surface 2 Sliding Surface 3 Robust Terms ^(X, t) Adaptive parameters of f Adaptive parameters of g ^(X, t) ^ (X, t) Adaptive parameters of h Design Parameters M1 M2 M3 g0 , 0 , 0 , K1 , (i = x, y, z ) ij , (i = x, y, z ) Values 0.001 0.001 0.001 0.001, 0.00001, 0.001, 0.1 0.0001 0.0001 0.001

The AFTSMC controller can stabilize the formation during thruster faults and converge the errors without largely affecting the geometry of the formation. The maximum thrust values are 5 mN per thruster. Fig. 2.3 shows the relative position errors and thrust demand for fault free case, fault case A and fault case B using the AFTSMC controller. The 3D trajectories of the follower spacecraft over 20 orbits for fault free, fault case A and fault case B are shown in Figs. 2.4 and 2.5. Fig. 2.7 shows the fuel consumption simulation results for fault free, fault case A and fault case B, respectively. The fuzzy logic system estimation of the system with fault and J2 disturbances for fault case A can be seen in Fig. 2.6. The reason the AFTSMC controller can stabilize formation keeping during the thruster fault is that the Fuzzy Logic System can estimate the system changes due to the fault during formation keeping. In Fig. 2.8, the trajectories of the following spacecraft over 20 orbits using the LQR based PD controller show that the PD controller can not stabilize the formation during this fault case A. It can be concluded that the AFTSMC controller works much better than the PD controller during thruster periodic additive fault. Thruster degradation is considered in formation keeping. In Fig. 2.9, the dashed lines and solid lines are the simulation results of AFTSMC using 5 mN and 3 mN thrusters, respectively. Under the initial error condition of 1 km, the steady-state errors on the

51 Table 2.2: Spacecraft Orbital Parameters and System Parameters Parameters mF (kg) µe (km3 s-2 ) rL (km) e  (deg) Values 1 398600 6878 0.02 0

, , i, M (deg) 0

radial, along track, and cross track directions are bounded by 0.5 m. Near perfect tracking is achieved in the radial, along track, and cross track directions. The proposed control scheme efficiently tracks the desired trajectories within 0.5 orbits. Fig. 2.10 shows the fuel consumption simulation results of AFTSMC using 5 mN and 3 mN thrusters, respectively. Thruster degradation causes greater fuel consumption. In order to stabilize the formation, the minimum thrust using the PD controller is 2.3 mN while at least 3 mN thruster force is needed with the AFTSMC controller.

52

x 10 1500 9 Fault Case A Fault Case B 500 0 -500 Fault Free Case 5

-3

x - x [m]

1000

U [N]
2 2.5 3

d

0 -5 -9 0 x 10
-3

0

0.5

1

1.5

x

0.5

1

1.5

2

2.5

3

1000

9 5

y - y [m]

500

U [N]
0 0.5 1 1.5 2 2.5 3

d

0 -5 -9 0 x 10
-3

0 -500

y

0.5

1

1.5

2

2.5

3

1000

9 5

z - z [m]

500

U [N]
0 0.5 1 1.5 2 2.5 3

d

0 -5 -9 0 0.5 1 1.5 2 2.5 3

0 -500

Orbits

z

Orbits

Figure 2.3: AFTSMC controller: Relative position errors and thrust demand of formation keeping, thruster fault case A, fault case B happened permanently after 2 orbits

53

2 2 1

z [km]

1

y [km]
2 0 0 1 -2 -1

0 -1 2

0

-1

y [km]

x [km]

-2 -0.5

0

0.5

1

1.5

x [km]
1.5 1 0.5 0 -0.5 -1 -2

1.5 1 0.5 0 -0.5 -1 -0.5

z [km]

0

0.5

1

1.5

z [km]

-1

0

1

2

x [km]

y [km]

Figure 2.4: AFTSMC controller: 3D trajectory of the follower spacecraft over 20 orbits of formation keeping, thruster fault A happened permanently after 2 orbits

54

2 2 1 1

z [km]

0 -1 -2 2 2 0 0 1 -2 -1

y [km]

0

-1

y [km]

x [km]

-2 -1

-0.5

0

0.5

1

1.5

x [km]
1.5 1 0.5

1.5 1 0.5

z [km]

0 -0.5 -1 -1.5 -1

z [km]
-0.5 0 0.5 1 1.5

0 -0.5 -1 -1.5 -2

-1

0

1

2

x [km]

y [km]

Figure 2.5: AFTSMC controller: 3D trajectory of the follower spacecraft over 20 orbits of formation keeping, thruster fault B happened permanently after 2 orbits

55

x 10 4

-6

x 10 10 FLC:F System:f 5

-6

f(x), Fx

2 0 -2

J2x
0 -5 0 x 10 2 0 -2 -4 -6 0 x 10 2 1
-6 -6

1

2

3

4

0 x 10
-6

1

2

3

4

2 0

f(y), Fy

J2x
-2 -4 1 2 3 4 0 x 10 5 0
-6

1

2

3

4

f(z), Fz

0 -1 -2 0 1 2 3 4

J2x
-5 -10 0

1

2

3

4

Orbits

Orbits

Figure 2.6: AFTSMC controller: Fault estimation and J2 disturbances of formation keeping, thruster fault A happened after 2 orbits

56

120

100

80

Fuel Cost [Nm/s]

60

Fault Case A Fault Case B Fault Free Case

40

20

0

0

1

2

3

4

5

6

7

8

9

10

Orbits

Figure 2.7: AFTSMC controller: Fuel consumption of formation keeping, thruster fault A happened permanently after 2 orbits

57

x 10 1 20 0.5

4

z [km]

10

y [km]
1
4

0 -10 1 x 10 0 -1 0 -1 -2
4

0

-0.5

x 10

y [km]

x [km]

-1 -15000

-10000

-5000

0

5000

x [km]
15

15

10

10

z [km]

5

z [km]
-10000 -5000 0 5000

5

0

0

-5 -15000

-5 -1

-0.5

0

0.5 x 10

1
4

x [km]

y [km]

Figure 2.8: PD controller: 3D trajectory of the follower spacecraft over 20 orbits of formation keeping, thruster fault A happened permanently after 2 orbits ( + denotes the leader spacecraft)

58

x 10 1500 9 AFTSMC with 3mN thruster 5 1000 500 0 -500 0 0.5 1 1.5 2 2.5 3

-3

x - xd [m]

Ux [N]

AFTSMC with 5mN thruster

0 -5 -9 0 x 10
-3

0.5

1

1.5

2

2.5

3

1000

9 5

y - yd [m]

500

Uy [N]
0 0.5 1 1.5 2 2.5 3

0 -5 -9 0 x 10
-3

0 -500

0.5

1

1.5

2

2.5

3

1000

9 5

z - zd [m]

500

Uz [N]
0 0.5 1 1.5 2 2.5 3

0 -5 -9 0 0.5 1 1.5 2 2.5 3

0 -500

Orbits

Orbits

Figure 2.9: AFTSMC controller: Relative position errors and thrust demand of formation keeping with AFTSMC controller using 3 mN and 5 mN thrusters, respectively

59

6

5 AFTSMC with 3mN thruster AFTSMC with 5mN thruster 4

Fuel Cost [Nm/s]

3

2

1

0

0

1

2

3

4

5

6

Orbits

Figure 2.10: AFTSMC controller: Fuel consumption for the fault case with AFTSMC controller using 3 mN and 5 mN thrusters, respectively

60

x 10 1500 9
Sensor Jam Sensor Degradation

-3

x - x [m]

1000 500 0 -500

5

U [N]
3

d

Sensor Periodic Additive Fault Fault Free

0 -5 -9 0 x 10
-3

0

0.5

1

1.5

2

2.5

x

0.5

1

1.5

2

2.5

3

1000

9 5

y - y [m]

500

U [N]
0 0.5 1 1.5 2 2.5 3

d

0 -5 -9 0 x 10
-3

0 -500

y

0.5

1

1.5

2

2.5

3

1000

9 5

z - z [m]

500

U [N]
0 0.5 1 1.5 2 2.5 3

d

0 -5 -9 0 0.5 1 1.5 2 2.5 3

0 -500

Orbits

z

Orbits

Figure 2.11: AFTSMC controller: Relative position errors and thrust demand of formation keeping under sensors jam, sensors degrade, sensors experience periodic additive fault permanently and fault free case

61

200

180

160

140

Sensor Jam Case Sensor Degradation Case Sensor Periodic Additive Fault Case Fault Free Case

Fuel Cost [Nm/s]

120

100

80

60

40

20

0

0

1

2

3

4

5

6

7

8

9

10

Orbits

Figure 2.12: AFTSMC controller: Fuel consumption of formation keeping under all sensors jam, sensors degrade, sensors experience periodic additive fault permanently and fault free case

62

x 10 1500 2 AFTSMC Controller 0

-3

x - x [m]

1000 500 0 -500

U [N]
3

d

PD Controller

-2 -4 -6

0

0.5

1

1.5

2

2.5

x 0 x 10
-3

0.5

1

1.5

2

2.5

3

1000

2 0

y - y [m]

500

U [N]
0 0.5 1 1.5 2 2.5 3

d

-2 -4 -6

0 -500

y 0 x 10
-3

0.5

1

1.5

2

2.5

3

1000

2 0

z - z [m]

500

U [N]
0 0.5 1 1.5 2 2.5 3

d

-2 -4 -6

0 -500

z 0

0.5

1

1.5

2

2.5

3

Orbits

Orbits

Figure 2.13: AFTSMC controller and PD controller: Relative position errors and thrust demand of formation keeping, sensors degrade 10% after 2 orbits

63

25

AFTSMC Controller 20 PD Controller

Fuel Cost [Nm/s]

15

10

5

0

0

1

2

3

4

5

6

7

8

9

10

Orbits

Figure 2.14: AFTSMC controller and PD controller: Fuel consumption of formation keeping, sensors degrade 10% after 2 orbits

64

x 10 1500 2 AFTSMC Controller 0

-3

x - x [m]

1000 500 0 -500

U [N]
3

d

PD Controller

-2 -4 -6

0

0.5

1

1.5

2

2.5

x 0 x 10
-3

0.5

1

1.5

2

2.5

3

1000

2 0

y - y [m]

500

U [N]
0 0.5 1 1.5 2 2.5 3

d

-2 -4 -6

0 -500

y 0 x 10
-3

0.5

1

1.5

2

2.5

3

1000

2 0

z - z [m]

500

U [N]
0 0.5 1 1.5 2 2.5 3

d

-2 -4 -6

0 -500

z 0

0.5

1

1.5

2

2.5

3

Orbits

Orbits

Figure 2.15: AFTSMC controller and PD controller: Relative position errors and thrust demand of formation keeping, all sensors experience periodic additive fault permanently after 2.0 orbits

65

3.5

3

AFTSMC Controller PD Controller

2.5

Fuel Cost [Nm/s]

2

1.5

1

0.5

0

0

1

2

3

4

5

6

7

8

9

10

Orbits

Figure 2.16: AFTSMC controller and PD controller: Fuel consumption of formation keeping, all sensors experience periodic additive fault permanently after 2.0 orbits

66

x 10 1500 9 AFTSMC with 4mN thruster 5

-3

x - xd [m]

1000 500 0 -500

Ux [N]
3

AFTSMC with 5mN thruster

0 -5 -9 0 x 10
-3

0

0.5

1

1.5

2

2.5

0.5

1

1.5

2

2.5

3

1000

9 5

y - yd [m]

0

Uy [N]
0 0.5 1 1.5 2 2.5 3

0 -5 -9 0 x 10
-3

-1000 -2000

0.5

1

1.5

2

2.5

3

1000

9 5

z - zd [m]

500

Uz [N]
0 0.5 1 1.5 2 2.5 3

0 -5 -9 0 0.5 1 1.5 2 2.5 3

0 -500

Orbits

Orbits

Figure 2.17: AFTSMC controller: Relative position errors and thrust demand of formation maneuvering

67

100

90

80

70

Fuel Cost [Nm/s]

60 AFTSMC with 4mN thruster for formation maneuvering AFTSMC with 5mN thruster for formation maneuvering 50

40

30

20

10

0

0

1

2

3

4

5

6

7

8

9

10

Orbits

Figure 2.18: AFTSMC controller: Fuel consumption of formation maneuvering

Next, the performance of the proposed controller is illustrated in Fig. 2.11 for a projected circular formation under e = 0.02. The thruster maximum force is 5 mN. We now assume all sensors experience jam faults between 2 - 2.1 orbits and a 10% degradation fault in all sensors. We also assume all six sensors experience periodic additive faults after 2 orbits. This fault case (named as fault case C) is defined with as follows: Ka = 0, Kb = Kc = 9 × 10-5 . Fig. 2.11 shows the relative position errors and control input required for formation keeping. The AFTSMC controller can keep tracking errors between the system output and the reference signal to UUB in the presence of sensor faults. Fig. 2.12 shows that the jam fault case uses more fuel than other two sensor fault cases. From Figs. 2.13, 2.14, 2.15, and 2.16, it is evident that the fuel consumption of AFTSMC controller is almost the same as that of the PD controller before the sensor fault happened. However, the fuel consumption is smaller than that of the PD controller after the fault. Based on

68 the comparison of fuel requirements, it is clearly evident that the proposed adaptive fuzzy terminal sliding mode control law is more efficient than the PD controller after sensor fault during SFF. Remark. In this research, the main objective of this fault tolerant controller is to reduce the effect of thruster/sensor faults. However, if sensor faults are too large, it is suggested to use the fault detection and isolation to replace the sensors. If thrusters are completely failed and the system is an under-actuated system, controller reconfiguration is required. In the real application case, this type of fault can be treated the same as real sensor faults (GPS measurement, accelerometer or star tracker fault) [Chen et al. 2006] and real thruster faults, depending on the application [Valdes & Khorasani 2010].

2.4.1.2

Formation maneuvers

In order to test the effectiveness of the proposed control strategies for multiple formation maneuvers, with the same initial condition errors of 1 km, we apply the motion of the follower spacecraft from a 1 km to a 2 km radius projected circular formation after 2 orbits. Then the follower spacecraft maneuvers to a circular formation after 6 orbits. In Figs. 2.17 and 2.18, the dashed lines and solid lines show the simulation results using 5 mN and 4 mN thrusters, respectively. It can also be observed that using 4 mN thrusters for twenty orbits still provides accurate formation maneuvering without using too much extra fuel. Thus 4 mN maneuvering thrusters can be used for SFF.

2.4.2

Under-actuated SFF

For fault tolerance in fully actuated and under-actuated SFF systems, we use 343 = (73 ) and 49 = (72 ) rules, respectively. We use the online fuzzy logic system to approximate the unknown fault dynamics model. We take the design parameters of the AFSMC control law with fault accommodation as follows in Table 2.3.

69 Table 2.3: Under-actuated AFSMC Controller Parameters for Numerical Analysis Name Sliding Surface Sliding Surface Sliding Surface Robust Terms Under-actuated SMC parameters F (X, t) Adaptive Gain G(X, t) Adaptive Gain H (X, t)Adaptive Gain Design Parameters C11 , C12 C21 , C22 C31 , C32 0 , 0 1 , 2 , (i = x, y, z ) ij , , (i = x, y, z ) Fully Actuated 0.001, 1 0.001, 1 0.001, 1 0.001, 0.000016 -- 0.0001-0.1 (all) 0.0001 0.001-0.03 (all) Under-actuated 0.0017 ,1 -0.001, 1 0.001, 1 0.001, 0.000016 3.1, 1 0.0001-0.1 (all) 0.0001 0.001-0.03 (all)

2.4.2.1

SFF without Failure

First, for circular orbit configuration of fully actuated SFF, we use the elements of the leader's orbit as follows [aL eL iL L L ML ]T = [6878, 0, 0, 0, 0, 0]T . Let the initial

formation be characterized by rd = 1 km and  = 0 deg. Figure 2.19 shows relative position errors and thrust demand for formation keeping when there is a 1km position offset on all three relative states.

70

x 10 2000 9 5 1000

-3

x - xd [m]

Ux [N]
0 0.5 1 1.5

0 -5 -9 0 x 10
-3

0 -1000

0.5

1

1.5

1000

9 5

y - yd [m]

500

Uy [N]
0 0.5 1 1.5

0 -5 -9 0 x 10
-3

0

0.5

1

1.5

1000

9 5

z - zd [m]

500

Uz [N]
0 0.5 1 1.5

0 -5 -9 0 0.5 1 1.5

0 -500

Orbits

Figure 2.19: Relative position errors and thrust demand for formation keeping for circular reference orbit fully actuated SFF system

71

x 10 2000 9 5 1000

-3

x - xd [m]

Ux [N]
0 2 4 6 8 10

0 -5 -9 0 x 10
-3

0 -1000

2

4

6

8

10

1000

9 5

y - yd [m]

0

Uy [N]
0 2 4 6 8 10

0 -5 -9 0 x 10
-3

-1000 -2000

2

4

6

8

10

1000

10 5

z - zd [m]

500 0 -500

Uz [N]
0 2 4 6 8 10

0 -5

0

2

4

6

8

10

Orbits

Figure 2.20: Relative position errors and thrust demand for circular reference orbit formation keeping when two thrusters jam during 4.5 - 5.5 orbits for under-actuated SFF system

72

2 2 1 1

z [km]

0 -1 -2 2 2 0 0 1 -2 -1

y [km]

0

-1

y [km]

x [km]

-2 -1

-0.5

0

0.5

1

1.5

x [km]
2

2

1

1

z [km]

0

z [km]
-0.5 0 0.5 1 1.5

0

-1

-1

-2 -1

-2 -2

-1

0

1

2

x [km]

y [km]

Figure 2.21: 3D trajectory for circular reference orbit formation keeping when two thrusters jam during 4.5 - 5.5 orbits for under-actuated SFF system

73

600

500

400

Fuel Cost [Nm/s]

300

200

100

0

0

1

2

3

4

5

6

7

8

9

10

Orbits

Figure 2.22: Fuel consumption for circular reference orbit formation keeping when two thrusters jam during 4.5 - 5.5 orbits for under-actuated SFF system

74

x 10 10 5

-4

x 10 5

-3

f(x), Fx

S1
0 -5 0 x 10 10
-4

0

2

4

6

8

10

-5

0 x 10
-3

2

4

6

8

10

5

f(y), Fy

5

S2
0 -5 0 x 10 2 1
-4

0

2

4

6

8

10

-5

0 x 10
-3

2

4

6

8

10

2 1

f(z), Fz

0 -1 -2 0 2 4 6 8 10

S3
0 -1 0

2

4

6

8

10

Orbits

Orbits

Figure 2.23: Sliding surfaces and Fuzzy parameter estimated for circular reference orbit formation keeping when two thrusters jam during 4.5 - 5.5 orbits for under-actuated SFF system

75

x 10 1500 9 5 1000 500 0 -500 0 1 2 3 4

-3

x - xd [m]

Ux [N]

0 -5 -9 0 x 10
-3

1

2

3

4

1000

9 5

y - yd [m]

0

Uy [N]
0 1 2 3 4

0 -5 -9 0 x 10
-3

-1000 -2000

1

2

3

4

1000

9 5

z - zd [m]

500

Uz [N]
0 1 2 3 4

0 -5 -9 0 1 2 3 4

0 -500

Orbits

Figure 2.24: Relative position errors and thrust demand for formation maneuvers for circular reference orbit under-actuated SFF system

2.4.2.2

SFF with Failure

Next, we applied the AFSMC control law for the under-actuated SFF system under the same initial conditions for formation keeping. The initial conditions for this case are given by Eq. (2.8). We demonstrate the effectiveness of the proposed control strategies for the different initial cases. The simulation results in the thrust jam fault case from 4.5 to 5.5 orbits with an under-actuated SFF system in a circular orbit are shown in Figs. 2.20, 2.21

76 and 2.22. The sliding surfaces, the fuzzy parameters estimated for the dynamics model of SFF spacecraft and fuel consumption under the external J2 disturbance with the nonlinear dynamics model for formation keeping with the thrust jam fault are shown in Fig. 2.23. We design the case such that the follower spacecraft moves from a 1 km to a 2 km radius projected circular formation after 2 orbits and then after 6 orbits, the follower spacecraft maneuvers to a circular formation. Figs. 2.24 and 2.25 show the relative position errors, thrust demand and 3D trajectory for multiple formation maneuvers for under-actuated SFF system. The performance of the proposed control algorithms in the sensors jam fault case is illustrated in Figs. 2.26 and 2.27 for the case of formation keeping at 1 km initial position offset and projected circular formation under e = 0. All two sensors encounter an abrupt blockage between 2.5 and 3.0 orbits.

77

3 5 2 1 0

z [km]

y [km]
2 0 0 -5 -2

0 -1

-5 5

-2 -3 -1.5

y [km]

x [km]

-1

-0.5

0

0.5

1

1.5

x [km]
4

4

2

2

z [km]

0

z [km]
-1 -0.5 0 0.5 1 1.5

0

-2

-2

-4 -1.5

-4 -3

-2

-1

0

1

2

3

x [km]

y [km]

Figure 2.25: 3D trajectory for formation maneuvers for circular reference orbit underactuated SFF system

78

x 10 2000 9 5 0

-3

x - xd [m]

Ux [N]
0 1 2 3 4

0 -5 -9 0 x 10
-3

-2000 -4000

1

2

3

4

5000

9 5

y - yd [m]

0

Uy [N]
0 1 2 3 4

0 -5 -9 0 x 10
-3

-5000

1

2

3

4

2000

9 5

z - zd [m]

0

Uz [N]
0 1 2 3 4

0 -5 -9 0 1 2 3 4

-2000 -4000

Orbits

Figure 2.26: Relative position errors and thrust demand for circular reference orbit formation keeping when two sensors jam during 2.5 - 3.0 orbits for under-actuated SFF system

79

6 2 4

z [km]

0

y [km]
2 0 -2 0 -5 -4

-2 -4 5

2

0

y [km]

x [km]

-2 -3

-2

-1

0

1

2

x [km]
2 1 0

2 1 0

z [km]

-1 -2 -3 -4 -3

z [km]
-2 -1 0 1 2

-1 -2 -3 -4 -2

0

2

4

6

x [km]

y [km]

Figure 2.27: 3D trajectory for circular reference orbit formation keeping when two sensors jam during 2.5 - 3.0 orbits for under-actuated SFF system

80

2.5

Conclusions

A novel adaptive fuzzy terminal sliding control scheme for formation flying systems is proposed in this chapter which accommodates thruster/sensor faults as well as J2 external disturbances for SFF. The system considered is MIMO and it has been proven in theory and demonstrated in simulation that the designed control scheme can guarantee that all signals in the closed-loop system remain bounded and tracking errors between the system output and the reference signal converge to UUB in the presence of subsystem faults, model uncertainties, and time varying disturbances. Finally, a numerical simulation example is given to demonstrate the validity of an adaptive fuzzy terminal sliding mode controller with comparison to a LQR based PD controller. It can be concluded that AFTSMC control is suitable for spacecraft formation keeping with thruster faults and sensor faults.

Chapter 3

Design of Asymptotic Second-order Sliding Mode Control for Formation Flying

3.1

Introduction

The SFF dynamics model and the effect of external disturbances were analyzed in Chapter 2. In this chapter, a methodology to achieve multiple satellite formation flying using a novel sliding mode control algorithm is proposed. The main contributions of this study relative to other works are as follows. 1. A new 2nd SMC control scheme is proposed and applied for the leader-follower approach for precise formation keeping and maneuvering in the presence of unknown time-varying satellite dynamics, J2 perturbations, actuator faults, and position offsets after an initial deployment that tends to disperse the formation. 2. The new robust 2nd SMC control algorithm for MIMO nonlinear systems proposed in this study is capable of stabilizing the relative states of the formation at a faster rate with superior finite error convergence, and no chattering. The higher order sliding mode establishment is guaranteed in finite time. The approach is constructive and needs no complex off-line computation. The fuel consumption of the proposed control methodologies for formation keeping is smaller than other controllers. The

82 fuel consumption of the proposed control methodologies is also smaller than other controllers after the fault occurs. The chapter is organized as follows: Section 3.2 introduces the nonlinear mathematical model of the SFF system and control laws and the design. For a detailed assessment of the system performance under the proposed control strategies, the results of numerical simulations incorporating different formation scenarios are presented in Section 3.3. The conclusions of the present study are summarized in Section 3.4.

3.2
3.2.1

Asymptotic 2nd SMC Architecture
Problem Formulation

In this study, the satellites are modeled as point masses and therefore the rotational dynamics of the leader and follower satellites are not taken into account. The orbital equations of motion for the leader satellite and the full nonlinear translational dynamics of the follower satellite relative to the leader satellite taking into account the thrust and disturbance forces can be written as Eq. (2.1)-(2.5) in state-space form as   X2 (t)  (t) =   + B (U + D ) X f (X )   where f (X ) =   [Ux Uy [x  y  
x y  2 x - y ¨ - µ rL + 2  + - µ r1 2 r3
F L

(3.1)

z  ]T  R3 . Here D = (d +  )  R3 denotes the differential J2 disturbance [Schaub dy dz ]T  R3 ) and thruster fault ( = [x


µ - rF 3z T 3 Uz ]  R , X (t) = [X1 (t) X2 (t)]T  R6 , X1 (t) = [x y

x ¨ + 2 y - -2  - x

µ y rF 3



   O3×3  , g = , B =   g

1 I, mF 3

U =

z ]T  R3 , X2 (t) = z ]T  R3 ). In low

et al. 2000] (d = [dx

y

earth orbit (LEO), J2 disturbance is by far the most dominant perturbation.  is the true anomaly. mF is the mass of the follower satellite. rL = [ rL 0 0 ]T defines the position vector of the leader satellite with respect to the inertial coordinate frame. The relative

83 position of the follower satellite from the origin of the leader satellite coordinate frame is defined by   R3 ,  = [x y z ]T . The follower satellite position with respect to the (rL + x)2 + y 2 + z 2 . The leader satellite is

inertial coordinate frame is given by rF =

assumed to be in an unperturbed reference orbit defined by Eqs. (2.1) and (2.2). A circular formation and a projected circular formation [Godard & Kumar 2010] are the desired trajectories. The control objective is to compute the thrust U required to drive the follower satellite to a desired formation trajectory with respect to the leader satellite in the presence of J2 disturbance force and thruster fault. Next, in order to design the proposed 2nd order sliding mode control law, a linear switching function is defined as  (t) = Ce(t) = M I3 e(t) = Me1 (t) + e2 (t) (3.2)

where  (t)  R3 . M  R3×3 is a diagonal constant matrix with positive diagonal elements i (i = 1, 2, 3). The elements of the matrix M are selected such that when the system is in a sliding mode, the eigenvalues of the closed-loop system are stable. e(t)  R6 is the tracking error defined as e(t) = X (t) - Xd (t) Xd (t) = [Xd1 Xd2 ]T  R6 is the desired trajectory. (3.3)

Here e(t) = [e1 (t) e2 (t)]T , e  1 (t) = e2 (t), e1 (t) = X1 (t) - Xd1 (t), and e2 (t) = X2 (t) - Xd2 (t). Taking the derivative of the system given by Eq. (3.1) yields ¨ (t) = A(X )X  (t) + B (U  (t) + D  (t)) X where A(X )  R6×6 is defined as  O3×3 A(X ) =  (3.4)

I3
f (X ) X2

f (X ) X1



=



O n ×n

In

a1 (X ) a2 (X )

 

Assumption 1 The disturbance and its derivative are bounded by |D (t)| < d1 ,  (t)| < d2 |D

84 where d1 and d2 are positive constants. Assumption 2 The unknown symmetric matrix g is bounded as 0 < g 1 I3 < g < g 2 I3 where g1 and g2 are positive constants. The desired trajectory Xd (t) is determined by  d (t) = Ad Xd (t) + Bd Ud (t) X Using Eqs. (3.3)-(3.5), the error dynamics of the SFF system is obtained as  (t) + D  (t)) + (A(X ) - Ad )X  d (t) - Bd U  d (t) e ¨(t) = A(X )e  (t) + B (U (3.6) (3.5)

 d (t) - Bd U  d (t) The desired trajectory is designed such that the term (A(X ) - Ad )X satisfies the matching condition, i.e.,  d (t) - Bd U  d (t) = B (aX  d (t) - bU  d (t)) (A(X ) - Ad )X (3.7)

where a and b are functions or constants. Substituting this matching condition into Eq. (3.6), the error dynamics can be expressed as  (t)) e ¨(t) = A(X )e  (t) + B (v  (t) + D where v (t) denotes an alternative control input defined as  (t) + aX  d (t) - bU  d (t) v  (t) = U If a and b are constants, the following holds. v (t) = U (t) + aXd (t) - bUd (t) Next, an extended state vector z (t) is defined as   e(t)   R6 z (t) =  e  2 (t) (3.10) (3.9) (3.8)

(3.11)

85 Substituting e(t) by z (t) into Eq. (3.6), the extended system is obtained as ¯(X )z (t) + B ¯ (v  (t)) z  (t) = A  (t) + D where  O3×3 I3 O3×3 O3×3 I3      (3.12)

Referring to Eq. (3.2), the switching function can be expressed in terms of z (t) as follows.  (t) = M I3 O3×3 z (t). (3.15)

  ¯ A(X ) =  O3×3  O3×3  O  3×3  ¯ =  O B  3×3 g

(3.13)

a1 (X ) a2 (X )     

(3.14)

Taking the first and second derivatives of the switching function given by Eq. (3.2) and using Eq. (3.15) yield   (t) = C e  (t) = M e  1 (t) + e  2 (t) = O3×3 M I3 z (t) (3.16) (3.17)

 (t)) = CA(X )e  (t))  ¨ (t) = CA(X )e  (t) + CB (v  (t) + D  (t) + g (v  (t) + D Next, a new state vector is defined as  (t)   w (t) =    (t)  e1 (t)      

(3.18)

The transformation matrix T to transfer z (t) to w (t) with w (t) = T z (t) is given by   M I3 O3×3     9×9 (3.19) T =  O3×3 M I3   R   I3 O3×3 O3×3

86 Substituting z (t) by w (t) into Eq. (3.12), the dynamical equation for the state vector w (t) is obtained as ~(X )w (t) + B ~ (v  (t)) w  (t) = A  (t) + D where O I3 O3×3   3×3   -1 ~ ¯ A(X ) = T A(X )T =  (X )  (X )  (X )    I3 O3×3 -M    O O3×3 I3 O  3×3  3×3     ~ = TB ¯ =  g  , T -1 =  I B O3×3 -M   3  -M I3 M2 O3×3 (X ) = a1 (X ) - M 2 - a2 (X )M  (X ) = M + a2 (X )  (X ) = -a1 (X )M + [M + a2 (X )]M 2 Using Eqs. (3.2) and (3.20) yields  (t))  ¨ =  (X )  (t) +  (X ) (t) +  (X )e1 (t) + g (v  (t) + D e  1 (t) = -Me1 (t) +  (t) (3.26) (3.27)   (3.20)

(3.21)

    

(3.22)

(3.23) (3.24) (3.25)

It is to be noted that Eq. (3.27) gives the reduced-order system on the sliding mode  (t) = 0, which is designed to be stable with positive diagonal elements of M . Eq. (3.26) will be used to show convergence to the sliding mode.

3.2.2

Design of Chattering-free SMC and Stability Analysis

The proposed second order sliding mode control (2nd SMC) is designed as
t

v (t) = -k1  (t) - k2

sgn( (t))dt
0

(3.28)

87 A chattering-free sliding mode control law (Chattering Free SMC) with the hyperbolic function is given by v (t) = -k1 tanh( ) A sliding mode control law (SMC) can be described as v (t) = -k1 sgn( ) (3.30) (3.29)

Taking the derivative of the proposed control law, Eq. (3.28) and substituting v  (t) into Eq. (3.26) yields  (t)  ¨ = -(k1 g - (X ))  (t) +  (X ) (t) +  (X )e1 (t) - gk2sgn( (t)) + g D (3.31)

where k1 and k2 are 3 × 3 diagonal matrices with positive constant diagonal elements. Remark : The proposed control law given by (3.28) is a higher order sliding mode controller and is chattering free. It does not require   (t) which is usually required in any higher order sliding mode controllers. In addition, the ordinary chattering free control laws use saturation or hyperbolic functions whereas the proposed control law does not require these functions. Finally, stability inside the boundary layer is guaranteed by the proposed control law as shown by Lemma 1 , Lemma 2 , and Theorem 1 , whereas the "chatteringfree" sliding mode control laws can not guarantee stability inside the boundary layer. Lemma 1 Consider the system (3.1) represented by two subsystems (3.26) and (3.27). With the switching function  (t) defined by (3.2), the reduced-order system on the 2nd SM  (t) =   (t) = 0 is asymptotically stable. Proof: On the 2nd SM,  (t) =   (t) = 0 holds. Thus, according to the system

 (t) = 0 is Eq. (3.27), the stability of the reduced-order system on the 2nd SM  (t) =  determined by e  1 (t) = -Me1 (t) where M is a diagonal constant matrix used in Eq. (3.2) to define the switching function  (t) with positive diagonal elements i (i = 1, 2, 3). Therefore the reduced-order system on the 2nd SM  (t) =   (t) = 0 is asymptotically stable.

88 Lemma 2 Consider the system (3.1) represented by two subsystems (3.26) and (3.27). With the switching function  (t) defined by Eq. (3.2) and the proposed control law (3.28), e1 (t) converges to a vicinity of zero, determined by ||M -1 || × | (t)|. Proof: Define a Lyapunov function candidate as 1 (t)M -1 e1 (t) Ve (t) = eT 2 1 Then its derivative is given as  e (t) = eT (t)M -1 (-Me1 (t) +  (t)) = -eT (t)e1 (t) + eT (t)M -1  (t) V 1 1 1  -||e1 (t)||2 + ||e1 (t)|| × ||M -1 || × | (t)| = -||e1 (t)||(||e1(t)|| - ||M -1 || × | (t)|) which means that e1 (t) converges until e1 (t) enters a vicinity of zero determined by ||e1 (t)||  ||M -1 || × | (t)| (3.32)

Denote the diagonal matrix gk2 by G and Gi (i = 1, 2, 3) are the diagonal elements of G. Then the dynamics to describe the convergence to the sliding mode is given by  (t)  ¨ = -(X )  (t) +  (X ) (t) +  (X )e1 (t) - Gsgn( (t)) + g D where (X ) is defined as (X ) = k 1 g -  (X ) Choose a Lyapunov function candidate as   1 T  I3  1 I3  V (t) =  (t) (t) + 2  1 I3  2 I3 = (3.33)

3

i=1

Gi |i (t)|
3

1 1 T   (t)  (t) + 2  T (t) (t) + 1  T (t)  (t) + 2 2

i=1

Gi |i (t)|

(3.34)

89 which is continuously differentiable when  (t) = 0. Two positive constants 1 and 2 are chosen to satisfy 2 - 2 1 > 0. Therefore, the Lyapunov function candidate V (t) is positive definite. (t) is defined as (t) =    (t)   (t)   (3.35)

  (t): Using Eq. (3.34), the derivative of V (t) for  (t) = 0 along the Derivation of V trajectory given by Eq. (3.33) is derived as   (t) =  V  T (t)¨  (t) + 2  T (t)  (t) + 1   T (t)  (t) + 1  T (t)¨  (t) +   T (t)Gsgn( ) (3.36)

 (t)) + 2  T (t) =   T (t)(-(X )  (t) +  (X ) (t) +  (X )e1 (t) - Gsgn (t)) + g D  (t) +  (t)) 1   T (t)  (t) + 1  T (t)(-(X )  (t) +  (X ) (t) +  (X )e1 (t) - Gsgn (t)) + g D +  T (t)Gsgn( ) 1  (t)) - 1  T (t)Gsgn (t) = - T (t)Q1 (X )(t) + (  T (t) + 1  (t))( (X )e1 (t) + g D 2 where Q1 (X ) is defined as  2((X ) - 1 I3 ) - (X ) - 2 I3 + 1 T (X ) 2(3I3 - 1  (X ))  

Q1 (X ) = 

- (X ) - 2 I3 + 1 (X )

T

It is assumed that the parameters of the controller, k1 and k2 and the positive constants i (i = 1, 2, 3, 4, 5) are chosen appropriately such that the following conditions hold for all X  R6 and for all (t) in a vicinity |(t)| < vs (t  0, vs > 0): 2 > 2 1  ( X ) >  1 I3  3 I3 >  1  ( X ) Q1 (X ) > 24 I6  (t) G >  (X )e1 (t) + g D Q2 (X ) > 25 I2 (3.37) (3.38) (3.39) (3.40) (3.41) (3.42)

90 where Q2 (X ) is defined as  2 4 -|| (X )|| × ||M -1 || -|| (X )|| × ||M 2 4
-1

Q2 (X ) = 

||

 

Using Eq. (3.37) and Eqs. (3.37)-(3.42) yields   (t) < -4 |(t)|2 +   (t)) + 1  T (t)( (X )e1 (t) + g D  (t) - Gsgn (t)) V  T (t)( (X )e1 (t) + g D < -4 |(t)|2 + |  (t)|(|| (X )|| × |e1 (t)| + g2 d2 ) < -4 |(t)|2 + |  (t)|(|| (X )|| × ||M -1 || × | (t)| + g2 d2 )   | (t)| 1  + | = -  (t)|g2 d2 | (t)| |  (t)| Q2 (X )  2 |  (t)|

< -5 |(t)|2 + |(t)|g2 d2 = -|(t)|(5 |(t)| - g2 d2 )

(3.43)

which means that V (t) keeps decreasing until (t) converges to a vicinity determined by |(t)| < g2 d2 5 (3.44)

Theorem 1 With the proposed control law (3.28), the system enters a vicinity of the 2nd SM  (t) =   (t) = 0 and then to a vicinity of the origin, locally and asymptotically. Proof: The convergence to the vicinity of the 2nd SM  (t) =   (t) = 0 has been

proved by Lemma 1. Similarly, with a Lyapunov function candidate as V = V (t) + Ve (t) = 1 T 1   (t)  (t) + 2  T (t) (t) + 1  T (t)  (t) + 2 2
3

i=1

1 Gi |i (t)| + eT (t)M -1 e1 (t) 2 1

it can be proved that  (t),   (t), and e1 (t) converge to the vicinity of the origin, locally and asymptotically, which indicates the local and asymptotic stability of the proposed control law (3.28).

91

3.3

Application to Satellite Formation Flying

With a view to assess the effectiveness of the proposed controller, the detailed response is numerically simulated using the SFF system (3.1) in conjunction with the proposed control law (3.28). The SFF system parameters and the orbital parameters for the leader satellite used in the numerical simulations are shown in Table 3.1. Table 3.1: Satellite Orbital Parameters and System Parameters Parameters mF (kg) µe (km3 s-2 ) rL (km) e , , i, M (rad) Values 1 398600 6878 0, 0.7 0

A Chattering Free SMC (3.29), SMC (3.30) and a chattering free adaptive fuzzy terminal sliding controller (AFTSMC) (3.45) are used for comparison with the proposed 2nd SMC. The AFTSMC is chosen as [Li & Kumar 2011]: ^(X | f ) - h ^ ( | h ) - K1  ¨d - E - f U =g ^(X | g )-1 X (3.45)

T ^(X | f ) = T f (X ), g ^ ( | h ) = T h ( ), and E = M e where f ^(X | g ) = g g (X ) and h + f h
q q C0 p e q -1 e  . The terminal sliding surfaces are: s1 = M1 ex + C01 ex +e  x , s2 = M2 ey + C02 ey +e y q p q and s3 = M3 ez + C03 ez +e z . p p p

In the numerical simulations for formation keeping, the formation radius and the initial position offsets are considered to be 1 km. The initial velocity components for all states are calculated by taking the time derivative of the desired projected circular formation trajectory and substituting t = 0. The phase angle between the leader and follower is assumed to be zero. The maximum thrust is taken as 3 mN. The design parameters of

92 the 2nd SMC are considered as: 1 = 2 = 3 = 2 (switching function parameters), k1 = 1 × 10-3 (controller parameter) and k2 = 1 × 10-9 (controller parameter).

3.3.1

Formation Keeping

The performance of the proposed controller is demonstrated for formation keeping when the leader satellite is in a circular orbit. Fig. 3.1 shows the relative position errors, thrust demand and fuel consumption using 2nd SMC, AFTSMC, Chattering Free SMC and SMC. All controllers exhibit the similar tracking performance. With respect to the fuel consumption, the proposed controller is the most economical followed by Chattering Free SMC, AFTSMC and SMC.

3.3.2

Formation Maneuvers

The effectiveness of the proposed controller is tested for the case of multiple formation maneuvers when the leader satellite is in a circular orbit. The follower satellite is maneuvered from a 1 km to a 2 km radius projected circular formation after 1 orbit and then after 2 orbits to a 4 km radius circular formation (Fig. 3.2). It is found that 2nd SMC, Chattering Free SMC, and SMC using 3 mN thrusters all provide the similar maneuver performance. However, AFTSMC handles only the first maneuver (the plots of tracking performance and thruster command for AFTSMC are omitted). It is to be noted that AFTSMC applies the fuzzy logic system that is used to estimate the system uncertainty and therefore it needs a larger gain. Furthermore, AFTSMC can not maneuver the follower satellite from a 2 km radius projected circular formation to a 4 km radius circular formation with 3 mN saturation. SMC works for two formation maneuvers, but it uses a large amount of fuel. Fig. 3.2 shows that the tracking performance of the proposed controller is better than the chattering free SMC controller, but it uses a little more fuel. Overall considering both the tracking performance and fuel consumption, the proposed 2nd SMC is still the best controller for reliable formation maneuvers using 3 mN thruster saturation.

93

3.3.3

Formation Keeping under Faults

A thruster periodic additive fault scenario is considered. Thruster periodic additive fault is defined by j as j =   0 t < tf j = x, y, z (3.46)

where tf is an unknown time. To test the thruster periodic additive faults, the faults are injected after 1 orbit with an initial offset error of 1 km. The scenario is considered as aj , bj = 10-5 and cj = 9 × 10-5 , j = x, y, z , with the maximum thrust of 3 mN. In order to compare the controllers without bias, all controller parameters are considered to be the same as selected for the fault free case of formation keeping. Fig. 3.3 shows the relative position errors and thrust demand using 2nd SMC, AFTSMC, Chattering Free SMC, and SMC. The values of thruster faults are 20% of the minimum thrust value required to stabilize the formation. It is found that that 2nd SMC stabilizes the formation with the errors being bounded within 2 m with minimal formation geometry changes. The tracking errors using AFTSMC, Chattering Free SMC and SMC are 4 m, 10 m and 1 m, respectively. Fig. 3.3 also shows the fuel consumption over 3 orbits. The 2nd SMC effectively stabilizes the formation during faults using less fuel. In other words, the 2nd SMC is the most suitable controller for handling thruster faults. Finally, the performance of the proposed controller is demonstrated for formation keeping when the leader is in a high eccentricity orbit (e=0.7). AFTSMC, Chattering Free SMC, and SMC all result in the same tracking performance with the similar trend in fuel consumption as found for the case of a leader satellite in a circular orbit. Adaptive sliding mode control (ASMC) and nonsingular terminal sliding mode control (NTSMC) [Godard & Kumar 2010] are also compared with the proposed 2nd SMC. The proposed 2nd SMC parameters are chosen as k1 = 6 × 10-2 and k2 = 10-9 . With 3 mN thruster, ASMC or NTSMC can not stabilize the formation. However, with 10 mN thruster as shown in Figs. 3.4 and 3.5, the formation is stabilized but the tracking performance is not as good as exhibited by the proposed 2nd SMC and the formation consumes higher fuel. There is

a + b sin(c t) t  t j j j f

94 also an obvious chattering phenomenon when using NTSMC. Thus, the proposed controller can stabilize the formation with less thrust and fuel as well as no chattering in the control demand.

95

2000
x - xd [m]

9 5

x 10

-3

1000
Ux [N]

0 -5

0 -1000 0

0.2

0.4

0.6

0.8

1

-9 0 x 10
-3

0.2

0.4

0.6

0.8

1

1000
y - yd [m]

9 5

500
Uy [N]

0 -5

0 -500 0

0.2

0.4

0.6

0.8

1

-9 0 x 10
-3

0.2

0.4

0.6

0.8

1

2000
z - zd [m]

9 5

1000
Uz [N]

0 -5

0 -1000 0

0.2

0.4
Orbit

0.6

0.8

1

-9 0

0.2

0.4
Orbit

0.6

0.8

1

300 2nd SMC AFTSMC SMC Chattering Free SMC

20

250
15

Fuel Cost [Nm/s]

200

10

5

150

0 0

0.2

0.4

0.6

0.8

1

100

50

0 0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

Orbit

Figure 3.1: Relative position error, thrust demand and fuel consumption for formation keeping e=0 (2nd SMC-dash-dot lines; AFTSMC-dash lines; Chattering Free SMC-dot lines; SMC-solid lines)

96

1500
x - xd [m]

50

9 5
Ux [N]
3 3.5 4

x 10

-3

1000 500 0 -500 0 1000 1 2

0

-50

0 -5

3

4

-9 0 x 10
-3

1

2

3

4

9 5
Uy [N]
3 3.5 4 50 0 -50

y - yd [m]

0 -1000 -2000 -3000 0 1 2

0 -5

3

4

-9 0 x 10
-3

1

2

3

4

1000
z - zd [m]

9 5
Uz [N]
3 3.5 4 50 0 -50

500 0 -500 -1000 0 1 2
Orbits

0 -5

3

4

-9 0

1

2
Orbits

3

4

6000 70 5000 60 50 4000 40 30 20 3000 10 0 0 0.5 1 1.5 2 2.5 2nd SMC AFTSMC SMC Chattering Free SMC

Fuel Cost [Nm/s]

2000

1000

0 0

0.5

1

1.5

2

2.5

3

3.5

4

Orbits

Figure 3.2: Relative position error, thrust demand and fuel consumption for formation maneuvering (2nd SMC-dash-dot lines; AFTSMC-dashed lines; Chattering SMC free-dot lines; SMC-solid lines)

97

1500
20

9
10 0

x 10

-3

x - x [m]

1000 500 0 -500 0 1000 0.5 1

5 U [N] 0 -5

d

-10 -20 2.6 2.8 3

x

1.5

2

2.5

3

-9 0
x 10

0.5
-3

1

1.5

2

2.5

3

9
20 10

y - y [m]

5

500 0 -500 0

0 -10 -20 2.6 2.8 3

U [N] 3

d

0 -5 -9 0 0.5
-3

0.5

1

1.5

2

2.5

y

1

1.5

2

2.5

3

1500
20

9
10

x 10

z - z [m]

1000 500 0 -500 0 0.5 1

5

U [N] 3

0 -10 -20 2.6 2.8 3

d

0 -5 -9 0 0.5 1 1.5 2 2.5 3

1.5 Orbits

2

2.5

z

Orbits

3000

2500

30

2nd SMC AFTSMC SMC Chattering Free SMC

20

Fuel Cost [Nm/s]

2000 10 1500 0 0 1000 1 2 3

500

0 0

0.5

1

1.5

2

2.5

3

Orbits

Figure 3.3: Relative position error, thrust demand and fuel consumption for formation keeping, thruster fault after 1 orbit e=0 (2nd SMC-dash-dot lines; AFTSMC-dashed lines; Chattering Free SMC-dot lines; SMC-solid lines)

98

1000

0.01 0.005

x - xd [m]

500 0 -500 -1000

Ux [N]
0 0.5 1 1.5 2

0 -0.005 -0.01

0

0.5

1

1.5

2

1000

0.01 0.005

y - yd [m]

500 0 -500 -1000

Uy [N]
0 0.5 1 1.5 2

0 -0.005 -0.01

0

0.5

1

1.5

2

1000

0.01 ASMC NTSMC 0.005

z - zd [m]

500 0 -500 -1000

Uz [N]
0 0.5 1 1.5 2

0 -0.005 -0.01

0

0.5

1

1.5

2

Orbits

Orbits

Figure 3.4: Relative position error, thrust demand for formation keeping e=0.7 (ASMCsolid lines; NTSMC-dash lines)

99

0.01 1000 2nd SMC 0.005

x - xd [m]

Ux [N]
0 0.5 1 1.5 2

0 -1000 -2000

0 -0.005 -0.01

0

0.5

1

1.5

2

1000

0.01 0.005

y - yd [m]

500

Uy [N]
0 0.5 1 1.5 2

0 -0.005 -0.01

0 -500

0

0.5

1

1.5

2

1000

0.01 0.005

z - zd [m]

500 0 -500 -1000

Uz [N]
0 0.5 1 1.5 2

0 -0.005 -0.01

0

0.5

1

1.5

2

Orbits

Orbits

Figure 3.5: Relative position error, thrust demand for formation keeping e=0.7 (2nd SMCsolid lines)

100

3.4

Conclusions

In this chapter, a new nonlinear controller for spacecraft formation flying was proposed. This controller was based on 2nd order sliding mode. The proposed controller can provide desired performance in the presence of nonlinear system dynamics, J2 perturbations, thruster faults and position offsets, and is constructive. It needs no complex off-line computation, and offers lower fuel consumption after faults than the other controllers presented in this chapter. Local asymptotic stability of the proposed controller was proven by using Lyapunov function. Numerical simulation results confirmed that this controller provides low fuel consumption and precise and effective tracking performance for formation keeping and formation maneuvers in the presence of 1 km initial errors, 3 mN thruster saturation and thruster periodic faults.

Chapter 4

Attitude Synchronization Control of Formation Flying

4.1

Introduction

In Chapter 2 and Chapter 3, the feasibility of performing satellite formation flying based on AFTSMC and 2nd SMC was studied and evaluated. The satellite attitude dynamics was not considered and attitude was assumed stabilized in Chapter 2 and Chapter 3. The attitude control system provides the satellite with the maneuvering, tracking and pointing capability. For many Earth orbiting satellites three axis attitude stabilization is essential to meet the nadir pointing requirement of the mission. This chapter looks to expand upon the previous efforts on the use of reaction wheels for satellite attitude control. To compensate for unknown disturbances, parameter uncertainties and actuator fault, AFTSMC is proposed as the control technique for satellite attitude control. The main contribution of the proposed adaptive fuzzy terminal sliding mode control approach is a methodology where no online control reconfiguration is needed and no fault detection and diagnosis is required. The stability of the system during faults is guaranteed by the Lyapunov theorem. In order to evaluate the performance of this controller, we evaluate its ability to handle different types of faults (actuator failure, actuator degradation); and its robustness under disturbances and uncertainties. We investigate the feasibility of achieving desired 3-axis stabilization and propose a continuous, time-invariant, nonlinear controller based on fuzzy variable structure techniques for a rigid body spacecraft, using stabilizing body rates and quaternions.

102 The chapter is organized as follows: Section 4.2 introduces the nonlinear equations of motion of an Earth orbiting satellite. AFTSMC algorithm is formulated with the corresponding stability conditions for robustness against uncertainties and disturbances in Section 4.3. The detailed numerical simulation of the governing system equations of motion under the proposed control strategy, including the effects of various system parameters on the controller performance is given in Section 4.4. Conclusions are stated in Section 4.5.

4.2

System Model and Equations of Motion

The investigation is initiated by formulating the complete nonlinear equations of relative attitude of the leader and follower rigid body spacecraft in order to develop a mathematical model that facilitates the design of nonlinear control methodologies. The proposed system is comprised of a rigid body spacecraft in an elliptical planar trajectory with the Earth's center at one of its foci (Figure 4.1). The orbital motion of the leader spacecraft is defined by a radial distance rL from the center of the Earth and a true anomaly . The inertial coordinate system O - XY Z is attached to the center of the Earth and rL  R3 , rL = [ rL 0 0 ]T defines the position vector of the leader satellite with respect to the inertial coordinate frame. The motion of the follower spacecraft is described relative to the leader spacecraft using a relative frame o - xyz fixed at the center of the leader spacecraft with the xaxis pointing along the local vertical, the z -axis taken along normal to the orbital plane, and the y -axis representing the third axis of the right-handed o - xyz frame.   R3 ,
 

 = [ x y z ]T defines the relative position of the follower spacecraft from the origin of the leader spacecraft coordinate frame. The attitude orientation of the spacecraft is specified by a set of three successive rotations:  (pitch) about the Z -axis,  about the roll axis (Y -axis), and finally  about the resulting yaw axis (X -axis). The corresponding principal body-fixed coordinate axes of the spacecraft are denoted by 0 - xyz .

103

Figure 4.1: Desired Relative Attitude during Formation Flying

4.2.1

Kinematics and Dynamics of Rigid Spacecraft with Quaternion

The absolute attitude kinematics of the leader or follower spacecraft is:     ×  + oi I3    oi ,  oi  = 1  oi 2 o -T 
i

(4.1)

oi

  oi where i = l, f refer to the leader and follower spacecraft, respectively. qi =   oi is the unit quaternion of the leader or follower spacecraft. oi = [oi1 oi2 oi3 ]T and oi = 1 - T oi oi are the vector and scalar components of the unit quaternion for the leader and follower satellite, respectively. I3 denotes the 3 × 3 identity matrix.   oi is the absolute 0 -oi3 oi2     angular velocity of the leader or follower satellite, respectively. × =  oi3 0 -oi1  oi   -oi2 oi1 0 is the skew-symmetric quaternion matrix. The rotation matrix that brings the leader or follower body-fixed frame onto the inertial frame [Pan & V. 2001] is represented by:
i Co = C (oi , oi ) i 2 T × ( o - T oi oi )I3 + 2oi oi - 2oi oi i

(4.2)

104 The dynamics model of a rigid leader or follower spacecraft is governed by a differential equation, [Hughes 1986] as:

× Ji   oi = -o J  + gi + i i i oi

(4.3)

where gi is the disturbance. i is the torque from actuator. Ji is the inertia matrix of the spacecraft.

4.2.1.1

Dynamics of Rigid Spacecraft with Four Reaction Wheels

The dynamics model of a rigid leader or follower spacecraft with four reaction wheels is governed by the following differential equation [Lin et al. 2008, Jiang et al. 2009]:
× Js   oi = -o (Js oi + LJw i ) + gi + Lwi i -1  i = -Jw w - LT   oi 

(4.4) (4.5)

where gi is the disturbance. wi is the torque matrix for the reaction wheels. Js is the total moment of inertia minus the moment of inertia of the wheels. Js = Ji - LJw LT . L is the reaction wheel orientation matrix.

4.2.2

Relative Attitude Kinematics and Dynamics

The relative quaternion between the leader spacecraft and the follower spacecraft [Pan & V. 2001] can be written as:   T  r  = F (of , of , ol , ol ) r by:
ol i i Cof = Cof Col T

  ×   - of ol + of ol  ol of  ol of + T  ol of

(4.6)

The rotation matrix between the leader spacecraft and the follower spacecraft is denoted

(4.7)

105 In this way, the relative attitude kinematics between the leader spacecraft and the follower spacecraft can be expressed as follows:      r r 

  r where qr =   is the unit quaternion of relative attitude of the leader and follower r spacecraft, and r is the relative angular velocity of the leader and follower satellite. The follower satellite, using reaction wheels as actuators, is shown in Figs. 4.2 and 4.3.

  ×  +  I 1 r r 3  r T 2 -
r

(4.8)

The relative rotational attitude dynamics of the follower satellite during formation flying are given by [Pan & V. 2001].
ol ol ol Jf  r = - (r + Cof ol )× Jf (r + Cof ol ) - Jf (Cof ol )× r ol -1 × - Jf Cof Jl (-ol Jl ol + gl + l ) + gf + f

(4.9)

Figure 4.2: Ryerson University Picosatellite with Reaction Wheels

106

Figure 4.3: Four Reaction Wheel Layout for Attitude Synchronization Control during Formation Flying We now use Eqs. (4.4), (4.5), and (4.9) to obtain the relative attitude dynamics of the follower spacecraft during formation flying with four reaction wheels:
ol ol ol Js  r = - (r + Cof ol )× [Jf (r + Cof ol ) + LJw r ] - Js (Cof ol )× r ol -1 × - Js Cof Jl (-ol Jl ol + gl + l ) + gf + Lw

(4.10) (4.11)

 r = -J -1 w - LT   r w

where gf is the total disturbances including gravity gradient torque and time varying disturbances d(t) (shown in Table 2.2), and w is the total torque from all reaction wheels. r is relative angular velocity. r is the wheel angular velocity. Jw , Jf and Jl are the inertia matrix of the wheel, the follower satellite, and the leader satellite, respectively, and Js = Jf - LJw LT . In order to simplify the controller design, we assume the leader is in the desired trajectory. Therefore, gl = 0, l = 0, and ol = old , where old is the leader desired angular velocity.

4.2.3

Relative Attitude Tracking Error Kinematics

To describe relative attitude and angular velocity tracking errors [Mehrabian et al. 2009], the quaternion qd is assumed to be the desired relative attitude. Therefore, the tracking

107 error quaternion describing the orientation of the follower body frame with respect to the leader body frame, qe is calculated by
-1 qe = qd  qr

(4.12)

where  denotes quaternion multiply. Denote e as the follower's relative angular velocity tracking error respect to the leader body frame. The quaternion rd is assumed to be the desired relative angular velocity.
ol (qe )rd e = r - Cof

(4.13)

× T ol 2 - T Cof (qe ) = (r r e  r e ) I3 + 2  r e  r e - 2  r e  r e e

(4.14)

Hereby, the relative attitude error kinematics between the leader spacecraft and the follower spacecraft can be expressed as follows:     ×   re +  I  re 3   1  re  e T 2   re -re

(4.15)

In this chapter, the control objective for attitude formation keeping of the fol-

lower spacecraft relative to the leader spacecraft requires that the actual attitude of the follower spacecraft track the desired relative attitude trajectory. It is required that limt re (t), re (t), e (t) = (0, 1, 0) exists.

4.3

Design of Fault Tolerant Control

In this section we present the theoretical basis for developing adaptive fuzzy terminal sliding control algorithms for the rigid body spacecraft mathematical model. A fault tolerant control methodology (shown in Fig. 4.4) is proposed for satellite attitude control with actuator faults. The AFTSMC overall design can be divided into two main steps. Step 1 involves the construction of a sliding surface containing tracking errors to ensure that once the system is restricted to the sliding surface the follower satellite can be expected to be

108

Figure 4.4: Fault tolerant control methodology for satellite attitude system

109 in the desired trajectory. Step 2 entails the derivation of parameter adaptation laws and fuzzy logic feedback control gains that can drive the relative state trajectory to the sliding surface and maintain it in the manifold.

4.3.1

Mathematical Model for Relative Attitude Controller

To employ the adaptive fuzzy sliding mode control design methodology described in this chapter, we need to construct a model to represent the nonlinear equations Eq. (4.10) and
T Eq. (4.8). Define the state as x = [T T r r ] and the AFTSMC control torque as u = Lw .

The relative attitude Eq. (4.10) can be represented as follows:
-1 ol ol ol  r = - Js (r + Cof old )× [Jf (r + Cof old ) + LJw r ] - (Cof old )× r ol -1 × -1 -1 - Cof Jl (-ol Jl old ) + Js gf + Js Lw

(4.16)

Denote P

× ol -1 Cof Jl (-ol Jl old ). Then, we consider Eq. (4.8) as follows:

-1 ol ol ol = Js (r + Cof old )× [Jf (r + Cof old ) + LJw r ] - (Cof old )× r -

r Denote p = 2 × r +  r I3
-1

2 × r +  r I3

-1

 r

(4.17)

. After taking the time derivative of , where T = × r +  r I3

Eq. (4.17), we obtain the followering expression of r :  r = p   r + p ¨r (4.18)

Making use of Eq. (4.17) and Eq. (4.18), the relative quaternion equation can be written as:
T T  -1  ¨r = 2(T -1 )   r - 4(T -1 ) (T ) r

(4.19)

 -1 = -T -1 T  T -1 . where T Substitute Eq. (4.16), we obtain the following:
T T  -1 T T -1 -1  ¨r = 2(T -1) P + 4(T -1 ) (T )  r + 2 Js (T -1 ) Lw + 2Js (T -1 ) gf

(4.20)

110 The equations governing the nonlinear dynamics of the relative attitude are: x ¨ = F (x) + G(x)Lw + D (t) y = x(t) (4.21)

T T  -1 T T -1 -1 where F (x) = 2(T -1 ) P + 4(T -1) (T ) r , G(x) = 2Js (T -1 ) , D (t) = 2Js (T -1 ) gf .

The unknown functions F (x), G(x) and D (t) satisfy the conditions: |F (x)|  F < , 0 < gmin  G(x), |D (t)|  F <  (4.22)

where F , gmin and  are constant numbers. A dynamic model of the follower's relative attitude tracking with multiplicative reaction wheel faults (e.g. reduced control torque) is represented by a diagonal matrix E . x ¨ = F (x) + G(x)(LEw ) + D (t) y = x(t) E is given by E = diag (a1 , a2 , a3 , a4 ), 0  ai  1 (i = 1, 2, 3, 4). (4.23)

4.3.2

Adaptive Fuzzy Terminal Sliding Mode Control Design

Let rd denote the desired angular velocity of the follower body frame relative to the reference leader frame:   r - 2×  rd = 2  rd   rd -  r rd  rd d d
× ¨rd   rd = 2  rd  ¨rd - ¨ rd  rd - 2  rd 

(4.24)

Next, we derive the general adaptive fuzzy sliding control law [Chan et al. 2001] as: ^ (x)-1 (¨ ^ (x) - H ^ (x)) u=G xd - E - F (4.25)

4.3.3

Terminal Sliding Surface

Nonlinear hyper-plane based sliding modes offer a wide variety of design alternatives with fast and finite time convergence. Define a terminal sliding surface vector [Park & Tsuiji 1999] as: s = [sr1 , sr1 , sr1]T (4.26)

111
p q r S = Cre + C0  e

(4.27)

where C0 is a constant number and p and q are the positive odd integers (p < q ).     p -1 q c c   re1  1 re1 p  1 re1   p     -1  q S= ¨r -  ¨rd + c2  ¨rd + E (4.28) re2  + C0 c2 re2  re2  = F (S ) + G(S )u + D (t) -  q    p c3  re3 c3 re3 q -1  re3     p -1 q c   re1 c    1 re1 p   1 re1      p - 1 where E = c2  re2 . re2  + C0 q c2 re2 q      p -1 q c3 re3 c3  re3  re3

4.3.4

Fuzzy Logic System

The unknown functions F (x), G(x) can be approximated by the fuzzy logic system universal approximation theorem [Wang 1997]. We can rewrite them as follows: ^ (x | F ) = T  (x), F F ^ (x | G ) = T  (x), G G (4.29)

where F and G are vectors of the fuzzy basis function and are supposed to be fixed, while
T T the parameters F and G are variables which will be designed by adaptive laws.

We choose the membership functions using the linguistic terms Negative Big (NB), Negative Medium (NM), Negative Small (NS), Zero (ZE), Positive Small (PS), Positive Medium (PB) and Positive Big (PM) which are assigned to the inputs (s1 to s3 ) and the ^ and G ^ ). output (F ^ (x | F ), G ^ (x | G ) as a function of , where 1 , ..., M are adjusted by an adaptation F law. Therefore, fuzzy basis functions F and G are vectors of S . The adaptation law is
  designed to minimize the parameter errors of F - F and G - G .   Therefore, we define F and G as the optimal values for F and G . They are artificial

^ (S | F ) and G ^ (S | G ) instead of With the given membership functions, we use F

quantities introduced only for analytical purposes, and their values are not needed for the

112 implementation.
 ^ (S | F ) - F (S ) F = arg min sup F F sDx  ^ (S | G ) - G(S ) G = arg min sup G G sDx

(4.30) ^ (S, t), G ^ (S, t) is: The collection of IF-THEN rules for in the following for F Rk : IF s ^1 is Ak 1, and, ··· , and, s ^m ··· , s ^m ··· , is Ak m, T HEN (4.31)

^1 (^ F s1 | F1 ) is B1 k , Rk : IF s ^1 is Ak 1, and,

^n (^ F sm | Fn ) is Bm k . is Ak m, T HEN (4.32)

··· , and,

^ 1 (^ G s1 | G1 ) is B1 k , where AK = [A1 A2 ··· A6

^ n (^ G sm | Gn ) is Bm k . B2 ··· B6 B7 ]T .

A7 ]T and B K = [B1

The unknown functions D (t) can be approximated by the universal approximation theorem. This term is proposed to avoid chattering: ^ (xi | H ) = T  (xi ) H H (4.33)

^ (si | H ) instead of H ^ (xi | H ). Therefore, the fuzzy basis function H is a vector We use H ^ (si , t) is: of S . The collection of IF-THEN rules for in the following for H Rk : IF where i = 1, · · · , m.
 We define the optimal value of H as:  H = arg min sup H

si

is Ak i

T HEN

^ i (si | H ) is Bi k H i

(4.34)

sDx

^ (si | H ) - H (si ) H

(4.35)

Define the minimum fuzzy approximation errors which correspond to approximation errors obtained when optimal parameters are used as follows:
 ^ (S | F ) w F = F (S ) - F

(4.36) (4.37)

^ (S |   ) w G = G( S ) - G G

113 ^ ( si |   ) w H = H (S ) - H H (4.38)

In this chapter, we assume that the used fuzzy logic systems do not violate the universal approximation property on the compact set Dx , which is assumed to be large enough for state variables to remain within Dx under closed-loop control. Therefore, |wF |  w ¯F , |wG |  w ¯G X  Dx (4.39)

where w ¯F and w ¯G are given constants. We also define F , G and H to represent the
   parameter estimation errors such that F = F - F , G = G - G , and H = H - H .

From the above analysis, we have: ^ (S | F ) = F ^ (S |   ) - F ^ (S | F ) + wF F (S ) - F F
 ^ (S | G ) = G(S ) - G ^ (S | F ^ (S | G ) + wG G( S ) - G )-G

(4.40) (4.41)

4.3.5

Stability Analysis

We append to the new control law a robustifying control term uR : u = uF + uR (4.42)

^ T (S | G )[0 Ip + G ^ (S | G )G ^ T (S | G )]-1 [X ¨d - E - F ^ (S | F ) - H ^ (si | H )] (4.43) uF = G where 0 is a small positive constant. Even though the control law Eq. (4.43) is always well defined, it cannot guarantee the stability of the closed loop system. This is due to the approximation of G-1 (S | G ) by the regularized inverse and to the unavoidable reconstruction errors of the unknown functions F (S ) and G(S ). S |S |T (w ¯F + w ¯ G |uF | + |u0 |) uR = 2 0 S +  and a robustifying control term [Labiod et al. 2005] : ^ (S | G )G ^ T (S | G )]-1 [X ¨d - E - F ^ (S | F ) - H ^ (si | H )] u0 = 0 [0 Ip + G where  is a design time varying parameter defined below. (4.45) (4.44)

114 Rewriting Eq. (4.28), we consider the new control laws and obtain the following equation:  = x S ¨-x ¨d + E = x ¨d + F (S ) + G(S )(u) + E + D (t) ^ (S | F ) + (G(S ) - G ^ (S | G ))uF + G(S )uR - H ^ (si | H ) + D (t) - u0 = F (S ) - F ^ (S |   ) - F ^ (S | F ) + wF + (G ^ (S |   ) - G ^ (S | G ) + wG uF = F F G ^ ( si |   ) - H ^ (si | H ) + wH + D (t) - H ^ ( si |   ) - u 0 + G( S ) u R H H H The adaptive parameters F , G , H and design parameter  are updated by the following adaptive laws: F = SF ,  H = SH ,  where:  F (S ) =
N i=1 P l=1

(4.46)

G = SG uF  |S |T (w ¯F + w ¯G |uF | + |u0 |)   = -0 0 S 2 + 

(4.47)

µAil (S )
N i=1

µAil (S )

,  G (S ) =

N i=1 µAil (S ) ,  H ( si ) N P i=1 µAil (S ) l=1

=

N i=1 P l=1

µAil (si ) N i=1 µAil (si )

 11 · · · 1n   .  .  . T . . . where  > 0,  > 0,  > 0, 0 > 0, 0 > 0.  = [1 · · · i · · · n ] ,  =  . . . ,   m1 · · · mn  = [1 · · · i · · · n ]T , 0 = [01 · · · 0 i · · · 0 n ]T , and 0 = [0 1 · · · 0 i · · · 0 n ]T . Theorem 1: Consider the system Eq. (4.21). The control laws defined by Eqs. (4.424.45), with AFTSMC control laws given by Eq. (4.47) guarantees the following property: 1. All signals in the closed-loop system are bounded. 2. The tracking errors are bounded. Proof of Theorem 1: In order to examine the stability and robustness of the trajectory



115 errors, we define a MIMO system as: F (S ) = [f1 (S ) ··· fn (S )]T (4.48) (4.49)

T ^ ^ ^ ^ (S | F ) = [f F 1 (S | f1 ), · · · , fi (S | fi ), · · · , fn (S | fn )]   g (S ) · · · g1n (S )  11  .  .  .. . G( S ) =  . . . .    gm1 (S ) · · · gmn (S )   g ^11 (S | g11 ) · · · g ^1n (S | g1n )   . .  .. ^ (S | G ) =  . . G .   . .   g ^m1 (S | gm1 ) · · · g ^mn (S | gmn )

(4.50)

(4.51)

^ 1 (s1 | h1 ), · · · , h ^ i (si | hi ), · · · , h ^ n (sn | hn )]T ^ (si | F ) = [h H w ¯F = [w ¯ f1 ··· w ¯fn ]T wF = [wf 1 , ..., wf i , ..., wf n ]T   w ¯ ··· w ¯g1n   g11  .  . . . . . w ¯G =  . . .    w ¯gm1 · · · w ¯gmn u j = u fj + u r j
 wgij = gij (S | gij ) - g ^ij (S | g ) ij  ^ wf i = fi (S | fi ) - f i (S | fi )

(4.52) (4.53) (4.54)

(4.55)

(4.56) (4.57) (4.58) (4.59) i = 1, 2, ..., n (4.60)

^ i ( si |   ) whi = hi (si | hi ) - h hi
m

wi = wf i +
j =1

wgij uj + whi ,

where wgij , wf i and wi are minimum fuzzy approximation errors, which correspond to approximation errors obtained when optimal parameters are used. We consider a Lyapunov function candidate defined as:
n

V =
i=1

Vi

(4.61)

116 where: Vi = 1 2 1 si +  T f + 2 i f i i
m

j =1

1 1 2 1 T  gij gij + T hi hi + ij i 0i i

(4.62)

 Define fi , gij and hi represent the fuzzy parameter errors such that fi = f - fi , i   gij = g - gij , and hi = h - hi . ij i

Thus, the time derivative of Vi is obtained as: 1 f +  i = si s V  i + T  i f i i
m

j =1

1 T  1 T 1 gij gij +  i  i hi hi + ij i 0i

(4.63)

Using Eqs. (4.46), (4.56), (4.57), (4.58) and (4.59), the time derivative of the component si can be expressed as:
m

s i

 ^ ^ = f i (S | fi ) - fi (S | fi ) + wfi +

j =1

 (^ gij (S | g )-g ^ij (S | gij ) + wgij )uf j ij

^ i ( si |   ) - h ^ i (si | h ) + Di (t) - h ^ i (si |  ) - u0 + Gij (S | g )urj +h hi i hi ij
m

=

T fi  fi (S )

+ w fi +
j =1

( T gij gij (S ) + wgij )uj (4.64)

+ T h i  h i ( si )

^ i (si |  ) - u0 + Gij (S | g )urj + Di (t) + whi - h hi ij

^ i (si |  ) = ki sgn(si ), substituting Eq. (4.64) into Eq. (4.63), we obtain the Since h hi time derivative of Vi as: i = V 1 T  f ) + si w f  ( s i i  f i ( S ) +  i i i f i m 1 T  g ) + si (Di (t) - ki sgn(si )) + si whi gij (si ij gij (S )uj +  + ij  ij j =1
m

(4.65)

+ si
j =1

wgij uj +

1 T  h ) - si (uo ) + si gij (S )ur + 1 i  i hi (i si hi (si ) +  i j j i 0i

Using Assumption 1, we obtain the time derivative of Vi as:

117

i = V

1 T f ) +  ( s i i  f i ( S ) +  i i f i

m

j =1

1 T  g ) + 1 T (i si h (si ) gij (si ij gij (S )uj +  ij i ij i hi 1 i  i 0i

 h ) + si wi + si (Di (t)) - (D0 + ki ) |si | - si (uo ) + si gij (S )ur + + 0 i j j 1 T f ) +   ( s i i  f i ( S ) +  i i f i
m

j =1

1 T  g ) + 1 T (i si h (si ) gij (si ij gij (S )uj +  ij i ij i hi 1 i  i 0i

 h ) + si wi - ki |si | - si (uo ) + si gij (S )ur + + 0 i j j

 f i = - f i ,   g = - g , and   hi = - hi . constant numbers,  ij ij Rewrite Eq. (4.47) as the following: f i = i si f i (S )  g = ij si g (S )uj  ij ij hi = i si hi (si )  We obtain the time derivative of Vi as:

f =   -  f ,  g =   -  g , and  h =   -  h . Since  ,  and  are Rewrite  gij gij i i ij ij i i fi hi fi hi

(4.66)

 i  si wi - ki |si | - si (uo ) + si gij (S )ur + 1 i  i V 0 j j 0i Using Eq. (4.44), we can write: si gij (S )urj  |si | (w ¯ fi + w ¯gij ufj + uoj ) - i |si | (w ¯ fi + w ¯gij ufj + uoj ) 0 si
2

(4.67)

+ i

(4.68)

According to Assumption 1, we obtain the inequality: si gij (S )urj  0 si by substituting the adaptive law as the following:   i = -0 | si | T ( w ¯ fi + w ¯gij |ufi | + |u0i |) 0 s2 i + i
2

(4.69)

118 Since wi is the approximation error which is bounded (|wi |  w ¯i ), we assume ki0 > w ¯i . Substituting the adaptive law into Eq. (4.67), we obtain: | si | T ( w ¯ fi + w ¯gij |ufi | + |u0i |) 1  i (  i + 0 ) V i  - | s i | k i0 + s i w i + 0i 0 s2 i + i  - | s i | k i0 + s i w i
n

(4.70) (4.71)

   - | s i | ( k i0 - w ¯i )  V

i=1

-ki0 |si |

 (t), F , G , H , e, and u. Therefore, G , H are bounded. This implies the boundedness of S the tracking errors are bounded. Remark 1. In this chapter, the fuzzy systems are used to approximate unknown

 is negative semi-definite and V  L , which implies that the signals S (t), F , Hence, V

dynamic functions due to faults on a compact operating set Dx . Then the stability results are semi-global as the state X remains inside Dx . We assume Dx is chosen large enough. However, a larger compact set requires a larger number of fuzzy rules to avoid violation of the universal approximation property of the used fuzzy systems. Larger fuzzy rules need more complexity in the adaptive control systems. When we apply AFTSMC, an appropriate compact set should be designed based on the knowledge of physical limitations and properties of the physical plants.

4.4

Results and Discussion

To study the effectiveness and performance of the proposed AFTSMC controller in satellite attitude synchronization control for formation flying, the detailed response is numerically simulated using the set of governing system equations of motion Eqs. (4.10-4.11) in conjunction with the modified adaptive fuzzy terminal sliding control laws Eqs. (4.42-4.45). The system and orbital parameters for the leader and follower spacecraft along with the initial conditions used in the numerical simulations are shown in Table 4.1. Unless otherwise stated explicitly, all numerical simulations are based on the parameters stated in Table 4.1.

119

Table 4.1: Satellite Attitude Parameters and System Parameters Parameters mF (kg) µe (km3 s-2 ) rL rf (km) Desired Relative Attitude Values 1 398600 6878, 6978   ( 3/3)sin(0.001t)     d = - ( 6/6)sin(0.001t) d =   -0.5sin(0.001t)

1 - T d d

Desired Leader Attitude Initial Relative Angular Velocity Initial Quaternion Inertia of Picosatellites (kgm2 ) Inertia of Reaction Wheels (kgm2 )

d = -[0, 0.5cos(0.2t), 0.5sin(0.2t)]T (0) = (-0.6, -0.2, 0.6)T ,  = Jw = 10-5 diag (1, 1, 1, 1)

 (0) = (0.0002, 0.0002, 0.0002)T (rad/s) 1 - (0)T (0)

Jl,f = diag (0.0020, 0.0017, 0.0020) d(t) = 0.0005[sin(0.8t), cos(0.5t), cos(0.3t)]T

External disturbances

Table 4.2: Fault Tolerant Controller Parameters for Numerical Analysis Name Yaw Track Control Sliding Surface Roll Track Control Sliding Surface Pitch Track Control Sliding Surface Robust Terms Estimation of F (X, t) Adaptive Gain Estimation of G(X, t) Adaptive Gain Chattering Free Control Adaptive Gain Parameters C11 , C12 C21 , C22 C31 , C32 0 , 0 , (i = x, y, z ) ij , , (i = x, y, z ) Values 0.1, 1 0.1, 1 0.1, 1 0.1, 0.002 0.3 0.01 8

120 The performance evaluation of the proposed controller presented in this section is divided into three subcategories. First, we present the effectiveness of the controller for a fault free case of attitude tracking during formation keeping. Then we examine the effects of wheel degradation, permanent wheel control failure, and multiple faults on the performance of the proposed control strategies. To implement the adaptive fuzzy terminal sliding mode fault tolerant control law, we define the fuzzy sets over the interval of sliding surface s1 , s2 , s3 . Five to eleven fuzzy rules can successfully deal with the different faults, but more rules will require more computing time. The triangular membership functions result in higher control gain. In the end, seven Gaussian membership functions defined for each variable Ai , i = 1, 2, · · · , 7, are used as follows:

µ A 1 ( si ) =

si + 0.6 × a µA2 (si ) = exp - b si µA4 (si ) = exp - b
2

1 , 1 + exp[5(si + 0.9 × a)]
2

,

µA3 (si ) = exp -

si + 0.3 × a b
2

2

,

,

si - 0.3 × a µA5 (si ) = exp - b
2

,

si - 0.6 × a µA6 (si ) = exp - b µ A 7 ( si ) =

, (4.72)

1 1 + exp[5(si - 0.9 × a)]

where a and b are different constant numbers designed according to si . For fault tolerance in attitude formation keeping and station keeping systems, the fuzzy logic system uses 343=(73) rules. We use the design parameters of the AFTSMC controllers with fault accommodation as given in Table 4.2.

121

4.4.1

Fault-free Condition

We first study the attitude motion of the spacecraft. Figs. 4.5, 4.6, 4.7 and 4.8 show the relative attitude formation keeping response of the spacecraft by the AFTSMC control law with gravity gradient torque disturbances (Case 1). Next we consider the system where there are initial gravity gradient torque disturbances and time-varying external dism is the mean angular velocity and equal (shown in Figs. 4.9, 4.10, 4.11, 4.12 and 4.13).  to 2 C ol × [Js C ol ] + 0.0005[sin(0.8t), cos(0.5t), cos(0.3t)]T ) (Case 2) turbances, as (gf = 3 m of of µe /a3 (µe is the gravitational parameter of the Earth; a is the semi-major axis of the

orbit of the leader satellite). In this chapter, we assume the distance between the leader m =  ). This function and follower satellite is fixed and the leader is in the circular orbit ( is used in order to test the robustness of the control law to time-varying disturbances. It is clearly evident that the control algorithm successfully stabilizes both attitude formation keeping (relative attitude) and relative angular velocity motion. The reaction wheel torque and wheel velocity for Case 2 is higher than Case 1 because of the external disturbances (Table 4.1).

4.4.2

Fault Condition

We simulate a severe case of failure (Case 3) in which not only some wheels lose partial power to randomly varying degrees, but also some wheels totally fail or are shut down purposely. Among the four wheels, wheels 3 and 4 only supply 20% and 40% respectively of the initial actuation torque at the time t = 0.0018 orbit, after which wheel 2 has failed or is shut down, as illustrated in Figs. 4.14, 4.15, 4.16, 4.17 and 4.18. The same control law and parameters as in the case of fault-free case is employed. The driving torques are all changed at the time t = 0.0018 orbit. The control precision and attitude tracking are as good as in the fault-free case, the control inputs do not saturate, and there is no chattering although the station keeping is not as good. Another important problem for the reaction wheel actuator system is that most wheels do not operate efficiently within a dead zone located near the lower-limit of control voltage.

122 In Case 4, after t = 0s the leader spacecraft's second wheel fails and the third wheel torque degrades by 90%, as illustrated in Figs. 4.19, 4.20, 4.21, 4.22 and 4.23. The relative attitude formation keeping and relative angular velocity motion for this case are presented in Figs. 4.19 and 4.20. More driving torque is needed compared with the fault-free Case 2. These simulations indicate that the proposed control law is indeed robust, adaptive, and fault tolerant when a reaction wheel suddenly fails or degrades.

0
1

-0.5 -1 0 0.4 0.005 0.01 0.015 0.02

2



0.2 0 0 0 0.005 0.01 0.015 0.02

3

-0.5 -1 0 1 0.5 0 0 0.005 0.01 Orbit 0.015 0.02 0.005 0.01 0.015 0.02

Figure 4.5: Fault tolerant AFTSMC control fault free case (case 1), with gravity gradient torque disturbances: quaternion





123

0.4 1 [rad/s] 0.2 0 0 0.1  [rad/s] 0 -0.1 0 0.4 3 [rad/s] 0.2 0 0 0.005 0.01 Orbit 0.015 0.02 0.005 0.01 0.015 0.02 0.005 0.01 0.015 0.02

Figure 4.6: Fault tolerant AFTSMC control fault free case (case 1), with gravity gradient torque disturbances: angular velocity

2

124

5  [rad/s] 0 -5 0  [rad/s] 5 0 -5 0  [rad/s] 10 0 -10 0  [rad/s] 10 0 -10 0 0.005 0.01 Orbit 0.015 0.02 0.005 0.01 0.015 0.02 0.005 0.01 0.015 0.02 0.005 0.01 0.015 0.02

Figure 4.7: Fault tolerant AFTSMC control fault free case (case 1), with gravity gradient torque disturbances: wheel velocity

4

3

2

1

125

[Nm]

2 0 -2 2 0 -2 5 0 -5 5 0 -5

x 10

-3



w1

0 -3 x 10

0.005

0.01

0.015

0.02



w2

[Nm]

0 -4 x 10

0.005

0.01

0.015

0.02



w3

[Nm]

0 -4 x 10

0.005

0.01

0.015

0.02



w4

[Nm]

0

0.005

0.01 Orbit

0.015

0.02

Figure 4.8: Fault tolerant AFTSMC control fault free case (case 1), with gravity gradient torque disturbances: wheel torque

126

1
1

0 -1 0 0.5 0.005 0.01 0.015 0.02

2

 

0 -0.5 0 1
3

0.005

0.01

0.015

0.02

0 -1 0 1 0.5 0 0 0.005 0.01 Orbit 0.015 0.02 0.005 0.01 0.015 0.02

Figure 4.9: Fault tolerant AFTSMC control fault free case (case 2), with gravity gradient torque and external disturbances: quaternion





127

0.4  [rad/s] 0.2 0 -0.2 0 0.1  [rad/s] 0.005 0.01 0.015 0.02

1 2

0

-0.1 0 0.4  [rad/s] 0.2 0 -0.2 0 0.005 0.01 Orbit 0.015 0.02 0.005 0.01 0.015 0.02

Figure 4.10: Fault tolerant AFTSMC control fault free case (case 2), with gravity gradient torque and external disturbances: angular velocity

3

128

100  [rad/s] 0 -100 0 100  [rad/s] 0 -100 0 100  [rad/s] 0 -100 0 100  [rad/s] 0 -100 0 0.005 0.01 Orbit 0.015 0.02 0.005 0.01 0.015 0.02 0.005 0.01 0.015 0.02 0.005 0.01 0.015 0.02

Figure 4.11: Fault tolerant AFTSMC control fault free case (case 2), with gravity gradient torque and external disturbances: wheel velocity

4

3

2

1

129

[Nm]

2 0 -2 2 0 -2 1 0 -1 5 0 -5

x 10

-3



w1

0 -3 x 10

0.005

0.01

0.015

0.02



w2

[Nm]

0 -3 x 10

0.005

0.01

0.015

0.02



w3

[Nm]

0 -4 x 10

0.005

0.01

0.015

0.02



w4

[Nm]

0

0.005

0.01 Orbit

0.015

0.02

Figure 4.12: Fault tolerant AFTSMC control fault free case (case 2), with gravity gradient torque and external disturbances: wheel torque

130

0.1
1

S

0

-0.1 0 0.04 0.02 S2 0 -0.02 0 0.1
3

0.005

0.01

0.015

0.02

0.005

0.01

0.015

0.02

S

0

-0.1 0 0.005 0.01 Orbit 0.015 0.02

Figure 4.13: Fault tolerant AFTSMC control fault free case (case 2), with gravity gradient torque and external disturbances: sliding surface

131

1
1

0 -1 0 0.5 0.005 0.01 0.015 0.02

2

 

0 -0.5 0 1
3

0.005

0.01

0.015

0.02

0 -1 0 1 0.5 0 0 0.005 0.01 Orbit 0.015 0.02 0.005 0.01 0.015 0.02

Figure 4.14: Fault tolerant AFTSMC control wheel failure case (case 3), with gravity gradient torque and external disturbances, after 0.0018 orbit, wheel 2 fails permanently and wheels 3 and 4 wheel degrade by 80% and 60%: quaternion





132

0.5  [rad/s]

0

1

-0.5 0 0.1  [rad/s] 0.005 0.01 0.015 0.02

0

2

-0.1 0 0.5  [rad/s] 0.005 0.01 0.015 0.02

0

3

-0.5 0 0.005 0.01 Orbit 0.015 0.02

Figure 4.15: Fault tolerant AFTSMC control wheel failure case (case 3), with gravity gradient torque and external disturbances, after 0.0018 orbit, wheel 2 fails permanently and wheels 3 and 4 wheel degrade by 80% and 60%: angular velocity

133

100  [rad/s] 0 -100 0 100  [rad/s] 0 -100 0 100  [rad/s] 0 -100 0 100  [rad/s] 0 -100 0 0.005 0.01 Orbit 0.015 0.02 0.005 0.01 0.015 0.02 0.005 0.01 0.015 0.02 0.005 0.01 0.015 0.02

Figure 4.16: Fault tolerant AFTSMC control wheel failure case (case 3), with gravity gradient torque and external disturbances, after 0.0018 orbit, wheel 2 fails permanently and wheels 3 and 4 wheel degrade by 80% and 60%: wheel velocity

4

3

2

1

134

[Nm]

2 0 -2 2 0 -2 1 0 -1 1 0 -1

x 10

-3



w1

0 -3 x 10

0.005

0.01

0.015

0.02



w2

[Nm]

0 -3 x 10

0.005

0.01

0.015

0.02



w3

[Nm]

0 -3 x 10

0.005

0.01

0.015

0.02



w4

[Nm]

0

0.005

0.01 Orbit

0.015

0.02

Figure 4.17: Fault tolerant AFTSMC control wheel failure case (case 3), with gravity gradient torque and external disturbances, after 0.0018 orbit, wheel 2 fails permanently and wheels 3 and 4 wheel degrade by 80% and 60%: wheel torque

135

0.1
1

S

0

-0.1 0 0.04 0.02 S2 0 -0.02 0 0.1
3

0.005

0.01

0.015

0.02

0.005

0.01

0.015

0.02

S

0

-0.1 0 0.005 0.01 Orbit 0.015 0.02

Figure 4.18: Fault tolerant AFTSMC control wheel failure case (case 3), with gravity gradient torque and external disturbances, after 0.0018 orbit, wheel 2 fails permanently and wheels 3 and 4 wheel degrade by 80% and 60%: sliding surface

136

1
1

0 -1 0 0.5 0.005 0.01 0.015 0.02

2

 

0 -0.5 0 1
3

0.005

0.01

0.015

0.02

0 -1 0 1 0.5 0 0 0.005 0.01 Orbit 0.015 0.02 0.005 0.01 0.015 0.02

Figure 4.19: Fault tolerant AFTSMC control wheel failure case (case 4), with gravity gradient torque and external disturbances, at 0s, wheel 2 fails permanently and wheel 3 degrades by 90%: quaternion





137

0.5  [rad/s]

0

1

-0.5 0 0.5  [rad/s] 0.005 0.01 0.015 0.02

0

2

-0.5 0 1  [rad/s] 0.5 0 -0.5 0 0.005 0.01 Orbit 0.015 0.02 0.005 0.01 0.015 0.02

Figure 4.20: Fault tolerant AFTSMC control wheel failure case (case 4), with gravity gradient torque and external disturbances, at 0s, wheel 2 fails permanently and wheel 3 degrades by 90%: angular velocity

3

138

100  [rad/s] 0 -100 0 1  [rad/s] 0 -1 0 100  [rad/s] 0 -100 0 100  [rad/s] 0 -100 0 0.005 0.01 Orbit 0.015 0.02 0.005 0.01 0.015 0.02 0.005 0.01 0.015 0.02 0.005 0.01 0.015 0.02

1 4 3 2

Figure 4.21: Fault tolerant AFTSMC control wheel failure case (case 4), with gravity gradient torque and external disturbances, at 0s, wheel 2 fails permanently and wheel 3 degrades by 90%: wheel velocity

139

[Nm]

2 0 -2

x 10

-3



w1

0 [Nm] 1 0 -1 1 0 -1 2 0 -2 0 0 -3 x 10 0 -3 x 10

0.005

0.01

0.015

0.02



w2

0.005

0.01

0.015

0.02



w3

[Nm]

0.005

0.01

0.015

0.02



w4

[Nm]

0.005

0.01 Orbit

0.015

0.02

Figure 4.22: Fault tolerant AFTSMC control wheel failure case (case 4), with gravity gradient torque and external disturbances, at 0s, wheel 2 fails permanently and wheel 3 degrades by 90%: wheel torque

140

0.1
1

S

0

-0.1 0 0.2
2

0.005

0.01

0.015

0.02

S

0

-0.2 0 0.2
3

0.005

0.01

0.015

0.02

S

0

-0.2 0 0.005 0.01 Orbit 0.015 0.02

Figure 4.23: Fault tolerant AFTSMC control wheel failure case (case 4), with gravity gradient torque and external disturbances, at 0s, wheel 2 fails permanently and wheel 3 degrades by 90%: sliding surface

4.5

Conclusions

In this chapter, we propose a fault tolerant AFTSMC control law and Lyapunov stability proof for attitude tracking of a leader and a follower picosatellite. The proposed controller successfully drives the system back to the desired trajectory for abrupt fault, incipient fault and multiple fault cases. Any information on the faults is not known to the controllers and therefore the proposed control algorithm accommodates the system faults without going through the process of fault detection and isolation. The asymptotic stability of the resulting closed loop system is shown through Lyapunov analysis. Simulation results have

141 demonstrated the effectiveness of the proposed control scheme.

Chapter 5

Decentralized Attitude Synchronization of Formation Flying

5.1

Introduction

In Chapter 4, the feasibility of attitude synchronization for leader-follower formation flying was studied. Decentralized multiple formation flying attitude cooperative will be studied extensively in this chapter. A decentralized attitude controller for satellite synchronization is beneficial for practical uses such as satellite surveillance, pointing control, formation flying and space based interferometry. The benefits of using a decentralized attitude controller are to avoid necessitating a complete redesign of the control system when new subsystems are added, and also to guarantee the stability of the whole system [Bakule 2008, Das & Lewis 2010]. A distributed cooperative nonsingular fast terminal fuzzy sliding mode controller (NFFTSMC) is proposed in this chapter for attitude synchronization. The system model and its equations of motion are presented in Section 5.2. Section 5.3 presents the closed-loop nonlinear control law based on SMC along with the stability analysis of the closed-loop system. In Section 5.4, numerical simulations are carried out for a detailed assessment of the proposed attitude control strategy. The effects of various system parameters on the performance of the controller are examined and the effectiveness of the proposed controller in the presence of parameter uncertainties and external disturbances is studied. Finally, the findings of the present study are summarized in Section 5.5.

144

5.2
5.2.1

Preliminaries
Attitude Dynamics and Kinematics

The individual satellites in the formation are modelled as rigid bodies. The proposed system consists of four rigid body satellites in a circular orbit around the Earth [Fragopoulos & Innocenti 2004]. Consider the i'th rigid satellite with a 4-wheel cluster installed to provide internal torques. The attitude dynamics of a rigid satellite controlled by reaction wheels can in general be described with the following nonlinear differential equation [Jin et al. 2008]:
B B Ji  i B BI = -i BI × (Jsi i BI + Ai Jwi i ) + Ai rwi + ie

(5.1)

The torques generated by the reaction wheels rwi are given by  i + AT i B rwi = Jwi ( i  BI ) (5.2)

where i B BI is the angular velocity of the satellite relative to the inertial frame L, expressed in the  frame, and ie  R3×1 represents the external torque acting on the system. Ai is the 3 × 4 matrix whose columns represent the influence of each reaction wheel on the angular acceleration of the satellite. We define a matrix Ji = Jsi - Ai Jwi AT i , where Jsi  R3×3 is the moment of inertia of the satellite, including the wheels, and Jwi  R4×4 =

diag([Jwi1 , Jwi2 , Jwi3 , Jwi4]) denotes the axial moment of inertia of the reaction wheels. i  R4×1 denotes the axial angular velocity of the reaction wheels. The external torques (ie ) are assumed to include gravity gradient torque (M i ) acting on the satellite and external disturbances (dM i ). The gravity gradient torque is given by [Schaub & Junkins 2003] as
2 × ie = 30 [^ c3 ]Jsi c ^3 , T c ^3 = Ci B L [0 0 1]

(5.3)

In this chapter, we adopt the unit quaternion to describe the attitude of the satellite. The unit quaternion q ¯i is defined by q ¯i =   e ¯ sin(/2) cos(/2)  =  qvi q4i   (5.4)

145 where  denotes the principal angle, and e ¯ = [e1 , e2 , e3 ]T denotes the principal axis asso2 2 3×1 ciated with Euler's Theorem (e2 = [qi1 , qi2 , qi3 ]T 1 + e2 + e3 = 1). q4i  R and qvi  R

denote the Euler parameters that represent the orientation of the satellite body frame,
T , with respect to the orbital frame, £, and satisfy the constraint qvi qvi + q4i = 1. The

nonlinear differential equations governing the kinematics of the satellite in terms of Euler parameters can be expressed as     × q vi q I + [ q ] vi    = 1  4i i B BL T 2 q 4i -qvi

(5.5)

× where I  R3×3 represents the identity matrix, and [qvi ] denotes a skew-symmetric matrix

which is given by
× [qvi ]

The angular velocity of the body-fixed reference frame, , with respect to the inertial frame, can be expressed as
B B i B BI = i BL + i LI

0 -qi3 qi2   =  qi3 0 -qi1  -qi2 qi1 0



    

(5.6)

(5.7)

The direction cosine matrix Ci B L that describes the orientation of the satellite body-fixed frame, , with respect to the LVLH reference frame, £ defined in terms of Euler parameters is given by
2 T T × Ci B L = (q4i - qvi qvi )I + 2qvi qvi - 2q4i [qvi ]

(5.8)

The orbital angular velocity expressed in the  frame, i B LI , can be obtained by rotating the angular velocity in £ using the transformation matrix Ci B L as follows:
B i B LI = Ci L T

0 -i 0 0

(5.9)

 is the magnitude of orbital angular velocity of the LVLH frame. For a where i 0 =  = circular orbit, 
3 , where µ represents the gravitational parameter of the Earth, µe /Rc

and Rc defines the distance of the spacecraft measured from the center of the Earth.

146 Torques are produced on the satellite by accelerating or decelerating the reaction wheels [Schaub & Junkins 2003]. Let the torque demanded by the satellite be denoted as rwi . The input voltage required to control the actuator dynamics of the reaction wheel can be shown as
-1 eai = Kbi i - Rbi Kti (Ai rwi - f )

(5.10)

where Kti  R4×4 = diag([kt1 , kt2 , kt3 , kt4 ]) is the motor torque constant. Kbi  R4×4 = diag([kb1 , kb2 , kb3 , kb4 ]) is the back-EMF constant, Rbi  R4×4 = diag([rb1 , rb2 , rb3 , rb4 ]) is the armature resistance, and we consider the constant friction f in the reaction wheels.

5.2.2

Attitude Tracking for Station Keeping and Formation Keeping

In the case of tracking a desired rotational motion, the target attitude of the i'th satellite in the desired reference frame o with respect to the LVLH frame £ is described by the
T 2 3 orientation (qdvi , qd4i )  R3 × R that satisfies the constraint qdvi qdvi + qd 4i = 1. Let di  R

denote the angular velocity of o with respect to £, expressed in the frame o . To address the station-keeping attitude tracking problem, we define the quaternion absolute tracking error (qi e , qi 4e )  R3 × R as the relative orientation between the body-fixed frame  and the desired reference frame o , which is computed as
× ]qdvi qi e = qd4i qvi - q4i qdvi + [qvi T qi 4e = qd4i q4i + qdvi qvi

(5.11)

2 where qi T e qi e + qi 4e = 1. The corresponding rotation matrix Cie = Ci (qi e , qi 4e )  SO (3) is

given by
× T T Cie = (qi 2 4e - qi e qi e )I + 2qi e qi e - 2qi 4e [qi e ]

(5.12)

absolute angular velocity tracking error ie  R3 of  with respect to £ as follows: ie = i B BL - Cie id

×  where Ci T e Ci e = 1, Ci e = 1, det(Ci e ) = 1, and Ci e = -[i e ]Ci e . Next, we define the

(5.13)

147 From Eqs. (5.5), (5.11), and (5.13), the equations that govern the absolute attitude (station-keeping) error dynamics and kinematics are given by 1 q i e = (qi 4e I + [qi × e ])i e 2 1 q i 4e = - qi T ie 2 e (5.14)

(5.15)

Assumption 1: We assume that there exists a known, finite constant, c1 > 0 such that qdi
2

+ q di

2

+ q ¨di

2

 c1 for all t  0.

We choose q ¯ij and ij to represent the quaternion mapping of the i'th satellite bodyfixed coordinate with respect to the j'th satellite body-fixed coordinate and the angular velocity of the i'th satellite with respect to the j'th satellite [Changa et al. 2009]
-1 q ¯ij = [qij T q4 ] = q ¯i  q ¯j T

(5.16)

qv ij = qv i - qv j ij = i - Cij j

(5.17) (5.18)

where Cij is the rotation matrix from the i'th body reference frame to the j'th body reference frame, which is a proper orthogonal matrix. qv ij is defined as the formation flying attitude error.
-1 Cij = Cij (¯ qi  q ¯i ) = Ci (¯ qi )Cj (¯ qj )T

(5.19)

According to Eq. (5.8), qi ) = (q4 i 2 - qv i T qv i )I + 2qv i qv i T - 2q4 i [qv i × ] Ci (¯ The quaternion (qv ij ) differential equations are 1 qv ij = (qij 4 ij - ij  qv ij ) 2 (5.21) (5.20)

148

5.2.3

Reference Attitude Tracking

Fig. 5.1 shows the attitude synchronization system has a virtual leader, labeled as rigid body n + 1, whose attitude is the time varying reference attitude qvd vd ¨vd ^ for the group. q ^, q ^ are bounded. The quaternion (qvi d ) uses the same concept as in the reference [Ren 2010]. qvi d =
n j =1 aij qvj n j =1 aij

+ ai(n+1) qvd ^ + ai(n+1)

(5.22)

5.2.4

Mathematical Model for Controller Design

To employ the proposed control design methodology described in this chapter, we need to construct a model to represent the nonlinear equations Eq. (5.1).
× -1 Denoting p = 2[q4i I + (qvi )] , after taking the time derivative of Eq. (5.5), we obtain

the following expression of i B BL :  i B q vi + pq ¨vi BL = p where T = [q4i I + (qvi )× ]-1 . Making use of Eq. (5.5) and Eq. (5.23), the quaternion equation can be written as:
-1  -1 )q q ¨vi = 2(T -1) ( i B i B ) (T vi BI -  LI ) - 4(T T T

(5.23)

(5.24)

 -1 = -T -1 T  T -1 . where T Substituting the Eqs. (5.1) and (5.9) into the Eq. (5.24), we obtain:
B q ¨vi = 2(T -1 ) [Ji -1 (-i B i B BI × (Jsi i BI + Ai Jwi i ) + Ai rwi + ie ) -  LI ] T  -1 - 4(T -1 ) (T )q vi B × B B Using CL = -[BL ]CL , we have: B B  i B LI = -i LI × i LI T

(5.25)

(5.26)

The dynamics error equation with actuator fault can be written as: i e ) + (i + i ) + i q ¨ie = fi (qi e , q (5.27)

149 A dynamic model of the satellite's relative attitude tracking with multiplicative reaction wheel faults (e.g. reduced control torque) is represented by a diagonal matrix E .
B i e ) = 2(T -1) [Ji -1 (-i B fi (qi e , q BI × (Jsi i BI + Ai Jwi i )] T  -1 T B - 4(T -1 ) (T )q ie + 2(T -1 ) Ji -1 i B LI × i LI T

(5.28) (5.29) (5.30)

i = E [2(T -1 ) Ji -1 Ai rwi ] i = 2(T -1) Ji -1 ie
T

T

Assumption 2: The disturbances i are bounded such that i  M i (i = 1, 2, ..., n), where M i is a positive constant. Assumption 3: The fault i are bounded such that i  iM i (i = 1, 2, ..., n), where iM i is a positive constant. The total disturbances i acting on the satellite include gravity gradient torque M and m =   . The external disturbances dM . In the case where the satellite is in a circular orbit,  gravity gradient torque [Wie & Roithmayr 2005] and external disturbances are 2 C ^ ^ M = 3 m i × [Js Ci ] m t), cos( m t), cos( m t)]T . dM = Md [sin( where M is much more smaller than dM . (5.31) (5.32)

5.2.5

Consensus Tracking

¯) consists of a node set v , an edge set E and a weighted A weighted graph G = (V, E, A ¯. It is natural to describe the topology of the information flow between adjacency matrix A ¯ = aij  Rn×n is the satellites in the form of a graph. The weighted adjacency matrix A weighted adjacency matrix of graph G with nonnegative elements. Node vi represents the i'th satellite, and an edge in G is denoted by an unordered pair (ij ). ij  E  ji  E . The adjacency element aij denotes the communication quality between the i'th satellite and the ¯ is a symmetric matrix. j'th satellite. It is assumed that aij = aji and A

150 Let D = diag (d1, d2 , ..., dn ) be the degree matrix of G. The Laplacian matrix L of the weighted graph G is defined by ¯ L=D-A (5.33)

It is assumed that the multi-satellite formation flying studied in this chapter has a connected graph topology G. The theorem given in [Godsil & Royle 2001] gives the existing results of the Laplacian matrix and graph theory. ¯) is an undirected connected graph, then the graph LaplaTheorem 1: If G = (V, E, A cian matrix L is a symmetric matrix with n real eigenvalues in an ascending order as: 0 = 1 , 2  3 ...  n  2PM (5.34)

where PM = max1in {Pi } is the maximum degree of a graph, and 2 is called the algebraic connectivity of a graph. Let ai1  R3 and ai2  R3 be the consensus attitude error including the station-keeping and formation-keeping errors of the i'th satellite in the formation, which are defined as:
n

ai1 = kp
j =1,i=j n

aij qv ij + ki qi e aij qv ij + ki q i e
j =1,i=j

(5.35)

ai2 = kp

(5.36)

¯. kp and ki are where i = 1, 2, ..., n. aij is the element of the weighted adjacency matrix A positive constants determined by the controller designer, respectively. Remark 1 : The parameters kp and ki are used to regulate the convergence rate of the state trajectory and tuned to reduce undesired chattering on the sliding surface. For synchronization of different size satellites, kp and ki are very important and critical parameters during the decentralized control design. The consensus error is used to evaluate the motion synchronization performance. Eqs. (5.35), (5.36) are written as follows:
n

ai1 = kp
j =1

lij qj e + ki qi e

(5.37)

151
n

ai2 = kp
j =1 T T T

lij qj e + ki q i e

(5.38)

Define A1 = (a11 , a21 , ..., an1 ), A2 = (a12 T , a22 T , ..., an2 T ),  11 T , qe  21 T , ..., qe  n1 T ), and K = diag (k1 , k2 , ..., kn ). E1 = (qe11 T , qe21 T , ..., qen1 T ), E2 = (qe The Eqs. (5.37), (5.38) can be expressed in terms of the aforementioned quantities as follows: A1 = (kp L  I3 + K  I3 )E1 A2 = (kp L  I3 + K  I3 )E2 (5.39) (5.40)

Lemma 1: The matrix M1 = (kp L  I3 + K  I3 ) is symmetric and positive definite. m x
2

 xT ((kp L  I3 + K  I3 ))x  M x

2

, x  Rmn

(5.41)

where m = min1in (ki ) and M = kp n + max1in (ki ) are positive constants. The objective of control design becomes to design appropriate control input that guarantees the convergence of both the station-keeping qi e and formation-keeping qv ij tracking error and consensus synchronization error ai1 and ai2 , even in the presence of unknown constant parameters, periodic disturbances, and actuator faults. In short, one needs to achieve qi e , qv ij  0 and ai1  0 as t  .

5.3

Design of Nonsingular Fast Fuzzy Terminal Sliding Mode Control

In this section we present the theoretical basis for developing NFFTSMC control algorithms for the four rigid body satellite attitude consensus tracking.

5.3.1

Nonsingular Fast Terminal Sliding Mode

The nonsingular fast terminal sliding mode can be defined by the following nonlinear differential equation: s = x + 1 sign(x) + 2 x q
p

(5.42)

152 where x  R and 1 , 2 are positive constants. The positive odd integers p, q are chosen such that 1 < p/q < 2. We define the fast terminal sliding mode si  Rm for the i'th satellite in the formation as: ^i ai1 = i + i si = ai2 +  i (ai1 ) = ai1 + i1 sign(ai1 )
p

(5.43)

i (ai2 ) = i2 aiq2

(5.44)

where i = 1, 2, ..., n. i (ai1 ) and i (ai2 )  Rm . i1 and i2 are positive constants for the designer. Defining  = (1 T , 2 T , ..., n T )T and s = (s1 T , s2 T , ..., sn T )T , we have s=+ The time derivative of the sliding mode Eq. (5.45) is given by   + s = (5.46) (5.45)

5.3.2

Fault Estimation by Fuzzy Logic System

The continuous nonlinear function i of each satellite can be approximated by the fuzzy logic system [Wang 1997]. ^ i = i T i (x) (5.47)

where F is the vector of the fuzzy basis function and is assumed to be fixed, while the
T parameters F are the variable which will be designed by adaptive laws. It is assumed that i

there exists an optimal fuzzy logic system to learn the nonlinear terms i such that i - ^ i =  (5.48)

where  is the approximation error and is bounded. Approximation errors can be reduced by increasing the number of fuzzy rules.

153 In order to decrease the number of fuzzy rules needed, we use the nonsingular fast terminal sliding surface s instead of the state x for the adaptive parameters. Then, the adaptive parameters F are updated by the following adaptive laws:
-1 i = i M2i 2 A   1 si N i=1 P l=1

(5.49) (5.50)

 i ( si ) = where i is a positive constant.

µAil (si )
N i=1

µAil (si )

In order to guarantee that the estimated Fuzzy Logic System parameters remain within some known bounded sets, a smooth projection is considered in this chapter. Let i be the
 estimation of the optimal weight matrix i , and define a smooth projection of i as:

i (i ) = i = i,jk (i,jk ) , j = 1, 2, ..., m, k = 1, 2, ..., N1

(5.51)

Each projection operator i,jk is a real-value smooth nondecreasing function defined by i,jk (i,jk ) = i,jk , i,jk  [imin , imax ] i,jk (i,jk )  [imin - M i , imax + M i ] ~i = i  - i ,  ~i = i  - i , and Define  1 V i = i
m N1 0 ~i 

j =1 k =1

( i,jk - i,jk ( i,jk - i,jk )di,jk , i = 1, 2, ..., n

(5.52)

~i,jk for   [imin, where, Vi is positive definite with respect to  ]. Furthermore, i,jk imax  = - 1 V i i
m N1

~i,jk   , i = 1, 2, ..., n  i,jk
j =1 k =1

(5.53)

Assumption 4:  is bounded such that i  M i (i = 1, 2, ..., n), where M i is a positive constant.
 Assumption 5: The optimal weight matrix i (i = 1, 2, ..., n) lies in a known bounded

set W i defined by
     i  W i = i : imin  i,jk  imin , j = 1, 2, ..., m, k = 1, 2, ..., N1   where imin and imax are known constants, respectively.

(5.54)

154

5.3.3

Nonsingular Fast Fuzzy Terminal Sliding Mode Controller

The controller design for the i'th satellite in the formation is now given by rwi =  ¯i = q ¨d - Ki1 si - Ki2 si  - 1 2- T a - i  i - i i2 i2 (5.55)

where Ki1 and Ki2 are designed parameters.  is p/q . i defined by [Hou et al. 2009] i  i tanh( 3Ku i si ) i (5.56)

Remark 2 : The controller consists of three components: 1. The nonlinear compensator q ¨d is applied to compensate for the desired satellite dynamics, motivated by the fact that when the attitude of each satellite in the formation reaches the desired trajectory of the formation, station-keeping errors and formation-keeping errors are zero. 2. The nonlinear
1 2- feedback Ki1 si + Ki2 si  +  a is used to drive the satellite attitude to the sliding surface 2 i2 T back to zero. 3. The robust term i + i i is used to counteract the external disturbance

and unknown system uncertainties due to actuator faults. Remark 3 : The proposed approach has two modes; in one, the uncertain terms are
T learned by the fuzzy logic system i i ; in the other, a robust controller is used that is

stable for all possible values of the uncertainty. The robust controller i is used when the term approximated by the fuzzy logic system grows above a given threshold. i is a positive constant satisfying i  dM i .  is a positive scalar. Ki1 and Ki2 are positive definite, diagonal and constant matrices. The proposed controller can provide stability in both the reaching phase and the sliding phase, which is guaranteed by the Lyapunov theory described in the next subsection. Remark 4 : The controller parameters Ki1 and Ki2 determine the accuracy of the sliding manifold, i.e. the smaller the sliding manifold, the bigger the controller parameters Ki1 and Ki2 required. The parameters i1 , i2 , p, and q determine the final accuracy of the attitude tracking error ai1 , i.e. the smaller the attitude tracking error ai1 , the bigger the parameters i1 , i2 , and  required. Larger parameters require more control input. In practice, there should be a compromise between the tracking accuracy and control input because of limited solar power supplies on the satellites.

155

5.3.4

Stability Analysis

Theorem 2: In the system Eq. (5.27), the nonsingular fast fuzzy terminal sliding control laws defined by Eqs. (5.55-5.56), with adaptive control laws given by Eq. (5.49) guarantee that all the signals of the closed loop system are bounded during actuator faults. Proof of Theorem 2: The dynamics equations for the absolute errors of the i'th satellite can be written as: qi e = e1i e  i1 = ei2 q i e = e2i i = 1, 2, ..., n (5.57) (5.58)

i e ) + i + i + i , e  i2 = -x ¨id + fi (qi e , q F = (f1 T , f2 T , ..., fn T ),  ¯ =

Define E1 = (e11 T , e21 T , ..., en1 T ), E2 = (e12 T , e22 T , ..., en2 T ), Qd =
T T T (¨ q1 ,q ¨2 , ..., q ¨n ), T T T (¯ 1 , ¯2 , ...,  ¯n ),



=

T T T 1 , ¯2 , ...,  ¯n ). The Eqs. (5.57) can be expressed in (i 1 T , i 2 T , ..., in T ) and  = (¯

terms of the aforementioned quantities as follows:  1 = E2 E  2 = -Qd + F +  +  +  E (5.59)

Denote M1 = (kp L + K )  I3 . Eqs. (5.39) and (5.40) can be expressed in terms of the aforementioned quantities as follows: A1 = M1 E1 A2 = M1 E2 The dynamics equations for A1 and A2 are defined as:  1 = A2 A  2 = -Qd + F +  +  +  M2 A
-1 respectively, where M2 = M1 .

(5.60)

(5.61)

Using Eqs. (5.46) and (5.61), we obtained ¯ ¯ + M2  M2 s  = M2 
-1  1 + M2 2 A  = M2 A 1 (-Qd + F +  +  +  )

(5.62)

156 Using the approximation property of Fuzzy Logic Systems, the unknown function fi (i = 1, 2, ..., n) can be approximated over the compact set d by Eqs. (5.47) and (5.49). Substituting the control law Eq. (5.55) into the error dynamics Eq. (5.62) yields the following dynamic equation for sliding surface s. ¯ ¯ + M2  M2 s  = M2   1 + M2 2 A  -1 (-Qd + F - Fd + Fd - T  - K1 s - K2 s = M2 A 1 - 1  2- A -  +  +  ) 2 1

~T  - K1 s - K2 s -  +  +  +  )  -1 ( +  = M2 2 A 1

(5.63)

T T T  = (1 T , 2 T , ..., n T ),  = (1 T , 2 T , ..., n T ),  = diag (1 , 2 , ..., n )),  =  diag (1 T , 2 T , ..., n T )),  =  -  , and  = (1 T , 2 T , ..., n T ).

where  = -Qd + F - Fd and K1 = (K11 T , K21 T , ..., Kn1 T ), K2 = (K12 T , K22 T , ..., Kn2 T ),

Consider the following Lyapunov function candidate 1 V = sT M2 s + 2 Thus, the time derivative of V is obtained as
n n

V i
i=1

(5.64)

 = sT M2 s V +
i=1

 V i

(5.65)

Due to the fact that ~T  - 1  -1  s M2 2 A 1 i
T m N1

 = 0 ~F   i,jk i,jk
j =1 k =1

(5.66)

Substituting Eqs. (5.53) and (5.63) into Eq. (5.65), we obtain:
-1 T T ~T T T  T  = 2 A  V 1 M2 (s  + s   - s K1 s - s K2 s - s 

1 + s ( +  +  ) - i
T

m

N1

 ) ~F   i,jk i,jk
j =1 k =1

 -1 M2 (sT  - sT K1 s - sT K2 s - sT  = 2 A 1 + sT ( +  +  )) (5.67)

157 Using the inequality in the reference [Lee & Kim 2000], it is easy to obtain that 0  -sT  + sT ( +  +  )  n Using the well-known inequality:     ( c5 s -  ) T ( c5 s -  )  0 2 c5 2 c5 The following inequality can be rewritten as 0  s T   c5 sT s +  2M 4 c5 (5.70) (5.69) (5.68)

where c5 is a positive constant satisfying c5 < min (K1 ) with min (K1 ) being the minimum eigenvalue of the matrix K1 . Eq. (5.67) becomes   2 A  -1 M2 (-(min (K1 ) - c5 )sT s + c4 - sT K2 s ) V 1
2 -1   -2 A 1 M2i |s|  0

(5.71)

where c4 = n +

2M 4c5

is a positive constant.

Inequality Eq. (5.71) implies that the sliding surfaces are bounded. Meanwhile, the aggregated attitude tracking errors ai1,j and ai2,j are also bounded. The state errors qi e and q i e are bounded. All signals in the closed-loop system are uniformly ultimately bounded. Thus, we have demonstrated the stability of the overall closed-loop system and have given the stability proof.

5.4

Results and Discussion

To study the effectiveness and performance of the proposed controller, a detailed response is numerically simulated using the set of governing system equations of motion Eq. (5.27) in conjunction with the control laws Eqs. (5.55-5.56). The system and the controller design parameters for the four satellites (the parameters based on the reference [Wang et al. 1999]) along with the initial conditions used in the numerical simulations are shown

158 in Tables 5.1 and 5.2. The total disturbances acting on the follower spacecraft include gravity gradient torque M and external disturbances dM . The external disturbances are chosen as (0.01)[sin(0.8t); cos(0.5t); cos(0.3t)] Nm. The dead zone and friction force on the reaction wheels are 1V and 0.002 Nmrespectively. The maximum value for control input noise is 0.005 Nm.

Table 5.1: Microsatellites Parameters Parameters Mass (kg) µe (km3 s-2 ) rL1 , rL2 , rL3 , rL4 (km) Desired Attitude Trajectory Initial Relative Angular Velocity Initial Quaternion (Satellite 1) Initial Quaternion ( Satellite 2) Initial Quaternion (Satellite 3) Initial Quaternion (Satellite 4) Values 20, 10, 11, 12 398600 6878 qd = [0, 0.05cos(0.2t), 0.05sin(0.2t)]T  (0) = (0, 0, 0)T (rad/s) q(10) = (0.3, -0.4, 0.4)T q(20) = (0.35, 0.3, 0.2)T q(30) = (-0.3, 0.3, 0.2)T

Moment of Inertia Satellite 1 (kgm2 ) Moment of Inertia Satellite 2 (kgm2 ) Moment of Inertia Satellite 3 (kgm2 ) Moment of Inertia Satellite 4 (kgm2 ) Moment of Inertia Wheels (kgm2 )

q(40) = (0.3, -0.3, 0.2)T J1 = diag (0.73, 0.55, 0.63) J2 = diag (0.36, 0.27, 0.31) J3 = diag (0.38, 0.3, 0.33) J4 = diag (0.48, 0.33, 0.35) Jw = 10-5 diag (5.12, 5.12, 5.12, 5.12)

The communication graph for the four satellites and the virtual leader in Case 1 and Case 3 are shown in Fig. 5.1. In Case 1, the virtual leader's information is known by satellites one and four. In Case 3, the virtual leader's information is only known by satellite one. The information exchange among satellites is represented by a graph with the weighted

159 Table 5.2: NFFTSMC Controller Parameters for Numerical Analysis Parameters kp , ki q, p i , i i1 , i2 Ki 1 , Ki 2 0 , imin , imax , i ¯1 and A ¯2 defined by adjacency matrices A   0 0.5 0 0     0.5 0 0 0 , ¯1 =  A   0 0 0 0.7   0 0 0.7 0 Values 0.1, 0.007;0.08, 0.001;0.09, 0.007;0.09, 0.007 9, 11 0.01, 0.001 0.00001, 100 diag (0.08, 0.08, 0.08), diag (0.28, 0.28, 0.28) 0, -200, 200, 100

Remark 5 : kp and ki are used to construct the satellite consensus attitude error, and are given in Table 2 for four satellites of mass 20 kg, 10 kg, 11 kg, and 12 kg. q , p, i1 and i2 are the parameters to design the sliding manifold. Ki1 , Ki2 , i and i determine the tracking accuracy and the control input value. 0 , imin , imax , i are used to design the

0 0.5 0 0     0.5 0 0.6 0   ¯2 =  A    0 0.6 0 0.7   0 0 0.7 0



 (5.72)

fuzzy logic system. Increasing the adaptive parameter i enables the system to handle larger faults, but this also requires a larger control input, so i should not be made too large. Seven Gaussian membership functions are defined the same as those in the other chapters.

5.4.1

Ideal Conditions

In this section, we present the simulation results for Case 1 as follows: for a pyramid configuration of reaction wheels and a desired trajectory qd , after t = 70s, t = 100s and

160

Lr

Lr

1

2

1

2

3

4

3

4

Figure 5.1: Undirected Graph of Four Satellites and Virtual Leader Satellite, Case 1 (Left) and Case 3 (Right)

t = 120s the wheels of satellites 1, 3 and 4 only supply 50% of their designed speed, respectively. There is no fault within satellite 2. Fig. 5.2 shows the formation-keeping errors in the satellite formation flying system using a NFFTSMC controller without external disturbances dM (a fault free case). The dead zone, friction of the reaction wheels, input noise maximum values and other initial conditions are the same as the above fault case. The station-keeping tracking errors, wheel speeds, wheel voltages, wheel torques and angular velocities of satellite 1 are shown in Fig. 5.3. The simulation results show that station keeping tracking errors, wheel speeds and wheel voltages are much smaller than those in Fig. 5.5 because there are no external disturbances in Case 1.

5.4.2

Realistic Conditions

External disturbances are considered in Case 2. The other conditions are the same as Case 1. Simulation results will clearly establish the robustness of the proposed controller with external disturbances. Figs. 5.4 and 5.8 show the formation-keeping and angular velocity tracking errors in the satellite formation flying system using a NFFTSMC controller for each satellite (i = 1, 2, 3, 4), respectively. The station-keeping tracking error, wheel speed. wheel

161

q
0.5

vij1
q
v12

q
0.8

vij2

Formation Keeping Tracking Errors

0.4 0.3 0.2 0.1 0 -0.1 -0.2 -0.3 -0.4

q q q q q

Formation Keeping Tracking Errors

v13 v14 v23 v24 v34

0.6 0.4 0.2 0 q -0.2 -0.4 -0.6 -0.8 -1 q q q q q 0 50 100 time [s]
v12 v13 v14 v23 v24 v34

0

50

100 time [s]

150

200

150

200

qvij
1

3

Formation Keeping Tracking Errors

qv12 0.8 q q q q 0.4
v13 v14

0.6

qv23
v24 v34

0.2

0

-0.2

-0.4

0

50

100 time [s]

150

200

Figure 5.2: Formation-keeping Tracking Errors using NFFTSMC for three vector quaternion components, qv ij denotes the error for each pair of satellites i and j (Case 1: fault free case without external disurbances)

162

1

qie and qi4e (i=1)

400 200 q
e1 e2

 (i=1)
i

Station Keeping Errors

q 0.5

qe3 qe4

Wheel Speed [rad/s]

0 -200 -400 -600 -800 -1000   

0

1

2
3 4

-0.5

0

50

100 time [s]

150

200

-1200

0

50

100 time [s]

150

200

e (i=1)
5

ai


0.08 0.06 0.04

rwi

(i=1)
1 
2

Wheel Voltage [V]

0

3 4

Wheel Torque [Nm]

0.02 0 -0.02 -0.04 -0.06 -0.08 -0.1 0.1 0 -0.1 0 1 time [s] 100 time [s] 2

-5

e e e

1 2 3 4

-10

e

-15

0

50

100 time [s]

150

200

-0.12

0

20

40

60

80

120

140

160

180

200

0.06

 (i=1)
ie

Angular Velocity Errors [rad/s]

0.04

0.02

0

-0.02

 

e1 e2

-0.04

e3

-0.06

0

50

100 time [s]

150

200

Figure 5.3: Station-keeping Tracking Error, Wheel Speed, Wheel Voltage, Wheel Torque and Angular Velocity Simulation Results of Satellite 1 using NFFTSMC with four reaction wheels per satellite (Case 1: fault free case without external disturbances)

163

q
0.5

vij1

q Formation Keeping Tracking Errors
qv12 q q q
v13 v14 v23 v24 v34

0.8 0.6 0.4 0.2 0

vij2

Formation Keeping Tracking Errors

0.4 0.3 0.2 0.1 0 -0.1 -0.2 -0.3 -0.4

q q

q -0.2 -0.4 -0.6 -0.8 -1 q q q q q 0 50 100 time [s] 150

v12 v13 v14 v23 v24 v34

0

50

100 time [s]

150

200

200

q
1

vij3
qv12 q q q q

Formation Keeping Tracking Errors

0.8

v13 v14

0.6

qv23
v24 v34

0.4

0.2

0

-0.2

-0.4

0

50

100 time [s]

150

200

Figure 5.4: Formation-keeping Tracking Errors using NFFTSMC for three vector quaternion components, qv ij denotes the error for each pair of satellites i and j (Case 2: fault case with external disturbances)

164

q and q
1

ie

i4e

(i=1)
1500

i (i=1)

q

e1 e2 e3 e4

1000

Station Keeping Errors

0.5

Wheel Speed [rad/s]

q q q

500

0

0

-500

   

1 2 3 4

-1000

-0.5

0

50

100 time [s]

150

200

-1500

0

50

100 time [s]

150

200

e (i=1)
15

ai

0.06 0.04

rwi (i=1)

10 0.02 5

Wheel Torque [Nm]

Wheel Voltage [V]

0 -0.02 -0.04 -0.06 -0.08 -0.1 -0.12    
1 2 3 4

0

-5

e1 e2

-10

e e

3 4

-15

0

50

100 time [s]

150

200

0

50

100 time [s]

150

200

Figure 5.5: Station-keeping Tracking Error, Wheel Speed, Wheel Voltage and Wheel Torque Simulation Results of Satellite 1 using NFFTSMC with four reaction wheels per satellite (Case 2: fault case with external disturbances)

165

q and q
ie
1.2

i4e

(i=2)
0.08



rwi

(i=2)


1

0.06

1 2 3 4

0.05 0 -0.05

   0 time [s] 5

Station Keeping Errors

0.8

Wheel Torque [Nm]
0 50 100 time [s] 150 200

0.04

0.6

0.02

0.4

0

0.2

-0.02

0

-0.04

-0.2

-0.06

0

50

100 time [s]

150

200

q and q
1

ie

i4e

(i=3)
0.06



rwi

(i=3)

Station Keeping Errors

q q 0.5 q q

0.04

e1

Wheel Torque [Nm]

e2 e3 e4

0.02

0

-0.02 0.05 -0.04 0 -0.06 -0.05 0 5 time [s] 0 50 100 time [s] 150 200    
1 2 3 4

0

-0.5

0

50

100 time [s]

150

200

-0.08

q and q
1

ie

i4e

(i=4)
0.08



rwi

(i=4)


0.8

0.06 q
e1 e2 e3 e4

1 2



Station Keeping Errors

0.6

q q

Wheel Torque [Nm]

0.04 0.02 0 -0.02 -0.04 -0.06 -0.08 0.01 0

3 4

0.4

q

0.2

0

-0.2

-0.01 196 198 time [s] 200 150 200

-0.4

0

50

100 time [s]

150

200

0

50

100 time [s]

Figure 5.6: Station-keeping Tracking Error and Wheel Torque Simulation Results of Satellites 2, 3 and 4 using NFFTSMC with four reaction wheels per satellite (Case 2: fault case with external disturbances)

166

q and q
ie
1

i4e

(i=2)
0.02 0.015



rwi

(i=2)

Station Keeping Errors

x 10 0.8 0 -1 0.6 -2 0.4 -3 0.2 -4 99

-3

Wheel Torque [Nm]

0.01 0.005 0 -0.005 -0.01 -0.015 1 2 3 4 80 90 100 110 time [s] 120 130 140 150

qe1 qe2 qe3 qe4

99.5

100

100.5

101

0 70 80 90 100 110 time [s] 120 130 140 150 -0.02 70

q and q
ie
1 x 10 6 0.8 4 0.6 2 0 0.4 -2 -4 0.2 -6 98 0 90 95 100 105 100 102
-3

i4e

(i=3)
0.04 0.03 0.02 0

rwi (i=3)
1 2 3 99.5 100 100.5 101 4

Station Keeping Errors

Wheel Torque [Nm]

qe1 qe2 qe3 qe4

0.02 0.01 0 -0.01 -0.02 -0.03 90

-0.02 99

104

110 115 time [s]

120

125

130

135

95

100

105

110 115 time [s]

120

125

130

135

q and q
1.2

ie

i4e

(i=4)
0.07 0.08 0.06 0.04 0.02 0 -0.02 0.02 0.01 0 119 119.5 120



rwi

(i=4)

1

0.06 x 10
-3

Station Keeping Errors

0.8

5

qe1 qe2

Wheel Torque [Nm]

0.05 0.04 0.03

1 2 3 4

0.6

0

qe3 qe4

0.4 -5 0.2 -10 115 0 100 105 110 115 time [s] 120 125 130 120 125

120.5

121

-0.01 -0.02

100

105

110

115 time [s]

120

125

130

Figure 5.7: Station-keeping Tracking Error and Wheel Torque Simulation Results of Satellites 2, 3 and 4 using NFFTSMC with four reaction wheels per satellite (Case 2: fault case with external disturbances) [Zoom-in Results]

167

0.06

ie (i=1)
e1 e2 e3

0.02  0.01 0 -0.01 -0.02 -0.03

ie (i=2)

Angular Velocity Errors [rad/s]

0.04

 

0.02

0

-0.02

Angular Velocity Errors [rad/s]

 -0.04 -0.05 -0.06 

e1

e2
e3

-0.04

-0.06

0

50

100 time [s]

150

200

0

50

100 time [s]

150

200

 (i=3)
0.05 0.04

ie

 (i=4)
0.04  
e1

ie

Angular Velocity Errors [rad/s]

0.03 0.02 0.01 0 -0.01 -0.02 -0.03 -0.04 -0.05 0 50 100 time [s] 150

e2
e3

Angular Velocity Errors [rad/s]

0.03 0.02 0.01 0 -0.01 -0.02 -0.03 -0.04

e1 e2 
e3

200

0

50

100 time [s]

150

200

Figure 5.8: Angular Velocity Errors using NFFTSMC for four satellites, ie denotes the angular tracking error for each satellite i (Case 2: fault case with external disturbances)

168

0.5

qvij

1

qvij
0.8

2

q

Formation Keeping Tracking Errors

Formation Keeping Tracking Errors

v12 v13 v14 v23 v24 v34

0.4 0.3 0.2 0.1 0 -0.1 -0.2 -0.3 -0.4

q q q q q

0.6 0.4 0.2 0 q -0.2 -0.4 -0.6 -0.8 -1 q q q q q 0 50 100 time [s]
v12 v13 v14 v23 v24 v34

0

50

100 time [s] 1

150

200

150

200

qvij Formation Keeping Tracking Errors

3

qv12 0.8 q q q q 0.4
v13 v14

0.6

qv23
v24 v34

0.2

0

-0.2

-0.4

0

50

100 time [s]

150

200

Figure 5.9: Formation-keeping Tracking Errors using the Proposed Control Law without FLS for three vector quaternion components, qv ij denotes the error for each pair of satellites i and j (Case 2: fault case with external disurbances)

169 voltage and wheel torque of satellite 1 are shown in Fig. 5.5. The station-keeping tracking errors and wheel torques of satellites 2, 3, and 4 are given in Figs. 5.6 and 5.7. It is found that the proposed controller can still drive the station-keeping attitude tracking errors and formation-keeping errors to the neighborhood of zero even during faults. Therefore, the proposed controller can still provide control for a group of satellites during actuator faults. The absence of a fuzzy logic system causes severe degradation of the formation-keeping tracking performance due to the fault (see in Fig. 5.9). The above results shows that the fault causes the trajectory to leave the convergence region and the decentralized NFFTSMC controller has the better ability to steer the states of each satellite back to the convergence region. Remark 6 : There is chattering in the control torques of satellites 3, 4 by increasing the precision of tracking errors (Fig. 5.9). In the future work, the controller will be improved to determine the influence of chattering and increase the precision of tracking errors under the actuator faults and external disturbances.

5.4.3

Different Information Topology

In this section, we test the controller's robustness using a different virtual leader topology. This case uses the same initial conditions as Case 2, the only difference being the ¯2 . communication graph which is now using A Figs. 5.10 and 5.11 show the formation-keeping and station-keeping errors. It is found that the proposed controller can still drive the formation-keeping and station-keeping errors to the neighborhood of zero even when faults occur. Since the desired tracking trajectories of satellite 2, 3 and 4 are generated by satellite 1, this causes a severe degradation of the tracking performance due to the difference in information topology. We have considered multiple situations due not only to the local subsystem dynamics but also to the different interconnectionn between the subsystems. It has been shown the proposed controller is robust in the presence of both actuator faults and different information topologies.

170

qvij
0.5

q
0.8

1

vij2

q

Formation Keeping Tracking Errors

Formation Keeping Tracking Errors

v12 v13 v14 v23 v24 v34

0.4 0.3 0.2 0.1 0 -0.1 -0.2 -0.3 -0.4

q q q q q

0.6 0.4 0.2 0 q -0.2 -0.4 -0.6 -0.8 -1 q q q q q 0 50 100 time [s] 150
v12 v13 v14 v23 v24 v34

0

50

100 time [s] 1

150

200

200

q Formation Keeping Tracking Errors

vij3
qv12 q q q q

0.8

v13 v14

0.6

qv23
v24 v34

0.4

0.2

0

-0.2

-0.4

0

50

100 time [s]

150

200

Figure 5.10: Formation-keeping Tracking Error Simulation Results using NFFTSMC for three vector quaternion components, qv ij denotes the error for each pair of satellites i and j (Case 3: fault case with external disturbances and a different information topology)

171

q and q
1

ie

i4e

(i=1)
1.2

q and q
ie

i4e

(i=2)

1

Station Keeping Errors

e1 e2 e3 e4

Station Keeping Errors

q 0.5 q q q

0.8 qe1 qe2 0.4 qe3 qe4 0.2

0.6

0

0

-0.5

0

50

100 time [s]

150

200

-0.2

0

50

100 time [s]

150

200

q and q
1

ie

i4e

(i=3)
1

q and q
ie

i4e

(i=4)

0.8

Station Keeping Errors

e1 e2

Station Keeping Errors

q 0.5 q

q 0.6 q q 0.4 q

e1 e2 e3 e4

qe3 qe4

0.2

0

0

-0.2

-0.5

0

50

100 time [s]

150

200

-0.4

0

50

100 time [s]

150

200

Figure 5.11: Station-keeping Error Simulation Results using NFFTSMC with three vector and one scalar quaternion components per satellite (Case 3: fault case with external disturbances and a different information topology)

172

5.5

Conclusions

The primary contribution of this chapter is the development and analysis of a decentralized, attitude coordination control law that provides stability and convergence for attitude synchronization. A nonsingular fast terminal sliding mode manifold is constructed based on the aggregated attitude tracking error that includes station-keeping and formation-keeping errors. A controller using a hyperbolic tangent function is applied to counteract bounded time-varying external disturbances. The stability in both the reaching phase and the sliding phase can be guaranteed by the Lyapunov theorem. Several scenarios of actuator faults with input noise, dead-zone, and friction are considered in this chapter, and simulation results clearly establish the robustness of the proposed control methodologies using nonsingular fast terminal sliding mode and fuzzy logic systems in tracking the attitude of formation flying satellites in the presence of reaction wheel faults and external disturbances.

Chapter 6

Fault Detection, Identification and Fault Tolerant Control of Formation Flying

6.1

Introduction

In Chapter 2 and Chapter 3, the feasibility of performing satellite formation flying control using AFTSMC and 2nd SMC was studied and evaluated. 2nd SMC is the best controller compared with AFTSMC, ASMC, SMC, and PID. This chapter evaluates the performance of this best control strategy in the presence of faults or failures integrated with FDI. The 2nd SMC control design employed in the previous chapters is extended to handle the presence of large faults. The proposed intelligent diagnosis and control system should be able to adapt to the mostly nonlinear process behavior and perform a fault diagnosis to request maintenance and a decision. The main contributions of this study relative to other works are as follows: 1. A FDI and FTC methodology (shown in Fig. 6.1) is proposed for thruster and sensor faults, which maintain precise formation-keeping in the presence of J2 perturbations, and position offsets, after an initial deployment that tends to disperse the formation. Simulation results are compared with sliding mode observer based [Alwi et al. 2008] fault detection and isolation methods. 2. The active fault tolerant control uses a second order sliding mode control scheme for precise formation keeping in the presence of unknown time-varying satellite dynamics, J2 perturbations, and position offsets after an initial deployment that tends to disperse

174

Figure 6.1: Fault diagnosis and control methodology for nonlinear system (SFF: satellite formation flying; FTC: fault tolerant control)

the formation. FDI uses an integrated fuzzy identifier and second order sliding mode observer. This proposed control integrated diagnostics and control approach gives higher formation keeping precision and effectiveness than using other FDI methods integrated with the proposed control scheme.

The system model and its equations of motion in the case of thruster and sensor fault is presented in Section 6.2. In section 6.3, FDI and FTC law are derived. In Section 6.4 numerical simulation is carried out for a detailed assessment of the proposed control strategy, and the effects of different failure scenarios on the controller performance is examined. Finally, the findings of the present study are summarized in Section 6.5.

175

6.2

Problem Statement

The most common spacecraft failures are due to design flaws associated with the introduction of new, untried and inadequately tested technologies. Therefore, it is very important to design an intelligent fault diagnosis control to deal with thruster and sensor faults. The satellites are modeled as point masses and therefore the rotational dynamics of the leader and follower satellite are not taken into account. The orbital equations of motion can be written as Eqs. (2.1)-(2.5). To facilitate the control design procedure, we re-formulate the relative dynamics of the SFF model in a state-dependent parameterized form as follows,        0 x 0 0 0 1 0 0 x                0   0 0 0  y 0 1 0  y                   0   0 0 0  z 0 0 1  z       +     =       2   (rL +x) 1 2 µ [ - ] - 2 n x         x x  3n 0 0 0 2n 0 ¨ 2 3 rF     rL            µy 2   0 0 0 -2n 0 0   y  y n y - r3    ¨         F µz 2 2 z  0 0 -n 0 0 0 z ¨ n z - r3 F   0 0 0         0 0 0        D u tx Fx          0 0 0   1        u + D  + (6.1)   F y   ty  mF   1 0 0        u Dtz  Fz    0 1 0    0 0 1 or in a more general state space form as  = AX + E (X ) + 1 B [u + Dt ] X mf

(6.2)

 = is the input matrix, and u  R3 = [uF x , uF y , uF z ]T is the vector of control inputs.  n = µe /rp 3 , where rp is the orbital radius of the leader spacecraft. Define f (X, u) =

the relative equations of motion, E  R6 represent the lumped nonlinearities, B  R6×3

where X  R6 = [x, y, z, x,  y,  z  ]T is the state vector, A  R6×6 is a Hurwitz matrix of

176 E (X ) +
1 mf

Bu, the system model given in Eq. (6.2) with thruster and sensor fault is

represented as

 (t) = AX + f (X, u) + B (t - tf )Tt + BDt (t) X Y = CX + (t - tf )Ts + Ds (t)

(6.3) (6.4)

where (t-tf ) represents the fault time profile and tf denotes the unknown fault-occurrence time. Tt represents the thruster fault and is bounded. where Y is the sensor-measured spacecraft state and Ts represents the sensor fault and is bounded. Dt represents J2 disturbances. Ds represents the disturbances of sensors. Tt < d1 , Ts < d2 , Dt < d 3 , Ds < d 4 (6.5)

where d1 , d2 , d3 and d4 are positive constants. We assume the nonlinear system in this chapter is observable and the nominal closedloop system is stable. The thruster and sensor faults do not occur simultaneously. The function f (X, u) is Lipschitz in X with Lipschitz constant lt . ^ u )  lt X f (X, u) - f (X, ~ = X -X ^. where X We assume the nominal closed-loop system with a nominal controller is asymptotically stable. The closed-loop system's linearized Jacobian Jn is a Hurwitz matrix. The normal tracking sliding mode control design without fault uses the following process: First, define a linear switching function as  (t) = Me(t) + e  (t) (6.7) (6.6)

which ensures that the reduced-order system on the sliding mode  = 0 is asymptotically stable, where M is a diagonal constant matrix with positive diagonal elements and e(t) is the tracking error defined as e(t) = X (t) - xd (t).

177 xd (t) is the desired trajectory. x  d (t) is the first derivation of xd (t). Second, the normal controller objective (un ) for formation keeping of the follower satellite relative to the leader satellite requires that the actual position of the follower track the desired relative position trajectory. Third, all signals in the closed-loop system are uniformly, and ultimately bounded. The tracking errors converge to a small neighborhood near zero. If these thruster and sensor faults are not negated using a fault tolerant control mechanism, the consequences can range from complicated reacquisition of spacecraft orbit to catastrophic ending of the mission. The solution requires an `intelligent' software that monitors behavior of components such that local faults are prevented from developing into failures that can lead to total mission loss. FTC algorithms will be developed in the following section.

6.3

Fault Detection and Accommodation Scheme

We now summarize a methodology for designing a fault detection and accommodation scheme, which consists of a second order sliding mode observer and a fuzzy identifier. The proposed fault accommodation scheme is designed such that it is capable of detecting and identifying unknown faults.

6.3.1

Fault Detection, Identification and Stability Analysis

Intelligent and learning based techniques are more suitable and promising when accurate mathematical models are not available. These methods monitor and approximate any fault behavior in the dynamic system by using on-line approximation and adaptive nonlinear estimation techniques. Fault detection and isolation schemes (FDI) have been researched extensively although little effort has been made in the area of autonomous fault tolerant control systems for formation flying of satellites. A second order sliding mode observer using a fuzzy identifier is proposed in this chapter.

178 6.3.1.1 Fault Detection

The second order sliding mode observer is developed based on [Davila et al. 2005]. This method was used for robot manipulator fault detection in [Brambilla et al. 2008] and used for satellite in [Wu & Saif 2007]. The second order sliding mode observer is used to observe the system states with modeling uncertainties and disturbance prior to the occurrence of any fault. Based on Eq. (6.2), a nonlinear thruster fault detection observer is proposed as 1 =   ^ ^2 + 1 2 = f ( ^t  ^ ^1 ,  ^ 2 , u) + T where  ^1 and  ^2 are the state estimations. The correction variables 1 and 2 are of the form 1 =  | ~1 |0.5 tanh( ~1 ) ^t = 1 tanh( 2 = T ~1 ) (6.10) (6.11) (6.8) (6.9)

Taking the estimation errors as  ~1 = X1 -  ^1 ,  ~2 = X2 -  ^2 (residuals) , the error equations are written as 1 =   ~ ~2 -  | ~1 |0.5 tanh( ~1 ) 2 = G(  ~ ^1 ,  ^2 , u) - 1 tanh( ~1 ) where Gs ( ^1 ,  ^2 , u) = f (1 , 2 , u) - f ( ^1 ,  ^ 2 , u ). Based on Eq. (6.2), a nonlinear sensor fault detection observer is proposed as  s1 =   ^ ^ s 2 + s 1  s 2 = f (  ^ ^s 1 ,  ^ s 2 , u ) + s 2 ^ = Cs + T ^s Y (6.14) (6.15) (6.16) (6.12) (6.13)

where  ^s1 and  ^s2 are the state estimations, s1 and s2 are the correction variables. ~ =Y -Y ^ (residual) and  Y ^s = [ ^s 1 ;  ^s2 ].  ~s 1 = Y 1 -  ^s 1 ,  ~s 2 = Y 2 -  ^s2 . Y = [Y1 ; Y2].

179 The correction variables s1 and s2 are of the form ~1 |0.5 tanh( ~s 1 ) s 1 =  | ~s 1 ) s 2 = 1s tanh( Taking the estimation errors equations as  s1 =   ~ ~s2 -  | ~s1 |0.5 tanh( ~s 1 )  s 2 = G(   ~ ^s 1 ,  ^s2 , u) - 1s tanh( ~s 1 ) where Gs ( ^s 1 ,  ^s2, u) = f (s1 , s2 , u) - f ( ^s 1 ,  ^ s 2 , u ). According to reference [Davila et al. 2005], , 1 , s , 1s can be chosen by G or Gs < gt   > or gs  2 (1 + gt  )(1 +  ) 1 - gt  1- 2 (1s + gs )(1 +  ) 1s - gs  1-


(6.17) (6.18)

(6.19) (6.20)

(6.21) (6.22) (6.23) (6.24) (6.25)

1 > gt  s >

1s > gs 

~ where  is a constant (0 <  < 1). Therefore,  ~ and Y

are semi-globally, uniformly,

~ M and Y ~ Y ~M (threshold bound chosen and ultimately bounded. We can find  ~ X by experiments). The decision for detecting a thrust and sensor fault is made when  ~ ~ ~ exceeds its threshold bound X M and Y exceeds its threshold bound Y~ M.

Remark. The proposed method differs from previously fault detection methodologies based on Kalman filters methods. Classic Kalman filters are designed for the linear systems while Extended Kalman filters (EKF) are used for nonlinear systems. EKF uses the linearized system model. Fault detectoin method using EKF might have large estimation errors and may not be as good as using the proposed method. Adaptive Kalman filters (AKF) do not need the linearized system model. However, the noise probability density function for AKF is assumed to be the normal distribution (Gaussian Noise). The proposed method does not require the noise to be "Gaussian Noise" and may enhance fault detection performance.

180 6.3.1.2 Fault Identification and Stability Analysis

For a real nonlinear system, it is quite difficult to determine a priori what class of faults may occur. As the fault is unknown, it is also difficult to isolate the fault function. We present several possible fault functions (constant, time-varying, and ramp fault) for fault reconstruction analysis. The sliding mode observer based fault reconstruction can use Eq. (6.11) for thruster fault reconstruction and also need to add the low pass filter [Edwards et al. 2007]. The sensor fault reconstruction based on sliding mode [Alwi et al. 2008] or other observer based method [Fragkoulis et al. 2011] needs to introduce a filter and reformulate the system to treat the sensor faults as thruster faults. Sensor fault reconstruction is more difficult than thrust fault reconstruction. However, in our proposed fault reconstruction scheme, we do not need to use an augmented system. It is well known that neural networks and fuzzy logic systems can estimate any continuous nonlinear function. Recurrent neural network based sensor and actuator fault detection and isolation schemes have already been applied to satellite attitude control systems [Talebi & Khorasani 2009]. The fuzzy identifier has been used as fault detection and isolation in reference [Laukonen et al. 1995, Diao & Passino 2004]. In this chapter, a fuzzy identifier [Wang 1995, Wang 1997] is used to determine the fault location and to estimate its magnitude. The fuzzy logic system is a collection of IF-THEN fuzzy rules such as: Rk : IF x1 is Ak 1, and, ··· , T HEN xn y is Ak n, is B k . (6.26)

The output of the fuzzy system (using singleton fuzzification, product inference and center average defuzzification) can be written as : yout =
P l l=1 F (X ) P l=1 N i=1 N i=1

µl Ail (xi )

µl Ail (xi )

= T 

(6.27)

where P is the total fuzzy rules number, the membership functions µA1l (x1 ) , ..., µAnN (xn ) (N is the number of membership functions) are Gaussian functions, and  is the fuzzy basis

181 function  l (x) =
N i=1 µAil (xi ) P N l=1 i=1 µAil (xi )

.

The thruster and sensor fault (Tt (X, u | t ) and Ts (X, u | s )) can be written as :
T Tt (X, u | t ) = t t (X, u) T Ts (X, u | s ) = s s (X, u)

(6.28)

^s ) to approximate sensor faults Ts (X, u | s ). ^s (X, ^ u| use T ^t ) =  ^T t (X, ^t (X, ^ u| ^ u) T t ^s ) =  ^T s (X, ^s (X, ^ u| ^ u) T s Define the optimal parameters of fuzzy systems

^t ) to approximate thruster faults Tt (X, u | t ) and ^t (X, ^ u| We use the fuzzy system T

(6.29)

^t ) - Tt (X, u | t ) ^ = arg min sup T ^t (X, ^ u|  t
t w ¯T X Dx

(6.30) (6.31)

^s ) - Ts (X, u | s ) ^ = arg min sup T ^s (X, ^ u|  s
s w ¯S X Dx

It is assumed that there exists the optimal fuzzy logic system to determine the nonlinear terms Tt and Ts such that ^ ) = wT ^t  (X, u |  Tt (X, u | t ) - T t

^ ) = wS ^s  (X, u |  Ts (X, u | s ) - T s

(6.32)

where wT and wS are approximation errors and bounded, i,e., wT  w ¯T and wS  w ¯S . The estimation of the nonlinear system can be given by  ^T t (X, ^ ^ + f (X, ^ u) + B  ^ u) X = AX t ^T s (X, ^ = CX ^ + ^ u) Y s (6.33)

~t =  ^t -  ^ ,  ~s =  ^s -  ^ , and by using ~ = Y -Y ^ , the fuzzy identifier update error as  Y t s

^ and Denoting the state estimation error and output estimation error as  ~ = X -X

182 Eqs. 6.3 and 6.33, the estimation errors of state and output corresponding to the possible types of faults are proposed as
T T  ^ ^ u) + B (t ^  = A  ~ ~ + f (X, u) - f (X, t (X, u) -  t t (X, u) + wT ) + BDt T  ^ ^ u) + B (T t (X, ^ u) -  ^ = A ~ + f (X, u) - f (X, t t (X, u) t T T ^ u) + wT ) + BDt + t t (X, u) - t t (X,

^ u) = A ~ + f (X, u) - f (X,
T ^ T s (X, ^ u ) + w S + Ds ~ = C Y ~ + s s (X, u) -  s

~T t (X, ^ u) + T t (X, u) - T t (X, ^ u) + wT )BDt + B ( t t t
T T T T  ^ ^ ^ ^ u) -  = C ~ + s s (X, s s (X, u) + s s (X, u) - s s (X, u) + wS + Ds

(6.34)

~T s (X, ^ u) + T s (X, u) - T s (X, ^ u ) + w S + Ds = C ~+ s s s

(6.35)

T T T T ^ u ) + wS  a ^ u ) + wT  a ¯S . ¯T and s where t s (X, u) - s s (X, t (X, u) - t t (X, ~t ,  ~s are updated by the following learning laws: The parameters 

J  ^  - 1 t = -1 ^t  J  ^ - 2  s = -2 ^s  where 1 > 0, 2 > 0, 1 > 0 and 2 > 0.

^t ~  Y ^s ~  Y (6.36)

Theorem 1: Consider the system Eq. (6.2). The fuzzy logic system defined by Eq. (6.28), with learning laws given by Eq. (6.36) guarantees the following property: the state and the output estimation errors are all UUB in the presence of unknown thruster and sensor faults as well as plant and sensor uncertainties and noise. (UUB: converges to a small neighborhood around zero by appropriately choosing the design parameters [Khalil 2002]). ~TY ~ is the fuzzy identifier's objective function. Proof of Theorem 1: In Eq. 6.36, J = 1 Y 2  -1 T T ^ ~T ~ ^  t = -1 (Y CJn ) t - 1 Y t (6.37)

 ^ ~ T -1 T T ~ ^  s = -2 (Y Ac ) s - 2 Y s  ~ ~ T ~ ^  t = l1 Y t + 1 Y t  ~ ~ T ~ ^  s = l2 Y s + 2 Y s

(6.38)

183 In order to examine the convergence properties of the estimation errors, we consider a positive-definite Lyapunov function candidate defined as 1 T V =  ~ P ~+ 2
3 T -1 ~ ~  ti 1 i ti + 3 T -1 ~ ~ si 2 i si

(6.39)

i=1

i=1

where P = P T is the positive-definite matrix satisfying the Lyapunov equation AT P + P A = -Q for the Hurwitz matrix A and the positive definite matrixes Q . Thus, the time derivative of V is obtained as 1 T   = 1 TP V ~ P ~+ ~ ~+  2 2 We obtain 1 T   = -1 ~T Q ~+  ~ P ~+ V 2 2
3 T  -1 ~ ~  ti 1 i ti + 3 T  -1 ~ ~ si 2 i si 3 T  -1 ~ ~  ti 1 i ti + 3 T  -1 ~ ~ si 2 i si

(6.40)

(6.41)

i=1

i=1

(6.42)

i=1

i=1

The time derivative of V can be written as  V 1 V 2 V 1 + V 2 + V 3 = V 1 T ~ Q ~ = -  2 1 T   ~ P ~ = 2
3 T  -1 ~ ~ ti 1 i ti + 3 T  -1 ~ ~ si 2 i si

(6.43) (6.44) (6.45) (6.46)

3 = V
i=1

i=1

Using Eqs. (6.34), (6.36) and (6.38), we get ~T t (X, 2 =  ^ u ) + B ( ^ u) + T t (X, u) - T t (X, ^ u ) + wT ) V ~T P (f (X, u) - f (X, t t t + BDt   ~
3

~t  ¯tM + a P ( lt  ~ + B (  ¯T + d3 ))
3

(6.47)

3 = V
i=1

~ti )) + ~T l1 1i -1 Y ~T Y ~ (ti -  ~ ti T +  ( ti ti ~si )) ~ (si -  Y
2

~T l2 2i -1 Y ~ si T ( si
i=1

+

~T  si

¯tM  ~t -  ~t ) +  ¯sM 2 -1  ~s l2 Y ¯tM 1 -1  ~t l1 Y ~ ~ + (   ~s ) ¯sM  ~s -  + ( (6.48)

2

184 From Eq. 6.34, the following inequality hold: ~  C Y ¯sM + a ~s  ¯ S + d4  ~ +  (6.49)

The time derivative of V can be written as  V 1 V 2 V 1 + V 2 + V 3 = V 1  - min (Q)  ~ 2 2 ~t  ¯tM + a   ~ P ( lt  ~ + B (  ¯T + d3 )) (6.50) (6.51) (6.52)
2

3  ( C V + ( C

~t ) ~t -  ¯sM + a ¯tM  ~s  ¯ S + d 4 ) × (  ~ +  ~s ) ~s -  ¯sM + a ¯sM  ~s  ¯ S + d 4 ) × (  ~ +  ~s  ¯sM + a  ~ +  ¯ S + d4 ) ¯sM + a ~s  ¯ S + d4 )  ~ +  (6.53)
2

~t l1 ( C ¯tM 1 -1  +  ~s l2 ( C ¯sM 2 -1  +  It yields  V  -v1  ~ ~s - v9  where v1 = v3
2 2

+ v2  ~ + v3  ~ ~s  ~ - v10 
2

~t + v4  ~s - v5  ~t 
2

2

~s + v11 

~s - v12 

3

~t  ~ - v6 

2

~s + v7  ~t 
2

~s  ~ + v8   ¯ =V (6.54)

~s + v13 

~t + v14  ~s 

1 min (Q) - lt P , v2 = B P (¯ aT + d3 ) 2 ¯tM + C  ¯tM +  ¯tM 1 -1 l1 C = P B  v5 = C

¯tM +  ¯tM 1 -1 l1 (¯ v4 = (¯ aS + d4 ) aS + d4 ), ¯sM + a v6 =  ¯ S + d4 ,

¯tM +  ¯sM 2 -1 l2 C v7 = C  v9 = C

¯sM +  ¯sM 2 -1 l2 (¯ v8 = (¯ aS + d4 ) aS + d4 ), v10 = -(¯ aS + d4 ), ¯sM , v12 = 

¯sM  ¯sM +  ¯2 2 -1 l2 v11 =  sM ¯sM v14 =  (6.55)

¯sM  ¯tM +  ¯sM 1 -1 l1  ¯sM , v13 = 

185 Hence  = -v  ¯ V 1 ~ where ¯1 = V  ( ¯2 = V ~t - v5  ~t  ~ (v3 
2 2

~s + v2  ~ - v10 

2

~s + v11 

2

~s - v12 

3

¯1 + V ¯2 + V ¯3 +V

(6.56)

2 v3 v2 + 7 )  ~ 4v5 4v9

~s - v9  ~s ) + v7  (6.57)
2

2

~s (v13  ~t - v14  ~t 
2

+ v8 )  (v8 +

2 v13 ~s )  4v14

(6.58) (6.59)

~t - v6  ~t ¯3 = v4  V Therefore  V  -v1  ~ ~s + v11   -v1  ~
2 2



2 v4 4v6

2 2 2 v13 v4 v7 ~ ~s )  ~ + (v8 + ) s + - v10  + (v2 + 4v5 + 4v9 4v14 4v6

2

~s - v12 

3 2 2 v7 v2 ~s + v4 - (v10 + v12 )  ~s )  ~ + (v8 + 13 )  4v9 4v14 4v6

2

+ (v2 + 4v5 +

2

4 (v10 + v12 )3 + 2 27 v12 (6.60) Using some algebraic manipulations, we can write  V  V
2 v7 )  ~ + 1 or 4v9 2 2 ~s + 2 ~s + (v8 + v13 )   -(v10 + v12 )  4v14

 -v1  ~

2

+ (v2 + 4v5 +

where 1 =

4 (v10 +v12 ) 2 27 v12

3

+

2 v4 4v6

+

13 ) (v8 + 4v 14

v2

2

4(v10 +v12 )

and 2 =

4 (v10 +v12 ) 2 27 v12

3

+

2 v4 4v6

+

3 + 7 ) (v2 + 4v 4v 5 9

v2

v2

2

4v1

.

 is strictly negative outside the following compact set  If min (Q) > 2lt P , V ~ and

186 ~s :   v2 v2 2  (v2 + 4v5 + 4v79 ) + (v2 + 4v5 + 4v79 ) + 41 v1  =  ~|  ~    2v1   2 2 2 v13 v13  (v8 + 4v14 ) + (v8 + 4v14 ) + 42 (v10 + v12 )  ~ ~ =  |   s   s 2(v10 + v12 )

 ~

(6.61)

~s

(6.62)

~ ~ We can conclude that  ~ is UUB.  s is UUB. According to Eq. 6.49, Y is UUB. Also, based ~t is UUB. All of the state and estimation errors are UUB. on Eq. 6.38, 

6.3.2

Fault Accommodation and Stability Analysis

In many applications, it is important to detect the fault as quickly as possible. Then, any fault must be quickly accommodated. Some research [Corradini et al. 2011] used sliding mode control for fault accommodation control. The research in reference [Richter et al. 2011] presents a continuous-time piecewise affine systems subject to actuator and sensor faults. It uses linear matrix inequality to guarantee the recovery of closed-loop stability and the tracking of constant reference inputs. We propose a different fault accommodation control to recover all possible thruster/sensor/plant faults as well as noise and uncertainties.

6.3.2.1

Normal Controller

The general chattering-free sliding mode control law with the saturation function is given by v (t) = -ksat(/), where  is a small positive constant. Our work in reference [Li et al. 2010] presents a second order sliding mode control law without using   (t) is designed as
t

(6.63)

v (t) = -k1  (t) - k2

 (t)dt
0

(6.64)

187 With this chattering-free SM control law, the system enters a vicinity of the 2nd sliding surface and then to a vicinity of the origin, locally and asymptotically. We apply this 2nd order sliding mode control for satellite formation flying. Rewrite the nonlinear dynamics model of formation flying (Eq. (6.2)) as f (X, u) = AX + E (X ). The 2nd sliding mode controller is written as
t

un (t) = -k1  (t) - k2   2 0 0 1 0 0     where Cg = 0 2 0 0 1 0.   0 0 2 0 0 1 6.3.2.2

0

¨ ]  (t)dt - Cg [AX + E (X ) - Xd

(6.65)

Accommodation Control of System Failures

After fault isolation, the proposed fault tolerant 2nd SMC law with fuzzy logic system is designed as u = un - uf (6.66)

T Using Eq. (6.28), the terms to accommodate the faults are uf = f f (, u). An adaptive

law is given as f = f   (6.67)

Theorem 2: Consider the system Eq. (6.2). The 2nd sliding mode control laws defined by Eqs. (6.65-6.66), with adaptive control laws given by Eq. (6.67) guarantees the following properties: All signals due to thrusters/sensors/plant/uncertainties/noise fault in the closed-loop system are bounded. The tracking error is UUB (Converges to a small neighborhood around zero by appropriately choosing the design parameters). Proof of Theorem 2: Rewriting Eq. (6.7) with thrusters/plant/uncertainties faults,

188 we obtain the following equation 1 1 1 ¨ -x   = X ¨d + M e  = -x ¨d + M e  + AX + E (X ) + Bu + BTf + BDf mF mF mF 1 1 1 B (u n - u f ) + BTf + BDf = -x ¨d + M e  + AX + E (X ) + mF mF mF t 1 = -x ¨d + M e  + AX + E (X ) + B (-k1  (t) - k2  (t)dt mF 0 ¨ ]) + g (X )(-T f ) + Tf + Df ) - Cg [AX + E (X ) - Xd f 1 = - B (k1  (t) - k2 mF
t 0 T  (t)dt - f f + Tf + Tf  - Tf  + Df )

(6.68)

where Tf is the thruster fault and Df is the uncertainty and disturbance. The term Tf - Tf  has the following relationship: Tf - Tf  = wf where wf is an approximation error and is bounded. Rewrite Eq. (6.68) as
t

(6.69)

  = -g ¯M (k1  (t) - k2 where g ¯M =
1 mF

0

T T  (t)dt - f f + f  f + w f + Df )

(6.70)

B.

We consider a Lyapunov function candidate defined as 1 T  + V = 2 where  = 3. Thus, the time derivative of V is obtained as
 

i=1

1 T  f i f i i

(6.71)

 = T  V +
i=1

1 T   f i f i i

(6.72)

 Define fi represents the fuzzy parameter errors such that fi = f - fi . i

Substituting Eq. (6.70) into Eq. (6.72), we obtain


 V

= - T g ¯M K1  +

i=1

1 T  f ) + T g  (i fi ( )i +  ¯M (wf + Df ) i i f i

(6.73)

189 where wf is the fuzzy estimation error wf  w ¯ f (w ¯f = 0) and Df  df (the noise and uncertainties are bounded). The time derivative of V can be written as  V 0 + V 1 + V 2 = V
2

(6.74) (6.75) (6.76) (6.77)

 0 = - T g V ¯M K1   -min (¯ g M K1 )  1 = T g V ¯M (Df + wf )   (df + w ¯f )


2 = V
i=1

1 T f )  (i fi ( )i +  i i f i

We can get 2 = 0 V Eq. (6.74) can be written as   -min (¯ V g M K1 )  < -min (¯ g M K1 )
2

(6.78)

+  (¯ gM df ) < -min (¯ g M K1 )  g ¯M df 2min (¯ g M K1 )
2

2

+  g ¯M df

(6.79)

 -

+
(¯ gM df )2 . 4min (¯ gM K1 )

and min (¯ gM K1 ) is the minimum eigenvalue of matrix g ¯M K1 .  = negative outside the following compact set  :  = |0   g ¯M df min (¯ g M K1 )

 is strictly V

(6.80)

We can conclude that  decreases whenever  is outside the compact set  and hence  is UUB. Since all signals involved in the proposed fault tolerant system are bounded in the closed-loop system, we can conclude that the control input is also bounded. A general sensor configuration for sensor fault tolerant control is used in this chapter. ^s is used to correct the measured output signal so that Yc = The estimated sensor fault T ^ = CX + Ts - T ^s . The sensor fault tolerant control law will be revised according to Y -Y Eq. (6.65). u = -k1 s (t) - k2
0 t

¨d] s (t)dt - Cg [AYc + E (Yc ) - X

(6.81)

The sensor configuration of sliding mode can be written as s (t) = Mes (t) + e  s (t) (6.82)

190 c - X  d . Consequently, using the Lyapunov arguments similar where es = Yc - Xd and e s = Y to the above proof for thruster fault tolerant control, there exists the following compact set s for sensor fault tolerant control law Eq. (6.81), which retains UUB stability.

6.4

Results and Discussion

The desired formation considered for ideal formation keeping is a projected circular formation. The phase angle () between the leader and follower satellite is assumed to be zero. The initial states for the numerical simulation are computed by substituting t = 0 and adding a 1 km position offset on x, y , and z . The SFF system parameters and the orbital parameters for the leader satellite used in the numerical simulations are given in Table 6.1. To implement the fuzzy logic system, we define the fuzzy sets according to Table 6.1: Satellite Parameters Parameter mF (kg) µe (km3 s-2 ) rL (km) e i (deg)  (deg) Value 1 398600 6878 0.1 45 0

, , i, M (deg) 0

reference [Wang 1997]. Seven Gaussian membership functions defined for each variable Ai (i = 1, 2, · · · , 7). The application of fault detection, identification and fault tolerant control methods proposed in Section IV yields the following steps: 1. Fault Detection : Construct a bank of second order sliding mode observer Eqs. (6.8)

191 and (6.14) for the fault detection. 2. Residual and Threshold : Generate the residuals and define the thresholds. 3. Fault Reconstruction : For the numerical analysis of the formation tracking problem, ^ - Y ). We use the sliding surface and sensor fault case (s = Mes + e  s , where es = Y  and s as the inputs for the fuzzy fault identifier Eq. (6.28) and learning law Eq. (6.36) to reconstruct unknown thruster and sensor faults. 4. Fault Tolerant Control : After fault reconstruction, the fault tolerant control laws (Eqs. (6.66) and (6.81) are used to accommodate the thruster and sensor faults. Remark. The proposed method differs from previously published sliding mode observer based fault reconstruction methods ( [Edwards et al. 2007] and [Alwi et al. 2008]). In the following simulation results, the thruster fault diagnosis information for the proposed method compared to reference [Edwards et al. 2007] will show very similar results. However, the proposed fault diagnosis information will be robust to J2 and the fault diagnosis information by [Edwards et al. 2007] cannot handle J2 or enhance the control performance. Sensor fault diagnosis information by the proposed method will be more accurate than the results of reference [Alwi et al. 2008], and will enhance the fault tolerant control performance. Table 6.2: Second Order Sliding Mode Controller Parameters for Numerical Analysis Name Along Track Control Sliding Surface Radial Control Sliding Surface Cross Track Control Sliding Surface Chatting Free Control Gain 1 Chatting Free Control Gain 2 Parameter m1 m2 m3 k1 k2 Value 2 2 2 1e-3 1e-9 ^ - Xd) we build the sliding surface for thruster fault case ( = Me + e  , where e = X

192 Table 6.3: Second Order Sliding Mode Observer Parameters for Numerical Analysis Name Along Track Radial Cross Track Along Track Radial Cross Track Parameter x y z 1x 1y 1z Value 1 1 1 0.1 0.1 0.025

6.4.1

Fault Free

First, we apply the proposed second sliding mode control for picosatellites. We take the design parameters of the 2nd-SM controllers as given in Table 6.2. We consider formation keeping for e = 0.1 elliptic orbit. Figures 6.2a and 6.2b show 3D trajectory, relative position errors and control demand for formation keeping. The objective is to stabilize the formation when there is an initial misalignment while positioning the follower satellite in orbit. Under the initial condition error of 1 km, the steady-state errors on the radial, along track, and cross track directions are bounded by 0.0005 m. Near perfect tracking is achieved in the radial, along track, and cross track directions. The proposed control scheme efficiently tracks the desired trajectories in 0.2 orbits. A low thrust (0.003N ), low fuel SFF system is achieved by the proposed control law.

6.4.2

Actuator Fault

In this situation, the actual forces applied by actuators are unknown. In practice, this fault can be caused by the damage that can occur to the thruster supply system. We use the   0 t < tf thruster constant additive fault scenario in this study as: Tti = 5 × 10-1 kN t  t f Periodic additive fault is assumed to be permanently added to all thrusters after 0.5

193

1500 2000 1000 0 -1000 2000 2000 0 0 1000 1000 500 0 -500 -1000 -500

z [m]

y [m] -2000 -1000

y [m]

x [m]

0

500

1000

1500

x [m]
1500 1000 500 0 -500 -1000 -1000

1500 1000 500 0 -500 -1000 -500

z [m]

0

500

1000

1500

z [m]

-500

0

500

1000

1500

x [m]

y [m]

(a) Without Thruster Fault

x 10 1000 5

-3

ex [m]

0 -1000

ux [N]
0 2000 4000 6000 8000

0 -5

0 x 10
-3

2000

4000

6000

8000

1000

5

ey [m]

0 -1000

uy [N]
0 2000 4000 6000 8000

0 -5

0 x 10
-3

2000

4000

6000

8000

1000

5

ez [m]

0 -1000

uz [N]
0 2000 4000 6000 8000

0 -5

0

2000

4000

6000

8000

time [s]

time [s]

(b) Without Thruster Fault

Figure 6.2: SFF 3D Trajectory, Relative Position Errors and Control Input

194

x 10 3 2

5

x 10 2.5 2 1.5

5

z [m]

y [m]
3
5

1 0 5

1 0.5 0

x 10

0 1

2 -5 0

x 10

5

-0.5

y [m]
5

x [m]

0

0.5

1

1.5

2

2.5 x 10
5

x [m]
x 10 2.5 2 1.5 1 0.5 0 -0.5
5

x 10 2.5 2 1.5 1 0.5 0

z [m]

0

0.5

1

1.5

2

2.5 x 10
5

z [m]

0

0.5

1

1.5

2

2.5 x 10
5

x [m]

y [m]

(a) With Constant Thruster Fault and without FTC

1500 10000 5000 0 -5000 2000 2000 0 0 1000 -2000 -1000 1000 500 0 -500 -1000 -500

z [m]

y [m]

y [m]

x [m]

0

500

1000

1500

x [m]
10000 8000 6000

10000 8000 6000

z [m]

4000 2000 0 -2000 -500

z [m]
0 500 1000 1500

4000 2000 0 -2000 -1000

-500

0

500

1000

1500

x [m]

y [m]

(b) With Constant Thruster Fault and with FTC

Figure 6.3: SFF 3D Trajectory

195

x 10 2000 5

-3

ex [m]

1000

ux [N]
0 2000 4000 6000 8000

0

0

-5

0 x 10
-3

2000

4000

6000

8000

1000

5

ey [m]

500

uy [N]
0 2000 4000 6000 8000

0

0

-5

0 x 10
-3

2000

4000

6000

8000

10000

5

e [m]

z

5000

uz [N]
0 2000 4000 6000 8000

0

0

-5

0

2000

4000

6000

8000

time [s]

time [s]

(a) With Constant Thruster Fault and with FTC
Fault Detection 250 200 Threshold 150 100 Residual 50 0 -50 -100 -150 -200 Fault Detected t=3000s Along Track Radial Cross Track 0 1000 2000 3000 4000 5000 time [s] 6000 7000 8000 9000

(b) FDI With Constant Thruster Fault

Figure 6.4: Relative Position Errors, Control Input and Residual using Proposed FDI/FTC Method

196
Fault Isolation of Along Track Direction 0.7
T t1

0.6

Tt1 Estimation

0.5

Fault [kN]

0.4

0.3

0.2

0.1

0

0

1000

2000

3000

4000 5000 time [s]

6000

7000

8000

9000

(a)
Fault Isolation of Radial Direction 0.7
T t2 t2

0.6

T Estimation

0.5

Fault [kN]

0.4

0.3

0.2

0.1

0

0

1000

2000

3000

4000 5000 time [s]

6000

7000

8000

9000

(b)
Fault Isolation of Cross Track Direction 0.9
T t3

0.8 0.7 0.6 Fault [kN] 0.5 0.4 0.3 0.2 0.1 0

Tt3 Estimation

0

1000

2000

3000

4000 5000 time [s]

6000

7000

8000

9000

(c)

Figure 6.5: Constant Thruster Fault Isolation using Proposed FDI Method

197

1.4 Fault Isolated t=3000s

1.2

1

0.8 x 0.6 0.4 0.2 0 0

1000

2000

3000

4000 5000 time [s]

6000

7000

8000

9000

(a) Along Track Direction
1.4 1.2 1 0.8 y 0.6 0.4 0.2 0 Fault Isolated t=3000s

0

1000

2000

3000

4000 5000 time [s]

6000

7000

8000

9000

(b) Radial Direction
1.4 Fault Isolated t=3000s

1.2

1

0.8 z 0.6 0.4 0.2 0 0

1000

2000

3000

4000 5000 time [s]

6000

7000

8000

9000

(c) Cross Track Direction

Figure 6.6: Fuzzy Estimation with Constant Thruster Fault

198

6000 4000 4000 3000

z [m]

2000 1000 0 5000 4000 0 2000

y [m] y [m] -5000 0

2000

0

-2000

x [m]

0

1000

2000

3000

4000

x [m]
4000

4000

3000

3000

z [m]

2000

z [m]
0 1000 2000 3000 4000

2000

1000

1000

0

0 -2000

0

2000

4000

6000

x [m]

y [m]

(a) Constant Thruster Fault

x 10 4000 3000 5

-3

ex [m]

2000 1000 0 0 2000 4000 6000 8000 10000

ux [N]

0

-5

0 x 10
-3

2000

4000

6000

8000

10000

10000

5

ey [m]

5000

uy [N]
0 2000 4000 6000 8000 10000

0

0

-5

0 x 10
-3

2000

4000

6000

8000

10000

4000 3000

5

ez [m]

2000 1000 0 0 2000 4000 6000 8000 10000

uz [N]

0

-5

0

2000

4000

6000

8000

10000

time [s]

time [s]

(b) Constant Thruster Fault

Figure 6.7: SFF 3D Trajectory, Relative Position Errors and Control Input using FDI/FTC in [Edwards et al. 2007]

199

Fault Isolation of Along Track Direction 0.6 0.5 0.4 0.3 0.4 0.2 Fault [kN] Fault [kN] 0.3 0.1

Fault Isolation of Radial Direction

0.5

T

0.2

T

0 -0.1 -0.2

t2

t1 t1

Tt2 Eastimation

T Eastimation 0.1

0

-0.3 -0.4

-0.1

0

2000

4000 time [s]

6000

8000

10000

0

2000

4000 time [s]

6000

8000

10000

(a)
Fault Isolation of Along Track Direction 0.6

(b)

0.5

0.4

Fault [kN]

0.3

0.2

T

t1

0.1

Tt1 Eastimation

0

-0.1

0

2000

4000 time [s]

6000

8000

10000

(c)

Figure 6.8: Constant Thruster Fault Fault Isolation using FDI in [Edwards et al. 2007]

200 orbits. First, we show the 3D trajectory without fault detection, isolation and accommodation in Figure 6.3a. Formation keeping is no longer available during the fault using the normal 2nd SMC law. We apply the active fault tolerant control system for the same initial condition. The 3D trajectory with fault detection, isolation and accommodation is shown in Figure 6.3b. The formation keeping is still available after the fault using the fault tolerant 2nd SMC law. Figure 6.4a shows relative position errors and control demand for formation keeping. The steady-state errors on the radial, along track, and cross track directions are bounded by 3 m. Then, we use the proposed second sliding mode observer with fuzzy identifier for fault detection and isolation. The observer parameters are given in Table 6.3. The
2 ~ residuals are shown in Figure 6.4b. The threshold X M is assumed as 100m/s . The faults

^ti (i=1,2,3) are given in Figures 6.5a, 6.5b and Tti (i=1,2,3) and fault isolation results T 6.5c. The fault added on the actuator of the radial, along track, and cross track directions are isolated using fuzzy logic system. The fuzzy logic adaptive parameters are shown in Figures 6.6a, 6.6b and 6.6c.

A comparison of the proposed fault tolerant control and a sliding mode observer based fault tolerant control [Edwards et al. 2007] with the same initial condition is carried out ^ti (i=1,2,3) are given in this section. The faults Tti (i=1,2,3) and fault isolation results T in Figures 6.8a, 6.8b and 6.8c (The residual filters are not applied in this comparison). The fault added on the actuator of the radial, along track, and cross track directions are isolated using a sliding mode observer. The 3D trajectory with fault detection, isolation and accommodation by the method in reference [Edwards et al. 2007] is shown in Figure 6.7a. The formation keeping is not available after the fault using the fault tolerant 2nd SMC law. Figure 6.7b shows relative position errors and control demand for formation keeping. The steady-state errors on the radial, along track, and cross track directions are large. It can be seen that the fault diagnosis information by [Edwards et al. 2007] can not handle J2 and the control performance is not as good as that of the proposed method.

201

6.4.3

Sensor Fault

In this situation, the controller can not determine the exact position or velocity of the satellite. The noise is negligible for the case and the sensors for the satellite are very precise for the fault free case. In order to test the robustness for sensor faults, a ramp additive  fault scenario in this study as:   0 t < tf 1 or t > tf 3   (t-t ) Tsi = km tf 1  t  tf 2 2 × 10-1 × (tf 2 -ft1 f 1)    2 × 10-1 - 2 × 10-1 × (t-tf 2 ) km tf 2  t  tf 3 (tf 3 -tf 2 )

The 3D trajectory without and with fault detection, isolation and accommodation are

shown in Figures 6.9a and 6.9b. Figures 6.10a and 6.10b show relative position errors and control demand for formation keeping without and with sensor compensation. The steadystate errors on the radial, along track, and cross track directions are bounded by 3 m. The ~ M is assumed as 1 m. residuals are shown in Figure 6.11. The threshold X A comparison of the proposed fault tolerant control and a sliding mode observer based fault tolerant control [Alwi et al. 2008] with the same initial condition is carried out in this section. The 3D trajectory with fault detection, isolation and accommodation by the method in reference [Alwi et al. 2008] is shown in Figure 6.12a. Figure 6.12b shows relative position errors and control demand for formation keeping. The steady-state errors on the radial, along track, and cross track directions are reasonable. The fault added on the sensor of the radial, along track, and cross track directions can be isolated using fuzzy logic system or sliding mode observer. The fault isolation result using the proposed FDI is given in Figure 6.13a. Fuzzy estimation result is shown in Figure 6.13b. THe fault isolation result using the method in [Alwi et al. 2008] is given in Figure 6.13c. It can be seen that the fault diagnosis information by [Alwi et al. 2008] is not as good as that of the proposed method.

202

1500 2000 1000 0 -1000 2000 2000 0 0 1000 1000 500 0 -500 -1000 -500

z [m]

y [m] -2000 -1000

y [m]

x [m]

0

500

1000

1500

x [m]
1500 1000 500 0 -500 -1000 -1000

1500 1000 500 0 -500 -1000 -500

z [m]

0

500

1000

1500

z [m]

-500

0

500

1000

1500

x [m]

y [m]

(a) Ramp Sensor Fault without Sensor Compensation

1500 2000 1000 0 -1000 2000 2000 0 0 1000 1000 500 0 -500 -1000 -500

z [m]

y [m] -2000 -1000

y [m]

x [m]

0

500

1000

1500

x [m]
1500 1000 500 0 -500 -1000 -1000

1500 1000 500 0 -500 -1000 -500

z [m]

0

500

1000

1500

z [m]

-500

0

500

1000

1500

x [m]

y [m]

(b) Ramp Sensor Fault with Sensor Compensation

Figure 6.9: SFF 3D Trajectory using Proposed FDI/FTC Method

203

x 10 1000 2 0

-3

ex [m]

500 0 -500

ux [N]
0 0.5 1 1.5 x 10 2
4

-2 -4

0 x 10
-3

0.5

1

1.5 x 10

2
4

1000

2 0

ey [m]

500 0 -500

uy [N]
0 0.5 1 1.5 x 10 2
4

-2 -4

0 x 10
-3

0.5

1

1.5 x 10

2
4

1000

5

ez [m]

500

uz [N]
0 0.5 1 1.5 x 10 2
4

0

0 -500

-5

0

0.5

1

1.5 x 10

2
4

time [s]

time [s]

(a) Ramp Sensor Fault without Sensor Compensation

x 10 1000 2 0

-3

ex [m]

500 0 -500

ux [N]
0 0.5 1 1.5 x 10 2
4

-2 -4

0 x 10
-3

0.5

1

1.5 x 10

2
4

1000

2 0

ey [m]

500 0 -500

uy [N]
0 0.5 1 1.5 x 10 2
4

-2 -4

0 x 10
-3

0.5

1

1.5 x 10

2
4

1000

5

ez [m]

500

uz [N]
0 0.5 1 1.5 x 10 2
4

0

0 -500

-5

0

0.5

1

1.5 x 10

2
4

time [s]

time [s]

(b) Ramp Sensor Fault with Sensor Compensation

Figure 6.10: Relative Position Errors and Control using Proposed FDI/FTC Method

204

Fault Detection 1.5 Along Track Radial Cross Track

1

0.5

Residual

0

-0.5

-1

-1.5

-2

0

1000

2000

3000

4000 5000 time [s]

6000

7000

8000

9000

Figure 6.11: Residual using Proposed FDI Method for Ramp Sensor Fault

205

1500 2000 1000 0 -1000 2000 2000 0 0 1000 -2000 -1000 1000 500 0 -500 -1000 -500

z [m]

y [m]

y [m]

x [m]

0

500

1000

1500

x [m]
1500

1500

1000

1000

z [m]

500

z [m]
0 500 1000 1500

500

0

0

-500 -500

-500 -1000

-500

0

500

1000

1500

x [m]

y [m]

(a) Ramp Sensor Fault

x 10 1000 5

-3

ex [m]

500

ux [N]
0 0.5 1 1.5 x 10 2
4

0

0 -500

-5

0 x 10
-3

0.5

1

1.5 x 10

2
4

1000

5

ey [m]

500

uy [N]
0 0.5 1 1.5 x 10 2
4

0

0 -500

-5

0 x 10
-3

0.5

1

1.5 x 10

2
4

1000

5

ez [m]

500

uz [N]
0 0.5 1 1.5 x 10 2
4

0

0 -500

-5

0

0.5

1

1.5 x 10

2
4

time [s]

time [s]

(b) Ramp Sensor Fault

Figure 6.12: SFF 3D Trajectory, Relative Position Errors and Control Input using the FDI method in [Alwi et al. 2008]

206

Fault Isolation of Along Track Direction 0.2 Ts1 Ts1 Eastimation 0.15 0.2 0.1 x Fault Isolated 0.25 0.3

Fault [km]

0.15

0.05

0.1

0.05 0 0

-0.05

0

0.5

1 time [s]

1.5 x 10

2
4

-0.05

0

0.5

1 time [s]

1.5 x 10

2
4

(a) Ramp Sensor Fault Isolation with Proposed FDI

(b) Fuzzy Estimation with Proposed FDI

Fault Isolation of Along Track Direction 0.3 T 0.25 T
s1 s1

Eastimation

0.2

Fault [km]

0.15

0.1

0.05

0

-0.05

0

0.5

1 time [s]

1.5 x 10

2
4

(c) Ramp Sensor Fault Isolation with FDI in [Alwi et al. 2008]

Figure 6.13: Fault Isolation Method using Proposed FDI and FDI in [Alwi et al. 2008]

207

6.5

Conclusions

In this chapter, a second order sliding mode controller and a second order sliding mode observer with a fuzzy identifier are proposed for a satellite formation flying system. The faults considered are modeled as constant, time-varying and ramp additive faults which occur at unknown times. It is proved that the proposed fault tolerant control scheme can guarantee all signals of the closed-loop system to be semi-globally, uniformly, and ultimately bounded, and the tracking error can converge to a small neighborhood near zero. Simulation results confirm that the suggested control methodologies yield high formation keeping precision and effectiveness for satellites in formation flying. The numerical results demonstrate the effectiveness of the proposed active fault tolerant control system during thruster/sensor faults.

Chapter 7

Experimental Testing

7.1

Introduction

Satellite motion is governed by kinematics and dynamics equations. The mathematical model is highly nonlinear and linear feedback control techniques are not suitable for the system design because the accuracy and precision decreases due to the contribution of the nonlinear term. Most references for satellite tracking control do not consider the hard nonlinearties such as Coulomb friction, saturations, noise, dead-zones and external disturbances. Most of the fault tolerant control studies consider the system' ability to maintain its stability and performance under fault conditions. Dynamics inversion and time-delay fault tolerant control has been developed for a satellite with four reaction wheels and compared with a PD controller [Lin et al. 2008]. In the last several years, various structure control technologies have been used for the satellite tracking maneuver problem [Lo & Chen 1995, Pukdeboon et al. 2010] without fault. Most fuzzy logic systems are designed based on the knowledge of a human expert who creats the rules. In most of cases, we do not have enough expert knowledge in advance. The first order sliding mode fault tolerant control with adaptive fuzzy control proposed in Chapter 5 is described in this chapter and comparied with two other novel fault tolerant control laws based on high order sliding mode theory and fuzzy logic systems. While nonlinear attitude control has been explored widely in theory [Lo & Chen 1995, Won 1999, Kim & Kim 2003, Lin et al. 2008], nanosatellite air-bearing-based spacecraft simulators [Prado et al. 2005, Kim & Agrawal 2009] have not been used to test nonlinear fault tolerant control techniques. This chapter documents development and testing of

210 a nonlinear attitude controller for a next generation nanosatellite. The novel nonlinear control algorithm proposed in Chapter 5 is verified with a spherical air bearing system. The stability conditions for robustness against unmatched uncertainties and disturbances are derived using Lyapunov stability theory to establish the regions of asymptotic stabilization. The proposed control method is tested on a three-axis nanosatellite air-bearing system with reaction wheel actuation, and results are compared to numerical simulations to show that precise attitude pointing and tracking can be achieved by dealing with the issues of system nonlinearities, variations in initial conditions, external disturbances, and control force saturation, concurrently. The results are then compared with a PID control law. The attitude control system results will be very valuable in the development and testing of future nanosatellite payloads. The main contributions of this study relative to other works are as follows:

1. The novel fault tolerant control uses a sliding mode control scheme and fuzzy logic system for precise attitude tracking in the presence of unknown time-varying satellite actuator faults. This proposed integrated fault tolerant control approach gives higher tracking precision and effectiveness than the other exsiting methods evaluated.

2. The novel fault tolerant control proposed in this dissertation is applied to an air bearing satellite simulator controlled by reaction wheels. Tests are performed to determine the effectiveness of the control theories under nominal operating conditions and simulated actuator faults.

System models, FTC design methods and numerical results are summarized in Section 7.2. In Section 7.3, air bearing testing is carried out for one of the proposed control strategies in this dissertation, and the effects of different actuator fault scenarios on controller performance is examined. Finally, the findings of the present study are summarized in Section 7.4.

211

7.2

Fault Tolerant Control Design of Attitude Control System

7.2.1

Satellite Dynamics and Kinematics

The spacecraft is modeled as a rigid body with actuators that provide torques about three mutually perpendicular axes that defines a body-fixed frame B. The equations of motion are given by

where  = (1 , 2 , 3 )T is the angular velocity of the spacecraft with respect to an inertial   R3 is the torque control; d  R3 is the bounded external disturbance; x×  R3×3 represents the cross product operator for a vector x = (x1 , x2 , x3 )T given as   0 -x3 x2     × x =  x3 0 -x1    -x2 x1 0 frame I and expressed in the body frame B; J  R3×3 is the inertia matrix of the spacecraft;

J  = - × J +  + d   × q I + q ¯ 1 4 3×3    1 A(q ) q =  2 2 -q ¯T

(7.1) (7.2)

(7.3)

and the unit quaternion q = (¯ q T , q4 )T = (q1 , q2 , q3 , q4 )T represents the attitude orientation of a rigid spacecraft in the body frame B with respect to the inertial frame I, which is defined by q ¯ = (q1 , q2 , q3 )T = e sin(/2), q4 = cos(/2) (7.4)

where e is the Euler axis, and  is the Euler angle. The unit quaternion q satisfies the constraint qT q = 1 (7.5)

212 Property 1 : AT A = I3×3 , AT (q )q = 0.

Property 2 : The inertia matrix J is a symmetric and positive definite matrix that satisfies the bounded condition given by Jm x
2

 xT Jx  JM x 2 , x  R3

(7.6)

where Jm and JM are positive constants, respectively.
T To address the attitude tracking problem, the attitude tracking error qe = (¯ qe , q4e )T is

defined as the relative orientation between the body frame B and the desired frame D with
T orientation qd = (¯ qd , q4d )T , and it is computed by the quaternion multiplication rule as

q ¯e = q4d q ¯ - q4 q ¯d + q ¯× q ¯d
T q4e = q4d q4 + q ¯d q ¯

(7.7) (7.8)

T T where qd  R4 and qe  R4 satisfy the constraints qd qd = 1 and qe qe = 1, respectively. The

corresponding rotation matrix is given by
2 T T × C (qe ) = q4 ¯e q ¯e I3×3 + 2¯ qe q ¯e - 2q4e q ¯e e -q

(7.9)

 = - × C , where e =  - Cd is the relative angular velocity Note that C = 1 and C e differential equations for the attitude tracking error qe and the relative angular velocity e are stated as follows 1 q e = A(qe )e 2 J  e = -(e + Cd )× J (e + Cd ) +  + d
× - J (C   d - e Cd )

of B with respect to D, and d  R3 is the desired angular velocity. Now, the governing

(7.10)

(7.11)

The control objective is to design a model free controller  such that all signals involved in the resulting closed-loop system are uniformly ultimately bounded.

213

7.2.2

NFFTSMC Control Design

The linear sliding mode (LSM), the initial terminal sliding mode (TSM), and the nonsingular TSM (NTSM) can be described by the following first-order nonlinear differential equations: LSM : TSM : NTSM : s=x  + kx s=x  + kxq/p s = x + k -p/q x  p/q (7.12) (7.13) (7.14)

respectively, where x  R; k is a positive constant, and the positive odd integers p, q are chosen such that 1 < p/q < 2. The nonsingular fast terminal sliding mode can be defined by the following nonlinear differential equation: s = x + 1 sign(x) + 2 x q where x  R and 1 , 2 are positive constants. Based on the approximation property of Fuzzy Logic System, a continuous nonlinear function F (x)  Rn can be approximated by Fuzzy Logic System as: F (x) =   (x) +  (7.16)
p

(7.15)

where  represents the bounded FLS approximation error, and  denotes the optimal weight matrix of the FLS. Then, the adaptive parameters  are updated by the following adaptive laws:
-1  = 2 q  e s

(7.17) (7.18)

= where  is a positive constant.

N i=1 P l=1

µAil (s) N i=1 µAil (s)

The proposed attitude fault tolerant controller design for a satellite in the centralized or decentralized formation is now given by q rw =  ¯ = -k1 s - k2 s - s2-p/q - T  -  p (7.19)

214  is defined by [Hou et al. 2009]   tanh( 3Ku s )  (7.20)

The other two proposed attitude fault tolerant controller [Pukdeboon et al. 2010] design for a satellite in the centralized or decentralized formation are now given by  ^rw = -k s  + |s|1/2 sign(s) s  + | s|
1/2

-  - T 

(7.21)

 ¯rw

s ¨ + 2(|s  | + |s|2/3 )-1/2 (s  + |s|2/3 signs) ^ = -k -  - T  2/3 1/2 |s ¨| + 2(|s  | + | s| )

(7.22)

The numerical method is used to compute s  and s ¨. For Eq. 7.21, a first-order real-time . differentiator [Levant 2005] Q0 and Q1 is used in to estimate s and s  0 = -1 |Q0 - s|1/2 sign(Q0 - s) + Q1 Q  1 = -2 sign(Q0 - s) Q   tanh( 3Ku Q0 )  (7.23)

For Eq. 7.22, a second-order real-time differentiator [Levant 2005] Q0 , Q1 and Q2 is used in to estimate s, s  and s ¨.  0 = Z0 Q ^ 1 |Q0 - s|2/3 sign(Q0 - s) + Q1 Z0 = -  1 = Z1 Q ^ 2 |Q1 - Z0 |1/2 sign(Q1 - Z0 ) + Q2 Z1 = - ^ 3 sign(Q2 - Z1 )  2 = - Q   tanh( 3Ku Q0 )  (7.24)

215

7.2.3

Numerical Results and Discussion

The computing environment of this simulation is: Matlab R2009b (64bit), running with processor (core speed 1596 [MHz]) and 1 GB of RAM memory (bus speed of 199.6 [MHz]).

Table 7.1: Satellite Parameters for ACS Parameters Mass (kg) µe (km3 s-2 ) rL (km) Size (m3 ) Desired Attitude Trajectory Initial Relative Angular Velocity Initial Quaternion (Satellite) Moment of Inertia Satellite 1 (kgm2 ) Moment of Inertia Maximum Voltage of Wheels (kgm2 ) Wheels (V ) Values 2 398600 6878 0.1 × 0.1 × 0.1

qd = [0, 0.005cos(0.2t), 0.005sin(0.2t)]T  (0) = (0, 0, 0)T (rad/s) q(10) = (0.6, -0.5, 0.6)T J = diag (0.015, 0.017, 0.020) Jw = 10-5 diag (1, 1, 1, 1) ea = 4.5

Table 7.2: NFFTSMC Controller Parameters for Numerical Analysis Parameters p, q ,  i1 , i2 k1 , k2 0 , min , max ,  Values 11, 9 0.1, 0.01 0.00001, 100 diag (0.004, 0.004, 0.004), diag (0.0025, 0.0025, 0.0025) 0, -200, 200, 2

The simulation results of NFFTSMC (nonsingular fast fuzzy terminal sliding mode control), 2nd SMC(second order sliding mode control), and 3rd SMC (third order sliding

216 Table 7.3: 2nd SMC Controller Parameters for Numerical Analysis Parameters p, q, k ,  1 , 2 0 , min , max ,  Values 11, 9, 0.0009 0.1, 0.001 120, 128 0, -200, 200, 9

Table 7.4: 3rd SMC Controller Parameters for Numerical Analysis Parameters ^ p, q, k ,  ^1 ,  ^2,  ^3  0 , min , max ,  Values 11, 9, 0.009 0.1, 0.001 20, 26, 81 0, -200, 200, 9

mode control) are shown in Figs. 7.1, 7.2, 7.4, 7.3 and 7.5. The design parameters of three control laws are in Tables 7.2, 7.3, and 7.4. According the reference [Pukdeboon et al. 2010], second order sliding mode and third order sliding mode controllers have been successfully applied to satellite attitude control. Second order sliding mode and third order sliding mode controllers provide better accuracy than a classic first order sliding mode controller. Also, a second order sliding mode controller has a short settling time. The shortcoming of 2nd SMC is that the control torques are more oscillatory. The results of this chapter show substantially the same conclusions. The novelty of this study is that we revised 2nd SMC and 3rd SMC control laws [Pukdeboon et al. 2010] with a fuzzy logic system. Moreover, a novel first order sliding mode controller (NFFTSMC) is proposed in this study. The simulation results show that NFFTSMC can achieve better performace under fault conditions than the other two controllers. Tracking error performance using NFFTSMC, 2nd SMC and 3rd SMC controllers without a fault or reaction wheel friction,

217 Table 7.5: Summary of Tracking Error Performance for NFFTSMC, 2nd SMC and 3rd SMC Controller without Fault and Reaction Wheel Friction (t=500s) Controller NFFTSMC 2nd SMC 3rd SMC Roll 0.040  0.086  0.01  Pitch 0.044  0.087  0.035  Yaw 0.068  0.103  0.12 

Table 7.6: Summary of Tracking Error Performance for NFFTSMC, 2nd SMC and 3rd SMC Controller with Multiple Faults and Reaction Wheel Friction (t=500s) Controller NFFTSMC 2nd SMC 3rd SMC Roll 0.041  0.091  0.29  Pitch 0.045  0.105  0.21  Yaw 0.074  0.109  0.68 

and with a fault and reaction wheel friction is shown in Tables 7.5 and 7.6. The best controller for the fault free case is 3rd SMC because the tracking error and control gain are the smallest. For the fault case, 3rd SMC with FLS is not the most robust controller. The tracking error is the largest under fault conditions. 2nd SMC with FLS control is robust and the tracking error is smaller than 3rd SMC under fault conditions. However, NFFTSMC is the best controller for the fault case.

7.3

Experimental Testing

Nanosatellites (spacecraft with a total mass of 1-10 kg) are becoming important not only as a means to educate, but also as scientific instruments to make specific measurements of the earth cost effective and allow greater flexibility. For most large satellites that use an active ACS, a pure simulation or hardware-in-the-loop system using a software environment

218
Roll Pitch Yaw Tracking Error with NFFTSMC
150 200 100 100 0 50 -100 -200 0 0 50 100

-50 Fault at t=70s Without FLS

-100

-150

0

50

100 time [s]

150

200

qe with NFFTSMC
1 0.8

1 0.5 0 -0.5

Quaternion Tracking Error

0.6 0.4 0.2

-1 0 -0.2 -0.4 -0.6

0

50

100

Fault t=70s Without FLS

0

50

100 time [s]

150

200

 with NFFTSMC
e
0.3

Angular Velocity Tracking Error

0.2

Fault t=70s Without FLS

0.1

0 1 -0.1 0.5 -0.2 0 -0.3 -0.5 -0.4 0 50 0 20 100 time [s] 40 60 150 80 200

Figure 7.1: Angular Tracking Error, Quaternion Tracking Error, Angular Velocity Tracking Error Fault Tolerance Results using NFFTSMC Controller and NFTSMC Controller : t=70s, Actuator Fault; t=80s, Actuator noise

219
Wheel Torque with NFFTSMC
0.08 0.06 0.04 0.02 0 0.1 -0.02 -0.04 -0.06 -0.1 -0.08 0 50 0 20 40 150 60 80 200 0.05 0 -0.05 1 Fault t=70s WIthout FLS 2 3 
4

Wheel Torque [Nm]

100 time [s]

Wheel Speed with NFFTSMC
600

400

Wheel Speed [rad/s]

200

0

-200 1 2 
3

-400

-600

4 0 50 100 time [s] 150 200

-800

Wheel Input Voltage with NFFTSMC
5 4 3 ea1 ea2 ea3 ea4

Wheel Voltage [V]

2 1 0 -1 -2 -3 -4 -5 0 50 100 time [s] 150

200

Figure 7.2: Wheel Voltage, Wheel Speed and Wheel Torques Fault Tolerance Results using NFFTSMC Controller and NFTSMC Controller: t=70s, Actuator Fault; t=80s, Actuator noise

220

q with NFFTSMC
e
1 0.8 1 0.8

q with NTSMC
e

Quaternion Tracking Error

Quaternion Tracking Error
0 50 100 time [s] 150 200

0.6 0.4 0.2 0 -0.2 -0.4 -0.6

0.6 0.4 0.2 0 -0.2 -0.4 -0.6

0

50

100 time [s]

150

200

Wheel Torque with NFFTSMC
0.08 0.06 0.04 0.02 0 -0.02 -0.04 -0.06 -0.08 -0.1  0.15
1

Wheel Torque with NTSMC

1

2 3 0.1

2 3 4 0.05

Wheel Torque [Nm]

Wheel Torque [Nm]
200

4

0

-0.05

0

50

100 time [s]

150

0

50

100 time [s]

150

200

Figure 7.3: Quaternion Tracking Error and Wheel Torques Results using NFFTSMC controller and NTSMC Controller: t=70s, Actuator Fault; t=80s, Actuator noise

221

q with 2ndSMC
1 0.8

e

q with 3rdSMC
1 0.8

e

Quaternion Tracking Error

0.6 0.4 0.2 0 -0.2 -0.4 -0.6

Quaternion Tracking Error
0 50 100 time [s] 150 200

0.6 0.4 0.2 0 -0.2 -0.4 -0.6

0

50

100 time [s]

150

200

 with 2ndSMC
0.15

e

 with 3rdSMC
0.15

e

0.1

Angular Velocity Tracking Error[rad/s]
0 50 100 time [s] 150 200

Angular Velocity Tracking Error

0.1

0.05

0.05

0

0

-0.05

-0.05

-0.1

-0.1

-0.15

-0.15

-0.2

-0.2

0

50

100 time [s]

150

200

Figure 7.4: Quaternion Tracking Error, Angular Velocity Tracking Error Fault Tolerance Results using 2nd SMC Controller and 3rd SMC Controller : t=70s, Actuator Fault; t=80s, Actuator noise

222
Wheel Torque with 2ndSMC
1 2 3 4

0.1 0.08 0.06

0.1 0.08 0.06

Wheel Torque with 3rdSMC
1 2 3 4

Wheel Torque [Nm]

0.04 0.02 0 -0.02 -0.04 -0.06 -0.08 -0.1 0 50 100 time [s]

Wheel Torque [Nm]
200

0.04 0.02 0 -0.02 -0.04 -0.06 -0.08

150

-0.1

0

50

100 time [s]

150

200

500 400 300

Wheel Speed with 2ndSMC

600

Wheel Speed with 3rdSMC

400

Wheel Speed [rad/s]

200 100 0 -100 -200 -300 -400 -500 0 1 2 3 4 50 100 time [s] 150 200

Wheel Speed [rad/s]

200

0

-200

1 2 3 4

-400

-600

0

50

100 time [s]

150

200

5 4 3

Wheel Input Voltage with 2ndSMC
ea1 ea2

5 4 3

Wheel Input Voltage with 3rdSMC

Wheel Voltage [V]

2 1 0 -1 -2 -3 -4 -5 0 50 100 time [s]

Wheel Voltage [V]

ea3 ea4

2 1 0 -1 -2 -3 -4 ea1 e
a2

ea3 ea4 0 50 100 time [s] 150 200

150

200

-5

Figure 7.5: Wheel Voltage, Wheel Speed and Wheel Torques Fault Tolerance Results using 2nd SMC Controller and 3rd SMC Controller: t=70s, Actuator Fault; t=80s, Actuator noise

223

Figure 7.6: Spherical Air Bearing System Model

Figure 7.7: Spherical Air Bearing Setup with Electronics System and Control System

224

Figure 7.8: Software Flow Chart of Spherical Air Bearing System

225 like Matlab and Simlink is very useful. However, an autonomous ACS that can be used on nanosatellites should be tested in a real time simulation environment. A nonlinear fault tolerant control algorithm needs to be investigated to manage the nonlinear satellite sensor and actuator dynamics, but there have been few actual implementations. With the development of smaller and cheaper micro-processors, autonomous nonlinear discrete control algorithms should be possible for an ACS. We applied the fault tolerant controller on an air bearing nanosatellite system to validate the control system (shown in Figs. 7.6 and 7.7). To overcome faults and noise injected into the hardware, adaptive terminal sliding mode control laws with a fuzzy system were developed, and tested on the spherical air bearing system. The proposed controller law can achieve a better attitude tracking accuracy than the PID controller in the reference [Ustrzycki 2011]. Experimental results showed the proposed analytical fault tolerant control laws to be effective.

7.3.1

Control Software

The discrete version of the controller is programmed in C. The output of the software is a PWM signal sent to the nanosatellite reaction wheel system. The program first initializes the controller and nanosatellite hardware. Following initialization, the controller completes the control loop at each time step. A sampling time of 1ms was used to average the data from a yaw rate gyro, and the control loop was run every 10 ms. The software flow chart is shown in Fig. 7.8.

7.3.2
7.3.2.1

Results and Discussion
Case 1 Results

The proposed AFSMC in this dissertation was applied to an air bearing attitude control testing system. The design parameters of control laws are in Tables 7.7, and 7.8. The AFSMC controller was used to perform a 90 yaw slew maneuver of a nanosatellite. The

226 only other controller previously tested in this air bearing system was a PID controller. Figs. 7.9 and 7.10 show the results of a 90 slew of the system. Fig. 7.11 shows the controller values used. Fig. 7.12 shows the PWM signal sent to the reaction wheel system during this test. The nanosatellite makes a 90 slew with a settling time of roughly 60 seconds, settling on a steady state error of 0.8 using AFSMC. The PID controller has a steady state error of approximately 5 . Figs. 7.13 and 7.14 show the results of a 180 slew of the system with actuator fault. The fault occurred between t = 20 - 120s. Two actuator faults were tested. One is the "Reduction Fault" in which output torque is reduced by 50%. Another is the "Constant Fault" in which a constant torque offset of 25% of maximum is added between t = 20 - 120s. Fig. 7.15 shows the controller values used. Figs. 7.16 and 7.17 show the PWM signal sent to the reaction wheel system and the applied motor torque fraction of maximum. The nanosatellite makes a 180 slew with a settling time of roughly 150 seconds, settling on a steady state error of 0.8 using AFSMC. The PID controller still has a steady state error of approximately 5 . The PID controller equation is given by
t

P ID = kp e + ki
0

e + kd e 

(7.25)

The nonlinear AFSMC controller for a satellite in these tests is now given by AF SM C = -k1 s - T  - tanh(  = s  3Ku s )  (7.26) (7.27)

where s is the sliding surface. , ,  are positive constant numbers.  is built using a Fuzzy Logic System. Remark. The proposed AFSMC control method has smaller steady state errors than the PID controller. However, the response speed of the PID controller is faster than the AFSMC controller. The author suggests that one possible solution is to improve the fuzzy rules. The current fuzzy rules are not based on expert knowledge. Using modified fuzzy rules may enhance the controller response.

227

Table 7.7: PID Controller Parameters for Numerical Analysis Name Proportional parameters Integral parameters Derivative parameters Design Parameters kp ki kd Values 0.026 0.0001 0.1

Table 7.8: AFSMC Controller Parameters for Numerical Analysis Parameters ,  k1 0 ,  Values 0.01, 0.0001 0.004 0, 0.1
Air Bearing Testing 140

120

100 Angle (degrees)

80

60

40

PID AFSMC

20

0

0

20

40

60

80 100 Time (s)

120

140

160

180

Figure 7.9: Nanosatellite 90 Degrees Slew

228

Air Bearing Testing 100

80

60 Error (degrees)

PID AFSMC

40

20

0

-20

-40

0

20

40

60

80 100 Time (s)

120

140

160

180

Figure 7.10: Nanosatellite Tracking Error during 90 Degrees Slew

229

Air Bearing Testing 1 0.8 0.6 Control (torque fraction) 0.4 0.2 0 -0.2 -0.4 -0.6 -0.8 -1 0 20 40 60 80 100 Time (s) 120 140 160 180 PID AFSMC

Figure 7.11: Nanosatellite Control during 90 Degrees Slew

230

Air Bearing Testing 3000

2500 PID PWM (timer ticks) 2000 AFSMC

1500

1000

500

0

0

20

40

60

80 100 Time (s)

120

140

160

180

Figure 7.12: Nanosatellite PWM Signal during 90 Degrees Slew

231

Air Bearing Testing 300 PID 250 AFSMC Reduction Fault AFSMC Constant Fault 200 Angle (degrees)

150 Fault happened at t=20s-120s. 100

50

0

-50

0

50

100

150 Time (s)

200

250

300

Figure 7.13: Nanosatellite 180 Degrees Slew with Actuator Faults

232

Air Bearing Testing 200

150

PID AFSMC Reduction Fault AFSMC Constant Fault

100 Error (degrees)

50

0

-50

Fault happened at t=20s-120s.

-100

-150

0

50

100

150 Time (s)

200

250

300

Figure 7.14: Nanosatellite Tracking Error during 180 Degrees Slew with Actuator Faults

233

Air Bearing Testing 3 2 1 Control (torque fraction) 0 -1 -2 -3 -4 -5 Fault happened at t=20s-120s. AFSMC Reduction Fault AFSMC Constant Fault PID

0

50

100

150 Time (s)

200

250

300

Figure 7.15: Nanosatellite Control during 180 Degrees Slew with Actuator Faults

234

Air Bearing Testing 1 0.8 0.6 Torque (timer ticks) 0.4 0.2 0 -0.2 -0.4 -0.6 -0.8 -1 0 50 100 Fault happened at t=20s-120s. 150 Time (s) 200 250 300 AFSMC Reduction Fault AFSMC Constant Fault PID

Figure 7.16: Nanosatellite Torque during 180 Degrees Slew with Actuator Faults

235

PWM 3000 Fault happened at t=20s-12s. . AFSMC Reduction Fault AFSMC Constant Fault PID

2500

2000 PWM

1500

1000

500

0

0

50

100

150 Time (s)

200

250

300

Figure 7.17: Nanosatellite PWM Signal during 180 Degrees Slew with Actuator Faults

236 7.3.2.2 Case 2 Results

In this section, we test the adaptive fuzzy sliding mode controller, PID, 2nd SMC and 3rd SMC with actuator faults. Figs. 7.18 and 7.19 show the results of a 90 slew of the system. Fig. 7.20 shows the controller output during these tests. The tracking errors are nearly the same using all three controllers. The AFSMC controller needs less actuator energy than the other controllers. Fig. 7.21 shows a longer test for the 90 slew maneuver. Next, we added actuator faults using AFSMC, PID, 2nd SMC and 3rd SMC. Figs. 7.22 and 7.23 show the results and control of a 90 slew of the system with the actuator experiencing a "Constant Fault" in which a constant torque offset of 25% of maximum is added between t = 180 - 240s. Figs. 7.24 and 7.25 show the fuzzy logic system and sliding surface values. The dynamic changes due to faults are represented by the fuzzy logic system "Hr = T  ". The sliding motion of "Srp " is broken by the fault and recovers quickly in the controller. The robustness of the proposed AFSMC controller is the best out of the four compared. The PID controller can not handle the faults as effectively as the sliding mode controllers. The 2nd SMC tracking error is not as good as that of AFSMC and 3rdSMC.

237

90 80 70 60 Angle (degrees) 50 40 30 20 10 0 -10 0 20 40 60 80 100 Time (s) 120 140 160 180 AFSMC 2nd SMC 3rd SMC

Figure 7.18: Nanosatellite 90 Degrees Slew with AFSMC, 2nd SMC and 3rd SMC in 180 s

238

100 90 80 70 Error (degrees) 60 50 40 30 20 10 0 0 20 40 60 80 100 Time (s) 120 140 160 180 AFSMC 2nd SMC 3rd SMC

Figure 7.19: Nanosatellite Tracking Error during 90 Degrees Slew with AFSMC, 2nd SMC and 3rd SMC in 180 s

239

0.6 0.4 0.2 0 -0.2 -0.4 3rd SMC -0.6 -0.8 2nd SMC AFSMC 0 20 40 60 80 100 Time (s) 120 140 160 180

Figure 7.20: Nanosatellite Control during 90 Degrees Slew with AFSMC, 2nd SMC and 3rd SMC in 180 s

Control (torque fraction)

240

100 AFSMC 80 2nd SMC 3rd SMC Error (degrees) 60 0 40 -0.5 -1 200 0.5 1

20

210

220

230

240

250

0

-20

0

50

100 Time (s)

150

200

250

Figure 7.21: Nanosatellite 90 Degrees Slew with AFSMC, 2nd SMC and 3rd SMC in 250 s

241

100

80 AFSMC 60 Error (degrees) 3rd SMC 2nd SMC PID 40

20

0

-20

0

50

100

150

200 Time (s)

250

300

350

Figure 7.22: Nanosatellite 90 Degrees Slew tracking errors with AFSMC, 2nd SMC, 3rd SMC and PID in 360 s

242

1.5 1 0.5 Control (torque fraction) 0 -0.5 -1 -1.5 -2 -2.5

AFSMC 2nd SMC 3rd SMC PID

0

50

100

150 200 Time (s)

250

300

350

Figure 7.23: Nanosatellite Control Input using AFSMC, 2nd SMC, 3rd SMC and PID in 360 s

243

Fuzzy Logic System 0.6

0.4

0.2

0 Hr -0.2 -0.4 -0.6 -0.8 0

50

100

150 200 Time (s)

250

300

350

Figure 7.24: Fuzzy Logic System with AFSMC in 360 s

244

Sliding Plane 4

AFSMC 3 3rd SMC 2nd SMC 2

1 Srp 0 -1 -2 -3 0

50

100

150

200 Time (s)

250

300

350

Figure 7.25: Sliding Motion of AFSMC, 2nd SMC and 3rd SMC in 360 s

245

7.4

Conclusions

Attitude control of small satellites is still predominantly performed by standard controllers such as Proportional-Integral-Derivative controllers. The implementation complexity of nonlinear control hinders the development of practical implementations for ACS. In this dissertation, numerical research on nonlinear control has been performed carefully. The purpose of this chapter is to verify the proposed adaptive fuzzy sliding mode control law on an air bearing system. A similar approach with an air bearing system has been used at the Surrey space centre [Horri et al. 2011]. However, this work did not include fault tolerant control. The control in [Horri et al. 2011] uses PD and optimal control laws. In this chapter, nonlinear AFSMC control has been successfully verified on an air bearing simulator.

Chapter 8

Conclusions

In the past, a large satellite did not need on-board fault tolerant control due to the ground station control and expert manual management available. Due to cost and weight limitations, the micro/nano/pico-satellites studied in this research need real time fault tolerant control. With the development of smaller and cheaper micro-processors, intelligent fault detection, identification, and fault tolerant control algorithms should be possible in the attitude control system. This is an important challenge, and considerable attention has been paid to this research in recent years. In this chapter, contributions to fault tolerant control for small satellites are reviewed based on the techniques presented in the previous chapters. The discussion of limitations and future work is concluded with a few final remarks.

8.1

Contributions Outline

The design and simulations of the advanced control strategies and integrated fault detection and identification and fault tolerant control systems for satellite formation flying and attitude control system have been presented in this dissertation. An overall dynamic system model is needed not only for designing and for the simulation control algorithm of fault detection and identification and fault tolerant control, but also for evaluating fuel and energy consumption and fault levels. Satellite formation flying is modelled as leader-follower formation flying. Attitude control system is modelled with quaternion and actuated by reaction wheels. Centralized attitude synchronization and decentralized satellite attitude synchronization are modelled differently. For decentralized satellite formations, graph theory is used for the communication links of each satellite. The actuator model is included

248 as well. The system, controller, actuator, and sensor constitute the key components for proper functioning of the control systems of satellite formation flying. For the proposed fault detection and identification and fault tolerant control strategies, the exact model is not necessary. In order to compare with the existing model-based fault detection and identification and fault tolerant control, the system model is presented in detail in this research. The major contributions of the dynamic model development can be summarized as follows: · Attitude Synchronization An overall dynamics model for attitude synchronization during formation flying with actuator dynamics was developed that is different from existing references. · Decentralized Attitude Synchronization To address the uncertainties associated with communication, a consensus concept with graph theory was used in this research. In order to employ a novel control algorithm to address these issues, station keeping attitude tracking and formation keeping attitude tracking was defined in this study. This methodology was not used for attitude synchronization in the existing references with quaternion as kinematics model. There are several reasons to use the proposed controller in satellite formation flying and attitude control systeMs: first, the existense of disturbances such as J2 for satellite formation flying and gravity gradient torque and external periodic disturbances for attitude control system; second, the influence of process and measurement noise on the system, such as thruster noise and sensor noise for satellite formation flying and attitude control system. Existing literature on the use of a controller for satellite formation flying and attitude control system focuses on the development of linear control techniques and is evaluated for a limited operating range. In this dissertation, nonlinear control algorithms with intelligence that are capable of accurate trajectory tracking, fast satellite maneuvering and reconfiguration are developed. The proposed methodology is evaluated for a wide range of operating conditions in a more realistic space environment. In total, three novel control

249 strategies were designed in this dissertation to deal with different situations. Simulation results and many examples were presented for each control design. The following is a brief summary of the main contributions of the proposed controllers: · High Sliding Mode Control A sliding mode control methodology typically experiences chattering, which is the biggest shortcoming for sliding mode control applications. Here, a chattering free second order sliding mode control algorithm was proposed to address these issues. The higher order sliding mode control technique is also implemented to support small satellite attitude control with reaction wheels. Fuel consumption and energy use of the high order sliding mode control was verified to be the smallest, and control accuracy was shown to be the most precise of all the control algorithms. · Adaptive Fuzzy Sliding Mode Control Due to the lack of precise knowledge of all the parameters in the environmental models and their time varying nature, adaptive fuzzy sliding mode control laws were developed. The controllers also use a chattering free control algorithm and is implemented for small satellite attitude control with reaction wheels, an implementation not present in the references. Adaptive fuzzy sliding mode control was designed for better system performance. However, this controller with input saturation can also reduce energy efficiency. · Underactuated Satellite Control Satellite formation flying with one of the thrusters failing represents an underactuated control problem, and the existing literature proposes hybrid controllers or proposes control methodologies based on linear techniques resulting in a restricted range of operation within the system model. Here, adaptive fuzzy sliding mode control as an underactuated control algorithm does not need the system model and provides stability proofs are presented for the resulting closed-loop system.

250 There is a need to design fault tolerant control strategies because faults in attitude control system during the satellite mission lifetime can not always be avoided. It is desirable that faults in the system, controller, actuator and sensor can be detected and identified without using hardware redundant devices. For the application in this dissertation, Nano/Pico-satellites cannot use hardware redundancy at all due to their size, volume and budget. In order to compare with the existing methodology, model-based fault detection and diagnosis based on sliding mode observers was employed to isolate the sensor and thruster fault in satellite formation flying. Then, the proposed fault detection and fault tolerant strategies were designed to improve the total performance of satellite formation flying. In fault tolerant control systems, the error input to the controller was calculated based on the online measurement as well as the error correction function using fault detection and identification information. The advantages of the proposed fault detection and identification and fault tolerant control systems include improving the system performance and saving energy in the system. The following is a brief summary of the main contributions of fault detection and identification and fault tolerant control: · Fault Detection Identification and Fault Tolerant Control for Satellite Formation Flying with Thruster Fault and Sensor Fault Model-based fault detection and identification was studied in satellite formation flying with thruster fault and sensor fault. Proposed fault detection and identification was tested and compared with model-based fault detection and identification for satellite formation flying. An error correction function was formulated based on fuzzy logic and sliding mode for fault tolerant control strategies to adjust the error signals of the control systems due to the fault. The designed fault tolerant control were robust to system disturbances and had better tracking accuracy. · Fault Tolerant Control for Attitude Control System with Actuator Fault To counter the effects of the actuator faults and noise, adaptive fuzzy sliding mode control laws with fuzzy logic system were developed and tested for attitude control system. The controller law can increase attitude tracking control accuracy without

251 redundant reaction wheels. Simulations and experimental results show the proposed analytical fault tolerant control laws to be effective.

8.2

Limitations of the Control Methods

In this section it is also appropriate to mention some of the limitations/disadvantages identified in this research. The current research is limited in terms of actual implementation. Accurately simulating the environment of outer space on Earth for testing of space hardware is a very challenging task. Nearly every environmental variable is completely different, from pressure, gravity and temperature to the radiation and charged particles present outside the earth's atmosphere. In addition, the stresses of launch and deployment must be considered. To test a system's resiliency to these conditions, it is typically necessary to simulate one or two individual conditions at a time, such as pressure and temperature extremes (thermal vacuum testing), radiation effects (cyclotron testing), and mechanical stresses from launch (vibration testing). This complicates the process of hardware validation, since hardware performance must be evaluated during each test while performing the function appropriate to that environment, and the cumulative effect of environmental conditions cannot be at once determined. As a result, actual hardware performance data from operating satellites and space hardware is generally considered much more valuable than ground test data, and for most mission-critical hardware, it is preferable to it that have been previously flight tested (except in the case of dedicated testing or demonstration missions).

8.3

Future Work

This study proposes techniques to utilize fault detection and identification and fault tolerant control for satellite formation or attitude control. Theoretical results are examined through numerical simulation. There remain several areas yet to be explored. Some of these areas for future work are outlined as follows:

252 · Apply a type-2 fuzzy sliding mode control for satellite formation flying or attitude control system. The main property of a fuzzy logic system is its capacity to represent and model imprecision and uncertainty by giving each point in the fuzzy set a value belonging to the interval between 0 and 1. However, such a classic fuzzy system, which is a type-1 fuzzy logic system is not fully exploited and can not deliver perfect performance. Type-2 fuzzy logic systems have been developed recently. The membership functions of these fuzzy systems have a new third dimension. Fault detection and identification and fault tolerant control using Type-2 fuzzy logic systems can have better performance than Type-1 fuzzy logic systems [Al-khazraji et al. 2011]. Also, the computational load problem in fault estimation must be solved for fuzzy logic systems with the constraints of a real satellite on-board computer. · Study satellite attitude fault detection and identification and fault tolerant control with sensor fault [Samy et al. 2011]. Usually the sensors used for space systems are quite stable. In this dissertation, we assume that actuator and sensor faults do not happen simultaneously. Sensor fault detection and isolation has been studied in detail for decades. Extended Kalman filter and unscented Kalman filter are the most popular tools for satellite attitude fault detection and isolation [Xiong et al. 2007]. Nonlinear filter and observer have been surveyed in the reference [Crassidis et al. 2007]. It is not difficult to detect sensor faults and isolate the fault. However, the nonlinear dynamics model and quaternion kinematics of satellites will make the design of sensor fault tolerant control to be a critical issue. The methodologies of sensor fault tolerant control design can be very complex. Therefore, a novel and simplifed fault tolerant control design with sensor fault and sensor noise will be a focus of future research. · Overcome an unwinding phenomenon in attitude control of a rigid satellite. A quaternion based feedback control law can cause the unwinding phenomenon. This phenomenon will cause fuel consumption and vibration suppression problems [Bhat & Bernstein 2000]. Novel global asymptotic quaternion based attitude control design

253 which can solve the unwinding phenomenon and tolerate sensor noise will be another important direction of future research.

References
[Abdessameud & Tayabi 2008] Abdessameud, A., & Tayabi, A., "Decentralized attitude alignment control of spacecraft with a formation without angular velocity measurements," Proceedings of the 17th IFAC World Conference, 2008, Pages: 1766­1771. 18 [Al-khazraji et al. 2011] Al-khazraji, A., Essunbouli, N., Hamzaoui, A., Nollet, F., & Zaytoon, J., "Type-2 fuzzy sliding mode control without reaching phase for nonlinear system," Engineering Applications of Artificial Intelligence, Vol. 24, 2011, Pages: 23­28. 252 [Alwi et al. 2008] Alwi, H., Edwards, C., Stroosma, O, & Mulder, J. A., "Fault Tolerant Sliding Mode Control Design with Piloted Simulator Evaluation," Journal of Guidance, Control, and Dynamics, Vol. 31, No. 5, 2008, Pages: 1186­1201. xxv, 14, 17, 173, 180, 191, 201, 205, 206 [Azizi & Khorasani 2008] Azizi, S. M., & Khorasani, K., "Cooperative fault accommodation in formation flying satellites," Proceedings of American Control Conference, WrB01.4, September 3-5, 2008. 15 [Bakule 2008] Bakule, L., "Decentralized control: An overview," Annual Reviews in Control, Vol. 32, 2008, Pages: 87­98. 18, 143 [Benosman & Lum 2010] Benosman, M., & Lum, K. Y., "Passive actuators' fault-tolerant control for affine nonlinear systems," IEEE Transactions on Control Systems Technology, Vol. 18, No. 1, 2010, Pages: 152­163. 13 [Benosman 2010] Benosman, M., "A Survey of Some Recent Results on Nonlinear Fault Tolerant Control," Mathematical Problems in Engineering, 2010, Pages: 1­15. 15

256 [Bhat & Bernstein 2000] Bhat, S. P., & Bernstein, D. S., "A topological obstruction to continuous global stailization of rotational motion and the unwinding phenomenon," Systems and Control Letters, Vol. 39, 2000, Pages: 63­70. 252 [Boskovi et al. 1999] Boskovi, J.D., Li, Sai-Ming, & Mehra, R.K., "Intelligent Control of Spacecraft in the Presence of Actuator Failures," Proceedings of the 38th IEEE Conference on Decision and Control, Vol. 5, Phoenix, AZ, Dec. 7-10, 1999, Pages: 4472­4477. 18 [Brambilla et al. 2008] Brambilla, D, Capisani, L. M., Ferrara, A., & Pisu, P., "Fault Detection for Robot Manipulators via Second-Order Sliding Modes," IEEE Transactions on Industrial Electronics, Vol. 55, No. 11, 2008, Pages: 3954­3963. 178 [Cai et al. 2008] Cai, W. C., Xiao, X. L., & Song, Y.D., "Indirect Robust Adaptive FaultTolerant Control for Attitude Tracking of Spacecraft," Journal of Guidance, Control, and Dynamics, Vol. 31, No. 5, 2008, Pages: 1456­1463. 17 [Castel & Saleh 2009] Castel, J. F., & Saleh, J. H., "Satellite reliability statistical data analysis and modeling," Journal of Spacecraft and Rockets, Vol. 46, No. 5, 2009, Pages: 1065­1076. 1 [Chan et al. 2001] Chan, P. T., Rad, A. B., & Wang, J., "Indirect Adaptive Fuzzy Sliding Mode Control: Part II: Parameter Projection and Supervisory Control," Fuzzy Sets and System, Vol. 122, No. 1, 2001, Pages: 31­43. 110 [Changa et al. 2009] Changa, I., Park, S.-Y., & Choi, K.-H., "Decentralized Coordinated Attitude Control for Satellite Formation Flying via the state-dependent Riccati equation technique," International Journal of Non-Linear Mechanics, Vol. 44, No. 8, 2009, Pages: 891­904. 18, 147 [Chen & Lin 2011] Chen, S. Y., & Lin, F. J., "Robust nonsingular terminal sliding mode control for nonlinear magnetic bearing system," IEEE Transactions on Control System Technology, Vol. 19, No. 3, 2011, Pages: 636­643. 20

257 [Chen et al. 2006] Chen, R. H., Ng, H. K., Spey, J. L., Guntur, L. S., & Carpenter, R., "Health Monitoring of a Satellite System," Journal of Guidance, Control and Dynamics, Vol. 29, No. 3, 2006, Pages: 593­604. 68 [Chobotv 2002] Chobotv, V.A., Orbital Mechanics, AIAA Education Series, AIAA, Reston, VA, 2002. 8 [Clohessy & Wiltshire 1960] Clohessy, W., & Wiltshire, R., "Terminal guidance systems for satellite rendezvous," Journal of the Astronautical Sciences, Vol. 27, No. 9, 1960, Pages: 653­658. 8 [Corradini et al. 2011] Corradini, M. L., Monteriu, A., & Orlando, G., "An Actuator Failure Tolerant Control Scheme for an Underwater Remotely Operated Vehicle," IEEE Transactions on Control Systems Technology, Vol. 19, No. 5, 2011, Pages: 1036­ 1046. 186 [Crassidis et al. 2007] Crassidis, J. L., Markley, F. L., & Cheng, Y., "Survey of Nonlinear Attitude Estimation Methods," Journal of Guidance Control and Dynamics, Vol. 30, No. 1, 2007, Pages: 12­28. 252 [Das & Lewis 2010] Das, A., & Lewis, F. L., "Distributed adaptive control for synchronization of unknown nonlinear networked systems," Automatica, Vol. 46, No. 12, 2010, Pages: 2014­2021. 18, 143 [Davila et al. 2005] Davila, J., Fridman, L., & Levant, A., "Second-order sliding mode observer for mechanical systems," IEEE Transactions on Automatic Control, Vol. 50, No. 11, 2005, Pages: 1785­1789. 178, 179 [de Queiroz et al. 2000] de Queiroz, Marcio S., Kapila, Vikram, & Yan, Qiguo, "Adaptive nonlinear control of multiple spacecraft formation flying," Journal of Guidance, Control, and Dynamics, Vol. 23, No. 3, 2000, Pages: 385­390. 12

258 [Defoort et al. 2009a] Defoort, M., Floquet, T., Kokosy, A., & Perruquetti, W., "A Novel Higher Order Sliding Mode Control Scheme," Systems and Control Letters, Vol. 58, 2009, Pages: 102­108. 13 [Defoort et al. 2009b] Defoort, M., Nollet, F., Floquet, T., & Perruquetti, W., "A Third Order Sliding Mode Controller for a Stepper Motor," IEEE Transactions on Industrial Electronics, Vol. 56, No. 9, 2009, Pages: 3337­3346. 20 [Demetriou & Polycarpou 1998] Demetriou, M.A., & Polycarpou, M. M., "Fault detection, diagnosis and accommodation of dynamical systems with actuator failures via online approximators," Proceedings of the 1998 American Control Conference, Philadelphia, PA, 1998, Pages: 2879­2883. 16 [Diao & Passino 2001] Diao, Y.X., & Passino, K.M., "Stable Fault-Tolerant Adaptive Fuzzy/Neural Control for a Turbine Engine," IEEE Transactions on Control Systems Technology, Vol. 9, No. 3, 2001, Pages: 494­509. 14 [Diao & Passino 2004] Diao, Y. X., & Passino, K. M., "Fault Diagnosis for a Turbine Engine," Control Engineering Practice, Vol. 14, 2004, Pages: 1151­1165. 180 [Digest 2011] Digest, Satellite News. "Satellite News Digest," , 2011. Satellite News Digest. 2, 4 [Dong et al. 2009] Dong, C. Y., Xu, L. J., Chen, Y., & Wang, Q., "Networked flexible spacecraft attitude maneuver based on adaptive fuzzy sliding mode control," Acta Astronautica, Vol. 65, No. 11-12, 2009, Pages: 1561­1570. 15 [Edwards et al. 2007] Edwards, C., Fridman, L., & Thein, M.-W. L, "Fault reconstruction in a leader/follower spacecraft system using higher order sliding mode observers," Proceedings of American Control Conference, WeA13.1, July 11-13, 2007. xxv, 11, 15, 180, 191, 198, 199, 200

259 [Elimali & Olgac 1992] Elimali, H., & Olgac, N., "Robust Output Tracking Control of Nonlinear MIMO Systems via Sliding Mode Technique," Automatica, Vol. 28, No. 1, 1992, Pages: 145­151. 13 [Ellen et al. 2005] Ellen, Applebaum, Joseph, Ben-Asher, & Tanchum, Weller, "Fuzzy Gain Scheduling for Flutter Suppression in an Unmanned Aerial Vehicle," Journal of Guidance, Control, and Dynamics, Vol. 28, No. 6, 2005, Pages: 1123­1130. 17 [Ellery et al. 2008] Ellery, A., Kreisel, J., & Sommer, B., "The case for robotic on orbit servicing of spacecraft: spacecraft reliability is a myth," Acta Astronautica, Vol. 63, 2008, Pages: 632­648. 2 [Eyer 2009] Eyer, J. K., "A Dynamics and Control Algorithm for Low Earth Orbit Precision Formation Flying Satellites," Ph.D. Dissertation, Graduate Department of Aerospace Science and Engineering, University of Toronto, 2009. 12 [Feng et al. 2002a] Feng, Y., Yu, X., & Man, Z., "Non-singular terminal sliding mode control of rigid manipulators," Automatica, Vol. 38, No. 12, 2002, Pages: 2159­2167. 20 [Feng et al. 2002b] Feng, Y., Yu, X.H., & Man, Z.H., "Indirect Robust Adaptive FaultTolerant Control for Attitude Tracking of Spacecraft," Automatica, Vol. 38, 2002, Pages: 1456­1463. 15 [Fontdecaba 2008] Fontdecaba, Jordi, "Dynamics of formation flying Applications to Earth and Universe observation," PhD Thesis Observatoire de Paris Ecole Doctorale Astronomie et Astrophyisique d'I1 de France, Vol. 63, 2008, Pages: 632­648. xix, 7, 8 [Fragkoulis et al. 2011] Fragkoulis, D., Roux, G., & Dannou, B., "Detection, isolation and identification of multiple actuator and sensor faults in nonlinear dynamic systems: Application to a waste water treatment process," Applied Mathematical Modelling, Vol. 35, 2011, Pages: 522­543. 180

260 [Fragopoulos & Innocenti 2004] Fragopoulos, D., & Innocenti, M., "Stability considerations in quaternion attitude control using discontinuous Lyapunov functions," IEE Proceedings Control Theory and Applications, Vol. 151, No. 3, 2004, Pages: 253­258. 144 [Fridman 1993] Fridman, L. M., "Stability of Motions in Singularly Perturbed Discontinuous Control Systems," Proceedings of IFAC World Conference, Sydney, 1993, Pages: 367­370. 13 [Godard & Kumar 2010] Godard, & Kumar, K. D., "Fault Tolerant Reconfigurable Satellite Formations Using Adaptive Variable Structure Techniques," Journal of Guidance, Control, and Dynamics, Vol. 33, No. 3, 2010, Pages: 969­984. 12, 31, 83, 93 [Godsil & Royle 2001] Godsil, C., & Royle, G., Algebraic Graph Theory, Springer- Verlag, New York, 2001. 150 [Green & Sasiadek 2006] Green, A., & Sasiadek, J. Z., "Heuristic Design of a Fuzzy Controller for a Flexible Robot," IEEE Transactions on Control Systems Technology, Vol. 14, No. 2, 2006, Pages: 293­300. 19 [Gurfil & Kasdin 2003] Gurfil, P., Idan M., & Kasdin, N. J., "Adaptive Neural Control of Deep-Space Formation Flying," Journal of Guidance, Control, and Dynamics, Vol. 26, No. 3, 2003, Pages: 491­501. 12 [Hill 1878] Hill, G.W., "Researches in the lunar theory," American Journal of Mathematics, Vol. 1, 1878, Pages: 5­26. 8, 12 [Horri et al. 2011] Horri, N. M., Plamer, P. L., & Robers, M., "Energy Optimal Spacecraft Attitude Control Subject to Convergence rate Constraints," Control Engineering Practice, Vol. 19, 2011, Pages: 1297­1314. 245

261 [Hou et al. 2009] Hou, Z.-G., Zou, A.-M., Cheng, L., & Tan, M., "Adaptive Control of an Electrically driven nonholonomic mobile robot via backstepping and fuzzy approach," IEEE Transactions on Control System Technology, Vol. 17, No. 4, 2009, Pages: 803­815. 154, 214 [Hu 2010] Hu, Q., "Robust adaptive sliding-mode fault-tolerant control with L2-gain performance for flexible spacecraft using redundant reaction wheels," IET Control Theory and Applications, Vol. 4, No. 6, 2010, Pages: 1055­1070. 19 [Huang & Tan 2008] Huang, S. N., & Tan, K. K., "Fault detection, isolation, and accommodation control in robotic systems," IEEE Transactions on Automation Science and Engineering, Vol. 5, No. 3, 2008, Pages: 480­489. 16 [Hughes 1986] Hughes, P.C., Spacecraft Attitude Dynamics, John Wiley, Son, New York, 1986. 104 [Hui & Li 2009] Hui, L., & Li, J. F., "Terminal Sliding Mode Control for Spacecraft Formation Flying," IEEE Transactions on Aerospace and Electronic Systems, Vol. 45, No. 3, 2009, Pages: 835­846. 15 [Hwang et al. 2010] Hwang, I., Kim, S., Kim, Y., & Eng Seah, C., "A survey of fault detection, isolation and reconfiguration methods," IEEE Transactions on Control Systems Technology, Vol. 18, No. 3, 2010, Pages: 636­653. 10, 15 [Jiang et al. 2009] Jiang, Y., Hu, Q. L., & Ma, G.F., "Adaptive Backstepping Fault Tolerant Control for Flexible Spacecraft with Unknown Bounded Disturbances and Actuator Failures," ISA Transactions, Vol. 49, No. 1, 2009, Pages: 57­69. 17, 104 [Jiang et al. 2010] Jiang, B., Gao, Z. F., Shi, P., & Xu, Y. F., "Adaptive Fault-Tolerant Tracking Control of Near-Space Vehicle Using Takagi-Sugeno Fuzzy Models," IEEE Transactions on Fuzzy Systems, Vol. 18, No. 5, 2010, Pages: 1000­1007. 15

262 [Jiang et al. 2011] Jiang, B., Zhang, K., & Shi, P., "Integrafted Fault Estimation and Accommodation Design for Discrete-Time T-S Fuzzy Systems with Actuator Faults," IEEE Transactions on Fuzzy Systems, Vol. 19, No. 2, 2011, Pages: 291­304. 18 [Jin et al. 2008] Jin, J.H., Ko, S.H., & Ryoo, C.-K., "Fault tolerant Control for Satellites with Four Reaction Wheels," Control Engineering Practice, Vol. 16, No. 10, 2008, Pages: 1250­1258. 144 [Khalil 2002] Khalil, H. K., Nonlinear Systems, Prentice-Hall, Upper Saddle River, NJ, 2002. 182 [Kim & Agrawal 2009] Kim, J. J., & Agrawal, B. N., "Automatic Mass Balancing of AirBearing-Based Three-Axis Rotational Spacecraft Simulator," Journal of Guidance, Control, and Dynamics, Vol. 32, No. 3, 2009, Pages: 1005­1017. 21, 209 [Kim & Kim 2003] Kim, K.-S., & Kim, Y. D, "Robust Backstepping Control for Slew Maneuver using Nonlinear Tracking Function," IEEE Transactions on Control Systems Technology, Vol. 11, No. 6, 2003, Pages: 822­829. 209 [Kristiansen & Nicklasson 2009] Kristiansen, R., & Nicklasson, P. J., "Spacecraft Formation Flying: A Review and New Results on State Feedback Control," Acta Astronautica, Vol. 65, No. 11-12, 2009, Pages: 1537­1552. 12 [Kristiansen et al. 2008] Kristiansen, R., Nichlasson, P.J., & Gravdahl, J.T., "Spacecraft Coordination Control in 6-DOF: Integrator Backstepping vs Passivity-based Control," Automatica, Vol. 44, 2008, Pages: 2896­2901. 17 [Krogastad & Gravdahl 2006] Krogastad, T.R., & Gravdahl, J.I., "6-DOF Mutual Synchronization of Formation Flying Spacecraft," Proceedings of the 45th IEEE Conference on Decision and Control, San Diego, CA, 2006, Pages: 5706­5711. 17 [Kruk et al. 2002] Kruk, J.W., Class, B.F., Rovner, D., Westphal, J., Ake, T.B., Moos, H.W., Roberts, B., & Fisher, L., "FUSE in-orbit attitude control with two reaction

263 wheels and no gyroscopes," Proceedings of SPIE - The International Society for Optical Engineering, Vol. 4854, Waikoloa, HI, Aug 22-23, 2002, Pages: 274­285. 4 [Kumar et al. 2007] Kumar, K.D., Bang, H.C., & Tahk, M.J., "Satellite formation flying using along-track thrust," Acta Astronautica, Vol. 61, No. 7-8, 2007. 15 [Labiod et al. 2005] Labiod, S., Boucherit, M.S., & Guerra, T.M., "Adaptive fuzzy control of a class of MIMO nonlinear systems," Fuzzy Sets and Systems, Vol. 151, No. 1, 2005, Pages: 59­77. 14, 113 [Laboratory 1994] Laboratory, Naval Research, "The Clementine Satellite," 1994. 9 [Laukonen et al. 1995] Laukonen, E. G., Passino, K. M., Krishnaswami, V., Luh, G.-C., & Rizzoni, G., "Fault Detection and Isolation for an Experimental Internal Combustion Engine via Fuzzy Identification," IEEE Transactions on Control Systems Technology, Vol. 3, No. 3, 1995, Pages: 347­355. 180 [Lawden 1954] Lawden, D., "Fundamentals of Space Navigation," Journal of the British Interplanetary Society, Vol. 13, No. 2, 1954, Pages: 87­101. 8 [Lee & Kim 2000] Lee, H., & Kim, Y., "Robust adaptive control using a universal approximator for SISO nonlinear systems," IEEE Transactions on Fuzzy Systems, Vol. 8, No. 1, 2000, Pages: 95­106. 157 [Leonard et al. 1989] Leonard, C.L., Hollister, W.M., & Bergmann, E.V., "Orbital formationkeeping with differential drag," Journal of Guidance, Control, and Dynamics, Vol. 12, No. 1, 1989, Pages: 108­113. 15 [Levant 2005] Levant, A., "Quasi-continuous High Order Sliding Mode Controllers," IEEE Transactions on Automatic Control, Vol. 50, No. 11, 2005, Pages: 1812­1816. 214 [Li & Kumar 2011] Li, J., & Kumar, K. D., "Fault Tolerant Attitude Synchronization Control during Formation Flying," Journal of Aerospace Engineering, Vol. 24, 2011, Pages: 251­263. 91

264 [Li et al. 2010] Li, J., Pan, Y. D., & Kumar, K. D., "Formation Flying Control of Small Satellites," Proceeding of the 2010 AIAA Guidance, Navigation, and Control Conference, Toronto, Ontario, August. 2-5, 2010. 186 [Lim & Bang 2009] Lim, H. C., & Bang, H.C., "Adaptive Control for Satellite Formation Flying Under Thrust Misalignment," Acta Astronautica, Vol. 65, No. 1-2, 2009, Pages: 112­122. 12, 13 [Lin & Chen 2007] Lin, C.-M., & Chen, C.-H., "Robust Fault-Tolerant Control for a Biped Robot Using a Recurrent Cerebellar Model Articulation Controller," IEEE Transactions on Systems, Man, and Cybernetics, Part B, Vol. 37, No. 1, 2007, Pages: 110­123. 19 [Lin & Hsu 2002] Lin, C. M., & Hsu, C. F., "Guidance Law Design by Adaptive Fuzzy Sliding mode Control," Journal of Guidance, Control, and Dynamics, Vol. 25, No. 2, 2002, Pages: 248­256. 14 [Lin & Wang 2010] Lin, D., & Wang, X. Y., "Observer-based decentralized fuzzy neural sliding mode control for interconnected unknown chaotic systems via network structure adaptation," Fuzzy Sets and Systems, Vol. 161, 2010, Pages: 2066­2080. 19 [Lin et al. 2008] Lin, J. Y., Ko, S.H., & Ryoo, Chang-Kyung., "Fault Tolerant Control of Satellites with Four Reaction Wheels," Control Engineering Practice, Vol. 16, 2008, Pages: 1250­1258. 17, 104, 209 [Lo & Chen 1995] Lo, S. C., & Chen, Y. P., "Smooth Sliding Mode Control for Spacecraft Attitude Tracking Maneuvers," Journal of Guidance Control and Dynamics, Vol. 18, No. 6, 1995, Pages: 1345­1349. 209 [Mahmoud 2009] Mahmoud, M., "Stabilization of Discrete Fault Tolerant Control Systems with Parameter Uncertainties," International Journal of Innovative Computing, Information and Control, Vol. 5, No. 8, 2009, Pages: 2415­2426. 19

265 [Man et al. 1994] Man, Z. H., Paplinski, A. P., & Wu, H. R., "Robust MIMO terminal sliding mode control scheme for rigid robotic manipulators," IEEE Transactions on Automatic Control, Vol. 39, No. 12, 1994, Pages: 2464 ­ 2469. 15 [Massey & Shtessel 2005] Massey, Timothy, & Shtessel, Yuri, "Continuous Traditional and High-Order Sliding Modes for Satellite Formation Control," Journal of Guidance Control and Dynamics, Vol. 28, 2005, Pages: 826­831. 12 [Mehrabian et al. 2009] Mehrabian, A. R., Tafazoli, S., & Khorasani, K., "Coordinated Attitude Control of Spacecraft Formation without Angular Velocity Feedback: A Decentralized Approach," AIAA Guidance, Navigation, and Control Conference, Chicago, Illinois, 10-13 August, 2009. 17, 18, 106 [Meissner 2009] Meissner, D. M., "A Three Degree of Freedom Test Bed for Nanosatellite and Cubesat Attitude Dynamics, Determination and Control," MASC Thesis, Naval Posgraduate School, 2009. 21 [Narendra & Balakrishnan 1997] Narendra, K. S., & Balakrishnan, J., "Adaptive Control using Multiple Models," IEEE Transactions on Automatic Control, Vol. 42, No. 2, 1997, Pages: 171­187. 17 [Pan & V. 2001] Pan, H. Z., & V., Kaplia., "Adaptive Nonlinear Control for Spacecraft Formation Flying with Coupled Translational and Attitude Dynamics," Proceeding of the 40th IEEE Conference on Decision and Control Oriando, Florida USA, December, 2001, Pages: 2057­2062. 103, 104, 105 [Pan et al. 2011] Pan, Y., Liu, G., & Kumar, K. D., "Reduced-order Design of High-order Sliding Mode Control System," International Journal of Robust and Nonlinear Control, Vol. 21, No. 18, 2011, Pages: 2064­2078. 13 [Panagi & Polycarpou 2011] Panagi, P., & Polycarpou, M. M., "Decentralized Fault Tolerant Control of a Class of Interconnected Nonlinear Systems," IEEE Transactions on Automatic Control, Vol. 56, No. 1, 2011, Pages: 178­184. 18, 19

266 [Pang & Tang 2010] Pang, H. P., & Tang, G.-Y., "Global Robust Optimal Sliding Mode Control for a Class of Nonlinear Systems with Uncertainties,," ICIC Express Letters, Vol. 4, No. 6(B), 2010, Pages: 2501­2508. 20 [Park & Tsuiji 1999] Park, K.B., & Tsuiji, T., "Terminal Sliding Mode Control of Secondorder Nonlinear Uncertain Systems," International Journal of Robust and Nonlinear Control, Vol. 9, No. 11, 1999, Pages: 769­780. 110 [Patton 1997] Patton, R. J., "Fault Tolerant Control Systems," Proceedings of

IFAN/LMACs Symposium on Fault Detection and Safety for Technical Process, 1997, Pages: 138­149. xix, 10, 11 [Peterson et al. 2009] Peterson, E. H., Fotopoulos, G., & Zee, R. E., "A Feasibility Assessment for Low-Cost InSAR Formation-Flying Microsatellites," IEEE Transactions on Geoscience and Remote Sensing, Vol. 47, No. 8, 2009, Pages: 2847­2858. 9 [Podder & Sarkar 2001] Podder, T.K., & Sarkar, N.L.J., "Fault Tolerant Control of an Autonomour Underwater Vehicle under Thruster Redundancy," Robtics and Autonomous System, Vol. 34, 2001, Pages: 39­52. 17 [Prado et al. 2005] Prado, J., Bisiacchi, G., Reyes, L., Vicente, E., Contreras, F., Mesinas, M., & Juarez, A., "Three-Axis Air-Bearing Based Platform for Small Satellite Attitude Determination and Control Simulation," Journal of Applied Research and Technology, Vol. 5, No. 3, 2005, Pages: 222­237. 209 [Pukdeboon et al. 2010] Pukdeboon, C., Zinober, A. S. I., & Thein, M. W. L., "QuasiContinuous Higher Order Sliding mode controllers for spacecraft attitude tracking maneuvers," IEEE Transactions on Industrial Electronics, Vol. 57, No. 4, 2010, Pages: 1436­1444. 21, 209, 214, 216 [Ramirez et al. 2010] Ramirez, J. L., Pavone, M., Frazzoli, E., & Miller, D. W., "Distributed Control of Spacecraft Formations via Cyclic Pursuit: Theory and Experi-

267 ments," Journal of Guidance, Control, and Dynamics, Vol. 33, No. 5, 2010, Pages: 1655­1669. 9 [Rauch 1994] Rauch, H. E., "Intelligent fault diagnosis and control reconfiguration," IEEE Control Systems Magazine, 1994, Pages: 6­12. 11 [Ren 2007] Ren, W., "Distributed attitude alignment in spacecraft formation flying," International Journal of Adaptive Control and signal processing, Vol. 21, 2007, Pages: 95­113. 18 [Ren 2010] Ren, W., "Distributed Cooperative Attitude Synchronization and Tracking for Multiple Rigid Bodies," IEEE Transactions on Control System Technology, Vol. 18, No. 2, 2010, Pages: 383­392. 18, 148 [Richter et al. 2011] Richter, J. H., Heemels, W. P. M. H, van de Wouw, N., & Lunze, J., "Reconfigurable control of piecewise affine systems with actuator and sensor faults: Stability and tracking," Automatica, Vol. 47, 2011, Pages: 678­691. 10, 186 [Roberts et al. 2004] Roberts, B.A., Kruk, J.W., Ake, T.B., Englar, T.S., Class, B.F., & Rovner, D.M., "Three-axis attitude control with two reaction wheels and magnetic torquer bars," AIAA Guidance, Navigation, and Control Conference, AIAA 20045245, Vol. 4, Providence, RI, Aug 16-19, 2004, Pages: 2465­2472. 4 [Robertson & Stoneking 2003] Robertson, B., & Stoneking, E., "Satellite GNC Anomaly Trends," AAS Guidance and Control Conference, Breckenridge, AAS 03-071, 2003. 2, 3 [Roth 2009] Roth, N. H., "Hybrid Magnetic Attitude Controller for Low Earth Orbit Satellites using the Time-varying Linear Quadratic Regulator," MASc. Dissertation, Graduate Department of Aerospace Science and Engineering, University of Toronto, 2009. 10

268 [Sabol et al. 2001] Sabol, C., Burns, R., & McLaughlin, C.A., "Satellite formation flying design and evolution," Journal of Spacecraft and Rockets, Vol. 38, No. 2, 2001, Pages: 270­278. 31 [Samy et al. 2011] Samy, I, Postlethwaite, I., & Gu, D. W., "Survey and application of sensor fault detection and isolation schemes," Control Engineering Practice, Vol. 19, 2011, Pages: 658­674. 11, 252 [Schaub & Junkins 2003] Schaub, H., & Junkins, J.L., Analytical Mechanics of Space Systems, AIAA Education Series, Reston, VA, 2003. 144, 146 [Schaub et al. 2000] Schaub, H., Vadali, S. R., Junkins, J. L., & Alfriend, K. T., "Spacecraft Formation Flying Control using Mean Orbit Elements," Journal of the Astronautical Sciences, Vol. 48, No. 1, 2000, Pages: 69­87. 12, 82 [Schwartz et al. 2003] Schwartz, J. L., Peck, M. A., & Hall, C. D., "Historical Review of Air-Bearing Spacecraft Simulators," Journal of Guidance, Control, and Dynamics, Vol. 26, 2003, Pages: 513­522. 21 [Soylu et al. 2008] Soylu, S., Buckham, B.J., & Podhorodeski, R.P., "A chattering-free Sliding-mode Controller for Underwater Vehicles with Fault-tolerant Infinity-norm Thrust Allocation," Ocean Engineering, Vol. 35, 2008, Pages: 1647­1659. 17 [Stonier & Stonier 2004] Stonier, D. J., & Stonier, R. J., "Obstacle avoidance and finitetime tracking of mobile targets," 2nd International Conference on Autonomous Robots and Agents, Palmerston North, New Zealand, December, 2004, Pages: 58 ­ 63. 41 [Su et al. 2009] Su, J.-P., Lee, T.-E., & Yu, K.-W., "A Combined Hard and Soft VariableStructure Control Scheme for a Class of Nonlinear Systems," IEEE Transactions on Industrial Electronics, Vol. 56, No. 9, 2009, Pages: 3305­3313. 15

269 [Tafazoli 2009] Tafazoli, Mak, "A study of on-orbit spacecraft failures," Acta Astronautica, Vol. 64, 2009, Pages: 195­205. xix, 1, 2, 3 [Talebi & Khorasani 2009] Talebi, H. A., & Khorasani, K., "Recurrent neural network based sensor and actuator fault detection and isolation for nonlinear systems with application to the satellite's attitude control subsystem," IEEE Transactions on Neural Networks, Vol. 20, No. 1, 2009, Pages: 45­60. 180 [Talebi & Patel 2006] Talebi, H.A., & Patel, R.V., "An Intelligent Fault Detection and Recovery Scheme for Reaction Wheel Actuator of Satellite Attitude Control Systems," Proceedings of the 2006 IEEE International Conference on Control Applications Munich, Germany, 4-6 October, 2006, Pages: 3282­3287. 17 [Tandale & Valasek 2006] Tandale, M. D., & Valasek, J., "Fault Tolerant Structured Adaptive Model Inversion Control," Journal of Guidance, Control, and Dynamics, Vol. 29, No. 3, 2006, Pages: 635­642. 14 [Tang et al. 2007] Tang, X. D., Tao, G., & Joshi, S. M., "Adaptive actuator failure compensation for nonlinear MIMO systems with an aircraft control application," Automatica, Vol. 43, 2007, Pages: 1869­1883. 13 [Tao & Kokotovic 1992] Tao, G., & Kokotovic, P. V., "Adaptive control of plants with unknown hystereses," Proceeding of the 31st Conference on Decision and Control, WA8-10:40, Tucson, Artzona, December, 1992. 13 [Tong et al. 2008] Tong, S. C., Wang, T. C., & Zhang, W., "Fault Tolerant Control for Uncertain Fuzzy Systems with Actuator Failures," International Journal of Innovative Computing, Information and Control, Vol. 4, No. 10, 2008, Pages: 2461­2474. 19 [Tschauner 1967] Tschauner, J., "Elliptic Orbit Rendezvous," AIAA Journal, Vol. 5, No. 6, 1967, Pages: 1110­1113. 8

270 [Tudoroiu & Khorasani 2007] Tudoroiu, N., & Khorasani, K., "Satellite Fault Diagnosis Using a Bank of Interacting Kalman Filters," IEEE Transactions on Aerospace and Electronic Systems, Vol. 43, No. 4, 2007, Pages: 1334­1350. 19 [Ure et al. 2011] Ure, N. K., Kaya, Y. B., & Inalhan, G., "The development of a Software and Hardware-in-the-Loop Test System for ITU-PSAT II nano satellite ADCS," IEEE 2011 Aerospace Conference, Big Sky, MT, 5-12 March, 2011. 21 [Ustrzycki 2011] Ustrzycki, T., "Spherical Air Bearing Testbed for Nanosatellite Attitude Control Development," MASC Thesis, York University, 2011. 21, 225 [Valdes & Khorasani 2010] Valdes, A., & Khorasani, K., "A pulsed plasma thruster fault detection and isolation strategy for formation flying of satellites," Applied Soft Computing, Vol. 10, No. 3, 2010, Pages: 746­758. 15, 68 [VanDyke & Hall 2006] VanDyke, M.C., & Hall, C.D., "Decentralized coordinated attitude control within a formation of spacecraft," Journal of Guidance, Control, and Dynamics, Vol. 29, No. 5, 2006, Pages: 1101­1109. 18 [Wang & Mendel 1992] Wang, L. X., & Mendel, J.M., "Fuzzy Basis Function, Universal Approximation, and Orthogonal Least-squares Learning," IEEE Transactions on Neural Networks, Vol. 3, No. 5, 1992, Pages: 807­814. 11, 19 [Wang & Yang 2003] Wang, P.J., & Yang, D., "PD-fuzzy Formation Control for Spacecraft Formation Flying in Elliptical Orbits," Aerospace Science and Technology, Vol. 7, 2003, Pages: 561­566. 47 [Wang et al. 1999] Wang, P. K. C., Hadaegh, F. Y., & Lau, K., "Synchronized Formation Rotation and Attitude Control of Multiple Free-flying Spacecraft," Journal of Guidance, Control, and Dynamics, Vol. 22, No. 1, 1999, Pages: 28­35. 157

271 [Wang et al. 2001] Wang, J., Rad, A. B., & Chan, P. T., "Indirect Adaptive Fuzzy Sliding Mode Control: Part I: Fuzzy Switching," Fuzzy Sets and Systems, Vol. 122, No. 1, 2001, Pages: 21­30. 35 [Wang et al. 2005] Wang, P.K.C., Hadaegh, F.Y., & Lau, K., "Synchronized Formation Flying Rotation and Attitude Control of Multiple Free Flying Spacecraft," Journal of Guidance, Control, and Dynamics, Vol. 22, No. 1, 2005, Pages: 28­35. 17 [Wang et al. 2007] Wang, Y. Q., Zhou, D. H., & Gao, F.R., "Robust Fault Tolerant Control of a Class of Non-minimum Phase Nonlinear Processes," Journal of Process Control, 2007, Pages: 523­537. 13 [Wang 1995] Wang, L. X., "Design and Analysis of Fuzzy Identifiers of Nonlinear Dynamic Systems," IEEE Transactions on Automatic Control, Vol. 40, No. 1, 1995, Pages: 11­23. 180 [Wang 1997] Wang, L.X, A Course in Fuzzy Systems and Control, Prentice-Hall, New York, NJ, 1997. 14, 111, 152, 180, 190 [Ward & Monaco 2005] Ward, D.G., & Monaco, J.F., "System Identification for Retrofit Reconfigurable Control of an F/A-18 Aircraft," Journal of Aircraft, Vol. 42, No. 1, 2005, Pages: 63­72. 17 [Wie & Roithmayr 2005] Wie, B., & Roithmayr, C. M., "Attitude and orbit control of a very large geostationary solar power satellite," Journal of Guidance, Control, and Dynamics, Vol. 28, No. 3, 2005, Pages: 439­451. 149 [Won 1999] Won, C.-H., "Comparative Study of Various Control Methods for Attitude Control of a LEO Satellite," Aerospace Science and Technology, No. 5, 1999, Pages: 323­333. 209 [Wong & Tam 1998] Wong, L. K., Leung F. H. F., & Tam, P., "Lyapunov Function based Design of Fuzzy Logic Controllers and Its Application on Combining Controllers,"

272 IEEE Transactions on Industrial Electronics, Vol. 45, No. 3, 1998, Pages: 502­509. 35 [Wong et al. 2002] Wong, Hong, Kapila, Vikram, & Sparks, Andrew G., "Adaptive output feedback tracking control of spacecraft formation," International Journal of Robust and Nonlinear Control, Vol. 12, No. 2-3, 2002, Pages: 117 ­ 139. 12 [Wu & Bai 2010] Wu, H., & Bai, M., "Stochastic Stability Analysis and Synthesis for Nonlinear Fault Tolerant Control Systems based on T-S Fuzzy Model," International Journal of Innovative Computing, Information and Control, Vol. 6, No. 9, 2010, Pages: 3989­4000. 18 [Wu & Saif 2006] Wu, Qing, & Saif, Mehrdad, "Robust Fault Diagnosis for a Satellite Large Angle Attitude System Using an Iterative Neuron PID (INPID) Observer," . Minneapolis, MN, 2006, Pages: 5710­5715. 19 [Wu & Saif 2007] Wu, Q., & Saif, M., "Robust fault detection and diagnosis for a multiple satellite formation flying system using second order sliding mode and wavelet networks," Proceedings of American Control Conference, WeA13.4, July 11-13, 2007. 10, 15, 178 [Wu et al. 1998] Wu, Y. Q., Yu, X. H., & Man, Z. H., "Terminal sliding mode control design for uncertain dynamic systems," Systems and Control letters, Vol. 34, No. 5, 1998, Pages: 281­287. 15 [Xiang & Huangpu 2010] Xiang, W., & Huangpu, Y. G., "Sliding Mode Control for a New Hyperchaotic Dynamical System," ICIC Express Letters, Vol. 4, No. 2, 2010, Pages: 547­552. 20 [Xiong et al. 2007] Xiong, K., Chan, C. W., & Zhang, H. Y., "Detection of Satellite Attitude Sensor Faults using the UKF," IEEE Transactions on Aerospace and Electronic Systems, Vol. 43, No. 2, 2007, Pages: 480­491. 252

273 [Xu et al. 2005] Xu, Y.J., Tatsch, A., & Fitzcoy, N.G., "Chattering Free Sliding Mode Control for a 6-DOF Formation Flying Mission," AIAA Guidance, Navigation, and Control Conference and Exhibit, 15-18 August, San Franciso, California, Vol. 22, No. 1, 2005. 17 [Xu et al. 2011] Xu, W. F., Liang, B., Li, B., & Xu, Y. S., "A universal on orbit servicing system used in the geostationary orbit," Advances in Space Research, Vol. 48, No. 1, 2011, Pages: 95­119. 2 [Yang & Yang 2011] Yang, L., & Yang, J. Y., "Nonsingular fast terminal sliding mode control for nonlinear dynamical system," International Journal of Robust and Nonlinear Control, Vol. 21, 2011, Pages: 1865­1871. 20 [Yu et al. 2005] Yu, S., Yu, X., Shirnzadeg, B., & Man, Z., "Continuous Finite Time Control for Robotic Manipulators with Terminal Sliding Mode," Automatica, Vol. 41, 2005, Pages: 1957­1964. 19 [Zhu et al. 2002] Zhu, J.J., Lawrence, D.A., Fisher, J., Shtessel, Y.B., Hodel, A.S., & Lu, P., "Indirect Robust Adaptive Fault-Tolerant Control for Attitude Tracking of Spacecraft," AIAA Guidance, Navigation, and Control Conference and Exhibit, 5-8 August, Monterey, California, 2002-4778, 2002, Pages: 1456­1463. 17

