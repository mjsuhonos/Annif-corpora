Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2013

Improving the Measurement Quality of Small Satellite Star Trackers
Tom Dzamba
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Aerospace Engineering Commons Recommended Citation
Dzamba, Tom, "Improving the Measurement Quality of Small Satellite Star Trackers" (2013). Theses and dissertations. Paper 2074.

This Dissertation is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

IMPROVING THE MEASUREMENT QUALITY OF SMALL SATELLITE STAR TRACKERS Tom Dzamba

B.Eng. Aerospace Engineering Ryerson University, 2007 MASc. Aerospace Engineering Ryerson University, 2009

A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of

Doctorate of Philosophy
in the program of

Aerospace Engineering

Toronto, Ontario, Canada © Thomas Dzamba 2013

Authors Declaration
I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my dissertation may be made electronically available to the public.

iii

iv

IMPROVING THE MEASUREMENT QUALITY OF SMALL SATELLITE STAR TRACKERS
Tom Dzamba, Doctorate of Philosophy, Aerospace Engineering Ryerson University, Toronto, September 2013

Recent demand from the small satellite community has led to the development of a new series of star trackers that are specifically designed for small satellites. These units represent substantial improvements in mass, power consumption and cost over traditional star trackers, but suffer slightly in terms of accuracy and availability performance. The primary factors inhibiting their performance are the use of significantly smaller optics, and commercial off the shelf components (COTS). This thesis presents a series of strategies for improving the performance of small satellite star trackers (SSSTs). These goals are realized through the development of offline calibration procedures, flight software, validation tests, and optical trade studies to guide future development. This thesis begins with the development of a target-based focusing procedure that enables precision control over the focus of the sensor optics. This improves the detection performance for dim stars, and ultimately increases the availability of the attitude solution. Flight software is developed to compensate for the effects of electronic rolling shutters, which reside on most COTS image detectors. Combined with a developed camera calibration procedure, these tools reduce the uncertainty with which a star tracker can measure the direction vectors to stars in view, ultimately increasing sensor accuracy. Integrated tests are performed to validate detection performance in dynamic conditions. These tests specifically examine the effect of slew rate on star tracker detection, and availability performance. Lastly, this thesis presents a series of optical trades studies that seek to identify design requirements for high performance SSSTs. The trends in availability and accuracy performance are examined as a function of different lens/detector configurations as well dual/triple-head sensor configurations. Together, these strategies represent tools that aim to improve small satellite star tracker performance and guide future sensor development.

Thesis Supervisor: Dr. John Enright Associate Professor, Ryerson University, Department of Aerospace Engineering v

vi

Contents
Authors Declaration Abstract . . . . . . . List of Publications . List of Tables . . . . List of Figures . . . . Acronyms . . . . . . Glossary . . . . . . . Nomenclature . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . iii . v . ix . xi . xiii . xv . xv . xviii 1 1 1 2 2 4 4 5 5 9 11 11 12 13 15 15 15 17 20 21 23 24 26 26 29 30 30 31 32 32 35 vii

1 Introduction 1.1 Motivation . . . . . . . . . . . . . . . . . . . . . . . . 1.1.1 Pointing Requirements for Small Satellites . . 1.1.2 Miniaturizing Star Tracker Technology . . . . 1.1.3 Development of the ST-16 Small Satellite Star 1.2 Fundamentals of a Star Tracker . . . . . . . . . . . . 1.2.1 Operations . . . . . . . . . . . . . . . . . . . . 1.2.2 Measures of Performance . . . . . . . . . . . . 1.3 Objectives and Contributions . . . . . . . . . . . . . 1.4 ST-16 Star Tracker: Design Limitations . . . . . . . .

. . . . . . . . . . . . . . . Tracker . . . . . . . . . . . . . . . . . . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

2 Image Quality and Detection Performance 2.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.1.1 The Impact of PSF Spot Size on Star Tracker Performance 2.1.2 Existing Focusing Techniques . . . . . . . . . . . . . . . . 2.1.3 The Focusing Mechanism of the ST-16 Star Tracker . . . . 2.2 Measuring Focus . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.2.1 The Modulation Transfer Function . . . . . . . . . . . . . 2.2.2 The Siemens Sinusoidal Star Pattern . . . . . . . . . . . . 2.3 Modeling Focus Error . . . . . . . . . . . . . . . . . . . . . . . . . 2.3.1 Blur Simulation . . . . . . . . . . . . . . . . . . . . . . . . 2.3.2 Defocus in Imaging Systems with a Planar Focal Surface . 2.3.3 Defocus in Imaging Systems with a Curved Focal Surface . 2.4 Focusing Procedure . . . . . . . . . . . . . . . . . . . . . . . . . . 2.4.1 Keystone Correction . . . . . . . . . . . . . . . . . . . . . 2.4.2 Calculation of Focus Error . . . . . . . . . . . . . . . . . . 2.5 Focusing Results . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.5.1 Accuracy of Blur Simulation . . . . . . . . . . . . . . . . . 2.5.2 Accuracy of Detector Positioning . . . . . . . . . . . . . . 2.6 Summary and Future Work . . . . . . . . . . . . . . . . . . . . . 2.7 Contributions to the Field . . . . . . . . . . . . . . . . . . . . . . 3 Star Vector Error

. . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . . .

3.1

3.2

Camera Calibration . . . . . . . . . . . 3.1.1 Camera Model . . . . . . . . . 3.1.2 Calibration Procedure . . . . . 3.1.3 Summary and Future Work . . ERS Compensation . . . . . . . . . . . 3.2.1 Introduction . . . . . . . . . . . 3.2.2 Framework for ERS Corrections 3.2.3 Results . . . . . . . . . . . . . . 3.2.4 Summary and Future Work . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

35 36 42 50 52 52 53 63 69 71 71 72 75 77 78 78 79 80 82 82 84 85 87 90 93 93 95 96 98 100 100 106 108 111 111 112 112 113 114 114

4 Verifying Slew Tolerance 4.1 Introduction . . . . . . . . . . . . . . . 4.1.1 Star Tracker Availability . . . . 4.1.2 The ST-16 Star Tracker . . . . 4.1.3 Testing the Performance of Star 4.2 Modeling the Effects of Sensor Slew . . 4.2.1 Types of Sensor Slew . . . . . . 4.2.2 Intensity Model . . . . . . . . . 4.2.3 Shape Model . . . . . . . . . . 4.3 Star Detection at Rate . . . . . . . . . 4.3.1 Simulation Tests . . . . . . . . 4.3.2 Lab Tests . . . . . . . . . . . . 4.3.3 Field Tests . . . . . . . . . . . . 4.4 Along-Track Dynamic Availability . . . 4.5 Summary and Future Work . . . . . . 5 Optical Trade Studies for Future 5.1 Introduction . . . . . . . . . . . 5.2 Optical Performance Models . . 5.2.1 Availability Model . . . 5.2.2 Accuracy Model . . . . . 5.3 Optical Design Trades . . . . . 5.3.1 Availability Trades . . . 5.3.2 Integrated Trades . . . . 5.4 Summary and Future Work . .

. . . . . . . . . . . . . . . . . . Detection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

Star Tracker Development . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

6 Conclusions 6.1 Summary of Contributions and Future Work . . 6.1.1 Improving Image Quality . . . . . . . . . 6.1.2 Reducing the Star Vector Error Budget . 6.1.3 Verifying Slew Tolerance . . . . . . . . . 6.1.4 Evolving a Sub-Arcsecond Small Satellite 6.2 The Final Word . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Star Tracker . . . . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

viii

List of Publications
Journal Papers
Dzamba, T. and Enright J. "Ground Testing Strategies for Verifying the Slew Rate Tolerance of Star Trackers", submitted to MDPI Sensors, May 2013.

Refereed Conference Papers
Dzamba, T. and Enright, J. "Optical Trades for Evolving a Small Arcsecond Star Tracker", IEEE Aerospace Conference, Big Sky, MT. March 2-9, 2013. Enright, J. and Dzamba, T. "Rolling Shutter Compensation for Star Trackers", AIAA Guidance, Navigation, and Control Conference, Minneapolis, MN. August 13-16, 2012. Dzamba, T., Enright, J. and McVittie, G. "A Focusing Procedure for Nanosatellite Star Trackers", AIAA Guidance, Navigation, and Control Conference, Toronto, Canada, August 2010, AIAA-2010-8152.

Conferences with Refereed Abstracts
Enright, J., Sinclair, D. and Dzamba, T. "The Things You Can't Ignore: Evolving a Sub-Arcsecond Star Tracker", In Proc. of 26th AIAA/USU Conference on Small Satellites, Logan, Utah, August 2012, SSC12-X-7. Dzamba, T., Enright, J. and Fernando, C. "Testing Strategies for Verifying the Slew Rate Tolerance of Star Trackers", in Proc. of 62nd International Astronautical Congress, Cape Town, South Africa, October 2011, IAC-11.C1.6.2. Dzamba, T., Fernando, C. and Enright J. "An Approach to Star Tracker Only Attitude Estimation using Motion Blur", AAS/AIAA Astrodynamics Specialist Conference, Girdwood, AK, August 2011, AAS-11-603. Dzamba, T., Enright J. and McVittie, G. "Commissioning the S3S Nanosatellite Star Tracker", in Proc. of 61st International Astronautical Congress, Prague, Czech Republic, September 2011, IAC-10-B4.4.10. Enright, J., Sinclair, D., Dzamba T., McVittie, G. and Grant, C. "Towards Star Tracker Only Attitude Estimation for Nanosatellites" in Proc. of 24th AIAA/USU Conference on Small Satellites, Logan, Utah, August 2010, SSC10-X-3. Dzamba T. and Enright J. "Calibration Techniques for Low-Cost Star Trackers", in Proc. of 23rd AIAA/USU Conference on Small Satellites, Logan, Utah, August 2009, SSC09-V-3. Dzamba, T. and Enright J. "Low-Cost Approaches to Star Tracker Lab Testing", AAS/AIAA Astrodynamics Specialist Conference, Pittsburgh, PA, August 2009, AAS-09-384. ix

x

List of Tables
1.1 2.1 3.1 3.2 3.3 3.4 3.5 3.6 3.7 3.8 4.1 5.1 5.2 5.3 5.4 5.5 ST-16 Specifications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Average MTF Residuals at 3 Focus Settings . . . . . . . . . . . . . . . . . . Definition of Camera Model Reference Frames . Summary of Inverse Camera Model Parameters Newport Motorized Gimbal Specifications . . . Summary of Lab Model Parameters . . . . . . . Summary of Calibration Starting Values . . . . Calibrated Model Parameters - Typical Case . . Motion Estimation Notations . . . . . . . . . . Angular Velocity Determination . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 30 41 43 44 48 49 50 57 65 89 101 101 107 107 108

ST-16 Along-track dynamic availability statistics. (Nmin = 2 / Nmin = 3) . . Optical Trade Study Detectors . . . . . . . . . . . . . . . . . . . Reference Optical Designs . . . . . . . . . . . . . . . . . . . . . Sky Fraction Meeting Accuracy Specification (single-head) . . . Sky Fraction Meeting Accuracy Specification (multi-head) . . . Required Centroid Caps for 0.90 Sky Fraction Meeting Accuracy . . . . . . . . . . . . . . . . . . . . . . . . . . . . Specification

xi

xii

List of Figures
1.1 1.2 1.3 2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8 2.9 2.10 2.11 2.12 2.13 2.14 2.15 3.1 3.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9 3.10 3.11 3.12 3.13 3.14 3.15 3.16 3.17 3.18 4.1 4.2 4.3 The ST-16 star tracker with Canadian quarter . . . . . . . . . . . . . . . . . Breakdown of thesis contributions. . . . . . . . . . . . . . . . . . . . . . . . Typical star tracker operations and research contributions . . . . . . . . . . PSF spot size vs. star tracker focus. . . . . . . . . . . . . . . . ST-16 Focusing mechanism. . . . . . . . . . . . . . . . . . . . Imaging a modulating intensity pattern. . . . . . . . . . . . . Example modulation transfer function. . . . . . . . . . . . . . Example Siemens sinusoidal star pattern (72 cycles). . . . . . Schematic of f . . . . . . . . . . . . . . . . . . . . . . . . . . . Flowchart for MTF calculation from the SSSP. . . . . . . . . . Image formation with a simple camera and planar focal plane. Defocus in a simple imaging system with a curved focal plane. Focus calibration target. . . . . . . . . . . . . . . . . . . . . . Flowchart of focus calibration procedure. . . . . . . . . . . . . System model for keystone correction. . . . . . . . . . . . . . . Keystone correction applied to the focus calibration target. . . Accuracy of MTF reproduction. . . . . . . . . . . . . . . . . . Summary of contributions for focusing procedure. . . . . . . . Summary of contributions for camera calibration procedure. Camera model reference frames. . . . . . . . . . . . . . . . . Detector frame of reference. . . . . . . . . . . . . . . . . . . Flow diagrams of forward and inverse camera models. . . . . Three-axis motorized gimbal. . . . . . . . . . . . . . . . . . Lab model reference frames. . . . . . . . . . . . . . . . . . . Layout of camera calibration procedure. . . . . . . . . . . . Camera calibration residuals - Typical case . . . . . . . . . . Summary of contributions for ERS compensation. . . . . . . The ERS compensation processing sequence. . . . . . . . . . Star image showing blurring due to sensor motion. . . . . . Field of view schematic. . . . . . . . . . . . . . . . . . . . . Variation of ERS correction with angular velocity. . . . . . . Relative centroid displacements under z -axis motion. . . . . Cross-axis estimator bias. . . . . . . . . . . . . . . . . . . . Errors in star pattern geometry for column-wise motion (y ). Errors in star pattern geometry for row-wise motion (x ). . . Laboratory measurements of the cross-axis estimator bias. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 8 8 14 15 16 17 18 19 20 24 25 26 27 27 29 31 33 36 37 40 44 45 45 49 51 53 54 55 62 63 64 66 67 68 69 73 76 76

Commonly used types of availability testing. . . . . . . . . . . . . . . . . . . Spatial static star distribution map (0  /s). . . . . . . . . . . . . . . . . . . . Sky regions with poor star availability (0  /s). . . . . . . . . . . . . . . . . . xiii

4.4 4.5 4.6 4.7 4.8 4.9 4.10 4.11 4.12 5.1 5.2 5.3 5.4 5.5 5.6 5.7 5.8

ST-16 Spatial static availability for varying star detection thresholds. Simulated star intensity at varying slew rates. . . . . . . . . . . . . . Tolerable slew rates for ST-16 star detection. . . . . . . . . . . . . . . Star intensity at varying slew rates using lab tests. . . . . . . . . . . Comparing field results. . . . . . . . . . . . . . . . . . . . . . . . . . Spatial dynamic availability map of the ST-16 star tracker (1  /s). . . Schematic of orientation tracks. . . . . . . . . . . . . . . . . . . . . . Examples of ST-16 along-track dynamic availability, Nmin = 2. . . . . Examples of ST-16 along-track dynamic availability, Nmin = 3. . . . . Summary of contributions for optical trade studies. An illustration of basic optical design parameters. Effect of F# on availability ( = 0  /s). . . . . . . Effect of F# on availability ( = 1  /s). . . . . . . Effect of field of view radius, x , at  = 1  /s. . . . Design space for CMV4000 detector ( = 1  /s) . . Angular star vector accuracy profiles. . . . . . . . . Components of centroid error. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . .

77 84 85 86 87 88 89 90 90 95 96 102 102 103 104 105 105

xiv

Acronyms
ADC APS CCD CMOS COTS CVT EKF EO ERS FCT FOV GPS LEO LIS MSE MTF P PSF RMS SAIL SFL SG SGP SI SNR SSSP SSST Analog-to-Digital Converter. Active Pixel Sensor. Charged-Coupled Devices. Complementary Metal-Oxide Semiconductor. Commercial-Off-The-Shelf. Circular Vision Target. Extended Kalman Filter. Earth Observation. Electronic Rolling Shutter. Focus Calibration Target. Field of View. Global Positioning System. Low Earth Orbit. Lost-In-Space. Mean-Squared Error. Modulation Transfer Function. Pillbox. Point Spread Function. Root-Mean-Squared. Space Avionics and Instrumentation Laboratory. Space Flight Laboratory at University of Toronto. Symmetric Gaussian. Symmetric Gaussian Pillbox Combination. Sinclair Interplanetary. Signal-to-Noise Ratio. Siemens Sinusoidal Star Pattern. Small Satellite Star Tracker.

xv

Acronyms

xvi

Glossary
The uncertainty in the provided orientation measurement. For star trackers, this is typically on the order of arcseconds. Availability (Star Tracker) The fraction of the celestial sphere over which a star tracker attitude solution is possible. Typically at least three stars are required for a star tracker Lost-In-Space solution (see corresponding glossary entry), and only two are required when the sensor is in a tracking mode. Camera Model The model used to transform image-plane coordinates into incoming star vectors, or vice versa. Described in detail in Section 3.1. Electronic Rolling Shutter A type of shuttering mechanism that controls the exposure of an image detector electrically instead of mechanically. Can lead to image level distortions if imaging in the presence of angular motion. See Section 3.2 for more details. Field of View The angular extent of the observable world visible through an optical system. This value is determined by the focal length, f , of the optical system or the height, ho , of the image detector. Typically specified as two angles corresponding to the minor, and major axes of the Field of View (FOV). Focus Error The displacement between the image detector and the ideal focal surface (defined by the optical system) along the optical axis. Integrated Intensity The summed response of all pixels corresponding to a star image. For the ST-16, this is the summation of all lit pixels, see corresponding glossary entry. Lit Pixel A pixel considered to be lit by starlight (photoelectrons) as opposed to various detector noise sources (thermal electrons). Only lit pixels are used in the calculation of star centroids. Lost-in-Space Solution A type of attitude solution that depends on no previous attitude knowledge. This type of solution requires at least two pairs of corresponding vectors in both the body-frame and the inertial frame. For star trackers, this minimum vector requirement is commonly increased to three or four pairs of vectors due to ambiguity in matching corresponding pairs of star vectors. Modulation Transfer Function The ability of an optical system to transfer contrast between object space and image space as a function of spatial frequency. xvii Accuracy (Star Tracker)

Glossary Optical Aberrations Point Spread Function Principal Point Stellar Detection Threshold Stellar Magnitude The departure of the performance of an optical system from the predictions of paraxial optics. The impulse response of the optical system, commonly used to approximate the shape of imaged stars. The coordinates of the intersection of the optical axis with the virtual image plane, illustrated in Figs. 3.2 and 3.3. The stellar magnitude, mt , that describes the intensity of the dimmest star the star tracker can detect. Also known as Apparent Magnitude, this is a measure of the brightness of a star as seen by an observer on Earth, neglecting the effects of the atmosphere. Denoted as ms , this value is expressed in a negative logarithmic scale. Dimmer stars represent larger values of ms , while brighter stars representing decreasing values of ms which can include and surpass the origin defined by ms = 0. Maximum cross-axis angular slew rate, | xy |, for which a star of given magnitude, m, can be detected.

Tolerable Slew Rate

xviii

Nomenclature
fc (k P ) A function denoting the inverse camera model as described in Section 3.1.1.D, where kP represents the measured star centroid defined in the pixel frame Coefficients of sinusoidal intensity pattern Coefficients of the shape model used the describe the intensity distribution of star in the presence of sensor slew, see Eq. (4.16) Lit Pixel Threshold (detector counts) Pixel width scaling parameter Diameter of the sensor optics (m) Focal length of the sensor optics (m) Ratio of focal length, f , to lens diameter, D of the sensor optics Spatial frequency of sinusoidal intensity pattern (cycles/pixel) Pillbox (P) intensity scaling parameter for Symmetric Gaussian Pillbox Combination (SGP) Symmetric Gaussian (SG) blur kernel Pillbox (P) blur kernel Symmetric Gaussian Pillbox Combination (SGP) blur kernel Image intensity at pixel (m, n) Maximum and minimum image intensity, respectively (detector counts) Modeled intensity of sinusoidal intensity pattern Radial distortion coefficients - Forward Model Parameters used to define plane image detector Radial distortion coefficients - Inverse Model Modulation transfer between object and image, expressed as a fraction of the ideal value of 1. Measured Modulation Transfer Function (MTF) - from image of Focus Calibration Target (FCT) xix

a, b, b1 , b2 Ao , Bo , a2 a1 a0 BT cs D f F# fs G h1 h2 h3 I (m, n) Imax , Imin Imodel j1 , j2 Jp = (ap , bp , cp , dp ) k1 , k2 M (fs ) MA

Glossary mo , no MS ms mt Nm Ncal Ncyc q QCVT Qc Qint QM T F R rsssp Ri s Se trow te tm tx u v Location of the principal point, expressed in pixels, with respect to origin of the detector array (defined as [0,0] on the image detector) Simulated MTF - based on simulated image of blurred FCT Stellar magnitude Stellar detection threshold Number of rows of the image detector Survey size for the camera calibration procedure Number of cycles in the Siemens Sinusoidal Star Pattern (SSSP) Parameter describing the shape of the paraboloid Cost function used to fit the orientation and position of the FCT with respect to the star tracker Error function that describes the angular Mean-Squared Error (MSE) between the sensor-based, and lab-based star vectors Cost function for fitting the sinusoidal intensity model given by Eq. (2.7) Cost function for fitting the simulated MTF, MS Radius of blur circle (m) Radial distance, in pixels, form the SSSP center Point Spread Function (PSF) radius of diffraction limited optical system (Airy disc) (m) Distance (along optical axis) of image detector from principal point The ideal integrated intensity of a star MTP9031 row read out time (s) Exposure time (s) Readout time for the midpoint of the exposure of row m Time delay between end of exposure of Image-0 and beginning of exposure for Image-1 (s) Distance (along optical axis) of object from principal point (m) Distance (along optical axis) of image from principal point (m) xx

Glossary z ai,Ci Distance between image detector and focal modeled focal surface for position (x, y ) on the image detector Star vector of i-th star found in image-0, expressed in the image-0 instantaneous camera frame, Ci . Each image-0 instantaneous camera frame is described as a rotated version of the image-0 epoch camera frame, defined halfway through the readout of row 1, image-0. The rotation is described by the row location of the star centroid, mi , and the body rate of the star tracker,  C , as given in Eq. (3.32) Modeled star vectors for the i-th star of the calibration set, based on sensor and lab parameters, respectively Point on the image detector, defined in the sensor frame Star vector of j-th star from image-1, expressed in the image-1 instantaneous camera frame, Ej . Each image-1 instantaneous detector frame is described as a rotated version of the image-1 epoch frame, defined halfway through the readout of row 1, image-1. The rotation is described by the row location of the j-th star centroid, mj , and the body rate of the star tracker,  C , as given in Eq. (3.32). Initial and Final positions of the star centroid over the coarse of an image exposure during angular motion Focal plane displacement of a star centroid during the course of an image exposure (including the effects of the Electronic Rolling Shutter (ERS)). This is equivalent to  p mapped onto the focal plane. Image plane coordinates of star centroid mapped from the incoming star vector, ac
T D

as,i , al,i aS bj,Ej

di , df d

g I = (gx , gy )I hD = hx hy hz hI = hx hy j D = jx jy kP = m n nS p pD
T I

Position of distorted star centroid hI , mapped into the detector frame (accounting for the effects of decentering and prism distortion) Image plane coordinates of star centroid, g I , after accounting for the effects of radial distortion - denoted as the distorted star centroid Detector array coordinates of the star centroid gI . Row/Column coordinates of j D , expressed in pixels within the pixel frame Normal of the image detector, defined in the sensor frame Star vector, a, at the beginning of the image exposure (in the presence of sensor slew) Location of arbitrary point, p, in the detector frame xxi

T D T P

Glossary pS pT q s U L, U C uT = (xT , yT , zT ) (x, y ) ha = [h , ho ] (m, n) (m, n)cent CCo Ci Location of arbitrary point, p, in the sensor frame Location of arbitrary point, p, in the focal calibration target frame Star vector, a, at the end of the image exposure (in the presence of sensor slew) Focal plane displacement of a star centroid during the course of an image exposure (excluding the effects of the ERS). Direction of the star source, expressed in the lab and camera frame reference frames, respectively Position of the target, with respect to the sensor (m) Row and column centroid-referenced image plane coordinates (pixels) Detector size (mm) Row and column image plane coordinates (pixels) Row and column image plane coordinates of the star centroid (pixels) Rotation from i-th image-0 instantaneous camera frame to image-0 epoch frame, Co . Image-0 epoch frame is defined as the instantaneous camera frame half way through the exposure of row 1, image-0 Rotation from the image-1 epoch frame, Eo , into the image-0 epoch frame, Co , and vice versa Rotation from the image plane to the detector frame, and vice versa. CDI is described as a X-Y Euler angle set parameterized by 1 , 2 . CID is described as a X-Y Euler angle set parameterized by 1 , 2 . Rotation from j-th image-1 instantaneous camera frame to image-1 epoch frame, Eo . Image-1 epoch frame is defined as the instantaneous detector frame half way through the exposure of row 1 in image 1 Transformation from the mount frame to the end-effector frame, and vice versa. Described by X-Y-Z Euler angle rotation parameterized by 1 , 2 3 . CM E = CT EM Transformation from the end-effector frame to the lab frame, and vice versa. Described by X-Y-Z Euler angle rotation parameterized by 1 , 2 3 . CEL = CT LE Transformation from the camera frame to the mount frame, and vice versa. Described by 1-2-3 Euler angle rotation parameterized by 1 , 2 3 . CCM = CT MC xxii

CCo Eo , CEo Co CDI , CID

CEo Ej

CEM , CM E

CLE , CEL

CM C , CCM

Glossary P RT Sb (x, y ) Si (x, y ) p  = (1 , 2 , 3 ) p s C  = (1 , 2 , 3 )  pix  = (1 , 2 , 3 ) p z Q 1 , 2 p  1 , 2 o bs e i SG tot FOV = [x , y ] Covariance of the star tracker attitude solution Orientation of the FCT with respect to the sensor frame, expressed as a rotation matrix parameterized by X-Y-Z Euler angle set (t , t , t ) Focal plane intensity distribution of a star in the presence of sensor slew Intensity distribution of a star during static imaging conditions Nominal PSF radius (pixels) Camera rotation angles (radians) Vector displacement of a star vector during the course of an image exposure (including the effects of the ERS) Vector displacement of a star vector during the course of an image exposure (excluding the effects of the ERS) Star tracker angular slew rate radians/s Mounting angles (radians) Centroid error Commanded gimbal angles (radians) Distance of the paraboloid from the image detector Displacement from ideal focus, along the optical axis (m) The quantum efficiency of the image detector Inverse model detector rotation angles (radians) Pixel size (m) Wavelength of light emitted by imaged star (m) Forward model detector rotation angles (radians) Distance of centroid from the principal point (pixels) Cross-boresight error of the star tracker attitude solution Detector read noise (electrons) Angular error of a star vector Symmetric Gaussian (SG) shape parameter Total error of the star tracker attitude solution ST-16 field of view (radians). x denotes the minor-axis FOV, while y denotes the major-axis FOV. xxiii

Glossary

xxiv

Chapter 1

Introduction

Recent demand from the small satellite community has led to the development of a new series of star trackers that are specifically designed for this class of satellite. These units represent substantial improvements in mass, power consumption and cost over traditional star trackers, but suffer slightly in terms of accuracy and availability performance. The primary factors inhibiting their performance are the use of significantly smaller optics, and Commercial-Off-The-Shelf (COTS) components. Both of these factors negatively impact the performance of a star tracker by either reducing the number of stars the sensor can detect, or decreasing the accuracy with which detected stars are related to star direction vectors. This study presents a series of strategies for improving the performance of Small Satellite Star Trackers (SSSTs). These strategies are realized through the development of offline calibration procedures, flight software, validation tests, and optical trade studies to guide future development.

1.1
1.1.1

Motivation
Pointing Requirements for Small Satellites

Over the past decade, there has been rapid growth in the number of small satellite missions. Microminiaturization of electronics has allowed for a dramatic increase in the capability of small satellites while maintaining very low cost. Since small satellites are ordinarily built in 1 to 3 years, with minimal budgets, there is a higher tolerance for risk compared to traditional satellites [Wertz et al. 2011]. This allows small satellites to take advantage of new technology much faster than traditional satellite programs, leading to equally capable spacecraft, developed for a fraction of the cost. Although communication, technology demonstration, and education are traditional small satellite applications, Earth Observation (EO) missions are rapidly becoming the most popular. 1

Chapter 1. Introduction The usefulness of EO data is related to the accuracy with which these observations can be registered with known ground locations (i.e. geolocation). The success of this task is directly dependent on knowledge of the spacecraft's position and attitude. Since the advent of modern low-cost Global Positioning System (GPS) receivers, which provide more than sufficient position accuracy, attitude accuracy has become the limiting factor in ground registration for small satellites. Attitude determination of small satellites is typically provided by sensor suites that incorporate measurements from several different instruments such as magnetometers, sun sensors, and rate gyros. These solutions work well for accuracies greater than one arcminute ( 0.01  ). However, for accuracies better than this, practical solutions typically involve a star tracker.

1.1.2

Miniaturizing Star Tracker Technology

Star trackers are high-accuracy, three-axis attitude determination sensors that utilize unique patterns formed by stars to determine the attitude of a spacecraft. Typical current generation star trackers provide attitude accuracies on the order of 1-10 arcseconds, have a mass of 1-5 kg, consume 5 W - 10 W of power, and cost several hundreds of thousands of dollars. These requirements typically exclude a star tracker as a potential attitude sensor for small satellites. In the last five years, a new breed of star trackers has emerged designed specifically for small satellites. These units provide attitude accuracies on the order of 10-30 arcseconds, weigh less than 400 g, consume less than 2 W of power, and cost significantly less than their predecessors. Although these new Small Satellite Star Trackers (SSSTs) are relatively coarse compared to existing star trackers, they represent significant improvements over current small satellite attitude determination capabilities.

1.1.3

Development of the ST-16 Small Satellite Star Tracker

One of these recently developed SSSTs is the ST-16 star tracker. The ST-16 star tracker is a fully integrated single unit that weighs 90 g and has a peak power requirement of 1W. Ground testing supports an accuracy claim of 7 arc-seconds (cross-axis), but better results are expected once on-orbit. The ST-16 has been successful in the marketplace with approximately $1.5M in sales and 11 flight units have already delivered for a number of astronomical and EO missions. The first launch of the ST-16 is expected in early 2014. An image of the ST-16 is shown in Fig. 1.1 and some key specifications are listed in Table 1.1. For more information, please see [Enright et al. 2010] or [Dzamba et al. 2010]. The ST-16 was developed specifically for nanosatellites through a joint venture between Ryerson University's Space Avionics and Instrumentation Laboratory (SAIL) - of which I am a part of, Sinclair Interplanetary (SI) and the Space Flight Laboratory at the University 2

1.1 Motivation

Figure 1.1: The ST-16 star tracker with Canadian quarter Table 1.1: ST-16 Specifications

Size Mass Power Accuracy Availability Field of View F# Focal Length Aperture Manufacturer Pixel Size Detector Dimension Row Read Time Read Noise Conversion Factor Manufacturer Product ID Stellar Detection Threshold Catalog Size Slew Tolerance Nominal Star Radius

59 x 56 x 31.5 mm  90 g (without baffle) < 1 W peak, < 0.5 W average 7 arcseconds  0.002 > 99.99%  7.5 × 10.5 (half angle) 1.2 16 mm 13 mm Marshall Optics 2.2 µm 1944 rows, 2592 columns 43.9 µs 3.5 e- 7 counts/e- Aptina MTP9031 < 5.75 3746 stars 2  /s 6 pixels (13.2 µm)

Top-Level Parameters

Optical Design

Image Detector

Performance Parameters

3

Chapter 1. Introduction of Toronto. The work presented in this thesis stems from my involvement and contributions to the design, development, and continued production of the ST-16 SSST. My initial role in the development of the ST-16 was mainly to develop lab facilities and procedures that provide characterization, calibration, and validation capabilities for the production of ST-16 flight units. Over the course of the project, my roles have evolved to include the development of novel algorithms, and analytical performance models used to steer future SSST design iterations. I continue to be involved in the production of ST-16 flight units, employing several of the developed approaches and techniques for unit production, characterization and validation testing. This thesis captures the developed theory, techniques, and lessons learned during the development of the ST-16. Although some details are specific to this design, most of the developed concepts have wider applicability.

1.2

Fundamentals of a Star Tracker

In simple terms, star trackers consist of three main components: a set of optics, an image detector, and a microcomputer. The optics and the detector are used to provide an image of the star field which is then processed by the microcomputer to compute the attitude solution. This section describes the basic processing chain for a star tracker and discusses how we quantify star tracker performance.

1.2.1

Operations

The processing chain for a typical star tracker can be summarized by four basic operations: image acquisition, image processing, star identification, and attitude estimation. These operations are briefly described below. Image Acquisition The camera (composed of the optical system and the image detector) generates a digital image of the star scene in the Field of View (FOV) of the lens. The image is a summation of both incoming star light and detector noise. The size and shape of each star image is dependent on the quality, and the focus of the optics. Since stars are commonly modeled as point sources of light at an infinite distance, in static imaging conditions, the size and shape of each star in the image can be approximated by the Point Spread Function (PSF) of the sensor optics. If the camera is moving during imaging, the star image is blurred along a path defined by the motion of the sensor. Image Processing The on-board computer is used to process the acquired image in two main phases: star detection and direction vector formulation. Star detection involves identifying collections of bright pixels likely caused by stars and then calculating the stars' centroid 4

1.3 Objectives and Contributions of illumination. This is generally achieved using thresholding and some simple logic of what a star should look like. These centroids are then related to star direction vectors using an optical model of the sensor. Star Identification The microcomputer searches the on-board catalog for patterns that correspond to the set of detected star vectors. Although only two matched stars are required for a final attitude solution, geometric ambiguity in star patterns typically requires at least three stars for an initial match. We refer to this initial match (i.e. without a priori attitude information) as the Lost-In-Space (LIS) problem. Attitude Solution Using both the detected and corresponding matched inertial sets of star vectors, the attitude of the sensor can be determined using one of several solutions to the Wahba problem [Wahba 1965, Keat 1977, Shuster & Oh 1981]. This attitude is then related to the attitude of the spacecraft through knowledge of sensor alignment which is generally specified by an alignment feature on the housing. Precise measurements of the transformations from the alignment feature to both the sensor-frame and the spacecraftframe are critical for the elimination of attitude biases.

1.2.2

Measures of Performance

The performance of a star tracker is generally described by two parameters: accuracy and availability [Liebe 2002]. Accuracy refers to the uncertainty of the final attitude solution that comes out of the selected method of solving the Wahba problem. For star trackers, accuracy is generally on the order or arc-seconds and is commonly expressed in two components: a crossaxis component, and an about bore-sight roll component. It is common for the roll accuracy of a star tracker to be significantly worse than the cross-axis accuracy. Availability is defined as the fraction of the celestial sphere that an attitude solution is possible. This definition is revisited in Chapter 4 which explores different definitions of star tracker availability that explicitly include the presence of angular motion during imaging.

1.3

Objectives and Contributions

There are two notable differences between Small Satellite Star Trackers (SSSTs), and conventional star trackers. They are: Small Satellite Star Trackers (SSSTs) utilize COTS components. These components can offer increased performance due to their use of advanced technologies and are less expensive than traditionally used space qualified components. However, COTS components possess increased variability in build quality, and their performance and survivability in the space environment must be tested and validated. 5

Chapter 1. Introduction Small Satellite Star Trackers (SSSTs) use small optics. This requirement can be traced to the size constraints imposed by the intended spacecraft (small satellites). A smaller lens aperture collects fewer photons, which ultimately results in the star tracker detecting fewer stars. Both of these factors negatively impact the performance of a star tracker by either reducing the number of stars the sensor can detect, or decreasing the accuracy with which detected stars are related to star direction vectors. This thesis demonstrates how accuracy and availability can be improved through the following innovations: 1. Improve the image quality. This entails maximizing the detection performance of the star tracker through improvements to the Signal-to-Noise Ratio (SNR) of imaged stars. Increasing detection performance directly improves availability and ultimately also the accuracy performance of the star tracker attitude solution. 2. Reduce the star vector error budget. The accuracy of the star tracker attitude solution is directly related to the angular uncertainty of measured star vectors. Decreasing this uncertainty, results in increased accuracy performance. 3. Validate sensor performance during motion. Angular motion during imaging causes the image of a star to smear, decreasing detection performance and ultimately availability. Describing this drop in availability leads to better performance characterization and identifies potential improvements for future detection routines. 4. Develop SSST production practices. Lab-based calibration routines can help maximize sensor performance by determining critical sensor parameters, unique to each individual sensor. The routines can also be used to validate sensor performance after environmental testing. These goals are realized through the development of offline calibration techniques, online algorithms (flight software) and integrated tests. Lessons learned from the development of these approaches are then applied to conduct a series of optical trade studies with the aim of evolving the design of the ST-16 in order to improve sensor performance. A brief description of each contribution is given below. SSST Focusing Procedure [Chapter 2]. The detection performance of a star tracker is driven by the size and shape of the PSF of the sensor optics. Minimizing the size of the PSF would ideally improve the SNR of star images. However, due to pixel saturation and sampling effects, there is trade-off between minimizing noise contribution (tight focus) and improving localization accuracy (broad, unsaturated light distribution). I develop a targetbased focusing procedure that utilizes the MTF of the sensor optics to enable precision control of the detector position and orientation. Camera Calibration Model [Section 3.1]. The accuracy performance of a star tracker is directly dependent on the accuracy with which imaged stars can be converted to incoming 6

1.3 Objectives and Contributions star vectors. This transformation is achieved through the use of an optical model based on the internal geometry of the sensor. I develop a calibration procedure for the ST-16 SSST based on repeatedly imaging a collimated pinhole source at several different orientations using a three-axis motorized gimbal. The sensor geometry is estimated through a minimization guided by the error between modeled star positions and the actual measured star positions. Electronic Rolling Shutter (ERS) Compensation [Section 3.2]. Common in many modern imaging detectors, ERS present challenges for use in star trackers. These detectors suffer from geometric distortions if images are taken while the satellite is rotating. I present an analytical model of the ERS distortion tailored to the characteristics of star-field images. This model is used to develop a series of algorithmic corrections that estimate spacecraft angular velocity from sequential image pairs and remove the ERS effects from measured star positions. These routines are implemented on the ST-16 and verified using simulation and laboratory testing. These tests show that the developed ERS corrections are able to preserve accurate scene geometry with body rates of up to 3 deg/s. Slew Tolerance Tests [Chapter 4]. The performance of a star tracker is largely based on the availability of its attitude solution. Several tests exist to assess the availability under static conditions, however these rarely reflect true operating conditions. To acquire results of higher fidelity, attitude engineers are generally forced to utilize mission specific details to generate a true sky track. I develop analytical models that describe the effects of slew rate on detection performance. These models are then used to describe sensor availability at rate, using simulations. I validate these models with lab tests that involve an ST-16 prototype, a motion platform, and a single star source. Optical Trade Studies for Improving SSST Performance [Chapter 5]. This chapter presents a series of system performance models for nanosatellite star trackers. Recent trends in EO missions have led to a demand for arcsecond-level accuracy attitude estimates at body motion rates of up to 1  /s. I develop models to predict sensor availability and accuracy in terms of a number of optical design parameters. Starting from the baseline optical design of ST-16, I explore strategies for improving sensor accuracy. I highlight distinctive features of the trade-space relative to more conventional star tracker design, discuss system-level trends, and provide analysis of promising point designs. Results from these trades are valuable for prioritizing further SSST development.

These contributions can be grouped into three main categories: design characterization and verification, unit production and validation, and novel algorithms. Design characterization and verification describe the capabilities of the ST-16 from a performance standpoint. Unit production and validation techniques are critical for the preparation ST-16 flight units. Lastly, novel algorithms enhance star tracker performance by compensating for hardware non-idealities and providing additional attitude information. Fig. 1.2 describes how the contributions of this thesis fit within these three categories and the benefits they provide. Figure 1.3 summarizes how these contributions tie into the typical processing chain of a star tracker. The developed focusing procedure helps to control the size and shape of star 7

Chapter 1. Introduction
CONTRIBUTIONS
Verifying the Tolerable  Slew Rate Optical Trade Studies

BENEFITS
Describes Availability  Performance at Rate Highlights Promising  Avenues for Development Improves Detection  Performance Decreases Star Vector  Error Budget Sensor Validation for  Environmental Testing Decreases Star Vector  Error Budget Provides Additional Rate  Estimate

Design Characterization  and Verification

Unit Production and  Validation

SSST Focusing  Procedure Camera Calibration

Novel Algorithms

Electronic Rolling Shutter  (ERS) Compensation

Figure 1.2: Breakdown of thesis contributions.

· Detector  Offsets

· Sensor  Geometry · PSF size

· Star  Catalogue

· State  Information · Sensor  Alignment

Required  Information

Image  Acquisition

Image  Processing

Star  Identification

Attitude  Solution

Typical Star  Tracker  Operations

Focusing

Geometric  Calibration ERS  Compensation Availability  Tests

Rate  Calculation

Research  Contributions

Offline Calibration Techniques Integrated Tests Online Algorithms

Figure 1.3: Typical star tracker operations and research contributions

images, enabling increased detection performance. The camera calibration model, and the ERS correction routine minimize the error budget associated with converting star centroids to star direction vectors. Reducing the uncertainty in these vectors, increases the accuracy of the star tracker attitude solution. Lastly, the examination of star tracker slew tolerance 8

1.4 ST-16 Star Tracker: Design Limitations not only provides valuable performance validation, but also helps identify promising avenues for improving detection performance at rate.

1.4

ST-16 Star Tracker: Design Limitations

Several top level design decisions were made during the development of the ST-16 that make various processing routines more challenging. Of particular importance is a constraint on interface bandwidth, and the desire to have stateless star tracker operations. The constraint on the interface bandwidth between the star tracker and the user is driven primarily from savings in weight, volume, circuit simplicity, and connector reliability. Since very little data (attitude, covariance, rate, etc.) is required to fully report the star tracker attitude solution, interface bandwidth is typically minimal. Traditional electronic communication interfaces (e.g. USB) would not only be wasteful in terms of mass, and volume, but also introduce risk because they possess little to no flight history. For these reasons, the ST-16 utilizes a serial-based communication interface. This constrains image processing to take place only onboard the star tracker itself, rather than the unit being used as a typical camera - providing an image to the user. The decision to keep the routines used onboard the ST-16 stateless (requiring no a prior attitude information), arose primarily from concerns over hardware reliability within the space radiation environment. By effectively restarting the ST-16 processor with each attitude measurement, the impact of radiation induced upsets was mitigated. Although this feature improves reliability, stateless processing also has its consequences. The dominant consequence being the Lost-In-Space (LIS) problem must be solved for each measurement. This improves tolerance to sudden changes in attitude, where a typical star tracker operating in a tracking mode would lose lock. However, this also increases processing time, effectively decreasing update rate.

9

Chapter 1. Introduction

10

Chapter 2

Image Quality and Detection Performance

Star tracker performance is directly dependent on the number of stars visible to the sensor and the accuracy with which the centroid of these stars can be found. These metrics are primarily driven by the size and shape of the Point Spread Function (PSF) of the sensor optics which is set by the focus and quality of the imaging optics. Minimizing the size of the PSF would ideally improve the Signal-to-Noise Ratio (SNR) of star images, increasing detection performance of dim stars. However, due to pixel saturation and sampling effects, there is a trade-off between minimizing noise contribution (tight focus) and improving localization and centroiding accuracy (broad, unsaturated light distribution). The chapter details a procedure for focusing the optics of a nanosatellite star tracker. The procedure utilizes the Siemens Sinusoidal Star Pattern (SSSP) to measure the Modulation Transfer Function (MTF) of the sensor. The MTF is related to the PSF of the sensor optics which is then used to guide focusing corrections to the position and orientation of the image detector. Initial results show the procedure is capable of measuring the position of the image detector with an average error of approximately 0.055mm. This translates into control over the size of the PSF to an approximate size of 20 pixels, for the ST-16 optical configuration.

2.1

Introduction

The performance of a star tracker depends on it's sensitivity to starlight, the Field of View (FOV), the accuracy of the star centroid, the star detection threshold, the number of stars within the FOV, the internal star catalog, and the calibration of the sensor [Liebe 2002]. SSSTs will naturally have smaller optics than existing star trackers due to size constraints. This limits their sensitivity to starlight, and in turn decreases the numbers of detectable stars within each image. To mitigate these effects, we seek to maximize the star detection threshold which is a product of the background noise of the image detector and the size of an imaged star's PSF [Liebe 2002]. Selecting a low-noise image detector addresses the 11

Chapter 2. Image Quality and Detection Performance first of these two factors, however the size of imaged stars' PSF is a function of the sensor focus. A tight focus minimizes the size of the PSF, maximizing the measured intensity of the brightest pixel. However, too tight of a focus and the ability to accurately centroid each PSF is impaired [Rufino & Accardo 2003]. Achieving a desired spot size is a difficult and often time consuming task. This chapter develops a low cost focusing procedure for all star trackers that will allow users to focus star trackers to a selected spot size using only a few calibration images. The motivation for this focusing procedure is to focus the recently developed ST-16 star tracker. The design of this unit allows manual adjustment to the position and orientation of the detector with respect to the sensor optics. This allows for focus adjustments in both the standard along-boresight (piston) sense, as well as in a detector orientation (tip/tilt) sense. This does provide an added capability to reduce variations in spot size across the sensor FOV. However, these additional degrees of freedom make it difficult to apply common star tracker focusing techniques. The focusing procedure I develop utilizes a calibration target to provide a closed-loop solution for the required focus adjustment given a desired spot size. I begin with a more in depth discussion on the effects of focus on sensor performance and review some of the existing focusing techniques. The second subsection then presents the SSSP and its use in the measurement of a sensor's MTF. Following this, I introduce a focus error model that relates the measured MTF of an optical system to a specific detector position and orientation. The fourth subsection highlights some of the specifics required for implementing the focusing procedure. Lastly, I present some preliminary lab results using the developed focusing procedure.

2.1.1

The Impact of PSF Spot Size on Star Tracker Performance

A star tracker determines attitude by solving what is known as the Wahba problem: Given two sets of n vectors, where n2, find the rotation matrix which brings the first set into the best least square coincidence with the second [Wahba 1965]. In the case of a star tracker, the first set of vectors are the known positions of stars on the celestial sphere. The second set are direction vectors to imaged stars that are calculated from the image plane coordinates of the star centroids. The accuracy of these measured centroid positions greatly impacts the accuracy of the resulting attitude solution [Liebe 2002]. The most commonly used method for determining star centroids from images is the firstmoment centroiding technique, which can reliably attain sub-pixel accuracy [Liebe 1995, Rufino & Accardo 2003]. This technique can be briefly described as the ratio of first-order spatial moments to zero-order ones and is expressed mathematically as: 1 I [m, n]
m n m n

(m, n)cent =

m I [m, n] ,
m n

n I [m, n] ,

(2.1)

12

2.1 Introduction where [m, n] are row and column image plane coordinates specified in pixels, (m, n)cent are the image plane coordinates of the star centroid, and I [m, n] is the image intensity at the pixel [m, n]. This technique yields a maximum level of centroid accuracy when the radius of the PSF (spot size) is approximately 3-5 pixels [Rufino & Accardo 2003]. I briefly summarize the reasoning behind this desired PSF radius below. If we consider the optics of a star tracker to be diffraction limited, at an ideal focus, stars will appear as Airy discs with a radius equal to Ri according to Eq. (2.2):

Ri = 1.22 F #,

(2.2)

where  is the wavelength of light emitted by the imaged star, and F # is the f-number of the sensor optics. Using a typical F # for star trackers ( 1.0), the radius of this disk is generally significantly smaller than a single pixel. This mitigates the benefit provided by the above centroiding algorithm, limiting the centroid accuracy to a single pixel. To prevent this, star trackers are normally purposely defocused, by a small distance thereby increasing the size of the PSF which becomes a circular blur [Rufino & Accardo 2003, Hopkins 1955]. The radius of the blur circle, R, from a point source at an infinite distance is related to the displacement from ideal focus, z , by the equation: z . F#

2R =

(2.3)

The spot size is denoted as the diameter of the blur circle = 2R. Increasing the radius of the PSF is beneficial because it provides additional sampling points of the stars illumination pattern which improves centroid accuracy. However, there is a trade-off between increasing sampling and the contributions of detector noise. As the spot size of the imaged PSF is increased, the SNR of the measured signal is effectively decreased. If the SNR falls too low, variations in detector noise can begin to impact the location of the first-moment centroid or worse, prevent the star from being detected at all. For these reasons, it is desirable to maintain as tight of a focus as possible, while not negatively impacting the accuracy of the centroiding technique. See Fig. 2.1 for an illustration of how the above mentioned variations in focus impact the PSF spot size and in turn, centroid accuracy.

2.1.2

Existing Focusing Techniques

One common approach to focusing star trackers is to iteratively image a collimated point source and adjust the sensor focus based on imaged PSF spot size. This method does have an advantage in that the collimated point source accurately represents a star at an infinite distance. A disadvantage of this method is that each image gives a limited perspective on the level of focus across the entire detector plane. Due to various optical aberrations that 13

Chapter 2. Image Quality and Detection Performance

CENTROID ACCURACY = 1 PIXEL MIN. SPOT SIZE FOCUS <1 PIXEL SUBPIXEL CENTROID ACCURACY

DESIRED FOCUS 3-5 PIXELS

TOO DEFOCUSED >> 5 PIXELS

CENTROID SHIFT DUE TO NOISE

STARLIGHT (SIGNAL) DETECTOR NOISE

Figure 2.1: PSF spot size vs. star tracker focus.

cause radial and angular variations in the ideal focal plane [Malacara 2007, Born et al. 2000, Mahajan 1998a,Mahajan 1998b], many images of the collimated point source must be taken before an appropriate focus adjustment can be calculated. Unlike focusing star trackers, focusing cameras is generally is done by imaging various naturally occurring scenes, or focus calibration targets. Each image is first assessed by some measure of focus using a predefined focus metric [Krotkov 1987,Groen et al. 1985]. The focus of the camera is then iteratively changed and a new image taken, until a maximum value of the focus metric is found [Subbarao & Choi 1993]. A disadvantage of most of these metrics is that the measure of focus is not easily related to the distance of the image detector from the focal plane of the sensor optics. Instead, these metrics generally only provide a relative, instantaneous measure of focus. On consumer cameras, this iterative focus adjustment is usually implemented with an auto focus mechanism. This allows for quick refocusing to objects at various distances. Star trackers generally do not have the ability to actively alter their focus. From an image processing standpoint, there are benefits to using the entire image for focusing, especially when the scene is a focus calibration target. Firstly, each image can provide a more spatially representative measure of focus when compared to focusing using a single PSF. If a target is used instead of a just any available scene, we can insure that all regions of the FOV are equivalently represented according to the defined focus metric. An additional benefit of a focus target is that it may be able to attain spatially-based focus information from each image that can be used to determine detector tip and tilt. 14

2.2 Measuring Focus

2.1.3

The Focusing Mechanism of the ST-16 Star Tracker

Inside the sensor housing of the ST-16 there is a single circuit board which carries both the processor and the detector. The lens is rigidly mounted to the chassis, and focus is achieved by moving the detector; which is mounted to the chassis, by three focus screws, each with a thread pitch of 0.45 mm (0.00125 mm of travel per 1 of rotation). By moving certain combinations of the screws, both the standard piston adjustment as well as additional tip/tilt adjustments of the detector can be achieved. Figure 2.2 shows the sensor cross section and focusing mechanism layout.
SENSOR BODY SENSOR OPTICS HIGH STIFFNESS SPRINGS 1 ADJUSTABLE FOCUSING NUTS

2

DETECTOR ORIGIN PIXEL: (0,0) IMAGE DETECTOR

IMAGE DETECTOR

3 ADJUSTABLE FOCUSING NUTS

Figure 2.2: ST-16 Focusing mechanism.

2.2

Measuring Focus

The focus of an optical system can be characterized by the range of spatial frequencies that it can resolve [Krotkov 1987, Pentland 1987, Subbarao & Choi 1993]. Poorly focused systems are only capable of resolving low frequencies while well focused systems can resolve frequencies up to their Nyquist frequency.

2.2.1

The Modulation Transfer Function

The image of an optical system can be formed as a convolution of the system's PSF and the object being imaged. Let O (x, y ) represent the intensity of the object, and hpsf (x, y ) represent the PSF, then the resultant image is calculated as: 15

Chapter 2. Image Quality and Detection Performance





I (x, y ) =
n1 =- n2 =-

O [n1 , n2 ] hpsf [x - n1 , y - n2 ]

(2.4)

Consider now, imaging a modulating intensity pattern described as a sinusoid with an arbitrary spatial frequency, fs . If Imax denotes the maximum intensity of the pattern, and Imin , denotes the minimum intensity, then let C denote the normalized amplitude of the intensity pattern, which is referred to as the contrast. This is mathematically defined as: Imax - Imin . Imax + Imin

C=

(2.5)

Isolating one wavelength of this pattern, and applying Eq. (2.4), it can be seen from Fig. 2.3a that image of the single wavelength is wider than the original object wavelength. This change in shape is due to the physical size and shape of PSF.

1

2

0.9

1.8

Object Pattern
0.8 1.6

Image Pattern

0.7

1.4

Object
0.6 1.2

Intensity

0.5

Intensity

1

0.4

0.8

0.3

Image

0.6

0.2

0.4

0.1

0.2

0

0

1

2

3

4

5

6

7

8

9

10

0

0

5

10

15

20

25

30

35

Arbitrary Spatial Dimension

Arbitrary Spatial Dimension

(a) A Single Wavelength

(b) Full Pattern

Figure 2.3: Imaging a modulating intensity pattern.

If we now consider imaging a portion of the modulating intensity pattern, shown in Fig. 2.3b, several wavelengths (or cycles) in length, it is not difficult to imagine that images of neighboring cycles will overlap and interfere. The result of this interference on the modulating intensity pattern will be a decrease in the observed contrast of the modulating pattern. Holding the PSF constant and increasing the spatial frequency of the modulating pattern will have a similar effect but larger in magnitude. Since the wavelength is now smaller, the amount of overlap between neighboring cycles will be larger, and therefore the observed contrast of the modulating pattern will be less. Changing the size of the PSF has a similar effect. Larger PSFs cause more contrast attenuation, while smaller PSFs cause less attenuation. 16

2.2 Measuring Focus The ability of the optical system to transfer contrast between the object and the image is defined by the Modulation Transfer Function (MTF) which is a function of the spatial frequency, fs , of the modulation. This is mathematically defined as: Cimage (fs ) Cobject (fs )

M (fs ) =

(2.6)

Where M (fs ) is the modulation transfer for a specific spatial frequency and is expressed as a fraction of the ideal modulation transfer of 1.0. The MTF refers to the entire set of M (fs ) values for all fs . Figure 2.4 shows several MTFs of a simulated system at various levels of defocus. Notable differences in modulation transfer are seen as the level of defocus is increased.

2.2.2

The Siemens Sinusoidal Star Pattern

A common approach to MTF measurement is to use the Siemens Sinusoidal Star Pattern (SSSP). This pattern consists of numerous pie-shaped regions that vary angularly in intensity according to a sinusoidal relation, see Fig. 2.5 for an example. This provides a continuous range of spatial frequencies, specified by the size and number of cycles in the pattern. The analysis of image contrast versus spatial frequency is performed along a series of concentric circular paths that are traced around the pattern center. The spatial frequency of the intensity variation decreases with increasing radius. The notion of this analysis is that as one travels from the lowest spatial frequency (outer edge) towards the center, we will reach a radial distance where we can no longer resolve the intensity variations of each cycle due to the attenuation caused by the shape and size of the PSF. The focusing procedure developed in this chapter utilizes the approach developed by Loebich et al. to measure the MTF using the SSSP. This approach is briefly described below, for more detail see [Loebich et al. 2007].

1 Normalized Contrast 0.8 0.6 0.4 0.2 0 0.04 Gaussian Blur ( =0.1) Gaussian Blur ( =1) Gaussian Blur (=3) Gaussian Blur (=5) 0.06 0.08 0.1 0.12 0.14 Spatial Frequency, cycles/pixel 0.16 0.18

Figure 2.4: Example modulation transfer function.

17

Chapter 2. Image Quality and Detection Performance

Figure 2.5: Example Siemens sinusoidal star pattern (72 cycles).

Let the number of cycles, or line pairs, of light/dark variation in the SSSP be denoted as Ncyc . If the SSSP is divided into np equal pie-shaped segments, each segment will have mp cycles per segment, where mp = Ncyc /np . Following Loebich et al, each of these segments will be used to compute a separate MTF which can then be used to examine any differences in observable frequencies across regions of the image detector. For clarity, let each mp -cycle segment be called a section and numbered 1-8, see Fig. 2.7. The resolvability of a specified spatial frequency fs , is measured through the detected modulation, M (fs ), of the sinusoidal variation in image intensity along a concentric circular path defined by a specific radial distance from the SSSP center. Cimage is the contrast measured in the image of the SSSP, and Cobject is the contrast of the of the SSSP. The latter is determined by sampling the image of the SSSP in both white and black regions that have large areas of uniform color, thereby removing the effects of defocus on measuring intensity. The contrast of the image, Cimage , can be related to a corresponding set of parameters that define the intensity of the observed sinusoidal relation. This relation is defined as:

Imodel (f ) = a + b1 cos(f 2 mp ) + b2 sin(f 2 mp )

(2.7)

where f is a variable representing the angular displacement from beginning of an SSSP 2 segment, np , to the end ­ see Fig. 2.6, b = b2 1 + b2 is the amplitude of the sinusoid and a represents it's mean value. The relation defined by Eq. (2.7) is fit to the measured image intensity, Iimage , along a single cycle at fixed radial distance, rSSSP , to determine the contrast, Cimage = b/a. Using a bounded minimization of the Mean-Squared Error (MSE) between 18

2.2 Measuring Focus the measured image intensity, Iimage , and the modeled intensity, Imodel , model parameters a, b1 , and b2 are estimated. The MSE is defined as:

Qint

1 = l

l

(Iimage - Imodel )2
1

(2.8)

where l is the number sample points along one cycle length. These sample points are selected as the pixels that fall under the concentric circular path defined by rSSSP as shown in Fig. 2.6. The spatial frequency corresponding to the contrast measurement is determined using the relation:

fs =

Ncyc 2rsssp

(2.9)

where fs is the spatial frequency measured in cycles/pixel and rsssp is the radial distance, in pixels, of the sample point from the SSSP center. To minimize the effects of image noise, instead of fitting the sinusoidal relation given by Eq. (2.7) to single cycle at a time, mp cycles, or one section is fit at a time. This process is repeated through a range of spatial frequencies (radial distances) to get corresponding measures of contrast versus spatial frequency. Each section of the SSSP is used as a measurement of the spot size local to that region of the image. Figure 2.7 is an illustration of this whole procedure.

 

SSSP Center
Figure 2.6: Schematic of f .

19

Chapter 2. Image Quality and Detection Performance

1

FIT SINUSOIDAL MODEL TO  DETERMINE CONTRAST

2

REPEAT (1) FOR  DESIRED RADI (SPATIAL FREQUENCIES)  TO DETERMINE SECTION MTF

3

REPEAT (2) FOR EACH SECTION  OF THE SSSP

Figure 2.7: Flowchart for MTF calculation from the SSSP.

2.3

Modeling Focus Error

The previous section explained how the MTF can be used to assess levels of focus based on resolvable spatial frequencies. This section introduces a preliminary framework to relate the MTF of a system to a corresponding focus error based on planar focal surface imaging model. Stated briefly, the approach is to first simulate the measured defocus through the application of a blur kernel to an artificially generated image of a Focus Calibration Target (FCT). The simulated defocused image is then matched with the real star tracker image based on the MSE between their measured MTFs. Once a match is found, the focus error is described by the specifications of the applied blur kernel. This is related to the distance of 20

2.3 Modeling Focus Error the image detector from the lens (focus error) through a geometric model. First, I present the procedure for blur simulation used to measure the spot size of the defocused PSF. Then I discuss the optical model that was used to relate the measured PSF spot size to focus error.

2.3.1

Blur Simulation

Blur due to defocus can be approximated by a convolution of the system PSF and the desired scene [Subbarao & Choi 1993, Groen et al. 1985, Krotkov 1987]. Assuming the target/scene is also at significant distance, the blurred image can be modeled as a convolution of the defocussed PSF and a focused image of the target. Determining the size of this blur circle directly from the blurred image of a scene is difficult. Instead, I propose to indirectly measure the size of the blur circle by matching the MTFs of actual blurred images to MTFs of simulated images, blurred with PSFs of varying size and shape. I investigate the use of three different blur kernels to accurately simulate the blur due to defocus of an SSSP. Each kernel is specified by a set of parameters that is fit based on the similarity of the defocus blur to that seen in actual defocused images. This similarity is defined by a cost function, QMTF , which is based on the MSE between the measured MTFs from the simulated and actual blurred images, denoted as MS and MA , respectively. Let the set of kernel parameters be specified by Hf , then the cost function is defined as:
g

QMTF

1 = g

(MA - Ms )2
1

(2.10)

where g is the number of sample points within each MTF, and where MS = f (Hf ). Beginning with an artificially generated image of the scene, the FCT, composed of numerous SSSPs, I iteratively blur the artificial image with three different blur kernels specified by their respective shape parameters. I compare the resultant MTFs, MS and MA , using Eq. (2.10). Linear interpolation is used to calculate the simulated modulation transfer values, MS , for a direct comparison against measured the modulation transfer, MA , at the corresponding measured spatial frequencies. A nonlinear minimization of the cost function, Eq. (2.10), is then used to find the set of kernel parameters, Hopt , that correspond to the lowest MSE between the two MTFs. Various approximations to the shape and size of a defocused PSF are discussed in literature [Hopkins 1955,Pentland 1987,Groen et al. 1985,Krotkov 1987,Rufino & Accardo 2003]. The most common of these are the Symmetric Gaussian (SG) and the circle of equal intensity, or Pillbox (P). Each of these PSF approximations have slightly different effects on the simulated modulation transfer of a blurred image. The SG kernel has the tendency to act as a low pass filter and heavily attenuate higher frequencies similar to the effects of diffraction. While on the other hand, the P kernel evenly attenuates all frequencies, more similar to defocus. Most 21

Chapter 2. Image Quality and Detection Performance optical systems have PSFs that are a combination of both diffraction and defocus [Rufino & Accardo 2003]. This results in a blur kernel that is a combination of both the SG and the P. Experimentation is generally used to determine which of the commonly used models for PSF best represents the defocus in your system. Therefore, as part of this chapter I evaluate the use of all three blur kernels to assess which best represent the actual measured MTF of the defocused FCT. We now briefly describe the parameter set, H , used to define the size and shape of each of the three specified blur kernels. The first blur kernel used is the SG spot. The shape of a specific SG blur kernel is defined by a single parameter, SG , through the following relation:
y -x + 1 2 2 SG e h1 (x, y ) = 2 2SG 2 2

(2.11)

where (x, y ) are the pixel coordinates. The shape parameter, SG , is related to the blur circle radius, R, through the linear equation: SG = cb R (2.12)

where c b is a constant that is greater than zero. Subbarao states an approximate value for cb of 1/ 2 from practice [Subbarao & Choi 1993]. The second approximation to the shape of the defocused PSF is the circle of equal intensity, also known as a pillbox. The size of the pillbox is directly defined by its radius, pr , through the following equation: 1, 0, x 2 + y 2  pr elsewhere

h2 (x, y ) =

(2.13)

The last of the three models used is based on the combination of both the SG and P as suggested by Rufino and Accardo [Rufino & Accardo 2003]. We define this PSF as Symmetric Gaussian Pillbox Combination (SGP) which is described as the sum of a SG blur kernel specified by a shape parameter,  , and a scaled P blur kernel specified by a radius, pr , and a relative intensity, G, with respect to the SG. This is defined with the expression: h3 (x, y ) = h1 (x, y,  ) + G h2 (x, y, p) (2.14)

The radius of the P kernel within Eq. (2.14) is constrained to be larger than the SG kernel and is therefore the dominant parameter used to specify the size of the blur circle. As mentioned above, the accuracy of each blur model will be evaluated based on it's similarity to the real defocused image attained with the star tracker. This is evaluated through blur simulation, MTF measurement, and finally MTF comparison using Eq. (2.10). I now move on to introduce optical framework to relate the size of the blur circle, specified by the parameters of each blur kernel, to the local focus error of the image detector. 22

2.3 Modeling Focus Error

2.3.2

Defocus in Imaging Systems with a Planar Focal Surface

In a simple imaging system, the size of the blur circle, 2R, can be related to local focus error, |s - v |, through ray optics. This represents an approximate model that is only valid in a small circular region around the optical axis. I utilize the framework of this paraxial approximation to build an extension to this model that is then used to evaluate the focus error across the detector. I first present a summary of the basic paraxial approximation given by Subbarao et al. [Subbarao & Choi 1993] and then develop the paraxial model extension in the following subsection. The process of image formation for a simple camera, using a thin lens model, is shown in Fig. 2.8. If we envision a point object, P , at distance of u in front of the lens, then it's focused image, P , will appear on the image plane, a distance v behind the lens. This distance, v , can be found through the lens formula:

1 1 1 = + f u v

(2.15)

where f is the focal length of the system. I assume that the system is circularly symmetric around the optical axis. If the position or orientation of the image detector change, the light from point object, P , will no longer be focused onto a single point P in the image plane. Instead, light from the object will be spread over a circular region commonly referred to as the blur circle. This circle will have a radius R, which I denote as the blur radius. From similar triangles, the radius of the blur circle can be expressed as a function of lens aperture, D, and the distance from the lens to the image plane, v , as:

s-v 2R = D v

(2.16)

The focus error can be found through Eq. (2.16) if the blur radius is determined through blur simulation. This relation is:

|s - v | 2R = v D 2R |s - v | = v = D

(2.17a)
1 f

1 -

1 u

2R D

(2.17b)

23

Chapter 2. Image Quality and Detection Performance
PLANAR FOCAL PLANE IMAGE DETECTOR

SCENE u P D/2 f OPTICAL AXIS Q s

P'

2R s-v

v

Figure 2.8: Image formation with a simple camera and planar focal plane.

2.3.3

Defocus in Imaging Systems with a Curved Focal Surface

The imaging model shown in Fig. 2.8 makes the assumption that the focal surface is planar. This is valid only under the paraxial approximation. As we begin to factor in various aberration terms, it can be seen that the focal surface in most simple imaging systems is in fact a curved surface. One of the most common optical aberrations, known as field curvature, causes variations in spot size across a planar image detector as a function of radial distance from the optical axis, see Fig. 2.9. Due to these effects, the relation between blur radius, R, and focus error, |s - v |, is not linear as portrayed with Eq. (2.17). As an extension of the paraxial model shown in Fig. 2.8, I define the focal surface as a single paraboloid. If I assume the focal surface is symmetrical around the optical axis, I can describe the paraboloid with two parameters, q and p through the relation:

z=

x2 + y 2 q2

+ p

(2.18)

where (x, y ) are pixel coordinates, q describes the shape of the paraboloid, and p describes its distance from the image detector. I define the detector as a planar surface, centered on the optical axis at the origin of the reference frame. The plane is described with a set of parameters Jp using:

ap x + bp y + cp z + dp = 0 24

(2.19)

2.3 Modeling Focus Error
PETZVAL FOCAL SURFACE IMAGE DETECTOR

s

>2R P' 2R

OPTICAL AXIS r

v

s-v (r)

Figure 2.9: Defocus in a simple imaging system with a curved focal plane.

where Jp = (ap , bp , cp ) and dp = 0 by definition of the plane location. The axial distance (parallel to the optical axis) between the focal surface and the detector plane is defined as the local focus error |s - v |, and is expressed as: x2 + y 2 q2 ap x + b p y cp

|s - v | =

+ p +

(2.20)

Using Eq. (2.17) I can relate the determined blur radius to the relative distance between the focal surface and the detector plane. I define a cost function, Q|s-v| , to express the MSE discrepancy between the predicted and measured set of focus errors for a given set of pixel coordinates and a set of paraboloid and detector plane parameters, q , p, and Jp , respectively. This function is defined as:
i 1 (M

Q|s-v| =

- P )2

i

(2.21)

where M = |s - v |M , and P = |s - v |P represent the measured and predicted local focus errors, and i is the number of focus error points available. Through the use of a nonlinear minimization of Eq. (2.21), I determine the set of paraboloid and plane parameters that best describe the calculated focus errors. I then use these determined parameters to calculate the focus adjustment necessary to move the detector array to be coincident with the focal surface along the optical axis. This is then given through the relation: ap xs + bp ys cp

zs (xs , ys ) = p + 25

(2.22)

Chapter 2. Image Quality and Detection Performance where (xs , ys ) are the coordinates of the focus adjustments nuts shown in Fig. 2.2 with respect to the center of the image detector. This model should provide a better resolution of the detector position from focus error data than the first planar model described in Section 2.3.2.

2.4

Focusing Procedure

A Focus Calibration Target (FCT) was created based on a grid of 3 × 3 SSSPs; see Fig. 2.10. The target is approximately 100 cm × 75 cm (40" × 30") in size and was printed at a resolution of 300dpi (dots per inch). Circular Vision Targets (CVTs) were added to the center and perimeter of each SSSP to allow for accurate target registration. Each SSSP is approximately 25 cm × 25 cm (10" × 10") and has 144 sinusoidal variations in intensity (cycles). In this section, I describe the specific steps and details used to perform some initial testing with the developed focus procedure. Figure 2.11 provides the reader with a flowchart of the required operations.

2.4.1

Keystone Correction

When the FCT is not aligned orthogonal to the boresight axis of the star tracker, the images of the target will appear trapezoidal instead of rectangular. This deformation is referred to as the image keystone. When imaging the FCT, key-stoning causes the images of individual SSSPs to become non-circular making it difficult to carry out the planned analysis along paths of constant spatial frequency. This problem is mitigated by remapping these paths

Figure 2.10: Focus calibration target.

26

2.4 Focusing Procedure

Take Image of Focus  Calibration Target 2Part Keystone  Correction Calculate MTFs

Solve for Local  Focus Errors Fit Plane to Focus  Error Calculate Required  j Focus Adjustment

Figure 2.11: Flowchart of focus calibration procedure.

onto the image of the FCT through a system model and a set of calibrated parameters. The system model, shown in Fig. 2.12, utilizes three frames of reference: the target frame, the camera frame, and the detector plane designated by the subscripts: T, S, and D, respectively. There are six model parameters that describe the position, uT = (xT , yT , zT ), and the orientation, t , t , t , of the FCT with respect to the star tracker. The transformation from the target frame to the sensor frame is then expressed as:

pS = R T p T + u T

(2.23)

XS DETECTOR XD

XT 



u
YD f

ZT ZS  YS TARGET YT

Figure 2.12: System model for keystone correction.

27

Chapter 2. Image Quality and Detection Performance where RT is a rotation matrix defined by a X-Y-Z Euler angle set, parameterized by T , and pS , pT denote the coordinates of a point in the S and T-frames, respectively. By using a simple pinhole model for image formation and assuming an approximate detector position equal to the focal length of the star tracker optics, f , the transformation of coordinates from the sensor frame into the detector frame can be defined using some simple algebra for line-plane intersection. I begin by defining the detector plane with a point, aS = [0, 0, -f ], and a normal, nS = [0, 0, 1] expressed in the sensor frame. The transformation of a point from sensor coordinates, pS , to detector coordinates, pD , is then defined as:

pD = - pS t where, (aS · nS ) - (pS · nS ) (-pS · nS )

(2.24)

t=

(2.25)

This model is utilized to map the ideally concentric circular paths of spatial frequency onto the keystoned image of the FCT. I then extract image intensity values along these paths in order to measure the star trackers MTF at various points along the detector. Calibration of the six model parameters is done through a minimization of the Root-MeanSquared (RMS) error between the measured CVT coordinates and a set of projected CVT coordinates given their actual separation on the target. Let pT represent a set of equally spaced points in the target frame that correspond to the CVTs placed at the center of each SSSP. Let pD represent the projection of these points into the detector frame, where the transformation from T-D is given by Eqs. (2.23) to (2.25). Given initial coordinates for pT , I can calculate the corresponding RMS error between pD and the actual imaged coordinates of the center CVTs, lD , through the following expression:

QCVT =

(pD,x - lD,x )2 + (pD,y - lD,y )2 nCV T

(2.26)

where nCVT is the number of CVTs, and

pD = f (uT , t , t , t )

(2.27)

A nonlinear bounded minimization routine is used to determine the set of model parameters that describe the smallest error between the known and imaged CVT positions. This is done in a two-step process to reduce computational time. The initial step utilizes only 9 of the 28

2.4 Focusing Procedure FCT's CVTs that are placed at the center of each SSSP. The imaged location of each CVT is determined by convolving a simulated image of the CVT with the image of the FCT and centroiding the resultant metric using Eq. (2.1). This coarse fit of the system parameters allows us to make approximations to the location of the remaining 36 edge CVTs (located along the perimeter of each SSSP). The precise image coordinates of each of these edge CVTs are then determined through the same convolution/centroid process. The locations of these 36 edge CVTs are then added the initial 9 center CVTs to perform a secondary fine fit of the model parameters. Figure 2.13 shows the fitted CVT positions on an image of the FCT.
200 400 Detector rows, pixels
Detector rows, pixels 700 800 900 1000 1100 1200

600 800 1000 1200 1400 1600 1800 500 1000 1500 2000 Detector colmuns, pixels 2500

1000 1100 1200 1300 1400 1500 1600 1700 Detector colmuns, pixels

Figure 2.13: Keystone correction applied to the focus calibration target.

2.4.2

Calculation of Focus Error

A series of images of the FCT were taken with the ST-16 star tracker to provide some initial results of the presented framework. Using the calibrated keystone model described above, I extracted intensities from specified paths along a series of images of the FCT. As described within Section 2.2, intensities are sampled across circular paths of constant frequency. Each circular path is separated into 8 segments, each containing m = 18 cycles of light/dark variation. I use a fixed sampling density of 30 points per cycle length that results in a total of 540 sample points for each 18 cycle arc. From the observed intensity pattern I calculate a modulation value by fitting the sinusoidal model defined by Eq. (2.7). One corresponding spatial frequency is calculated per arc through the use of Eq. (2.9) and the mean radial distance of each sample point. This process is repeated for 70 radii that are equally spaced between the values of 25-90% of the imaged SSSP radius. This forms the imaged MTF for a specific section that is designated with the numbers 1-8. Following the MTF measurement phase, three blur radii were iteratively calculated for each MTF by fitting kernel parameters defined by Eqs. (2.11) to (2.14) to the measured MTF. Blur simulation was achieved by a two-dimensional convolution of the specified blur kernel and a sample portion of a single SSSP. Using the calculated values for blur radii, I then determined the local focus error for each section through Eq. (2.17). The focus error results 29

Chapter 2. Image Quality and Detection Performance were then used to calibrate the geometric model based on a paraboloid focal surface, given by Eq. (2.20).

2.5

Focusing Results

A series of initial tests were conducted to assess the performance of various segments of the developed procedure. Each test consisted of a series of images taken at various focus settings where the relative adjustments from image to image were known. The focusing procedure was then used to assess each image and return the position and orientation of the image detector. Additionally the performance of the three different blur kernels was tested to determine which best simulates the defocus seen in our image sets. I first discuss some of these preliminary results pertaining to blur simulation and then present some initial results of measured detector positions at various levels of defocus.

2.5.1

Accuracy of Blur Simulation

The framework developed for this focusing procedure relied on the size of the PSF being known. This was indirectly determined through the simulation of blur due to defocus using an artificial image of the FCT and three different blur kernels. These kernels were the symmetric Gaussian, the pillbox and a combination of the two described by Eq. (2.14). The accuracy of their blur simulation was assessed by the Mean-Squared Error (MSE) between the MTFs of the actual and simulated blurred images, defined by Eq. (2.10). Although the performance of the three kernels did fluctuate with various levels of defocus, their ordering in terms of accuracy remained constant. The symmetric Gaussian distribution proved to best represent the imaged defocus. This was followed by the combination of the symmetric Gaussian and pillbox, and finally the pillbox alone. Table 2.1 shows average values of the residuals, given by Eq. (2.10) at three different focus settings.
Table 2.1: Average MTF Residuals at 3 Focus Settings

Image 1 2 3

Spot Size 20 pixels 30 pixels 40 pixels

Symmetric Gaussian 0.0872 0.0630 0.0352

Pillbox 0.0976 0.0701 0.0514

Combination(SGP) 0.0953 0.0705 0.0404

Although the SG distribution does clearly show to be the best of the three kernels, in some cases there was still a relatively significant discrepancy between the MTF of real blurred image and the simulated blur. This discrepancy mainly occurs at higher spatial frequencies which the SG kernel tends to attenuate heavily, see Fig. 2.14b. The performance of the kernel 30

2.5 Focusing Results is quite high at lower levels of focus (larger blur circles), see Fig. 2.14a. However as we begin to move more into focus and the MTF ceases to drop off at a certain frequency, the simulated MTF no longer closely maps the true MTF of the defocused image. This misrepresentation of the blur due to defocus inevitably causes discrepancies in the determined spot size. Although some success was achieved by scaling the measured spot sizes by a constant amount, this limits the accuracy performance of the focusing procedure as we approach desired focus positions. Further examinations need to be completed on the accuracy of using circular blur kernels in blur simulation. Additionally, future work should also investigate the effectiveness of determining the size of the PSF directly from the MTF measurements through the use of the inverse Fourier transform.

2.5.2

Accuracy of Detector Positioning

The second preliminary test of the focusing procedure was the accuracy assessment of the determined detector position and the orientation. A series of images were taken at various focus levels with known adjustments between them. Focus adjustments ranged from 0.225mm (1/2 turn of the focusing screws) to 0.0563mm (1/8 turn of the focusing screws; see Fig. 2.2). The determined focus error at each image was then used to fit the paraboloid model discussed above. The changes in calculated detector position were compared against the measured change in focus error. Initial results show the average discrepancy between commanded and measured focus adjustments was approximately 0.055mm, or about 1/8th of a turn on the focusing screws. According to Eq. (2.3), this limits sensor focus to a blur circle diameter of just over 20 pixels. Although this is encouraging for initial testing, blur

0.5 0.45 0.4

Measured MTF Simulated MTF

0.8 0.7 0.6

Measured MTF Simulated MTF

0.35 Modulation Transfer Modulation Transfer 0.06 0.08 0.1 0.12 0.14 0.16 Sampling Frequency (cycles/pixel) 0.18 0.2 0.3 0.25 0.2 0.15 0.2 0.1 0.05 0 0.04 0.1 0 0.04 0.5 0.4 0.3

0.06

0.08

0.1 0.12 0.14 0.16 Sampling Frequency (cycles/pixel)

0.18

0.2

(a) Out of focus

(b) In focus

Figure 2.14: Accuracy of MTF reproduction.

31

Chapter 2. Image Quality and Detection Performance circle diameters of less than 10 pixels are required for desired focus levels of the ST-16 star tracker.

2.6

Summary and Future Work

I have developed the framework for a focusing procedure for star trackers. The procedure provides the ability to determine the position and orientation of the image detector given a single image of the developed FCT. Initial results show that focus adjustments of up to 0.055 mm can be traced through the procedure. Although these preliminary results are encouraging, several improvements to the procedure are required before it can be effectively used to achieve desired focus levels. Future work should include the examination of non-symmetric PSF models to improve the mathematical representation of the shape of the PSF better as desired focus is approached. For the ST-16, this should begin with models that incorporate the effects of astigmatism which have been found to be a dominant aberration from experimental testing. This will not only enable better focus control but also provide the ability to characterize lens performance. The latter can be incorporated into star tracker detection routines to increase detection performance. Although this work has not addressed this at all, an important investigation would be to define what an optimal focus would be, by examining the variation in PSF shape and intensity throughout the FOV.

2.7

Contributions to the Field

The use of the SSSP to measure the MTF, and the use of the MTF to describe the focus of an optical system is not novel. I have drawn on these tools to develop a framework for focusing a special type of a camera, a star tracker. This differs from typical cameras in that it doesn't contain a motorized focus control mechanism, and the desired application is imaging stars which are effectively at an infinite distance. The framework I have developed consists of the FCT, a corresponding analysis procedure, and initial testing to tune the analysis procedure to the specific performance of the ST-16 lens. The FCT is designed to describe the focus of the star tracker at numerous points throughout the FOV. The analysis procedure I have developed, incorporates commonly used techniques to measure the MTF in one location within the FOV. Repeating this process throughout the FOV is novel as the tip/tilt of the detector is not typically addressed. I have tested three different blur kernels to assess which best represents the lens of the ST-16. 32

2.7 Contributions to the Field

1 2 3 4 5

Use of SSSP to measure MTF Relation of MTF to PSF size Development of FCT Development of procedure,  and initial testing Analysis of performance
Personal Contributions Collaborative Work From Literature

Figure 2.15: Summary of contributions for focusing procedure.

1

Development of Camera Model

Lastly, I have assessed the preliminary of this method in focusing the ST-16 2 Development  of Labperformance  Model star tracker. These contributions are summarized in Fig. 2.15. 3 Parameter Optimization Compared to existing star tracker focusing methods, a significant benefit of the developed Personal Contributions Development of Procedure, and  calibration procedure is that it requires far fewer images. Additional benefits are that it 4 Performance Assessment Collaborative does not require any special hardware and can be implemented on other Work optical devices that require precise focus Environmental Validation Tests 5 calibration. From Literature

33

Chapter 2. Image Quality and Detection Performance

34

Chapter 3

Star Vector Error

A star tracker's accuracy is the uncertainty in its orientation measurement. This is closely related to the accuracy with which the sensor can measure the direction vectors to the stars in view. This process is typically achieved in two phases: 1. The image of the star must first be located precisely on the detector. This is accomplished by the detection routine which incorporates knowledge of sensor focus to identify and separate the intensity distribution of stars from the image background and find their centroids. This was discussed in detail in Chapter 2. 2. The detector position of the star must be related to a corresponding star vector. This is accomplished through the use of an optical model, typically known as a camera model, and may also include algorithms that correct for various centroid errors introduced by hardware components. This chapter discusses the elements of this second phase. I begin with description of the developed camera model and an associated calibration process which estimates the model parameters. I then present an algorithm that was developed to compensate for the effects Electronic Rolling Shutter (ERS) which is utilized on most CMOS image detectors.

3.1

Camera Calibration

Camera models relate image plane coordinates to object space coordinates. These models are based on a set of parameters that describe the internal geometry of the camera, lens behavior, and the orientation and position of the camera with respect to some target. Accurate knowledge of these parameters is crucial for applications that involve quantitative measurements such as dimensional measurements, depth from stereoscopy, and motion from images. Knowledge of these parameters is acquired through the use of a camera calibration 35

Chapter 3. Star Vector Error procedure. Typically, this procedure consists of imaging a target that has numerous structured features (structure is known a prior ), several times in different camera orientations. Based on the measured location of these features, various techniques exist for determining the camera model parameters [Wang et al. 2008, Weng et al. 1992, Sturm et al. 2010]. This section describes the camera model and associated calibration procedure used to calibrate the ST-16 star tracker. The camera model used is based primarily on the work of Wang et al. with an extension to describe the specifics of the lab setup at SAIL. A calibration procedure, consisting of an acquisition procedure and a parameter optimization routine, was then developed around the extended camera model. This calibration procedure provides knowledge of 11 sensor parameters critical for the accurate formulation of star vectors from image plane coordinates of star centroids. In addition to providing accurate star measurement capabilities, the developed calibration routine is also employed to validate sensor performance following environmental testing. For typical ST-16 flight units, environmental 1 Use of  SSSP to  measure  MTF testing, please see Section 3.1.2.E for more testing includes thermal cycling and vibration information. 2 Relation of MTF to PSF size
 of FCT The extension of 3 the Development camera model as well as the formulation of the parameter estimation routine represents a collaborative contribution between Personal myself Contributions and my supervisor, Dr. John Development of procedure,  4 andacquisition Enright. The developed procedure, performance assessment of the parameter op initial testing Collaborative Work timization, and formulation of the entire camera calibration into a production routine used to From  Literature my own contributions. 5 Analysis  of performance both initially calibrate and then validate ST-16 flight units represents A summary of the contributions is shown in Fig. 3.1. 1 2 3 4 5 Development of Camera Model Development of Lab Model Parameter Optimization Development of Procedure, and  Performance Assessment Environmental Validation Tests
Personal Contributions Collaborative Work From Literature

Figure 3.1: Summary of contributions for camera calibration procedure.

3.1.1

Camera Model

Most camera models typically describe the transformation from 3D world coordinates to 2D coordinates on the image plane using a set of model parameters. In the case of a star tracker, the camera model describes the transformation from body-referenced star vectors to image detector coordinates. I denote this transformation as the forward model, and denote the inverse transformation (image detector coordinates to body-referenced star vectors) as the 36

3.1 Camera Calibration inverse model. The camera model used is based on the work of [Wang et al. 2008]. This model accounts for elements of both radial and tangential distortion which have been found to be prevalent in the imaging optics of the ST-16. First, I introduce the pinhole camera model approximation. Second, I provide a basic description of the modeled geometric distortions. Lastly I provide descriptions of both the forward and inverse camera models developed for camera calibration and star tracker processing.

3.1.1.A

Basic Pinhole Model

Let (x, y, z )C represent the coordinates of any star vector a within a camera-centered reference frame defined by (XYZ)C as shown in Fig. 3.2. Assuming a pinhole optics model, we can map this direction vector to a set of corresponding coordinates on the ideal image plane using the relation: - f xC xJ = yJ zC yC

(3.1)

where the ideal image plane is defined by (XY Z )J , and f is the effective focal length of camera optics. The (X,Y)J axes of the image plane are parallel to the (X,Y)C axes, and represent the ideal location of the image detector. The ZJ axis is chosen to be coincident with ZC which represents the optical axis of the camera optics. Therefore, (x, y )J represent the


Theoretical  Pinhole

 f f
Example  Ray

Ideal Image  Plane (actual)


x

x


Principal Point Ideal Image  Plane (virtual)

,

, 







 

Figure 3.2: Camera model reference frames.

37

Chapter 3. Star Vector Error ideal image plane coordinates of the incoming star vector ac with respect to the intersection of the optical axis with the image plane, which is denoted as the principal point. This mapping of 3D coordinates to a 2D image plane using a pinhole camera is a perspective projection, followed by a 180 rotation of the whole image. To simplify future expressions, the need for image inversion is removed by modeling the image plane as a virtual image defined by (XYZ)I in Fig. 3.2. This changes Eq. (3.1) to: gx gy f xC zc yC

gI =

=
I

(3.2)

For the remainder of this section, the virtual image plane is referred to as simply the image plane and is denoted with the subscript I.

3.1.1.B

Geometrical Distortions

Due to several types of imperfections in the design, manufacture, and assembly of lenses composing the optical system, the expression given by Eq. (3.2) does not reflect the true image plane position of point g I . This expression must be revised to include geometrical distortions of the form: jx g  (g , g ) = x + x x y jy gy y (gx , gy )

(3.3)

where g = (gx , gy ) are the distortion-free image coordinates, j = (jx , jy ) are the distorted image coordinates, and x , y are positional errors due to various geometric distortions. Following the model described by Wang et. al, three types of geometric distortions are included in the camera model: radial distortion, decentering distortion, and thin prism distortion. I briefly review the basic definition and model for each distortion, for more detail see [Wang et al. 2008]. Radial distortion is mainly caused by flawed radial curvature of the lens elements. This type of distortion manifests itself as an inward or outward displacement of a given image point from its ideal location based on its distance from the optical axis. The contribution of radial distortion is given by: x,r = x(k1 2 + k2 4 ) (3.4) y,r = y (k1 2 + k2 4 ) where k1 , k2 are the coefficients of radial distortion and  = from the principal point on the image detector. 38 (3.5) x2 + y 2 is the radial distance

3.1 Camera Calibration Decentering distortion is caused by the misalignment of lens elements. While thin prism distortion arises from tilt of the optics with respect the image detector. Both of these types of distortions have both radial and tangential components. Traditionally, decentering distortion and thin prism distortion have been mathematically treated as independent. However, [Wang et al. 2008] states that they physically cannot be separated and introduces a new formulation that describes the combined effects of both decentering and prism distortion as a rotation of the image plane. This rotation is specified as a X-Y Euler angle set parameterized by two angles, 1 , and 2 . This new rotated image plane is labeled the 'detector' frame and denoted with the subscript 'D', see Fig. 3.2. The origin of this frame is defined by the location of the principal point.Following Wang's model, this rotation is given as:    1 0 0 cos 2 0 - sin 2  1 0 RDI = Rx (1 ) · Ry (2 ) =  0 cos 1 sin 1   0 (3.6) 0 - sin 1 cos 1 sin 2 0 cos 2 Typically, 1 and 2 are very small, which leads Wang to apply the small angle approximation, reducing Eq. (3.6) to:  1 0 -2 1 1  RDI (1 , 2 )   0 2 -1 1 

(3.7)

3.1.1.C

Forward Camera Model

Using Eqs. (3.2), (3.4), (3.5) and (3.7), the transformation of incoming star vectors to image plane centroid coordinates (forward model) is described by the following series of operations: 1. Given a star vector, aC , defined in the camera frame, the image plane coordinates of the star T centroid, g I = gx , gy I , are calculated using Eq. (3.2). 2. The ideal image plane position of the star centroid, g I , is then shifted to a distorted centroid, hI , on the ideal image plane due to the effects of radial distortion. Where hI is given by: hI = hx hy = (1 + k1 2 + k2 4 )
I

gx gy

(3.8)
I

3. To account for the effects of decentering and prism distortion, the distorted centroid, hI , is rotated into the detector frame, denoted by the subscript "D". This rotation, denoted as RDI , is specified by the coefficients of decentering and prism distortion, 1 and 2 . The location of hI in the detector frame is given by: 39

Chapter 3. Star Vector Error

    hx hx    hD = hy = RDI hI = RDI hy  hz D 0 I

(3.9)

^D , Y ^D axes) coordinates of the star 4. The detector array (defined by the detector frame X centroid, j D , are found by tracing a ray from the theoretical pinhole to point hD . This ray intersects the distorted detector array at point j D , which is calculated as: jD = jx jy =
D

f hx 1 hy,D - 2 hx,D + f hy

(3.10)
D

5. These detector array centroid coordinates are then converted into corresponding pixel coordinates using: kP = m n =
P

1 -jx mo + no p cs jy

(3.11)
D



heoretical  Pinhole

where p is the size of each pixel, cs is a scaling parameter used to represent non-symmetric pixel dimensions, and [mo , no ] is the location of the principal point with respect to the origin  of the detector array (pixel [0,0] on the image detector and illustrated by (o, m, n) as shown in Fig. 3.3). Example 
f f
Ray

The reference frames used in the camera model are summarized in Table 3.1.

x

eal Image  ne (actual)

3.1.1.D
x

Inverse Camera Model  ,
Principal Point

, 



The camera model presented in Section 3.1.1.C describes the transformation of star vectors Ideal Image  defined in the camera frame star centroids on the image detector. Typical star tracker Plane to (virtual) processing requires the inverse of this model, star centroids to star vectors.
  

,



Figure 3.3: Detector frame of reference.

40

3.1 Camera Calibration
Table 3.1: Definition of Camera Model Reference Frames

Frame Camera Image Plane Detector Pixel

Symbol C I D P

Origin Theoretical Lens Pinhole Principal Point Principal Point Pixel [0, 0]

^ X Negative Row Direction Negative Row Direction ^ XI rotated through RDI Row Direction

^ Y Column Direction Column Direction ^ YI rotated through RDI Column Direction

^ Z Optical Axis Optical Axis Complete RH vector triad Coincident ^D with Z

The formulation of Eq. (3.8), prevents the forward model from simply being inverted. This is due to the fact that Eq. (3.8) cannot be explicitly solved for [hx , hy ]I , given a distorted image plane coordinate [gx , gy ]I , due to the 2 and 4 terms. As a result, given a set of distorted image plane coordinates, g I , the undistorted version is typically found by solving a similar relation given by: gx gy hx hy

gI = where

= (1 + j1 2 + j2 4 )
I

(3.12)
I

=

2 h2 x,I + hy,I

(3.13)

and j1 , j2 are inverse radial distortion coefficients, different from k1 , k2 of Eq. (3.8). Beginning with star centroid coordinates on the image detector, this inverse model is described by the following steps: 1. Beginning with the location of the star centroid given in pixel-frame coordinates [m, n]P , as shown in Fig. 3.3, convert the row/column pixel frame centroid coordinates, kP , into detector frame coordinates, j D , defined with respect to the principal point. This transformation is given by: jD = p (m - mo ) p cs (n - no ) (3.14)

2. Using the detector frame coordinates of the star centroid, j D , calculate the contributions of geometric distortions by reapplying Eqs. (3.8) and (3.9) with different 1 , 2 , k1 , and k2 41

Chapter 3. Star Vector Error parameters. The parameters used for the inverse model are denoted as 1 , 2 , j1 , and j2 , respectively. The effects of decentering and prism distortions are removed using:     jx jx    j I = jy = RID jy  jz I 0 D where  1 0 -2 1 1   0 2 -1 1 

(3.15)

RID

(3.16)

3. The image plane coordinates of this centroid are then found by tracing a ray from the theoretical pinhole to point j I . This ray intersects the image plane at point hI , given by: hI = hx hy =
I

f jx hy,I 2 - hx,I 1 + f jy

(3.17)
I

4. The effects of radial distortion are then removed through Eq. (3.12). 5. Two points are now known for each star, the theoretical pinhole, and the image plane centroid coordinates, g I = [gx,I , gy,I , f ]T . Therefore the direction to each star is:   gx,I  aC = gy,I  f This is normalized to get: ^C = a aC ||aC || (3.19)

(3.18)

The required inverse model parameters are summarized in Table 3.2. The inverse and forward models are summarized by the flow diagrams shown in Fig. 3.4.

3.1.2

Calibration Procedure

Application of the both the forward and inverse camera models requires knowledge of key model parameters that describe the quality of the optics and internal sensor geometry. These are typically determined in a laboratory setting using some form of calibration procedure. Most calibration procedures involve imaging a calibration target, which consists of multiple identifiable features, and processing the resultant images. By analyzing the spacing between features, one typically can form estimates of the camera model parameters. Since a star 42

3.1 Camera Calibration
Table 3.2: Summary of Inverse Camera Model Parameters

Parameter Focal Distance

Symbol f

Comments Nominal distance between theoretical pinhole, and detector plane. Measured along the optical axis.

Radial Distortion Coefficients Decentering/Prism Distortion Angles Principal Point

j1 , j2 1 , 2 mo , no Rotation angles describing the orientation of the image detector. Row and column of optical axis intersection with image detector. Measured from pixel (0,0) Scaling factor accounting for non-symmetric pixel dimensions.

Y-axis Scale Factor

cs

tracker is designed to image sources that are effectively at infinite distances, the developed calibration procedure is based on repeatedly imaging a star source, rather than calibration target. This is achieved using a motorized gimbal to continuously change the orientation of the star tracker, effectively simulating incoming star vectors from various directions. First, this I briefly describe the lab setup used for the procedure. Then I introduce the model used to relate commanded gimbal positions to incoming star vectors. Following this I discuss the optimization routine used to form estimates of the model parameters. Lastly, I present results of this calibration and discuss how they are critical for star tracker processing and validation testing.

3.1.2.A

Lab Setup

The lab setup used for the calibration procedure consists of a 3-axis motorized gimbal, an autocollimator, and a collimated star source. The motorized gimbal accepts positioning T commands directly from the user in the form of a three element vector,  = 1 , 2 , 3 . The parameters (1 , 2 , 3 ) are the commanded angles for each joint of the motorized gimbal. Figure 3.5 shows an image of the motorized gimbal and labels the axes of rotation, Table 3.3 lists of key specifications for each joint of the gimbal. The ST-16 star tracker is mounted to an interface plate that is attached to the gimbal's 3-axis. The star source is a fiber-coupled halogen lamp that illuminates a pinhole and is collimated by a telescope. Collimation is achieved by passing the light through the telescope in a direction opposite to that of normal operation. The telescope is a Black Diamond ED80 with focal length of 600 mm and a diameter of 80 mm. The separate alignment procedure is used to measure the direction of the star source relative to the gimbal's 3-axis. 43

Chapter 3. Star Vector Error

FORWARD MODEL g h h j k

Radial distortion

Decentering/Prism  distortion

Map to detector  array

Convert to pixel  coordinates



g

h

j

j

k

Radial distortion

Map to image plane

Decentering/Prism  distortion

Convert to pixel  coordinates

 INVERSE MODEL
Figure 3.4: Flow diagrams of forward and inverse camera models. Table 3.3: Newport Motorized Gimbal Specifications

Part ID Repeatability Resolution 3.1.2.B Lab Model

1-Axis 2-Axis RVS240PP RV120PP 0.001 0.001  0.001 0.001

3-Axis RV80PP 0.002 0.0001

The lab model describes the relationship between commanded platform angles and camerareferenced star vectors. Similar to the camera model, this relationship is based on a set of parameters that describe the lab geometry. Before we take an in-depth look at the model, lets define 4 frames of reference that serve as stepping stones towards establishing the relationship between commanded gimbal angles and camera-referenced star vectors.

Lab Frame The first reference frame I define is the lab frame. This is a fixed frame of reference defined by the home position of the motorized gimbal. The origin is at the center ^ L , always points vertically upwards and the of rotation of the gimbal while the X-axis, X 44

3.1 Camera Calibration

ST16 Star Tracker

1Axis 2Axis 3Axis

Interface  Plate

Figure 3.5: Three-axis motorized gimbal.





 

 


Interface  Plate Serial  Communication  Connector
Serial  Communication  Connector




Interface  Plate

 

Center of  Rotation  Center of  (gimbal) Rotation 
(gimbal)

  




 






(a) (b)



Figure 3.6: Lab model reference frames.

45

Chapter 3. Star Vector Error ^ L , points along the homed platform 3-axis. The Y-axis, Y ^ L , completes the rightZ-axis, Z handed orthogonal coordinate system. End-Effector Frame This frame of reference is fixed to the axes of the motorized gimbal. ^ E, Y ^ E, Z ^ E ) axes are defined by the positions of the Joint-1, Joint-2, and Joint-3 axes. The (X The origin is defined as the center of rotation of the motorized gimbal. Mount Frame This frame is defined by external alignment features on the body of the star ^ M axis lies roughly in line with the serial connector used to communicate with tracker. The X ^ M axis is coincident with the normal to the back of the the star tracker, see Fig. 3.6b. The Z sensor, but defined in the opposite direction (roughly the direction the sensor faces). The ^ M axis completes the right-handed orthogonal coordinate system. The origin is defined as Y the center of rotation of the motorized gimbal. Camera Frame The last frame is defined by the location of the theoretical pinhole and the ^ C, Y ^ C axes are defined roughly orientation of the sensor optics and image detector. The (X in the direction of increasing rows and columns on the image detector, respectively. The ^ C axes is defined by the optical axis of the optics. The origin of this frame is defined by Z the location of the theoretical pinhole. This definition is consistent with the camera frame definition used in Section 3.1.1.D.

These frames are illustrated in Fig. 3.6. We now define the respective transformations that are required to convert commanded gimbal angles to camera-referenced star vectors. Lab-End Effector Transformation The rotation from the lab to end-effector reference frame follows a simple X-Y-Z Euler angle set, but the sense of the first and third rotations are reversed. Thus if i is the commanded angle to joint-i, then the transformation is:

CLE

 c2 c3 - c2 s 3 -s2 = Rx (-1 )Ry (2 )Rz (-3 ) =  -s1 s2 c3 + c1 s3 s1 s2 s3 + c1 c3 -s1 c2  c1 s2 c3 + s1 s3 -c1 s2 s3 + s1 c3 c1 c2



(3.20)

where ci = cos i , and likewise for si . The lamp position is expressed in arbitrary units of the form:

UL =

Ux Uy 1 46

T

(3.21)

3.1 Camera Calibration End Effector-Mount Transformation The rotation between the end-effector and mount frame describes a static rotational bias between the 3-axis of the motorized gimbal, and the sensor mounting plate. These rotations cannot be determined by the conventional sensor calibration procedure; they must be measured by a special facility alignment procedure. The choice of representation is arbitrary, so for simplicity we adopt another X-Y-Z rotation:  c2 c3 c2 s 3 -s2 = Rx (1 )Ry (2 )Rz (3 ) =  s1 s2 c3 - c1 s3 s1 s2 s3 + c1 c3 s1 c2  c1 s 2 c3 + s 1 s 3 c1 s 2 s 3 - s 1 c3 c1 c2 

CEM

(3.22)

Mount-Camera Transformation This transformation takes us from the physical mounting on the interface plate, into the camera frame. The origin of the camera frame is at the theoretical lens pinhole. Allowing an arbitrary tip-tilt-roll rotation between these frames, I express this rotation with another X-Y-Z Euler angle set parameterized by: 1 , 2 , 3 . This rotation is given as:  c2 c3 c2 s 3 -s2 = Rx (1 )Ry (2 )Rz (3 ) =  s1 s2 c3 - c1 s3 s1 s2 s3 + c1 c3 s1 c2  c1 s 2 c3 + s 1 s 3 c1 s 2 s 3 - s 1 c3 c1 c2 

CM C

(3.23)

No translation is necessary for the transformation from the mount frame into the camera frame. This is due to the fact that the light source being imaged is a wide collimated beam. Motion, both along the axis of the light source, and perpendicular to the axis, will have no effect, provided the lens aperture stays within the beam diameter during the calibration procedure. Using Eqs. (3.20) to (3.23), the direction of the star source in the detector frame can be expressed as:

U C = CCM CM E CEL U L

(3.24)

T T where CCM = CT M C , CM E = CEM , and CEL = CLE . The parameters associated with the lab model are summarized in Table 3.4.

3.1.2.C

Parameter Estimation

The inverse camera model described in Section 3.1.1.D describes the conversion of image detector star coordinates into camera-referenced star vectors. Star vectors generated from 47

Chapter 3. Star Vector Error
Table 3.4: Summary of Lab Model Parameters

Parameter Joint Angles Mount Rotations Camera Rotations

Symbol 1 , 2 , 3 1 , 2 , 3 1 , 2 , 3

Comments Joint angles as commanded to the motion platform Angles between joint-3 and mounting plate. Must be measured by special facility alignment. Angles between the mount and sensor optics

the camera model are labeled as sensor -based star vectors and denoted with the subscript s. Similarly, the lab model defined in Section 3.1.2.B also describes star vectors, but this set is based on the commanded gimbal angles. These star vectors are labeled as lab -based star vectors and denoted with the subscript l. Both of these models depend on a number of parameters that define the internal geometry of the sensor, the quality of the optics, and the geometry of the lab setup. To determine these parameters, an optimization routine was developed that utilizes the discrepancy between sensor-based star vectors and lab-based star vectors to guide a bounded nonlinear minimization. The motorized gimbal is used to conduct a Ncal -point survey of the sensor FOV. This survey is arranged as a grid of equally spaced points on the image detector. At each orientation, the star source is imaged and the commanded gimbal angles and detected star centroids are recorded. Employing both the inverse camera model, and the lab model, this data is converted into a set of Ncal sensor-based star vectors, as,C , and Ncal model-based star vectors, al,C , both expressed in the camera frame. An error function, Qc , is defined as the angular MSE between corresponding sets of star vectors. This is expressed as:
Ncal

1 Qc = Ncal

^ l,i )2 arccos(^ aT s,i · a
i=1

(3.25)

where as,i and al,i represent the sensor-based and lab-based star vector for the i-th point of the survey. This calibration procedure is summarized in the flow diagram shown Fig. 3.7. Using Eq. (3.25) as the cost function, I utilize MATLAB to run a 3-step bounded nonlinear minimization to determine the desired lab and camera model parameters. The stepped minimization is used to improve the repeatability of the calibration in terms of specific parameters values. The starting values, as well as the upper and lower bounds for each parameter are summarized in Table 3.5. This 3-step minimization is described by the following individual minimizations: 1. Using all 300 points, the first minimization entails only a subset of the camera model parameters (f, mo , no ) and the camera-rotations (1 , 2 , 3 ) from the lab model. The starting values for each parameters are given in Table 3.5. 48

3.1 Camera Calibration
Table 3.5: Summary of Calibration Starting Values

Parameter Camera Rotations Focal Length Y-axis scale factor Principal Point Radial Distortion Decentering/Prism Distortion

Symbol 1 , 2 , 3 f cs mo , no j1 , j2 1 , 2

Unit radians m N/A pixels N/A radians

Initial Value 0, 0, 0 16 × 10- 3 1 972, 1296 0, 0 0, 0

Lower Bound  - 4 , - , - 4 4 15 × 10- 3 0.95 778, 1036 -108 , -104 -0.175, -0.175

Upper Bound    , , 4 4 4 17 × 10- 3 1.05 1166, 1555 108 , 104 0.175, 0.175

Focal Length Columnscaling ,  ,  ,  Radial Distortion Decentering/Prism  Distortion Principal Point

Camera Model
Sensorbased  star vectors

ImagePlane  coordinates of  detected stars

Vector Difference  (angle)
Labbased  star vectors

Calculate  Error

Nonlinear  Minimization

Parameter  Estimates

Commanded  Platform Angles Light Source  Direction Interface Plate  Mount Angles

, 

, 

Camera Rotation

Lab Model

Figure 3.7: Layout of camera calibration procedure.

2. Following this, a second minimization is used to determine the camera model distortion parameters (j1 , j2 , 1 , 2 ). 3. Lastly, a full re-optimization of all camera model and lab model parameters is run, using the results of the previous minimizations as their initial guesses.

3.1.2.D

Results

Using a Ncal = 300 point survey, typical residual errors between the sensor-based and labbased star vectors are approximately 3.5 × 10-5 radians ( 2.0 × 10-3 degrees). This is equivalent to approximately 0.2 pixels of error on the image detector. A plot of the residual error between the lab-based and camera-based star vectors is shown in Fig. 3.8. The residual 49

Chapter 3. Star Vector Error vectors are drawn from the camera-based star vectors toward to the lab-based star vectors, given the fitted calibration parameters and the commanded joint angles. Although minor, Fig. 3.8 shows structure in the residual errors of the optimization process. This structure indicates that at least some un-modeled parameters exist that have an impact on the local position of a star vector. Future work is required to understand this residual structure which is suspected to come from the accuracy of the motorized gimbal. The mean error across the detector, 0.2 pixels, is currently sufficient for the target performance parameters of the ST-16. The total procedure, including survey acquisition and optimization, requires approximately 30 minutes to complete.

3.1.2.E

Validation Procedure

In addition to using the camera calibration procedure to initially calibrate ST-16 flight units following manufacture, this procedure is utilized to validate sensor performance following environmental testing. Typical environmental tests for ST-16 flight units include vibration testing and thermal cycling. Following each of these tests, the performance of each flight unit is validated by conducting another 300-point survey and assessing the residuals based on the set of model parameters determined in the initial calibration. Although this doesn't represent a novel contribution to the field, the validation procedure is critical to the preparation of ST-16 flight units.

3.1.3

Summary and Future Work

The accuracy performance of a star tracker is directly dependent on the accuracy with which imaged stars can be converted to incoming star vectors. This transformation is based on knowledge of various intrinsic sensor parameters which cannot be practically measured individually. I have developed a lab-based calibration procedure that determines these parameters using a motorized gimbal and collimated star source.
Table 3.6: Calibrated Model Parameters - Typical Case

Parameter Camera Rotations Focal Length Y-axis scale factor Principal Point Radial Distortion Decentering/Prism Distortion

Symbol 1 , 2 , 3 f cs [mo , no ] j1 , j2 1 , 2

Unit radians m N/A pixels N/A radians

Calibrated Value [-1.52, 2.03, -1.53] × 10-3 15.9959 × 10- 3 0.9998 1100.5, 1207.3 -1.416 × 107 , -0.108 × 103 [1.94, -6.61] × 10-3

50

3.1 Camera Calibration

0.1

Modelled Measured

0.05 X-Component (Column-wise)

0

-0.05

-0.1

-0.1

-0.05

0 0.05 Y-component (Row-wise)

0.1

0.15

Figure 3.8: Camera calibration residuals. Vectors show error from sensor-based star vectors to lab-based star vectors.

The procedure is based on analytical models that describe i) the transformation between the star tracker image detector and the sensor optics, and ii) the location of the simulated star source with respect to the star tracker, based on the commanded gimbal orientation. I estimate the sensor geometry through a minimization guided by the error between the modeled star position, based on the known orientation of the motorized gimbal, and the measured star position from the image detector. The residual error in star vector formulation is approximately 3.5 × 10-5 radians which equates to approximately 0.2 pixels on the image detector. Although this is sufficient for current performance targets of the ST-16 star tracker, this process must be refined to achieve accuracy performance on the order of 1 arcsecond. Future work is required to understand the limiting factors in the calibration residuals. The accuracy of the gimbal is suspected to be the dominant source of error. The orthogonality of the axes needs to be verified, and the effect of wobble about each joint needs to be examined. Additional improvements may lie in more complex centroiding routines that rely on models of the PSF shape.

51

Chapter 3. Star Vector Error

3.2

ERS Compensation

Electronic Rolling Shutters (ERSs), common in many modern imaging detectors, present challenges for use in star trackers. These detectors suffer from geometric distortions if images are taken during satellite motion. This section presents an analytical model of the ERS distortion tailored to the characteristics of star-field images. This model is used to develop a series of algorithmic corrections that estimate spacecraft angular velocity from sequential image pairs and remove the ERS effects from measured star positions. These routines are implemented on the ST-16 star tracker and verified using simulation and laboratory testing. Simulations show that the residual angular velocity measurement errors are dominated by centroid noise ( 0.007 /s, 1 -  ). The simulations are also supported by laboratory testing, which shows that the developed ERS corrections are able to preserve accurate scene geometry with body rates of up to 3 /s.

3.2.1

Introduction

Many low-cost COTS detectors make use of a readout technology known as a ERS. These systems rarely have mechanical shutters, so the detector exposure is controlled electrically. To avoid the need to sample all of the image pixels at once, each row of the detector is released from reset at a slightly different time. The total exposure time for each row remains constant, but the rows are not exposed simultaneously -- each row is offset in time by a small amount. If the camera (or scene) is not moving during the exposure, the image from an ERS-equipped detector is identical to an ideal imaging system. However, any motion in the camera or scene introduces geometric distortions in the resulting image. This is in addition to any blurring effects due to the motion. Previous work for ERS modeling and correction has been mainly focused on correcting entire images for use in robotic vision algorithms [Liang et al. 2005, Liang et al. 2008, Ait-Aider et al. 2007]. These are generally dense scenes where feature identification and correspondence can be challenging. In addition, these problems generally need to address local velocity variations that stem from moving objects in the image [Nicklin et al. 2006]. In comparison, with the exception of Earth or Moon incursions, star tracker images can be modeled as blurred point sources against a dark background, all of which are effectively at an infinite distance. This greatly simplifies the task of feature detection, correspondence, and correction. Furthermore, the range of inquiry can be confined to distortions resulting from body-frame rotational motion; translations are not significant. These simplifications allow for the utilization of relatively simple models to analyze and correct for the effects of the ERS. The research presented in this section represents a combination of collaborative work between myself and my supervisor, Dr. John Enright, and my own personal contributions. This research can be broken into five main segments, shown in Fig. 3.9. The first three of these 52

3.2 ERS Compensation represent developed routines that model the effects of ERS on star tracker performance, estimate the angular rate of the sensor using a pair of images, and heuristically match stars between this pair of images. The latter two segments represent validation of the developed correction routines. Segments 1, 2, and 4 were done collaboratively between John Enright and I. Segment 3, the matching routine, represents the work of John Enright and is briefly mentioned for context. The last segment that involved the integrated lab testing of the developed routines represent solely my own work. This authorship is summarized in Fig. 3.9.

1 2 3 4 5

Analytical Modeling of ERS Effects Rate Estimation Routine Matching Routine Simulation Tests Integrated Lab Tests
Personal Contributions Collaborative Work From Literature / Other Authors

Figure 3.9: Summary of contributions for ERS compensation.
1 2 Development of Analytical  Shape Model for PSF at Rate Simulation Tests to Assess  Detection Performance

3.2.2

Framework for ERS Corrections
3 Lab Tests to Verify Simulation  Results
Personal Contributions Collaborative Work

4 Examining  Literature  Dynamic  Availability The proposed sensor processing scheme corrects for From ERS effects using a pair of sensor images. The algorithm requires little persistent state information, has modest computational requirements, and does not rely on external sensors such as rate gyros. Although these routines were developed for a specific sensor (i.e., the Sinclair Interplanetary ST-16), adapting this algorithm to other hardware should be straightforward. This subsection reviews the steps involved in typical star tracker processing and presents detailed models of the effects of the ERS on the sensor's measurements. These models help us understand the ERS distortions and serve as a framework for the developed corrections. The algorithms detailed in this study form the basis of the processing routines used onboard the Sinclair Interplanetary ST-16 star tracker.

The developed approach assumes that two images, taken in close succession are available. These images are denoted as Image-0 and Image-1, respectively. It is assumed that raw image processing corrects for the dark-levels and extracts likely star centroids from both images, but does not apply any geometric rectification. The proposed processing scheme then begins by making two passes through the data. In the first pass, the body rates of the sensor are estimated in the camera frame of reference, denoted as  C . Then in the second pass, local corrections are made to centroid locations and the resulting star vectors. This processing sequence is summarized in Fig. 3.10. The remainder of this subsection elaborates on each of these processing steps. 53

Chapter 3. Star Vector Error
Raw  Centroids Image Pair Raw Star  Vectors

Star  Detection

Camera  Model

Rate  Estimation

Angular  Velocity

Centroid  Correction
Corrected  Centroids

Camera  Model

Vector  Correction

EpochCorrected  Star Vectors

CentroidCorrected  Star Vectors

Figure 3.10: The ERS compensation processing sequence.

3.2.2.A

Conventional Image Processing

Although the developed ERS corrections operate independently from conventional star tracker processing, they do rely on a number of assumptions concerning the outputs of these processing steps. In particular, the developed corrections rely on typical star tracker routines to extract promising stars from the raw detector image (i.e., Star Detection), and secondary routines to convert centroid coordinates into detector-frame star vectors (i.e., the Camera Model). The latter routines can involve corrections for optical aberrations and are described in detail in Section 3.1. Star centroid measurement relies, at least implicitly, on the PSFs that are expected to be found in detector images. Although the spacecraft motion is continuous and each row is offset in time from the next, the geometric distortions caused by the ERS are most significant when considering the geometry between stars. In the neighborhood of a single star they are less important. Consider a moving star tracker without an ERS. Over the duration of an exposure, the instantaneous star centroid will trace a path on the detector from di to df . This will create a streak in the star tracker image as this path is convolved with the PSF of the sensor. Figure 3.11 shows an actual star image taken using a ST-16 star tracker and a 3-axis motorized gimbal slewing at 2  /s. These images were taken using the gimbal system described in Section 3.1.2.A. We assume that we known enough about the shape of the nominal PSF to estimate the midpoint of this track. If we also assume that centroid track is linear, then the midway point is the average of the endpoints. df + di 2

dt =

(3.26)

Furthermore, for symmetric PSFs, this midpoint can be calculated with a simple firstmoment centroid of the image intensity as given in Eq. (2.1). This summation need only be evaluated in the neighborhood of a star, not the whole image. In the remainder of this 54

3.2 ERS Compensation

1600 5 1400 10 1200 1000 15 800 20 600 400 25 200 30 5 10 15 20 25 30 35 40 45 50 55 0

Figure 3.11: Star image showing blurring due to sensor motion.

section, detector plane coordinates will refer almost exclusively to star centroids. For notational simplicity, henceforth the notation (m, n) refers to the row/column position of a star centroid as defined in the pixel frame described in Fig. 3.3. Once the centroid location of a star is known, a calibrated camera model, fc , as described in Section 3.1.1 by Eqs. (3.14) to (3.19), is used to transform the centroid coordinates in the pixel frame, kP , into a corresponding direction vector, ac , expressed in the camera frame, c. E.g..,

ai,C = fc (kP [mi , ni ])

(3.27)

where ai,C is the direction vector of the i-th star detected in image-0, and kP (mi , ni ) are the associated centroid coordinates in the pixel frame, expressed as row/column coordinates in pixels.

3.2.2.B

Vector Correction

Each row in an ERS-equipped detector is exposed at a slightly different time. The primary effect of this process is to introduce a row-dependent rotation between star vectors in an image. Although this is the final correction in the developed processing sequence, understanding this phenomena and its correction is key to understanding the rest of the developed ERS-compensation routine. Given the exposure duration, te , and the row-to-row time offset, trow (given in Table 1.1), the midpoint of the exposure of row m occurs at time: 55

Chapter 3. Star Vector Error

tm =

te + mtrow 2

m  0 . . . Nm - 1

(3.28)

where Nm is the number of rows on the image detector. For convenience, the constant term from Eq. (3.28) can be dropped by defining the epoch of the image (i.e., t = 0) to be the midpoint of the exposure of the first image row, specified by m = 0. For the remainder of this chapter, Co is used to denote the camera reference frame at epoch of image-0. When the camera is in motion with angular rate  C , the body frame is constantly rotating. Applying the camera model to two star centroids, (m1 , n1 ) and (m2 , n2 ), obtained from different areas of the image, yields star vectors in different reference frames: a1,C1 = fc (kP [m1 , n2 ]) a2,C2 = fc (kP [m2 , n2 ])

(3.29)

Provided the angular rate is not too high, the rotation between these two frames can be approximated as an infinitesimal rotation  × , given by: CC1 C2 = I +  ×

(3.30)

Over the relatively short duration of the exposure, it is assumed that  C remains constant. Using the observation that an angular velocity vector represents an instantaneous axis of rotation, and substituting the time equations from Eq. (3.28), we get: CC1 C2 = I + trow (m2 - m1 )  × C

(3.31)

If we let Co define the instantaneous camera frame at the epoch (e.g., t = 0) of image-0, then the ERS correction rotation for a given centroid location is: CCo Ci = I + trow mi  × C

(3.32)

where Co is refers to image-0 epoch frame, and Ci refers to an instantaneous image-0 camera frame. Therefore, as long the rotation rate  C is known, the ERS-corrected star-vectors at the epoch of image-0 can be calculated using: ai,Co = I + trow mi  × C fc (kP [mi , ni ])

(3.33)

The notation for star vectors, centroid coordinates, and image frames for the developed ERS routines is summarized in Table 3.7. 56

3.2 ERS Compensation
Table 3.7: Motion Estimation Notations

Quantity Row Column Star Vector Epoch Frame Star Frame 3.2.2.C Rate Estimation

Image-0 mi ni ai Co Ci

Image-1 mj nj bj Eo Ej

Applying the above vector correction relies on knowledge of the angular velocity of the star tracker. If external sensors are available, the angular velocity may be able to be measured directly. However, it was our desire for the developed ERS compensation routine not to have this external dependency. Estimating motion by tracking features between image is a staple technique in computer vision. In contrast to general computer vision problems, star tracker scenes are relatively simple. This subsection presents a simplified algorithm for estimating body rates by tracking stars between a sequential pair of images. This algorithm requires association of stars between images, but does not require an absolute match to the onboard star catalog. The corrections for stars in Image-0 are given by the rotation matrices calculated from Eq. (3.32). Similar corrections can be written for stars in Image-1:

CEo Ej = I + trow mj  × C bj,Eo = CEo Ej bj,Ej

(3.34) (3.35)

where, bj,Ej is the direction vector of the j-th star found in image-1, expressed in the j-th instantaneous camera frame, bj,Eo is the direction vector of the j-th star found in image-1, expressed in the image-1 epoch frame defined as the instantaneous camera frame half way through the exposure of row 1, image-1. This can be written in terms of the inter-exposure time (known from ST-16 processing routines), tx , as:

CCo Eo = I + tx  × C

(3.36)

If the measurements were perfect, the star vectors from both images could be equated if rotated into a common frame, Co :

× I + trow mi  × C ai,Ci = I + tx  C

I + trow mj  × C bj,Ej

(3.37)

57

Chapter 3. Star Vector Error Discarding higher order rotational terms, and simplifying gives: ai,Ci = I - trow mi  × I + tx  × I + trow mj  × C C C bj,Ej × ai,Ci  I + {trow (mj - mi ) + tx }  C bj,Ej = I + ij  × C bj,Ej

(3.38)

where ij = trow (mj - mi ) + tx . The angular velocity of the star tracker can be estimated by using the observed star vectors ai,Co and bj,Eo . Rearranging this relationship into the form of a linear least-squares problem in  C gives:

I + ij  × C bj,Ej = ai,Ci ij  × C bj,Ej = ai,Ci - bj,Ej × -ij bj,Ej  C = ai,Ci - bj,Ej This equation can be written as:

(3.39)

Aij  C = dij where

(3.40)

Aij = - (trow (mj - mi ) + tx ) b× j,Ej and

(3.41)

dij = ai,Ci - bj,Ej

(3.42)

Concatenating the matrices form from each pair of vectors results in the linear least squares system:

A C = d which has the solution:
-1

(3.43)

 C = AT A 58

AT d

(3.44)

3.2 ERS Compensation This can be computed efficiently in block form:
-1

C =

AT ij Aij

AT ij dij

(3.45)

where the summations are evaluated over the matched pairs of vectors. The RMS error in the fit is then: A C - d  NM

 = where NM is the number of matched stars.

(3.46)

The above derivation presupposes that the mapping M between stars in the two exposures, i.e., M : i  j , is known. This is realized using a heuristic approach to mapping between two images described in detail in [Enright & Dzamba 2012].

3.2.2.D

Centroid Correction

The models introduced in the preceding subsections describe the macro-effect of the ERS on inter-star geometry, and derive a rate estimation algorithm that can operate using ERSskewed star vectors. However, because the ERS time offsets apply to each sequential row, measurable effects can be observed during the exposure of individual stars. A model for the displacement of a star centroid on the image detector over the course of an image exposure, including the effects of ERS, is now developed. This displacement is denoted as the track, and is represented with the symbol d . Let p denote the star vector of any arbitrary star at the beginning of an exposure. Let q denote the direction vector to the same star at the end of the exposure. Both vectors are expressed in instantaneous camera frames. Each of these vectors are expressed in terms of their components, e.g.:  px p =  py  pz 

(3.47)

Using a pinhole optics model, the focal-plane position of the star centroid corresponding to the star vector, p, is given as: f pz 59 px py

dp =

(3.48)

Chapter 3. Star Vector Error A similar expression holds for dq . If the rotation over the course of an exposure is modeled as an infinitesimal rotation caused by the angular velocity, then:

q = Cp where

(3.49)

C = I - t  × C

(3.50)

and t is time required for the full exposure of the star (greater than te due to the effects of ERS, full definition given by Eq. (3.57)). The displacement over the star exposure can then be found from:

q = p +  p = I - t × p and thus  z py - y pz  x pz - z px   p = -t  × C p = t y px - x py 

(3.51)

(3.52)

Most star trackers have fairly narrow FOVs -- the ST-16 has a minor-axis FOV of 7.5 -- thus for moderate rotation rates we can assume that:

pz  q z

(3.53)

Hence, the displacement of the centroid in the focal plane over the course of the PSF exposure is: f t pz z py - y pz x pz - z px

d =

(3.54)

We can divide by the pixel size, p , to get the track displacement in pixels f t p pz z py - y pz x pz - z px 60

d =

(3.55)

3.2 ERS Compensation The total extent of the blurred PSF from a single star depends on the time duration t that appears in this expression. This time-span begins when the first pixel in an imaged star begins its exposure and ends, when the last pixel completes. Due to the row-to-row time offsets caused by the ERS, this depends in part on the motion in the row-wise direction. The total height of the PSF image, in terms of number of rows, is given by H . H can be related to motion of the centroid by using the track displacement in the x-direction from Eq. (3.55). This is expressed as:

dx = H - 2p

(3.56)

where p is the radius of the PSF in pixels. The total time required for this exposure is:

t = (H - 1) trow + te

(3.57)

Equating Eq. (3.56) to the track displacement in the x-direction described by Eq. (3.55), and substituting in Eq. (3.57) gives f ((H - 1) trow + te ) (z py - y pz ) = (H - 2p ) p pz Solving for H gives trow - te - trow -
2p p pz f (z py -y pz ) p pz f (z py -y pz )

(3.58)

H=

(3.59)

This expression is valid as long as the terms involving the  -components are non-zero (in the zero-motion case, Eq. (3.58) gives the trivial result H = 2p ). It is assumed that centroid measurement algorithms identify the point half-way along the centroid track on the focal plane, i.e., displaced d /2 from the initial centroid position dp . Thus, for a given  C Eq. (3.59), Eq. (3.57), and Eq. (3.55) can be used to predict where the measured centroid will lie. Moreover, if row readout time, trow , is set to 0, the same set of expressions can be used to predict performance of an ideal sensor without an ERS. The change in centroid location, due to the ERS effect is then: 1 f (H - 1) trow d - d |trow =0 = 2 2p pz z py - y pz x pz - z px

ders =

(3.60)

and thus the ERS-corrected centroids can be found from: 61

Chapter 3. Star Vector Error

mi ni

=

mi ni

- ders

(3.61)

Two effects are potentially important when considering how the ERS affects star tracker performance. First, the sensor motion can cause a bulk centroid offset across the whole detector. If uncorrected, this will introduce inaccuracy in the final attitude estimate from the sensor, but because the relative geometry between stars is not affected, the sensor's ability to match stars is not impaired. However, any change in the relative displacement, ders , from one part of the detector to another will distort the relative geometry of the detected stars. This latter effect will interfere with the star tracker's ability to match stars. Figure 3.13 shows the magnitude of the centroid correction for different types of rotations. This value is insensitive to the position in the FOV for rotations about the x- and y -axes. In fact, this can be seen from Eq. (3.59) and Eq. (3.60). For rotations about the boresight (i.e., z -axis) the magnitude of the correction is roughly proportional to the distance from the boresight axis. In this case, we assume a star at the minor edge of the FOV, x , where the ERS effect will be largest, see Fig. 3.12. The corrections are largest for y -axis rotations. This motion creates the most coupling between the ERS effects and the sensor motion (and also leads to the asymmetry about zero rotational speed). Motion about the x-axis creates a moderate, symmetric correction.

 Majoraxis  FOV

 Minoraxis  FOV

Theoretical  Pinhole

Image  Detector  
Figure 3.12: Field of view schematic.

62

3.2 ERS Compensation Although it is difficult to see at this scale, the correction resulting from z -axis rotations is asymmetric and also depends on star location in the FOV. This effect of z -axis rotations are examined closer in Fig. 3.14. The figure shows the magnitude of the maximum centroid displacement relative to any other point on the detector. ay , ax denote the vector components of the star vector aC . The figure illustrates the scale of this displacement, typically 0.08-0.15 pixels, as well as the the asymmetry of the ERS effect. This asymmetry is caused by coupling between z -axis rotations and the ERS displacement: for positive ay , the motion and the row-readout move in opposite directions; for negative ay , the effect is reversed. For the ST-16 sensors, optical calibration gives a mean residual error equivalent to approximately 0.2 pixels, so uncorrected centroid displacement will have a noticeable effect on the overall accuracy of star vector determination.

3.2.3

Results

In the preceding section, I presented a series of algorithms designed to compensate for ERS effects in star tracker images and permit effective star tracking. For these techniques to be useful, the rate estimates derived from ERS-skewed star images must be accurate, and the modeled corrections must be effective in undoing the ERS distortions in the star vector measurements. This problem of algorithm verification is approached using a combination of simulation and laboratory testing.
0.9 0.8 0.7 0.6 ders (pixels) 0.5 0.4 0.3 0.2 0.1 0 -3

X-rotation Y-rotation Z-rotation

-2

-1

0  (deg/s)

1

2

3

Figure 3.13: Variation of ERS correction with angular velocity.

63

Chapter 3. Star Vector Error
x 10 -2 0.14 -1.5 0.13
-3

-1

ax (row direction)

-0.5

0.12

0 0.11 0.5 0.1

1

1.5

0.09

2 -2 -1.5 -1 -0.5 0 0.5 1 1.5 2 x 10
-3

ay (column direction)

Figure 3.14: Relative centroid displacements under z -axis motion.

3.2.3.A

Simulations

Simulations allow rapid evaluation of the ERS compensation routines using realistic distributions of stars. Scenes can easily be generated for arbitrary sensor orientations, optical configurations, and body rates. The primary objective of these simulations was to evaluate the accuracy of the rate estimation algorithm. Each scene for the simulation is generated based on the optical parameters of the ST-16 star tracker, specifically the ST-16 FOV (15 × 21 ). The source catalog for this simulation is the Yale Bright Star Catalog [Hoffleit & Warren Jr 1991]. The starting sensor orientation was randomly generated for each scene, parameterized by right ascension, declination and boresight roll. Each component of angular velocity is independent and uniformly distributed on -2  i < 2 /s. Sensor orientation is propagated numerically between exposures, assuming constant angular velocity. For each exposure the simulation calculates the stars in view, and their true directions relative to the detector frame of reference. ERS effects are then applied and the camera model (Section 3.1.1) is used to calculate the detector locations of the star centroids. The simulation uses tx = 0.1 and trow = 43 × 10-6 s. Detection uncertainty is introduced by adding Gaussian noise of 0.2 pixels to both components of the star centroids. This noise represents the typical amount of centroid uncertainty that is observed following the camera calibration procedure discussed in Section 3.1.2. Blurred star images could be simulated at the pixel level, however, this extra step requires 64

Max. Deviation (pix)

3.2 ERS Compensation significantly more time to construct each scene. It was judged that the fidelity of noisy centroid detection was sufficient for this study. Once the centroid locations are chosen, the brightest 10 stars were selected from each image and the developed ERS compensation routines were applied. The ST-16 applies a similar selection heuristic to the stars detected in each image. The angular velocity statistics for a trial involving 104 random scenes are shown in Table 3.8. The no-motion statistics are drawn from a smaller trial of 103 scenes with zero angular velocity. Because the mean errors were very small -- suggesting zero overall bias in the  estimates -- only the standard deviations are reproduced. Errors in the zero-motion case are dominated by the centroid noise. Larger errors observed for z are expected as star tracker roll estimates are very sensitive to small centroid displacements. The motion trials show modest increases in the z and x components, but a relatively large jump in y . Closer examination of the angular velocity estimates revealed a cross-axis coupling between the y and z components, see (Fig. 3.15). Large roll rates introduce a variable bias into the estimates of y . This effect is not apparent in the other axes. We suspect that the cross-axis bias is a shortcoming of the linearized rate estimator derived in Section 3.2.2.C. Although these rate estimates are sufficiently accurate to compute the necessary ERS corrections, they are not particularly good as standalone rate measurements. Additional tests showed that a relatively simple fix could be used to eliminate most of the bias effect. This fix is described by the following operations:

1. Calculate corrected star vectors for each of the paired images using the raw rate estimate. 2. Find the rotation between exposures using an optimal vector rotation estimator (e.g., qMethod [Keat 1977], QUEST [Shuster & Oh 1981], ESOQ2 [Mortari 2000], etc) 3. Compute a revised estimate of  from the exact frame-to-frame motion.

Table 3.8 and Fig. 3.15 show the effect of this secondary correction applied to the simulated test cases. Error statistics are virtually identical to the zero-motion case and the coupling between axes is absent. Although this step requires some additional processing, it is felt that the improvements in accuracy are enough to justify the additional computational cost. The ST-16 currently uses ESOQ2 to calculate the inertial attitude solutions, so an additional execution of the algorithm is unlikely to require more than a few milliseconds to complete.
Table 3.8: Angular Velocity Determination

Component  (No motion) deg/s  (With Motion) deg/s  (Motion x 0.0074 0.0083 y 0.0075 0.0245 z 0.0536 0.0597 65

+ ESOQ2 ) deg/s 0.0072 0.0075 0.0551

Chapter 3. Star Vector Error
0.08 Raw Estimate ESOQ Estimate 0.06

0.04

0.02 y (deg/s)

0

-0.02

-0.04

-0.06

-0.08 -2

-1.5

-1

-0.5

0 z (deg/s)

0.5

1

1.5

2

Figure 3.15: Cross-axis estimator bias.

3.2.3.B

Laboratory Tests

As an extension to the simulation tests described in the previous section, the developed ERS corrections were tested in the laboratory using an engineering model ST-16 star tracker and a motorized three-axis gimbal. Although these tests cannot reproduce arbitrary star scenes, laboratory trials do allow for testing of the embedded, on-line correction routines, during real motion. The primary objectives of these laboratory trials were to verify the modeled corrections were effective in reducing ERS distortions in the star vector measurements, and to examine the effectiveness of the ESOQ2 rate estimator in removing the cross-axis bias. The setup of these tests consisted of the sensor attached to a motorized, three-axis gimbal, viewing a star scene comprised of three point sources. The geometry of this three-star pattern was parameterized by a set of three arc lengths: Side-a, Side-b, and Side-c, which were measured through a separate set of static trials. Each test consisted of single-axis rotations, with rates of -3 . . . + 3 /s, applied separately to both the x- and y -axes. The trials for each rate consisted of 50 separate measurement of the star pattern geometry. These measurements were then averaged to minimize the effects of random sensor noise and gimbal inaccuracy, and then compared against the geometry of the three-star pattern in static conditions. The experiment was repeated both with and without the ERS corrections. Figure 3.16 and Fig. 3.17 show errors in the arc length measurements, for both x and y motion, with and without the developed ERS corrections. It can be seen that in both 66

3.2 ERS Compensation trials, the ERS corrections reduce the arc length error to approximately the same level as the variability seen during the zero motion trials. The thick dotted line in Fig. 3.16 and Fig. 3.17 represents the 1 variability of these zero motion tests. From Fig. 3.16, it can be seen that for a pure y spin, ERS effects significantly degrade the arc length measurements for Side-b and Side-c whereas Side-a is mostly unaffected. This is due to the orientation of the star pattern relative to the body motion. The endpoints of Side-a span relatively few rows, and therefore see little motion during the ERS exposure shift. In most of the trials the arc-length error is less than the standard deviation of the stationary case. Figure 3.17 shows the effect of x motion. The qualitative results are similar to the first case -- the ERS corrections minimize errors in Side-b and Side-c, while Side-a sees little error at all -- but the cause of this behavior is different. Side-a spans the largest
x 10
-4

8 7 Absolute Arc Length Error (deg) 6 5 4 3 2 1 0

6
ERS comp. = On ERS comp. = Off  zero-motion

x 10

-3

ERS comp. = On ERS comp. = Off  zero-motion

5 Absolute Arc Length Error (deg) 0 0.5 1 1.5 2 Commanded platform rate (deg/s) 2.5 3

4

3

2

1

0

0

0.5

1 1.5 2 Commanded platform rate (deg/s)

2.5

3

(a) Side-a
6 x 10
-3

(b) Side-b

ERS comp. = On ERS comp. = Off  zero-motion

5 Absolute Arc Length Error (deg)

4
1050 1040 Platform Motion

3
Detector Rows (pix.)

1030 1020 1010 1000 990 980 970 960 Row Readout Direction 1220 1240 1260

a

2

b

c

1

0

0

0.5

1 1.5 2 Commanded platform rate (deg/s)

2.5

3

1200

1280 1300 1320 Detector Columns (pix.)

1340

1360

1380

1400

(c) Side-c

(d) Star Pattern Layout

Figure 3.16: Errors in star pattern geometry for column-wise motion (y ).

67

Chapter 3. Star Vector Error
8 7 Absolute Arc Length Error (deg) 6 5 4 3 2 1 0 0 x 10
-4

6
ERS comp. = On ERS comp. = Off  zero-motion

x 10

-3

ERS comp. = On ERS comp. = Off  zero-motion

5 Absolute Arc Length Error (deg) 0 0.5 1 1.5 2 Commanded platform rate (deg/s) 2.5 3

4

3

2

1

0

0.5

1 1.5 2 Commanded platform rate (deg/s)

2.5

3

(a) Side-a
980

(b) Side-b

6

x 10

-3
970 Platform Motion

ERS comp. = On ERS comp. = Off  zero-motion

960

5 Absolute Arc Length Error (deg)
950

b
Detector Rows (pix.)

4

940

a

3

930

2
920

c
1
910 Row Readout Direction

0

0

0.5

1 1.5 2 Commanded platform rate (deg/s)

2.5

3

900

1380

1390

1400

1410

1420 1430 1440 Detector Columns (pix.)

1450

1460

1470

(c) Side-c

(d) Star Pattern Layout

Figure 3.17: Errors in star pattern geometry for row-wise motion (x ).

number of image rows, but it sees little change because most of the endpoint displacement is in the column direction. These tests were repeated under a z -axis rotation in order to confirm the presence of the rate bias in y and verify that the ESOQ2 rate estimates remove this secondary effect. To make the cross-axis effect more pronounced a primary rotation about z was combined with a small amount of cross-axis motion. Figure 3.18 shows laboratory measurements of this bias using both the raw and ESOQ2 estimated rates. Although the ESOQ2 correction greatly reduces the magnitude of the bias, some residual rate dependent bias is still visible. It is believed that this remaining bias is caused by synchronization uncertainty between the platform motion and the star tracker measurements. This premise is based on the structure 68

3.2 ERS Compensation observed in the arc length errors as a function of rate as showed in Fig. 3.16b, Fig. 3.16c, Fig. 3.17b and Fig. 3.17c. Future work is required to verify this hypothesis.
0.025 Raw Estimate ESOQ Estimate 0.02

0.015

0.01

0.005

y(deg/s)

0

-0.005

-0.01

-0.015

-0.02

-0.025 -3

-2

-1

z(deg/s)

0

1

2

3

Figure 3.18: Laboratory measurements of the cross-axis estimator bias.

3.2.4

Summary and Future Work

When evaluating detectors for new star tracker designs, engineers are faced with a potentially troublesome trade-off: limit the detector choices to those with simultaneous row exposure; accept the added complexity of a mechanical shutter; or restrict the operating regime to very small angular velocities. The developments presented in this section offer a means of removing ERS distortions without the need for additional instruments. These algorithms are computationally simple and can easily be adapted to sensors with different optical designs and processing concepts. The specific contributions of this research are: 1. Analytical models (coarse and fine) of the effects of ERS distortion on star centroid locations. 2. Algorithms to estimate rate from pairs of detector images and correct ERS effects. 3. Initial simulation-based verification of the compensation routines that characterize rate estimation accuracy and computational complexity. 69

Chapter 3. Star Vector Error 4. An embedded implementation of the processing routines, validated by laboratory testing. These tests clearly demonstrate effectiveness of the ERS compensation under realistic imaging conditions. These algorithms are quite mature and have been deployed on a commercial sensor. Nonetheless, ongoing studies aim to improve the algorithm performance and better characterize the effectiveness of the corrections. In particular, the cross-axis bias effect must be better understood and algorithm testing should be expanded to include night-sky observations. Further research is necessary to understand the source of the cross-axis bias and additional testing is required to verify the effect in laboratory results. The proposed secondary ESOQ2 correction is effective in improving the rate estimation accuracy, but this effect may be able to be removed in the initial determination step. Laboratory testing is able to verify that the ERS software is able to estimate sensor body rate and preserve the geometry of simple scenes. Extensive night-sky tests with the ST-16 have validated star tracking and attitude estimation functions but these experiments have used only static observations. A valuable experiment would be to verify our ERS compensation routines operate correctly during slewing maneuvers under the night sky. Future work is required to qualify a motorized mount to enable precision slew control during field trails. Although some aspects of algorithm development have been shaped by the specific operating concept of the ST-16 star tracker, this approach to ERS compensation is applicable to a wide array of sensor designs. If rate estimates are independently available (e.g, from rate gyros or an external state estimator), the ERS corrections can be applied without the need for the rate estimation step. Additionally, star trackers with dedicated tracking modes can dispense with the paired imaging and integrate rate estimation into their frame-to-frame processing. Designers need not choose between effective star tracking and simplified hardware design -- they can have both.

70

Chapter 4

Verifying Slew Tolerance

The performance of a star tracker is largely based on the availability of its attitude solution. Several tests exist to assess the availability under static imaging conditions, however these rarely reflect true operating conditions. To acquire results of higher fidelity, we are generally forced to utilize mission specific details to generate a true sky track. This study attempts to bridge this gap between low fidelity general solutions and high fidelity, mission specific solutions by providing intermediate-level solutions that explicitly address the effects of sensor slew and incorporate pixel-level detection logic. Specifically, I describe, model, and test the effects of slew rate on star tracker performance using results from the newly available ST16 nanosatellite star tracker. I conclude this chapter with comparisons of spatially defined availability and sky tracks that can be calculated for specific missions.

4.1

Introduction

Satellites that require high accuracy attitude estimates (< 1 arc-min) generally employ the use of star trackers. These sensors operate by taking images of the star field and matching observed patterns to an onboard catalog. For most star trackers, the availability of this attitude measurement is generally greater than 99% [Liebe 2002]. However, in many cases, the satellites that employ star trackers are required to change their attitude; either continuously, as with Earth Observation (EO) satellites, or periodically, as with space telescopes. For star trackers onboard such satellites, angular motion during imaging (slew) causes stars to smear out over a larger number of pixels than they would occupy in static imaging conditions. This reduces the Signal-to-Noise Ratio (SNR) of the imaged star, which decreases detection performance of dim stars. Detecting less stars in each image ultimately impairs the accuracy and availability of the star tracker attitude solution. Each star tracker claims to be tolerant of some amount of sensor slew; however, it is difficult to quantify the exact impact this angular motion has on sensor performance. This chapter investigates the effects of slew rate on the availability performance of a star tracker. Specifically, I develop an analytical model for the intensity distribution of a star 71

Chapter 4. Verifying Slew Tolerance smear. I combine this model with star detection logic in a simulation-based approach to evaluate the effects of slew rate on star tracker availability. I verify these results through lab testing, and discuss further verification using field tests. Lastly, I propose two new measures of star tracker availability that can be used to quantify the availability performance of a star tracker in the presence of sensor slew. These new measures represent different degrees of availability fidelity at corresponding degrees of applicability (in terms of specific missions). Although numerical results of this chapter are specific to the ST-16 star tracker, the models and methods developed are applicable to any star tracker with only minor modifications. Before beginning with any discussion on slew rate tolerance, it is imperative to understand how sensor slew impacts the performance of a star tracker. The remainder of this section defines star tracker availability, introduces the ST-16 test sensor, and outlines the methods that are used to measure detection performance as a function of slew rate.

4.1.1

Star Tracker Availability

The performance of a star tracker is generally described by two parameters: availability and accuracy. Accuracy is defined by the uncertainty in the attitude estimate. Availability is defined as the fraction of the celestial sphere, also known as firmament, over which a reliable attitude solution is possible. This chapter only examines the effects of sensor slew on availability. For more information on how sensor slew affects star tracker accuracy, please see Chapter 5. The key requirement for a star tracker attitude solution is detecting a sufficient amount of stars in each image. The required number of detected stars, denoted as Nmin , varies depending on the operating mode of the star tracker and the performance of the matching algorithm. If no previous attitude information is known, at least three stars are generally required to solve the Lost-In-Space (LIS) problem using star tracker measurements [Wahba 1965,Shuster & Oh 1981, Spratling & Mortari 2009]. This limit of three stars stems not from the solution for attitude , known as Wahba's problem - which only requires two stars, but from the identification of stars within an image. If only two stars are detected in an image, typically not enough information is known to identify one star from another. Therefore, at least one additional star is required. This lower bound of Nmin = 3 represents the most optimistic case that implies the matching algorithm can correctly identify each star based on the respective 3-star pattern. Due to pattern ambiguity in the star catalog, this lower bound is commonly increased to Nmin = 4 which is a more conservative representation of matching performance. Once the attitude of the spacecraft is known, the star tracker can switch into a tracking mode. In this mode, only two stars are generally required in each image to determine the incremental change in attitude between sequential images (Nmin = 2). For this chapter, it is assumed that pattern ambiguity is not a limiting factor and the availability of an attitude solution is defined by at least three detectable stars in the FOV. One problem with this definition is that it 72

4.1 Introduction conflates stochastic effects (star detection) with non stochastic effects (star distribution, slew rates, tracking modes, etc.) and therefore is difficult to quantify over a range of operating conditions. Throughout the design and development process of a star tracker, several different models are used to predict the availability performance of the sensor. The lowest fidelity models generally assume idealized (static) imaging conditions and are useful for examining top level performance of candidate optical systems [Liebe 2002,Dzamba & Enright 2013]. These models are typically based on a fixed stellar detection threshold, mt , which is used in conjunction with the FOV to determine the number of detectable stars for a given sensor orientation. Repeating this calculation over a survey of all possible sensor orientations yields an idealized measure of star tracker availability. The fixed mt is typically defined by a minimum SNR set by the noise of the image detector and size of the PSF. This type of model is summarized by the first row of Fig. 4.1. A step up from the lowest fidelity, are various models that explicitly include the effects of
FIDELITY
Low fidelity  results but  widely  applicable

Metric
· Ideal · Static

Principle
· Fixed stellar detection  threshold:  · Count detected stars in  FOV ( required)

Detection
·  defined by a desired SNR · SNR based on PSF size and  detector noise · · · · · · · · · · · ·

Required Information
Minoraxis FOV Static  Static PSF Diameter Detector Noise Desired SNR Star Catalog Minoraxis FOV Variable     Fixed Slew Rate Static PSF Diameter Detector Noise Star Catalog

Useful For
· Initial Optical  Design

· Noisy · At Rate

· Stellar detection  threshold varies with  slew rate:     · Count detected stars in  FOV ( required)

·  defined by a desired SNR · SNR based on size of star smear +  shot noise and detector noise · All pixels within star smear are  assumed to be identifiable. (Full  star intensity is measured)

· Performance Prediction

GAP IN AVAILABILITY TESTS
· Detected · At Rate · Stellar detection  threshold varies with  slew rate:     · Count detected stars in  FOV ( required) ·  is based on detection routine · Focal plane intensity distribution  of star smear is modeled · Pixels within star smear are  identified using detection logic  (Not all star intensity is measured) · · · · · · · Minoraxis FOV Variable     Fixed Slew Rate Static PSF Diameter Detector Noise Star Catalog Detection Routine · Design Validation · Detection  routine analysis

THIS  STUDY

GAP IN AVAILABILITY TESTS
· Operational · Utilize mission info and  reference maneuvers to  calculate sky track · Stellar detection  threshold varies with  slew rate:     · Count unambiguous star  patterns in FOV ·  is based on detection routine · Focal plane intensity distribution  of star smear is modeled including  effects of optical aberrations · Pixels within star smear are  identified using detection logic  (Not all star intensity is measured) · Matching routine eliminates  spurious star detections · · · · · · · · Full FOV shape Variable     Variable Slew Rate Variable PSF Diameter  (optical aberrations) Detector Noise Star Catalog Detection Routine Matching Routine · Mission Planning

High fidelity  results but  mission  specific

APPLICABILITY
Figure 4.1: Commonly used types of availability testing.

73

Chapter 4. Verifying Slew Tolerance slew rate. These models utilize a dynamic stellar detection threshold that is based on the slew rate, mt = f ( ) [Accardo & Rufino 2001, Liebe et al. 2004]. These models account for the size of the smear, but do not explicitly consider the intensity distribution within the smear itself. The typical assumption with these models is that all of the signal (starlight) is detected, not by the image detector, but separated from the background image noise by the star detection routine. Similar to model described in first row of Fig. 4.1, detection of a specific star is defined by a minimum SNR. However, in this case, the SNR is based not only by the noise of the image detector and size of the PSF, but by the length of star smear. These models are summarized by the second row of Fig. 4.1. On the opposite end of the fidelity spectrum, we have various high fidelity models. These models produce more accurate results but they rely on specific information about mission orbits and maneuvers. Availability is measured along the specific orientation track the sensor will follow on the celestial sphere. This track is defined by dynamics of the spacecraft. Star detection is assessed by the exact detection routines employed on the star tracker. These models can include the effects of optical aberrations on the PSF, as well as the effects of bright bodies (Sun, Moon, other planets). Furthermore, these models would typically revise the definition of availability from having at least Nmin detectable stars in the FOV to having a detectable non-ambiguous star pattern in the FOV. These models would typically be used to predict the availability performance of a spacecraft following launch. These models are summarized by the last row of Fig. 4.1. There is currently a gap in available performance models between those which yield high fidelity results and those which are not specific to a particular mission. This work attempts to bridge this gap and provide some intermediate models of availability. The aim is to increase the fidelity of the availability model while not limiting its applicability to any specific mission. This work explicitly considers the effects of sensor slew, star detection logic, and the commonly modeled effects of star distribution on star tracker availability. Figure 4.1 summarizes the metrics, required knowledge and potential application of the common types of availability testing. For the purpose of this chapter, three types of availability are defined to describe the transition from the general and heavily idealized to mission specific models of availability shown in Fig. 4.1:

1. Spatial Static Availability. No motion of the sensor during an image exposure. Availability is calculated using a large set of discrete sensor orientations that are equally spaced along the celestial sphere. At each orientation, I determine if at least three stars are detected based on the sensor FOV and a fixed stellar detection threshold, mt . This definition represents the idealized static model described by the first row of Fig. 4.1. 2. Spatial Dynamic Availability. Sensor is moving at a constant rate during image exposure. Availability is still evaluated at discrete sensor orientations; equally spaced along the celestial sphere, but now with a detection threshold dependent on the slew rate. Unlike the second 74

4.1 Introduction row of Fig. 4.1, detection is not based on a desired SNR, but actually determined by detection logic employed by the ST-16. This represents the model described by the third row of Fig. 4.1. 3. Along-track Dynamic Availability. Sensor is moving at a constant rate during image exposure. Availability is calculated only along the specific path (sky track) and at specific slew rates the sensor orientation will follow as a result of mission dynamics. Similar to spatial dynamic availability, detection is determined by detection logic employed by the ST-16. This represents an approximate version of the bottom row of Fig. 4.1.

4.1.2

The ST-16 Star Tracker

Consistent with the rest of the thesis, the Sinclair Interplanetary ST-16 star tracker is used as the baseline sensor. For detailed information about the sensor, please see Table 1.1. Although the results of this work reflect some preliminary performance characteristics of this device, the developed approach is generalizable to other star trackers. The ST-16 star catalog contains all stars of stellar magnitude 5.75 or brighter -- 3746 stars in total, drawn from Yale Bright Star catalog (YBS) [Hoffleit & Warren Jr 1991]. Using mt = 5.75 as the stellar detection threshold, in combination with the ST-16 half-axis FOV, x = 7.5 , the spatial static availability of the ST-16 attitude solution is calculated to be > 99.9%. This is calculated by testing a large number (10,000) of sensor orientations for at least Nmin = 3 detectable stars in the FOV. The tested orientations are distributed evenly across the celestial sphere using the method described by [Marantis et al. 2009]. Figure 4.2 shows a distribution map of the number of stars within the ST-16 FOV as a function of sensor orientation. From this figure we can see how uneven the star distribution is across the celestial sphere. When pointing near the celestial equator, more than 10 stars in the FOV are typical. Conversely, in the neighborhood of the celestial poles, many views see only three stars (see Fig. 4.3). These regions of sparse star distribution are directly dependent on the sensor FOV and the range of detectable stellar magnitudes. One of the main contributions of this chapter is that it enables the incorporation of detection logic into the availability analysis of a slewing star tracker. The detection scheme used onboard the ST-16 can be briefly summarize by describing three threshold values: Lit Pixel Threshold - This value defines the minimum intensity of an image pixel that is considered to be lit by starlight as opposed to just sensor noise. Pixels that are above this threshold are labeled lit pixels. The ST-16 utilizes a lit pixel threshold of 120 detector counts out of a possible 4095 (constrained by the image detector's 12-bit Analog-to-Digital Converter (ADC)). Number of contiguous pixels - This defines the minimum number of contiguous lit pixels that each candidate star must possess before it can be considered as a valid detection. The ST-16 requires at least six contiguous pixels. 75

Chapter 4. Verifying Slew Tolerance Integrated Intensity Threshold - This value describes the minimum integrated intensity (summed intensity) of all contiguous lit pixels that compose a candidate star. Candidate stars above this threshold are considered valid detections. Typical ST-16 operation requires an integrated intensity of 1000 detector counts per a star.

Figure 4.2: Spatial static star distribution map (0  /s).
6+ 80 60 40 4 Declination (deg) 20 0 -20 2 -40 -60 -80 0 50 100 150 200 Right Ascension (deg) 250 300 350 0 1 3 5 Number of stars in the FOV

Figure 4.3: Sky regions with poor star availability (0  /s).

76

4.1 Introduction

4.1.3

Testing the Performance of Star Detection

Sensor slew during an image exposure spreads the light from each star over a larger region of the detector than compared to static imaging conditions. Given that the areal density of the detector noise is approximately constant, as the incoming light spreads over more pixels, the integrated SNR over a star image drops. The processing routines used onboard the ST-16 subtract out most of the detector dark response, so the SNR reduction appears as a decrease in the apparent brightness of imaged stars. At some point the integrated intensity (summed detector response) of a star will drop below the threshold of reliable detection. Therefore, as the slew rate increases, the range of stellar magnitudes that the ST-16 can detect decreases. This reduces the number of detectable stars in the working catalog, ultimately leading to a drop in availability. Fig. 4.4 shows the change in availability for various limiting stellar detection thresholds. As part of this work, I examine the efficiency of three methods that can be used to determine the performance of star detection as a function of slew rate. The results from these methods can be used to define the stellar detection threshold in terms of slew rate, mt = f ( ), which can then be related to availability. The methods I examine are:

 Simulations: I derive an analytical model to calculate the shape and intensity of an imaged star in the presence of sensor slew. This is combined with the detection scheme implemented
100 90 80 70 Availability (%) 60 50 40 30 20 10 0 0 1 ST-16 Static Detection Threshold (5.75) 2 3 4 5 Detection Threshold (Stellar Magnitude) 6 Detection threshold decreases with increasing slew rate

Figure 4.4: ST-16 Spatial static availability for varying star detection thresholds.

77

Chapter 4. Verifying Slew Tolerance onboard the ST-16 to determine the rate at which a star of given magnitude would cease to be detected.
 Lab Tests: The ST-16 star tracker is placed onto a three-axis motion platform capable of accurately slewing at a prescribed rate. While slewing, images are taken of a collimated light source. This strategy represents an improved level of realism as the actual star tracker and onboard routines are used for image formation and processing.  Field Tests: This strategy involves moving the star tracker at fixed rates while collecting night sky images. Atmospheric factors introduce variability into images taken with this strategy. However, these effects can be mitigated with the selection of an observation site with good viewing conditions and a high-accuracy telescope drive system.

Each of these methods represent a different level of realism for a different cost (material and labor). I compare the performance of these methods and examine which method is the most beneficial at different points of the sensor development process.

4.2

Modeling the Effects of Sensor Slew

Since stars are effectively point sources of light, the shape of an imaged star is equivalent to the PSF of the optical system. During nominal imaging conditions, this is commonly approximated by a symmetric two-dimensional Gaussian distribution. In the presence of sensor slew, the symmetric Gaussian is elongated along the direction of motion forming a blurred image. This section begins by discussing the effects of slew rate in different directions. Following this, I develop two analytical models for the intensity and shape of a star image taken at a given rate. I combine these models with shot noise and detector noise to simulate a realistic PSF. I then apply detection logic equivalent to that used on-board the ST-16 star tracker to determine the tolerable slew rate for the given stellar magnitude.

4.2.1

Types of Sensor Slew

It is useful to separate the slew rate of a star tracker into two components: a roll component (z ), and a cross-axis component (xy ). Each component results in a different effect, with a different relative magnitude. If we neglect the effects of optical aberrations and consider a pinhole imaging model, a purely cross-axis rotation (z = 0) results in linear star streaks on the focal plane of the star tracker. The length of each streak, so , is dependent only on 2 +  2 , the exposure time, t , and the focal length of the the rate of rotation, ||xy || = x e y sensor optics, f . The length of every star streak for a purely cross-axis slew is given by: 78

4.2 Modeling the Effects of Sensor Slew

sca = f tan (xy te )

(4.1)

For a pure boresight roll, stars will appear as streaks in the shape of circular arcs, centered about the axis of rotation. Similar to the cross-axis case, the length of each arc is dependent on the roll rate, ||z ||, and the exposure time. However, instead of scaling directly with focal length, the arc length scales with distance from the axis of rotation (in this specific case, the boresight). Practically, the largest distance from the boresight that a star can be detected at rate is at the edge of the minor-axis FOV. If we let h denote the minor dimension of the image detector, the maximum arc length of a star tracker is given as:

sr = (h/2) tan (z te )

(4.2)

Since the focal length of the optics is always significantly larger than the dimension of the detector, we can see that cross-axis slew rates will cause larger streak lengths. Comparing Eq. (4.1) and Eq. (4.2), we can see that even at the largest off-axis distance, h/2, the crossaxis streak length is still larger than the roll streak length by a factor of 2f /h. For the ST-16, this factor works about to be  7.5. Therefore, a pure cross-axis slew produces the maximum streak length of any slew rate, for a given magnitude. Since the streak length is the primary factor that impacts star detection, this chapter limits its investigation of slew rate on star detection to cross-axis slews only.

4.2.2

Intensity Model

The number of photo-electrons from a single star is given by [Reed 1993] as:
-2 (ms,1 -ms,0 ) 5

Se = Q te A0 · 10

(4.3)

where Q is the mean quantum efficiency of the detector; te , is the observation time; A, the aperture area; 0 the stellar flux from a reference star; and ms,1 , and ms,0 are the apparent stellar magnitudes of both the star in question and the reference star. Stellar magnitudes are defined with respect to a negative logarithmic scale. Dimmer stars represent larger values of ms , while brighter stars represent decreasing values of ms , which can include and surpass the origin defined by ms = 0. Our sun has a stellar magnitude of approximately -26.74. Following [Reed 1993] and making judicious assumptions about stellar type and wavelength band, 0 = 1.8 × 1010 m-2 s-1 is used for a magnitude zero star reference star, (ms,0 = 0). Incorporating this change into Eq. (4.3) and expressing A in terms of the aperture diameter, D, gives: 79

Chapter 4. Verifying Slew Tolerance

2 1 Se = Q te D2 0 · 10- 5 ms,1 4

(4.4)

where ms,1 is now simply denoted as ms , representing the stellar magnitude of a desired star.

4.2.3

Shape Model

The PSF of a star from a non-rotating spacecraft can be approximated as a symmetric Gaussian distribution. The intensity distribution on the focal-plane can be modeled by the function, Si (x, y ), given as:

Si (x, y ) =

+(y -yc ) Se - (x-xc )2 s2 e 2s 2 r2 Se - 2 s2 e = 2 2s

2

2

(4.5)

where Se is the ideal integrated intensity of the imaged star given by Eq. (4.4), s describes the size of the PSF (can be measured during calibration), (xc , yc ) is the location of the star's centroid, and r is the radial distance of a point (x, y ) from the centroid. Equation (4.5) is commonly used to model the intensity distribution of a star for static imaging conditions. When the star tracker is moving, the centroid of an imaged star moves during the course of an exposure forming a elongated streak. If we define the star vectors at the beginning and end of an exposure as p and q , we can model this motion as an infinitesimal rotation through an angle te  as described by:

q = I3x3 - te  × p

(4.6)

where  × denotes the skew-symmetric matrix of the angular velocity vector  and te is the star tracker exposure time. The vector difference can be written as:

 s = q - p = -te  × p

(4.7)

In the ST-16 operating regime, defined by a maximum acceptable slew rate of 2  /s, it is assumed that the loci of the centroids in the detector plane appear as linear segments with displacement, s , specified in pixels. This is given by: 80

4.2 Modeling the Effects of Sensor Slew

s =

f te s,x = s,y p pz

z py - y pz x pz - z px

(4.8)

Using Eq. (4.8) the integrated response at a point (x, y ) of the elongated PSF is defined as a function of the initial centroid position, (xi , yi ), and the focal plane displacement, s . Eq. (4.5) is rewritten to include the elongation of the PSF as:
t)2 Se - r2( 2 s e 2 2s

Ss (x, y, t) =

(4.9)

where t is the time from the beginning of the PSF exposure, and r2 from Eq. (4.5) is now s,x t -x xi + te
2

r =

2

s,y t + yi + -y te

2

(4.10)

The quantities (xi , yi ) are the detector frame coordinates of the star centroid at the beginning of the exposure and (x, y ) are detector frame coordinates of an arbitrary point of interest. Substituting Eq. (4.10) into Eq. (4.9), expanding Eq. (4.9), and collecting like terms, we get: Se z e 2 2s

Ss (x, y, t) = where

(4.11)

z = a2 t2 + a1 t + ao and
2 (d2 ,x + d,y ) a2 = - 2 t2 2s e

(4.12)

(4.13) (4.14) (4.15)

a1 =

d,x (x - xi ) + d,y (y - yi ) 2t s e

- (xi 2 + x2 + yi 2 + y 2 ) + 2 (xi x + yi y ) a0 = 2 2s

We now integrate Eq. (4.11) with respect to time and get the focal-plane intensity distribution of an imaged star in the presence of angular rates: 81

Chapter 4. Verifying Slew Tolerance

te

1

Sb (x, y ) =
0

Ss (t) dt = Ao Bo e 4a2

4a0 a2 -a2 1

(4.16)

where Se 2 2s 1 2a2 te + a1  2 - a2

Ao =   Bo =  erf 2 - a2

(4.17)

1 a1  2 -a2

- erf

(4.18)

Given an angular rate and a static intensity, this derivation gives the shape and intensity distribution of a star imaged during sensor slew.

4.3

Star Detection at Rate

Employing the analytical models developed in the previous sections, simulations are used to examine how the measurable intensity of a star is affected by the slew rate of the sensor. The results of these simulations are compared with lab trials that utilized a motion platform, a ST-16 engineering model, and a collimated light source. This discussion is concluded with an examination into the potential accuracy and benefit of acquiring field results at rate.

4.3.1

Simulation Tests

Using the developed analytical models for the shape and intensity distribution of a star, given by Eqs. (4.4) and (4.16), simulation tests are performed to accomplish two objectives. The first objective is to examine the decrease in the measurable intensity of a star (integrated intensity), as a function of slew rate. The second objective is to determine the maximum slew rate at which a star of given magnitude can be detected. This maximum slew rate is referred to as the tolerable slew rate. Each simulation consists of iteratively simulating a star image for a range of slew rates, adding some typical imaging noise sources, and then applying a detection scheme equivalent to the one used onboard the ST-16. This process is summarized by the following steps:

1. Using Eqs. (4.4) and (4.16) the shape and focal plane intensity distribution of the star is calculated. This gives the value of each pixel within the star image on the image detector. 82

4.3 Star Detection at Rate 2. The ideal signal from step 1 is then combined with two typical imaging noise sources: shot noise and detector read noise. Shot noise describes a random variation in the observed amount of photoelectrons due to the discrete, quantum nature of light. It is typically modeled as a Poisson distribution with  (x, y ) = Sb (x, y ) [Holst & Lomheim 2007]. Read noise is essentially a summation of typical image detector noise sources and is generally modeled as a zero mean, normally distributed random variable with e = 3.5e- , where e- is electrons. 3. The resulting image is quantized in two steps. First, a scaling parameter of 7 detector counts/e- is applied. This corresponds to the gain of the ST-16's image detector, the MTP9031 (see Table 1.1). Second, the signal is converted into a 12-bit integer to reflect the 12-bit ADC of the MTP9031. 4. The last part of the process applies the ST-16 detection routine described in Section 4.1.2 to determine if the star would be detected, and if so, measure its integrated intensity.

Utilizing the process summarized above, images are simulated for stars of varying stellar magnitude and at slew rates of 0 - 3  /s. At each slew rate, the integrated intensity is recorded, as measured by the ST-16 detection routines. Figure 4.5 shows the measured integrated intensity as a function of increasing slew rate for set of stellar magnitudes, ms , where ms defines the intensity of each star as per Eq. (4.4). The line at the bottom of the graph represents the integrated intensity threshold of the ST-16. The trend of decreasing integrated intensity with increasing slew rate is similar for each stellar magnitude. The rate of this decrease in integrated intensity, referred to as the loss rate, begins at a shallow value and gradually increases. At a particular slew rate, which varies depending on the brightness of the star, the loss rate reaches a maximum value after which (for larger slew rates) it begins to decrease. The overall trend in changing loss rates of integrated intensity is due to the shape of the star, which is modeled as symmetric Gaussian. Since most of a star's intensity is concentrated at the centroid, the loss of integrated intensity for increasing slew rates is gradual, for small slew rates. However, once the peak of the star smear begins to reach the integrated intensity threshold, a large amount of lit pixels can be lost all of a sudden. The only remaining lit pixels are those closest to the centroid track which typically contain substantially more intensity ( ×2) than their immediate neighbours. The intensity within these center pixels, can be initially hidden due to the effects of pixel saturation. As the light from a saturated pixel is spread across a region of several pixels, an instantaneous increase can sometimes be seen in the integrated intensity of a star as previously undetected light is now detected by the neighbouring pixels, see Fig. 4.5. The results of these simulations are used to determine the maximum tolerable slew rate for a given stellar magnitude. This is achieved by examining when the ST-16 detection algorithm loses a star of a given magnitude. Figure 4.6 shows the tolerable slew rates for stars with stellar magnitudes between 3.8 and 5.8. 83

Chapter 4. Verifying Slew Tolerance
16000 m: 5.50 m: 5.25 m: 5.00 m: 4.75 m: 4.50 m: 4.25 m: 4.00 Inten. Thresh

14000

Integrated Intensity (det. counts)

12000

10000

8000

6000

4000

2000

0 0

0.5

1

1.5 2 2.5 Angular Rate - 1 axis (deg/s)

3

3.5

4

Figure 4.5: Simulated star intensity at varying slew rates.

4.3.2

Lab Tests

To evaluate the accuracy of the simulation tests, a series of lab trials was conducted using a ST-16 engineering model, a 3-axis motorized gimbal, and a star source. The star source is a fiber-coupled halogen lamp that illuminates a pinhole and is collimated by a telescope. Star intensity is adjusted with neutral density filters and a variable attenuator. Each trial consisted of testing the detection performance of a given stellar magnitude at a range of slew rates. The intensity model given by Eq. (4.4) was used to match the static response of the ST-16 to the desired stellar magnitude. For each intensity, 30 images were taken at each slew rate spanning from 0  /s to 3  /s in 0.25  /s steps. The mean value of these 30 measures of integrated intensity was then used for each angular rate to mitigate the random effects of shot noise and read noise. The results of these tests are displayed in Fig. 4.7. Markers indicate the integrated intensity measured during lab trials, denoted in the figure as Lab. Full lines represent results attained through simulation for corresponding beginning star brightnesses. These simulation-based results are denoted in the figure as Sim. There is strong correspondence in trends of decreasing integrated intensity. However, the lab results appear generally brighter than the simulation results by an approximately constant amount. This error was traced to a discrepancy in the number of lit pixels between the simulation and lab-based trials. It is believed that this discrepancy arises from the effects 84

4.3 Star Detection at Rate

3.5

3

Tolerable Slew Rate (deg/s)

2.5

2

1.5

1

0.5

0 3.8

4

4.2

4.4

4.6

4.8

5

5.2

5.4

5.6

5.8

Stellar Magnitude

Figure 4.6: Tolerable slew rates for ST-16 star detection.

of residual dark current in the images taken with the ST-16. Although the ST-16 employs routines to eliminate dark current, a small non-zero mean component and separate random varying component of dark current remain following the correction. This residual non-zero mean component increases the intensity of the image background which leads to a larger amount of lit pixels in lab images. Future work is required to model this residual dark current in the simulation-based trials.

4.3.3

Field Tests

The final method examined for assessing detection performance was the use of field images. For static tests, field trials generally involve taking a star tracker out on a clear night and imaging the stars under the night sky. For assessing tolerable slew rate, additional equipment is required to move the star tracker at a precise angular rate while imaging. Several problems exist with both types of testing that can cause significant discrepancies in the measured integrated intensity of imaged stars. In this section, these inaccuracies and how they impair our ability to get useful measurements of detection performance are examined. Several environmental factors associated with static field trials can impair the measurements of the integrated intensity of a given star. These include, but are not limited to: scintillation, high altitude cloud cover, aerosols and light pollution. Careful selection of a testing site far from any bright lights (cities) can effectively minimize the effect of the last of these error 85

Chapter 4. Verifying Slew Tolerance
4

2.2 2 1.8 Integrated Intensity (det.counts) 1.6 1.4 1.2 1 0.8 0.6 0.4 0.2

x 10

m = 5.26 (Lab) m = 4.55 (Lab) m = 4.04 (Lab) m = 3.72 (Lab) m = 5.26 (Sim) m = 4.55 (Sim) m = 4.04 (Sim) m = 3.72 (Sim) Intensity Thresh

0 0

0.5

1 1.5 2 Angular Rate - 1 axis (deg/s)

2.5

3

Figure 4.7: Star intensity at varying slew rates using lab tests.

sources. However, scintillation, high altitude cloud cover, and aerosols cause effects that continuously vary with time and therefore are harder to remove. Scintillation causes rapid variations in the apparent brightness of stars due to turbulence in the Earth's atmosphere. This can cause a star to appear brighter or dimmer than it nominally would. Due to the fact this effect is a result of Earth's atmosphere it cannot be avoided with field trials. However, the mean value of multiple intensity measurements of the same star over a short period of time can be used to increase the accuracy of the intensity measurement. Cloud cover and aerosols have a continuously varying attenuation effect on the measured integrated intensity of a given star. In many cases, careful planning and monitoring of forecast weather conditions can help mitigate these effects but they cannot be removed completely. In addition to environmental factors, several internal factors can contribute to the inconsistency in measured integrated intensity. Most notable are the effects of optical aberrations. These effects lead to changes in the size and shape of the imaged star as a function of offaxis distance. As discussed earlier in this chapter, changes in the size and shape of the PSF directly impact the measured integrated intensity of the star. Given that any useful field image contains many stars which are generally located at several off-axis angles from the optical axis, this effect introduces variations even within a single image. As an example of the types of described variations, Fig. 4.8 shows the results of three different field trials compared to the intensity model given by Eq. (4.4). Field trials 1 and 2 were taken a single day apart in two different locations both of which were located a great distance 86

4.4 Along-Track Dynamic Availability
x 10
4

11 10 Integrated Intensity (det. counts) 9 8 7 6 5 4 3 2 1

Field Trial 1 Field Trial 2 Field Trial 3 Intensity Model

1.5

2

2.5

3 3.5 4 4.5 Matched Stellar Magnitude

5

5.5

6

Figure 4.8: Comparing field results.

away (>50km) from any surrounding bright lights and were taken on days which the cloud cover was reported to be clear. Field trial 3 was taken several months later at a location approximately 20 km from a major city center and was also taken on a day in which the cloud cover was reported to be clear. Fig. 4.8 shows the variability present in measurements of integrated intensity from field trials, even in static conditions. Under dynamic conditions, the errors introduced by these variations quickly overcome the effects of slew rate. This severely impairs the accuracy of measuring the tolerable slew rate for any given stellar magnitude. This method can still be used as a coarse validation of detection performance, but the result will be a conservative estimate of the actual integrated intensity of star.

4.4

Along-Track Dynamic Availability

Throughout this study, several different approaches have been presented that can be used to predict the availability of the ST-16 star tracker at various slew rates. Both Figs. 4.6 and 4.7 support the conclusion that the ST-16 can detect stars dimmer than magnitude 5.0 at a slew rate of 1  /s. In Fig. 4.4, it can be seen that a detection limit of magnitude 5.0 still corresponds to a dynamic spatial availability of approximately 94%. This is illustrated by Fig. 4.9 which shows the distribution of the number of stars that would be detected by the ST-16 given a specific orientation, at a slew rate of 1 /s. Comparing this to Fig. 4.3, it can be seen that even a small drop in the range detectable stellar magnitudes results in large change in the spatial availability of the attitude solution. 87

Chapter 4. Verifying Slew Tolerance

Figure 4.9: Spatial dynamic availability map of the ST-16 star tracker (1  /s).

These availability calculations are based on instantaneous assessments of visible stars, not actual tracks of the sensors across the sky. These measures of availability are useful for generalizing the performance of the sensor; however, they do not accurately reflect the availability that would be seen during an actual mission. This type of mission-specific availability is heavily dependent on the path that the sensor traces along the celestial sphere and the slew rates the sensor experiences. This brings us back to the final definition of availability listed in Section 4.1.1, along-track dynamic availability. Using a known path along the celestial sphere we can calculate the along-track dynamic availability using the tolerable slew rate limit from Fig. 4.6 and the star distribution along the chosen path. As mentioned earlier, the calculated values for this type of availability vary greatly depending on the chosen path and slew rates. To illustrate this dependence I examine the along-track dynamic availability for a set of simple orientation tracks of star tracker slewing at a constant rate. Each orientation track is defined by an inclination, i, with respect to the celestial equator and represents a great circle on the celestial sphere, see Fig. 4.10. To calculate the along-track dynamic availability of the orientation track, I sample the orientation track at 1000 equally spaced orientations. At each orientation, I utilize the tolerable slew rates defined by Fig. 4.6 to determine if the number of stars that would be detected at each orientation, Nobs , satisfies Nmin , the required number of stars for the star tracker attitude solution. Repeating this calculation for all 1000 sample orientations gives the fraction of the orientation track over which an attitude solution is possible, which I denote as the along-track dynamic availability of orientation track. This analysis is repeated for different orientation tracks defined by (-90  i  90 ), at constant slew rates | | = 1.0 /s, 1.5 /s, 2.0 /s, and 3.0 /s. Figures 4.11 and 4.12, and Table 4.1 show the variation in along-track dynamic availability due to slew rate and orientation track inclination for both tracking (Nmin = 2) and Lost-In88

4.4 Along-Track Dynamic Availability

Minor Axis FOV

Orientation  Track

Celestial  Equator

Example Image,  3
Figure 4.10: Schematic of orientation tracks.

Space (LIS) (Nmin = 3) attitude solutions. For comparison I overlay a series of horizontal lines that indicate the determined spatial dynamic availability at each respective slew rate. It is evident from Figs. 4.11 and 4.12 that the along-track dynamic availability of a star tracker attitude fix is strongly dependent on the specific path the sensor follows. Just from the simple orientation tracks shown, it can be seen that the along-track dynamic availability can differ from the calculated spatial dynamic availability by more than 15%. Determining the along-track dynamic availability of a star tracker can be a challenging task. One needs to model the mission dynamics quite accurately to be able to predict the path the sensor will follow along the celestial sphere. In addition, one needs to establish the relationship between the stellar magnitude of a given star and the tolerable slew rate (see Fig. 4.6). Given that the latter task is independent of the selected mission and has been shown to be measurable using lab/ground tests, it could be provided by the sensor manufacturer. If these tasks can be achieved; even with a simplified set of dynamics, some rough bounds on star tracker availability can be determined. These can then be used as a coarse tool for star tracker feasibility studies and/or trade studies for star tracker placement. Spatial Dynamic Availability (%) 99.4 / 96.8 89.5 / 73.6 79.2 / 58.7 45.6 / 21.0 Along-Track Dynamic Availability (%) Mean Max Min 98.2 / 94.7 100.00 / 99.3 91.5 / 85.8 89.5 / 75.2 97.1 / 89.6 73.7 / 60.7 79.7 / 56.2 91.8 / 72.5 66.8 / 40.6 47.6 / 22.4 62.3 / 30.8 26.7 / 8.5

Slew Rate ( /s) 1.00 1.50 2.00 3.00

Table 4.1: ST-16 Along-track dynamic availability statistics. (Nmin = 2 / Nmin = 3)

89

Chapter 4. Verifying Slew Tolerance
1 100 90 Along-Track Availability (%) 80 70 60 50 40 30 20 10 0 -90 -75 -60 -45 -30 -15 0 15 30 Track Inclinations (deg) Along-Track Dynamic Spatial Dynamic 45 60 75 90 3.0 deg/s 1.0 deg/s 1.5 deg/s 2.0 deg/s

Figure 4.11: Examples of ST-16 along-track dynamic availability, Nmin = 2.
110 100 90 Along-Track Availability (%) 80 70 60 50 40 30 20 10 0 -90 -75 -60 -45 -30 -15 0 15 30 Track Inclinations (deg) 3.0 deg/s Along-Track Dynamic Spatial Dynamic 45 60 75 90 2.0 deg/s 1.5 deg/s 1.0 deg/s

Figure 4.12: Examples of ST-16 along-track dynamic availability, Nmin = 3.

4.5

Summary and Future Work

The main goal outlined at the beginning of this study was to model the effect of slew rate on star tracker performance. This was achieved by a three-part solution. First, I developed 90

4.5 Summary and Future Work two analytical models to describe the effects of slew rate on the PSF shape and intensity distribution. Second, I used this model to relate the detection performance of a star tracker to the slew rate through simulations, which were confirmed by lab tests. Third, I used this measured relationship between detection performance and slew rate to calculate star tracker availability under dynamic conditions. Good correspondence was seen between the results from the simulations and those from lab tests. Both of these indicated that the ST-16 satisfies the design requirement of maintaining high availability (> 99.9%) while tracking a ground target from LEO (slew rate  1  /s). In comparison, field trials were shown to be a poor choice for measuring the tolerable slew rate. This is due to variations in the measurable integrated star intensity caused by several parameters internal and external to the sensor. I finished the study with a brief examination of along-track dynamic availability for a set of simple mission dynamics. It was seen that the along-track results do vary from the calculated spatial dynamic availability. However, the latter can serve as a first-cut approximation of star tracker availability performance. The calculation of along-track dynamic availability requires knowledge of mission details and the relationship between tolerable slew rate and stellar magnitude. Using methods described in this study, the latter part of this solution can be achieved. If one can then attain even a simplified understanding of the expected mission dynamics, we can begin to form bounds on the availability performance of a star tracker.

91

Chapter 4. Verifying Slew Tolerance

92

Chapter 5

Optical Trade Studies for Future Star Tracker Development

This chapter presents a series of system performance models for nanosatellite star trackers. Many Earth-observing missions rely on spacecraft body motion to track ground targets. These operational scenarios lead to requirements for arc-second-accuracy attitude estimates during body motion at rates of up to 1  /s. Achieving these performance targets with a small sensor presents a challenge. This chapter develops models to predict sensor availability and accuracy in terms of a number of optical design parameters. Starting from the baseline optical design of the Sinclair Interplanetary ST-16, I explore several strategies for improving the sensor accuracy. I highlight distinctive features of the trade-space relative to more conventional star tracker design. This work includes an overview of system-level trends and an analysis of promising point designs. Results from these trades are valuable for prioritizing further development.

5.1

Introduction

There is increasing demand for arc-second-level attitude measurement accuracy in microand nanosatellites. Star trackers are the most promising technology for achieving this attitude knowledge, but most extant designs are poorly suited for the requirements of this class of mission. The performance priorities required of these sensors differ from conventional applications giving rise to a variety of trade-offs during design. This chapter develops analytical models of star tracker performance and uses these tools to redesign the Sinclair Interplanetary ST-16 star tracker to achieve arc-second level performance. The ground registration of payload imagery can benefit significantly from arcsecond-level attitude knowledge. The increasing interest in performing this type of mission with microor nanosatellite class spacecraft creates a niche for a small, high accuracy star tracker. Toplevel analysis of the demands of such a device suggests the following performance targets: 93

Chapter 5. Optical Trade Studies for Future Star Tracker Development
 1 arc-second (i.e.,  4.8µrad) accuracy, while slewing at  1 /s , to track a target on the Earth's surface from Low Earth Orbit (LEO), with  99% availability of a robust attitude fix.

These requirements -- particularly the need for accuracy while slewing -- distinguish SSSTs from most conventional designs. Several design features of the ST-16, notably a rate tolerance of > 2  /s and stateless (i.e., zero acquisition time) processing model, were selected to address reference scenarios similar to those presented above. The primary deficiency of the ST-16 is currently its accuracy. Some redesign is necessary to bring the performance down to the sub-arcsecond level. The goal of this chapter is to explore evolutionary changes to the sensor design that would allow it to meet our performance targets while leaving the overall sensor architecture intact. In an earlier study [Enright et al. 2012], preliminary models of availability and accuracy were developed for sensors evolved from the ST-16. This study explored simple optical redesigns to improve quantitative performance, but also made semi-quantitative assessments of the contributions of a variety of secondary factors (e.g., stellar aberrations, thermal distortion, etc.) to the sensor error budget. The findings of this study suggested that contributions from many error sources could be minimized with software corrections and minor physical changes. The results of the optical redesign were less conclusive. The simplified models of sensor accuracy were not responsive to changes in parameters such as pixel size. Without a fair assessment of the impact of these parameters on performance, it was difficult to come to firm conclusions on directions for design optimization. The goal of this chapter is to extend the models used in earlier research and better explore the optical trade-space. Other researchers have formulated performance models for star trackers: Liebe, et al. [Liebe 2002, Liebe et al. 2002], have considered the role of physical design parameters in sensor accuracy; Hancock, et al. [Hancock et al. 2001], have examined centroid error through the use of detailed models of detector noise. One limitation of these previous studies is the common assumption of symmetric PSFs, and hence negligible motion and image smear during exposure. Many star trackers can operate at the rates outlined in our reference scenario ­ several operational reports exist in the literature, e.g., [van Bezooijen 2003,Rogers et al. 2009] -- but I am not aware of models designed to predict star tracker accuracy during slews. The models presented in this chapter take sensor motion into account when predicting both availability and accuracy, and thus extend the capabilities of previous techniques. In the following sections, I introduce the primary design parameters and define the scope of the trade studies that follow. I then present two analytical models that can be used to estimate sensor performance in terms of our primary measures of effectiveness: availability and accuracy. In Section 5.3, I apply our models to a series of trade studies. These trades evaluate performance both of discrete point-designs (based on COTS components) and a broader assessment of possible implementations. 94

5.2 Optical Performance Models The research presented in this chapter is a synthesis of my own contributions and work done in collaboration with my supervisor, Dr. John Enright. Both of the developed analytical performance models (availability and accuracy) represent collaborative contributions. These models were then utilized to carry out three types of trade studies: availability, accuracy, and combination of the two, which is dubbed as integrated trades. Of these three trade studies, the first represents a collaborative contribution while the latter two are both my own contributions to this body of research. I summarize this authorship in Fig. 5.1.
1 2 3 4

Analytical Performance Models Availability Trade Studies Accuracy Trades Studies Integrated Trades Studies
Personal Contributions Collaborative Work From Literature / Other Authors

Figure 5.1: Summary of contributions for optical trade studies.

5.2

Optical Performance Models

The goal of this chapter is to evaluate a family of star trackers that could reasonably be evolved from the baseline ST-16 design. I select promising design candidates and attempt to find COTS components (e.g., detectors, lenses) that could realize these designs. The validity of a design is influenced by two primary metrics: availability and accuracy. Availability indicates the fraction of the sky where a good attitude fix is possible; accuracy considers the magnitude of the error in these attitude estimates. Given requirements for these two metrics, we can identify regions of the optical design space where performance will meet our requirements. A few parameters can be used to describe the optical characteristics of the star tracker camera (Fig. 5.2). Basic imaging properties of the lens can be expressed in terms of the f -number, F# , and the lens diameter, D. The focal length is simply the product of these two quantities:

f = F# D

(5.1)

Further properties of the detector such as pixel size, p and detector height, ho can be related to the camera resolution and FOV, x . This simple set of parameters abstracts away many details of the lens design, but these quantities are sufficient to capture important aspects of system performance. 95

Chapter 5. Optical Trade Studies for Future Star Tracker Development

h


f

D 

Figure 5.2: An illustration of basic optical design parameters.

5.2.1

Availability Model

Availability is defined as the fraction of the sky over which a given star tracker design will give a reliable attitude fix. This subsection presents an analytical model that describes the availability of a star tracker's attitude solution. The model predicts the stellar magnitude of the dimmest star able to be detected. I label the brightness of this dimmest star as the threshold magnitude and denote it with mt . Using the predicted threshold magnitude and a catalog of known stars, we can predict the number of visible stars in an arbitrary sensor orientation. Repeating this calculation over the whole sky allows us to calculate availability. The model presented here is abstraction of the simulation based model presented in Section 4.2. In Section 4.2, star detection was assessed by effectively an exact replica of detection routines utilized by the ST-16 star tracker. Furthermore, the tolerable slew rate for a star of given stellar magnitude was determined through an open loop simulation. In this chapter, star detection is instead expressed through an analytical relation dependent on a required Signal-to-Noise Ratio (SNR). This relation analytically includes the effects of slew rate.

5.2.1.A

Signal-to-Noise Contributions

The number of photo-electrons from a single star is given by Eq. (4.4). The noise during the readout is a function of the number of pixels included in the star image. Assuming a rotationally symmetric static PSF, of radius, p (in pixels), and pixel size, p , we can calculate the number of pixels that contribute noise. If the sensor is not moving, this is:

2 Mstatic = p

(5.2)

2 where the delimiters denote the value described by p must be rounded up to next integer. When motion is present we must consider the added motion of the star centroid on the image detector during the course of an exposure. Considering only cross-boresight motion, the length of this centroid motion, labeled the track length, is given by:

96

5.2 Optical Performance Models

so =

F# D tan ( te ) f tan ( te ) = p p

(5.3)

where  is the magnitude of the angular velocity vector  (assuming only cross-boresight motion, e.g. x and y ). The result of Eq. (5.3), so , is equivalent to the magnitude of s given in Eq. (4.8). The total number of pixels in the PSF is therefore: F# D tan (te ) p

2 2 + 2 p + 2p so = p Mtotal = p

(5.4)

Translating the number of pixels into an expected noise depends on the dominant noise sources. The regime where we are using the MT9P031 (ST-16 image detector, see Table 1.1) seems only weakly dependent on exposure time. This suggests that we are dominated by read-noise. Neglecting the weak time dependence we can write the expected noise standard deviation as:

Ne =

Mtotal e

(5.5)

This leads to an expression for the expected SNR, Rt : Q te D2 0 · 10- 5 ms 4e
2 p
2

Rt =

+

2p F# D tan(te ) 

1/2

(5.6)

To achieve a specified target SNR, Rt , we can solve for the corresponding threshold magnitude, mt :
2 2 p (p p + 2F# D tan (te )) Rt e 2 p (Q te D2 0 )

5 mt = - log10 4

(5.7)

Thus, stars of this magnitude or brighter should always be detectable.

5.2.1.B

Estimating Availability

To evaluate availability one must assess the number of visible stars in a range of sensor orientations. Star visibility depends on the threshold magnitude calculated from Eq. (5.7), the size of the FOV, and the target region of the sky. Using the popular SKY2000 catalog 97

Chapter 5. Optical Trade Studies for Future Star Tracker Development [Myers et al. 2001] as our reference for star properties and distribution. For simplicity we will consider a circular FOV, with angular radius, x , determined by the minor axis of the detector, h. The extent of the FOV is determined by the optical design of the system: h = arctan 2f h 2DF#

x = arctan

(5.8)

The number of stars necessary for an attitude fix depends on the star tracking algorithms employed in the sensor. The algorithms employed by different sensors are quite varied, but many star trackers distinguish between matching (i.e., identifying stars in view, with or without a priori attitude knowledge), and tracking (i.e., following known stars across the FOV). These definitions suggest the following classifications:
 Fewer than two visible stars. Matching and tracking are impossible.  Two visible stars. Tracking possible (but not implemented by current ST-16), matching impossible.  Three visible stars. Tracking possible, minimum observation for matching.  Four or more stars. Good conditions for both matching and tracking.

Instead of a single availability metric one could define three distinct quantities -- i.e., 2-Star, 3-Star, and 4+-Star -- however, for simplicity the results in this study use the 3-star predictions. Depending on the final operating conditions, the assumptions behind the three and four-star categories may need further study. If enough of the star triangles are ambiguous, four-star scenes may represent the minimum number for reliable matching. This chapter does not assess triangle ambiguity in the availability calculations.

5.2.2

Accuracy Model

Accuracy is defined as the magnitude of the error in the attitude estimates of the star tracker. This subsection develops a simulation-based accuracy model based on the intensity model given by Eq. (4.16) and the simulation based procedure described in Section 4.2.3. Beginning with Sb given in Eq. (4.16), shot noise and detector read noise, parameterized by e , were added to the ideal intensity distribution to simulate a more realistic star image. This intensity distribution was then quantized in the same fashion as described in Section 4.2.3, to simulate an actual image. Pixels that receive 4095 detector counts of illumination or more are considered saturated. From here onwards, the analysis of the respective star image differs from that presented in Chapter 4. 98

5.2 Optical Performance Models For this portion of the thesis, I consider a simplified version of the ST-16 star detection routines. Any pixels whose response is greater than a fixed threshold, BT , are considered lit pixels and are included in the centroid calculation. Groups of contiguous lit pixels are candidate stars and centroid positions are estimated for each candidate using the first moment of illumination, given by Eq. (2.1), for all non-saturated lit pixels in each group. On the ST-16 there are several additional checks to prevent false detections caused by noise, but low-signal sensitivity is governed by BT . Equation (4.8) describes the centroid motion over the span of an image exposure, neglecting the effects of ERS. Assuming the true centroid, dt is located exactly midway between these two points, it can be calculated as: s 2

dt = di +

(5.9)

where di is the centroid at the beginning of the exposure, and s is the focal displacement of the star centroid, neglecting the effects of ERS. The centroid error is then the magnitude of the difference between true, dt , and estimated, de , centroid locations: = ||dt - de ||

pix

(5.10)

where de is the measured star centroid, calculated as the first moment of illumination of the star image, given by Eq. (2.1). The centroid error, , is a zero mean, normally distributed random variable with  = pix . The standard deviation, pix , represents the uncertainty in the centroid position which can be related to the angular uncertainty of the star vector using: pix p f

 = tan-1

(5.11)

The accuracy of a single star tracker attitude solution, using an arbitrary star scene, can be estimated from the angular uncertainty associated with any arbitrary star vector. If i denotes the expected angular uncertainty  of the i-th star vector, and assuming optimal weighting assigned to the set of star vectors, ai,C , the attitude covariance is given by Schuster [Shuster & Oh 1981] as :
N -1

P=
n=1

1 I - ai,C aT i,C 2 i

(5.12)

This covariance matrix is expressed in terms of a infinitesimal error vector,  = x y z where the j are the error rotations about the three body axes, defined by the camera frame. 99

T

,

Chapter 5. Optical Trade Studies for Future Star Tracker Development The first two elements of the diagonal can be used to approximate the cross-boresight accuracy:
2 bs = P11 + P22

(5.13)

The total attitude error is given by the trace:
2 = P11 + P22 + P33 tot

(5.14)

The presented approach can be used to give the accuracy estimate for any arbitrary star tracker image.

5.3

Optical Design Trades

Using the performance models developed in the preceding section, this section explores optical design options that will meet the target requirements. The primary goal of these trade studies is to highlight promising redesigns for the ST-16, but more generally, it is valuable to understand any general trends that can be found in this design space. I explore factors affecting each of the target metrics individually, but also examine their interaction. The bounds placed on the model parameter values reflect constraints imposed by our target application, and a certain degree of engineering judgment. To ensure that the sensor size remains fairly small, I consider lens diameters between 12 mm and 50 mm. As a rule of thumb, most star trackers use fast optics (i.e., low F# ), so these trade studies concentrate on lenses between F# = 1.0 and F# = 2.0. Detector parameters are chosen based on the properties of the Aptina MT9P031 (used in the ST-16), and the CMOSIS CMV4000 (a promising 4MP detector with larger pixels). Table 5.1 shows the key parameter values for both parts. The latter detector has some desirable design features (e.g., a global shutter), but also serves to illustrate the effect of changing the pixel size. Table 5.2 shows the baseline optical parameters for ST-16 star tracker as well as three reference point designs. The reference designs represent interesting regions of the tradespace. The subsections that follow discuss the performance of these designs in greater detail. All of the following scenarios use the ST-16 baseline exposure of 100 ms.

5.3.1

Availability Trades

Broadly speaking, increasing the number of stars in view of the star tracker will increase its availability. Two basic approaches will increase the number of stars in the FOV: enlarging 100

5.3 Optical Design Trades
Table 5.1: Optical Trade Study Detectors

Parameter h (mm) Q p (pixels) te (s) p (µm) e- Rt  ( /s)

MT9P031 4.28 0.5 5 0.1 2.2 3.5 10 1.0

CMV4000 11.3 0.5 5 0.1 5.5 13 10 1.0

Table 5.2: Reference Optical Designs

Designation Manufacturer Detector F# D (mm) x ( ) Mass (g)

1 (Baseline) Marshall Aptina 1.2 12 7.5 15

2 Custom Aptina 1.0 12 10.1

3 Navitar CMOSIS 1.4 35 6.4 217

4 Navitar CMOSIS 0.95 52 6.4 489

the field of view and raising mt (i.e., allow the sensor to detect dimmer stars). The specific mechanisms for achieving these ends are related to the optical design parameters. We can increase the size of the FOV by enlarging the detector (i.e., increasing h), or reducing the focal length f . The primary mechanism for improving mt is to collect more photons; i.e., by increasing D or te . There is a trade-off in several of these parameters, particularly D and f and the optimal resolution of this will depend on the regime (static, or motion) in which we are operating. To examine this trade off, the availability curves for several candidate designs are compared at different body rates. Fig. 5.3 shows the availability at rest; Fig. 5.4 shows the same designs at  = 1 deg./s. Note the curves for the two designs that use the MT9P031 detector (h = 4.3 mm). At rest, the larger lens solution provides an advantage over a larger FOV. When moving, these results are reversed: the larger FOV maintains better optical performance. This inversion is a consequence of the distribution of stars across the celestial sphere. Narrow fields of view see longer, dimmer star tracks. The increased sensitivity is not sufficient to compensate for the restricted view. Although the absolute limit of this results was not assessed, this trend holds in a variety of model conditions for the MT9P031 detector. The preference for D over x does not seem to hold for the larger CMOSIS detector. Some insight into this behavior can be gained by plotting the availability curves against the FOV size (Fig. 5.5). Here it is seen that the small lens and large detector (D = 12.0mm, h = 11.3mm) corre101

Chapter 5. Optical Trade Studies for Future Star Tracker Development
1.01

1

0.99 Availability

0.98

0.97

0.96

D = 12.0 mm, h = 4.3 mm D = 50.0 mm, h = 4.3 mm D = 12.0 mm, h = 11.3 mm D = 50.0 mm, h = 11.3 mm 1.1 1.2 1.3 1.4 1.5 F# 1.6 1.7 1.8 1.9 2

0.95 1

Figure 5.3: Effect of F# on availability ( = 0  /s).
1.1

1.05

1

0.95 Availability

0.9

0.85

0.8 D = 12.0 mm, h = 4.3 mm D = 50.0 mm, h = 4.3 mm D = 12.0 mm, h = 11.3 mm D = 50.0 mm, h = 11.3 mm 1.1 1.2 1.3 1.4 1.5 F# 1.6 1.7 1.8 1.9 2

0.75

0.7 1

Figure 5.4: Effect of F# on availability ( = 1  /s).

102

5.3 Optical Design Trades sponds to a very wide FOV. Developing a star tracker in this region of the design space would require dealing with a host of secondary factors that are not well represented in the developed performance models. Implementing a low aberration lens to these specifications would be challenging, and several system level complications also arise (e.g, bright body incursions, baffle dimensions, etc.). The opposite configuration, a large lens and a small detector (D = 50.0mm, h = 4.3mm), corresponds to a small FOV. From Fig. 5.5, we can see that the availability performance of this configuration is very sensitive to changing FOV. These designs are judged to be impractical at this time. The most promising design candidates for evolving the ST-16 appear to lie in two categories: The MT9P031 detector and a small lens (similar to the current design), or the CMV4000 and a large lens. In terms of the FOV, these two families overlap. These results help guide the definition of four reference point designs shown in Table 5.2. The designs in Table 5.2 were selected based on the availability results and a survey of existing commercial lenses. Custom designed optics are feasible, but this work estimates the performance that could be achieved using only primarily commercial components. Contour plots of the availability trade-space (Fig. 5.6) can be used to help guide component selection. These plots illustrate how changing both lens aperture, D, and F # simultaneously affects the availability performance. Design-1 represents the current ST-16 design. Design-2 is similar to the current ST-16, with a slightly faster lens (and wider field of view). Design-3

1.1

1.05

1

0.95 Availability

0.9

0.85

0.8 D = 12.0 mm, h = 4.3 mm D = 50.0 mm, h = 4.3 mm D = 12.0 mm, h = 11.3 mm D = 50.0 mm, h = 11.3 mm 5 10 15 Field of View (deg) 20 25 30

0.75

0.7 0

Figure 5.5: Effect of field of view radius, x , at  = 1  /s.

103

Chapter 5. Optical Trade Studies for Future Star Tracker Development and Design-4, share the same CMOSIS detector and field of view, but demonstrate the effect of differing F# values.
0.05

0.045
0.95
0.99

0.9

0.04 Clear Aperture Diameter (m)

0.035

0.03

0.9

0.95

0.99

0.025

0.999
0.9

0.02

0.015

0.
1 1.1 1.2

0.9

99
1.3 1.4 1.5 F# 1.6

Figure 5.6: Design space for CMV4000 detector ( = 1  /s), contours show availability.

5

1.7

1.8

1.9

2

5.3.1.A

Accuracy Trades

Imaging in the presence of motion spreads the photons from an imaged star over increasing numbers of pixels. This effect generally decreases SNR, but can sometimes have a positive effect when pixel saturation is considered. The accuracy profile for a given hardware configuration is a function of the brightness of the star(s) being imaged. Figure 5.7 shows the dependence between stellar magnitude of an arbitrary star and the associated angular error in the star direction vector. Different mechanisms contribute to the elevated errors for very bright and very dim stars. For bright stars, centroid error is dominated by saturated pixels. For dimmer stars, centroid error becomes dominated by the combined effects of shot noise, read noise and the thresholding used within the ST-16 detection routine. Figure 5.8 shows the relative magnitude and trends of these noise components. Signal quantization is modeled but had a negligible effect on accuracy compared to the other factors. The accuracy profiles of each of the four reference designs shown in Fig. 5.7 are similar. In each profile, there is an obvious region of minimum star vector error corresponding to some 104

5.3 Optical Design Trades
100 Design #1 Design #2 Design #3 Design #4 Accuracy Target

90

80

Angular Vector Error (  rads )

70

60

50

40

30

20

10

0

2

3

4

5 Stellar Magnitude

6

7

8

Figure 5.7: Angular star vector accuracy profiles.
Saturation Shot Noise Read Noise + Thresholding Total Error 0.5

0.4 Centroid Error (pixels)

0.3

0.2

0.1

0

0

0.5

1

1.5

2

2.5 3 Stellar Magnitude

3.5

4

4.5

5

5.5

Figure 5.8: Components of centroid error.

105

Chapter 5. Optical Trade Studies for Future Star Tracker Development optimal stellar magnitude, flanked on either side by regions of increasing star vector error. For brighter stars (decreasing stellar magnitudes), the star vector error is driven by pixel saturation effects. For dimmer stars (increasing stellar magnitudes), the star vector error is driven by thresholding effects. In either case, the increased error is due to a loss of lit pixels (defined as any pixel whos response is greater than a fixed threshold, BT , but not saturated), which ultimately reduces the accuracy of the centroid estimate - This is due to a decrease in the number of intensity measurements used in Eq. (2.1). This suggests that for each hardware design, there exists a stellar magnitude that maximizes the number of pixels below the saturation limit of the detector and above the minimum threshold. The width of this inner region of low angular star vector error is relatively insensitive to hardware changes. Lens or detector changes tend to shift the optimal stellar magnitude towards either brighter or dimmer stars. This can give a net benefit because of the abundance of dim stars in the sky. Although these simulations do not clearly suggest hardware changes they do highlight directions for improving the star centroid estimation.

5.3.2

Integrated Trades

Using the combined general results of both the availability and accuracy trials, I evaluate the performance of our reference designs against our targets. Table 5.3 shows the fraction of the sky that meets the tot  4.8 µrad specification, with at least three stars in view. The first row of the table shows results for the unmodified Reference Designs. Clearly, this performance is inadequate as only a small fraction of the sky meets the accuracy specification. These results should not be surprising, particularly for the designs closest to the current ST-16 optics, namely, Design-1 and Design-2. The next few rows of Table 5.3 explore the impact of specific hypothetical processing improvements. Although I do not specify exactly how these would be implemented; I examine the expected impact to help guide further development. These improvements include:

Improvement in accuracy for overexposed stars - Currently, the centroid accuracy degrades as the pixels forming the PSF become saturated. If this phenomena can be avoided, there will be an improvement in centroid accuracy for bright stars. Tighter focus - Detector noise is one of the primary factors affecting the accuracy of the star centroid. Decreasing the size of the PSF will reduce the contributions of detector noise, improving overall performance. Here I consider halving the PSF radius i.e., p = 2.5 pixels. Multi-head solutions (Table 5.4) - The presented simulations of star availability can easily incorporate the effects of multiple fields of view. Here I evaluate dual head and triple head configurations composed of identical star trackers, mounted orthogonal to the primary 106

5.3 Optical Design Trades
Table 5.3: Sky Fraction Meeting Accuracy Specification (single-head)

Processing Baseline Bright Star Tighter focus pix  0.2 pix  0.1 pix  0.05 pix  0.01

Ref. 1 0.057 0.063 0.081 0.100 0.150 0.262 0.986

Ref 2 0.073 0.081 0.118 0.131 0.186 0.338 0.999

Ref. 3 0.085 0.100 0.124 0.135 0.187 0.348 0.998

Ref. 4 0.141 0.166 0.204 0.217 0.305 0.633 1.000

Table 5.4: Sky Fraction Meeting Accuracy Specification (multi-head)

Processing Baseline Bright Star Tighter focus pix  0.2 pix  0.1 pix  0.05 pix  0.01

Dual Head Ref. 1 Ref 2 0.067 0.091 0.091 0.122 0.143 0.256 0.230 0.331 0.502 0.565 0.697 0.747 1.000 1.000

Triple Ref. 1 0.068 0.094 0.151 0.249 0.542 0.712 1.000

Head Ref. 2 0.093 0.127 0.275 0.361 0.595 0.759 1.000

sensor. For these cases I evaluate the accuracy, from Eq. (5.13), using all the stars across all the FOVs.

The tabulated effects for these cases are cumulative (i.e, each assumes the preceding improvements). Even with all of the changes, the fraction of the sky compliant with our accuracy specification is still low. The different optical design solutions represented by the reference designs show small improvements over the baseline case, but centroid errors remain too high. The final rows of Table 5.3 and Table 5.4 show the effect of artificially capping the centroid error, pix , at different fractions of a pixel. Each of these cases assume the preceding improvements of the first three rows. Performance increases gradually from pix = 0.2 pixels to pix = 0.05 but quite dramatically as we approach pix = 0.01.

Table 5.5 shows the required centroid cap (in pixels) to meet the accuracy specification for 90% of the sky with the four single-head reference designs and two dual-head designs. Ensuring these targets can be met may be quite challenging, particularly at the body-rates implicit in these scenarios, but it seems clear that any compliant design will require significant improvements in pix . 107

Chapter 5. Optical Trade Studies for Future Star Tracker Development
Table 5.5: Required Centroid Caps for 0.90 Sky Fraction Meeting Accuracy Specification

Ref. 1 0.017

Single Head Ref 2 Ref. 3 0.021 0.020

Ref. 4 0.033

Dual Head Ref. 1 Ref 2 0.026 0.032

5.4

Summary and Future Work

This chapter presented a number of performance models useful for the systems design of micro- and nanosatellite star trackers. By explicit inclusion of the effect of body motion during image exposure, these models are able to estimate performance in operational scenarios where the star tracker must maintain an accurate attitude estimate during high rate motion. A specific motivation for this inquiry is to explore possible design evolution of the Sinclair Interplanetary ST-16 star tracker to allow arc-second level accuracy. Examining the variation of availability in response to the design parameters yielded an interesting finding. Whereas at rest, a large aperture can improve availability by allowing the sensor to detect dim stars, the trade-off changes during slewing. At the target body rates, large FOVs are preferred over sensitivity to dim stars. Secondary considerations such as baffle design will ultimately limit the practicality of very large FOV star trackers. Several promising point-designs were selected between x = 6  and x = 10  . These designs combine the baseline MT9P031 with a relatively small lens, or the CMV4000 with a large lens. Little advantage is gained from using a large lens with Aptina detector or a small lens with the CMOSIS. The design trade-offs shown have also illustrated how detection accuracy depends on image characteristics. Making accurate centroid measurements is a necessary precondition for accurate attitude measurements. Large magnitude, unsaturated PSFs need very little help to yield accurate star measurements. Rather, the key challenge of meeting the target requirements is maintaining good accuracy in off-nominal conditions. Changes to optical design parameters can yield minor accuracy improvements, but dramatic changes will require a reevaluation of our star detection routines. Saturated and marginal detections present different image characteristics, but smarter image processing using more explicit models of the smeared PSF may allow more accurate detection. Several solutions were found that meet the accuracy requirement for at least 90% of the sky with each reference design. In all cases, algorithmic and hardware changes are necessary to achieve the required centroid accuracy of 0.015-0.030 pixels, particularly when the PSF is significantly elongated. Centroid accuracy on the order of 0.01 pixels has been demonstrated by [Rufino & Accardo 2003], but it is unclear whether their techniques can be applied under the relatively high target body rate. The most favorable solutions appear to be either a single or dual-head Design-2 sensor. Although I do not have an COTS lens to use for comparison, I expect that such a design would be less massive than a single Design-4 solution. 108

5.4 Summary and Future Work One dimension of systems design that has deliberately been omitted from discussions within this chapter is the relationship between the star tracker and other components of the attitude estimation system. The presence of good quality rate measurements and a recursive estimator (e.g., EKF or similar), could produce attitude estimates that meet the target specification even if individual measurements did not. Such an approach would likely be part of any integrated system. However, by restricting my discussions to deal only with individual measurements, the presented results remain general and do not rely on assumptions about starting conditions. Future work should aim to present a hybrid assessment of accuracy that can balance the conservative predictions of the presented approach with benefits of an online estimator.

109

Chapter 5. Optical Trade Studies for Future Star Tracker Development

110

Chapter 6

Conclusions

Star trackers have traditionally been reserved for larger spacecraft due to their size, power consumption, and cost. Motivated by growing demand from the small satellite community for sub-arcminute attitude accuracy, a new breed of star trackers has been developed specifically for small satellites. These Small Satellite Star Trackers (SSSTs) comply well with small satellite constraints on size, power and cost. However, they are relatively coarse when compared against traditional star trackers. The primary factors limiting the performance of SSSTs are the use of significantly smaller optics and Commercial-Off-The-Shelf (COTS) components. The effects of these factors are: reduced detection performance, reduced star coordinate-vector mapping accuracy, and decreased performance in off-nominal operating conditions. This thesis has presented several strategies to mitigate these factors through the development of offline calibration routines, flight software, and validation tests. The impact of each strategy has been assessed through a series of simulations, laboratory tests and field trials using a prototype of the newly available ST-16 Small Satellite Star Tracker. Based on the knowledge gained from these specific developments, I have also conducted a series of optical trades studies aimed at guiding future development towards a sub-arcsecond SSST. This chapter reviews the contributions of this dissertation, highlighting the improvements in sensor performance, added benefits and also the limitations of the developed work. Following this, I examine promising avenues for further small satellite star tracker performance improvements and conclude with a few final remarks.

6.1

Summary of Contributions and Future Work

The contributions of this thesis seek to improve the accuracy and availability of the SSST attitude solution. To achieve this, I break down the star tracker operational chain and develop specific improvements for each major step. I present four groups of contributions: improving image quality, reducing the star vector error budget, verifying slew tolerance, and optical trades studies for further SSST improvement. This section provides a brief overview of each contribution and makes some specific suggestions for future work. 111

Chapter 6. Conclusions

6.1.1

Improving Image Quality

The detection performance of a star tracker is driven by the size and shape of the PSF of the sensor optics. Minimizing the size of the PSF would ideally improve the SNR of star images. However, due to pixel saturation and sampling effects, there is a trade-off between minimizing noise contribution and improving localization accuracy. Chapter 2 describes the developed target-based focusing procedure that utilizes the MTF of the sensor optics to measure the current position and orientation of the image detector. This procedure enables precise control over the focus of the sensor allowing one to achieve desired PSF sizes that maximize detector performance. Results show that the model of the PSF you use to determine MTF is important. After testing three different PSF shapes, I found the symmetric Gaussian produces the most consistent results. Using this model, the developed focusing procedure was able to determine the focus error with an accuracy of 0.055mm. This provides control over the PSF size down to a size of approximately 20 pixels, which is useful for coarse focusing. Further refinement is required before this method can be used to finely focus star tracker flight models. The most attractive avenues for future improvement of the developed focusing procedure are higher fidelity models of the sensor PSF. Incorporating even the most basic optical aberrations will improve the performance of the developed focusing routine in the neighborhood of desired PSF sizes.

6.1.2

Reducing the Star Vector Error Budget

The accuracy performance of a star tracker is directly dependent on the accuracy with which detected stars can be converted to incoming star vectors. This transformation is based on the knowledge of the intrinsic sensor parameters and the correction of any hardware induced distortions. This dissertation makes two significant contributions to reducing the error in star vector formation: an offline camera model calibration procedure, and flight software to compensate for the effects of the Electronic Rolling Shutter (ERS).

6.1.2.A

Camera Model Calibration

The accuracy performance of a star tracker is directly dependent on the accuracy with which imaged stars can be converted to incoming star vectors. This transformation is based on knowledge of various intrinsic sensor parameters which cannot practically be measured individually. I have developed a lab-based calibration procedure that determines these parameters using a motorized gimbal and collimated star source. The procedure is based on analytical models that describe i) the transformation between the star tracker image detector and the sensor optics, and ii) the location of the simulated 112

6.1 Summary of Contributions and Future Work star source with respect to the star tracker, based on the commanded gimbal orientation. I estimate the sensor geometry through a minimization guided by the error between our modeled star position, based on the known orientation of the platform, and the measured star position on the detector. The residual error in star vector formulation is approximately 3.5 × 10-5 radians which equates to approximately 0.2 pixels on the image detector. Although this is sufficient for current performance targets of the ST-16 star tracker, this process must be refined to achieve accuracy performance better than 1 arcsecond.

6.1.2.B

Electronic Rolling Shutter (ERS) Compensation

When evaluating detectors for new star tracker designs, engineers are faced with a potentially troublesome trade-off: limit the detector choices to those with simultaneous row exposure; accept the added complexity of mechanical shutters; or restrict the operating regime to the very small angular velocities. Section 3.2 develops a means of removing ERS distortions without the need for additional instruments. This section develops a series of algorithms that compensate for the effects of the ERS. These corrections are based on developed analytical models that account for the effects of ERS distortion on star centroid locations and estimate slew rate of the sensor. I have verified these routines through simulation and laboratory tests that involve embedded implementation onboard the ST-16 star tracker. Simulation results show the residual angular velocity measurement errors are dominated by centroid noise ( 0.07 , 1 -  ). Laboratory results shows that the developed ERS corrections are able to preserve accuracy scene geometry with body rates of up to 3 /s. The developed algorithms have been deployed on the commercial versions of the ST-16. Nonetheless, ongoing studies aim to improve the algorithm performance and better characterize the effectiveness of the corrections. In particular, future work is aimed at better understanding the cross-axis bias effect and expanding algorithm testing to include night-sky observations. Although some aspects of our algorithm development have been shaped by the specific operating concept of the ST-16 star tracker, I feel that developed approach to ERS compensation is applicable to a wide array of sensor designs.

6.1.3

Verifying Slew Tolerance

Sensor slew spreads starlight over a larger number of pixels when compared with static imaging conditions. This reduces the SNR of the imaged star and impairs centroid accuracy. For dim stars, this can reduce the probability of detection. Each star tracker claims to be tolerant of some amount of sensor slew, however, it is difficult to measure the exact impact this angular motion has on sensor performance. Chapter 4 develops several approaches to measure the effect of slew rate on sensor performance from the ground. 113

Chapter 6. Conclusions The main objective of this work was to model the effect of slew rate on star tracker performance. This was achieved in three basic steps. First I formulated an analytical model to describe the effects of slew rate on the PSF shape and intensity distribution of a star image. Second, I employed this model to describe detection performance as a function of slew rate. Lastly, I used this relationship to predict star tracker availability at slew rates of 0 - 3 /s. As a final contribution, I examined the concept of along-track dynamic availability. Unsurprisingly, these results can vary quite substantially from calculated spatial dynamic availability performance. However, the latter can serve as a first-cut approximation. The calculation of along-track dynamic availability requires knowledge of mission details and the relationship between tolerance slew rate and detectable stellar magnitudes. Using the techniques presented in this study, we can achieve the latter part of this solution. If one can then attain even a simplified understanding of the expected mission dynamics, we can being to form bounds on the availability performance of the star tracker.

6.1.4

Evolving a Sub-Arcsecond Small Satellite Star Tracker

Many Earth-observing mission rely on spacecraft body motion to track ground targets. These scenarios lead to requirements for arc-second accuracy attitude estimates during body motion rates of up to 1  /s. Achieving these performance targets with SSST presents a challenge. Chapter 5 presents a number of performance models useful for the design of micro- and nanosatellite star trackers. By explicit inclusion of the effect of body motion during image exposure, I am able to estimate performance in operational scenarios where the star tracker must maintain an accurate attitude estimate during high rate motion. Starting from the baseline optical design of the ST-16, I have explored strategies for improving the sensor accuracy to the sub-arcsecond range. This study highlights distinctive features of the trade-space relative to more conventional star tracker designs and is valuable for prioritizing further SSST development.

6.2

The Final Word

In addition to typical challenges faced by all star trackers, SSSTs suffer from decreased performance caused by small optical systems and the use of COTS components. This thesis has demonstrated that these challenges can be successfully mitigated through a combination of offline calibration routines, online algorithms and integrated tests. This multifaceted approach to sensor development has aided the rapid development of the ST-16 star tracker which appears to be having initial success in the marketplace. Although the procedures and algorithms described in this thesis were developed alongside the ST-16, they are applicable to other star trackers. 114

References
[Accardo & Rufino 2001] Accardo, D., & Rufino, G., "A procedure for three-dimensional angular velocity determination using a star sensor in high-rate rotation modes," Acta Astronautica, Vol. 48, No. 5-12, 2001, Pages: 311­320. cited By (since 1996)9. [Ait-Aider et al. 2007] Ait-Aider, O., Bartoli, A., & Andreff, N., "Kinematics from lines in a single rolling shutter image," . 2007. [Born et al. 2000] Born, M., Wolf, E., Bhatia, A.B., Clemmow, P.C., Gabor, D., Stokes, A.R., Taylor, A.M., Wayman, P.A., & Wilcock, W.L., Principles of Optics: Electromagnetic Theory of Propagation, Interference and Diffraction of Light, Cambridge University Press, 2000. [Dzamba & Enright 2013] Dzamba, T., & Enright, J., "Optical trades for evolving a small arcsecond star tracker," Aerospace Conference, 2013 IEEE, 2013, Pages: 1­9. [Dzamba et al. 2010] Dzamba, T., Enright, J., McVittie, G., Sinclair, D., & Grant, C.C., "Commissioning the S3S nanosatellite star tracker," . Vol. 6, 2010, Pages: 4635­ 4649. [Enright & Dzamba 2012] Enright, John, & Dzamba, Thomas. "Rolling Shutter Compensation for Star Trackers," AIAA Guidance, Navigation, and Control Conference, Guidance, Navigation, and Control and Co-located Conferences. American Institute of Aeronautics and Astronautics, August, 2012. [Enright et al. 2010] Enright, John, Sinclair, Doug, Grant, C. Cordell, McVittie, Geoff, & Dzamba, Tom, "Towards Star Tracker Only Attitude Estimation," 24th Annual AIAA/USU Conference on Small Satellites, 2010. [Enright et al. 2012] Enright, John, Sinclair, Doug, & Dzamba, Tom, "The Things You Cant Ignore: Evolving a Sub-Arcsecond Star Tracker," Proc. of the 26th AIAA/USU Conference on Small SatellitesProc. of the 24th AIAA/USU Conference on Small Satellites, SSC12-X-7, Vol. SSC12-X-7, Logan, Utah, August, 2012. [Groen et al. 1985] Groen, Frans C. A., Young, Ian T., & Ligthart, Guido, "A comparison of different focus functions for use in autofocus algorithms," Cytometry, Vol. 6, No. 2, 1985, Pages: 81­91. [Hancock et al. 2001] Hancock, Bruce R., Stirbl, Robert C., Cunningham, Thomas J., Pain, Bedabrata, Wrigley, Christopher J., & Ringold, Peter G., "CMOS active pixel sensor specific performance effects on star tracker/imager position accuracy," May, 2001, Pages: 43­53. [Hoffleit & Warren Jr 1991] Hoffleit, E. D., & Warren Jr, W. H., "Yale Bright Star Catalog," Yale University, 1991. 115

REFERENCES [Holst & Lomheim 2007] Holst, Gerald C., & Lomheim, Terrence S., CMOS/CCD Sensors and Camera Systems, JCD Publishing, 2932 Cove Trail, Winter Park, FL, USA, 2007, pp. 147-163,222-277,305-336. [Hopkins 1955] Hopkins, H. H., "The Frequency Response of a Defocused Optical System," Proceedings of the Royal Society of London. Series A. Mathematical and Physical Sciences, Vol. 231, No. 1184, 1955, Pages: 91­103. [Keat 1977] Keat, J. E. "Analysis of Least-Squares Attitude Determination Routine DOAOP," . Rapport technique CSC/TM- 77/6034, Computer Sciences Coporation, February, 1977. [Krotkov 1987] Krotkov, Eric, "Focusing," Internation Journal of Computer Vision, Vol. 1, 1987, Pages: 223­237. [Liang et al. 2005] Liang, C.-K., Peng, Y.-C., & Chen, H., "Rolling shutter distortion correction," . Vol. 5960, 2005, Pages: 1315­1322. [Liang et al. 2008] Liang, C. K, Chang, L. W, & Chen, H. H., "Analysis and compensation of rolling shutter effect," IEEE Transactions on Image Processing, Vol. 17, No. 8, 2008, Pages: 1323­1330. [Liebe et al. 2002] Liebe, C.C., Alkalai, L., Domingo, G., Hancock, B., Hunter, D., Mellstrom, J., Ruiz, I., Sepulveda, C., & Pain, B., "Micro APS based star tracker," Aerospace Conference Proceedings, 2002. IEEE, Vol. 5, 2002, Pages: 5­2285 ­ 5­2299 vol.5. [Liebe et al. 2004] Liebe, C.C., Gromov, K., & Meller, D.M., "Toward a Stellar Gyroscope for Spacecraft Attitude Determination," Journal of Guidance, Control, and Dynamics, Vol. 27, No. 1, 2004, Pages: 91­99. [Liebe 1995] Liebe, Carl Christian, "Star trackers for attitude determination," IEEE Aerospace and Electronic Systems Magazine, Vol. 10, No. 6, 1995, Pages: 10­16. [Liebe 2002] Liebe, C.C., "Accuracy performance of star trackers - A tutorial," IEEE Transactions on Aerospace and Electronic Systems, Vol. 38, No. 2, 2002, Pages: 587­599. [Loebich et al. 2007] Loebich, C., Wueller, D., Klingen, B., & Jaeger, A., "Digital camera resolution measurement using sinusoidal siemens stars," Proceedings of SPIE - The International Society for Optical Engineering, Vol. 6502, 2007. [Mahajan 1998a] Mahajan, V.N., Optical Imaging and Aberrations: Ray Geometrical Optics, Optical imaging and aberrations, SPIE Optical Engineering Press, 1998. [Mahajan 1998b] Mahajan, V.N., Optical Imaging and Aberrations: Wave Diffraction Optics, SPIE Press monograph, SPIE Optical Engineering Press, 1998. [Malacara 2007] Malacara, Daniel, editeur, Optical Shop Testing, John Wiley and Sons, 3 ´ edition, 2007, pp. 398-434. 116

REFERENCES [Marantis et al. 2009] Marantis, L., Witte, E. De., & Brennan, P.V., "Comparison of various Spherical Antenna Array Element Distributions," 3rd European Conference on Antennas and Propagation, 2009. [Mortari 2000] Mortari, D., "Second Estimator of the Optimal Quaternion," Journal of Guidance, Control, and Dynamics, Vol. 23, No. 5, 2000, Pages: 885­888. [Myers et al. 2001] Myers, J. R., Sande, C. B., Miller, A. C., Warren, W. H., & Tracewell, D. A., "SKY2000 Catalog, Version 4 (Myers+ 2002)," VizieR Online Data Catalog, Vol. 5109, September, 2001, Page: 0. [Nicklin et al. 2006] Nicklin, S., Fisher, R., & Middleton, R., "Rolling shutter image compensation," RoboCup 2006: Robot Soccer World Cup X, 2006, Pages: 402­409. [Pentland 1987] Pentland, Alex Paul, "A New Sensor for Depth of Field," IEEE Transactions on Pattern Analysis and Machine Intelligence, Vol. 9, No. 4, 1987, Pages: 523­531. [Reed 1993] Reed, B. Cameron, "Education Notes/Rubrique Pdagogique- Stellar Magnitudes and Photon Fluxes," Journal of the Royal Astronomical Society of Canada, Vol. 87, April, 1993, Page: 123. [Rogers et al. 2009] Rogers, Gabe D., Schwinger, Marsha R., Kaidy, James T., Strikwerda, Thomas E., Casini, Roberto, Landi, Andrea, Bettarini, Rossano, & Lorenzini, Stefano, "Autonomous star tracker performance," Acta Astronautica, Vol. 65, No. 12, July, 2009, Pages: 61­74. [Rufino & Accardo 2003] Rufino, G., & Accardo, D., "Enhancement of the centroiding algorithm for star tracker measure refinement," Acta Astronautica, Vol. 53, No. 2, 2003, Pages: 135­147. [Shuster & Oh 1981] Shuster, Malcolm David, & Oh, S. D., "Three-axis attitude determination from vector observations," Journal of Guidance, Control, and Dynamics, Vol. 4, No. 1, 1981, Pages: 70­77. [Spratling & Mortari 2009] Spratling, B.B., & Mortari, D., "A survey on star identification algorithms," Algorithms, Vol. 2, No. 1, 2009, Pages: 93­107. [Sturm et al. 2010] Sturm, P., Ramalingam, S., Tardif, J.-P., Gasparini, S., & Barreto, J., "Camera models and fundamental concepts used in geometric computer vision," Foundations and Trends in Computer Graphics and Vision, Vol. 6, No. 1-2, 2010, Pages: 1­183. cited By (since 1996)16. [Subbarao & Choi 1993] Subbarao, Murall, & Choi, Tae, "Focusing Techniuqes," Optical Engineering, Vol. 32, No. 11, 1993, Pages: 2824­2836. [van Bezooijen 2003] van Bezooijen, Roelof W. H., "SIRTF autonomous star tracker," March, 2003, Pages: 108­121. 117

REFERENCES [Wahba 1965] Wahba, Grace, "A Least Squares Estimate of Satellite Attitude," SIAM Review, Vol. 7, No. 3, 1965, Page: 409. [Wang et al. 2008] Wang, Jianhua, Shi, Fanhuai, Zhang, Jing, & Liu, Yuncai, "A new calibration model of camera lens distortion," Pattern Recognition, Vol. 41, No. 2, February, 2008, Pages: 607­615. [Weng et al. 1992] Weng, Juyang, Cohen, Paul, & Herniou, Marc, "Camera calibration with distortion models and accuracy evaluation," IEEE Transactions on Pattern Analysis and Machine Intelligence, Vol. 14, No. 10, 1992, Pages: 965­980. cited By (since 1996)819. [Wertz et al. 2011] Wertz, J.R., Everett, D.F., & Puschell, J.J., Space Mission Engineering: The New SMAD, Space technology library, Microcosm Press, 2011.

118


