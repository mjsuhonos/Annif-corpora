Pricing and Hedging Tools for Spread Option Contracts
by Ekaterina Klyueva Bachelor of Applied Science in Engineering Science, University of Toronto, 2012 A thesis presented to Ryerson University

in partial fulfillment of the requirements for the degree of Masters of Applied Science in the Program of Applied Mathematics Toronto, Ontario, Canada, 2014 c Ekaterina Klyueva 2014

"65)03h4%&$-"3"5*0/'03&-&$530/*$46#.*44*0/0'"5)&4*4

*IFSFCZEFDMBSFUIBU*BNUIFTPMFBVUIPSPGUIJTUIFTJT5IJTJTBUSVFDPQZPGUIFUIFTJT JODMVEJOHBOZSFRVJSFEGJOBMSFWJTJPOTBTBDDFQUFECZNZFYBNJOFST *BVUIPSJ[F3ZFSTPO6OJWFSTJUZUPMFOEUIJTUIFTJTUPPUIFSJOTUJUVUJPOTPSJOEJWJEVBMTGPSUIF QVSQPTFPGTDIPMBSMZSFTFBSDI. *GVSUIFSBVUIPSJ[F3ZFSTPO6OJWFSTJUZUPSFQSPEVDFUIJTUIFTJTCZQIPUPDPQZJOHPSCZPUIFS NFBOTJOUPUBMPSJOQBSUBUUIFSFRVFTUPGPUIFSJOTUJUVUJPOTPS JOEJWJEVBMTGPSUIFQVSQPTFPGTDIPMBSMZSFTFBSDI *VOEFSTUBOEUIBUNZUIFTJTNBZCFNBEFFMFDUSPOJDBMMZBWBJMBCMFUPUIFQVCMJD

ii

Pricing and Hedging Tools for Spread Option Contracts Masters of Applied Science 2014 Ekaterina Klyueva Applied Mathematics Ryerson University

Abstract
This thesis examines the problem of pricing and hedging Spread options under market models with jumps driven by a Compound Poisson Process. Extending the work of Deng, Li and Zhou we derive the price approximation for Spread options in jump-diusion framework. We find that the proposed model accurately approximates option prices and exhibits reasonable behavior when tested for sensitivity to the model parameters. Applying the method of Lamberton and Lapeyre, we minimize the squared error between the Spread option price and the hedge portfolio to arrive to an optimal hedging strategy for discontinuous underlying price modes. Additionally, we propose an alternative average Delta-hedging hedging strategy that is derived by conditioning the underlying price processes on the number of jumps and summing over all the possible jump combinations; such an approach allows us to revert to a hedging problem in a Black-Scholes framework. Although the average Delta-hedging strategy oers a significantly simpler approach to hedge Spread options, we conclude that the former strategy performs better by examJJJ

ining the Profit and Loss Probability Density Function of the two competing strategies. Finally, we oer a model parameter calibration algorithm and test its performance using the transitional Probability Density Functions.

v

Acknowledgements
My gratitude and thanks go to my supervisor, Dr. Pablo Olivares who has been a great mentor to me and provided me with a superb guidance and support throughout my work; to my family who have always supported me and continuously pushed me for more and kept me motivated throughout my work; and to Farrokh, who has always listened to my ideas and made all the possible eort to understand them and give me a very valuable feedback, criticizing my ideas when necessary - it was of the greatest help to me; Farrokh worked in parallel with me on his thesis, which was a very strong motivation factor for me.

vi

Dedication
This work is dedicated to my grandfather, who has always been my role model; he has been a great, deeply respected man and an outstanding scientist and would have been proud to know that I am defending my Master's thesis.

WJJ

Contents
Declaration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Abstract . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Dedication . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . List of Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . List of Figures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ii JJJ vii ix xiii xi xv xii

xv List of Appendices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xvii
1 Introduction 2 Multi-Dimensional Option Contracts 2.1 Multi-Dimensional Options . . . . . . . . . . . . . . . . . . . . . . . . . . 2.1.1 2.1.2 2.1.3 Spread Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . Basket Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . Rainbow Options . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 7 8 8 10 10 11 11 13 17 25 25 30 32

3 Option Pricing in Black-Scholes Framework 3.1 3.2 3.3 Black-Scholes Framework Setup . . . . . . . . . . . . . . . . . . . . . . . Black-Scholes Model for One-Dimensional Contracts and Their Hedging . Black-Scholes Model for Two-Dimensional Contracts and Their Hedging .

4 Option Pricing In a Jump-Diusion Framework 4.1 4.2 4.3 Jump-Diusion Process Setup . . . . . . . . . . . . . . . . . . . . . . . . One-Dimensional Option Pricing and Their Hedging . . . . . . . . . . . . Two-Dimensional Option Pricing and Their Hedging . . . . . . . . . . . JY

5 Pricing and Hedging Implementation 5.1 Option Price Computations and Monte-Carlo Simulations . 5.2 Parameter Dependencies . . . . . . . . . . . . . . . . . . . 5.3 Parameter Calibration . . . . . . . . . . . . . . . . . . . . 5.4 Hedging Evaluation Using Simulation . . . . . . . . . . . . 6 Conclusions References

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

45 45 49 58 63 69 85

Y

List of Tables
5.1 5.2 5.3 5.4 5.5 5.6 5.7 5.8 5.9 5.10 5.11 5.12 5.13 5.14 5.15 5.16 5.17 Parameters used in Monte-Carlo simulation . . . . . . . . . . . . . . . . Simulated time t = 0 prices of a Call option on the first asset . . . . . . . Simulated time t = 0 prices of a Call option on the second asset . . . . . Simulated time t = 0 prices of a Spread option . . . . . . . . . . . . . . . Option price and computational e ciency in the Monte-Carlo method . . Option price and computational e ciency comparison for the proposed option pricing formulae . . . . . . . . . . . . . . . . . . . . . . . . . . . . Parameters used in the reference model in the parameter dependancy experiments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . GBM correlation and the corresponding overall correlation of the two underlying assets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Parameters used for a numerical experiment of Deng, Li and Zhou option pricing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Calibrated and true model parameters for the European Call options . . Calibrated and true model parameters for the bivariate Spread option . . Confidence Intervals for the parameters calibrated for Asset 1 . . . . . . Calibrated and true model parameters . . . . . . . . . . . . . . . . . . . Parameters used for Delta-hedging experiment for a Call option in BlackScholes framework . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Parameters used for Delta-Hedging experiment for a Call option in jumpdiusion framework . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Parameters used in the hedging experiments for bivariate Spread options 95% Value-at-Risk of various hedging strategies . . . . . . . . . . . . . . 47 48 48 48 49 49 50 56 56 61 62 62 63 65 66 67 67

YJ

List of Figures
5.1 5.2 5.3 5.4 5.5 5.6 5.7 5.8 5.9 European Call and bivariate Spread option dependencies on the time to maturity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Bivariate Spread option dependency on the time to maturity in jumpdiusion framework . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . European univariate and bivariate Spread option price dependencies on the GBM volatility component . . . . . . . . . . . . . . . . . . . . . . . . European univariate and bivariate Spread option price dependencies on the Strike price . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . European univariate and bivariate Spread option price dependencies on the Risk-Free Rate . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . European bivariate Spread option price dependencies on the correlation . European univariate and bivariate Spread option price dependencies on the jump size and jump volatility . . . . . . . . . . . . . . . . . . . . . . Bivariate Spread option price dependencies on various parameters; Deng, Li and Zhou pricing formula . . . . . . . . . . . . . . . . . . . . . . . . . Minimization problem objective function plotted for a varying set of parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

51 52 53 54 54 55 56 57 60 61 62 64

5.10 Transition Probability Density Function for the calibrated set of parameters in the one-dimensional parameter calibration problem; asset 1 . . . . 5.11 Transition Probability Density Function for the calibrated set of parameters in the one-dimensional parameter calibration problem; asset 2 . . . . 5.12 P&L PDF of Delta-hedging strategy for a European Call option in BlackScholes framework . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . YJJ

5.13 P&L PDF of Delta-hedging strategy for a European Call option in jumpdiusion framework . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.14 P&L PDF of average Delta-hedging strategy for a bivariate Spread option in jump-diusion framework . . . . . . . . . . . . . . . . . . . . . . . . . 5.15 P&L PDF of the extended Delta-hedging strategy for a bivariate Spread option in jump-diusion framework . . . . . . . . . . . . . . . . . . . . .

65 68 68

YJJJ

List of Appendices
1 MATLAB Codes 1.1 Monte-Carlo Simulation . . . . . . . . . . . . . . . . . . . . . . . . . . 1.2 Univariate Call Option Pricing Formula in Jump-Diusion Framework . 1.3 Bivariate Spread Option Pricing Formula in Jump-Diusion Framework 1.4 Hedging in Jump-Diusion Framework . . . . . . . . . . . . . . . . . . 71 71 76 77 81

. . . .

YW

Chapter 1 Introduction
European options are a special class of derivative securities, that give the holder of an option contract a right, but not an obligation to execute a trade and receive a payo at a specified time, called an option Maturity[20]. The payo depends on the underlying asset or a group of assets that an option contract is written on and contract-specific terms (such as strike price, and a payo function). Option contracts range from the most basic Call and Put options on one underlying asset to multi-dimensional contracts, such as Basket or Rainbow options that take a group of assets as their underlying. Option contracts have many practical applications and are actively used for trading and hedging purposes: these instruments can be used to speculate on or to hedge against the future price movements of their underlying assets. As a result, an investor desires to know how to price and hedge a European option contract. The goal of our work is to combine and extend the option pricing, hedging and parameter calibration strategies currently available in the scientific literature to price and hedge the bivariate Spread options in a jump-diusion framework, as well as to oer a parameter calibration strategy for the proposed model. Black and Scholes[4] introduced a revolutionary option pricing formula, that is still widely used nowadays. The original Black-Scholes pricing formula for Call and Put options written on one asset was derived under a simplistic assumption of the underlying assets following the Geometric Brownian Motion process. Although being theoretically and computationally easy, the Black-Scholes model failed to capture the three important features of the financial markets: (1) the asymmetric leptokurtic features of return 1

Chapter 1 distributions; (2) implied volatility smiles and smirks; and (3) large random fluctuations in asset prices. Merton[26] extended the Black-Scholes pricing formula to allow for the jumps in the underlying asset prices which allowed to capture large swings in the asset prices. Since the works of Black, Scholes and Merton, a number of further extensions to the option prices were introduced. Following the practical observation of implied volatility smiles and smirks, Heston[16] extended the Black-Scholes framework by introducing stochastic volatility that follows a random process; Bates[11] presented a model including both stochastic volatility and jumps. Nowadays, the option market is not limited to only univariate Call and Put options; there is a wide range of multi-dimensional options available to an investor, such as Cracks, Sparks, Spikes, Rainbow options, etc. Such option contracts find application in the industry as they represent a convenient tool for companies to hedge against the uncertainty in the future prices and price spreads, and therefore, to protect their operational margins. Being the simplest case of multi-dimensional options, Spread options gained the most popularity in the academic literature. When pricing the European Call and Put options, Black and Scholes derive and solve a partial dierential equation; although the equation derivation is easily expandable to two dimensions, the two-dimensional PDE does not have a closed-form solution. Alvarez, Escobar and Olivares[1] use the Taylor expansion to price multidimensional options on underlyings with jumps and stochastic covariance terms to allow a greater flexibility in modeling both shorter and longer term smiles. Deng, Li and Zhou[22] propose the closed-form approximation to two dimensional option prices in Black-Scholes framework by first deriving an integral pricing formula and then providing a discrete Taylor approximation to it; they later extend their work to higher dimensions[23]. While working well for some sets of parameters, Deng, Li and Zhou's model fails to produce feasible results across a range of the underlying volatility and correlation combinations due to the option price approximation being derived in the vicinity of a reference point with the model strength declining with increasing distance from the point. Spread options provide a unique challenge as analytical solutions are unavailable for most market models, and the researchers are forced to rely on numerical methods to derive multi-dimensional option price approximations. While using Taylor expansion method for approximation might adversely impact the model accuracy, Fast Fourier Transform oers an alternative approximation method. Fourier transform methods, as outlined by 2

Chapter 1 Eberlein, Glau and Papapantoleon[12] provide an e cient method for pricing options under a variety of market models. Dempster and Hong[10] and Hurd and Zhou[19] price Spread options by utilizing the Fast Fourier Transform (FFT) pioneered by Carr and Madan[7]. The advantage of the FFT method is in its applicability to jump-diusion set-ups in multiple dimensions. Hurd and Zhou[19], as well as Cane and Olivares[5] apply the FFT for pricing Spread options under Merton processes. Additional Spread option pricing approaches are proposed by Carmona and Durrleman[6], and Hikspoors and Jaimungal[17]. Although being an e cient method, FFT has drawbacks such as difficulty dealing with time-dependent parameters and challenges in developing computer algorithms for FFT computations, as mentioned in Barua, Thulasiram and Thulasiraman[2]; additionally, FFT method for option pricing is di cult to implement in higher dimensions. In order to reduce the risks associated with the movements of the underlying assets, investors utilize hedging strategies. In the Black-Scholes set-up, delta hedging, in theory, allows to completely eliminate the risks associated with the underlying movements; such a strategy is referred to as "perfect hedging". However, as one moves to more complicated theoretical frameworks, such as jump-diusion, perfect hedging is no longer available due to the market incompleteness. Moreover, the complexity of the Spread option price approximations poses challenges in parameter calibration. Together, the hedging and parameter calibration problems present the additional challenges in option pricing. Lamberton and Lapeyre[21] employ sophisticated statistical methods to derive an integral-form delta hedging strategy for univariate options under Merton models. Carr and Wu[8] and He et al.[15] propose the semi-static hedging using a finite set of shorterterm options; such an approach allows them to simplify the strategy and decrease the hedging error. Similarly, Cont, Tankov and Voltchkova[9] use the shorter maturity options in quadratic hedging, showing that such an approach oers an advantage over the strategies relying solely on the underlying asset. Although oering an advantage, the aforementioned strategies require a larger amount of data to be readily available to the investor; additionally, these strategies require a larger number of trades to be executed that lead to high transaction costs. An investor should calibrate the option parameters in order to build an e cient hedge. Due to the presence of the jump parameter for option prices in jump-diusion framework, the calibration problem is ill-posed. He et al.[15] investigate the specific characteristics 3

Chapter 1 of the ill-posedness of the calibration problem for a univariate jump-diusion model with a local volatility function and evaluate the impact of the calibration error on pricing and hedging. They show that the problem becomes well-posed after imposing a condition on the parameters governing the distribution of the jump amplitude. Moreover, they conclude that in spite of the ill-posedness of the calibration problem, the model can be calibrated to accurately price and hedge options. The ill-posedness property of the parameter calibration problem means that one cannot arrive to a unique solution, Maribu, Galli and Armstrong[24] look for methods to find a unique minimizing set of parameters and propose a three-step procedure to fit the parameters to the Spark Spread option price function; they employ the least-squares regression and a variogram and conclude that most of the model parameters can be calibrated well using this procedure. The contributions of our work include: 1. Proposal of the pricing method for bivariate Spread options in the jump-diusion framework. 2. Extension to two dimensions of the hedging strategy proposed by Lamberton and Lapeyre[21] for univariate options in the jump-diusion framework. 3. Proposal of the parameter calibration approach for bivariate Spread option pricing and hedging in the jump-diusion framework. 4. Sensitivity analysis of the proposed bivariate Spread option prices in the jumpdiusion framework. To achieve the goal of our work, we refer to the work of Deng, Li and Zhou[22] to derive bivariate Spread option prices under discontinuous jump processes; we find that the proposed model accurately approximates option prices and exhibits reasonable behavior when tested for sensitivity to the model parameters. Our conclusions are based on the extensive numerical tests. Furthermore, we propose a three-step process to iteratively callibrate unique parameters in the derived Spread option pricing formula and test its performance using the transitional Probability Density Functions. To develop an optimal hedging strategy for the Spread options in the jump-diusion setting, we extend the work of Lamberton and Lapeyre[21] that minimizes the squared error between the Spread option price and the hedge portfolio. Additionally, we oer an alternative hedging 4

Chapter 1 strategy, that employs the average Delta-hedging to oer a simpler and faster hedging strategy. Although the average Delta-hedging strategy oers a significantly simpler approach to hedge Spread options, we conclude that the former strategy performs better by examining the Profit and Loss Probability Density Function of the two competing strategies. The thesis consists of five chapters. Chapter 2 gives an overview of various multidimensional options, their characteristics and applications. Chapter 3 discusses univariate and bivariate option pricing and hedging in the Black-Scholes framework. Chapter 4 derives the two-dimensional option pricing in the jump-diusion setting, as well as oers two applicable hedging strategies. Chapter 5 concludes our work with the discussion of the parameter calibration approach, model performance and the presentation of various numerical experiments.

5

Chapter 2 Multi-Dimensional Option Contracts
Options are a special class of derivative securities, that give the holder of an option contract a right, but not an obligation to execute a trade and receive a payo at a specified time, called an option Maturity[18]. The payo depends on the underlying asset or a group of assets that an option contract is written on and contract-specific terms (such as strike price, and a payo function). Option contracts range from the most basic Call and Put options on one underlying asset to the multi-dimensional contracts, such as basket or rainbow options that take a group of assets as their underlying. Option contracts have many practical applications and are actively used by various companies in order to hedge against the uncertainty in the future prices, as well as many institutional and individual investors to speculate on the future movements of assets or hedge their outstanding positions. For example, a inery company that uses crude oil to produce its derivative products would purchase a Crack option to protect itself from fluctuations in the crude oil prices and the prices of its derivative products. In our work we are primarily concerned with pricing bivariate Spread options; however, our model is applicable to pricing any two-dimensional option contracts and can be further extended to pricing the option contracts in higher dimensions. Chapter 2 provides an overview of the various option contracts to which our work is applicable. 7

2.1. Multi-Dimensional Options

Chapter 2

2.1
2.1.1

Multi-Dimensional Options
Spread Options

Spread options are derivative instruments on two or more underlying assets. Their payo (i ) at the time of maturity, denoted as h(xt , T ) 2 C 1,2 [0, T )  (0, 1), i = 1, .., n, depends on the dierence in the spot prices of two (or more) underlying assets as well as on the specified strike price, K [27]: h ( St , S t , T ) = ( S T
(1) (2) (1)

ST

(2)

K )+

Spread options are ubiquitous in the financial markets, being traded on equity, fixed income, foreign exchange, commodities, and energy markets. Although Spread options are popular instruments and some options can be purchased on large exchanges, the majority of Spread options are traded Over-the-Counter(OTC-securities): Commodity Spreads There is a wide range of spread options oered in the commodity markets: Location Spreads that are based on the dierence between the prices of the same commodity at two dierent locations; Calendar Spreads that are based on the dierence of the same commodity in two points in time; Processing Spread that are based on the dierence of the prices of inputs to, and outputs from, a production process; or Quality Spreads that are based on the dierence between the prices of dierent grades of the same commodity[5]. Crack Spread Options The only two types of the spread options oered on a large exchange, the New York Mercantile Exchange (NYMEX), are energy market Spreads between the heating oil/crude oil and gasoline/ heating oil, called Crack Spread options. Crack Spread options are used by oil refineries that utilize crude oil to produce gasoline, heating oil, or other refined petroleum products. The options are purchased in order to hedge against sharp fluctuations in refining margins. A Crack spread allows a simultaneous purchase or sale of crude oil against sale or purchase of a refined petroleum product[20]. 1:1 Gasoline Crack Spread is constructed using one contract of crude oil and one contract of unleaded gasoline, with a payo function given as 8

Chapter 2 h ( St , S t , T ) = ( ST
(1) (2) (1) (2) (1)

2.1. Multi-Dimensional Options ST
(2)

K )+ ,

where St and St are time t 0 futures prices of crude oil and unleaded gasoline respectively. Since crude oil prices are usually quoted in dollars per barrel, while unleaded gasoline prices are quoted in dollars per gallon, a simple conversion needs to be applied to the data using the fact that there are 42 gallons per barrel[20]. 1:1 Heating Oil Crack Spread is constructed using one contract of crude oil and one contract of heated oil, with a payo function given as h ( St , S t , T ) = ( ST
(1) (2) (1) (2) (1)

ST

(2)

K )+ ,

where St and St are time t 0 futures prices of crude oil and heating oil respectively. Similar to the gasoline crack spread, conversion needs to be applied to the heating oil prices, using the fact that there are 42 gallons per barrel[20]. 6:3:2:1 Crack Spread is an example of higher dimensional spread contract that is constructed using six barrels of crude oil, three contracts of gasoline, two contracts of heating oil and one contract of residual oil. Spark Spread Options Spark Spread is the primary cross-commodity transaction in the electricity market. It is used to hedge against the fluctuations in costs of converting specific fuel (coal, natural gas, or petroleum, etc.) into electricity at a specific facility [1]. The general definition of the most popular spark spreads underlying function is St = StE rh StG ,

where StE is a price of a futures contract on electricity at time t and StG is a price of a futures contract on natural gas at time t, while rh is heat rate, or the e ciency factor of a power plant. Electricity future is often expressed in $/MWh (US dollar per Mega Watt hour); in order to match it, the price of natural gas future, expressed in $/MMBtu, is multiplied by heat rate, expressed in Btu/KWh and is divided by 1, 000 [1]. Currency Spreads Currency Spread options in foreign exchange markets often involve interest or swap rates in dierent countries with closely related economies (for example, French-German or Dutch-German bond spreads). 9

2.1. Multi-Dimensional Options

Chapter 2

2.1.2

Basket Options

The payo function of Basket options depends on the weighted average sum of the underlying asset prices at the time of maturity: h(St , St , ..., St , T ) = (( where St is a price of an ith asset at time t underlying as per the basket contract.
(i ) (1) (2) (d ) d P

i=1

w i ST )

(i )

K )+ ,

0, and wi is the weight of the ith , i = 1, ..., d

2.1.3

Rainbow Options

Rainbow options depend on more than one underlying asset. They usually pay a nonequally weighted average of the assets according to their relative performance. The number of assets is called the number of colors of the rainbow[28]. Rainbow options allow a greater exposure to the market and are a cheaper alternative to portfolio diversification and hedging. There is a wide range of dierent rainbows available on the market; the most typical examples include: 1. Best of Assets or Cash with a general payo function given as: h(St , St , ..., St , T ) = max(ST , ST , ..., ST , K ) 2. Multi-strike Rainbow Option with a general payo function given as: h(St , St , ..., St , T ) = max(ST
(1) (2) (d ) (1) (1) (2) (d ) (1) (2) (d )

K, ST

(2)

K, ..., ST

(d )

K )+

3. Pyramid Rainbow Option with a general payo function given as: h(St , St , ..., St , T ) = (|ST
(1) (2) (d ) (1)

K | + | ST

(2)

K | + | ST

(d )

K | K )+

4. Call on Max with a general payo function given as: h(St , St , ..., St , T ) = (max(ST , ST , ..., ST )
(1) (2) (d ) (1) (2) (d )

K, 0)+

10

Chapter 3 Option Pricing in Black-Scholes Framework
An e cient hedging strategy must be developed in order for an investor to minimize the risk of his position on the market. Black-Scholes model explores the relationship between the prices of options and the underlying assets. Following this model, it is possible to construct a self-financing portfolio that replicates a derivative security and leads to an e cient hedging strategy. In §3.1, we discuss the Black-Scholes framework setup. We review pricing and hedging of one-dimensional European option contracts under the Black-Scholes framework in §3.2. The pricing and hedging model extension to two dimensions is presented in §3.3.

3.1

Black-Scholes Framework Setup

Black-Scholes framework is built upon the following assumptions on the market[4]: a) A self-financing strategy for an option is possible if there exists a market for the underlying assets or, if former condition in not satisfied, there exists a reasonable approximation for the price of the underlying assets; b) Investors are allowed to trade continuously and operate in complete arbitrage-free frictionless markets (i.e. the trade is instantaneous and there are no transaction cost or taxes associated with it) with an unlimited number of the product shares 11

3.1. Black-Scholes Framework Setup freely available on the market;

Chapter 3

c) Investors are allowed to borrow or sell any fraction of the price of the security at a risk-free interest rate that is assumed to be known and constant throughout the time of the strategy implementation. d) There is no penalty associated with short-selling. A seller is assumed to accept the market asset price and agree to settle with the buyer on the specified future date by paying him an amount equal to the market price of the security on the settlement date; Before proceeding to underlying process definition, we introduce some notation. Let the price process (St , t 0) be defined in the filtered probability space {, F , Ft 0 , P} with filtration Ft 0 := (Sl , 0  l  t) defined as a sigma algebra generated by a set of random variables {Sl , 0  l  t} satisfying the "usual conditions" (i.e. it is right-continuous and contains few null events). We denote the equivalent risk-neutral martingale measure as Q with an expectation under this measure denoted by EQ . Definition 1. Let  be an open set of Rn . A Lebesgue-measurable function f :  ! C , where C is a set of complex numbers, is said to be locally integrable if, for every compact subset K of  the following is true[13]: Z |f |dx < +1

K

Definition 2. A multi-variate It^ o's drift-diusion process is a stochastic process of the form[2]: d X ij j i i dXt = µt dt + t dWt , i = 1, ..., N ; t 2 [0, T ]
j =1

where X0 is an F0 measurable random variable; µt and functions of orders one and two respectively.

ij t 0

are locally integrable

Black-Scholes framework assumes that the rate of return on the riskless asset (risk-free rate, r) is constant, the underlying stock pays no dividends, and that the price process t follows Geometric Brownian Motion (GBM), in which an asset return, dS , consists of two dt components: deterministic and random [4]. We will use the common notation with the 12

Chapter 3 3.2. Black-Scholes Model for One-Dimensional Contracts and Their Hedging deterministic component µdt, where µ is the mean rate of change of an asset price, and the random component dWt , where 0 is an asset constant volatility that determines how much eect the noise term has on the asset return, and dWt is an increment of a Wiener process. Additionally, increments of a Wiener process are independent with dWt  N (0, dt). The following stochastic dierential equation defines the GBM price process: dSt = µSt dt + St dWt (3.1.1) The initial Black-Scholes set-up for pricing of European options of one asset can be extended to two dimensions. In the case of the two dimensional options, the underlying asset prices are assumed to follow the correlated GBM process in which their price paths can be described by 3.1.1, with correlation  between their random components: dSt1 = µ1 St1 dt + dSt2 = µ2 St2 dt +
1 1 1 St dWt , 2 2 1 2 2 St dWt , corr (Wt , Wt )

= ,

(3.1.2)

with Wiener process having the following properties: a) The quadratic variance of a Wiener process Wt is hW it = t; b) Covariance of two correlated Wiener process, such that corr(Wt , Wt ) =  is ,2 hW, W i1 t = t.
(1) (2)

3.2

Black-Scholes Model for One-Dimensional Contracts and Their Hedging

It is of interest to an investor to minimize the risks of his position on the market. This can be done by employing a proper hedging strategy. Typically, the hedging strategy consists of some amount of an underlying asset and a risk-free asset, where their respective amounts depend on the current underlying asset price; additionally, the strategy does not require any further cash inflows or outflows and can be approximated by simple strategies using finite number of trading dates[3]. Such a hedging strategy is called an admissible ~t 0 will denote the strategy whose value at time t > 0 will be denoted by Ft 0 , while F ~t = e rt Ft . time t 0 discounted portfolio value under the risk-neutral measure EQ , i.e. F 13

3.2. Black-Scholes Model for One-Dimensional Contracts and Their Hedging Chapter 3
i Definition 3. A strategy {t }, i = 1, 2, ..., d with portfolio value Ft = n P i i t St , t

0 is

said to be self-financing if dFt =

i=1

n X i=1

i t dSti , t

0

i In order for an investor to be able to execute the strategy {t }, i = 1, 2, ..., d, i Definition 4. A self-financing strategy {t }, i = 1, 2, ..., d with the discounted (under ~t 0 defined on the filtered probability space the risk-neutral measure EQ ) portfolio value F {, F , Ft 0 , P} with filtration Ft 0 is said to be admissible if

~t F

0

0

P

a.s

(3.1)

Definition 5. In the filtered probability space {, F , Ft>0 , P}, a "non-anticipating", or adapted stochastic process (St ) is said to posses the Markov property if for every bounded measurable function f (x) and 0  t  T : E [f (ST )|Ft ] = E [f (ST )|St ] Definition 6. A strategy (t , if:
t)

that possesses Markov property is said to be Markovian t = (t, St )

and

t

= (t, St ), ,

2 C 1,2 [0, T )  (0, 1)

Theorem 1 (9). Let St , t 0 be a GBM process on a filtered probability space {, F , Ft 0 , P} with t , t 0 being the augmented filtration generated by St , t 0. For a squareintegrable random variable X measurable with respect to 1 , there exists a predictable process t , t 0, adapted to filtration t , t 0, such that: S = E (S |F0 ) +
Q

Z

1 0

l dSl

Q

a.s.

(3.2.1)

The Black-Scholes framework insures a complete and arbitrage-free market in which a European options contract with a payo h(t, St ) and a value V (T, St ) = V at time T 14

Chapter 3 3.2. Black-Scholes Model for One-Dimensional Contracts and Their Hedging are replicable in a unique way. Theorem 1 states that there exists a replicating strategy 0} for an option payo. In order to replicate a European contract, an t = { t , t investor follows a self-financing Markovian strategy and typically holds some shares t of the underlying asset St , t 0andsomeamount t, t 0of arisk f reeasset(Bt), t 0 = e^-rt. By the definition of a self-financing portfolio (t , t ), the following equations have to be satisfied: Ftt , t = t St + dFt, = t dSt +
t Bt , t dBt

(3.2.2)

Theorem 2. Let Xt be an It^ o's process and f = f (t, x) 2 C 1,2 [0, T )  Rd . Then
N 1X df = @t f dt + 5f dSt + @s s f d hS i , S j it , 2 i,j =1 i j

(3.2.3)

with f = f (t, St ) and 5f = (@s1 f, ..., @sN f ) [28]. It^ o's formula is one dimension for f (t, S ) = f has the following form: 1 df = @t f dt + @S f dS + @SS f dhS it 2 (3.2.4)

We now introduce Theorem 3 that can be proved using eq. 3.2.2 and 3.2.4; the proof is not presented in our work due to its broad availability in the option pricing literature, see for example [28]. Theorem 3. For a Markovian strategy t = (t , t ) with portfolio value f = f (t, S ) = Ft , t 0, the following two statements are equivalent: a) (t ,
t)

is a self-financing replicating strategy defined in 3.2.2
2

b) f is the solution to S2 @SS f + rS @S f + @t f = rf, (3.2.5) 2 where r is the risk-free interest rate with dBt = rBt = rert ; f 2 C 1,2 [0, T )  R+ and t = @S f [28]. 15

3.2. Black-Scholes Model for One-Dimensional Contracts and Their Hedging Chapter 3 Using Theorem 3 and the fact that a self-financing strategy (t , t ) uniquely replicates a European option contract, option pricing problem can be formulated and solved. Pricing Statement 1. For a European one-dimensional options contract with a payo h(t, St ), replicating strategy f = f (t, S ) = Ft , t 0 and a value V (T, St ) there exists a unique strategy (t , t ) given by t = @S f,
t

=e

rt

(f

 t St )

where f is the solution to eq. 3.2.5 with f (T, St ) = V (T, St ) [28]. The pricing statement can be used to yield prices for a European call and put: a) For a European call contract bought at time t with strike price K , expiration time T , and a pay-o h(T, St ) = max(ST K, 0): V ( St , T ) = S t N ( d 1 ) Ke
r (T t )

N (d2 )

(3.2.6)

b) For a European put contract bought at time t with strike price K , expiration time T , and a pay-o h(T, St ) = max(K ST , 0): V (St , T ) = Ke where d1 = K pT Normal distribution.
ln(
St

r (T t )

N ( d2 )

St N ( d 1 )

(3.2.7)

)+(r +

2 )T 2

and d2 =

t )+(r ln( K p T

S

2 )T 2

; N (x) denotes the cumulative standard

Hedging is the reduction of the sensitivity of a portfolio to the movement of an underlying asset by taking opposite positions in dierent financial instruments[29]. A hedging strategy that eliminates any sensitivity of a portfolio to the movement of an underlying asset is called perfect hedging. The hedging strategy for a European call or a put follows from the Pricing Statement 1. The self-financing strategy (t , t ) replicates an option price at each point in time, as stated in theorem 1. At time t 0, an investor can hedge the long option  t St position by selling t = @S f shares of an underlying asset at price St and t = Vt B t units of a risk-free asset. Such strategy eliminates all market risk from the position, 16

Chapter 33.3. Black-Scholes Model for Two-Dimensional Contracts and Their Hedging leading to "perfect hedging". The values of t and 3.2.6 and 3.2.7 with respect to St : a) For a European call contract: t = N (d1 )and b) For a European put contract: t = N ( d1 )and
t t t

can be obtained by dierentiating

=

Ke

rT

N (d2 )

(3.2.8)

=

Ke

rT

N ( d2 )

(3.2.9)

3.3

Black-Scholes Model for Two-Dimensional Contracts and Their Hedging
(1) (2) (1)

In order to replicate a European Spread option with a payo h(St , St , T ) = (ST (2) (1) (2) ST K )+ , where K is a strike price, and a time T value V (St , St , T ) = V , an investor (1) (2) employs an admissible self-financing strategy and holds some shares t and t of the (1) (2) underlying assets St,t 0 and St,t 0 respectively, and some amount t of a risk-free asset 0 (1) (2) (Bt ),t 0 . As in case of a univariate options' pricing, the strategy t = {t , t , t }, t 0 uniquely replicates the option payo. Therefore, in order to price and hedge a European Spread option we derive an equation that describes the aforementioned hedging strategy, similar to Theorem 3. (1) We begin by presenting quadratic variance and covariance for the two assets, St and (2) St , that follow a correlated GBM given by eq. 3.1.2:

dhS it = hµ1 St dt + dhS (1) , S (2) it = hµ1 St dt +
2 dhS i2 t = ( 2 St ) dt (1) (2)

(1)

(1)

(1) (1) 1 St dWt i

= ( 1 St )2 hdW it = ( 1 St )2 dt (3.3.1) +
(2) (2) 2 St dWt i

(1)

(1)

(1)

(1) (1) (2) 1 St dWt , µ2 St dt

=

(1) (2) 1 2 St St dt

(3.3.2)

Using eq. 3.2.3, 3.3.1 and 3.3.2 we obtain It^ o's formula for a bivariate option contract, with the time t 0 value of a hedging strategy given by Ft = f (S1 , S2 , t) = f : 17

3.3. Black-Scholes Model for Two-Dimensional Contracts and Their HedgingChapter 3

1 1 1 df = @t f dt + @S1 f dS1 + @S2 f dS2 + @S1 S1 f dhS i(1) + @S2 S2 f dhS i2 + @S1 S2 f dhS i1,2 2 2 2 1 1 1 2 2 = @t f dt + @S1 fd S1 + @S2 f dS1 + ( 1 S1 ) @S1 S1 f dt + ( 2 S2 ) @S2 S2 f dt +  1 2 S1 S2 @S1 S2 f dt 2 2 2 (3.3.3) For a self-financing strategy {t , t ,
(1) (1) (1) (1) (2) t }, t (2) (2)

0 the following holds:
t Bt , t dBt

F t =  t S t +  t St +
(1) (2) (2)

dFt = t dSt + t dSt +

(3.3.4)

Using eq. 3.3.3 and 3.3.4, we extend Theorem 2 to two dimensions: Theorem 4. For an admissible strategy t = (t , t , t ) with portfolio value f = f (t, S1 , S2 ) = Ft , t 0, the following two statements are equivalent: a) (t , t ,
(1) (2) t)
0

(1)

(2)

is a self-financing strategy defined in [3.3.4]

b) f is the solution to
2 2 1 ( S1 )

2

@ S 1 S1 f +

2 2 2 ( S2 )

2

@ S 2 S2 f +

1 2 1 ,2 S 1 S 2 @ S 1 S 2 f

+ r(S1 @S1 + S2 @S2 )f + @t f = rf, (3.3.5) where r is the risk-free interest rate with dBt = rBt = rert ; (t, St1 , St2 ) 2 C 1,2 [0, T )  1 2 R+ and t = @S1 f, t = @ S2 f .

1 2 Proof. a ! b Let (t , t , t ) be a self-financing strategy. For a portfolio consisting of (1) (1) (2) (2) t shares of asset St , t shares of asset St and t shares of a risk-free asset Bt , such that dBt = rBt dt, eq. 3.3.4 holds:

1 2 df = t dSt1 + t dSt2 +

t dBt ,

18

Chapter 33.3. Black-Scholes Model for Two-Dimensional Contracts and Their Hedging Using eq. 3.3.4 and 3.1.2, df can be expressed as:

df = (t µ1 St + t µ2 St + r t Bt )dt + (t

(1)

(1)

(2)

(2)

(1)

(1) (1) 1 St dWt

+ t

(2)

(2) (2) 2 St dWt )

(3.3.6)

It^ o's formula 3.3.3 for a bivariate contract allows another expression for the selffinancing strategy Ft ; since It^ o's process has a unique representation, expressions 3.3.3 and 3.3.6 can be matched to yield:
1 i t = @S1 f a.s. 2 ii t = @S2 f a.s.

iii 1 1 (1) (2)  t µ1 S 1 +  t µ2 S 2 + r B t = ( @ t + µ1 S 1 @ S1 + µ2 S 2 @ S2 + ( 1 S 1 ) 2 @ S1 S1 + ( 2 S 2 ) 2 @ S2 S2 2 2 1 + 1 2 1,2 S1 S2 @S1 S2 )f, a.s. 2 where t = @S1 f and t µ2 S2 = µ2 S2 @S2 f , or equivalently: ( 1 S1 ) 2 ( 2 S2 ) 2 @ S1 S1 f + @ S2 S2 f + 2 2
1 2 1,2 S1 S2 @S1 S2 f +r (S1 @S1 +S2 @S2 )f +@t f (1) (2)

= rf, a.s.

b ! a Let f be a solution to 3.3.6. Eq. 3.3.6 can be re-written in the following form: ( 1 S1 ) 2 ( 2 S2 ) 2 @ S1 S1 f + @ S 2 S2 f + 2 2

1 2 1 ,2 S 1 S 2 @ S 1 S 2 f + @ t f

= r(1 S1 @S1 S2 @S2 )f (3.3.7)

It^ o's formula 3.3.3 for a Spread option can be re-written using 3.3.7:

df = @S1 f dS1 + @S2 f dS1 + r(1 , df = t dS1 + t dS2 + r(f 19
(1) (2)

S 1 @ S1
(1)

S 2 @ S2 ) f
(2)

t S1 + t S2 )dt

(3.3.8)

3.3. Black-Scholes Model for Two-Dimensional Contracts and Their HedgingChapter 3 The strategy f = Ft was constructed in such a way that Ft = t St + t St + t Bt ; therefore:
t Bt (1) (1) (2) (2)

= Ft

 t St

(1)

(1)

 t St

(2)

(2)

We then write 3.3.8 as

dFt = t dSt + t dSt + r t Bt dt , dFt = t dSt + t dSt + Hence, the strategy (t , t , strategy.
(1) (2) t)

(1)

(1)

(2)

(1)

(1)

(1)

(2)

(1)

t dBt

is self-financing by definition of a self-financing

Based on Theorem 3, it can be concluded that a perfect hedging strategy for a Euro(i ) pean two-dimensional Spread contract consists of t = @Si f shares of each underlying (i ) (1) (1) (2) (2) asset Si = St , i = 1, 2 and t = e rT (f t St t St ) shares of the risk-free asset. The pricing statement for the two-dimensional European Spread option contract can be formulated: Pricing Statement 2. For a European two-dimensional Spread options contract with a (1) (2) (1) (2) (1) (2) payo h(St , St , t) and a value V (St , St , T ) there exists a unique strategy (t , t , t ) given by (i ) (1) (2) t = @Si f, i = 1, 2 and t = e rT (f t S1 t S2 ) where f is the solution to eq. 3.3.6 with f = f (St , St , T ) = F (St1 , St2 , T ). In order to obtain numerical expression for the hedging strategy {t , t , t } using the parameters calibrated from publicly available data, such as expected return and variance, the Pricing Statement 2 must be solved for f ; however, eq. 3.3.6 does not have a closed form solution. An alternative expression for an option price is required to derive the hedging strategy for it. In their paper, Deng, Li and Zhou[22] introduce an alternative pricing formula for Spread options, when the underlying assets follow GBM process 3.1.2: 20
(1) (2) (1) (2)

Chapter 33.3. Black-Scholes Model for Two-Dimensional Contracts and Their Hedging Theorem 5. Under the jointly-normal setup, the price of the Spread option is given by
µ1 Vt = e1 /2+~
2

rT

I1

µ2 e2 /2+~

2

rT

I2

Ke

rT

I3 ,

where n(x) and N (x) are the standard normal density and the cumulative normal density functions and I1 = I2 = I3 = Z Z Z
1 1 1 1 1 1

N (A(y + 1 ) +

N (A(y + 2 ))n(y )dy, N (A(y ))n(y )dy,

p 1

2 1 )n(y )dy,

y x(y ) A(y ) = p , 1 2

i 2 µ ~i = log (S0 ) + (r i /2)T, p i = i T , i = 1, 2[22]

(3.3.9)

Additionally, Deng, Li and Zhou[22] oer an approximation to 3.3.9:

Theorem 6. Let K

0 and ||< 1. Let y0 be a real number close to 0. The spread 21

3.3. Black-Scholes Model for Two-Dimensional Contracts and Their HedgingChapter 3 option price Vt under the general jointly-normal returns setup 3.1.2 is given by I2 Ke rT I3 , 1 I i = J0 ( C i , D i ) + J1 ( C i , D i )  + J 2 ( C i , D i )  2 , 2 Ji 's are defined as u J0 (u, v ) = N ( p ), 1 + v2 1 + (1 + u2 )v 2 u J1 (u, v ) = n( p ), 2 5 / 2 (1 + v ) 1 + v2 (6 6u2 )v 2 + (21 2u2 u4 )v 4 + 4(3 + u2 )v 6 J2 (u, v ) = (1 + v 2 )11/2 I1 and C i , Di , and  are defined as C 1 = C 3 + D3  C 2 = C 3 + D3
1 ~ 1 Vt = e1 /2+µ
2

rT

~ 2 e2 /2+µ

2

rT

3

· n( p

u ) 1 + v2

+ 2

2 1

+

D1 = D3 + 2 1 ,
2 2 + 2 ,

p 1

2 1 ,

D 2 = D 3 + 2 2 ,
2 1 1 2 RK 2 2R p (µ1 log (R + K ) + y0 y ), 2 R+K 2 (R + K )2 0 1  1 2 1 2R 2 RK D3 = p ( 1 + y0 ) , R + K (R + K )2 1 2 1 2 1 2 RK p = , 2 1 1 2 ( R + K ) 2

C3 =

R=e

2 y 0 + µ2

(3.3.10)

where y0 is any real number close to zero, generally chosen as y0 = 0 [22].

In our work we will rely on Theorem 5, omitting Theorem 6 due to the reasons (1) (2) discussed in Chapter 5. Theorem 5 allows us to derive the hedging strategy {t , t , t } (reference 4): 22

Chapter 33.3. Black-Scholes Model for Two-Dimensional Contracts and Their Hedging

~ 1 t = @S1 ft = @S1 (e1 /2+µ (2) t t

(1)

2

rT rT

I1 I1

~ 2 e2 /2+µ

2

rT rT

I2 I2

Ke Ke 1)I1

rT rT

) = I1 , )= I2 ,
2rT
2 /2+µ 2 ~ 2

= @ S2 f t = @ S 2 ( e =e
rT

2 /2+µ 1 ~ 1

e

2 /2+µ 2 ~ 2

( ft

1 1 t St

2 2 t St ) = ( e

2 /2+µ 1 ~ 1

2rT

(e

+ 1)I2

Ke 2rT (3.3.11)

23

Chapter 4 Option Pricing In a Jump-Diusion Framework
The Black-Scholes framework is built upon the assumption that the underlying prices follow a path-continuous processes; however, stock prices often exhibit large unexpected jumps over a small interval of time. This violates the assumption of a price path continuity. In order to improve approximation of option prices and allow for larger random price fluctuations, a jump term can be introduced into the underlying price equation. The jump term will be aimed at modelling events such as arrival of important information that may cause an underlying crush or upsurge. The jumps may occur on the company, industry or market level. While a jump cause is not important, its time and magnitude are. Our goal is to model the time of a jump occurrence and its magnitude. In §4.1, we discuss the jump-diusion process setup. We review pricing and hedging of one-dimensional European option contracts under the jump-diusion process in §4.2. The pricing and hedging model extension to two dimensions is presented in §4.3.

4.1

Jump-Diusion Process Setup

The jumps in asset prices may be caused by a number of unrelated reasons, such as political issues, weather catastrophes, seasonal operation process changes, etc.; moreover, the underlying assets may experience positive as well as negative jumps which requires us to operate under an assumption of a jump independence. For simplification purposes, 25

4.1. Jump-Diusion Process Setup

Chapter 4

it is assumed that the jumps are instantaneous. Therefore, it is reasonable to let the jump process to be defined by a compound Poisson process; in this process the jump times will be modelled by a Poisson process (Nt ), t 0, while the jump sizes will follow a log-normal process. Such an approach to introduce jumps in the underlying price process was proposed by Merton[26]. Definition 7. Let (Ti )i 1 be a sequence of independent, identically exponentially disPn tributed random variables with parameter > 0. We set n = i=1 Ti . We call a Poisson process with intensity the process Nt that counts the number of jumps in the time interval [0, t] is defined by[21]: Nt = X
n 1

1 n t

The number, Nt , of Poisson events is proportional to a small time interval dt in which it occurs, with a coe cient of proportionality , called jump intensity. Poisson process has the following properties: a) N0 = 0, Nt 2 N for t b) Ns  Nt , s < t a.s. c) Nt Ns , t > s, is independent of Ns Ns  Nt , t > s
0 d

0

d) N(s+t)

Definition 8. Let Nt be a Poisson process with intensity . Then the process Xt,t compound Poisson process if it satisfies the following equality: Xt =
Nt X i=0

is a

Yt

where Yi , i = 0, 1, 2, ... are i.i.d. random variables[14]. The price of an underlying asset with jumps is a right-continuous process. It can be written as a combination of a continuous price process before an instantaneous jump at 26

Chapter 4

4.1. Jump-Diusion Process Setup

time t and the price change due to the jump at time t: St = St + St , where St = lim Ss
s "t

(4.1.1)

The absolute magnitude of a jump at time t will be denoted by Jt,t 0 . The price change at the time of a jump is determined by the size of a jump. The relative price change at time t 0 is negative when Jt < 1 and positive when Jt > 1 and can be written as: dSt Jt St St = = Jt St St 1

Merton[26] models the jump sizes as independent non-negative log-normal random variables with mean µ ~ and variance 2 : log (Jt )  i.i.d.N (~ µ,
2

)

(4.1.2) 1) can be derived as follows:

The mean and variance for the relative jump size (Jt

E ( Jt V ar(Jt

~+ 2 1) = eµ

1 2 2

µ+ 1) = e2~ (e

2

1  ,

1)  ~

(4.1.3)

Additionally, the expectation of a compound Poisson process over a time interval [0, t], t 0 is given by: E(
Nt X i=0

lnJTi ) = t

(4.1.4)

where Ti , i = 0...Nt are the jump arrival times. We now extend the underlying price dynamics in eq. 3.1.1 by adding a jump term:

dSt = µSt dt + St dWt + (Jt 1)St dNt , Z t Z t Nt X St = S0 + µSs ds + Ss dWs + ( JT i
0 0 i=0

1)STi

(4.1.5)

27

4.1. Jump-Diusion Process Setup

Chapter 4

An expression for a price process with jumps can be derived using It^ o's formula for a jump-diusion process (version with discontinuity). Theorem 7. For a jump-diusion process Xt , t Xt = X0 + Z
t

0 with evolution given by
Nt X i=1

as ds +
0

Z

t

bs dWs +
0

Xi ,

where at is a drift term, bt is a volatility term, Xt is a jump and Nt is a jump-driving Poisson process, then for a function f (Xt , t) 2 C 2,1 [0, T )  R+ the following is true: @ f (Xt , t ) @ f (Xt , t ) b2 @ f ( X t , t ) @ f (Xt , t ) dt+at dt+ t dt+bt dWt +[f (Xt + Xt ) f (Xt )][9] 2 @t @ Xt 2 @ Xt @ Xt

df (Xt , t) = (4.1.6)

Theorem 7 can be applied to the logarithmic function of underlying price process 4.1.5 to obtain:
2

)dt + dWt + logJt 2 Using eq. 4.1.7, we obtain the expression for an underlying price:

d(logSt ) = (µ

(4.1.7)

2

log (St ) = logS0 + (µ St = S 0 e
(µ
2 )t + 2

2
Wt

)t + W t + Ji

Nt Y i=1

Nt X i=0

logJi , (4.1.8)

Due to the introduction of a jump term, an underlying price process is no longer a martingale under the risk-neutral measure EQ (EMM). While a compound Poisson Nt P process, Yt = log (JTi ), is not a martingale, a compensated compound Poisson process,
i=0

Ytc =

with compensated compound Poisson process to insure that the underlying price process is a martingale: 28

i=0

Nt P

log (JTi )

t is. Hence, the compound Poisson process 4.1.3 should be replaced

Chapter 4

4.1. Jump-Diusion Process Setup

dSt = (µ

)St dt + St dWt + (JTi
2

1)STi dNt ,
Nt X i=0

log (St ) = log (S0 ) + (µ S t = S 0 e (µ

2 )t + 2


Wt Nt Y i=0

2

)t + W t +

log (JTi ), (4.1.9)

JT i

The jump-diusion set-up for pricing of univariate European options can be extended to two dimensions. In case of multi-dimensional option contracts, such as Spread options, an investor expects the underlying price jumps to be partially correlated. Such an expectation is due to the fact that the options are often underwritten on the assets from the same or related industries (for example, Spark and Crack options); hence, an event driving the jumps of one asset will at least partially influence the jumps of other. In order to allow for the partially correlated jump components between the two underlying assets, we let their jumps to be driven by the pairs of Poisson processes, with one Poisson process being shared among the two assets:

Nt Nt
(i )

(1) (2)

= nt + nt , = nt + nt
(2) (3)

(1)

(3)

(4.1.10)

where Nt , i = 1, 2 are the Poisson processes driving price jumps in the two underly(1) (2) (3) ing assets; and nt  P oiss( 1 ), nt  P oiss( 2 ) and nt  P oiss( 3 ) are the three independent Poisson processes.

For generality, we additionally incorporate dividends qi , i = 1, 2 into the asset price equations. Following the procedure outlined above, eq. 4.1.9 can be extended to become: 29

4.2. One-Dimensional Option Pricing and Their Hedging

Chapter 4

dSt = (µi
(i ) St

(i )

qi

i i

(i ) 3 3 )St dt
(i ) 3 3 )t + i W t +

+
Q

(i ) (i ) i St dWt JT +
k (i) (3) nt l=0

+ ( JT i

(i )

1)ST dnt + (JTi
i

(i )

(i )

(3)

1)ST dnt ,
i

(i )

(3)

=

( i ) (µi q i S0 e ( i ) (µi q i

i i

(i ) nt k=0

Q

JT

(3) l

, Tk = 0...nt , Tl = 0...nt , i = 1, 2 , Tk = 0...nt , Tl = 0...nt , i = 1, 2 (4.1.11)
(i ) (3)

(i )

(3)

St = S0 e

(i )

i i

3 3 )t +

(i ) nt P (i ) i Wt + k=0

(3) nt P (i) JT + k l=0

JT

(3) l

where Wiener processes Wt1 and Wt2 are correlated with correlation 1,2 ; µi and i are the constant mean and variance of the GBM price component of the ith asset and i (i ) 2 is the mean of the i0 s jump process log (Jt )  i.i.d.N (~ µi , i ) driven by the ith Poisson (i ) process Nt .

4.2

One-Dimensional Option Pricing and Their Hedging

Due to the presence of a discontinuous jump term in the process 4.1.5, a martingale with respect to the filtration F cannot be represented in the form 3.2.1. This leads not only to market incompleteness but also to the impossibility of producing a perfect hedging strategy for an option that would consist of some shares of the underlying asset and some amount of a risk-free asset[9]. Since the jump sizes in 4.1.9 are represented by i.i.d. log-normal variables, the compound Poisson process becomes a combination of a finite number of independent log-normal variables when conditioned on the number of jumps. For a number of jumps Nt = j , the jump process in 4.1.9 is given by N (j µ ~, j 2 ). Hence, if conditioned on the number of jumps, the underlying price process becomes a combination of log-normal processes and can be written as in [26]:
q

( S t | Nt = j ) = S 0 e (r ( S t | Nt = j ) = S 0 e



2 )t + j µ ~+ 2 2 ~j 2

2 +j 2 W t t

(r q j

2W )t+~j t

, ~j =

r

= S 0 e (r
2 2

~+  + j 2µ 2t

2

2 ~j 2

2W )t+~j t

, (4.2.1)

+j

t

, qj = 

j

2~ µ+ 2t

2

30

Chapter 4

4.2. One-Dimensional Option Pricing and Their Hedging

Additionally, the Black-Scholes pricing formulae 3.2.5 and 3.2.6 can be extended to incorporate dividends, q : a) For a European call contract bought at time t with strike price K , expiration time T , and a pay-o max(ST K, 0): ~ (St , T, , q ) = e V ( St , T )  V
r (T t )

(Ft N (d1 )

KN (d2 ))

(4.2.2)
q (T t )

The hedge in this case is given as t = @s V (St , t)  at (St , t, , q ) = e and t = e rt (V (St , t) t St )  bt (St , t, , q ) = Ke r(T t) N (d2 )

N (d1 )

b) For a European put contract bought at time t with strike price K , expiration time T , and a pay-o max(K ST , 0): ~ (St , T, , q ) = e V ( St , T )  V
r (T t )

(KN ( d2 )

Ft N ( d1 ))
q (T t )

(4.2.3) N ( d1 )

The hedge in this case is given as t = @s V (St , t)  at (St , t, , q ) = e and t = e rt (V (St , t) t St )  bt (St , t, , q ) = Ke r(T t) N ( d2 )
log (
Ft

Kp 2 Kp 2 where Ft = St e(r q)(T t) , d1 = and d2 = ; N (x) denotes the T t T t cumulative standard Normal distribution. The option pricing formulae 4.2.2 and 4.2.3 can be applied to the conditional price process 4.2.1. Thus, option pricing statement in jump-diusion setup is reduced to an option pricing statement in Black-Scholes framework. Summing over the probabilities of the number of jumps we obtain the formula for an option price in jump-diusion setting:

)+

2 (T

t)

log (

Ft )

2 (T

t)

V ( St , T ) =

1 X j =0

e

(T t ) (

(T j!

t))j ~ V (St , T, ~j , qj )

(4.2.4)

~ (St , T, ~j , qj ) is given by eq. 4.2.2 or 4.2.3. where V We propose an average Delta-hedging technique which is derived using an already familiar approach of conditioning on the number of jumps. Once the underlying price process is conditioned on the number of jumps, we can apply the hedging strategy for a univariate option in Black-Scholes framework. Summing over all the possible number of jumps the underlying asset can experience and multiplying by the probability of each (3) (3) (3) jump event, we derive the average Delta-hedging strategy t = (t , t ). 31

4.3. Two-Dimensional Option Pricing and Their Hedging

Chapter 4

t =
(3) t

(3)

1 X j =0 1 X j =0

e e

(T t ) (

(T j! (T j!

t))j t))j

at (St , t, ~j , qj ), bt (St , t, ~j , qj ) (4.2.5)

=

(T t ) (

Lamberton and Lapeyre[21] propose an alternative hedging strategy that is derived by minimizing the risk at maturity, discounted under the specific risk-neutral measure Q = e rT . The risk is given as:
T R0 = EQ ((e r (T t )

( F ( St , T )

V (T, St ))2 )

(4.2.6)

The minimizing exercise with an underlying following the jump-diusion process leads (4) (4) (4) to the following hedging strategy, t = (t , t ): Z

(4) t (4) t

1 = 2 + ( ~2 = V (t, St )

)
(4)

( t +

2

1 1

 (dz )

V (t, St (z + 1)) St

F (t, St )

), (4.2.7)

 t St 1).

where  (z ) is a probability density function of (Jt

4.3

Two-Dimensional Option Pricing and Their Hedging

We start by extending the two-dimensional option pricing formula 3.3.9 proposed by Deng, Li and Zhou[22] to incorporate dividends. Deng, Li and Zhou[22] introduce the following variables: 32

Chapter 4

4.3. Two-Dimensional Option Pricing and Their Hedging

X= Y =

logSt1 logSt2

( µ1
1

q1 ) q2 )

, (4.3.1)

( µ2
2

A two-dimensional spread option pays a non-zero amount at the time of maturity T if it expires at the money: St1 Using eq. 4.3.1: X log (e
2Y

St2

K

0

+(µ2 q2 )

+ K)
1

( µ1

q1 )

(4.3.2) x(y ), where the exercise

Conditioning on Y = y , the option is at the money if X boundary x(y ) is given by

x( y ) =

ln(e

2 Y +(µ2

q 2 ) +K ) 1

(µ1 q 1 )

y x( y ) p We also let A(y ) =  . Theorem 8 presents an extension (conserving dividends) 1 2 to the Deng, Li and Zhou[22] pricing formula.

Theorem 8. Under the jointly-normal returns setup 3.1.2, the price of the spread option is given by

~ (T, St(1) , St(2) , V (T, St )  V

1,

2 , q1 , q2 )

µ1 = e1 /2+(~

2

q1 ) rT

µ2 I1 e2 /2+(~

2

q2 ) rT

I2 Ke

rT

I3 ,

where n(x) and N (x) are the standard normal density and the cumulative normal density 33

4.3. Two-Dimensional Option Pricing and Their Hedging functions and I1 = I2 = I3 = Z Z Z
1 1 1 1 1 1

Chapter 4

N (A(y + 1 ) +

N (A(y + 2 ))n(y )dy, N (A(y ))n(y )dy,

p 1

2 1 )n(y )dy,

y x(y ) A(y ) = p , 1 2

i µi = log (S0 ) + (r p i = i T , i = 1 , 2

2 i /2)T,

(4.3.3)

Proof. Since the random variables X and Y are jointly normally distributed, the conditional density function of X given Y = y is n(x; y, 1 2 ). The two-dimensional 1 2 European Spread option contract with a payo h(T, St1 , St2 ) = max(ST ST K, 0) can be priced by discounting under the risk-neutral measure Q:

V

1 2 ( ST , ST , t)

=E =e

Q

[h(T, St1 , St2 )] Z
1 1

rT

n(y )dy

=e Z 1
x

rT

Z

1 1

Z

1 1 q1 )

µ1 (e1 x+(~ µ2 e2 y+(~

q1 )

µ2 e2 y+(~

q2 )

K )+ n(x, y ; )dxdy 2 )dx

µ1 (e1 x+(~

q2 )

K )n(x; y, 1

Using the identity

Z

1 x0

etx n(x; µ,

2

)dx = eµt+

2 t 2 /2

N(

µ

x0

+ t)

the following can be obtained: 34

Chapter 4

4.3. Two-Dimensional Option Pricing and Their Hedging

V

(St1 , St2 , T )

p N (A(y ) + 1 2 1 )n(y )dy 1 Z 1 1 rT 2 y +(~ µ2 q 2 ) rT e e N (A(y ))n(y )dy Ke N (A(y ))n(y )dy 1 1 Z 1 p 2 /2+(~ 1 µ1 q1 ) rT =e N (A(y + 1 ) + 1 2 1 )n(y )dy 1 Z 1 Z 1 2 /2+(~ 2 µ2 q2 ) rT rT e N (A(y + 2 ))n(y )dy Ke N (A(y ))n(y )dy =e Z
rT 1

Z

e1 y+(1

2 /2+(~ 2 ) 1 µ1 q 1 )

1

=e

2 /2+(~ 1 µ1 q1 ) rT

I1

e

2 /2+(~ 2 µ2 q2 ) rT

1

I2

Ke

rT

I3

We repeat the approach undertaken for pricing univariate options with jumps in the underlying asset to reduce the bivariate pricing in the jump-diusion framework to the pricing in the Black-Scholes framework. We condition the underlying price processes (i ) (3) 4.1.11 on the number of jumps, nt = li , i = 1, 2 and nt = k, 0  k  li to reduce the pricing problem to the Black-Scholes framework:
r

(i ) ( i ) ( St | n t

= li

(3) k, nt (i ) (i )

= k) =

( i ) (r S0 e qi

i i

3 3

2 i )t+(l i 2

k)~ µi + k µ ~3 +

2 i +(li

k)

2 2 i + k 3 W (i ) t t t

,

( S t | Nt = l i ) = S 0 e ( r where ~i = q
2 i

2 ~i 2W i )t + i t 2

, i = 1, 2 (li k)
2~ µi + 2t
2 i

(4.3.4) k
2~ µ3 + 2t
2 3

+ ( li

k)

2 i

t

+ k t3 , qi =
(1) Nt

2

i i

The joint probability function for = = i jumps experienced by the (2) (3) asset St1 and Nt2 = nt + nt = j jumps experienced by the asset St2 over time t 0 is:

3 3 (1) (3) nt + nt

+

.

min(i,j ) (1) P ( Nt

=

(2) i, Nt

= j) =

X
k=0

e

(

1 + 2 + 3 )t

( 1 t) i k ( 2 t) j k ( 3 t) k [25] (i k )! (j k )! k !

(4.3.5)

Additionally, the correlation between the two assets in the jump-diusion setup 4.1.11 is no longer uniquely defined by the correlation 1,2 between their respective GBM com35

4.3. Two-Dimensional Option Pricing and Their Hedging

Chapter 4

ponents due to the additional correlation caused by the jump components. We follow Martin[25] to obtain the expression for the correlation between the two underlying assets in the jump-diusion setup:  = Corr( dSt St
(1)

(1)

,

dSt St

(2)

(2)

We now combine the eq. 4.3.3- 4.3.6 and the arguments outlined above to arrive to a price expression for a two-dimensional spread option in the jump-diusion framework: Theorem 9. The price of a bivariate spread option in jump-diusion framework can be approximated by the following expression: VT =
(1) 1 X 1 X i=0 j =0 (2)

)= p

+ 2 p 3 3 2 2 2 2 2 1 + 1 1 + 3 3 2 + 2
1 2 1,2

2

+ 2 3

(4.3.6)
3

P ( Nt

(1)

= i, Nt

(2)

~ (T, St(1) , St(2) , ~1 , ~2 , q1 , q2 ), = j )V
(1) (2)

(4.3.7)

~ (T, St , St , ~1 , ~2 , q1 , q2 ) is given by eq. 4.3.3 and P (Nt where V by 4.3.5.

= i, Nt

= j ) is given

As in the case of the one-dimensional European option hedging in the jump-diusion setting, we propose two hedging strategies: a simplistic average hedging approach and the extension of the Lamberton and Lapeyre's[21] hedging strategy initially derived for one-asset options with discontinuous jumps. We begin with presenting the average hedging strategy that is obtained by applying the delta-hedging strategy from Deng, Li and Zhou[22], conditional on the number of jumps and with an appropriate parameter change. Referring to the derivation of (4.3.7) and (3.3.11), we write:

(1) t

=

1 X 1 X i=0 j =0 1 X 1 X i=0 j =0

P ( Nt P ( Nt

(1)

= i, Nt = i, Nt

(2)

= j )I1 , = j )( I2 ) (4.3.8)

t =

(2)

(1)

(2)

where I1 and I2 are given in 3.3.9; P (Nt parameters given in 4.3.4 and 4.3.6.

(1)

= i, Nt

(2)

= j ) is given in 4.3.5; with the

36

Chapter 4

4.3. Two-Dimensional Option Pricing and Their Hedging

In order to derive an extension to the Lamberton and Lapeyre's hedging strategy[21], we extend one of the propositions presented by the authors. Theorem 10. Let (t , t )0tT be an adapted, left-continuous process such that E (
Q (1) (2)

Z

T 0 T 0

EQ (

Z

(1) (1) u Su du) < 1, (2) (2) u Su du) < 1 (1) (2)
2 2

2

2

and let F0 2 R. There exists a unique process (t , t , t )0tT that defines an admissible self-financing strategy with initial value F0 . The discounted, under EMM, time t value of this strategy is given by Z
t 0 Nt (1) ~(1) (1) 1 u Su dWu

~t = F0 + F

+

Z

X
j =1

(1)

(1) (1) ~(1)  Uj S j
j

1 1

Z

t 0

~(1) (1) du+ S u u Z
t 0

t 0

Nt (2) ~(2) (2) 2 u Su dWu

+

X
j =1

(2)

(2) (2) ~(2)  Uj S j
j

2 2

~(2) (2) du (4.3.9) S u u

where Uj = are the logarithms of the jump sizes with a j th jump occurring at a time j Let (t , t , by:
(1) (2) t ) 0 t  T

be an admissible strategy with the initial portfolio value given

F 0 =  0 S0 +  0 S 0 + The strategy value at time t can be written as: Ft = F0 + where
(i ) Yt

(1)

(1)

(2)

(2)

0

Z +

t u re 0 ru

du + Yt

(1)

+ Yt

(2)

+ Zt + Zt =
N t P
(i)

(1)

(2)

=

The discounted value of the strategy at time t is, therefore: 37

Rt

(i ) (i )  Su (µi du 0 u

i dWu ), i

= 1, 2 and

(i ) Zt

j =1

j Uj S , i = 1, 2.
j

(i )

(i )

(i )

4.3. Two-Dimensional Option Pricing and Their Hedging

Chapter 4

~t = F0 + F Z t + e
0

Z

t

)F0 du + 0 Z t ru (1) dYu + ( re
0

( re

ru

Z

t

r
0 ru

u du +

Z

t

( re
0

ru

)

)Yu(2) du +

Z

t

Z

t u re 0 rt (1) ru

du +

Z

t

( re
0 rt

ru

)Yu(1) du

e
0

ru

dYu(2) + e

Zt + e

Zt

(2)

(4.3.10)

As in [21], the product e

rt

Zt , i = 1, 2 can be expressed as follows:

(i )

e

rt

(i ) Zt

=

Nt X j =1

(i )

e

r j

( i ) (i ) (i )  Uj S j
j

+

Z

t

( re
0

ru

(i ) ) Zu du, i = 1, 2

(4.3.11)

Additionally, we re-write

Rt
0

e

ru

dYu , i = 1, 2 as

(i )

(4.3.12)

Z

t

e
0

ru

dYu(i)

=

Z

t

e
0

ru

(i ) (i ) u Su (µi du

+

i dWu )

=

Z

t 0

(i ) ~ (i ) u Su (µi du +

i dWu ), i

= 1, 2

Combining eq. 4.3.11 and 4.3.12 into 4.3.10, we obtain: 38

Chapter 4

4.3. Two-Dimensional Option Pricing and Their Hedging

~t = F0 + F + Z
t

Z

t

( re
0

ru

)F0 du +
t 0

( re
0

ru

(1) ) Zu du+

Z

Z

t

r
0

u du +

Z

t

( re
0

ru

)

(1) Nt

Z e

t u re 0 r j ru

du +

Z
j

t

( re
0

ru

)Yu(1) du
ru

(1) ~(1) u Su (µ1 du

+

1 dWu )+

+

Z

t

( re
0

ru

(2) ) Zu du

+

= F0 +

Z

t

r
0

u du +

+

Z Z

Z

Z

X
j =1

(1) (1) (1)  Uj S + j
(2) Nt

Z

t

( re
0

)Yu(2) du

t 0

(2) ~(2) u Su (µ2 du +

2 dWu )

+

t

X
j =1

e

r j

(2)  Uj S  j

(2)

(2)
j

re
0

ru

(F0 +

u re

ru

(1) (2) du + Yu(1) + Zu + Yu(2) + Zu )du Nt

t 0 t 0

(1) ~(1) u Su (µ1 du +

1 dWu )

+

X
j =1

(1)

(1) (1) ~(1)  Uj S j
j

Nt (2) ~(2) u Su (µ2 du + 2 dWu )

+ Z
t

+

= F0 +

( re
0

ru

)Vu du + Z
t 0

Z

t

r
0

u du

+

Z

X
j =1

(2)

(2) (2) ~(2)  Uj S j
j

t 0

Nt (1) ~(1) u Su (µ1 du + Nt
(2)

1 dWu )

+

X
j =1

(1)

(1) (1) ~(1)  Uj S j
j

+ Z
t 0

(2) ~(2) u Su (µ2 du +

2 dWu )

+

= F0

(1) ~(1) (2) ~(2) r (u Su +  u Su +

u )du+

Z

t

r
0

u du+

Z

X
j =1 t 0

(2) (2) ~(2)  Uj S j
j

Nt (1) ~(1) u Su (µ1 du + 1 dWu )+

+ Z
t 0

Z

t 0

Nt (2) ~(2) u Su (µ2 du + Nt 2 dWu )
(1)

+

X
j =1
j

(2)

X
j =1

(1)

(1) (1) ~(1)  Uj S j
j

(2) (2) ~(2)  Uj S j
j

= F0 +

(1) ~(1) u Su ((µ1

r)du +

1 dWu )+

X
j =1

(1) (1) ~(1)  Uj S + j

Z

t 0

(2) ~(2) u Su ((µ2 Nt
(2)

r)du +

2 dWu )

+

X
j =1

(2) (2) ~(2)  Uj S  (4.3.13) j
j

39

4.3. Two-Dimensional Option Pricing and Their Hedging
(1) (2)

Chapter 4

The price processes St and St are driven by a compensated Poisson process as in 4.1.9, having µi = r i i , i = 1, 2; 4.3.13 yields:

~t = F0 + F

Z

t 0

Nt (1) ~(1) (1) 1 u Su dWu

+
t 0

Z

X
j =1

(1)

(1) (1) ~(1)  Uj Sj j

1
(2) Nt

Z

t 0

~(1) (1) 1 + S u u Z
t 0

(2) ~(2) (2) 2 u Su dWu

+

X
j =1

(2) (2) ~(2)  Uj S j
j

2

~(2) (2) 2 S u u

Theorem 11. Let Vt be a time t value of a European two-dimensional Spread option and Ft be a time t value of an admissible strategy that minimizes the quadratic risk of a (1) (2) trading position at maturity; its initial value is F0 = EQ (e rT f (ST , ST )). The strategy (1) (2) is determined by a process (t , t )0tT for the quantities of the underlying assets (1) (2) St , St and the risk-free asset respectively, such that:

(1) t

1 = 2 2 1 + 1( 1 1 = 2 2 2 + 2( 2 = V ( St , S t )
(1) (2)

1 ) 2 )

( (

2 1 I1

+

1

Z

z  (dz ) Z

V (St (1 + z ), St ) St
(1) (2) (1)

(1)

(2)

V ( St , S t )
(1)

(1)

(2)

),
(2)

(2) t (2) t

2 2( (1)

I2 ) +
(2)

2

z  (dz )

V (St , St (1 + z )) St
(2)

V ( St , S t )

),

 t St

(1)

 t St

(2)

(4.3.14)

2 where ~i = V ar(Ji 1) is the variance of a jump size; I1 and I2 are given in (4.3.3);  (dz ) is the probability density function of the log-normal jump sizes.

Proof. The initial value of the strategy is F0 = 0 S0 + 0 S0 + value at time t > 0 is given by Theorem 10: 40

(1)

(1)

(2)

(2)

0;

its discounted

Chapter 4

4.3. Two-Dimensional Option Pricing and Their Hedging

~t = F0 + F

Z

t 0

Nt (1) ~(1) (1) 1 u Su dWu

+

Z

X
j =1

(1)

(1) (1) ~(1)  Uj S j
j

1

Z

t 0

~(1) (1) 1 + S u u Z
t 0 (2) (2) ~u S u 2 (4.3.15)

t 0

Nt (2) ~(2) (2) 2 u Su dWu

+

X
j =1

(2)

(2) (2) ~(2)  Uj S j
j

2

~ (t, St(1) , St(2) ) = e As in [21], we introduce the discounted option price h We now extend the [21] by first introducing the process Mt :

rt

f (t, St , St ).

(1)

(2)

Nt

Mt = M 1 + M 2 = +

1

Z

X
j =1 t 0

(1)

~ (j , S (1) , S (2) ) h j j Z

~ (j , S (1) , S (2) ) h j 
j

du

~ (u, S (1) (1 + z ), S (2) ) (h u u X
j =1
(2)

~ (u, S (1) , S (2) ))d (z ) h u u

Nt

+ + Z

~ (j , S (1) , S (2) ) h j j Z

~ (j , S (1) , S (2) ) h j 
j

t 0

2

du

~ (u, S (1) , S (2) (1 + z )) (h u u

~ (u, S (1) , S (2) ))d (z ) (4.3.16) h u u

Lamberton and Lapeyre[21] show that each of the M1 and M2 in 4.3.16 are squareintegrable martingales, where

Nt

M1 =

X
j =1

(1)

~ (j , S (1) , S (2) ) h j j +

~ (j , S (1) , S (2) ) h j 
j

1

Z

t

du
0

Z

~ (u, S (1) (1 + z ), S (2) ) (h u u 41

~ (u, S (1) , S (2) ))d (z ) h u u

4.3. Two-Dimensional Option Pricing and Their Hedging

Chapter 4

Nt

M2 =

X
j =1

(1)

~ (j , S (1) , S (2) ) h j j +

~ (j , S (1) , S (2) ) h j 
j

1

Z

t

du
0

Z

~ (u, S (1) (1 + z ), S (2) ) (h u u

~ (u, S (1) , S (2) ))d (z ) h u u

~ (M1 + M2 ) is a martingale as it is represented as a linear We conclude that h ~ (M1 + M2 ) can be written in the following form, as combination of martingales. h shown in [21]:

~ (M1 + M2 ) = f (0, X (1) , X (2) )+ h 0 0
(i ) (i )

Z

t 0

~ @h ~(1) 1 dW (1) + S u (1) u @ Su
(1) (2)

Z

t 0

~ @h ~(2) 2 dW (2) (4.3.17) S u (2) u @ Su

~t = e( rt) St , i = 1, 2 and f (0, X0 , X0 ) = F0 . The latter is due to the fact where S that the hedge portfolio is equal to the initial option price at time t = 0.

We now combine 4.3.15 and 4.3.17 to write: 42

Chapter 4

4.3. Two-Dimensional Option Pricing and Their Hedging

~ h

~ = M (1) + M (2) + M (3) + M (4) , F T T T T Z Z
t

where
(1) Mt (2) Mt

= =

(
0 t

~ @h
(1) @ Su

(1) ~(1) (1) u )Su 1 dWu , (2) ~(2) (2) u )Su 2 dWu ,

(
0
(1)

~ @h @ Su
(2)

Nt

Mt

(3)

= +

X
j =1 1

~ (j , S (1) , S (2) ) (h j j
t

~ (j , S (1) , S (2) ) h j 
j

(1) (1) ~(1)  Uj S  ) j
j

Nt

Mt

(4)

= +

X
j =1 2

(2)

Z

du
0

Z

~ (u, S (1) (1 + z ), S (2) ) (h u u

~ (u, S (1) , S (2) ) h u u
(2) (2) ~(2)  Uj S  ) j
j

(1) ~(1) u z Su ) d  ( z ) ,

~ (j , S (1) , S (2) ) (h j j
t

~ (j , S (1) , S (2) ) h j 
j

Z

du
0

Z

~ (u, S (1) , S (2) (1 + z )) (h u u

~ (u, S (1) , S (2) ) h u u

(2) ~(2) u z Su )d (z ) (4.3.18)

~t The squared error between the hedge portfolio Ft and the discounted option price h at time t is, therefore:

~t E((h
(1)

Ft )2 ) = E((Mt
(2)

(1)

+ Mt

(2)

+ Mt
(4)

(3)

+ Mt ) 2 ) =
(1) (2) (1) (3) (1) (4) (2) (3)

(4)

E((Mt )2 +(Mt )2 +(Mt )2 +(Mt )2 )+2E(Mt Mt + Mt Mt + Mt Mt + Mt Mt + Mt Mt
(i ) (j ) (2) (4) (3) (4)

(3)

+ Mt Mt ) (4.3.19)

Lamberton and Lapeyre[21] show that E(Mt Mt ) = 0, i 6= j : ~t E((h Ft )2 ) = E((Mt )2 + (Mt )2 + (Mt )2 + (Mt )2 )
(1) (2) (3) (4)

(4.3.20)

Lastly, we extend eq. 4.3.20, following [21]: 43

4.3. Two-Dimensional Option Pricing and Their Hedging

Chapter 4

T ~T R0 = E((h

FT )2 ) = Z T Z T ~ ~ @h @h (1) 2 ~(1)2 2 (2) 2 ~(2)2 2 ( (1) u ) Su 1 du + ( (2) u ) Su 2 du+ @ Su @ Su 0 0 Z T Z (1) 2 ~ (u, S (1) (1 + z ), S (2) ) h ~ (u, S (1) , S (2) ) (1) z S ~u du (h ) d (z )+ 1 u u u u u 0 Z T Z (2) 2 ~ (u, S (1) , S (2) (1 + z )) h ~ (u, S (1) , S (2) ) (2) z S ~u du (h ) d (z ) = 2 u u u u u 0 Z T ~ ~ @h @h (1) 2 ~(1)2 2 (2) 2 ~(2)2 2 (( (1) u ) Su 1 + ( (2) u ) Su 2 + @ S @ S 0 u u Z (1) 2 ~ (u, S (1) (1 + z ), S (2) ) h ~ (u, S (1) , S (2) ) (1) z S ~u d (z )(h )+ 1 u u u u u Z ~ (u, S (1) , S (2) (1 + z )) h ~ (u, S (1) , S (2) ) (2) z S ~(2) )2 )du (4.3.21) d (z )(h 2 u u u u u u

To find the optimal delta-hedging strategy, it su ces to minimize the squared error given by eq. 4.3.21 with respect to the underlying assets S (1 ) Z

t R0

@ St @ St

(1)

= =

(1) t

1 = 2 2 1 + 1( 1 1 = 2 2 2 + 2( 2

1 ) 2 )

( (

2 1 I1

+

1

z  (dz ) Z

V (St (1 + z ), St ) St
(1) (2) (1)

(1)

(2)

V ( St , S t )
(1)

(1)

(2)

),
(2)

t R0 (2)

(2) t

2 2(

I2 ) +

2

z  (dz )

V (St , St (1 + z )) St
(2)

V ( St , S t ) (4.3.22)

)

2 where ~i = V ar(Ji 1) is the variance of a jump size; I1 and I2 are given in (4.3.3);  (dz ) is the probability density function of the log-normal jump sizes.

44

Chapter 5 Pricing and Hedging Implementation
In order to implement and validate the theoretical results presented in this thesis, numerical tests and approximations ought to be executed. In §5.1, we examine and discuss dependencies of the European one- and two-dimensional Spread option prices on various parameters in both Black-Scholes and Jump-Diusion frameworks. We present the parameter calibration techniques and the results of their application in §5.2. In §5.3 we proceed with the hedging experiments, using the parameter values calibrated in §5.2.

5.1

Option Price Computations and Monte-Carlo Simulations

For the purpose of our investigation, we implement option pricing formulae 4.2.4 and 4.3.7 in MATLAB R2014a. We cap the infinite discrete summations in 4.2.4 and 4.3.7 in order to increase the computational e ciency and due to the fact that the summation terms become negligible at higher orders. The altered formulae used for option price computations are: 45

5.1. Option Price Computations and Monte-Carlo Simulations

Chapter 5

a) For a univariate European option contract the pricing equation 4.2.4 becomes: V ( St , T ) =
171 X j =0

e

(T t ) (

(T j!

t))j ~ V (St , T, ~j , qj )

(5.1.1)

~ (St , T, ~j , qj ) is given by eq. 4.2.2 or 4.2.3. where V b) For a bivariate European Spread option contract the pricing equation 4.3.7 becomes: VT =
6 X 6 X i=0 j =0 (1)

P ( Nt

(1)

= i, Nt

(2)

~ (T, St(1) , St(2) , ~1 , ~2 , q1 , q2 ), = j )V
(1)

(5.1.2)
(2)

~ (T, St , St , ~1 , ~2 , q1 , q2 ) is given by eq. 4.3.3 and P (Nt where V is given by 4.3.5.

(2)

= i, Nt

= j)

One of the objectives of this work is to propose a parameter calibration algorithm. Such an algorithm will allow to find an optimal set of parameters that calibrates the market Spread option prices and can be used for the purposes of option hedging and pricing. In order to verify the accuracy of the proposed algorithm, we use a selected set of parameters to simulate the prices of the two assets, European Call options written on each of the assets and Spread options written on the spread between the two assets. We use Monte-Carlo approach to simulate Call and Spread option prices for across a range of Strikes and Maturities: Strikes range from $0 to $30 with $2.5 intervals and Maturities range from 0.5 year to 3 years with half-a-year intervals. The parameters used for Monte-Carlo simulation are presented in table 5.1. Additionally, the following assumptions are made: a) Underlying dynamics follow jump-diusion process 4.1.5. b) Risk-free rate stays constant over time. c) No arbitrage is possible on the market. To arrive to an option price at time t, option payos can be discounted using a risk-neutral measure e r(T t) , where T is an option maturity time. 46

Chapter 5

5.1. Option Price Computations and Monte-Carlo Simulations Parameter (1) Initial price, S0 (2) Initial price, S0 Risk-free rate, r GBM volatility, 1 GBM volatility, 2 GBM correlation, 1,2 Jump-diusion volatility, 1 Jump-diusion volatility, 2 Jump-diusion volatility, 3 Jump-diusion expected value, µ ~1 Jump-diusion expected value, µ ~2 Jump-diusion expected value, µ ~3 Jump-diusion intensity, 1 Jump-diusion intensity, 2 Jump-diusion intensity, 3 Parameter Value 122.00 105.97 0.03 0.20 0.15 -0.0696 0.425 0.361 0.05 -0.15 -0.15 -0.15 0.30 0.20 0.05

Table 5.1: Parameters used in Monte-Carlo simulation

The number N > 1 of Monte-Carlo simulations to carry out is selected such that: a) The Call option prices VN and VN 1 on the first underlying asset dier by less than 0.10 cents for the two consecutive Monte-Carlo runs. b) The Call option prices VN and VN 1 on the second underlying asset dier by less than 0.10 cents for the two consecutive Monte-Carlo runs. c) The Spread option prices VN and VN consecutive Monte-Carlo runs.
1 (2) (2) (1) (1)

dier by less than 0.10 cents for the two

To arrive to an option price at time t = 0 for each maturity-strike combination, an average of option payos for 100, 000 Monte-Carlo simulations discounted under the risk-natural measure e r(T t) is calculated. Tables 5.2- 5.4 presents a sample set of the simulated option prices. We additionally compare the option prices computed using 5.1.1 and 5.1.2 with the prices simulated using the aforementioned Monte-Carlo methods. The computational e ciency and the prices are presented in Tables 5.5 and 5.6 for Strikes of $100 and $10 47

5.1. Option Price Computations and Monte-Carlo Simulations

Chapter 5

Maturity/Strike 0.5 1 1.5 2 2.5 3

95 29.54 32.26 35.59 38.49 41.97 44.68

97.5 27.28 30.42 33.47 36.68 39.51 42.85

100 25.02 28.50 31.61 35.19 38.44 41.71

102.5 22.91 26.70 30.06 33.49 36.99 40.80

105 21.06 24.69 28.53 32.14 35.52 39.73

Table 5.2: Simulated time t = 0 prices of a Call option on the first asset

Maturity/Strike 0.5 1 1.5 2 2.5 3

95 13.90 16.78 19.36 21.65 23.64 25.99

97.5 11.92 14.96 17.78 20.10 22.37 24.27

100 10.06 13.34 16.15 18.51 20.90 23.13

102.5 8.33 11.73 14.53 17.13 19.56 21.78

105 6.87 10.25 13.17 15.81 18.23 20.44

Table 5.3: Simulated time t = 0 prices of a Call option on the second asset

Maturity/Strike 0.5 1 1.5 2 2.5 3

15 12.04 17.67 22.91 27.14 31.83 35.34

17.5 10.76 16.65 21.34 25.87 29.73 34.18

20 9.60 15.42 20.17 25.00 29.06 33.04

22.5 8.77 14.51 19.23 23.72 28.10 32.64

25 7.82 13.32 18.28 22.82 27.04 31.97

Table 5.4: Simulated time t = 0 prices of a Spread option

48

Chapter 5 Option Type Option Price European Call on Asset 1 28.50 European Call on Asset 2 13.34 European bivariate Spread 24.31

5.2. Parameter Dependencies Computational Time, s 101.01 100.02 226.61

Table 5.5: Option prices at time t = 0 were simulated using Monte-Carlo methods as well as computed with the proposed pricing formula [4.3.7] Option Type Option Price European Call on Asset 1 28.46 European Call on Asset 2 13.37 European bivariate Spread 24.36 Computational Time, s 0.02 0.02 0.70

Table 5.6: Option prices at time t = 0 were computed using 5.1.1 and 5.1.2

for the European Call and bivariate Spread options respectively and maturities of one year for the both option types. We note that while the absolute dierences between the relative option prices computed using the two methods stay within $0.05 for the tested set of prices, 5.1.1 and 5.1.2 oer a significant computational time reduction.

5.2

Parameter Dependencies

In previous chapters, we presented four European-style option pricing formulas: two of them were attributed to univariate options and two to bivariate options; the prices were derived in both the Black-Scholes and Jump-Diusion frameworks. It is natural to expect that comparable one- and two-dimensional European Spread option prices will have similar behaviour with respect to their various underlying parameters, independent of the framework. In order to test the validity of the option pricing formulae 3.3.9, 4.2.4, 4.3.7 presented in our work, we examine their responses to the changes in various model parameters such as time to maturity, strike price, risk-free rate, underlying volatility, etc. The dependencies are produced using MATLAB R2014a and are compared to the benchmark model 3.2.6. We use the Black-Scholes model as a benchmark since it has already been extensively tested and is theoretically sound. At all times, we only change one model 49

5.2. Parameter Dependencies Parameter (1) Initial price, S0 (2) Initial price, S0 Maturity, T Strike price, K Risk-free rate, r GBM volatility, 1 GBM volatility, 2 GBM correlation, 1,2 Jump-diusion volatility, 1 Jump-diusion volatility, 2 Jump-diusion volatility, 3 Jump-diusion expected value, µ ~1 Jump-diusion expected value, µ ~2 Jump-diusion expected value, µ ~3 Jump-diusion intensity, 1 Jump-diusion intensity, 2 Jump-diusion intensity, 3 Parameter Value 122.00 105.97 0.5 10 0.03 0.20 0.15 -0.0696 0.425 0.361 0.050 -0.15 -0.15 -0.15 2.5 1.9 0.8

Chapter 5

Table 5.7: Reference model parameters. To explore a parameter dependance, the parameter was varied while the rest of parameters remaining unchanged, as per the reference model

parameter, keeping the rest of the parameters constant. The original model parameters are presented in Table 5.7. The initial underlying asset prices and their correlation are selected based on the real market data for Sweet Crude Oil and WTI from 2011-05-13 to 2013-05-13 obtained from Datastream. We keep the jump parameters high in as our primary objective is to test the option pricing models in presence of discontinuous jumps. Fig. 5.1 presents the option price dependencies on the time to maturity. In all the scenarios, option price grows with the Time to Maturity. The relationship exhibits more curvature for a univariate option with jumps compared to its counterpart without jumps. This relationship is anticipated because with longer time to maturity an option has more opportunity to move deeper into the money. Noteworthy, the jump-diusion framework bivariate option price evolution with respect to the Time to Maturity is only shown for Maturities of up to 1.5 years. With increasing Time to Maturity T , the probability of a jump in eq. 4.3.7 becomes small, or equivalently a larger number of jumps occurs 50

Chapter 5

5.2. Parameter Dependencies

Figure 5.1: Univariate and bivariate Spread option prices increases with maturity in both Black-Scholes and jump-diusion frameworks

on [0, T ]; therefore, we have to increase the infinite series truncation level in eq. 5.1.2. Fig. 5.2 supports our claim. The top half of Fig. 5.2 shows that the option price does not behave as expected for the Maturities above 1.5 years, however, it changes its behaviour for lower jump intensities; lower jump intensities lead to higher jump probabilities in eq. 4.3.7 that avoids the necessity of higher truncation levels in eq. 5.1.2. The bottom half of the Fig. 5.2 shows that the option price exhibits expected behaviour with larger Times to Maturity for the same set of parameters (Table 5.7) if we increase the truncation level in eq. 5.1.2. Fig. 5.3 shows the option price changes with respect to volatility attributed to the GBM component. All the four suggested pricing formulas react to the volatility changes in a similar fashion. Two-dimensional option prices grow faster with volatility, specifically, with increase in the volatility of the first underlying asset. This is due to their payo function being dependent on the spread between the two underlying assets: the more volatile they are, the higher the chance of an increasing spread; moreover, if the volatility of the first asset increases while that of the second is kept constant, the option has higher chances to move out of the money. Noteworthy, with changing GBM component of 51

5.2. Parameter Dependencies

Chapter 5

Figure 5.2: Bivariate Spread option dependency on the time to maturity in jump-diusion framework. As jump intensities are decreased, Spread options exhibit behaviour more close to the univariate Call options

52

Chapter 5

5.2. Parameter Dependencies

Figure 5.3: European univariate and bivariate Spread option price dependencies on the GBM volatility component. Option prices increase with the volatility attributed to the GBM component in both Black-Scholes and jump-diusion frameworks

the volatility, Spread option price increases faster in the Black-Scholes framework. This phenomena is explained by the fact that in the jump-diusion framework the impact of the changes in the GBM component of the volatility are reduced by the unchanging jump components of the volatility; in the Black-Scholes framework, however, the GBM component is the sole driver of the volatility and impacts the option price more. Option price evolution with respect to the changes in the strike price can be seen on fig. 5.4. As expected, an option price decreases with increase in strike. Fig. 5.5 presents the option prices variation with the risk-free interest rate. Since the risk-free interest rate is not eected by the underlying asset jumps, there is not dierence observed between the option price change in each of the frameworks. We now proceed to the investigation of the Spread option dependencies on the correlation between the two underlying assets. Fig. 5.6 shows that the relationship between the bivariate option price in Black-Scholes framework and the correlation attributed to the GBM component has slightly more curvature compared to its jump-diusion counterpart. This is due to the overall correlation of the two underlying assets in the jump-diusion framework being a function of the GBM correlation and the jump correlation; the corre53

5.2. Parameter Dependencies

Chapter 5

Figure 5.4: European univariate and bivariate Spread option price dependencies on the Strike price. Option prices decrease with the increasing Strike in both Black-Scholes and jump-diusion frameworks

Figure 5.5: European univariate and bivariate Spread option price dependencies on the Risk-Free Rate. Option prices increase with the Risk-Free Rate in both Black-Scholes and jump-diusion frameworks.

54

Chapter 5

5.2. Parameter Dependencies

Figure 5.6: European bivariate Spread option price dependencies on the correlation. Spread option prices increase with the Risk-Free Rate in both Black-Scholes and jumpdiusion frameworks

lation components attributed to the jump parameters reduce the impact of the changes in the GBM components of the underlying correlation as presented in table 5.8. The price dependencies on the jump parameters such as jump size volatility and jump expected value are displayed in fig. 5.7. We note the shared jump parameters ("Jump 3") have the least eect on the option price due to the low jump intensity relative to the other jumps. Lastly, we repeat our numerical experiment for the pricing equation 3.3.10 proposed by Deng, Li and Zhou [22]. We are able to find a set of parameters (table 5.9) such, that the option price does not exist when the first underlying assets price is kept constant (volatility is zero), or when the underlying assets are perfectly correlated or perfectly negatively correlated. Additionally, the option price does not behave as expected with respect to the underlying asset correlation and takes on negative values for strikes above 20. The results are presented on fig. 5.8. 55

5.2. Parameter Dependencies

Chapter 5

GBM Correlation Overall Correlation -1.0000 -0.7761 -0.5000 -0.3672 0.0000 0.0417 0.5000 0.4505 1.0000 0.8594 Table 5.8: GBM correlation and the corresponding overall correlation of the two underlying assets.

Figure 5.7: European univariate and bivariate Spread option price dependencies on the jump size and jump volatility. Option prices in jump-diusion framework increase with increasing jump sizes and volatility

Parameter (1) Initial price, S0 (2) Initial price, S0 Maturity, T Strike price, K Risk-free rate, r GBM volatility, 1 GBM volatility, 2 GBM correlation, 1,2

Parameter Value 122.00 105.97 0.5 10 0.03 0.0198 0.0156 -0.0696

Table 5.9: Parameters used for a numerical experiment of Deng, Li and Zhou option pricing.

56

Chapter 5

5.2. Parameter Dependencies

Figure 5.8: Bivariate Spread option price dependencies on various parameters in BlackScholes framework. The option price is calculated using the Deng, Li and Zhou's pricing formula. It can be seen that the prices do not exist when the underlying assets are perfectly positively or negatively correlated, or for low volatility values; the price take on negative values for higher Strike prices and exhibits an unexpected behaviour with respect to the underlying asset volatility

57

5.3. Parameter Calibration

Chapter 5

5.3

Parameter Calibration

For a set of options with various strikes and maturities the parameter calibration problem can be defined as follows: min
y n X i=1

~ (y ) (V

Vi )2

(5.2.1)

where Vi are the Spread option market prices, y is a set of parameters to be calibrated ~ (y ) is the calculated option price for a set of parameters y . and V The set of parameters to be calibrated contains 12 values. The problem 5.2.1 does not have a unique solution due to the presence of the jump parameters[15] as well as a large set of unknowns to be calibrated. In order to simplify the calibration procedure and arrive to a unique set of calibrated parameters, we propose to additionally use the European Call option prices and calibrate the unknown parameters in steps. We break-down the calibration problem into three sub-problems:

a) Use historical prices Vi , i = 1, ..., n of one-dimensional European options on the first underlying asset to approximate 1 - the volatility of the first underlying attributed to the GBM component; µ ~1 - the mean of the log-normally distributed jump sizes attributed to the first underlying asset; 1 - the variance of the lognormally distributed jump sizes to the first underlying asset; 1 - the jump intensity of the log-normally distributed jumps to the first underlying asset:
n X i=1

(1)

y 2R

min 4

~ (y ) (V

Vi )2

(1)

(5.2.2)

b) Use historical prices Vi , i = 1, ..., n of one-dimensional European options on the first underlying asset to approximate 2 - the volatility of the first underlying attributed to the GBM component; µ ~2 - the mean of the log-normally distributed jump sizes attributed to the first underlying asset; 2 - the variance of the lognormally distributed jump sizes to the first underlying asset; 2 - the jump intensity 58

(2)

Chapter 5

5.3. Parameter Calibration

of the log-normally distributed jumps to the first underlying asset.

y 2R

min 4

n X i=1

~ (y ) (V

Vi )2

(2)

(5.2.3)

c) Conditional on all the prior calibrated parameter values, use historical prices of the two-dimensional European Spread options, Vi , i = 1, ..., n to approximate 1,2 - the correlation between the two underlying assets attributed to their Brownian motion components; µ ~3 - the mean of the log-normally distributed jump sizes attributed to both underlying assets; 3 - the variance of the log-normally distributed jump sizes attributed to both underlying assets; 3 - the jump intensity of the log-normally distributed jumps attributed to both underlying assets:

y 2R

min 4

n X i=1

~ (y ) (V

Vi )2

(5.2.4)

As discussed in [15], the problems 5.2.2 - 5.2.3 are ill-posed. To show the ill-posedness of the simplified problem 5.2.2, with the calibration done only on the two parameters, µ ~1 and 1 , while keeping 1 = 0.20 and 1 = 0.3 constant, fig. 5.9 plots the calibration ~ k2 . Fig. 5.9 displays a large nearly flat region, suggesting that error function 1 kV V 2 the problem is ill-posed. Although the calibration problem is ill-posed, we claim that it has several acceptable solutions. He et al.[15] note that any European option price depends only on the riskadjusted transition density function from the current stock price to the stock price in time T 0. Hence, our task is to show that the probability density function (PDF) for the calibrated set of parameters follows closely the true PDF for each set of options. The calibration problems 5.2.2 - 5.2.4 are solved in MATLAB R2014a by minimizing the objective function with a set of constraints using a trust-region-reflective algorithm; the minimization procedure is applied multiple times from a set of random and user-defined start points in attempt to find the best minimum point. The transition PDF for the log asset prices is as follows: 59

5.3. Parameter Calibration

Chapter 5

Figure 5.9: Minimization problem objective function plotted for a varying jump intensity and GBM volatility component

e p( x) = p w=r

inf X ( T )n e 2(T 2 +n 2 ) ·p , T 2+n 2 2 n=0 n! T 2

(wT +nµ ~ x)2

2



(5.2.5)

The transition PDF 5.2.5 can be used to assess the goodness of fit for the parameters calibrated in 5.2.2 - 5.2.3. Table 5.10 shows the calibration results for problems 5.2.2 5.2.3 with the PDF functions presented in fig. 5.10 - 5.11, while the calibration results for problem 5.2.4 are presented in Table 5.11. We additionally note that the true parameters fall within the 95% Confidence Intervals(CIs) of all the calibrated values, except the jump size; as an example, we present the 95% CIs for each calibrated parameter for Asset 1 in Table 5.12. After the parameters were calibrated, a set of option prices was computed using the calibrated parameters and computed against the corresponding out-of-sample prices. The set contained 50 options with out-of-sample prices calculated using the Monte-Carlo simulations for the set of parameters as in 5.1 for the Strikes ranging 60

Chapter 5

5.3. Parameter Calibration

Figure 5.10: Transition Probability Density Function for the calibrated set of parameters attributed to the first underlying asset in the one-dimensional parameter calibration problem. The transitional Probability Density Function for the calibrated set of parameters follows closely the transitional Probability Density Function for the true set of parameters

from $7.5 to $30 with $2.5 intervals and Maturities ranging from 1 year to 2.5 years with half-a-year intervals; using the out-of-sample testing, the square root error was calibrated to be $0.12. Table 5.13 presents some option prices computed for the calibrated set of parameters and the true set of parameters.

Asset Asset 1 Asset 2

True Parameters ( , µ ~, , ) (0.30, 0.15, 0.43, 0.20) (0.20, 0.15, 0.36, 0.15)

Calibrated Parameters ( 0 , µ ~0 , 0 , 0 ) (0.34, 0.0064, 0.4500, 0.1912) (0.58, 0.1042, 0.2537, 0.1300)

Table 5.10: Calibrated and true model parameters for the European Call options underwritten on Asset 1 and Asset 2

61

5.3. Parameter Calibration

Chapter 5

Figure 5.11: Transition Probability Density Function for the calibrated set of parameters attributed to the second underlying asset in the one-dimensional parameter calibration problem. The transitional Probability Density Function for the calibrated set of parameters follows closely the transitional Probability Density Function for the true set of parameters

True Parameters (1,2 , µ ~3 , 3 , 3 ) ( 0.0696, 0.15, 0.05, 0.05)

0 Calibrated Parameters (01,2 , µ ~03 , 3 , ( 0.072, 0.012, 0.06, 0.04)

0 3)

Table 5.11: Calibrated and true model parameters for the bivariate Spread option

Parameter

Calibrated Parameter Value 95% CI of the Calibrated Parameter 0.34 [0.296, 0.371] -0.0064 [ 0.0135, 0.0031] 0.45 [0.412, 0.469] 0.191 [0.173, 0.211]

Table 5.12: Confidence Intervals for the parameters calibrated for a European Call option on Asset 1. The true parameters fall within the 95% CIs of all the calibrated values, except the jump size

62

Chapter 5

5.4. Hedging Evaluation Using Simulation

Strike and Maturity Combination Calibrated Option Price True Option Price 1year, $7.5 21.54 21.61 1year, $10 20.11 20.18 1.5years, $7.5 26.01 26.08 1.5years, $10 24.91 24.82 Table 5.13: Calibrated and true model parameters.

5.4

Hedging Evaluation Using Simulation

It is a theoretical expectation that a Delta-Hedging strategy oers a perfect hedge for a Call option in Black-Scholes framework. We perform a simple numerical experiment to verify this expectation. The experiment calculates the Profit and Loss(P&L) of the hedging strategy with a half-year hedging and re-balance horizon. The P&L is calculated for 1,000,000 simulated asset prices with option parameters given in table 5.14 and allows us to derive the P&L PDF for the hedging strategy. We employ Monte-Carlo method to simulate the asset price in Black-Scholes and jump-diusion frameworks over a six months horizon with daily frequency. Generally, the strategy proceeds through the following steps: a) Calculate the initial hedge (0 , 0 , 0 ), with (0 , 0 ) obtained according to (1) (1) (2) (2) the applicable formulas and 0 = V0 (S0 0 + S0 0 ); where V0 is the initial option price. b) At each re-balance time ti , re-calculate the asset portions (ti , ti ) of the hedge (1) (1) (1) (2) (2) and the amount of a risk-free asset as ti = er t ti 1 (Sti (ti ti 1 )+ Sti (ti ) (2) ti 1 ); where Vti is the time ti option price. c) At the end of the hedging period Th profit and loss (P&L)[13]: VT 0, calculate the hedging strategy relative
(1) (2) (1) (2) (1) (2)

rP L(T ) =

( ST  T + S T  T + V0

(1)

(1)

(2)

(2)

T)

(5.2.6)

Fig. 5.12 supports the theoretical expectation of the perfect Delta-hedging strategy for the Call options in Black-Scholes framework calculated using 3.2.8 as the PDF is 63

5.4. Hedging Evaluation Using Simulation

Chapter 5

Figure 5.12: P&L PDF of Delta-Hedging strategy for a European Call option in BlackScholes framework. The PDF is centered around zero showing that the strategy yields a perfect hedge in majority of the scenarios

centered around zero. Due to the incompleteness of a market that accepts an infinite number of possible jumps sizes, hedging of a contingent claim under the jump diusion process poses a great challenge. Although the diusion risk can still be nearly eliminated by imposing delta neutrality, the presence of jumps governed by the compound Poisson process precludes the complete removal of all the price fluctuation risk due to the presence of the jump risk[15]. Fig. 5.13 shows that the Delta-hedging experiment repeated for asset priced in jump-diusion framework almost always leads to a loss as the P&L PDF is centered around 2. The parameters used in the latter experiment are presented in table 5.15. We now illustrate the results of the hedging experiments for the two hedging strategies under the consideration for a Spread option in the jump-diusion framework. The option parameters used in the experiments are presented in table 5.16; as before, the experiment calculates P&L of the hedging strategy with a half-year hedging horizon. The P&L is calculated for 10,000 simulated asset prices. Fig. 5.14 shows the P&L PDF for an average Delta-hedging strategy given by 4.3.8. The P&L PDF is centered close to zero and peaks very high; although the strategy 4.3.8 does not oer a nearly perfect hedge, the error from 64

Chapter 5

5.4. Hedging Evaluation Using Simulation

Figure 5.13: P&L PDF of Delta-Hedging strategy for a European Call option in jumpdiusion framework. The PDF is not centered around zero showing that the strategy leads to a portfolio loss in majority of the scenarios

Parameter (1) Initial price, S0 Strike price, K Maturity, T Risk-free rate, r GBM volatility,

Parameter Value 122.00 122.00 1 0.03 0.20

Table 5.14: Parameters used for Delta-Hedging experiment for a Call option in BlackScholes framework.

65

5.4. Hedging Evaluation Using Simulation Parameter (1) Initial price, S0 Strike price, K Maturity, T Risk-free rate, r GBM volatility, Jump-diusion volatility, Jump-diusion expected value, µ ~ Jump-diusion intensity, Parameter Value 122.00 122.00 1 0.03 0.20 0.425 -0.15 0.30

Chapter 5

Table 5.15: Parameters used for Delta-Hedging experiment for a Call option in jumpdiusion framework.

the strategy is generally very low. Fig. 5.15 shows the P&L PDF for the Delta-hedging strategy given by 4.3.14. The P&L PDF is centered around zero leading us to conclude that it oers a nearly perfect hedge in majority of the cases. Lastly, we present 95% Value-at-Risk (VAR), for every dollar invested, of various hedging strategies in Table 5.17 and we note that although the P&L PDF for the hedging strategy given by 4.3.14 is centered around zero, the curve is wider signifying a more volatile hedge; that is, indeed, shown by the higher 95% VAR as compared to the average Delta-hedging strategy. The average Delta-hedging strategy sums over the products of the Delta-hedges for all the possible combinations of the jumps in the underlying assets and the probabilities of the corresponding jump combinations. For each simulated set of the underlying asset prices, the average hedging strategy will contain a Delta-hedge for the observed combination of the jumps experienced by the underlying assets as one of its terms; the remaining terms of the average Delta-hedging strategy will lead to either gain or loss. When added together, all the gains and losses resulting from the application of each of the hedge terms in the average Delta-hedging strategy will lead to a small gain or loss that, on average, will always stay close to the gain and loss of the previous simulation due to the large number of terms being added. This phenomena explains shorter 95% VAR intervals of the average Delta-hedging strategy compared to the hedging strategy given by 4.3.14.

66

Chapter 5

5.4. Hedging Evaluation Using Simulation

Parameter (1) Initial price, S0 (2) Initial price, S0 Strike price, K Maturity, T Risk-free rate, r GBM volatility, 1 GBM volatility, 2 GBM correlation, 1,2 Jump-diusion volatility, 1 Jump-diusion volatility, 2 Jump-diusion volatility, 3 Jump-diusion expected value, µ ~1 Jump-diusion expected value, µ ~2 Jump-diusion expected value, µ ~3 Jump-diusion intensity, 1 Jump-diusion intensity, 2 Jump-diusion intensity, 3

Parameter Value 122.00 105.97 16.00 1 0.03 0.20 0.15 -0.0696 0.425 0.361 0.05 -0.15 -0.15 -0.15 0.30 0.20 0.05

Table 5.16: Parameters used in the hedging experiments for bivariate Spread options

Strategy Average Delta-hedge strategy Lamberton and Lapeyre's Delta-hedging extension

95% VAR 0.35 7.15

Table 5.17: 95% VAR of various hedging strategies

67

5.4. Hedging Evaluation Using Simulation

Chapter 5

Figure 5.14: P&L PDF of Delta-hedging strategy for a bivariate Spread option in jumpdiusion framework. The PDF is centered close to zero, with a high peak, showing that the strategy leads to a slight portfolio gain almost always

Figure 5.15: P&L PDF of extended Delta-hedging strategy for a bivariate Spread option in jump-diusion framework. The PDF is centered around zero showing that the strategy leads to a perfect hedge in majority of the case

68

Chapter 6 Conclusions
This thesis has extended the work of Deng, Li and Zhou[22] to oer a pricing formula for a bivariate Spread options in jump-diusion framework. Having a jump component in our model allows us to better reflect certain characteristics observed in financial markets such as unexpected jumps in the underlying assets that may have adverse eects on option prices. The proposed pricing method yielded prices within $0.01 of the corresponding option prices obtained using Monte-Carlo techniques and allowed a significant computational time reduction. In most cases, the bivariate Spread option pricing formula exhibited the expected behaviour with respect to its various parameters. We extended the work of Lamberton and Lapeyre[21] to arrive to an optimal hedging strategy for bivariate Spread options in jump-diusion framework. The proposed strategy was shown to minimize the squared dierence between the option price and the hedging portfolio and oered an invaluable risk-control tool for an investor. Additionally, we suggested a simplistic "average" Delta-hedging strategy for bivariate Spread options in jump-diusion framework. Although the latter strategy lead to a slightly higher hedging error than the former, it required less computational time and was easier to utilize for a general investor. In order to allow an investor to approximate option prices and derive a hedging strategy, a parameter calibration algorithm was oered. The algorithm was unique in its utilization of both univariate and bivariate option prices to calibrated the necessary parameters. It was shown that although the parameter calibration problem was ill-posed, an acceptable parameter set was produced by the proposed algorithm. 69

Chapter 6 As many commodity market prices possess a mean-reverting property, further work is needed to allow this property in the underlying process; such an extension can, for example, be useful in pricing Crack and Spark spreads. Moreover, it is of interest to investigate the eects of adding jumps to the volatility processes, and the eects of stochastic correlation as they may allow us to better reflect volatility and correlation smiles and smirks observed in financial markets. Other area of investigation should include improvement of the bivariate option hedging strategies to further reduce the hedging error and to simplify the hedging strategy. Finally, it is of a value to extend the model to the more general d-dimensional case and to a wider variety of derivatives, as methods in these areas are often limited to Monte-Carlo simulation, which can be extremely slow to converge particularly in the presence of jumps.

70

Appendix 1 MATLAB Codes
1.1 Monte-Carlo Simulation

%% Parallel Computing myCluster = parcluster('local'); myCluster.NumWorkers = 4; % 'Modified' property now TRUE saveProfile(myCluster); % 'local' profile now updated, % 'Modified' property now FALSE matlabpool('open',4); %%read in the data filename = 'Simulated Data v3.xlsx'; sheet = 1; xlRange = 'B1:N1'; Strikes1D = xlsread(filename, sheet, xlRange); nstrikes = length(Strikes1D); xlRange = 'B2:N2'; Strikes2D = xlsread(filename, sheet, xlRange); xlRange = 'B3:G3'; Maturities = xlsread(filename, sheet, xlRange); nmaturity = length(Maturities);

71

1.1. Monte-Carlo Simulation % holders for the future simulated rices Price1D1S = zeros(nmaturity, nstrikes); Price1D2S = zeros(nmaturity, nstrikes); Price2D = zeros(nmaturity, nstrikes); Price1D1S = zeros(1,100000); Price1D2S = zeros(1,100000); Price2D = zeros(1,100000);

Chapter 1

J = 3; % Number of Poisson processes to simulate S0 = [122 105.97]; % Initial stock prices r = .03; % Risk-free interest rate sigma = [0.2 0.15]; % Stock return volatility mu = [-0.1591 -0.1697]; % Stock return mean sigmatilde = [0.425 0.361 0.05]; % Std. of jumps mutilde = [-0.15 -0.15 -0.15]; % Mean of jumps lambda = [.3 .2 .05]; % Jump intensity K = [exp(mutilde(1) + .5*sigmatilde(1)^2)-1 ... exp(mutilde(2) + .5*sigmatilde(2)^2)-1 ... exp(mutilde(3) + .5*sigmatilde(3)^2)-1]; % jump means correlation = [1.0000 -0.0696; -0.0696 1.0000]; % asset correlation (BM part) rho = [1 0; correlation(1,2) sqrt(1-correlation(1,2)^2)]; % matrix used to derive the correlated BMs Dt=1/252; mmu1 = (r - lambda(1)*K(1) - lambda(3)*K(3))*Dt; mmu2 = (r - lambda(2)*K(2) - lambda(3)*K(3))*Dt; ssg1 = sigma(1)*sqrt(Dt); ssg2 = sigma(2)*sqrt(Dt);

%% 72

Chapter 1

1.1. Monte-Carlo Simulation

for imaturities = 1:nmaturity ts = [1/252 : 1/252 :Maturities(imaturities)]; % Simulation frequency: daily T=ts(end); % Simulation time horizon % Jump intensity over the simulation horizon t1 = lambda(1)*T; t2 = lambda(2)*T; t3 = lambda(3)*T; maturity = Maturities(imaturities); for istrikes = 1:nstrikes Strike1D = Strikes1D(istrikes); Strike2D = Strikes2D(istrikes); tic % parallel computing improves the computation time parfor iruns = 1:100000 % Simulate number of jumps N = [poissrnd(t1) poissrnd(t2) poissrnd(t3)]; L=length(ts); Jumpsts = zeros(L,3); dN = zeros(L,3); for j=1:J % simulate jump arrival time t = T*rand(N(j),1); t = sort(t); % simulate jump size Jj = mutilde(j) + sigmatilde(j)*randn(N(j),1); % add the jumps 73

1.1. Monte-Carlo Simulation CumS = cumsum(Jj); Eventsprev = 0; % Zero the jump simulator for the new simulation Jumpsts(:,j)=0; dN(:,j) = 0; % order the jump arrival times if isempty(t) for n=1:L if t(1)¡=ts(n) Events = sum(t¡=ts(n)); Jumpsts(n,j) = CumS(Events); dN(n,j) = Events - Eventsprev; Eventsprev = Events; end end end end % calculate the price dynamics using the simulated parameters Dt = ts(1); S = ones(2, length(ts)); DDi = zeros(2, length(ts)); BM = rho*randn(2,1); DDi(1,1) = (r - lambda(1)*K(1) - lambda(3)*K(3))*ts(1) +... sigma(1)*sqrt(ts(1))*BM(1)... + (Jumpsts(1,1)*dN(1,1) + Jumpsts(1,3)*dN(1,3)); DDi(2,1) = (r - lambda(2)*K(2) - lambda(3)*K(3))*ts(1) +... sigma(2)*sqrt(ts(1))*BM(2)... + (Jumpsts(1,2)*dN(1,2) + Jumpsts(1,3)*dN(1,3)); S(:,1) = S0(:).*(1 + DDi(:,1)); 74

Chapter 1

Chapter 1

1.1. Monte-Carlo Simulation

for l = 2:L BM = rho*randn(2,1); DDi(1,l) = mmu1 + ssg1*BM(1) +... (Jumpsts(l,1)*dN(l,1) + Jumpsts(l,3)*dN(l,3)); DDi(2,l) = mmu2 + ssg2*BM(2) +... (Jumpsts(l,2)*dN(l,2) + Jumpsts(l,3)*dN(l,3)); S(:,l) = S(:,l-1).*(1 + DDi(:,l)); end % calculate option payos at expiry and discount them to the % present Sf = [S0' S]; Price1D1S(iruns) = max(Sf(1,length(ts)+1) - Strike1D,0)*exp(-r*T); Price1D2S(iruns) = max(Sf(2,length(ts)+1) - Strike1D,0)*exp(-r*T); Price2D(iruns) = max(Sf(1,length(ts)+1) - Sf(2,length(ts)+1) - Strike2D,0)*exp(-r*T); end % store the simulated prices Price1D1S(imaturities, istrikes) = mean(Price1D1S); Price1D2S(imaturities, istrikes) = mean(Price1D2S); Price2D(imaturities, istrikes) = mean(Price2D); toc end end % record the simulated prices in the file xlswrite('Simulated Data v5.xlsx', Price1D1S, '1D Option Prices S1', 'B2'); xlswrite('Simulated Data v5.xlsx', Price1D2S, '1D Option Prices S2', 'B2'); xlswrite('Simulated Data v5.xlsx', Price2D, '2D Option Prices', 'B2'); %% terminate the parallel computing 75

1.2. Univariate Call Option Pricing Formula in Jump-Diusion Framework Chapter 1 matlabpool('close');

1.2

Univariate Call Option Pricing Formula in JumpDiusion Framework

% this function computed univariate option price in jump-diusion % framework function price1D = Price1DJD(S0, K, T, sigma, sigmatilde, mutilde,... lambda, r) % holder for the formula parameters factors = zeros(1,172); call = zeros(1,172); % initial price is set to zero (first element in the % infinite sum) price = 0; % dividends will be later used for the price computations q = 0; % compute the jump expected value Kg = exp(mutilde + .5*sigmatilde^2); % the summation is capped at 171 for j = 0:171 % calculate the jump probability factors(j+1) = exp(-lambda*T)*(lambda*T)^j/factorial(j); end for i = 0:171 76

Chapter 1 1.3. Bivariate Spread Option Pricing Formula in Jump-Diusion Framework % calculate the parameter changes sigmai = sqrt(sigma^2 + (i*sigmatilde^2)/T); qi = q + lambda*(Kg - 1) - i*(mutilde + (sigmatilde^2)/2)/T; % the new price is computed using the Black-Scholes formula for a % Call option with dividends call(i+1) = BSwithDividends(S0,K,r,qi,sigmai,T); end % perform the summation for k = 1:172 price = price + factors(k)*call(k); end price1D = price; end

1.3

Bivariate Spread Option Pricing Formula in JumpDiusion Framework

% this function computed univariate option price in jump-diusion % framework function call = Price2DJD(S, K, T, sigma, sigmatilde, mutilde,... lambda, corr, r) % dividends will be used later to change the parameters q = zeros(2,1); % holders for the parameters using in pricing sigmai = zeros(2,1); qi = zeros(2,1); % compute the jump expected value 77

1.3. Bivariate Spread Option Pricing Formula in Jump-Diusion Framework Chapter 1 Kg = [exp(mutilde(1) + .5*sigmatilde(1)^2)-1 ... exp(mutilde(2) + .5*sigmatilde(2)^2)-1 ... exp(mutilde(3) + .5*sigmatilde(3)^2)-1]; % compute the correlation between two underlying assets % this correlation rho =(sigma(1)*sigma(2)*corr + Kg(3)^2*lambda(3))/... (sqrt(sigma(1)^2 + Kg(1)^2*lambda(1) + Kg(3)^2*lambda(3))*... sqrt(sigma(2)^2 + Kg(2)^2*lambda(2) + Kg(3)^2*lambda(3))); sumlam = sum(lambda); call = 0;

% the summation is capped at 6 for i = 0:6 for j = 0:6 for k = 0:min(i,j) % calculate the jump probability prob = exp(-sumlam*T)*((lambda(1)*T)^(i-k))*... ((lambda(2)*T)^(j-k))*((lambda(3)*T)^k)/... (factorial(i-k)*factorial(j-k)*factorial(k)); ii(1) = i; ii(2) = j; for l = 1:2 % calculate the parameter changes sigmai(l) = sqrt(sigma(l)^2 + (ii(l) - k)*(sigmatilde(l)^2)/T +... + k*(sigmatilde(3)^2)/T); qi(l) = q(l) + lambda(l)*Kg(l) + lambda(3)*Kg(3) - ... (ii(l) - k)*(mutilde(l) + (sigmatilde(l)^2/2))/T -... - k*(mutilde(3) + (sigmatilde(3)^2/2))/T; end

% the new price is computed using the formula in Deng, Li and 78

Chapter 1 1.3. Bivariate Spread Option Pricing Formula in Jump-Diusion Framework % Zhou[17] sum1 = prob*TwoDimenssionalCallPriceInt(K, S(1), S(2), r, rho,... qi(1), qi(2), sigmai(1), sigmai(2), T); % perform the summation call = call + sum1; end end end end % this function computed the option price according to Deng, Li and Zhou % [17] function CInt = TwoDimenssionalCallPriceInt(K, S1, S2, r, rho,... q1, q2, sigmareturn1, sigmareturn2, T) % compute the model variables mu1 = log(S1) + (r - q1 - sigmareturn1^2/2)*T; mu2 = log(S2) + (r - q2 - sigmareturn2^2/2)*T; sigma1 = sigmareturn1*sqrt(T); sigma2 = sigmareturn2*sqrt(T); sigma = [sigma1 sigma2]; mu = [mu1 mu2]; q = [q1 q2]; % compute the model infinite integrals I(1) = integral(@(y) integral1(y, sigma(1), sigma(2), mu(1), mu(2), K, rho),-inf,inf,'AbsTol', 1e-1, 'RelTol', 1e-1); I(2) = integral(@(y) integral22(y, sigma(1), sigma(2), mu(1), mu(2), K, rho),-inf,inf,'AbsTol', 1e-1, 'RelTol', 1e-1); I(3) = integral(@(y) integral33(y, sigma(1), sigma(2), mu(1), mu(2), K, rho),-inf,inf,'AbsTol', 1e-1, 'RelTol', 1e-1);

79

1.3. Bivariate Spread Option Pricing Formula in Jump-Diusion Framework Chapter 1 % arrive to the option price CInt = exp((sigma(1)^2)/2 + mu(1) - r*T - q(1)*T)*I(1) -... exp((sigma(2)^2)/2 + mu(2) - r*T - q(2)*T)*I(2) - K*exp(-r*T)*I(3); end % first integral in the pricing formula function int1 = integral1(y, sigma1, sigma2, mu1, mu2, K, rho) x = y + rho*sigma1; xbar = (log(exp(sigma2.*x + mu2) + K) - mu1)./sigma1; A = (rho*x - xbar)/sqrt(1-rho^2); int1 = normcdf(A + sqrt(1-rho^2)*sigma1).*normpdf(y); end % second integral in the pricing formula function int2 = integral22(y, sigma1, sigma2, mu1, mu2, K, rho) x = y + sigma2; xbar = (log(exp(sigma2*x + mu2) + K) - mu1)/sigma1; A = (rho*x - xbar)/sqrt(1-rho^2); int2 = normcdf(A).*normpdf(y); end % third integral in the pricing formula function int3 = integral33(y, sigma1, sigma2, mu1, mu2, K, rho) x = y; xbar = (log(exp(sigma2*x + mu2) + K) - mu1)/sigma1; A = (rho*x - xbar)/sqrt(1-rho^2); int3 = normcdf(A).*normpdf(y);

80

Chapter 1 end

1.4. Hedging in Jump-Diusion Framework

1.4

Hedging in Jump-Diusion Framework

%% two dimensional extension of Lamberton and Lapeyre's hedging strategy in one dimension % initialize parameters dt = 1 252; % time increment = 1 day = 1/252 years t = 0.5; % rebalancing time T = 1; % time to maturity K = 16; S0 = [122 105.97]; % Initial stock prices r = .03; % Risk-free interest rate sigma = [0.2 0.15]; % Stock return volatility mu = [-0.1591 -0.1697]; % Stock return mean sigmatilde = [0.215 0.161 0.05]; % Std. of jumps mutilde = [0.15 0.15 0.15]; % Mean of jumps lambda = [1.2 .8 0.1]; % Jump intensity % sigmatilde = [0.215 0.161 0.05]; % Std. of jumps % mutilde = [0.15 0.15 0.15]; % Mean of jumps % lambda = [1.2 .8 .1]; % Jump intensity corr = -0.0696; % asset correlation (BM part) %% calculate the hedge PLerror = zeros(1,10000); % the initial hedge optionprice0 = Price2DJD(S0, K, T, sigma, sigmatilde, mutilde,... lambda, corr, r); delta10, delta20 81

1.4. Hedging in Jump-Diusion Framework = DengHedge(S0, K, T, sigma, sigmatilde, mutilde,... lambda, corr, r); % holders for intermediate hedge values deltat1 = zeros(1,2); deltat2 = zeros(1,2); deltat1(1) = delta10; deltat2(1) = delta20; % initial value of a risk-free asset B0 = optionprice0 - delta10*S0(1) - delta20*S0(2); Bt = zeros(1,2); Bt(1) = B0; % the next period hedge for i = 1:10000 for j = 1:1 St1 = Sf(j*126+1,1,i); St2 = Sf(j*126+1,2,i); tt = j*126/252; % new delta hedge deltat1(j+1), deltat2(j+1)

Chapter 1

= DengHedge([St1 St2], K, T-tt,... sigma, sigmatilde, mutilde,lambda, corr, r); % new value of a risk-free asset Bt(j+1) = Bt(j)*exp(r*tt) - St1*(deltat1(j+1) - deltat1(j))... - St2*(deltat2(j+1) - deltat2(j)); end % time t option price optionprice = Price2DJD([St1 St2], K, T-t, sigma, sigmatilde, mutilde,... lambda, corr, r); % calculate the loss PL = (deltat1(j+1)*St1 + deltat2(j+1)*St2 + Bt(j+1)) - optionprice; PLerror(i) = exp(-r*.5)*PL/optionprice0; end 82

Chapter 1

1.4. Hedging in Jump-Diusion Framework

% calculate the PDF function edges = -20:0.1:20; PDF = histc(PLerror,edges)10000;

83

85

86

