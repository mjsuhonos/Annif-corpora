MODELING AND CONTROL DESIGN OF RESIDENTIAL HVAC SYSTEMS FOR OPERATING COST REDUCTION
by

Abdul Afram
Master of Science in Mechatronics Engineering, Gwangju Institute of Science and Technology (GIST), South Korea, 2009 Bachelor of Engineering in Mechatronics Engineering, National University of Sciences and Technology (NUST), Pakistan, 2003

A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of Doctor of Philosophy in the Program of Mechanical and Industrial Engineering

Toronto, Ontario, Canada, 2016 © Abdul Afram 2016

Author's Declaration for Electronic Submission of a Dissertation
I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my dissertation may be made electronically available to the public.

ii

Acknowledgements
I would like to thank my supervisor Dr. Farrokh Janabi-Sharifi for providing me with the opportunity to conduct Ph.D. level research in Canada. His continuous guidance kept me focused on the problem at hand during the course of my research. He also provided me with ample opportunities to write the grant proposals, work as a teaching assistant and co-supervise the international students on Mitacs Globalink internships. I am thankful to Dr. Alan Fung for providing appropriate feedback during my research and putting my research first over the other projects when it was time to test the controller design on Toronto and Region Conservation Authority's Archetype Sustainable House, House B (TRCA-ASHB). I am also thankful to the Dr. Wey Leong and Dr. Ahmed Ghasempoor for their positive comments to improve the quality of this dissertation. I would also like to extend my gratitude to the external examiner Dr. Mehrdad Moallem for agreeing to review this dissertation and providing constructive feedback. Special thanks to Mr. Gil Amdurski, Mr. Ricardo Brown and Mr. David Nixon of TRCA for their help during the implementation of the centralized controller. Without their help the implementation of this project would have not been possible. I am also thankful to Amanda Yip and Leigh St. Hilaire for their great coordination efforts and leading roles during the implementation phase. I am also thankful to my lab mates Aleksander, Akbar, Shahir, Ata, Hossein, Lubna, Patrick, Yasar and all others that I forgot to mention for their cooperation and making my time enjoyable. I have spent quite a few memorable moments with my lab mates and made the long term friends during the course of my PhD. In addition to my lab mates, I had the opportunity to interact with several other M.Sc. and Ph.D. students from Dr. Alan Fung's and Dr. Xavier Fernando's group who were working on the TRCA-ASH including Waleed, Navid, Dahai, Raghad, Nima, Ebrahim and Sajjad. I share some wonderful memories with these students and many of them helped me with different aspects of the project such as pick and drop to the TRCA-ASH, sharing of ideas and data. I am thankful to all of them as well. This research was financially supported by the Ryerson University's Center for Urban Energy (CUE), Toronto Hydro and Mitacs-Accelerate Program (Project Title: Development of Residential HVAC and Air Conditioning Demand Management and Control Systems - Modeling and Control Design, IT number: IT02222). The resources such as the HVAC system, monitoring system and data were provided by the Toronto and Region Conservation Authority (TRCA). I am also thankful to Toronto iii

Hydro, Independent Electricity Systems Operator (IESO) and Connect Canada for awarding me with the several research awards which helped me both financially and in terms of research. I am thankful to Ryerson University for providing me with several awards to complete my Ph.D. These awards included Mechanical Engineering Graduate Award, Mechanical Engineering Graduate Scholarship, Ryerson University International Student Scholarship, Access to Opportunity Program (ATOP), Doctoral Completion Award and teaching assistantship (TA) in various courses.

iv

Dedication
To my family including my parents, wife, son, daughter, brother and his family, father in-law, mother in-law, brother in law and his family, sister in law and her family and my uncle Iftikhar Ahmed. Without their continued support, love, encouragement and confidence I may not have succeeded in this journey.

v

Abstract
MODELING AND CONTROL DESIGN OF RESIDENTIAL HVAC SYSTEMS FOR OPERATING COST REDUCTION Doctor of Philosophy, 2016 Abdul Afram Department of Mechanical and Industrial Engineering, Ryerson University The residential HVAC systems in Canada can consume more than 60% of the total energy in a house which results in higher operating costs and environmental pollution. The HVAC is a complex system with variable loads acting on it due to the changes in weather and occupancy. The energy consumption of the HVAC systems can be reduced by adapting to the ever changing loads and implementation of energy conservation strategies along with the appropriate control design. Most of the existing HVAC systems use simple on/off controllers and lack any supervisory controller to reduce the energy consumption and operating cost of the system. In Ontario, due to the variable price of electricity, there is an opportunity to design intelligent control system which can shift the loads to off-peak hours and reduce the operating cost of the HVAC system. In order to take advantage of this opportunity, a supervisory controller based on model predictive control (MPC) was designed in this research. The residential HVAC system models were developed and accurately calibrated with the data measured from the Toronto and Region Conservation Authority's Archetype Sustainable House, House B (TRCA-ASHB) located in Vaughan, Ontario, Canada. Since HVAC is a large and complex system, it was divided into its major subsystems called energy recovery ventilator (ERV), air handling unit (AHU), radiant floor heating (RFH) system, ground source heat pump (GSHP) and buffer tank (BT). The models of each of the subsystem were developed and calibrated individually. The models were then combined together to develop the model of the whole residential HVAC system. The developed model is able to predict the temperature, flow rate, energy consumption and cost for each individual subsystem and whole HVAC system. The model was used to simulate the performance of the existing HVAC system with on/off controllers and develop the supervisory MPC. The supervisory controller was implemented on the HVAC system of TRCA-ASHB and at least 16% cost savings were verified. vi

Table of Contents
Author's Declaration for Electronic Submission of a Dissertation .............................................. ii Acknowledgements ............................................................................................................................. iii Dedication ............................................................................................................................................. v Abstract ................................................................................................................................................. vi List of Tables ....................................................................................................................................... xi List of Figures ..................................................................................................................................... xii List of Appendices ............................................................................................................................xiv Abbreviations ...................................................................................................................................... xv Nomenclature .................................................................................................................................... xix Chapter 1 1.1. 1.2. 1.3. 1.4. 1.5. 2.1. 2.2. Introduction .................................................................................................................... 1 Motivation.............................................................................................................................. 1 Challenges .............................................................................................................................. 3 Style of the Dissertation....................................................................................................... 4 Publications ........................................................................................................................... 4 Structure of the Dissertation ............................................................................................... 6 Review of HVAC Modeling Methods ........................................................................ 7 Introduction........................................................................................................................... 7 HVAC Modeling Techniques ............................................................................................. 9 Data Driven Models....................................................................................................10 Physics-Based Models .................................................................................................18 Grey-Box Models ........................................................................................................28

Chapter 2

2.2.1. 2.2.2. 2.2.3. 2.3. 2.4. 3.1. 3.2.

Performance Comparison Metrics ...................................................................................30 Conclusions .........................................................................................................................33 Grey-Box Modeling .....................................................................................................35 Introduction.........................................................................................................................35 HVAC System Description of TRCA-ASHB ................................................................37 ERV Unit ......................................................................................................................38 AHU ..............................................................................................................................39 BT ..................................................................................................................................39 RFH System and Zone ...............................................................................................40 vii

Chapter 3

3.2.1. 3.2.2. 3.2.3. 3.2.4.

3.2.5. 3.3. 3.3.1. 3.3.2. 3.3.3. 3.3.4. 3.3.5. 3.4. 3.4.1. 3.4.2. 3.4.3. 3.4.4. 3.4.5. 3.5. 3.5.1. 3.5.2. 3.5.3. 3.5.4. 3.5.5. 3.6. 3.7. 3.8. 4.1. 4.2. 4.3.

GSHP ............................................................................................................................40 Model of ERV .............................................................................................................41 Model of AHU.............................................................................................................42 Model of BT .................................................................................................................45 Model of Zone with RFH ..........................................................................................46 Model of GSHP ...........................................................................................................48 ERV Unit Measurements ...........................................................................................49 AHU Measurements ...................................................................................................49 BT Measurements .......................................................................................................50 RFH and Zone Measurements ..................................................................................51 GSHP Measurements .................................................................................................51 ERV Data .....................................................................................................................53 AHU Data ....................................................................................................................53 BT Data ........................................................................................................................54 RFH and Zone Data ...................................................................................................54 GSHP Data ..................................................................................................................55

Modeling ..............................................................................................................................40

Measurements......................................................................................................................49

Extraction, Analysis and Pre-processing of Data ..........................................................51

Model Development in Simulink® ...................................................................................55 Parameter Estimation and Results ...................................................................................59 Conclusions .........................................................................................................................62 Black-Box Modeling and Comparison ......................................................................63 Introduction.........................................................................................................................63 System Description.............................................................................................................64 Modeling ..............................................................................................................................65 Modeling and Validation Data...................................................................................66 Grey-box Models .........................................................................................................71 Black-Box Models .......................................................................................................71 Visual Comparison of the Models ............................................................................77 Analytical Comparison of the Models ......................................................................81 viii

Chapter 4

4.3.1. 4.3.2. 4.3.3. 4.4. 4.4.1. 4.4.2.

Comparison of the Models ................................................................................................77

4.4.3. 4.5. 5.1. 5.2. 5.3. Chapter 5

Rankings of the Models ..............................................................................................87 Review of HVAC Control Systems ...........................................................................89

Conclusions .........................................................................................................................87 Introduction.........................................................................................................................89 Previous Surveys .................................................................................................................91 Classification of HVAC Control Methods......................................................................91 Classical Control ..........................................................................................................92 Hard Control ................................................................................................................93 Soft Control..................................................................................................................94 Hybrid Control ............................................................................................................95 Other Control Techniques .........................................................................................96 Summary .......................................................................................................................97 Comparison of MPC with Other Control Approaches ...................................... 100 Factors Affecting MPC Performance .................................................................... 104 Supervisory Model Predictive Controller Design................................................. 119

5.3.1. 5.3.2. 5.3.3. 5.3.4. 5.3.5. 5.3.6. 5.4. 5.4.1. 5.4.2. 5.5. 6.1. 6.2. 6.3. 6.4. Chapter 6

Model Predictive Control ..................................................................................................98

Conclusions ...................................................................................................................... 116 Introduction...................................................................................................................... 119 System Description.......................................................................................................... 123 Centralized Controller Design ....................................................................................... 125 Centralized Controller Architecture ...................................................................... 125 Cost Function ........................................................................................................... 129 Constraints................................................................................................................. 130 Zone Model ............................................................................................................... 131 AHU Model............................................................................................................... 131 ILAHU Model .......................................................................................................... 133 RFH Model ............................................................................................................... 134 GSHP Model............................................................................................................. 135 BT Model ................................................................................................................... 135 ERV Model ............................................................................................................... 135 Local Level Controller Models............................................................................. 136 ix Supervisory MPC Design ............................................................................................... 129

6.3.1. 6.4.1. 6.4.2. 6.4.3. 6.4.4. 6.4.5. 6.4.6. 6.4.7. 6.4.8. 6.4.9. 6.4.10.

6.5.

Implementation of the Centralized Controller ............................................................ 138 Selection of Hardware for Centralized Controller Implementation ................. 138 Modifications to the HVAC System ...................................................................... 139 Centralized Controller High Level Schematic ...................................................... 140 Centralized Controller Software Architecture ...................................................... 142 Cooling Season ......................................................................................................... 146 Heating Season ......................................................................................................... 155 Conclusions and Future Work ................................................................................ 158

6.5.1. 6.5.2. 6.5.3. 6.5.4. 6.6. 6.6.1. 6.6.2. 6.7. 7.1. 7.2. 7.3. Chapter 7

Results ............................................................................................................................... 146

Conclusions ...................................................................................................................... 156 Conclusions ...................................................................................................................... 158 Future Work ..................................................................................................................... 159 Contributions ................................................................................................................... 160

Bibliography ..................................................................................................................................... 188

x

List of Tables
Table 2-1: Comparison of different modeling techniques in building HVAC field...............................30 Table 3-1: Sensor Type and Accuracy [126].................................................................................................51 Table 3-2: Initial and Estimated Parameters ................................................................................................60 Table 3-3: Performance of the models .........................................................................................................62 Table 4-1: Statistical model structures ..........................................................................................................75 Table 4-2: Rankings of the Models................................................................................................................87 Table 6-1: Electricity TOU Price in Ontario during Summer and Winter 2015 [235] ....................... 144 Table 6-2: Energy Consumption and Cost Comparison......................................................................... 154

xi

List of Figures
Figure 2-1: Data driven modeling techniques ..............................................................................................11 Figure 3-1: TRCA-ASH, ERV unit, AHU, RFH system, GSHP, BT and DAQ system ......................38 Figure 3-2: Energy balance diagram of ERV ...............................................................................................41 Figure 3-3: Energy balance diagram of AHU ..............................................................................................43 Figure 3-4: Energy balance diagram of BT ..................................................................................................46 Figure 3-5: Energy balance diagram of RFH and zone ..............................................................................47 Figure 3-6: Inputs and outputs of the HVAC Subsystems ........................................................................50 Figure 3-7: Temperature and flow rate profiles of air and water in (a) ERV unit, (b) AHU, (c) BT, (d) RFH-zone and (e) GSHP circuits ..................................................................................................................52 Figure 3-8: Inputs and outputs of (a) ERV unit, (b) AHU, (c) BT, (d) RFH-zone and (e) GSHP model in Simulink® ..........................................................................................................................................56 Figure 3-9: Detailed (a) ERV unit, (b) AHU, (c) BT, (d) RFH-zone and (e) GSHP model in Simulink® ...........................................................................................................................................................58 Figure 3-10: Combined HVAC Model .........................................................................................................58 Figure 3-11: Measured vs. simulated responses of (a) ERV unit, (b) AHU, (c) BT, (d) RFH-zone and (e) GSHP ...........................................................................................................................................................61 Figure 4-1: Simplified block diagram of TRCA-ASHB HVAC system ...................................................65 Figure 4-2: Inputs and outputs of the models .............................................................................................66 Figure 4-3: Data for modeling and validation of (a) ERV, (b) AHU, (c) BT, (d) RFH and (e) GSHP ............................................................................................................................................................................70 Figure 4-4: Example of the architecture of a 2-2-1 ANN .........................................................................72 Figure 4-5: Measured vs. simulated response of ERV models..................................................................78 Figure 4-6: Measured vs. simulated response of AHU models .................................................................78 Figure 4-7: Measured vs. simulated response of BT models .....................................................................79 Figure 4-8: Measured vs. simulated response of RFH models..................................................................80 Figure 4-9: Measured vs. simulated response of GSHP models ...............................................................80 Figure 4-10: Comparison of ERV models for output 1 (Teao) (a) actual data (b) normalized data and output 2 (Tfao) (c) actual data (d) normalized data .......................................................................................82 Figure 4-11: Comparison of AHU models for output 1 (Two) (a) actual data (b) normalized data and output 2 (Tao) (c) actual data (b) normalized data ........................................................................................84 Figure 4-12: Comparison of BT models (a) actual data (b) normalized data ..........................................84 xii

Figure 4-13: Comparison of RFH models for output 1 (Tz) (a) actual data (b) normalized data and for output 2 (Twret) (c) actual data (d) normalized data ...............................................................................86 Figure 4-14: Comparison of GSHP models (a) actual data (b) normalized data ....................................86 Figure 5-1: Classification of control methods in HVAC systems.............................................................92 Figure 5-2: Inputs and outputs of MPC based controller ..........................................................................98 Figure 6-1: Schematic diagram of the HVAC system at TRCA-ASHB ................................................ 124 Figure 6-2: Heating controller architecture ............................................................................................... 127 Figure 6-3: Cooling controller architecture ............................................................................................... 128 Figure 6-4: Supervisory MPC architecture ................................................................................................ 128 Figure 6-5: High level schematic of centralized HVAC controller implementation ........................... 141 Figure 6-6: Centralized HVAC controller software architecture ........................................................... 142 Figure 6-7: Weather forecast data downloaded from the server [234].................................................. 143 Figure 6-8: Electricity TOU price during the summer and winter season on weekdays .................... 145 Figure 6-9: Estimated temperature of all zones and BT along with their control signals during cooling season with variable temperature set-points ............................................................................... 148 Figure 6-10: Estimated temperature of all zones and BT along with their control signals during cooling season with fixed set-points at (a) 25 °C (b) 24 °C (c) 23 °C (d) 22 °C ............................... 152 Figure 6-11: Measured temperature of all zones and BT along with their control signals during cooling season ............................................................................................................................................... 153 Figure 6-12: Set-point vs. energy consumption increase......................................................................... 154 Figure 6-13: Set-point vs. cost increase ..................................................................................................... 155 Figure 6-14: Box plot of the air temperature in Toronto for 50 years [236] ........................................ 156

xiii

List of Appendices
Appendix I: Identified Black-Box Models ................................................................................................ 161 Appendix II: Tables for Comparison of Models...................................................................................... 179 Appendix III: Wiring Diagrams of HVAC Interface to Centralized Controller ................................. 183 Appendix IV: Controller Hardware Components and Inputs/Outputs Nomenclature .................... 186

xiv

Abbreviations
4SID AC ACO AHU ANFIS ANN APMonitor APOPT ARIMA ARMA ARMAX AR ARI ARX ASH ASHB ASHP ASHRAE BJ BLAST BT CAV CARNOT CBR CFM CFP CHAID CO2 Sub-space state-space identification Air conditioning Ant colony optimization Air handling unit Adaptive network based fuzzy inference system Artificial neural network Advanced Process Monitor Advanced Process OPTimizer Autoregressive integrated moving average Autoregressive moving average Autoregressive moving average exogenous Autoregressive Autoregressive integrated Autoregressive exogenous Archetype sustainable house Archetype sustainable house, house B Air source heat pump American society of heating, refrigerating and air-conditioning engineers Box Jenkins Building loads analysis and system thermodynamics Buffer tank Continuous air volume Conventional and renewable energy optimization toolbox Case-based reasoning Cubic feet per minute Compact FieldPointTM Chi-square automatic interaction detector Carbon dioxide xv

COP CSV DAQ DDPSO DFL DMPC DP EA EEV ERV FAN FIR FL GA GSHP HRV H-MPC HVAC IAQ IDP IBPT ILAHU ILS I/O JIT KPCA LBMPC LEED LMTD

Coefficient of performance Comma separated values Data acquisition Differential discrete particle swarm optimization Direct feedback linear Deterministic model predictive control Dynamic programming Evolutionary algorithm Electronic expansion valve Energy recovery ventilator Fuzzy adaptive network Finite impulse response Fuzzy logic Genetic algorithm Ground source heat pump Heat recovery ventilator Hierarchical model predictive control Heating, ventilation and air conditioning Indoor air quality Iterative dynamic programming International building physics toolbox In-law suite air handling unit In-law suite Input-output Just in Time Kernel principal component analysis Learning-based model predictive control Leadership in energy and environmental design Log mean temperature deviation xvi

HVACSIM+ HVAC SIMulations PLUS other systems

LP LTI MIMO MIP MISO MLP MPC MSC NI NNARX NOAA NRPE OE OEM PB PDF PID PLR PMAC P-MPC PMV PRAC PSO PWPFM QP RBC RC RFH RTD SAPSO

Linear Programming Linear time-invariant Multiple-input and multiple-output Mixed integer programming Multiple-input and single-output Multilayer perceptron Model predictive control Meteorological service of Canada National Instruments Non-linear autoregressive exogenous National Oceanic and Atmospheric Administration Non-renewable primary energy Output error Original equipment manufacturer Performance bound Probability density function Proportional-integral-Derivative Part load ratio Pulse modulation adaptive controller Piloting model predictive control Predicted mean vote Pattern recognition adaptive controller Particle swarm optimization Pulse-width pulse-frequency modulation Quadratic programming Rule-based control Resistive capacitive Radiant floor heating Resistance temperature detector Simulated annealing based particle swarm optimization xvii

SISO SMPC S-MPC SQL SS SVM TCBM TF TOU TPS TPSC TRCA TRCA-ASH TRNSYS T-S FL VAV VCC WFV WSHP

Single-input and single-output Stochastic model predictive control Scheduling model predictive control Structured query language State-space Support vector machine Topological case-based modeling Transfer function Time of use Thin plate spline Two parameter switching control Toronto and Region Conservation Authority TRCA-Archetype Sustainable House Transient systems simulation program Takagi-Sugeno fuzzy logic Variable air volume Vapor compression cycle Water flow valve Water source heat pump

TRCA-ASHB TRCA-ASH House B

xviii

Nomenclature
Alphabets

adp , , , bdp cdp f dp
a1 , b1 A AE APE

Damper coefficients Coefficients that apply over a certain range of zone air temperature Area [m 2 ] Absolute error [° C] Absolute percentage/relative error [° C] Constants Covariance Thermal capacitance [J/ K] Coefficient of correlation Specific heat of air at constant pressure [J/ KgK] Specific heat of water at constant pressure [J/ KgK] Coefficient of performance Coefficient of variation Polytropic index Coefficient of determination Diameter of supply duct [m] Energy used [kWh] Electricity time of use price [$ / kWh] Fraction of the fan/pump power converted to the fluid thermal energy Goodness of fit Convection coefficient [W/ m 2 K] Enthalpy flow rate [J/ s] Cost function Static gain Derivative gain of PID controller Integral gain of PID controller Proportional gain of PID controller Length [m] Apparent dead time of the process [s] Mass flow rate [kg/ s] Mass [kg] Mean absolute error [° C] Mean absolute percentage/relative error [° C] Maximum absolute error [° C] Mean bias error [° C] Mean squared error [° C] xix

cov C CC

c, c1 , c2

C pa

C pw

COP
CV

d

D

E ETOU f
G

Dsd

h

K Kd Ki

J

 H

Kp
l

L m M MAE MAPE MAX AE MBE
MSE

n N Nv

Number of observations Optimization horizon [Hour] Valve authority Number of operating tower cells Pressure [Pa] Back shift operator Radius [m] Thermal resistance [K/ W] Coefficient of multiple determination Root mean squared error [° C] Heat transfer rate [W/ m 2 ] Duty of evaporator [kW] Energy gain in evaporator [kW] Energy loss in compressor [kW] Standard deviation of absolute error [° C] Standard deviation of absolute percentage error [° C] Temperature [° C] Input/control signal Valve opening Conduction heat transfer coefficient [W/ mK] Conduction heat transfer coefficient to ambient [W/ mK] Conduction heat transfer coefficient between upper and lower water layers [W/ mK] Overall conduction heat transfer coefficient [W/ K] Internal energy of the water [J] Volume [m3 ] Volume ratio of compressor [m3 ] Specific volume [m3 ] Saturated volume of the compressor [m3 ] Noise Power [W] Output Measured value Predicted value Average value Height of the water [m]

N cell
P

q
r

-1

R R2

RMSE

Q
Qevap
Qleak ,evap

Qleak ,comp
Std AE Std APE T u (t )  (t ) u U

U amb

U ud
 U V

UA

Vr

Vs Vst
w( t )

W

y (t ) y  y
y

z

Greek Letters xx

 ,   , , ,     P T ST  
   
Subscripts

Polynomials Effectiveness of heat exchanger Change in pressure [Pa] Change in temperature [° C] Total internal entropy production [J/ K mol] Efficiency Density [kg/ m3 ] Standard deviation Time constant [s] Angular position [rad] Angular velocity [rad/ s]

0,1, 2,3, 4
a ai am

cond
conv

chw, r chw,s cmp cmp, r cmp, s comp

cd

ao a, fresh c cc ch

amb

dp e ea eai eao

d

evap f

ele

Zone 0 (basement), zone 1 (1st floor), zone 2 (2nd floor), zone 3 (3rd floor), zone 4 (4th floor) Air Inlet air Air and metal Ambient Outlet air Fresh air Cooling Cooling coil Cooling and heating coil Condenser Chilled water returning to the chiller Chilled water supplied by chiller Campus Campus water return Campus water supply Compressor Condenser Convective Water below thermocline Damper error Exhaust air Exhaust air at inlet Exhaust air at outlet Electrical Evaporator Floor xxi

fa  fai fao gain
hp int iw IA ma m, ai m, ao max mec mw n o ow ra
h

ref ret rpm rw r , GSHP r , ILAHU r , RFH 1 r , RFH 2 sa

ra1 ra 23

sa1 sa 2 sa3 sd sdi sdo

S SA

sp surf smpw sw s, GSHP

Fresh air Fresh air at inlet Fresh air at outlet Heat gained from internal/external sources Heating Heat pump Internal Inlet water Infiltration air Mixed air Mixed air at inlet Mixed air at outlet Maximum Mechanical Make-up water Number of samples Outside air Outlet water Return air Return air from zone 1 Return air from zone 2 and 3 combined Refrigerant Return water Revolutions per minute Return water Return water from GSHP to BT Return water from ILAHU Return water from RFH system of zone 1 Return water from RFH system of zone 2 Supply air Supply air to zone 1 Supply air to zone 2 Supply air to zone 3 Supply duct Inside the supply duct Outside the supply duct Set-point Surface Fully-mixed sump water Supply water Supply water from BT to GSHP Solar Supply air xxii

u

vol
w

wai wdi
wf

Water above thermocline Volumetric Water i th wall

w, sup
wi wm wo z

w, ret

i th window Water and floor Supply water Return water Water at inlet Water and metal Water at outlet Zone

xxiii

Chapter 1 Introduction
Most residential heating, ventilation and air conditioning (HVAC) systems are controlled by the conventional controllers such as simple on/off controller or proportional-integral-derivative (PID) controller. Simple on/off controller also known as dead-band controller, when employed for the zone temperature control, turns the heating on when temperature falls below a minimum temperature threshold and turns the heating off when the temperature rises above the maximum temperature threshold. The controller stays idle if the temperature stays within the minimum and maximum temperature band hence the name dead-band controller. PID controller on the other hand tries to minimize the error between the temperature set-point and the zone temperature based on the dynamics of the error such as the proportional error, integral error and derivative error. A well-tuned PID controller (i.e., whose P, I and D gains are tuned optimally) minimizes the peak time and percentage overshoot and also eliminates the steady state error. Zone temperature is a slow moving process with time delay. Time varying internal and external disturbances are also acting on the HVAC system. External disturbances are due to the weather variables such as temperature, humidity and solar irradiance. The internal disturbances are due to the behavior of occupants and equipment use. Due to the dynamic disturbances acting on the system and time delay in system response, on/off controller is unable to regulate the process within the desired band and large temperature swings occur resulting in degradation of thermal comfort and higher energy use. PID controller produces either a sluggish or too aggressive response to the disturbances when the operating conditions vary from the tuning conditions. This results in overshoots and undershoots in the zone temperature and degradation of thermal comfort and higher energy usage.

1.1.

Motivation

The main objective of this research is to reduce the energy consumption and operating cost of the HVAC systems without sacrificing the thermal comfort. In order to achieve this objective, the controller should be able to predict the time varying disturbances and counter them in advance due to the slow response time of the HVAC systems. Conventional controllers such as on/off and PID controllers are not up to the task due to their limitations highlighted above. The ideal candidate in this scenario is the model predictive control (MPC). MPC produces an anticipatory control action instead of the corrective control action produced by the conventional controllers and overcomes the 1

limitations of the conventional controllers. MPC employs the system model to predict the future state of the system based on the estimates of the disturbances and produces a constrained control signal which drives the system towards the desired state. Internal disturbances can be estimated using the occupancy and equipment usage schedules. External disturbances can be estimated using a statistical or artificial neural network (ANN) forecast model trained with the historical weather data to produce a short term weather forecast. Alternatively, the weather forecast data can be downloaded from the government web server, e.g., Environment Canada in Canada and National Oceanic and Atmospheric Administration (NOAA) in US. Though the on/off and PID controllers have inherent problems and their performance is inferior to MPC but these limitations are not much visible in the residential systems. A small family house does not have enough thermal mass to affect the regulation of the zone temperature by simple on/off or PID controllers. In contrast, a large condo or office building has much higher thermal inertia and delay in the response to the heating and cooling that it is very difficult to control the zone temperature with on/off or PID controller. In such cases, the MPC can be used to regulate the processes at a local level. Nevertheless MPC can still be used in a residential setting as a supervisory controller. The supervisory controller generates the dynamic set-point trajectories for the local level controllers which then regulate the process at its set-point. A supervisory MPC solves an optimization problem by using a cost function and produces a set-points trajectory for the local level controllers which minimizes the operating cost without sacrificing the thermal comfort. For residential HVAC systems, on/off or PID controller can be used to regulate the temperature at its set-points. In summary, the main motivations for developing the MPC controller for HVAC system are as follows: · · Maximizing the thermal comfort and minimizing the electricity consumption and operating cost Prediction of the future states of the system based on system model and generation of control signal which drives the system towards the desired state and eliminates the wild temperature swings from the set-point · Producing constrained control signal by incorporating the actuator constraints such as rate limit, range limits and capacity limit, etc. 2

· · · · ·

Peak load shifting opportunity by incorporating the variable electricity rate profile in the optimization problem and using active and passive thermal storage Less tuning parameters and consistent response during off-tuning conditions compared to conventional controllers Robustness to time varying disturbances based on the future disturbance estimates considered in control decision Ability to work as both supervisory level and local level controller (though in this research MPC is only used on the supervisory level) Usability in hierarchical configuration for rejection of both slow moving and fast moving disturbances

1.2.

Challenges

The main objective of this work is to design the MPC controller for HVAC system to reduce the operating cost and shift the load to off-peak hours without compromising the thermal comfort of the occupants. Some of the main challenges in the MPC control design for HVAC systems are listed below: · · · · · · Identification of the HVAC processes for MPC control implementation resulting in highest savings such as zone temperature control process and thermal energy storage control Capturing accurate system models suitable for control design using physics-based, data driven and grey-box modeling approaches Validation of the system models with the actual performance measurements Simulation framework design for replicating the existing controllers functionality and design and validation of new controllers in the simulation Development of new controllers and energy conservation strategies in the simulation framework Implementation on the actual HVAC system in Toronto and Region Conservation Authority's Archetype Sustainable House, House B (TRCA-ASHB) after modification of the existing controllers and data acquisition (DAQ) systems · Verification of the energy savings through comprehensive monitoring 3

All of the above mentioned challenges were overcome during the course of this research in order to design and implement the MPC controller on the TRCA-ASHB.

1.3.

Style of the Dissertation

This dissertation follows the manuscript-style dissertation guidelines of the Mechanical and Industrial Engineering Department. It satisfies the following criteria of the manuscript-style dissertation: 1. It contains five journal papers (minimum 3 are required) each making an original and significantly different contribution. 2. The student is the principal author of the papers. 3. All the work reported in the journal papers and this dissertation is primarily contributed by the first author. The student is prepared to stand for, and defend all the work included in this dissertation. 4. Four journal papers have already been published in the highly reputable peer-reviewed journals in the student's field of study. The manuscript for the fifth journal paper is ready for submission to a reputable peer-reviewed journal.

1.4.

Publications

Below is a list of the published journal papers which are the part of this dissertation 1. Abdul Afram, Farrokh Janabi-Sharifi, Review of modeling methods for HVAC systems, Applied Thermal Engineering, Volume 67, Issues 1-2, June 2014, pp. 507-519. (IF: 2.739) 2. Abdul Afram, Farrokh Janabi-Sharifi, Theory and applications of HVAC control systems ­ A review of model predictive control (MPC), Building and Environment, Volume 72, February 2014, pp. 343-355. (IF: 3.341) 3. Abdul Afram, Farrokh Janabi-Sharifi, Gray-box modeling and validation of residential HVAC system for control system design, Applied Energy, Volume 137, 1 Jan 2015, pp. 134-150. (IF: 5.613)

4

4. Abdul Afram, Farrokh Janabi-Sharifi, Black-box modeling of residential HVAC system and comparison of gray-box and black-box modeling methods, Energy and Buildings, Volume 94, 1 May 2015, pp. 121-149. (IF: 2.884) The following journal paper manuscript is not published yet but is the part of this dissertation 5. Abdul Afram, Farrokh Janabi-Sharifi, Supervisory Model predictive control (MPC) design for residential HVAC system, manuscript prepared for IEEE Transactions on Control Systems Technology, Dec 2015 The following journal papers and conference publications were also published during the course of this Ph.D. research but are not the part of this dissertation 6. Abdul Atisam Farooq, Abdul Afram, Nicola Schulz, Farrokh Janabi-Sharifi, Grey-box modeling of a low pressure electric boiler for domestic hot water system, Applied Thermal Engineering, Volume 84, 5 June 2015, pp. 257-267 (IF: 2.739) 7. Abdul Afram, Farrokh Janabi-Sharifi, Alan Fung, Xavier Fernando, Grey-box modeling of a residential multi-zone air handling unit (AHU) through comprehensive monitoring, IEEE International Conference on Smart Energy Grid Engineering (IEEE-SEGE'14), Oshawa, Ontario, Canada, Aug 2014. (Conference "best regular paper award" winner) 8. Abdul Afram, Farrokh Janabi-Sharifi, Giuseppe Giorgio, Data-driven modeling of thermal energy storage tank, 2014 IEEE 27th Canadian Conference on Electrical and Computer Engineering (CCECE), IEEE, Toronto, Ontario, Canada, 2014, 4-7 May 2014; Pages 1-5. The following journal paper manuscript was submitted during the Ph.D. research but is not part of this dissertation 9. Abdul Afram, Farrokh Janabi-Sharifi, Effects of dead-band and set-point settings of on/off controllers on the energy consumption and equipment switching frequency of a residential HVAC system, under review at Energy and Buildings since Nov 2015 (IF: 2.884)

5

1.5.

Structure of the Dissertation

In Chapter 2, a review of the existing HVAC modeling methods is conducted highlighting the several modeling techniques such as white-box, black-box and grey-box models. Several model performance comparison metrics are collected from the literature review and reported in Chapter 2. The grey-box models of the HVAC systems of TRCA-ASHB are developed in Chapter 3. Data measured from the site is used to calibrate the model parameters and the response of the models is evaluated against the measurements using the performance comparison metrics. In Chapter 4 several black-box models [e.g., ANN, transfer function (TF), state-space (SS), process models and autoregressive exogenous (ARX)] of the same HVAC systems are reported and the comparison of grey-box and black-box models is carried out in order to find out the rankings of the models. In Chapter 5, the review of HVAC control systems is conducted with a focus on the MPC. Several examples are given from the literature where MPC performs better than the other types of control systems and produces lower energy consumption, lower cost, better process regulation and better transient response. In Chapter 6, the centralized controller is implemented and tested on the TRCA-ASHB. A supervisory MPC is developed to reduce the operating cost of the HVAC system and the results of the operating cost reduction are summarized. The MPC controller was implemented on the TRCA-ASHB and the cost savings were verified. The conclusions and future work is highlighted in Chapter 7.

6

Chapter 2 Review of HVAC Modeling Methods
This chapter is based on the following published journal paper: · Abdul Afram, Farrokh Janabi-Sharifi, Review of modeling methods for HVAC systems, Applied Thermal Engineering, Volume 67, Issues 1-2, June 2014, pp. 507-519. This chapter presents the literature review of the methods used to model the HVAC systems. The model development is necessary for the study of the energy consumption of HVAC systems. Models are also required to simulate the different supervisory and local loop control strategies to improve the energy consumption efficiency. HVAC systems have complex structures consisting of heat and mass transfer equipment such as chiller, boiler, heating/cooling coils, and supply air ducts. HVAC systems also consist of several sensors and controllers for regulating the controllable variables such as zone temperature, supply air temperature, supply air fan speed, duct static pressure, and chilled water temperature at their set-points. To predict the energy consumption by the HVAC systems accurately, one needs to model the individual components either from the measured data or based on the knowledge of the underlying physical phenomenon. This results in three broad classes of the models known as data driven, physics-based, and grey-box models. In this chapter, major data driven, physicsbased, and grey-box modeling techniques reported in the recent literature are reviewed.

2.1.

Introduction

Modeling of HVAC systems is necessary for studying and regulation of energy consumption and quality of indoor environment. Generally three types of modeling approaches are used for HVAC systems. In the first one, known as the data driven (black-box or inverse) approach, the system performance data is collected under normal use or under a specific test and a relationship is found between the input and output variables using the mathematical techniques (e.g., statistical regression and ANN) [. The second type is known as physics-based (white-box or forward) approach, in which the system models are derived using the governing laws of physics and the detailed knowledge of the underlying process. In the third type, known as the grey-box approach, the basic structure of the model is formed by using the physics-based methods and the model parameters are determined by using the parameter estimation algorithms on the measured data of the system. In order to build the physics-based models and to determine their parameters, the detailed knowledge of the system and its processes is necessary. On the other hand, the data driven models and their parameters can be 7

obtained with little or no knowledge of the system and its processes but comprehensive system performance data is needed for training and testing the black-box models. The grey-box models benefit from the qualities of both the physics-based and data driven models as they use physics-based methods for building the model structure and use system performance data to estimate the model parameters. Physics-based models have very good generalization capabilities but suffer from poor accuracy (due to the non-optimum parameters); whereas, the data driven models have very high accuracy on the training data but suffer from generalization beyond the training domain (due to the non-existent relation between the mathematical model and system physics). Grey-box models benefit from the advantages of the other two types, providing good generalization capabilities as compared to the data driven models and better accuracy as compared to the physics-based models. In this chapter, a review of the data driven, physics-based and grey-box models is provided. Comprehensive modeling resources are available. In addition to the conference proceedings and journals, American Society of Heating, Refrigerating and Air-conditioning Engineers (ASHRAE) has published several handbooks for HVAC system fundamentals [1], Equipment details [2], and its Applications [3]. ASHRAE has also produced energy calculation toolkits for the system primary components (e.g., boiler, heat pump, and chiller) [4] and secondary ones [e.g., ducts, pipes, valves, dampers, pumps, fans, and air handling unit (AHU)] [5] which both include comprehensive dynamic, steady-state, and quasi-steady state models. Also technical documentation of building energy simulation programs [i.e., transient systems simulation program (TRNSYS) [6], EnergyPlus energy simulation software [7], and HVAC SIMulations PLUS other systems (HVACSIM+) [8]] provide the models of common HVAC system components. U.S. Department of Energy maintains a comprehensive listing of building energy simulation software tools which includes popular tools like building loads analysis and system thermodynamics (BLAST), BSim, ESP-r, and DOE-2. Several toolboxes to simulate the building and HVAC systems have also been developed for MATLAB® Simulink®, e.g., international building physics toolbox (IBPT) [9], SIMBAD toolbox [10], conventional and renewable energy optimization toolbox (CARNOT) [11], HAM-tools [12, 13], and ASTECCA toolkit [14, 15]. A few survey works focusing on some classes of modeling approaches have been reported in the literature. Examples include a survey of fuzzy logic (FL) modeling for HVAC systems [16], software used for the simulation of HVAC components [17, 18], and MATLAB® Simulink® use in HVAC systems research [19]. While significant progress has been made in modeling HVAC systems, to the 8

best of the author's knowledge, no recent comprehensive survey of HVAC systems models covering data-driven, physics-based, and grey-box modeling approaches have been reported in the literature.

2.2.

HVAC Modeling Techniques

HVAC modeling techniques are divided into data driven, physics-based, and grey-box models. Models can also be classified as linear or nonlinear, static or dynamic, explicit or implicit, discrete or continuous, deterministic or probabilistic, and deductive, inductive or floating models. According to this classification, most of the physics-based techniques fall under the deductive models; whereas, data-driven techniques fall under the inductive models. Grey-box models are hybrid models and can be categorized under both the inductive and deductive models. Both physics-based and data driven techniques can result in linear/nonlinear, static/dynamic, and explicit or implicit models. Physicsbased techniques generally result in continuous and deterministic models; whereas, data-driven techniques generally result in discrete and deterministic or stochastic models. While developing the physics-based HVAC system models, dynamic models are commonly utilized for the slow moving temperature and humidity processes (e.g., zone temperature dynamics, zone humidity dynamics, and tank water temperature dynamics), and static models are utilized for the fast moving dynamics (e.g., mixed air temperature and carbon dioxide (CO2) concentration in mixing box, and flow rate of air and water through damper and valve respectively) and energy consumption (fan or pump energy consumption). This is because the fast moving processes are many orders of magnitudes faster than the slow moving processes in the HVAC systems and their dynamics are not of interest to HVAC researchers in general. Both static and dynamic models can also be developed for the same subsystem, e.g., the dynamic model of cooling/heating coil can be developed by energy balance on the water and air flow streams resulting in a pair of differential equations; alternatively, the heating/cooling coil static model can be developed by considering the coil as a constant effectiveness heat exchanger. Generally, physics-based dynamic models are developed by thermal-network method. In this method, the heat transfer in HVAC components is often modeled by an electrical network in which resistors and capacitor represent thermal resistivity and capacitance, respectively, while current and voltage represent heat transfer and temperature, respectively. Data driven models are divided into the approaches based on frequency domain models with dead time, data mining algorithms, FL, stochastic models, statistical models, SS models, CBR models, 9

geometric models and instantaneous models. The grey-box approaches differ based on the selection of a particular parameter estimation algorithm; most common of which are nonlinear least squares, simplex search, and genetic algorithm (GA). In the following sections, each class of approaches will be discussed in more details.

2.2.1. Data Driven Models
Major techniques used for data driven modeling of HVAC systems are shown in Figure 2-1. These techniques are not limited to the modeling of HVAC systems and can also be applied for the modeling of other systems whose input and output measured data is available. The following subsections discuss the data driven or black-box models in detail. 2.2.1.1 Frequency Domain Models with Dead Time

Many of the processes in the HVAC system (e.g., dynamics of zone temperature and humidity) are slow moving with time delay due to the heavy thermal inertia of the system. Such processes can be modeled using the first and second order (over-damped) models with dead time [20-23], e.g.,

= G (s)

Y (s) K - Ls = e , U (s)  s + 1

(2.1)

G = (s)

Y (s) 1 = e - Ls . 2 U ( s ) as + bs + c

(2.2)

The first and second order models are developed for single-input and single output (SISO) systems and can be extended to multiple-input and multiple-output (MIMO) systems. Examples of the models developed in the literature include first-order process models for AHU in [20], cooling coil dynamics, and duct TF in [24], temperature sensor in [21], flow meter in [22], and temperature control dynamics of AHU in [23]. To identify the model parameters with dead time, the process identification techniques are applied, e.g., for models of off-coil air temperature, duct static pressure, room temperature, and room pressure in [20]. First and second order frequency domain models with dead time have simple structure and very few parameters to be determined from the measured data. Due to the wealth of the literature on first and second-order systems, the controller design is also straight forward. On the other hand, the data 10

gathering process is intrusive and requires the interruption of the normal operation of the system. Such models are applied to linear and time-invariant (LTI) systems and thus complicated and time varying system dynamics cannot be represented with such models.
Frequency Domain Models Data Mining Algorithms First/Second Order Over-damped Process with Dead Time Artificial Neural Network (ANN) Support Vector Machine (SVM) Fuzzy Adaptive Network (FAN) Fuzzy Logic Models Takagi-Sugeno (T-S) Fuzzy Models Adaptive Network based Fuzzy Inference System (ANFIS) Linear and Polynomial Time Series Regression Auto Regression eXogeneous (ARX) Auto Regression Moving Average eXogeneous (ARMAX) Auto Regressive Integrated Moving Average (ARIMA) State-Space Models Geometric Models Case-Based Reasoning Stochastic Models Instantaneous Models Sub-Space State Space IDentification (4SID) Thin Plate Spline (TPS) Approximation Topological Case Base Modeling (TCBM) Probability Density Function (PDF) Approximation Just In Time (JIT) Model

Data Driven Models

Statistical Models

Figure 2-1: Data driven modeling techniques 11

2.2.1.2

Data Mining Algorithms

A wide variety of data mining and machine learning algorithms such as ANN and support vector machine (SVM) have been applied to the HVAC systems modeling. This class of approaches is often used for modeling complicated and nonlinear system dynamics. The network is trained by a supervised learning (often back-propagation) algorithm. A SVM-based approach projects the nonlinearly separable data into higher dimensional feature space through a mapping function where it can be separated linearly. A comprehensive survey of ANN applications in building energy systems was provided in [25]. A single ANN or multilayer perceptron (MLP) can produce erroneous results due to non-optimum weights obtained during training. To avoid this situation, MLP ensemble can be used in which multiple MLPs can be used and the decision can be made based on the majority vote. HVAC energy consumption model was developed in [26] by using five data mining algorithms (i.e., exhaustive general chi-square automatic interaction detector (CHAID), boosting tree, random forest, SVM, and MLP ensemble) for the construction of the model. MLP ensemble was found to outperform the other algorithms. Example of ANN in HVAC modeling include the one to estimate the ground source heat pump (GSHP) well temperature in [27] using the ambient temperature, inlet water temperature, time of operation, water flow rate, and exchanger heat capacity. ANN models for predicting the energy consumption of AHU and indoor air quality (IAQ) sensors were developed in [28]. IAQ was represented by indoor air temperature, humidity, and CO2 concentration. The clustering of the ANN input variables produced a model with improved prediction accuracy as compared to the model without clustering. The model of HVAC system based on dynamic ANN called non-linear ARX (NNARX) was developed in [29]. ANN was used to model the cooling coil in [30] for application in fault detection. In this application, the difference between the output of real coil and ANN was used to detect the faults in the cooling coil. When there was no fault, the difference was low and when a fault occurred, the difference became large. Examples of SVM in building load forecasting include the estimate of cooling load of the building HVAC system based on the single variable time series [31]. The measured data on the cooling load over a period was used to predict the future cooling load using SVM. The global optima of SVM 12

penalty parameter, intensive loss function and kernel function were found using the ant colony optimization (ACO). The prediction capability of ANN and SVM approaches can be improved by hybrid data mining algorithms. For example hybrid ACO-SVM model outperformed the simple ANN model in [31]. A hybrid SVM based autoregressive integrated moving average (ARIMA) model was used for the building cooling load prediction in [32]. The accurate prediction of the cooling load is mandatory for the optimal control of the HVAC system [32]. The ARIMA model is suitable for linear prediction and SVM is suitable for the nonlinear prediction of the cooling load. The building cooling load was predicted in [33] using the kernel principal component analysis (KPCA) and SVM. The input data was applied to the KPCA, which extracts the nonlinear features from the input data and produces the output data suitable for the SVM. The resultant KPCA-SVM model had good generalization ability and low dependency on the training data. Another method for cooling load forecasting was used in [34] which used simulated annealing based particle swarm optimization (SAPSO) algorithm to compute the parameters of the SVM. The SAPSO-SVM resisted the premature convergence and outperformed the simple SVM-based load forecasting. Data mining algorithms are easy to implementation. They can model noisy data with many variables and complex nonlinear relations between inputs and outputs. Comprehensive literature is available on parameter selection and training methods. Unlike the ANN, the SVM is resistant to over-fitting the data and has better performance than simple ANN. SVM finds the global optimum solution in the data and provides the best fit for the data. In order to build the models using data mining algorithms, large amount of training and testing data is needed. No physical interpretation of the developed model is possible and the performance degrades when conditions deviate from training and testing conditions. These algorithms are suitable for offline model development and online implementation of these algorithms is often cumbersome. 2.2.1.3 Fuzzy Logic Models

FL uses the expert knowledge in the model development. FL models are developed by implementing the if-then-else statements. The rules are written in the form of a table or database [35]. Takagi-Sugeno (T-S) FL modeling method uses the local linear models blended together to model the nonlinear system. Variations of FL technique include fuzzy adaptive network (FAN) and adaptive network based fuzzy inference system (ANFIS). FAN is a five layered network which utilizes the same back13

propagation algorithm as ANN for training of the network. ANFIS comprises of a multilayer structure similar to ANN but unlike ANN each layer performs different function. Its structure is more complicated than ANN or FL alone and is a combination of both. The node architecture and properties remain the same in a single layer but vary across the layers. A review of FL modeling and control of HVAC systems was presented in [16]. Examples of FL include FAN used to model the thermal comfort in [36], T-S FL model of AHU in [37], and model of thermal comfort in [38]. ANFIS was used to predict the fan speed and damper opening using the zone temperature and ambient temperature in [39]. The energy use of the two buildings was predicted by [40] using the ANN and GA based ANFIS (GA-ANFIS). In many HVAC systems, GA-ANFIS performs better than ANN as it has more complex structure than the ANN. For large datasets, the training time for GA-ANFIS is also greater than ANN but is comparable at small datasets. Models developed with FL are generally very simple and easy to understand. FL incorporates the operator's experience in model design. This requires comprehensive knowledge of plant and its various operating states. Alternatively, FL model development requires large amount of performance data for training T-S FL models, FAN and ANFIS. The required knowledge and data for FL model development may not be readily available for many HVAC components and thus presents a difficulty in modeling these components using FL. 2.2.1.4 Statistical Models

The statistical black-box models consist of single and multivariate regression, ARX, autoregressive moving average exogenous (ARMAX), ARIMA, finite impulse response (FIR), Box Jenkins (BJ), and output error (OE) models. The mathematical expression for the generalized structure of statistical black-box models in a simple input/output relationship is given below [41]. Appropriate choice of numerator and denominator polynomials of input u (t ) , output y (t ) and noise

w(t ) results in different models such as ARX, ARMAX, ARIMA, FIR, BJ and OE.
=  ( q -1 ) y ( t )

 ( q -1 )  ( q -1 ) + u ( t ) w(t ).  ( q -1 )  ( q -1 )

(2.3)

14

Some of these models such as FIR, OE and BJ do not consider the output while the others such as AR and ARMA do not consider the input in the input/output equation; therefore, may not be useful for closed loop control system. The models ARX and ARMAX consider both the input and output in their structure and are useful for the design of the closed loop control system. The model ARMAX is superior to ARX as it incorporates the time series of error in the model structure which is essential for capturing the dynamics of the error and better control performance. ARIMA is a generalization of ARMAX, modeling the stationary and non-stationary data into a single step, and consists of autoregressive, integrated and moving average parts. Examples of statistical models include single variable linear model to calculate the energy demand of a variable capacity air source heat pump (ASHP) and a GSHP based on the outside temperature in [42]. The relation between AHU fan speed and power consumption in [43] was modeled using a second order polynomial whose coefficients are derived by curve fitting on the measured data. A more accurate model can include multiple input variables. The model of room temperature and humidity based on the time series regression of the internal and external variables such as ambient temperature, solar irradiance, electricity consumption, zone temperature and zone humidity was presented in [44]. The developed model can predict the room temperature very accurately many days ahead under similar conditions of training data. The ARX model of the energy use and zone temperature (as a function of the temperature set point and ambient temperature) were developed in [45]. The autoregressive integrated (ARI) model for the compressor capacity and power consumption was developed in [46]. The ARX model, ARIMA model, Bayesian networks and ANN for load forecasting in air-conditioned non-residential buildings were compared in [47] concluding that the ARX model outperformed the other three models. Statistical methods such as linear and polynomial time series regression provide steady state modeling which is useful for quick calculations. The model can be obtained with limited data. These models have low accuracy and are unable to capture the nonlinear dynamics of the system. Since the processes in an HVAC system depend on their previous values, a time series regression model (i.e., ARX, ARMAX, and ARIMA) captures these correlations by including the process variables from the previous sampling times. This results in a very accurate model of the process dynamics but the memory requirement increase in order to save the previous values. Correlation analysis must be performed in order to determine the number of previous samples that are important and need to be used in the time series regression model of a process. These statistical methods also work well under time varying 15

process noise. Many useful online tuning algorithms exist for these methods. MIMO model identification using these methods requires large number of parameters to be determined. Model tuning requires experience as brute force tuning takes a long time to tune the model parameters. 2.2.1.5 State-Space Models

This class of black-box model derives the system model from data directly into the SS form. The subspace SS (4SID) model determines the sequence of the states and system matrices from the input and output data measurements. It requires only one parameter, i.e., the number of block rows of Henkel matrix to be supplied by the user for model tuning [48]. A 4SID model is a deterministic technique and does not use the recursive algorithms for tuning hence requiring short time to tune the model. A 4SID model complexity does not increase and can be easily extended to MIMO systems. However, a 4SID approach needs lot of input and output measurement data for tuning the model so online implementation is complicated. The model developed with 4SID technique performs poorly if the process noise has time changing properties. 2.2.1.6 Geometric Models

Geometric modeling methods deal with the construction and representation of the curves, surfaces and volumes. Thin plate spline (TPS) is part of the geometric modeling methods. The name of TPS comes from the shape of the function that resembles a bent thin plate with smooth surface. TPS has the smooth features and good ability of extrapolation. TPS maps the input output data using a function which contains the weighted sum of Green's function and linear regression terms [49]. TPS compared to ANN has its own advantage as it is independent of initial conditions; however, unlike the ANN, it is sensitive to the noise present in the data on which it interpolates. It also has the disadvantage of being computationally expensive as the data size increases [49]. 2.2.1.7 Case-Based Reasoning

Case-based reasoning (CBR) models make use of the similar past cases to construct the models [50]. Topological case-based modeling (TCBM) is a special CBR technique in which the models are built on a subset of data instead of the whole data. The algorithm of TCBM finds the cases whose inputs are the most similar to the new inputs and averages the outputs of the similar cases as the corresponding new output [49]. Once the real outputs are obtained, it adds them to the case-base and 16

adapts to the new situation. If a previous case is not found in the database, the output is computed based on the neighborhood cases. CBR approach is suitable for a nonlinear and ill-defined system. It reduces measurement noise and compresses the data. The models mature with time and add data to the case-database online to increase the future prediction performance. The case-database should be comprehensive to cover all the input cases. CBR technique suffers from the problems related to the unseen cases. 2.2.1.8 Stochastic Models

Stochastic models deal with the random processes. Some processes (e.g., energy consumption of some mechanical systems) in the HVAC systems act as random variables and can be modeled using the probability density functions (PDF). The energy used by the fans of a large hypermarket (a superstore combining a supermarket and a department store) based on the operating schedule was modeled in [51] using the Gaussian PDF. The variable speed fans were assumed to be operating at the minimum power level during the unoccupied hour and the energy consumption during the occupied hours was assumed to follow a normal distribution function. Many physical processes can be approximated to standard normal and uniform distributions. However, a large amount of data is required to obtain the accurate shape of the PDF of a random variable. The model predictions suffer if the PDF is not modeled properly. 2.2.1.9 Instantaneous Models

Just in time (JIT) model comprises of a statistical model and a pattern model. JIT approach uses previous data to find the patterns similar to the current data. It combines the statistical modeler with the pattern recognition modeler and provides good prediction results. For example, in [52] the load pattern model algorithm searches the database for the similar weather condition to today's and peak load statistical model with today's weather prediction adjusts today's load pattern. JIT model can be applied for modeling the other HVAC components such as cooling coil model, and chiller model from the measured data. In order to implement JIT technique successfully, large database is needed. Missing data creates major problem and if the number of parameters is large, the search could take longer.

17

2.2.2. Physics-Based Models
Physics-based models are also known as analytical first principal models, forward models or whitebox models. These models are based on the detailed knowledge of the process and its underlying physical principles. They require significant effort to develop and calibrate. Though the physics-based models usually take the form of time-domain differential equations, they can be readily converted to frequency domain TFs [53] or time-domain SS representations [54, 55]. TFs and SS models developed from the physical equations are different from the data driven modeling approaches discussed above which do not have underlying physical meanings. Major applications of physics-based modeling approach to HVAC components are discussed in the following subsections. 2.2.2.1 Zone Model

The zone temperature is maintained by adding or removing the heat to balance the internal and external gains and losses [38]. The zone model can be obtained by the energy balance of a room in the steady state [55]. Heat is transferred to the zone through the supply air, conduction through walls and windows, air infiltration, and internal and external gains due to the humans and solar flux [56]. Heat transfer to a zone is commonly modeled by using heat conduction equation model, heat balance method, weighting factor (response factor or TF method), and thermal-network method [57, 58]. In heat balance method [58], the energy flow is modeled using the first law of thermodynamics (i.e., conservation of energy). For a zone, generally a heat balance equation is written for each heat transfer element (wall, window, ceiling, floor, etc.) and zone air. These equations are simultaneously solved to find the unknown temperature of the zone and surface of each heat transfer element using the matrix algebra techniques. Once the surface temperatures are determined, convective heat transfer to and from the zone air can be calculated. Zone temperature can be calculated by the following equation at a time step j
a1 +  Asurf ,i hconv , surf ,iTsurf ,ii , j +  a C pVIAj To j +  a C pVSAj TSAj + Qconv ,int j
i =1 N

Tz j =

-b1 +  Asurf ,i hconv , surf ,i +  a C pVIAj +  a C pVSAj
i =1

N

,

(2.4)

where i represents the surface number in the zone. The coefficients a1 and b1 apply over a certain range of zone temperature. Similar equations need to be written for each element enclosing the zone 18

and solved simultaneously to compute the zone air temperature. Once these coefficients are determined, the heat transfer rate to the zone can be calculated as follows:

Qz= a1 + b1Tz j . j

(2.5)

The heat balance method can be expanded to multiple zones but the size of the coefficients required for solving the simultaneous equations becomes too large resulting in increased computation time. In weighting factor method, heat gains and losses are calculated using the z-TFs. Two types of weighing factors, i.e., heat gain weighting factors (relating zone cooling load to instantaneous heat gain) and air temperature weighting factors (relating zone air temperature to the total load of the zone), represent the TFs. The cooling load at time j is calculated as

Q j= v0 q j + v1q j -1 + ... - w1Q j -1 - w2Q j - 2 + ... .

(2.6)

The cooling load at time j is the linear combination of present and past values of instantaneous heat gain (q j , q j -1 ,...) and previous values of cooling load (Q j -1 , Q j - 2 ,...) . The weights of the linear combination (v0 , v1 ,..., w1 , w2 ,...) are the heat gain weighting factors. Heat gain weighting factors are different for each heat source due to the variation in amount of convective and radiation energy leaving each source. Heat gain weighting factors also differ across buildings since there is a variation in thermal properties of various materials used during construction. Zone air temperature at time j can be calculated as

Tz= 1/ g 0 + [(Q j - ER j ) + P 1 (Q j -1 - ER j -1 ) + P 2 (Q j - 2 - ER j - 2 ) + ... - g1Tz j -1 - g 2Tz j -2 ]. j

(2.7)

Zone temperature at time j is the linear combination of present and past values of cooling load

(Q j , Q j -1 ,...) , energy removal rate (ER j ,ER j -1 ,...) and deviation of air temperature from set point

(Tz j-1 , Tz j-2 ,...) . The weights of linear combination ( P 1, P 2 ,..., g 0 , g1 ,...) are called temperature
weighting factors and typical values for light, medium and heavy room envelope construction are provided in [58].

19

While using the weighting factor method, it is assumed that the heat transfer processes are linear and the system properties influencing the weighting factors are not changing with time. This could be limiting the application of this approach. In thermal-network model, the building is divided into a network of nodes with interconnecting paths through which the energy flows. The implementation of this method varies based on the selection of nodes on which energy balance is applied. This method is considered as the refinement of heat balance method. Temperature for a single zone using the lumped parameter model is given in [24] by applying the heat balance on the zone air as follows:

dTz  aVz C = mSAC pa (TSA - Tz ) + U wa Awa (Twa - Tz ) + U wd Awd (Twd - Tz ) + QS + Qint . (2.8) z dt
i i i i i i

Following are some of the examples of various implementations of thermal-network model. Models of building envelope can be developed by applying the heat balance on the outside surface and inside surface of the zone in conjunction with the zone air [43]. In [59], room was modeled by applying the energy balance on walls, two layers of floor and zone which yielded four equations. Two layers of floor help to model the radiant floor heating (RFH) system. The zone temperature model in [53] was obtained by energy balance on the zone, two walls, and the ceiling also resulting in four equations. The models discussed above only consider the heat transfer to the zone through the process of convection (by ventilation, air infiltration and exfiltration) and conduction (through walls, windows, floors and ceiling). The radiant exchange between surfaces or neighboring zones occurs if they are at different temperatures. The radiant exchange between two surfaces is provided by the StefanBoltzmann law and becomes significant when the surfaces are at significantly different temperatures or the energy transfer to a zone is calculated for a longer period of time (e.g., a year) and cannot be ignored [60]. Humidity ratio and CO2 concentration in a zone was modeled in [53] and [61]. These models take into consideration the CO2 and humidity generated by humans. The rate of change of CO2 and humidity in a zone is dependent on the supply air flow rate and difference between the zone and supply air concentration as well as the number of persons present in the zone.

20

2.2.2.2 Cooling and Heating Coil Model In an HVAC system, the heating/cooling coil conditions the supply air to maintain the indoor temperature. Reheat coil is used in the variable air volume (VAV) box to control the temperature of the supply air. The cooling coil dynamic temperature model can be obtained by the energy balance on the water and air side of the coil ([62], [63], [64], [53]). Mass balance on the air side gives the humidity ratio of the outlet air. The temperature of outlet water and air is given as follows:

dTow Cwm = mwC pw (Tiw - Tow ) - (UA )cc (Tow - Tao ) , dt dTao C pa= dt

(2.9)

(UA)cc (Tow - Tao ) - maC pa (Tao - Tai ) .

(2.10)

In [65] heating system was modeled by calculating the heat delivery rate of the radiators due to convection and radiation. The cooling/heating coil can also be modeled as a constant effectiveness heat exchanger [6, 66, 67]. This type of steady state model is very simple and determines the temperature of the outgoing air and water from the inlet air and water temperature as follows:
= Tiw - Tow

mwC pw

 Qmax

,

(2.11)

= Tai - Tao

ma C pa

 Qmax

.

(2.12)

= = Qmax mwC pw (Tai - Tiw ) . Qmax ma C pa (Tai - Tiw ) when ma C pa < mwC pw , otherwise where
2.2.2.3 Duct and Pipe Model The conditioned air is supplied to the zone and exhaust air is extracted from the zone through the ducts. The air passing through the ducts loses its energy to the surrounding environment due to the heat transfer loss through the walls of the duct. The supply duct model represents the heat transfer between the air inside the duct and the ambient [55] given as follows:

dTsdi 4U sd (Tamb - Tsdi ) = . dt Csd Dsd  a
21

(2.13)

The supply air duct model in [53] gives the variations of the outlet temperature with respect to the inlet temperature of the air as follows:

dTao = dt
2.2.2.4 Mixing Box Model

(U sdi + U sdo ) maC pa
U sdi M sd Csd

(Tai - Tao ) .

(2.14)

A portion of the return air from the zone is mixed with the fresh air from outside in a mixing box and mixed air is supplied to the zone after passing through heating/cooling coil [62]. The mixed air temperature is the linear combination of return air and fresh outside air temperature [53] given as

Tm =

moTo + ( mSA - mo ) Tz . mSA

(2.15)

By replacing all temperature variables with the corresponding CO2 concentration or humidity ratio variables in the above equation, one can get the similar linear relation for finding the mixed air CO2 concentration [61] or humidity ratio [66], respectively. 2.2.2.5 Damper Model The damper controls the flow rate of the air in HVAC system. The mass flow rate of the air passing through the damper depends on the control signal u (t )  [0,1] which controls the damper opening [22]
= ma adp e dp
b u (t )

+ f dp .

(2.16)

In the damper model presented in [39], the mass flow rate of the air through the damper depends upon the damper flow coefficient, pressure difference across the damper and the position dependent flow cross section area of the damper

= ma cdp   (  a Pdp Adp  ).
2.2.2.6 Valve Model

(2.17)

Valves control the flow rate of water and refrigerant in HVAC system. Expansion valve is used in chiller to control the flow of the refrigerant from condenser to evaporator. Valve is also used to control 22

the flow rate of the water to cooling or heating coil. The nonlinear hydraulics of the plant are modeled using the valve travel vs. the water flow rate graph in [21]. A linear model of the valve relating the

 ( t ) depends upon the control signal to the valve opening is provided in [63]. The valve opening u
control signal u (t )  [0,1] and the valve authority. The valve opening and water flow rate is given as follows:
 (t ) = u u (t ) u 2 ( t )(1 - N v ) + N v ,

(2.18)

 (t )mw,max . mw = u

(2.19)

The model of a temperature regulating valve for hydronic radiator is given in [59]. The relation between the valve opening and the water flow rate can be modeled by a third order polynomial equation with constant coefficients. The refrigerant flow rate in a chiller expansion valve is modeled using orifice equation in [68] as follows:

 = mref cvalve   cond ( Pcond - Pevap )  .
n

(2.20)

The curve of flow coefficient cvalve is provided by the manufacturer and n is a constant. 2.2.2.7 Fan and Pump Model Fans control the flow rate of air and pumps control the flow rate of water and refrigerant through the HVAC system. For example, in GSHP, refrigerant is circulated in the ground loop and in AHU, water is circulated through cooling/heating coils using pumps. The power consumption of the fan or pump depends on the flow rate, pressure difference between inlet and outlet and efficiency of the fan or pump ([69], [22], [70], [71]). The temperature of air passing through fan increases due to the inefficiencies of the fan motor if the motor is installed in the air stream. The temperature of the air at the outlet of the fan is given by [6]

Tao = Tai +

W fan f ma C pa
23

.

(2.21)

2.2.2.8 Storage Tank Model Storage tank stores the chilled and hot water to be supplied to the cooling and heating coil [72]. The temperature at the outlet of the tank is given as the summation of the heat transferred by the inlet water, heat supplied by the heat pump and heat lost to the ambient as follows:
1 dTow  -m C ( T - T ) + Ehp Ehp ,maxCOP + (UA)tank ( Tamb - Tiw )  = . dt  wC pwVtank  w pw iw ow

(2.22)

A more comprehensive model dealing with the charging and discharging modes of a stratified thermal storage tank was provided by [73]. A large university campus was supplied by a 30m high thermal storage tank. The thermocline layer which separates the hot water from the cold water, formed at about 20 m height. During the cooling mode, the water was warm above the thermocline and cold below it due to the return water from the campus entering the top of the tank. The chiller supplied the water near the bottom of the tank and the water supplied to the campus was also from the bottom of the tank. During charging mode, the flow rate of the water supplied by the chiller was higher than the flow rate of the water supplied to the campus. During discharging mode, the flow rate of the water supplied by the chiller was lower than the flow rate of the water supplied to the campus. Despite the different flow rates of the independent charging and discharging circuits, the water volume in the tank remained constant as the supply and return water flow rate in both the charging and discharging circuits was equal. The tank dynamics during the charging mode are given as

 =m C T , H d d pw chw, s

(2.23) (2.24) (2.25)

 =mC T , H u u pw u
Tcmp , s = Tchw, s ,
Tchw,r = Tcmp ,r mcmp ,r - Tu mu mchw,r .

(2.26)

The tank dynamics during the discharging mode are given as

 =m C T , H d d pw d
24

(2.27)

 =mC T , H u u pw cmp ,r
Tcmp ,s = Tchw,s mchw, s - Td md mcmp ,

(2.28)

(2.29)

Tchw,r = Tcmp ,r .
The internal energy of the tank is

(2.30)

 +Q   =  +Q U H u u d >u amb >u ,  +Q   =H + Q U d d u >d amb > d .

(2.31) (2.32)

  where Q amb >u and Qamb > d are the heat transfer rate in Watt from the ambient to the warmer and cooler
water in the tank respectively given as

 = (T - T )(2 r l )U , Q amb >u amb u tank u amb  = (T - T )(2 r l )U , Q amb > d amb d tank d amb

(2.33) (2.34)

  and Q u > d denotes the heat conducted from warmer water to cooler water and Qd >u represents the
heat conducted from cooler water to warmer water in the tank given as

 = (T - T )( r 2 )U , Q u >d u d tank ud  = (T - T )( r 2 )U . Q d >u d u tank ud
2.2.2.9 Boiler Model

(2.35) (2.36)

Boiler consumes fuel and produces hot water. The temperature of the water in a boiler is given by the heat supplied and the difference in supply and return water temperature [74]
dTboiler 1 Qheat + mwC pw (Tiw - Tow )  . = dt mwC pw 

(2.37)

25

2.2.2.10 Chiller Model The chiller can be broken down into its individual components evaporator, condenser, compressor and expansion valve which can be modeled separately. The chiller works on the basis of vapor compression cycle (VCC) [68]. In VCC refrigerant gains heat from the conditioned zone and gets evaporated in the evaporator. The compressor increases the pressure of refrigerant making it superheated and releases it into the condenser where the heat is rejected to the water or air. Then the expansion valve reduces the pressure by releasing the refrigerant in the evaporator in a cool state and the cycle continues. Both condenser and evaporator can be modeled as classical heat exchangers [75]. The model of the compressor outlet pressure and mass flow rate were given by [76] as follows:
  Wcomp d Pcond =+ PevapVrd Vr  mecele - Pevap (Vrd -1 - 1)  , mref Vs d - 1    

(2.38)

mref =V   st  ref volrpm .

(2.39)

The chiller power consumption is dependent on the water flow rate, heat capacity of water, temperature difference between entering and leaving water in chilled water loop and coefficient of performance (COP) of the chiller [69]. COP of the chiller varies based on the load on the chiller. Ref. [61] provided the model for computation of COP from part load ratio (PLR). In this model [61], COP was high when PLR was low and vice versa. Ref. [77] compared the performance of ASHRAE primary toolkit model, Gordon-Ng universal chiller model and DOE-2 model. First two chiller models are physics-based; whereas, the last model is empirical model. The two physics-based models differ in the methodology and assumptions made during the development of the models. All three models were found to be equally accurate. GordonNg universal chiller model provides the linear performance equation as follows:

Tevap ,in  Tevap ,in (Tcond ,in - Tevap,in ) + RQevap 1 + 1  , 1  1 1 + = -  S + Q T leak , eqv     Tcond ,in  COP  Qevap Tcond ,inQevap Tcond ,in  COP 

(2.40)

26

= R

1 1 , +  cond mcond C pw  evap mevap C pw
Qleak ,compTevap ,in Tcond ,in - Tevap ,in .

(2.41)

= Q Qleak ,evap + leak , eqv
2.2.2.11 Heat Pump Model

(2.42)

Heat pump provides energy from a source of heat to a sink of heat. Most common categories of heat pump are ASHP, water source heat pump (WSHP) and GSHP. In the cooling mode, heat pump extracts heat from a conditioned zone or thermal storage, and rejects it to the ambient air, water or ground depending on the type of heat pump. In the heating mode, the operation of the heat pump reverses and the heat is extracted from the ambient air, water or ground and rejected to the conditioned zone or thermal storage. Heat pump also works on the basis of VCC as described in the above section. As described above, evaporator and condenser can be modeled as classical heat exchangers. The models of expansion valves and compressor are also provided in the previous sections. Analytical models of ground heat exchanger of a GSHP based on line source theory and cylindrical source theory were reviewed in [78]. The later model is more accurate than the former model due to its distinct physical meanings and forms the basis of many numerical simulation models. Above mentioned analytical models along with numerical models of ground heat exchanger (e.g., finite difference method, finite element method, finite volume method, response factors model, and load aggregation algorithms) were also reviewed in [79]. A comprehensive review of WSHP models (i.e., analytical models, empirical models and models falling between the two extremes) was provided in [80]. 2.2.2.12 Cooling Tower Model Cooling tower is used to reject heat from the chiller condenser. Fans and pumps in the cooling tower are controlled to maintain a desired water temperature entering the condenser. Cooling tower can be modeled as a heat exchanger in which the heat is rejected to the air through natural or forced convection. Physical models of cooling tower are developed using Merkel's method and EffectivenessNTU method; whereas, empirical model is developed by Stoecker's method [81].

27

The heat rejection of the tower cell and sump water temperature based on the Effectiveness-NTU method is given by [82]. Heat rejection is given as

Qtower  a ma (hao - hai ). =

(2.43)

Water is lost in the operating tower cells due to evaporation. To keep the level of water in sump reservoir constant, water enters the sump reservoir from water make-up source. The flow of the water make-up is equal to the total water loss from the cells. The sump water is considered to be fully mixed and its temperature is given as [82]
N cell   dTsmpw Ncell  =  mow (Tow - Tsmpw ) +  miw -  ( mow )k  (Tmw - Tsmpw )  . k dt = k 1= k 1   

w

(

)

(2.44)

Physics-based models provide good generalization capability but lack the accuracy compared to the data driven models. The calibration of the physics-based models also presents a difficult challenge due to the identification of large number of parameters.

2.2.3. Grey-Box Models
Grey-box models use physics-based models as the model structure whose parameters are estimated from the measured data. These models provide physical meaning and are useful for control applications with generalization capability superior to data driven models. Grey-box models also capture the effects of any un-modeled dynamics of the system which were left out of the modeling equation by choosing appropriate parameters. Knowledge of both the physical phenomena and the data from the process is needed to find the parameters. The zone model in [83] was represented by a resistive capacitive (RC) circuit. GA was used to find the model parameters such as thermal resistances and capacitances with best fit to the measured data. The lumped capacitance model of the thermal zone in [84] was obtained using the heat balance equations on zone air and wall. The parameters of this grey-box model were identified from the indoor temperature, outdoor temperature and energy consumption. These parameters can be obtained using the construction data of the building and can also be estimated from the measured data using a parameter identification method. In [85], the zone model was represented by RC circuit whose parameters were identified by quadratic programming (QP) optimization algorithm. The model 28

parameters were estimated from the data obtained by a comprehensive zone model developed in EnergyPlus. The physics-based ARMAX model of room temperature was developed in [56]. The model was able to predict the room temperature quite accurately up to ten weeks ahead. A SS model of the room with zone temperature and outside air temperature as the state variables and HVAC power as the input was given in [86]. The system matrices were obtained by applying least squares method on the measured data. The continuous model of the cooling coil and chilled water flow rate control valve was developed in [63]. The grey-box models of the electronic expansion valve, thermostatic expansion valve, compressor and evaporator were developed in [87]. The parameter estimation of the grey-box models was performed by the numerical search methods nonlinear least squares and simplex search. The parameters were successfully identified from the measured data using both methods. The cooling coil model was given in [88] and [89] whose parameters can be determined by manufacturer's data or by real time experimental data. The cooling coil model for water and air temperature as well as the coil capacity whose parameters can be determined from the real time experimental data is given in [82]. The model for power consumption of the chiller as a function of chilled water temperature was given in [90]. The power of the chiller was a function of water temperature change and voltage. The model parameters were found using the least squares estimates on the measured data. Grey-box models provide good accuracy than physics-based models and better generalization capability compared to data driven models but they are also the hardest to develop. In order to develop grey-box models, both the knowledge of underlying physical phenomenon and input-output data of the system is required. For some HVAC subsystems, the underlying physical phenomenon could be very complicated to model and for other systems, the input-output data may not be readily available making it difficult to develop the grey-box models. The parameters for grey-box models also need retuning when the operating conditions deviate from the training data in order to ensure higher accuracy. Table 2-1 provides the comparison of the models based on the criteria of auto tuning, robustness to parameters and disturbances, and ability to model linear or nonlinear, SISO or MIMO systems.

29

Table 2-1: Comparison of different modeling techniques in building HVAC field Criteria
Model noisy data Tuning parameter count L H M H H M M L L L L Generalization capability Ease of tuning Robustness to parameters Robustness to disturbances

Modeling technique

Frequency domain models with dead time Data mining algorithms FL models Statistical models SS Models Geometric models CBR Stochastic model Instantaneous models Physics-based models Grey-box models

M M M H L M M L M L L

Y N N Y N N Y N N N Y

Y N Y N N N Y N N N Y

N N Y N N N N N N N Y

N Y N Y N N Y Y N N Y

M H H L H M M H M L H

L L M M L M M L L H M

Lin NL NL Lin Lin NL NL NL NL Lin/NL Lin/NL

MIMO MIMO MIMO MIMO MIMO SISO MIMO MIMO MIMO MIMO MIMO

Note: Y ­ Yes, N ­ No, H ­ High, M ­ Medium, L ­ Low, Lin ­ Linear, NL ­ Nonlinear

2.3.

Performance Comparison Metrics

In order to compare the prediction results of different models and their deviation from the measured data performance metrics are defined. Following metrics are used for comparing the performance of different models ([26], [28], [29], [32], [39], [40], [56], [91-94]): Absolute error [26, 92] Absolute percentage/relative error [26, 29, 92] Maximum absolute error [56, 91] Mean bias error [93]

AE y- y , = 
 y- y , y

APE =

max i yi -  MAX = yi , AE

= MBE

1 n   y i - yi , n i =1

(

)

30

SISO/MIMO models

Linear/nonlinear model

Auto tuning

Prediction accuracy

(2.45)

(2.46)

(2.47)

(2.48)

Mean absolute error [26, 28, 56, 91, 92] Mean squared error [56, 92] Root mean squared error [39, 93, 94] Mean absolute percentage/relative error [26, 28, 29, 92]

MAE =

1 n AEi ,  i =1 n
1 n  y i - yi  i =1 n

(2.49)

= MSE

(

),
2

(2.50)

RMSE = MSE ,

(2.51)

1 n MAPE =  i =1 APEi , n

(2.52)

Standard deviation of absolute Std AE = error [26, 28, 29, 92] Standard deviation of absolute Std APE = percentage error [26, 28, 29, 92]

1 n 2 ( AEi - MAE ) ,  i =1 n -1
1 n 2 ( APEi - MAPE ) ,  i =1 n -1

(2.53)

(2.54)

2 Coefficient of variation (RMSE) RMSE 1 1 n  = = CV y ,  i - yi i =1 y n y [40, 93, 94]

(

)

(2.55)

Correlation Coefficient [91]

CC =

cov y,  y

 y  y

( ),
( )
    ×100,   

(2.56)

Goodness of fit [92]

 2 n   - y y  i=1 i i  G= 1 - 2 n  1 n   - y y i 1=  i  i  = n i1   

(2.57)

31

Coefficient of determination [56]

D=

)) ,     ( n (  y ) - (  y ) )  n (  y ) - (  y ) 
n yi  y i - (  yi )
2 i

(

(

yi 
2 i

2

(2.58)

2 i

2

i

Coefficient of multiple determination [39]

R2 =

y - y) (  1-  (y - y )
n i =1 n i =1 i i i i

2

. 2

(2.59)

AE is the absolute difference between the value predicted by the model and the measured value at each sampling instant. While raw difference between predicted and measured value can take both positive and negative values, AE is always positive. APE is the normalized error and can be used to compare the model performance across different datasets. Errors are also called residuals and residual analysis is used in statistical regression to determine the prediction ability of a certain model. If there is no pattern in the residuals and they seem random, then the model is a suitable fit. If the residuals show a pattern (e.g., a U-shape, an inverted-U shape) then a linear model is not suitable for the data and a more suitable nonlinear model is desirable. While MAXAE computes the maximum value of absolute error, MBE, MAE, MSE, RMSE, MAPE, and RME compute the averages of bias, absolute, squared, root-squared, absolute percentage, relative and absolute relative errors and measure how close forecasts are to the actual outcomes. Since average of a purely random error is zero; therefore, the values of MBE, MAE, MSE, RMSE, MAPE, and RME average errors close to zero indicate a more useful prediction. Compared to other mean errors defined above, MSE has advantages such as it is analytically tractable and measures the precision (variance) and accuracy (bias) [95]. StdAE and StdAPE measure the dispersion (variance) of AE and APE from their respective means. CV is the normalized measure of the dispersion of the error probability distribution from its mean value. Lower values of StdAE, StdAPE, and CV mean that the model predictions are closer to the observations. The dispersion of error is used to see the trend in error (i.e., increasing, decreasing or constant). A purely random error exhibits a fixed dispersion and thus has a constant distribution. Obviously, the dispersion of an increasing error also increases and that of a decreasing error also decreases. 32

CC measures the dependent relationship or strength of association between two datasets (i.e., model predictions and actual measurements). If they are highly correlated, the value of CC will be close to 1 for positively correlated or -1 for negatively correlated. As the relationship between the two datasets decreases, the value of CC starts to change and approaches to 0 for completely uncorrelated datasets. R2 is the square of CC and ranges from 0 to 1. G, D, and R2 describe how well a model fits the measurements. While the values of G range from 0 to 100, the values of D and R2 range from 0 to 1. Higher values correspond to a better fit of the model predictions to the measurements. Both D and R2 produce similar values on the same data set and can be used alternatively. In the later chapters these performance comparison metrics were calculated for the same dataset and it was found that CV, CC, G, D and R2 provide almost the same information about model performance and computation of only one of them should suffice. In addition to the above mentioned methods, ASHRAE standard [96] provides the methods for model validation and testing for building energy performance simulation programs. In order to comply with this standard, the software has to successfully pass the comparative tests, analytical verification, and empirical validation of building envelope and mechanical equipment simulations [97]. Home energy rating system building energy simulation test (HERS BESTEST) [98] provides the guidelines for developing the pass/fail criteria for energy simulation programs based on the comparison with reference programs (i.e., BLAST, DOE2 and SUNCODE). ISO standard [99] provides the methods for calculation of room temperature, with standard [100] outlining the general criteria and validation methods for room temperature calculations.

2.4.

Conclusions

In Chapter 2, the general techniques used for modeling HVAC systems were reviewed. Three main classes were identified and include data driven, physics-based and grey-box methods. · The data driven methods completely rely on the measurement data of the input and output variables and fit the linear and nonlinear functions to approximate the behavior of the system as close as possible. These models include well established techniques such as frequency domain models with dead time, data mining algorithms (e.g., ANN and SVM), FL models (e.g., FAN and ANFIS), and statistical models (e.g., ARX, ARMAX and ARIMA). 33

·

On the other hand, physics-based models completely rely on the knowledge of the process and the physical laws governing this process. The models built using physics-based methods represent the system more closely and have better generalization capabilities. The data driven models tend to degrade as the conditions vary from the training data.

·

Another modeling technique known as the grey-box models exists at the intersection of the physics-based and data driven models. Grey-box models use physical laws to define the overall structure of the models and use measured data to find the parameters of these models. For parameter identification, many optimization techniques such as least squares, gradient descent and GA are used.

·

In order to compare the performance of the models several performance comparison metrics are used in the literature. Such metrics were collected from the literature survey and reported in Chapter 2.

·

The qualitative comparison of different modeling techniques was also carried out based on their strengths, weaknesses, ease of tuning, robustness and ability to model linear/nonlinear, and SISO/MIMO systems.

Many of the modeling techniques reviewed in this chapter will be used to build the grey-box and blackbox models of the TRCA-ASHB and its mechanical systems in the next two chapters. The model performance will be compared to the measured data and with each other as well in order to find out the best modeling method which will be utilized for the new controller development.

34

Chapter 3 Grey-Box Modeling
This chapter is based on the following published journal paper: · Abdul Afram, Farrokh Janabi-Sharifi, Gray-box modeling and validation of residential HVAC system for control system design, Applied Energy, Volume 137, 1 Jan 2015, pp. 134-150. In this chapter, grey-box models of the residential HVAC system were developed. The HVAC system comprises of several subsystems such as energy recovery ventilator (ERV), AHU, buffer tank (BT), RFH system, zone and GSHP whose models can be identified separately and combined to obtain the model of the full system. The parameters of the subsystem models were identified from the data measured from the instrumented TRCA-ASHB HVAC systems located at Kortright Centre for Conservation (Vaughan, Ontario, Canada). Individual subsystem models were combined to obtain the full system model which replicates the performance of the existing HVAC system and provides the cost estimate for running the HVAC system. Existing HVAC system uses on/off controllers for zone temperature and BT temperature control. The on/off controllers were integrated into the full scale system model and energy estimates were calculated for the operation of primary and secondary components (e.g., GSHP, fans and pumps). This model can be used to further investigate the effects of more advanced controllers (e.g., PID, MPC) and energy conservation strategies (e.g., set-point reset, passive/active thermal energy storage) in the simulation before implementing on the existing HVAC system.

3.1.

Introduction

HVAC systems consume about 40% of the total energy in a household [101] and this number can go up to 60% in cold climates such as Canada [102]. Due to the increase in electricity prices over the years, it is important to investigate the energy conservation strategies and implement them into HVAC control design. The development of HVAC models is necessary to replicate the operation of the HVAC system, to implement the energy conservation strategies, and to develop the advanced controllers. Once the models are developed and calibrated, the effect of each energy conservation strategy and each controller design can be simulated and the total cost savings can be calculated. Simulations help in minimum disruption of the working system when deploying new controller

35

designs as the new controller can be tuned in the simulation before implementing it on the actual system. The models can be classified as white-box, black-box and grey-box models [103]. A comprehensive review of HVAC modeling methods was reported in [104]. White-box models (also known as physicsbased, analytical and forward models) are developed by understanding the process physics and underlying engineering principles. Black-box models (also known as inverse models) are developed by measuring the inputs and outputs of the system and fitting a linear or nonlinear mathematical function to approximate the operation of the system. Grey-box models are developed by using the white-box models whose parameters are estimated by using the measured system inputs and outputs. White-box models have good prediction accuracy over a wide range of operating conditions but since no measurements are used in their development, their accuracy is low. Black-box models have very high accuracy, but the understanding of system physics is not required while developing black-box models, so their generalization capability is low. Grey-box models use both the measurements and the system physics so they provide both good accuracy and high generalization capabilities but more work is required to develop the grey-box models. The HVAC simulation can be either carried out in the existing building performance analysis tools such as TRNSYS [105] and Energy-Plus [106, 107], or in generic programming environments such as MATLAB® Simulink® [14, 19, 108, 109]. The energy simulation programs usually employ white-box modeling approaches and provide wide varieties of HVAC components in their libraries for quick start of the simulations. These programs generally are less flexible for the controller development and do not include the high performance controllers such as MPC in their libraries. It is also difficult to develop and integrate these controllers into such programs. Moving to the generic programing environment such as MATLAB® Simulink® allows the flexibility of developing advanced controllers and implementing the energy conservation strategies. In order to simulate the HVAC systems in MATLAB® Simulink®, several toolboxes have been developed such as IBPT [9], SIMBAD toolbox [10], CARNOT [11], HAM-tools [12, 13] and ASTECCA toolkit [14, 15]. The whole building model was developed in [110] for the simulation of central HVAC systems. The work reported in [111] used a building model to determine the indoor humidity profile. The development of a simulation tool (HAM-BE) for building envelope study was reported in [112]. Another simulation environment for the performance analysis of HVAC systems was designed and 36

the results were provided in [113]. A dynamic models based simulation platform was developed and given in [114]. Grey-box models have also been designed for the AHU [115], thermal load estimate [116, 117], heat pump [118] and VCC [119]. SS models for heat exchanger [120], zone [121] and chiller [122] have also been developed. While significant work has been carried out in the modeling and validation of HVAC systems, it is hard to find the generic models to be useful in all the different types of systems with their infinite possible configurations. In order to be able to correctly simulate and modify the control systems and energy conservation strategies, it is necessary to write the dynamic equations of each subsystem and perform the measurements to identify the parameters. In this chapter, we develop a general method to design HVAC subsystem models and integrate them to simulate larger systems. The developed models are suitable for new controller design both on local level and supervisory level. The structure of the chapter is as follows: In Section 3.2, a detailed description is provided for the HVAC system installed at the TRCA-ASHB, Vaughan, Ontario, Canada. The dynamic equations of the ERV, AHU, BT, RFH system, zone and GSHP are developed in Section 3.3. The details of the flow rate and temperature measurements of each subsystem are provided in Section 3.4. The data analysis is carried out in Section 3.5 and appropriate data is selected for modeling and validation. Section 3.6 provides the details of the model development in Simulink®. The estimated parameters and the modeling results compared to the measurements are provided in Section 3.7.

3.2.

HVAC System Description of TRCA-ASHB

Two identical houses, House A and House B (also known as TRCA-ASH) were built for the benchmarking study of HVAC systems and new controller designs [123]. House A has the HVAC systems found in a typical residential house (e.g., heat recovery ventilator (HRV), ASHP, and natural gas boiler); whereas, House B has the more advanced futuristic HVAC system (e.g., ERV, GSHP, multi-zone AHU and RFH system). The zone temperature of In-Law Suite is also controlled by the HVAC system of House B. Both houses are R-2000 and Leadership in Energy and Environmental Design (LEED) Platinum certified [124]. The details of the HVAC equipment and building material used in the TRCA-ASHB were provided in [42, 125, 126]. The HVAC systems of House-B which were modeled and reported in this chapter comprises of ERV, AHU, BT, RFH and GSHP. The HVAC systems of House A and In-Law Suite will not be discussed in this chapter. During the summer 37

season, cooling is provided by the AHU and during the winter season, heating is provided by the RFH system. The details of each HVAC subsystem are provided in the following subsections. Figure 3-1 shows the TRCA-ASH, the DAQ system and major HVAC components installed in the TRCAASHB.

Exhaust Air Inlet Exhaust Air Outlet Fresh Air Outlet TRCA Archetype Sustainable House Fresh Air from ERV Return Air from Zone 1 Return Air from Zone 2 & 3 Supply air to Zone 3 Supply air to Zone 1 Supply air to Zone 2 Cooling Coil Fan OEM Controller Fresh Air Inlet Solenoid Valves RFH Supply Water RFH Return Water OEM Controller (Uponor) Thermostat Wireless Base Station Pump and Control Interface AHU RFH, AHU and ILAHU Supply Water BT Return Water BT Supply Water Ground Loop Return Ground Loop Pump Ground Loop Supply GSHP Return Water RFH Return Water GSHP GSHP Supply Water AHU and ILAHU Return Water DAQ OEM Controller (Aquastat) Power Supply Controller I/O Module Sensor Wires BT Supply Water BT Return Water RFH ERV

BT

Figure 3-1: TRCA-ASH, ERV unit, AHU, RFH system, GSHP, BT and DAQ system

3.2.1. ERV Unit
ERV exchanges heat between the incoming fresh air and outgoing exhaust air streams. In winter season, the outgoing exhaust air coming from the indoors is at a much higher temperature (usually around 22°C±1°C set-point) compared to the incoming fresh air whose temperature is very low and often times below 0°C. Energy can be saved by transferring the heat from the exhaust air to the fresh 38

air, thus pre-heating the fresh air. Similarly in summer season, outgoing exhaust air coming from the indoors is at a much lower temperature (usually around 25°C±1°C set-point) compared to the incoming fresh air (usually above 26°C). Again the energy can be saved by transferring the heat from the fresh air to the exhaust air, thus pre-cooling the fresh air. The fresh air goes to the AHU after passing through the ERV to be distributed to the zones.

3.2.2. AHU
Multi-zone AHU of TRCA-ASHB serves three zones. The AHU works only during the summer season and supplies cold air to the zones. During the winter season, heat is supplied to the zones by the RFH system. Fresh air is pre-cooled after passing through ERV and enters the inlet of the AHU along with the return air streams from the zones. The mixed air consisting of return and fresh air streams passes through the cooling coil inside the AHU where the mixed air transfers heat to water and gets cold. The cold air is supplied to the three floors separately based on the demand from each zone thermostat. Cold water enters the cooling coil from the BT and after gaining heat from the supply air, the warm water returns to the BT. The temperature of BT is maintained by the GSHP.

3.2.3. BT
Thermal energy storage tank is also known as BT and stores energy for use by the AHU, in-law suite (ILS) air handling unit (ILAHU) and RFH systems of floor 1 (RFH1) and floor 2 (RFH2). It helps to reduce equipment wear due to short cycling. The BT stores water at a certain temperature during heating and cooling seasons. After passing through the AHU, ILAHU, RFH1 and RFH2, the water is returned back to the BT and thus the water level in the BT does not change over time. The temperature of the water inside the BT is maintained by the GSHP. In summer, GSHP supplies cold water and maintains the BT temperature between 5°C and 15°C (due to the on/off controller's set-point at 10°C and dead-band of ±5°C for cooling). In winter GSHP supplies warm water to the BT and maintains the BT temperature between 33°C and 43°C (due to the on/off controller's set-point at 38°C and dead-band of ±5°C for cooling). During summer, AHU supplies cold air to the zone and heat is rejected to the BT. During winter, RFH supplies warm water to the zone and extracts heat from the BT and returns cold water to it. ILAHU works during both summer and winter seasons providing cooling in summer and heating in winter.

39

3.2.4. RFH System and Zone
RFH system works in winter season to provide heating to the zone. Hot water is stored in the BT between 33°C and 43°C. The zone temperature is controlled by the thermostat between 21°C and 23°C (due to the controller set-point at 22°C and dead-band of ±1°C). Zone thermostat controls the floor heating pump based on the heating demand from the zone. The hot water circulates in the RFH system and maintains the zone temperature at its set point. The zone loses heat to the ambient through the building envelope. Fresh air also enters into the zone through mechanical ventilation system and infiltration altering the temperature of the zone from its set point.

3.2.5. GSHP
GSHP maintains the different BT temperatures in both summer and winter seasons. It takes warm water at its inlet in the summer and returns the cold water to the BT maintaining its temperature between 5°C and 15°C. In winter, it receives cold water at its inlet and returns warm water to the BT maintaining its temperature between 33°C and 43°C. The GSHP has a horizontal ground loop which rejects heat to the ground during the summer season and extracts heat from the ground during the winter season. Since the ground temperature is relatively constant during both summer and winter seasons compared to the outside air temperature which varies widely during summer and winter seasons, the GSHP generally has high COP compared to an ASHP [127].

3.3.

Modeling

The white-box models were developed by writing the energy balance equations on each of the subsystems. The data of all the inputs and outputs of the individual subsystems was measured and the parameters were estimated by using the nonlinear least squares optimization technique. In this general method, all models are identified with all the necessary inputs/outputs for easy integration with the other subsystems. After all the models are developed, only the outside air temperature and the set points (such as BT water temperature set point and zone temperature set point, etc.) need to be supplied. For simplistic analysis, cosine temperature model [128] can be used as the outside air temperature and for more realistic analysis, the measured temperature can be used as the input of the integrated model. The set points can either be set manually or can also be supplied by a supervisory controller [129, 130] which changes the set points based on different requirements (e.g., occupancy, 40

energy conservation and thermal comfort, etc.). The model of each subsystem (i.e., ERV, AHU, BT, Zone, RFH and GSHP) is described in the following subsections in detail.

3.3.1. Model of ERV
The core of the ERV employs air-to-air energy exchanger (i.e., it exchanges both sensible and latent heat) and a pair of fans for supply and exhaust air streams. The energy exchanger can be modelled by writing an energy balance equation on each of the exhaust and fresh air streams [63, 64]. More details on the ERV of TRCA-ASHB are available in [131-133]. Figure 3-2 shows the energy balance diagram of the ERV.
Heat stored in metal and dT Cam eao exhaust air mass dt

meaCpaTeao

meaCpaTeai Heat in exhaust air at inlet

Heat in exhaust (UA)  Teai + Teao - T fai + T fao   CC  2 2 air at outlet   Heat transfer between the two air streams Heat stored in metal and dT Cam eao fresh air mass dt

mfaCpaTfai Heat in fresh air at inlet

mfaCpaTfao Heat in fresh air at outlet

Figure 3-2: Energy balance diagram of ERV The model of the ERV is presented in the following equations. The model inputs, outputs and the parameters that need to be estimated are also shown. The dynamic equations determine the temperature of the exhaust and fresh air at the outlet of the ERV respectively. The parameters c1 and

c2 are added to each heat balance equation to cater for any un-modelled dynamics.

 Teai + Teao T fai + T fao   dTeao 1  = -  mea C pa (Teai - Teao ) - (UA )cc    + c1 , 2 2 dt Cam   

(3.1)

41

dT fao   Teai + Teao T fai + T fao  1  = - - m C T - T ( ) (UA )cc   fa pa fao fai  + c2 . 2 2 dt Cam    
mea T fai ,  Teai Inputs: m fa , , 
Outputs: T fao ,  Teao

(3.2)

C pa , ,  c1 c2 Parameters to be identified: Cam = ( cam  amVam ) ,  (UA)cc , 
The log mean temperature deviation (LMTD) can be used to compute the heat transfer rate across the heat exchanger in steady state analysis and is not suitable for the dynamic analysis. Fans inside the ERV consume power and dissipate heat into the air stream due to the inefficiencies of the motor. The heat produced by the fans was neglected due to their relative low energy dissipation and resulting small increase in the air temperature.

3.3.2. Model of AHU
AHU transfers heat from the mixed air (produced by combining return and fresh air) to the chilled water and produces cold supply air to maintain a comfortable zone temperature during summer. The HVAC system installed at the TRCA-ASHB does not incorporate a separate mixing box. The mixing of the return and fresh air occurs inside the AHU. Multi-zone AHU comprises of air to water heat exchanger also known as cooling coil, a fan and three zone air control dampers. Based on the cooling requirements from the zone thermostats, AHU also controls a pump to circulate water between the cooling coil and the BT. White-box AHU model is based on cooling coil model [63] and mixing box model [53]. Energy balance diagram of AHU is shown in Figure 3-3. The model of AHU was developed by writing the energy balance equations on water and air streams as follows:

dTwo 1  mwC pw (Twi - Two ) - (UA )cc (Two - Tao )  =  + c1 , dt Cwm 

(3.3)

42

dTao 1 (UA )cc (Two - Tao ) - ma C pa (Tao - Tai )  =  + c2 . dt Cam 
Inputs: mw , ma , Twi , Tai Outputs: Tao , Two

(3.4)

= Cam Parameters to be identified:

cam  amVam ) , ,  Cwm ( cwm  wmVwm ) (= C pa ,  C pw , ,  c1 c2 (UA)cc , 

The constants c1 and c2 were added to cater for any un-modeled dynamics of the system.

mwCpwTwo Heat in water at outlet

Heat stored in metal and dT Cwm wo water mass dt (UA)cc(Two ­ Tao) Heat transfer between the water and air streams Heat stored in fresh air and metal mass
C pa dT fao dt

mwCpwTwi Heat in water at inlet

maCpaTai Heat in air at inlet

maCpaTao Heat in air at outlet

Figure 3-3: Energy balance diagram of AHU The researchers have used either the difference of the outlet air/water streams or the difference of the average of inlet and outlet air/water streams to find the heat transfer between the two streams inside a heat exchanger. Both of the methods were used in this research to develop the models and finally the one with the higher accuracy for the particular subsystem was used. The difference of average of the inlet and outlet air streams was used in the ERV model to compute the heat transfer between the two air streams since it increased the model's accuracy. In contrast, the difference of the outlet temperature of the water and air streams was used to compute the heat transfer between the water and air streams as it resulted in the higher prediction accuracy of the AHU model. 43

The AHU consists of three inlet air streams comprising of one fresh air stream from the ERV and two return air streams from the zones. Three inlet air streams are assumed to be well mixed inside the AHU and the temperature of the mixed air at the inlet of the cooling coil was calculated based on the mixing box model [53] as follows:

Tai = Tm ,ai ,
Tm ,ai = mra1Tra1 + mra 23Tra 23 + m faT fa ma ,

(3.5)

(3.6)

ma =mra1 + mra 23 + m fa .

(3.7)

The measurement of the return air (from the 2nd and 3rd floors) was not available separately and thus were combined together in this formulation. The air is supplied to three zones from the output of the AHU. The air streams at the outlet of the AHU can also be combined into a single air stream thus converting the model of the multi-zone AHU to a single-zone AHU which results in lower number of parameters to be identified. The mixed air temperature at the outlet of the AHU can also be computed based on the mixing box model [53] as follows:

Tao = Tm,ao ,
Tm,ao = msa1Tsa1 + msa 2Tsa 2 + msa 3Tsa 3 , ma

(3.8)

(3.9)

ma = msa1 + msa 2 + msa 3 .

(3.10)

The fan and pump consume energy and produce heat which can be added to the air or water streams respectively if the motor is installed directly in the stream. In this research we neglected these energy losses since they do not result in significant temperature increase of the air and water streams. The dampers do not affect the temperature of the air streams but control the flow rate of the air. The dampers in this particular AHU are simple open and close dampers which operate based on the 44

cooling demand from the corresponding zone. No special formulation is needed to simulate the dampers in this case.

3.3.3. Model of BT
The purpose of the BT model is to predict the water temperature inside the BT. The following assumptions were made for developing the BT model: 1. Water is well mixed inside the BT having a uniform temperature and there is no stratification in the tank. This assumption is realistic due to the relatively small size of the BT where the significant stratification cannot take place due to the low height of the water. 2. Supply water temperature of ILAHU, GSHP, RFH1 and RFH2 is equal to BT temperature since the supply water pipes are well insulated to prevent any heat loss between the ambient and the water. 3. The heat loss to ambient is insignificant and is thus not considered since the insulation of the BT is quite effective at blocking the heat transfer between the water and the ambient. Figure 3-4 shows the energy balance on all the inlet and outlet water streams and the water inside the BT. Storage tank model was reported by [72]. The following equation can be written for the energy balance

dTBT 1 = [mGSHPC pw (Tr ,GSHP - TBT ) - mILAHU C pw (TBT - Tr , ILAHU ) dt CBT

- mRFH 1C pw (TBT - Tr , RFH 1 ) - mRFH 2C pw (TBT - Tr , RFH 2 )] + c.

(3.11)

Tr , , Tr RFH 1 ,  Tr , RFH 2 ,  ,  mGSHP mILAHU ,  mRFH 1 ,  mRFH 2 Inputs: Tr ,GSHP ,  ILAHU , 
Outputs: TBT Parameters to be identified: CBT = (  wVBT C pw ) , ,  C pw c A constant c was added to cater for any un-modeled dynamics of the system. 45

mGSHPCpwTr,GSHP Heat in GSHP return water mILAHUCpwTr,ILAHU Heat in ILAHU return water mRFH1CpwTr,RFH1 Heat in RFH1 return water mRFH2CpwTr,RFH2 Heat in RFH2 return water
CBT dTBT dt

mGSHPCpwTBT Heat in GSHP supply water mILAHUCpwTBT Heat in ILAHU supply water mRFH1CpwTBT Heat in RFH1 supply water mRFH2CpwTBT Heat in RFH2 supply water

Heat stored in BT

Figure 3-4: Energy balance diagram of BT

3.3.4. Model of Zone with RFH
Model of the zone with RFH was developed by writing the heat balance on each of the zone air streams and the water passing through the RFH system in the floor of the zone. Figure 3-5 shows the heat entering, leaving and stored in the zone and the floor mass. The following assumptions were made while developing the zone model: 1. The return water temperature is same as the floor temperature due to the high thermal conduction between the supply water and floor mass caused by the copper pipes. 2. The flow rate of the infiltration air is negligible compared to the fresh air introduced into the zone by the mechanical ventilation system so it is neglected in modeling. The TRCA-ASHB has been tested for the air tightness using blower door tests and found to have very good air tightness [124]. Also the flow rate of the air going inside the house (about 100 CFM) is higher

46

than the air coming out of the house (about 90 CFM) which slightly pressurizes the house and thus reduces the air infiltration significantly. 3. The heat generated inside the zone by the occupants is also negligible and thus not considered during modeling. Since the house is mainly used for the experimentation purposes so there is no heat generated by the occupants in the zone and this approximation is realistic.
Heat lost to the ambient from the zone
(UA) 2 (Tz - To )

ma,freshCpaTa,fresh Heat in fresh air

Heat stored in the zone Zone Heat transferred to the zone from the floor

Cz

dTz dt

(UA)1 (Tw,ret - Tz )

mwCpwTw,sup Heat in supply water Heat stored in the floor Floor
Cwf dTw,ret dt

mwCpwTw,ret Heat in return water

Figure 3-5: Energy balance diagram of RFH and zone In a case where insulation of the building is not adequate, the effects of the infiltration air should be considered during the modeling but it is difficult to measure the flow rate of the infiltration air directly. When the heat is generated inside the zone due to cooking or equipment operation, the effect on the zone temperature could be significant and should be considered in the modeling. In our particular case, the insulation is quite appropriate and there is no heat generation inside the zone so these factors can be neglected. Figure 3-5 shows the heat balance of RFH and zone. The zone model was written as follows:
dTw,ret 1  mwC pw (Tw, sup - Tw,ret ) - (UA ) (Tw,ret - Tz )  + c1 , = 1  dt Cwf 

(3.12)

47

dTz 1 (UA ) (Tw,ret - Tz ) - (UA ) (Tz - To ) - ma , freshC pa (Tz - Ta , fresh )  + c2 . = 1 2  dt Cz 

(3.13)

To Ta fresh ,  mw ,  ma , fresh Inputs: Tw, , sup , , 
Outputs: Tz ,  Tw,ret Parameters: = C pw ,  C pa ,  Cwf
c  V ) ,  C ( c  V ) ,  (UA) ,  (UA) (=
wf wf wf z z a z 1

2

c1 c2 , , 

The constants c1 and c2 were added to cater for any un-modeled dynamics of the system.

3.3.5. Model of GSHP
The purpose of the GSHP model is to find the return water temperature based on the supply water temperature. It is not necessary to develop a comprehensive grey-box model for the GSHP for this scenario. Therefore, a black-box model was selected for the GSHP. The measurements of supply and return water temperature and flow rate were made to develop the GSHP model. Linear CC was computed between the supply and return water temperature in BT loop as follows [92]:
CC = ^) cov ( y, y .

 y y ^

(3.14)

CC computes the dependent relationship between two datasets (input and output of the model in this case). For the datasets with high linear correlation, the value of CC is close to 1. It was found that the value of CC between the two datasets was 0.95. Since very high linear correlation exists between the inputs and outputs of the two datasets, linear model was chosen. Linear model is given as follows:

= Tr ,GSHP mGSHP C pwTs ,GSHP + c.

(3.15)

In this linear model, C pw represents the heat capacity or slope of the line and c is the intercept.

48

3.4.

Measurements

The temperature of both air and water streams was measured in degrees Celsius (°C). The flow rate of air and water streams was measured in cubic feet per minute (CFM) and gallons per minute (GPM) respectively. The power consumption of each subsystem was measured in watt (W). National Instruments (NI) Compact FieldPointTM (CFP) system was used along with the LabVIEW® software for recording the measurements. The DAQ system stores each measurement at a sampling time of 5 seconds in a structured query language (SQL) database [123]. Once the white-box models were developed, the measurements of inputs and outputs of the subsystems were utilized for the parameter estimation. Figure 3-6 provides the schematic diagram of inputs and outputs of each of the HVAC subsystems. The detail about the sensors, their location, calibration and uncertainties was provided in [123, 126, 127, 131-133]. The information about the sensor type, manufacturer, model number and corresponding accuracy is shown in Table 3-1 [126]. For the measurement of water temperature, direct immersed Pt-100 series resistance temperature detector (RTD) probe sensors were used. For the supply and return water loops in GSHP and RFH system, Pt-500 series matched differential temperature T RTD probe sensors were used. For the measurement of air temperature, air temperature sensors were used. For the measurement of water flow rate, turbine type flow rate sensors were used. For the flow rate measurement of air, pressure transducers with flow stations were used.

3.4.1. ERV Unit Measurements
ERV unit comprises of two inlet air streams and two outlet air streams [131-133]. In total, there are four inputs and outputs altogether for which temperature and flow rate of each input and output was measured resulting in a total of six measurements.

3.4.2. AHU Measurements
For AHU, there are three inlet air streams, three outlet air streams, one inlet water stream and one outlet water stream [134, 135]. In total there are eight inputs and outputs altogether for which temperature and flow rate of each input and output was measured resulting in a total of fifteen

49

measurements since flow rate of supply water was not measured which was equal to the return water flow rate.

3.4.3. BT Measurements
There are four water loops going to GSHP, ILAHU, RFH1 and RFH2 [123, 127, 136]. The flow rate of each of supply and return water was measured. Since the flow rate of supply and return in each of the four circuits was equal so only one flow rate measurement was needed for each water loop. The temperature of the outgoing water was assumed to be equal to the BT temperature so, only one measurement was needed for the supply water temperature but the return water temperature of each loop was different and depended on the heat transferred; therefore, four measurements were made for four return water temperatures. This means a total of nine measurements were made (i.e., four flow rates, one BT temperature and four return water temperatures).

Fresh Air Inlet from Outside Exhaust Air Inlet from Zone

Fresh Air Return Water Outlet to AHU ERV from RFH1 Exhaust air Outlet to Outside Return Water from RFH2 Return Water to Supply Water Buffer Tank from Buffer Tank Return Water Return Water from from ILAHU Supply Water to GSHP Desuperheater Desuperheater Return Water Return Water from Supply water to from GSHP Ground Loop Ground Loop Return Air Outside Air from 1st Floor Heat Transfer Fresh Return Air from Air from Zone Air 2nd +3rd Floor ERV Heat Supply Zone Transfer Water from BT RFH System Floor Return Water to BT Fresh Air from ERV Supply Water from Buffer Tank

Supply Water to RFH1 Supply Water to RFH2 Supply Water to ILAHU Supply Water to GSHP Supply Air to 1st Floor AHU Supply Air to 2nd Floor Supply Air to 3rd Floor Return Water to Buffer Tank

BT

Figure 3-6: Inputs and outputs of the HVAC Subsystems 50

Table 3-1: Sensor Type and Accuracy [126] Sensor Name Air velocity transmitter Turbine type flow rate Air temperature Differential pressure transducer RTD sensor Pt-100 RTD sensor Pt-500 Sensor Type Measure air velocity Measure water flow rate Measure air temperature Measure air flow rate Measure water temperature Measure water temperature Manufacturer Dwyer Instruments Inc. Omega/Clark Solution Dwyer Instruments Inc. Alpha Instruments, Inc. Omega/Clark Solution Kamstrup Model Number AVU-1-A CFT110 Series RHT-D 164 RTD-2-F310536-T-B 65-00-0DO-310 Sensor Accuracy ±5% ±3% ±0.3% ±1%FS ±0.12% N/A

3.4.4. RFH and Zone Measurements
For RFH and zone, a total of seven measurements were made for supply water temperature to RFH, return water temperature from RFH, water flow rate through RFH, outdoor air temperature, zone temperature, temperature of fresh air and flow rate of fresh air [123].

3.4.5. GSHP Measurements
There are three fluid carrying loops entering and leaving the GSHP [127, 136]. First loop is the supply and return water loop from the BT to the GSHP. The second loop supplies hot water to the desuperheater loop which can be used to heat up the domestic hot water. Third loop is the ground loop which carries working fluid to exchange heat between the GSHP and the ground. The measurements were only made on the supply and return water from the BT for the water temperature and flow rate since the purpose of the model was to predict the return water temperature given the supply water temperature and flow rate in the BT loop.

3.5.

Extraction, Analysis and Pre-processing of Data

Data was extracted from the database and plotted for analysis. Figure 3-7 shows the temperature and flow rate profiles of all the measurements of each HVAC subsystem.

51

20

Tfai Teai Teao
Temperature (°C)

25 20 15 10 500 1000 1500 2500 2000 Time (sec) 3000 3500 4000

Temperature (°C)

Tfao

Tfa Tsa1 Tsa2 Tsa3 Tra1 Tra23 Tw i Tw o

10 0 -10

1

2

3

4

5

7 6 Time (sec)

8

9

10

11

12 x 10
4

Air/Water Flow Rate (kg/sec)

0.09

Flow Rate (kg/sec)

0.08 0.07 0.06 0.05 0.04 0.03 1 2 3 4 5 7 6 Time (sec) 8 9 10 11 12 x 10
4

mfa mea

0.3 0.25 0.2 0.15 0.1 0.05 0 500 1000 1500 2000 2500 Time (sec) 3000 3500 4000

mfa msa1 msa2 msa3 mra1 mra23 mw

(a)
50 Tr,ILAHU
Temperature (°C)
50 40 30 20 10 0 -10 0.2 0.4 0.6 0.8

(b)
Tr,GSHP Tr,RFH1 Tr,RFH2 TBT
Tz To Tw ,ret Tw ,sup Ta,fresh

Temperature (°C)

40 30 20

0.2

0.4

0.6

0.8

1.2 1 Time (sec)

1.4

1.6

1.8 x 10

2
4

1 1.2 Time (sec)

1.4

1.6

1.8 x 10

2
5

3

Flow Rate (kg/sec)

Flow Rate (kg/sec)

2.5 2 1.5 1 0.5 0 0.2 0.4 0.6 0.8 1.2 1 Time (sec) 1.4 1.6 1.8 x 10 2
4

mILAHU mGSHP mRFH1 mRFH2
0.1

mw ma,fresh

0.05

0

0.2

0.4

0.6

0.8

1 1.2 Time (sec)

1.4

1.6

1.8 x 10

2
5

(c)
50
Temperature (°C)

(d)
Ts,GSHP Tr,GSHP

40 30 20

1

2

3

4

5 6 Time (sec)

7

8

9

10 x 10
4

3.5 3
Flowrate (kg/sec)

mGSHP

2.5 2 1.5 1 0.5 0 1 2 3 4 5 6 Time (sec) 7 8 9 10 x 10
4

(e) Figure 3-7: Temperature and flow rate profiles of air and water in (a) ERV unit, (b) AHU, (c) BT, (d) RFH-zone and (e) GSHP circuits

52

The data was captured from sensors at an interval of 5 seconds which produces very high resolution data. Since temperature changes very slowly, a larger sampling time can be used if the process dynamics can be captured appropriately. The advantage of using a larger sampling time is that it results in reduced number of data samples which is more appropriate for the faster convergence of the optimization used for parameter estimation. The units of the air and water flow rate were converted to kg/s.

3.5.1. ERV Data
ERV data shows fresh and exhaust air streams at the inlet and outlet of the ERV for 10 days of Mar 2011. March is a cold month in Ontario, Canada so outdoor air temperature is varying somewhere between -10°C and +10°C. The exhaust air coming from the zones is at about 22°C which is being regulated by a RFH system. The fresh air gains heat and exhaust air becomes cold at the outlet of the ERV. The flow rate of supply and return air is almost constant around 100 CFM (0.058 kg/s ). The noise from the data was removed by applying the median filter. The resolution of the data was reduced by a factor of 100 making the new sampling time to be 500 seconds which is a sufficient resolution for modeling the ERV. In total, 500 samples were selected for the parameter estimation of the AHU model which were sufficient to capture the process dynamics under varying conditions.

3.5.2. AHU Data
AHU data plot shows the temperature and flow rate profiles of air and water streams at the inlet and outlet of the AHU for Sep 2010 [123]. Cold water is supplied to the cooling coil inside the AHU from the BT whose temperature is maintained by the GSHP between 7°C and 14°C. The temperature of the return air is close to the zone temperature set-point, i.e., 22.5°C. The temperature of the fresh air entering the AHU is warmer than the return air since all heat is not transferred to the incoming air from the exhaust air inside the ERV. The temperature of supply air is colder than the zone air. The flow rate of the water is constant at 3 GPM (0.189 kg/s). The flow rate of zone air is also constant for each zone when being served. The flow rate of zone 1, zone 2 and zone 3 is 500 CFM (0.276 kg/s), 300 CFM (0.166 kg/s) and 380 CFM (0.21 kg/s) respectively. A sampling time of 30 seconds was found to be appropriate by the data analysis. So the data was resampled at a sampling time of 30 seconds by selecting every 6th sample and discarding the 5 samples 53

in between. Since the data was already clean for AHU, the averaging was not used as it reduces the sharpness of the data un-necessarily. Since no heat transfer takes place when no air is flowing through the AHU, the data when air is not flowing cannot be used for the parameter estimation and needs to be removed. This can be achieved by computing the total flow rate of the air passing through the AHU and applying a threshold filter on it. In this case, a threshold value of 200 CFM (0.116 kg/s) was used. When air flow rate was below 200 CFM (0.116 kg/s), the data was removed. Total air flow is computed as follows:

ma = msa1 + msa 2 + msa 3 .

(3.16)

In total, 500 samples were selected for the parameter estimation of the AHU model which were sufficient to capture the process dynamics under varying conditions.

3.5.3. BT Data
A total of 60 days of data between Sep-Nov 2013 was extracted from the database for the purpose of BT modeling and validation. BT data plot shows only a small portion of the data (about 14 hours only). From the flow rate profiles, it can be seen that the ILAHU pump is always running which could be due to a fault in the sensor or inappropriate wiring of the pump. Ideally this pump should only run when there is a heating or cooling demand from the zone thermostat. The pumps of RFH1 and RFH2 only work when there is a demand from the zone thermostat. The GSHP water pump runs when the BT temperature falls below 33°C and turns off when the BT temperature reaches 43°C. The sensor noise was removed by applying the median filter. A sampling time of 50 seconds was found to be appropriate by the data analysis. So the data was resampled at a sampling time of 50 seconds by selecting every 10th sample and discarding the 9 samples in between. In total, around 2250 samples were selected for the parameter estimation and validation which were sufficient to capture the process dynamics under varying operating conditions.

3.5.4. RFH and Zone Data
About 10 days of data of Mar 2011 was selected for modeling and validation of the zone models. A sampling time of 50 seconds was found to be appropriate by the data analysis. So the data was resampled at a sampling time of 50 seconds by selecting every 10th sample and discarding the 9 samples 54

in between. In total, about 4500 samples were selected for the parameter estimation of each model, sufficient to capture the process dynamics under varying conditions.

3.5.5. GSHP Data
GSHP data plot shows the temperature and flow rate profiles of supply and return water streams at the inlet and outlet of the GSHP. The data is from winter 2013 (Sep-Nov 2013). Relatively cold water is supplied to the GSHP from the BT and warm water is returned by the GSHP to the BT. The median filter was applied to remove the noise from the data. Since no heat transfer takes place when the water is not flowing between BT and GSHP, the data can be removed when pump is not working. Thresholding was used to select the data when the water pump in BT loop was turned on.

3.6.

Model Development in Simulink®

After the data had been selected for parameter estimation and validation, the models were developed in Simulink® as shown in Figure 3-8 which shows the higher level models with all the inputs and outputs of each subsystem. Figure 3-8 (a) shows the four inputs and two outputs of the ERV system. Figure 3-8 (b) shows the four inputs and two outputs of the AHU system. Figure 3-8 (c) has eight inputs and one output for the BT system. In Figure 3-8 (d), RFH system has five inputs and two outputs. And finally in Figure 3-8 (e), there are two inputs and one output for the GSHP system. The details of the implementation of higher level blocks in Figure 3-8 are provided in Figure 3-9. The models developed in section 3.3 were implemented in Figure 3-9 using the common Simulink® blocks such as mathematical blocks (add, subtract, multiply and divide), input-output ports, constants and integrators. The higher level blocks introduced in the Figure 3-8 were cascaded to develop the combined HVAC system model presented in Figure 3-10. The on/off controllers were added to control the BT temperature and zone temperature as well. The cost estimate of running the HVAC equipment was also calculated by integrating the total on time of the GSHP, RFH pump and ERV fan and multiplying it with the power consumption and cost of each component. As can be seen in the model, only the outside air temperature and set points (zone temperature set point, BT temperature set point) are supplied and all other internal signals are automatically generated by the integrated model without the need of any further measurements during the development of advanced controllers. The integrated 55

HVAC model can be utilize to implement the energy conservation strategies (e.g. thermal storage in the building mass [106] or floor heating mass [107], passive solar gains [107], thermal storage in tank water [105, 137], temperature reset during unoccupied hours [128, 138], night setbacks, pre-cooling during off-peak periods and set-point changes during peak hours [139, 140], optimum start and stop times [141], ventilation control [142, 143] and economizer cycle control [138, 144, 145]) and see the relevant cost savings [146]. It can also be used to implement the more advanced controllers such as PID [59, 147-150], robust control [151], optimal control [152], soft control [153-156] hybrid control [157, 158] and MPC [22, 45, 106, 108, 109, 159-164] to see their effect on the total cost savings.

(a)

(b)

(c)

(d)

(e)

Figure 3-8: Inputs and outputs of (a) ERV unit, (b) AHU, (c) BT, (d) RFH-zone and (e) GSHP model in Simulink®

(a) 56

(b)

(c)

(d) 57

(e) Figure 3-9: Detailed (a) ERV unit, (b) AHU, (c) BT, (d) RFH-zone and (e) GSHP model in Simulink®

Figure 3-10: Combined HVAC Model 58

3.7.

Parameter Estimation and Results

All the pre-processing of the data was carried out in MATLAB®, the models were developed in Simulink® and the parameter estimation was carried out in Control and Estimation Tools Manager which is a part of Simulink®. Nonlinear least squares optimization was used to find the parameters. Other optimization techniques such as gradient descent, pattern search and simplex search were also used to estimate the parameters but sometimes they failed to converge. Nonlinear least squares technique was converging for all the datasets. When the optimization converges, the estimated parameter trajectories become flat and stop changing. A good choice of initial conditions increases the speed of the convergence of optimization and helps to find the global minima of the function. A number of different initial conditions were tried which resulted in different local minimum. Finally, the initial conditions given in Table 3-2 were used based on the quick convergence of optimization and appropriate estimates of the parameters. Estimated parameters were found after the convergence of the optimization and are also given in Table 3-2. The theoretical values of the parameters were also calculated from the physical properties of the systems and are also reported in Table 3-2 for comparison. The theoretical values and the estimated parameters are very different from each other. Figure 3-11 shows the measured and simulated responses of all the subsystems. All of the developed models were successfully able to approximate the outputs of the corresponding subsystems. The models have good generalization capability and are robust to the noise in the measurements. For the analytical evaluation of the models, the performance comparison metrics defined in Chapter 2 were used. These metrics were calculated for all of the developed models and the results are summarized in Table 3-3.

59

Table 3-2: Initial and Estimated Parameters Subsystem ERV Initial Parameters C pa = 10,
Cam =  10, c1 = 10,  c2 = 10.    (UA)cc = 10, 

Estimated Parameters with Optimization C pa = 6.683 J/kgK,

Estimated Parameters from Physical Properties C pa = 1012 J/kgK,
  Cam 1.964 ×103 J/K,   =  0 c1 = W,  0 c2 = W. C pa = 1012 J/kgK, = (UA)cc 871.653 ×103 W/K,

(UA)cc = 0.82352 W/K,
c1 = -  0.258 W, c2 =  1.8373 W.

Cam = 0.4644 J/K,    

AHU

C pa = 1, C pw = 5, Cam = 1, Cwm = 15, c1 = 0  , c2 = 0.

C pa = 52.049 J/kgK, C pw = 145.34 J/kgK, Cam = 52.049 J/K, Cwm 3.3252 ×10-5 J/K, =

C pw = 4181.3 J/kgK, Cam 39.281×103 J/K, = = (UA )cc Cwm = 107.013 J/K, 1.743 ×106 W/K, c1 = 0 W, c2 = 0 W.

(UA)cc = 100,

(UA)cc = 12.905 W/K,
c1 = 0 W, c2 = 0 W.

BT

CBT = 10,  = C 4.18 ×10-3 ,  pw c = 10.

CBT = 5.76 J/K,  4.18 C = ×10-3 J/kgK, pw c 5.2 ×10-6 W. = C pw = 29.145 J/kgK, 

= CBT 1.129 ×106 J/K,  4181.3 J/kgK, C pw = c = 0 W.
C pw = 4181.3 J/kgK, 

RFH and Zone

C pw = 0.5,

C pa 2.1438 × 10-2 J/kgK,  C pa = 1012 J/kgK,  C pa = 1.5 ×10-4 ,  = Cwf = 11022 J/K, = Cwf 12.921×106 J/K, 4.0 ×103 , C= wf

(UA)1 = 0.25, (UA)2 = 0.01,
c1 = 0,
GSHP

Cz = 9, 

Cz = 40959 J/K,

(UA)1 = 5.3773 W/K, (UA)2 = 0.12317 W/K,
c2 = -4.38 × 10
-4

= Cz 19.382 ×106 J/K,

= c1 1.7433 ×10-3 W, W.

(UA)1 = 1369.291 W/K, (UA)2 = 172 W/K,
c1 = 0 W, c2 = 0 W.

c2 = 0. C pw = 10,
c = 0.

C pw = 0.3153 J/kgK, c = 3.9795 W.

C pw = 4181.3 J/kgK, c = 0 W.

60

25
Temperature(°C) Temperature(°C)

30 20 10 0 0.5 1 Time(sec)

Teao Meas Teao Sim

20 15 10 0 25 100 300 200 Time(sec)

Tw o Meas Tw o Sim

1.5 x 10 Tfao Meas Tfao Sim

2
5

400

500

30
Temperature(°C)

Temperature(°C)

Tao Meas 20 Tao Sim

25 20 15 0 0.5 1 Time(sec)

15 0 100 300 200 Time(sec) 400 500

1.5 x 10

2
5

(a)
55 50 45 40 0 1 3 2 Time(sec) 4 x 10 5
4

(b)
TBT Meas
Temperature(°C)

Temperature(°C)

TBT Sim

25 24 23 22 21 0 0.5 1 Time(sec) 1.5 x 10 Tw ret Meas Tw ret Sim 2
5

Tz Meas Tz Sim

(c)
70 TrGSHP Meas TrGSHP Sim

Temperature(°C)

40 35 30 25 0 0.5 1 Time(sec)

Temperature(°C)

60 50 40 30 0 1000

1.5 x 10

2
5

2000 3000 Time(sec)

4000

5000

(e)

(d)

Figure 3-11: Measured vs. simulated responses of (a) ERV unit, (b) AHU, (c) BT, (d) RFHzone and (e) GSHP 61

Table 3-3: Performance of the models Unit ERV AHU

MAX AE MBE MAE

°C °C °C °C °C °C °C °C -

Teao 2.135
0.013 0.589 0.581 0.762 0.065 0.485 0.066

T fao 1.369
-0.002 0.364 0.211 0.459 0.020 0.280 0.016

Two 4.112
0.013 0.391 0.603 0.777 0.033 0.674 0.072

Tao 1.433
0.030 0.402 0.253 0.503 0.025 0.304 0.019

BT TBT 3.759 -0.017 0.826 1.270 1.127 0.019 0.767 0.018 0.026 0.949 65.449 0.900

RFH

Tz 0.662
0.040 0.180 0.050 0.224 0.008 0.133 0.006 0.010 0.836 44.260 0.700

Tw,ret 5.141
0.011 0.530 0.480 0.693 0.021 0.446 0.017 0.027 0.679 26.360 0.462

GSHP Tr ,GSHP 12.786 0.005 0.375 0.645 0.803 0.009 0.710 0.022 0.018 0.971 75.936 0.942

CV CC G

MAPE Std AE Std APE

MSE RMSE

D

0.069 0.025 0.979 0.970 79.307 74.204 0.959 0.941

0.056 0.032 0.849 0.883 46.609 26.700 0.720 0.780

3.8.

Conclusions

In Chapter 3 grey-box models of the residential HVAC systems were developed. The whole system was divided into subsystems such as ERV, AHU, RFH, BT, GSHP and Zone. The white-box models of each subsystem were developed by writing the energy balance equations. The high resolution data of the inputs and outputs of each subsystem (such as temperature and flow rate of air and water) was measured. Parameters of the white-box models were estimated by using the nonlinear least squares optimization technique. The developed models had high accuracy and were able to predict the output variables precisely. Furthermore, the models were combined to create the integrated HVAC model which was used to estimate the costs of the equipment operation under the existing on/off controllers. The model was further utilized to investigate the effects of energy conservation strategies and more advanced controllers on the total cost savings in the upcoming chapters. In the next chapter, the black-box model of the same HVAC system is developed and the comparison is made between the grey-box and black-box modeling methods in order to find out the best performing model that can be used for the controller development.

62

Chapter 4 Black-Box Modeling and Comparison
This chapter is based on the following published journal paper: · Abdul Afram, Farrokh Janabi-Sharifi, Black-box modeling of residential HVAC system and comparison of gray-box and black-box modeling methods, Energy and Buildings, Volume 94, 1 May 2015, pp. 121-149. In this chapter, black-box models of the residential HVAC system are developed. The data of the input and output of the system is measured and the models of the ERV, AHU, BT, RFH and GSHP are developed using the system identification techniques in MATLAB®. The developed models include models based on MIMO ANN, TF, process, SS and ARX ones of each HVAC subsystem (ERV, AHU, BT, RFH and GSHP). The grey-box models of the same HVAC subsystems were developed in [165] which are also compared with the black-box models developed in this chapter. The models were compared visually and analytically. Ranks of the models were calculated based on their relative performance. It was found that the ANN outperforms the other modeling methods followed by the ARX, TF, SS, process and grey-box models respectively.

4.1.

Introduction

HVAC systems consume about 40% of the total energy in a building [166, 167]. The energy consumption of the system can be reduced if it can be predicted accurately and appropriate energy conservation strategies, e.g., thermal storage in the building mass [106] or floor heating mass [107], passive solar gains [107], thermal storage in tank water [105, 137], temperature reset during unoccupied hours [128, 138], night setbacks, pre-cooling during off-peak periods and set-point changes during peak hours [139, 140], optimum start and stop times [141], ventilation control [142, 143] and economizer cycle control [138, 144, 145] are applied. Advanced controllers [130], e.g., classical PID [88, 168], nonlinear [169], robust [151], optimal [152], model predictive [22, 108, 109, 170], FL [153156], ANN [25, 29, 128, 171, 172], adaptive fuzzy [157], adaptive neuro [128], and fuzzy PID [156] can also be implemented to predict the energy consumption and take appropriate actions to reduce energy consumption. The performance of the controllers depends largely on the accuracy of the system models and the processes being controlled. Therefore, the development of accurate models is 63

necessary which perform well under the wide range of operating conditions and are able to cope with the nonlinear behavior of the system. According to the review of modeling methods for HVAC systems in [173], the researchers have developed several methods such as white-box models [62, 63], black-box models [22, 23, 26, 29, 41, 46, 48] and grey-box models [56, 84-86] to model the behavior of the HVAC systems. The white-box models require the understanding of the system physics and use the manufacturer supplied parameters for modeling the system dynamics. The white-box models have good generalization capabilities but poor accuracy compared to the black-box models. The black-box models are developed by measuring the data of the system input and output and fitting a mathematical function to the data. The development of black-box models does not require the understanding of the system physics and they have high accuracy compared to the physics-based models though they suffer from the poor generalization capabilities. A balance between the good generalization capability and high accuracy is provided by the grey-box models which use the physics-based white-box model as the mathematical structure and measured data to estimate the parameters of the models. As a result, grey-box models require more effort to develop, have good generalization capabilities compared to black-box models, and demonstrate higher accuracy compared to the white-box models. The organization of the chapter is as follows: In Section 4.2, system description is provided explaining the residential HVAC system under research. In Section 4.3, the details regarding the developed models are provided. In Section 4.4, two methods for comparison of the models, i.e., visual and analytical methods are provided and the models are ranked based on their overall performance. The detailed numerical data including matrices and functions for the identified models is provided in Appendix I. The numerical data regarding the performance comparison metrics of each model is provided in Appendix II.

4.2.

System Description

The residential HVAC system is installed at the TRCA-ASHB in Vaughan, Ontario, Canada. There are two houses House-A and House-B which are semi-detached houses. The House-A is outfitted with the traditional HVAC equipment comprising of HRV, single-zone AHU and ASHP typical of many Canadian households. The House-B comprises of more advanced HVAC equipment aimed at the futuristic housing projects such as net zero buildings. The HVAC system in House-B comprises 64

of ERV, multi-zone AHU, GSHP and RFH system. The In-Law Suite receives its heating and cooling from the House-B HVAC system. In this chapter, only the modeling of House-B HVAC system is discussed. A simplified block diagram of the TRCA-ASHB HVAC system is supplied in Figure 4-1. The heating is supplied by the RFH system and the cooling is supplied by the AHU. The water is stored in the BT to supply the hot and cold water to the RFH and AHU systems. The temperature of the BT water is maintained by the GSHP. In the winter, hot water is supplied by the GSHP and in the summer cold water is supplied by the GSHP to the BT. ERV transfers the energy from the outgoing stale air to the incoming fresh air.
Exhaust air outlet Fresh air inlet Return air Pre-heated/precooled fresh air Supply water to AHU Return Water from AHU Supply water to RFH BT Return Water from RFH Supply water to GSHP GSHP Return Water from GSHP RFH

ERV

AHU

Return air from the zones Fresh air to the zones Supply water to the zones Return water from the zones Supply water to the ground loop Return water from the ground loop

Figure 4-1: Simplified block diagram of TRCA-ASHB HVAC system

4.3.

Modeling

Each of the subsystem including ERV, AHU, BT, RFH and GSHP is modeled separately. The inputs and outputs of these models are shown in Figure 4-2. All the systems have multiple inputs. ERV, AHU and RFH systems have multiple outputs; whereas, BT and GSHP systems have single output. The measurements are performed on all inputs and outputs of these multiple-input and single-output (MISO) and MIMO systems. The temperature and flow rate measurements in all air and water loops were performed at an interval of 5 sec and the data was stored in SQL database. The high resolution data captures the process dynamics very well but is not suitable for the modeling purpose as it results in large datasets resulting in increased time spent in training the models. The data was extracted from the database and median filtering was applied to remove the spiked noise in the measurements. The 65

data was then down sampled to reduce the data resolution while keeping its ability to capture all the necessary process dynamics. This data was used to develop the grey-box models and black-box models of the system. Figure 4-3 shows the data used for modeling and validation of each subsystem. The developed black-box models include ANN models, frequency domain TF models, frequency domain process models with time delay, time domain SS models, and polynomial ARX models.
Temperature of inlet fresh air Flow rate of inlet fresh air Temperature of inlet exhaust air Flow rate of inlet exhaust air Temperature of inlet air Temperature of inlet water Flow rate of inlet air Flow rate of inlet water Temperature of fresh air Temperature of supply water Temperature of the outside air Flow rate of fresh air Flow rate of water Temperature of return water from ILAHU Temperature of return water from GSHP Temperature of return water from RFH1 Temperature of return water from RFH2 Flow rate of water in ILAHU loop Flow rate of water in GSHP loop Flow rate of water in RFH1 loop Flow rate of water in RFH2 loop

ERV Model

Temperature of outlet fresh air Temperature of outlet exhaust air

BT Model

Temperature of water in BT

AHU Model

Temperature of outlet water Temperature of outlet air

RFH Model

Temperature of return water Temperature of zone

Temperature of GSHP supply water from BT Flow rate of water in GSHP-BT loop

GSHP Model

Temperature of GSHP return water to BT

Figure 4-2: Inputs and outputs of the models

4.3.1. Modeling and Validation Data
The data used for modeling and validation of each subsystem is presented in Figure 4-3. The following subsections describe the preparation of the data for each subsystem. 4.3.1.1 ERV Data

ERV unit is an air to air heat exchanger. Figure 4-3(a) shows the data of the inputs and outputs of the ERV unit. ERV receives the return air from the zone and the fresh air from outside and transfers the heat from outgoing stale air to the incoming fresh air. The flow rates of both the air streams along 66

with their temperature were measured. Since the flow rate of the air stream is same at the inlet and outlet; therefore, only one flow rate was measured but the temperature changes after the air stream passes through the ERV; therefore, the temperature was measured at both inlet and outlet ports of the ERV. This resulted in a total of two flow rate measurements and four temperature measurements. The data for ten days of Mar 2011 was used to model the ERV unit. The outdoor air temperature varies between -10°C and +10°C. The zone temperature was maintained at 22°C reflected in the exhaust air temperature graph. The heat from the exhaust air is transferred to the incoming fresh air and its temperature is raised about 12°C to 15°C. The flow rate remains constant during this period for both outgoing (0.05 kg/s) and incoming (0.06kg/s) air streams. About 55 hours of data was used for modeling and validation of the ERV unit. The data was down sampled to 500s (about 8.3 minutes) which was sufficient to capture the slow moving dynamics of the ERV subsystem. 4.3.1.2 AHU Data

AHU comprises of a mixing box, a cooling coil, a fan and three dampers to control the flow of the air to the zones. Since the House-B has the multi-zone AHU; therefore, there are three outlet/supply air streams serving three zones in the house. Based on the demand from the zone thermostat, the corresponding damper is opened and the cold air is let into the zone to control its temperature. The return air from the three zones enters the AHU and is mixed before passing through the cooling coil. Cooling coil is a water to air heat exchanger and transfers heat from the hot air to the cold water in turn making the air cold and water hot at their respective outlets. The flow rate and temperature of all the entering and leaving air and water streams is measured resulting in a total of eight temperature measurements and seven flow rate measurements. The entering and leaving air streams were combined proportionally based on their flow rates into a single air stream to simplify the modeling process by converting the multi-zone AHU to a single-zone AHU with only one entering and one leaving air stream. This results in four temperature and two flow rate readings which are shown in Figure 4-3(b). The AHU data was measured in September 2010. The temperature of the inlet air is close to the zone set-point of 22.5°C. The temperature of the air at the outlet of the AHU is about 16 °C which means on average the air temperature is dropped by about 8°C on average after passing through the cooling coil. The inlet water temperature is about 10°C on average and the outlet water temperature is raised about 4°C after passing through the cooling coil. The flow rate of the water is constant at (0.02kg/s); whereas, the flow rate of the air depends on the simultaneous cooling demand from the zones and varies in the range of 0.025 kg/s to 0.04 kg/s. The data presented in the Figure 4-3(b) is not raw data 67

as recorded from the sensors, rather it is the result of a threshold process where the data corresponding to no air flow (when no zone needs cooling) was removed since no heat transfer takes place in that period. Since the dynamics of the AHU are faster compared to the ERV unit; therefore, a different faster sampling rate of 30 sec was used to down sample the data. 4.3.1.3 BT Data

BT helps to reduce the equipment short cycling by storing the thermal energy. BT stores the hot water during the winter season and cold water during the summer season. In this chapter, the model of the BT for the winter season is developed. The BT temperature is maintained by the GSHP between 33°C and 43°C. The BT supplies hot water to multi-zone RFH system of House-B and ILAHU during heating season. About 60 days of data between September and November 2013 was used for the modeling and validation of BT subsystem. Figure 4-3(c) shows about 13 hours of such data. During this period, the ILAHU pump was constantly on (0.04 kg/s) irrespective of the demand from the In-Law Suite. The RFH pumps for zone-1 (RFH1) and zone-2 (RFH2) were turned on (0.05 kg/s) based on the demand from their respective zone. Water flow rate in GSHP loop was about 5 times higher (2.7 kg/s) to meet the maximum demand of heating water adequately when all systems are supplying heating simultaneously. The sampling time of 50 seconds was found to be adequate to capture the dynamics of the BT subsystem and was used to prepare the data for modeling and validation. 4.3.1.4 RFH Data

House-B has a multi-zone RFH system. The RFH system receives hot water from the BT and circulates it into the copper tubing embedded in the floor of each zone. The model presented in this chapter is for the zone 1. The data used for RFH system was measured in March 2011 for 10 days. The data of about 55 hours was used for modeling and validation and is presented in Figure 4-3(d). The zone temperature is maintained at 22.5°C by the RFH system. The fresh air enters into the zone after passing through the ERV in winter at a constant flow rate (0.06 kg/s). The AHU does not work during the winter period; therefore, the air entering the zone comes directly from the ERV without further heating from AHU. This air can be treated as the fresh air entering into the zone. The supply water in RFH loop is within the range of 33°C and 43°C (same as the BT water temperature). The RFH pump turns on (0.1 kg/s) based on the demand from the zone thermostat. The water is 68

returned to the BT from RFH at an average temperature of about 25°C. The data was down sampled to 50 seconds interval for the modeling and validation purpose. 4.3.1.5 GSHP Data

GSHP receives the comparatively cold water from the BT and returns the hot water to the BT. GSHP return water is on average about 2°C hotter than the supply water. The GSHP turns on based on the demand from the BT. The data for the GSHP was measured in winter 2013. The GSHP starts charging the BT when the water temperature falls below 37°C and stops when it reaches about 47°C. The data for modeling and validation of the GSHP system is shown in Figure 4-3(e) which is a result of a threshold operation in which only the data pertaining to when the GSHP pump was turned on was kept (i.e., data was removed when no heat transfer takes place). The data was down sampled at 50 seconds for modeling and validation.
Modeling Data 20 10 0 Tfai Teai Teao 20 10 0 Validation Data Tfai Tfao Teai Teao Tfao

Temperature (°C)

0.07

5

10

15

Temperature (°C)

20

25

30

35

40

45

50

55 mfa

0.07

5

10

15

20

25

30

35

40

45

50

55 mfa mea

Flow Rate (kg/sec)

0.06

Flow Rate (kg/sec)

mea

0.06

0.05

0.05

0.04

5

10

15

20

25 30 Time (hour)

35

40

45

50

55

0.04

5

10

15

20

Modeling Data 20 Tai Tw i

(a)
Temperature (°C)
Tao Tw o 20

25 30 Time (hour)

35

40

45

50

55

Validation Data Tai Tao Tw i Tw o

Temperature (°C)

15

15

10 0 5 10 15 20 25 30 35 40 45 ma

10 0 5 10 15 20 25 30 35 40 45 ma mw

Flow Rate (kg/sec)

0.35 0.3 0.25 0.2 0.15 0 5 10 15 20 25 Time (min) 30 35 40 45

Flow Rate (kg/sec)

0.4

mw

0.4 0.35 0.3 0.25 0.2 0.15 0 5 10 15 20 25 Time (min) 30 35 40 45

(b) 69

Modeling Data 50 Tr,ILAHU 50

Validation Data Tr,ILAHU Tr,GSHP Tr,RFH1 Tr,RFH2 TBT

Temperature (°C)

40 35 30 25 3 2 4 6 8 10 12

Tr,RFH1 Tr,RFH2 TBT

Temperature (°C)

45

Tr,GSHP

45 40 35 30 25

mILAHU

3

2

4

6

8

10

12 mILAHU mGSHP mRFH1 mRFH2

Flow Rate (kg/sec)

2

Flow Rate (kg/sec)

mGSHP mRFH1 mRFH2

2

1

1

0

2

4

6 8 Time (hour)

10

12

0

2

4

Modeling Data Tz Tw ,ret Tw ,sup

(c)
Temperature (°C)
To 40 20 0 0 mw 10 20

6 8 Time (hour)

10

12

Validation Data Tz To Tw ,ret Tw ,sup Ta,fresh

Temperature (°C)

40 20 0 0 10 20 30 40 50

Ta,fresh

30

40

50 mw ma,fresh

Flow Rate (kg/sec)

0.05

Flow Rate (kg/sec)

0.1

ma,fresh

0.1

0.05

0 0

10

20

30 Time (hour)

40

50

0

0

10

20

55
Temperature (°C)

Modeling Data

(d)
Ts,GSHP
Temperature (°C)

30 Time (hour)

40

50

55 50 45 40 35 30 0 1 2

Validation Data Ts,GSHP Tr,GSHP

50 45 40 35 30 3.3 0 1 2 3 4 5

Tr,GSHP

mGSHP
Flow Rate (kg/sec)

3.3

3

4

5 mGSHP

Flow Rate (kg/sec)

3.2

3.2

3.1

3.1

3

0

1

2

3 Time (hour)

4

5

3

0

1

2

(e)

3 Time (hour)

4

5

Figure 4-3: Data for modeling and validation of (a) ERV, (b) AHU, (c) BT, (d) RFH and (e) GSHP

70

4.3.2. Grey-box Models
The grey-box models were developed in [165]. The results of these models were used to compare with the black-box models developed in this chapter.

4.3.3. Black-Box Models
The black-box models were identified in the MATLAB ® including the ANN, TF, Process, SS and ARX for each of the ERV, AHU, BT, RFH and GSHP subsystems. All the identified models are presented in the Appendix I. While selecting the model order, it is reasonable to keep the model order low if no benefit is gained by increasing the order. A higher order model does not necessarily fit the data well. Increasing the model order unnecessarily can over fit the training data. Training a model on the modeling data set and testing on a separate validation data set helps to avoid the over fitting problem. The goodness of fit (%age fit) was computed for each model order. If increasing the model order resulted in a decrease in the value of fit or the value of fit did not improve at least 5%, the increase in model order was discarded and the lower order model was used. In this research, the model order was kept to first or second order for TF models and process models based on this criteria. The order of the SS and ARX models was determined using the Hankel Singular Value plot. This resulted in most of the SS models to be 3rd order; whereas, most of the ARX models were 4th order. The fit for SS and ARX plots was also calculated for various model orders and best order was chosen based on the 5% fit increase criteria explained above. For the ANN models, several different sizes of network were tested. The difference between the network architectures was little once the number of the hidden layer neurons increase above twice the number of ANN inputs. Therefore, a single value of 10 neurons in the hidden layer was used for all ANN models which satisfies the criteria of twice the number of input neurons for ERV, AHU, RFH and GSHP subsystems. The number of input and output layer neurons is determined by and equal to the corresponding number of inputs and outputs of the system being modelled. Following subsections provide the general details about black-box modeling methods used in this research.

71

4.3.3.1

ANN Models

ANN works like the human brain and learns by example. The measurement data is randomly divided into training and test data sets. The ANN is trained using the training data. The training data comprises of network inputs and true outputs also known as targets. The network architecture consists of one input layer, one output layer and one or more hidden layers. Each layer consists of neurons which receive signals from the previous layers and produce the output based on a nonlinear sigmoidal activation function. The input layer receives the input signals and the output layer generates the output signals. The number of neurons in the input layer is equal to the number of inputs and the number of neuron in the output layer is equal to the number of outputs of the network. For example, Figure 4-4 shows the architecture of a 2-2-1 ANN. The network has two inputs and one output. There are two neurons in the input layer, two neurons in the hidden layer and one neuron in the output layer. Each layer also consists of one bias unit neuron which provides a constant signal of +1 at its outputs and has no input. The symbols a11, a12, a13, a23 and a22 are the values computed by the forward propagation algorithm at each neuron by applying the activation function on the linear combination of the input values and layer weights.
Bias Unit 1 a01 = +1 b11 a12 v13 v22 b21 a22 Bias Unit 2 a02 = +1 c11 Input x1 a11 = x1 v12 w12 w13 Output Layer a13 Output

Input x2

a21 = x2 Input Layer

v23

Hidden Layer

Figure 4-4: Example of the architecture of a 2-2-1 ANN ANN can have multiple inputs and multiple outputs. The number of hidden layers and the number of neurons in each of the hidden layer depends on the complexity of the nonlinear function which the 72

ANN wants to predict. Typical ANNs have 1-2 hidden layers and 5-10 neurons in each hidden layer. The number of neurons in the hidden layer is generally equal to or greater than the number of inputs. Such network can approximate any nonlinear function to a high degree of accuracy. The ANN learns the features from the inputs and generates its own features at the output of each hidden layer. ANN is trained using the back-propagation algorithm. The neurons in each layer receive inputs from all the neurons in the previous layer. Each input is assigned a weight. At each neuron, a linear combination of the inputs and their corresponding weights is calculated and the result is input to a nonlinear sigmoidal function known as activation function. The output of the sigmoidal function represents the output of each neuron. Sigmoidal is an exponential function which has linear region and nonlinear region. The derivative of the sigmoidal function is used in the back propagation algorithm. Two commonly used sigmoidal activation functions are hyperbolic tangent and exponential. The training takes a long time if the data set is large and network has many inputs and outputs. The well trained network predicts the outputs with great accuracy. The speed of prediction for the trained network is very high. The limitation of the training network is that it has good accuracy for the training data but the accuracy decreases when the test conditions are different. The ERV ANN model has one input layer, one hidden layer and one output layer. There are four inputs and two outputs of the ERV model. There are a total of 4 neurons in the input layer, 10 neurons in the hidden layer and 2 neurons in the output layer. The sigmoid was used as the activation function. In the AHU ANN model, there is one input layer, one output layer and one hidden layer with 10 neurons in it. BT model has 8 input neurons, one output neuron and 10 neurons in the hidden layer. RFH ANN Model has 5 input neurons, 2 output neurons and 10 neurons in the hidden layer. The GSHP model has 2 input neurons one output neuron and 10 neurons on the hidden layer. 4.3.3.2 TF Models TF models provide the relation between the input and output of the system in the frequency domain. The MIMO TF models can be identified by using the superposition principle in which each input and output is assumed to be decoupled from each other. The outputs of the MIMO TF model are computed as follows:

yk = G jk ( s ) u j ,
j =1

n

(4.1)

73

where k is the output number, j is the input number, n is the total number of inputs, u is the input, y is the output and Gjk(s) is the TF between input j and output k. 4.3.3.3 Process Models The output of the process model can also be computed in a similar fashion to the TF model using the superposition principle. The first-order continuous-time process model with time delay between each input and output is represented by the following general equation:

G jk ( s ) = K p

1 + Tz s -Td s e , 1 + Tp s

(4.2)

where j = 1,2,...,4 is the input and k = 1, 2 is the output number, Kp is the static gain, Tp and Tz are the time constants and Td is the input-to-output delay. 4.3.3.4 SS Models The continuous-time SS model is represented by the following equations:
dx = Ax(t ) + Bu (t ) + Ke(t ), dt

(4.3) (4.4)

y (t ) =Cx(t ) + Du (t ) + e(t ),

where A, B, C, D and K are the SS matrices, u(t) is the input, e(t) is the disturbance and y(t) is the output of the system. 4.3.3.5 ARX Models The statistical black-box models consist of single and multivariate linear and polynomial regression techniques, AR, ARX, ARMA, FIR, ARMAX, OE and BJ models [173]. The mathematical expression for the generalized structure of statistical black-box models in a simple input/output relationship is provided by [41] as follows:
A = ( z ) y (t ) B( z ) C ( z) u (t ) + e(t ), F ( z) D( z )

(4.5)

74

where y(t), u(t) and e(t) are the output, input, and noise respectively, A(z), B(z), C(z), D(z) and F(z) are polynomials given as

A( z ) = 1 + a1 z -1 +...+ ana z - na , B( z ) = 1 + b1 z -1 +...+ bnb z - nb , C ( z ) = 1 + c1 z -1 +...+ cnc z - nc , D( z ) = 1 + d1 z -1 +...+ d nd z - nd ,
F ( z ) = 1 + f1 z -1 +...+ f n f z
-n f

(4.6) (4.7) (4.8) (4.9) (4.10)

.

-1 where z is the back shift operator and na, nb, ..., nf are the order of the polynomials A(z), B(z),... ,

D(z) respectively. Different polynomials used for AR, ARX, ARMA, FIR, ARMAX, OE and BJ models are shown in Table 4-1 [41]. Table 4-1: Statistical model structures Name of the Model AR ARX ARMA FIR ARMAX OE BJ
A( z ) A( z ), B ( z ) A( z ), C ( z ) B( z ) A( z ), B ( z ), C ( z ) B ( z ), F ( z ) B ( z ), C ( z ), D ( z ), F ( z )

Polynomials Used

Based on the Table 4-1, we can write the input/output equations of each model as follows: AR ARX

A( z ) y (t ) = e(t ), A = ( z ) y (t ) B( z )u (t ) + e(t ),

(4.11) (4.12)

75

ARMA FIR ARMAX OE

A( z ) y (t ) = C ( z )e(t ), = 0 B( z )u (t ) + e(t ), A = ( z ) y (t ) B( z )u (t ) + C ( z )e(t ),
= 0 B( z ) u (t ) + e(t ), F ( z)

(4.13) (4.14) (4.15) (4.16)

BJ

= 0

B(z) C ( z) u (t ) + e(t ). F ( z) D( z )

(4.17)

As seen from these models some of these models such as FIR, OE and BJ do not consider the output while the others such as AR and ARMA do not consider the input in the input/output equation; therefore, may not be useful for closed loop control system. The model ARX and ARMAX consider both the input and output in their structure and are useful for the design of closed loop control system. For the system with one output and multiple inputs, the discrete-time ARX model is given as follows:

 y (t ) =

n

j =1

B j ( z )u j (t ) + e(t ) A( z )

.

(4.18)

For the system with two outputs and two inputs, the discrete-time ARX model is given as follows: For output y1:

y1 (t ) =
For output y2:

- Ai ( z ) yi (t ) +  j =1B j ( z )u j (t ) + e1 (t )
n

A( z )

.

(4.19)

y2 (t ) =

- Ai ( z ) yi (t ) +  j =1B j ( z )u j (t ) + e2 (t )
n

A( z )

.

(4.20)

where n is the number of total inputs of the system. 76

4.4.

Comparison of the Models

4.4.1. Visual Comparison of the Models
In the following subsections, the measured vs. simulated responses of the models are plotted in order to visually compare the performance of the models. The measured data is plotted using the dotted line; whereas, the model estimates are plotted using the solid lines. 4.4.1.1 ERV Models

ERV model has two outputs which are plotted in the Figure 4-5. On the left is the first output of the ERV model, i.e., `temperature of the exhaust air outlet (Teao)' and on the right side the second output of ERV model, i.e., `temperature of the fresh air outlet (Tfao)' is plotted. From the top to the bottom, the measured data is plotted against the predictions of the grey-box model, ANN model, TF model, process model, SS model and ARX model respectively for each output. As can be seen from these graphs, all the models were able to predict the outputs to a reasonable accuracy. 4.4.1.2 AHU Models

The predictions of the AHU models are plotted in the Figure 4-6. The first output, `temperature of the outlet water (Two)' is plotted on the left and the second output, `temperature of the outlet air (Tao)' is plotted on the right. The visual inspection reveals that some models, e.g., ANN and ARX were able to predict both the outputs better compared to some other models, e.g., grey-box models and process models. TF and SS models also seem to have a better performance compared to the grey-box and process models.

77

20

(°C)

(°C)

15 10 5 0 20 10 20 30 40 50

eao

T

T

fao

Measured Grey-box

20 15 0 10 20 30 40 50

Measured Grey-box

(°C)

(°C)

15 10 5 0 20 10 20 30 40 50

eao

Measured ANN

20 15 0 10 20 30 40 50

Measured ANN

T

(°C)

(°C)

15 10 5 0 20 10 20 30 40 50

eao

T

T

fao

Measured TF

T

fao

20 15 0 10 20 30 40 50

Measured TF

(°C)

(°C)

15 10 5 0 20 10 20 30 40 50

eao

T

T

fao

Measured Process

20 15 0 10 20 30 40 50

Measured Process

(°C)

(°C)

15 10 5 0 20 10 20 30 40 50

eao

Measured SS

20 15 0 10 20 30 40 50

Measured SS

T

(°C)

(°C)

15 10 5 0 10 20 30 Time (hour) 40 50

eao

T

T

fao

Measured ARX

T

fao

20 15 0 10 20 30 Time(hour) 40 50

Measured ARX

Figure 4-5: Measured vs. simulated response of ERV models
(°C) (°C)
15 10 0 10 20 30 40 Measured ANN
wo

Measured Grey-box

18 16 14 18 0 10 20 30 40

Measured Grey-box

T

T

ao

(°C)

(°C)

15 10 0 10 20 30 40

wo

T

T

ao

16 14 0 10 20 30 40

Measured ANN

(°C)

(°C)

15 10 0 10 20 30 40

wo

Measured TF

18 16 14 0 10 20 30 40

Measured TF

T

T
Measured Process

ao

(°C)

(°C)

15 10 0 10 20 30 40

18 16 14 0 10 20 30 40

wo

Measured Process

T

T
Measured SS

ao

(°C)

(°C)

15 10 0 10 20 30 40

18 16 14 0 10 20 30 40

Measured SS

wo

T

T
Measured ARX

ao

(°C)

(°C)

15 10 0 10 20 30 Time (min) 40

18 16 14 0 10 20 30 Time (min) 40

wo

Measured ARX

T

Figure 4-6: Measured vs. simulated response of AHU models 78

T

ao

4.4.1.3

BT Models

The response of BT models is presented in Figure 4-7. BT model has only one output, i.e., `temperature of the BT water (TBT)'. The SS model seems to perform best; whereas, the grey-box model seems to have the worst performance. The other models, i.e., ANN, process and ARX seem to have a similar response. 4.4.1.4 RFH Models

Results of RFH modeling are shown in Figure 4-8. The two outputs of the RFH, i.e., `zone temperature (Tz)' and `temperature of the return water (Twret)' were more challenging to predict for some models, i.e., ANN, TF, process and SS compared to others, i.e., grey-box and ARX. This probably happened due to the challenging nature of the dataset as the range of the data is small and has some measurement noise and invalid data as well. Grey-box model performed the best due to its ability to correlate the data to the inputs of the system.
50
T (°C)

45 40 35 50 0 2 4 6 8 10 12

Measured Grey-box

BT

T (°C)

45 40 35 50 0 2 4 6 8 10 12

Measured ANN

BT

T (°C)

45 40 35 50 0 2 4 6 8 10 12

Measured TF

BT

T (°C)

45 40 35 50 0 2 4 6 8 10 12

Measured Process

BT

T (°C)

45 40 35 50 0 2 4 6 8 10 12

Measured SS

BT

T (°C)

45 40 35 0 2 4 6 8 Time (hour) 10 12

Measured ARX

Figure 4-7: Measured vs. simulated response of BT models 79

BT

23

T (°C)

w ret

z

22 21 23 0 10 20 30 40 50

Measured Grey-box

35

30 25 0 10 20 30 40 50

Measured Grey-box

T
Measured ANN

(°C)

35

T (°C)

w ret

z

22 21 23 0 10 20 30 40 50

30 25 0 10 20 30 40 50

Measured ANN

T
Measured TF

(°C)

35

T (°C)

w ret

z

22 21 23 0 10 20 30 40 50

30 25 0 10 20 30 40 50

Measured TF

T
Measured Process

(°C)

35

T (°C)

w ret

z

22 21 23 0 10 20 30 40 50

30 25 0 10 20 30 40 50

Measured Process

T
Measured SS

(°C)

35

T (°C)

w ret

z

22 21 23 0 10 20 30 40 50

30 25 0 10 20 30 40 50

Measured SS

T
Measured ARX

(°C)

35

T (°C)

w ret

z

22 21 0 10 20 30 Time (hour) 40 50

30 25 0 10 20 30 Time (hour) 40 50

Measured ARX

Figure 4-8: Measured vs. simulated response of RFH models
rGSHP

T

(°C)

(°C)

50 40 30 0 1 2 3 4 5 6 50 40 30 0 1 2 3 4 5 6 50 40 30 0 1 2 3 4 5 6 50 40 30 0 1 2 3 4 5 6 50 40 30 0 1 2 3 4 5 6 50 40 30 0 1 2 3 Time (hour) 4 5 6

Measured Grey-box

T

Measured ANN

T

rGSHP

(°C)

Measured TF

T

rGSHP

(°C)

Measured Process

T

rGSHP

(°C)

Measured SS

T

rGSHP

(°C)

Measured ARX

Figure 4-9: Measured vs. simulated response of GSHP models 80

T

rGSHP

(°C)

4.4.2. Analytical Comparison of the Models
From the visual inspection of the model responses, it is hard to see the difference in performance for the models having similar responses. In order to compare the performance of the models, the performance comparison metrics defined in Chapter 2 were used. These metrics were computed for all the outputs of the models. The results are summarized in Appendix II. A smaller value of AE, APE, MaxAE, MAE, MSE, RMSE, StdAE, StdAPE and CV is better; whereas, a large value of CC, D and G shows a better fit between the measured data and the model prediction. For MBE, a value closer to zero is better. The best values are highlighted in the tables presented in Appendix II. It can be seen from these tables that the superior model performs best across most of these metrics. The data in these tables is also plotted in the Figure 4-10 (a, c), Figure 4-11 (a, c), Figure 4-12 (a), Figure 4-13 (a, c) and Figure 4-14 (a) to compare different models easily. Data of the performance metrics computation presented in these tables was also normalized using the feature scaling in order to bring all the values into the range [a, b] to compare the performance metrics as follows:
X = a +

( X - X min )(b - a ) , X max - X min

(4.21)

where X', X, Xmin and Xmax are normalized data, input data, minimum of input data, and maximum of input data respectively, and a = 0.03, b = 1 are the arbitrary points. After the normalization, it can be seen in the normalized data plots of Figure 4-10 (b, d), Figure 4-11 (b, d), Figure 4-12 (b), Figure 4-13 (b, d) and Figure 4-14 (b) that very similar information is supplied by the CC, D and G metrics and computation of only one of these should suffice for the performance evaluation of a model. 4.000 3.000 2.000 1.000 0.000 -1.000 (a) 81

1.000 0.800 0.600 0.400 0.200 0.000

(b) 1.400 1.200 1.000 0.800 0.600 0.400 0.200 0.000 -0.200 (c) 1.000 0.800 0.600 0.400 0.200 0.000

Grey-Box Model Process Model

ANN Model SS Model (d)

TF Model ARX Model

Figure 4-10: Comparison of ERV models for output 1 (Teao) (a) actual data (b) normalized data and output 2 (Tfao) (c) actual data (d) normalized data 82

9.500 8.500 7.500 6.500 5.500 4.500 3.500 2.500 1.500 0.500 -0.500

(a) 1.000 0.800 0.600 0.400 0.200 0.000

(b) 2.500 2.000 1.500 1.000 0.500 0.000

(c) 83

1.000 0.500 0.000

Grey-Box Model Process Model

ANN Model SS Model

TF Model ARX Model

(d) Figure 4-11: Comparison of AHU models for output 1 (Two) (a) actual data (b) normalized data and output 2 (Tao) (c) actual data (b) normalized data 4.500 4.000 3.500 3.000 2.500 2.000 1.500 1.000 0.500 0.000

(a) 1.000 0.500 0.000

Grey-Box Model Process Model

ANN Model SS Model

TF Model ARX Model

(b) Figure 4-12: Comparison of BT models (a) actual data (b) normalized data

84

2.500 2.000 1.500 1.000 0.500 0.000 -0.500 -1.000 -1.500 (a) 1.000 0.800 0.600 0.400 0.200 0.000

(b) 7.000 6.000 5.000 4.000 3.000 2.000 1.000 0.000

(c) 85

1.000 0.800 0.600 0.400 0.200 0.000

Grey-Box Model Process Model

ANN Model SS Model

TF Model ARX Model

(d) Figure 4-13: Comparison of RFH models for output 1 (Tz) (a) actual data (b) normalized data and for output 2 (Twret) (c) actual data (d) normalized data 25.000 20.000 15.000 10.000 5.000 0.000

(a) 1.000 0.800 0.600 0.400 0.200 0.000

Grey-Box Model Process Model

ANN Model SS Model

TF Model ARX Model

(b) Figure 4-14: Comparison of GSHP models (a) actual data (b) normalized data 86

4.4.3. Rankings of the Models
The rankings of the models are shown in the Table 4-2. The sum of the rankings across all the systems was computed to determine the final rank of the model. The model with the lowest sum performed the best and vice versa. It can be seen that the ANN model performed the overall best remaining at number 1 or number 2 in most of the prediction tasks. The second and third place was taken by the ARX and TF models respectively, whose sum was very close to each other, i.e., 23 and 25. The last three positions were taken by the SS, process and grey-box models respectively, whose total sum was again very close to each other, i.e., 35, 35 and 36 respectively. Table 4-2: Rankings of the Models System/Model ERV Output 1 ERV Output 2 AHU Output 1 AHU Output 2 BT RFH Output 1 RFH Output 2 GSHP Output Sum Final Rank Grey-box 4 6 3 6 6 2 4 5 36 6 ANN TF Process SS ARX 2 3 6 5 1 2 3 4 5 1 1 2 6 4 5 1 5 3 4 2 1 2 3 4 5 5 4 6 1 3 1 3 5 6 2 1 3 2 6 4 14 25 35 35 23 1 3 5 4 2

4.5.

Conclusions

In Chapter 4, black-box models of the residential HVAC system were developed. The ANN, TF, process, SS and ARX models were identified using the system identification techniques in MATLAB®. The prediction results of the grey-box models developed in Chapter 3 were also used to compare with the black-box models developed in Chapter 4. The performance of the models was compared using visual inspection and analytical metrics to determine the rankings of the models. Visual inspection of the models revealed that almost all the models performed well across all the subsystems and were able to predict the outputs accurately under most of the scenarios. In order to examine the performance more closely and help in rankings of the models, the analytical metrics were computed which determined that ANN models performed the overall best. The TF and ARX models performed equally

87

well at the second level; whereas, the SS, process and grey-box models scored the least coming at the third level. Although the data driven models all perform better than the grey-box model based on the analytical metrics as seen through the research carried out in this chapter, they all suffer from the noise in the measured data and their performance degrades as the training and testing conditions change. Also the difference in the performance of the data-driven and grey-box models is not very significant. The visual comparison reveals that the grey-box technique performs much better than the data driven technique in modeling the BT and RFH and it is on par with the black-box technique in modeling the ERV, AHU and GSHP. On top of that, the grey-box models have higher generalization capabilities as its strong point. Therefore, the grey-box models were chosen to develop the MPC in the next chapters.

88

Chapter 5 Review of HVAC Control Systems
This chapter is based on the following published journal paper: · Abdul Afram, Farrokh Janabi-Sharifi, Theory and applications of HVAC control systems ­ A review of model predictive control (MPC), Building and Environment, Volume 72, February 2014, pp. 343-355. This chapter presents a literature review of control methods, with an emphasis on the theory and applications of MPC for HVAC systems. Several control methods used for HVAC control are identified from the literature review, and a brief survey of each method is presented. Next, the performance of MPC is compared with that of other control approaches. Factors affecting MPC performance (including control configuration, process type, model, optimization technique, prediction horizon, control horizon, constraints, and cost function) are elaborated using specific examples from the literature.

5.1.

Introduction

With the significant increase of energy consumption in buildings, energy saving strategies have become a priority in energy policies in many countries. For instance, building energy consumption in the EU was 37% of the final energy totals in 2004 [166]. In the USA, building energy consumption accounted for 41% of primary energy consumption in 2010 [167]. The categories of building services and HVAC systems make up the major sources of energy use in buildings (almost 50% [166, 167]). Therefore, the development and implementation of effective control techniques for HVAC systems is of primary importance. In particular, with the decreased costs of data processing, storage, and communication over recent years, the design and implementation of more complex control techniques have become feasible. Despite the similarity of HVAC control to other types of process control, certain features exist that render HVAC system control unique and challenging, including the following: · · Nonlinear dynamics; Time-varying system dynamics and set-points; 89

· · · ·

Time-varying disturbances; Poor data due to low resolution of analog-to-digital converter devices, sampling rates, accuracy of sensors, and lack of access to network forecasting and environmental information; Interacting and at times conflicting control loops; and Lack of supervisory control (in many buildings).

Many control methods have been developed or proposed for HVAC systems. However, because of their simplicity, on/off and PID control are still used in many HVAC systems, resulting in inconsistent performance among such systems. With advances in data storage, computing, and communication devices, it is now feasible to adopt and implement a proper control approach to overcome the inherent issues in HVAC control. The focus of this chapter is on a survey of control methods for HVAC systems, and emphasis is placed on the MPC approach because research on MPC development for HVAC systems has intensified over the last few years due to its many inherent advantages, which includes · · · · · · · · · Use of a system model for anticipatory control actions rather than corrective control; Integration of a disturbance model for disturbance rejection; Ability to handle constraints and uncertainties; Ability to handle time-varying system dynamics and a wide range of operating conditions; Ability to cope with slow-moving processes with time delays; Integration of energy conservation and cost saving strategies in the controller formulation; Use of a cost function for achievement of multiple objectives; Use of advanced optimization algorithms for computation of control vectors; and Ability to control the system at both the supervisory and local loop levels.

However, a comprehensive survey of MPC approaches for HVAC systems is still lacking. In particular, selected trends and issues related to MPC design must be identified. The organization of this chapter is as follows: First, a review of HVAC systems is presented to outline the spectrum of control tasks in HVAC systems. Section 5.2 includes a brief review of previous surveys related to HVAC control. Section 5.3 classifies the approaches to HVAC control according to methodology, scope and implementation to create a framework with which to compare MPC with 90

other methods. Section 5.4 discusses the comparison of MPC with other methods as well as the factors that affect its performance.

5.2.

Previous Surveys

Brief reviews of hard and soft control techniques were reported in [138, 144], respectively. The hard control techniques reviewed in [138] include gain scheduling, optimal control, robust control, MPC, nonlinear and adaptive control. The soft or intelligent control techniques reviewed in [144] include controllers based on the ANN, FL, and GA. Intelligent control techniques such as neuro- and geneticfuzzy approaches were also reviewed in [174]. A review of hybrid controllers resulting from the fusion of hard and soft control techniques was also provided in [144]. ANN and GA applications for energy conservation in HVAC systems were comprehensively reviewed in [25]. A review of hybrid and soft techniques (i.e., fuzzy-P, fuzzy-PI, fuzzy-PID, adaptive-fuzzy, fuzzy-neural controllers) and multiagent control systems for energy management was provided in [175]. A review of fuzzy modeling and control of HVAC systems was published in [16]. A review of load forecasting in HVAC systems using intelligent control techniques was reported in [176, 177]. An overview of HVAC simulation approaches that covers the modeling of HVAC components, controls, and systems was presented in [17]. An overview of supervisory and optimal control of HVAC systems was given in [129]. The optimization techniques used in supervisory control (i.e., least squares, simplex search, gradient-based search, sequential QP, evolutionary programming and GA) were also reviewed in [129]. A survey of energy-efficient strategies for HVAC systems (i.e., heat recovery, liquid pressure amplification, and thermal storage) was conducted in [145]. Automatic controls for HVAC systems (i.e., on/off control, PID control, time control [on/off switch, fixed time boosted start, and optimum start and stop]) were reviewed in [178]. Additionally, a survey of the theory and applications of adaptive control for HVAC systems was given in [179].

5.3.

Classification of HVAC Control Methods

A classification for control methods in HVAC systems is illustrated in Figure 5-1. The control methods are divided into classical control, hard control, soft control, hybrid control, and other control techniques. Brief details of each method are provided in the following sections.

91

5.3.1. Classical Control
Classical controllers consist of the most commonly used control techniques, such as on/off control and P, PI, and PID control. The on/off controller uses an upper and lower threshold to regulate the process within the given bounds. The P, PI, and PID controllers use error dynamics and modulate the controlled variable to achieve accurate control of the process.
Classical Control ON/OFF P, PI, PID Gain Scheduling PID Hard Control Nonlinear Control Robust Control Optimal Control Model Predictive Control HVAC Control Methods Fuzzy Logic Control Neural Network Control Adaptive Fuzzy, Adaptive Neuro, Fuzzy PID etc. DFL Control PMAC Control Other Control Techniques PRAC Control Preview Control TPSC Control Reinforcement Learning Control

Soft Control

Hybrid Control

Figure 5-1: Classification of control methods in HVAC systems 92

Classical controllers are used for the dynamic control of cooling coil units [88, 168], room temperature control [59, 147-150], damper gap rate control [168, 180], supply air pressure control [168, 181], supply air temperature control [172, 182], VAV unit temperature control [183], evaporator supply heat control [183], and heater control [168]. Most of the research is focused on finding optimal tuning and auto-tuning methods for PID controllers. Although the on/off controller is the most intuitive and easiest to implement, it is unable to control moving processes with time delays. Because of the high thermal inertia of many HVAC processes, a process that is controlled using an on/off controller displays large swings from the set points. The PID controller produces promising results, but tuning the controller parameters is cumbersome, and the performance of the controller degrades if the operating conditions vary from the tuning conditions. Re-tuning or auto-tuning approaches for the PID controller [184] can be time-consuming. In certain applications, auto-tuning might be unacceptable because of its intrusive nature relative to normal operation [185].

5.3.2. Hard Control
Hard controllers are based on a theory for control systems composed of gain scheduling control, nonlinear control, robust control, optimal control, and MPC. In gain scheduling control, a nonlinear system is divided into piecewise linear regions. For each of the linear regions, a linear PI or PID controller is designed with a different set of gains. Self-tuning PI or PID controllers are also proposed in the literature to vary the controller gains based on the state of the process. For example, in [59], two PI controllers are tuned to meet the high and low heat demand conditions in a hydronic-radiator-based HVAC system. In [181], to control the supply air pressure, a PI controller is used with gains based on the error between the set point and the measured supply air pressure. For nonlinear controller design, the control law can be derived using Lyapunov's stability theory, feedback linearization and adaptive control techniques. The control law is used to drive the nonlinear system toward a stable state while achieving the control objectives. Nonlinear controllers have been applied to AHU control [169], cross flow water-to-air heat exchanger control [186], and control of greenhouse environments (ventilation, cooling and moisturizing) control [187]. 93

The purpose of robust control is to design a controller that works well under time-varying disturbances and changes in parameters. Examples of robust control include supply air temperature control [151], supply airflow rate control [151], and zone temperature control [188]. The optimal control algorithm solves an optimization problem to minimize a certain cost function. The objectives of optimization in HVAC systems are generally minimization of energy consumption and control effort and maximization of thermal comfort. Examples of optimal control design include active thermal storage control [152], passive thermal storage control [189], energy optimization of HVAC system [49, 72], VAV system control [61], and building heating and cooling control [190, 191]. The hard controller techniques are well established in the control system design field. The nonlinear control techniques are effective but require the identification of stable states and complex mathematical analysis for controller design. For gain scheduling control design, the identification of linear regions and design of switching logic between regions is necessary, and the manual tuning of multiple PID controllers in these regions can be quite cumbersome. Optimal control and robust control are promising techniques for HVAC process control because they are capable of rejecting disturbances and time-varying parameters. In general, robustness is difficult to guarantee in HVAC systems, which are subject to varying conditions in buildings. Many of these approaches also require the specification of additional parameters, which could be difficult and impractical for integration in HVAC systems. Among the hard control approaches, MPC is one of the most promising techniques because of its ability to integrate disturbance rejection, constraint handling, and slow-moving dynamic control and energy conservation strategies into controller formulation.

5.3.3. Soft Control
Soft control techniques such as those based on FL [153-156] and ANN [25, 29, 128, 171, 172] are comparatively new techniques made possible by the advent of digital controllers. In an FL controller [153-156], control actions are implemented in the form of if-then-else statements. The FL also can be incorporated for the auto-tuning of PID controller gains in which PID control represents the local scope of control, and the FL supervisor is often used to optimize the response of the system on the global scale. The fuzzy supervisor also acts as an arbiter and resolves conflicting objectives from the local level controllers by prioritizing certain controllers over others based on the common goals of reduction in energy consumption and maintenance of thermal comfort. 94

Alternatively, the FL can be implemented on both the local and supervisory levels of control. Examples of FL design include predicted mean vote (PMV)-based thermal comfort control [154], which controls temperature, humidity, and air velocity in an AHU. Another example of FL is the design of a three-level hierarchical supervisory-FL controller to generate the operating modes of the water and air subsystems and the set-points for the lower level controllers [192]. The ANN is trained on the performance data of the system and fits a nonlinear mathematical model to the data. The algorithm is a black-box modeling technique that does not require an understanding of the underlying physics of the process. The ANN is commonly used in feed-forward control, and ANN can be trained on the controller input-output in an attempt to replace a conventional controller in that application. Examples of ANN design include a PMV-based thermal comfort controller for zone temperature control [193], optimization of air conditioning (AC) setback time based on outdoor temperature [194], and fan control of an air cooled chiller [195]. The implementation of FL control requires comprehensive knowledge of the plant operation and its different states; whereas, ANN-based control design requires training data on a wide range of operating conditions, which may not be available for many systems. Additionally, industry is usually reluctant to adopt and use a black-box approach.

5.3.4. Hybrid Control
Hybrid controllers are produced by the fusion of hard and soft control techniques. Several controllers, including quasi-adaptive fuzzy control [157], adaptive-neuro control [128] and fuzzy-PID control [156], have been proposed in the literature for the control of HVAC systems. Hybrid controllers are composed of soft control techniques such as ANN at higher levels and hard control techniques such as adaptive controllers at the lower levels of the control structure. In fuzzyPID systems, controller gains can be auto-tuned using FL. Both hard and soft control techniques complement each other, and a combination of both can solve problems that may not be solved by each technique separately. Examples of hybrid control include a fuzzy self-tuning PI controller for supply air pressure control [181] and a quasi-adaptive fuzzy controller for zone temperature control [157] using convector-radiator power control.

95

Just as hybrid control benefits from the qualities of both hard and soft control techniques, it also inherits the problems associated with those techniques. For example, the design of a soft control component requires user expertise and large amounts of data for training, and the hard control component may be difficult to design and tune under the wide range of operating conditions often observed in HVAC systems.

5.3.5. Other Control Techniques
Other control techniques, such as direct feedback linear (DFL) control [196], pulse modulation adaptive controller (PMAC) [197], pattern recognition adaptive controller (PRAC) [198], preview control [199], two parameter switching control (TPSC) [200], and reinforcement learning control [201, 202] have also been proposed for the control of HVAC systems. The purpose of DFL control is to achieve decoupling between different control loops in HVAC systems and achieve global stability of the system. By applying input-output linearization, the coupled equations of the system are converted to linear uncoupled equations to which conventional linear control techniques can be applied. The DFL has been applied for control of zone temperature in [196] and demonstrated lower energy consumption, better disturbance rejection, and enhanced transient and steady state performance compared with PID control. The PMAC is useful only for on/off systems such as fixed capacity compressors. The purpose of PMAC is to reduce the switching frequency of an on/off system to reduce equipment cycling and the associated energy costs and equipment wear. Using a PMAC, on/off systems can be controlled by a closed loop controller such as PID. The PID controller measures the error of the system from its set point and generates an analog signal as its output. The PMAC cascaded with a PID controller generates discrete an on/off pulse-width pulse-frequency modulation (PWPFM) signal corresponding to this analog signal. The PWPFM signal is applied to the discrete input of the system instead of an analog signal. For example, in [197], PMAC regulated the zone temperature of a direct expansion system by controlling the single-capacity compressor. The PRAC automatically tunes the gain and integral time of the PI controller based on the closed loop response patterns in self-regulating systems. This method produces near-optimal performance, and according to [198], it has been applied to HVAC control of many buildings, including offices, high schools, national labs, and hospitals. The process output is

96

measured and fed to a digital PRAC, which estimates the process noise and tunes the PI controller parameters to tightly regulate the process. The TPSC can be viewed as an improvement to the on/off controller, which uses one sensor or parameter to control the operation. Instead, the TPSC uses two sensors mounted at different points to control the system. For instance, the TPSC has been used to control the flow rate of hot water in RFH systems based on measurements of slab temperature and air temperature [200]. Compared with the on/off controller, the TPSC reduces oscillations of the air temperature and slab temperature because it increases the control effort by turning the control valve on and off more often. Reinforcement-learning controller learns from the input and output of the system from past control actions using machine-learning techniques. For example, reinforcement learning control has been applied for thermal energy storage [201, 202]. The reinforcement-learning controller savings are comparable to those of conventional control techniques but do not reach the level of MPC cost savings. Reinforcement learning is a model-free method and improves the controller performance based on previous control actions; however, it takes an unacceptably long time to learn and is difficult to implement in practice [129].

5.3.6. Summary
When considering HVAC control system characteristics, the MPC offers many advantages. Many processes in HVAC systems are slow moving with time delays, and time-varying internal and external disturbances act on the system. The system undergoes a wide range of operating conditions. The actuators exhibit rate and range limit constraints. In many areas, energy has a variable price structure. In the presence of all of these challenges, an ideal controller should be able to handle time-varying disturbances, wide operating conditions, actuator constraints, and variable price structures. Apparently, many control systems display several shortcomings in their application to HVAC control. For instance, the classical controllers require manual tuning and perform sluggishly or too aggressively outside of the tuning band. The hard controllers require rigorous mathematical analysis and the identification of stable equilibrium points for the controller design. Soft control requires massive amounts of data for training and reinforcement, and learning techniques require extensive time, rendering them impractical for industrial implementations. Alternatively, MPC provides a solution to many of the aforementioned problems and; therefore, constitutes the focus of this survey. 97

5.4.

Model Predictive Control

Because the focus of this chapter is MPC, a comprehensive review of MPC techniques and comparisons with other control techniques are provided in this section. Figure 5-2 shows inputs and outputs of MPC based controller. The MPC uses a system model to predict the future states of the system and generates a control vector that minimizes a certain cost function over the prediction horizon in the presence of disturbances and constraints. The first element of the computed control vector at any sampling instant is applied to the system input, and the remainder is discarded. The entire process is repeated in the next time instant. The cost function can take the form of tracking error, control effort, energy cost, demand cost, power consumption, or a combination of these factors. Constraints can be placed on the rate and range limits of the actuators and the manipulated and controlled variables (e.g., upper and lower limits of the zone temperature, supply airflow rate limits, and range and speed limits for damper positioning). External and internal disturbances acting on the system due to weather, occupant activities, and equipment use are also modeled, and their predicted effects on the system are used during control vector computation. This effort results in a controller that is robust to both time-varying disturbances and system parameters and regulates the process tightly within the given bounds. The MPC is used in both supervisory and local (execution) levels of control in HVAC systems.

Optimization Horizon r(t) yt+k
Sample Time

Reference Trajectory r(t) Predicted Outputs yt+k Measured Outputs x(t) Predicted Control Input ut+k Past Control Input u(t)

x(t) u(t) t

ut+k

t+1

t+2

...

t+N

Figure 5-2: Inputs and outputs of MPC based controller 98

At each time instant, the system output is also measured and is used as the initial condition in the optimization process. This helps in eliminating any un-modeled disturbances or modeling errors. The system and disturbance model can be written in a variety of form such as differential equations, SS representation, TF representation or discrete difference equations. The MPC algorithm works as follows: · At time t, solve an optimal control problem over a finite future horizon of N steps:
2  N -1  min   = J  yt + k - r (t ) + ut + k - ur (t )  ut ,...., ut + N -1  k =0    xt + k +1 = f ( xt + k , ut + k ), s.t.

yt + k = g ( xt + k , ut + k ), umin  ut + k  umax , ymin  yt + k  ymax , = xt x= (t ), k 0,..., N - 1,

(5.1)

where J is the cost function, N is the prediction horizon, u, y, x and r are the input, output, state and reference trajectory of the system, and x(t) is the measured state of the system at time t. · · Only apply the first optimal move At time t+1, get new measurements and repeat the optimization process.

The cost function in the above formulation takes the form of the summation of tracking error and control effort. The optimization tries to reduce the tracking error and control effort over the optimization horizon and produces the optimal control vector in the presence of the constraints on system input and output. The limits on the control input (i.e., umin and umax) and system output (i.e., ymin and ymax) are defined by the actuator constraints and required specifications of the control objective, e.g., in case of zone temperature control, the zone temperature can be specified to vary to a certain degree around the reference set-point. In the case where the optimization objective is to reduce the operating cost of the HVAC system, the objective function is re-written to represent the operating cost of the system.

99

5.4.1. Comparison of MPC with Other Control Approaches
The following comparison metrics are commonly used to compare the performances of various controllers: · · · · · · · · · · Energy and cost savings [21, 106, 107, 109, 203, 204] Peak load shifting capability [106] Transient response improvement (decrease in rise time, settling time, and peak time) [22, 37, 159, 205] Steady-state response improvement (decrease in offset error) [21, 205] Control of variables within bounds [108, 170] Reduction in fluctuations from a set-point (better regulation) [109] Efficiency and COP improvements [159] Robustness to disturbances and changes in operating conditions [22, 206] IAQ and thermal comfort improvement [109, 170, 204] Computation time reduction [206]

Most researchers use one or two of the above performance metrics to evaluate the performance of their proposed controllers against others. In fact, MPC for HVAC systems is shown to outperform most control techniques using the aforementioned performance metrics. The results obtained for MPC applications can be divided into simulation and experimental categories. To show the significance and advantages of MPC approaches, details of the developed MPC controllers are presented within simulation and experimental platforms in the following subsections. 5.4.1.1 Simulation Results

The zone temperature and damper position in a simulated VAV system were controlled using MPC in [22]. Compared with a PI controller, the MPC-based supply airflow rate controller displayed better transient response (rise time, settling time, percentage overshoot) and was more robust in the presence of air duct pressure disturbances. During the regulation of a low-flow-rate set point, the PI controller produced a sluggish response that needed additional time to reach the set point. At a high-flow-rate set point, the PI controller responded too aggressively, which resulted in excessive overshoots above 100

the set point. In contrast, the MPC-based technique produced consistent responses in both cases and achieved both faster settling time and lower overshoot. When zone temperature regulation was tested for low cooling load and high cooling load situations, the PI controller was able to regulate the process precisely at the set point; whereas, MPC regulated the process within a feasible range close to the set point. However, the control effort put forth by the PI controller was much larger than that of the MPC controller. From inspecting the control signals generated by the PI and MPC controllers, it was observed that the PI controller signal exhibited much more fluctuation under low cooling load and oscillated at a high cooling load, which resulted in the need for re-tuning. In contrast, MPC produced a much smoother control signal under both the high and low cooling load conditions. Simulations of zone temperature regulation using decentralized, centralized, and distributed MPC were presented in [109]. The zone temperature was well regulated at the set point using centralized and distributed MPC in the presence of coupling effects between adjacent zones. The PI controllers used a decentralized structure because they do not consider the coupling effects between zones. Each PI controller regulated the zone temperature individually in a multi-zone building without communicating any information to the neighboring controllers. The multi-zone decentralized MPC controllers also behaved in a fashion similar to that of the PI controller. However, the centralized and distributed MPC controllers accounted for the coupling effects of the neighboring zones by making predictions for the coupling effects and communicating the control decisions to the neighboring controllers. Compared with the PI controller, decentralized MPC was able to reduce the energy consumption by approximately 5.5%; whereas, centralized MPC and distributed MPC were able to achieve an additional 36.7% increase in thermal comfort and a 13.4% reduction in energy consumption. When used for the temperature and ventilation control of six zones in [170], the MPC-based technique was able to regulate the temperature within the limits and provided adequate ventilation levels based on the occupancy of the zones. However, the PI controllers failed to maintain zone temperatures within the desired thermal comfort range at all times and resulted in low ventilation when the occupancy was increased. To achieve a desired zone temperature, the supply water temperature for a RFH system was computed using both the numerical Simulink® model (also referred to as the exact solution) and MPC in [108]. The MPC maintained the room temperature within the desired bounds at all times using weather 101

prediction and accounting for the dead time of the building. However, the exact solution method was unable to maintain the room temperature at the set point at all times because it did not use weather forecasting. In [106], MPC was used for zone temperature control. By employing the MPC technique, the peak loads were shifted, and the on-peak power profile was flattened. Compared with the baseline night setup strategy (0%), MPC yielded higher savings (28%) than did the linear-up (17%) and step-up (24%) strategies. For the charging and discharging control of an ice storage system, MPC outperformed conventional control strategies (i.e., chiller priority control, constant proportion control, and storage priority control), as reported in [137]. Supervisory MPC was used to generate the optimal zone temperature set point profile, the thermal storage optimal charging and discharging profiles, and the pre-cooling profile in [105]. Compared with conventional chiller control techniques, which have no thermal storage and chiller priority control, the MPC generated extra energy savings of 27% and 17%, respectively. When a supervisory MPC-based optimal sequence of tank water set points was used in [107], the energy consumption of heat pump was reduced. 5.4.1.2 Experimental Results

To control the temperature of multiple zones, MIMO MPC was used to control the water flow valve (WFV) in [159]. The MPC was also applied to regulate the evaporator temperature and pressure by controlling the electronic expansion valve (EEV) and compressor speed. For comparison purposes, local level PI controllers were also implemented on the aforementioned processes. It was observed that the MPC outperformed the PI controllers, e.g., improved regulation of superheat temperature and evaporator pressure. Adding supervisory MPC to the system improved the COP of the system by 9.5% and resulted in higher efficiency. The MPC and PID control simulations for regulating the dry bulb temperature of the off-coil air from the AHU were carried out in MATLAB® in [37]. In the simulations, MPC produced less overshoot and a faster settling time compared with the PID controller. The controller was implemented on a lab-scale pilot HVAC system. The implemented controller also showed improved robustness and superior tracking performance compared with the PID controller. 102

The supply air temperature of a test room in a factory building was controlled using controllers designed using prescribed error dynamics and MPC techniques in conjunction with feedback linearization [21]. The MPC controller performed remarkably well, demonstrating good trajectory tracking. The MPC could account for process dead time and use future values of the reference signal. Therefore, the MPC controller demonstrated a minimal delay in response, less overshoot, and a shorter settling time compared with a controller designed with prescribed error dynamics. For zone temperature control in a large university building, the performance of the MPC was compared with that of a finely tuned weather compensated controller that also used weather forecasting in [204], and the heating curve method in [203]. The MPC used 29% less energy while maintaining the same thermal comfort level in both applications. Because the building had a time delay of 12 hours in its temperature response because of its large thermal capacitance, MPC heated the building in advance to track the reference trajectory more accurately. The weather-compensated controller supplied water to the radiant ceiling heating system at a much higher temperature compared with that of the MPC controller, resulting in higher energy consumption. The heating curve method heated the concrete of the building during the night and turned off the heating in the morning. The MPC also preheated the building during the night, but it did not switch off the heating during day, which resulted in a significant peak energy reduction. The zone temperature and humidity of a thermal chamber in a university lab were controlled with an MPC and a neural-fuzzy controller in [205]. Compared with the neural-fuzzy controller, the MPC demonstrated superior performance: it improved the settling time by 25% and the steady-state error for temperature and humidity by 100% and 400%, respectively. A comparison of on/off control with learning-based MPC (LBMPC) was carried out in [163] using a single heat pump AC system installed in a university lab. LBMPC reduced the energy consumption by 30-70% compared with the on/off control. The energy savings were reduced as the occupancy and temperature of outside air increased, resulting in a higher thermal load on the AC. In summary, both the simulation and experimental results suggest many advantages in the use of MPC for HVAC system control. The remaining sections shed light on the components of the MPC system and its implementation.

103

5.4.2. Factors Affecting MPC Performance
A typical MPC system is composed of a system model, constraints, a disturbance model, a cost function, an optimization method, and a control horizon, which could all affect the performance of MPC. The remainder of this chapter examines the effects of these choices on MPC performance. 5.4.2.1 Control Configuration and Type

Different MPC configurations can be considered, and such configurations can be categorized into hierarchical, cascaded, centralized, decentralized, and distributed structures. The controllers can be used in a hierarchical or cascaded design to cater to both fast-moving and slowmoving disturbances in HVAC systems. For instance, MPC was combined with conventional local loop PID controllers in a hierarchical structure in [203] and cascaded to the PI controller in [207]. MPC can also be combined with a rule-based control (RBC) in a hierarchical structure to derive control signals using a set of rules [84]. MPC-based controllers can also be used in both the upper (supervisory) and lower (execution) levels of hierarchical control [208] and in both the inner and outer loops of the cascaded configuration [22]. Decentralized, centralized and distributed MPC can be used for a multi-zone building [109]. The decentralized control uses the same local controller separately for each zone without any consideration of thermal coupling between zones. Because zone coupling is not addressed in decentralized implementation, it results in temperature swings in the zone due to heating of neighboring zones at different set points resulting in poor control performance. The centralized controller considers the inputs, outputs, occupancy and thermal coupling for all zones simultaneously. Therefore, it is able to track the set point of each zone despite different occupancy periods and zone temperature set points. However, a centralized MPC configuration results in a higher computation time and lower reliability because any problem in the central controller will disable the HVAC system of the entire building. This system is also not scalable to large buildings because implementing the controller would require higher-order MIMO models and a large amount of computing power. The solution is to design a distributed controller similar to the decentralized controller in which each controller communicates with the neighboring controllers to share the zone temperature information and the future course of action. The distributed controller performance [109] is comparable to that of the centralized controller 104

and achieves similar energy savings and temperature regulation and its computational cost is low comparable to decentralized controller. Robust MPC can be used to provide consistent control performance in the presence of disturbances and over a wide range of operating conditions [22, 209]. For instance, a VAV AHU system was controlled using robust MPC, and the results were compared with those of the conventional PI control strategy in [209]. Compared with the conventional strategy, the robust strategy yielded tighter control of the supply air temperature set point by modulating the cooling coil valve. The robust strategy also showed a faster response compared with that of the conventional strategy in the presence of disturbances. The robust strategy accounted for the uncertainty in the gain and the time delay in the temperature control process and produced a control signal with such actuator constraints as rate and range limits. In contrast, the conventional strategy did not consider uncertainties and constraints, resulting in a sluggish response if the operating conditions deviated from the tuning conditions. In the robust MPC control strategy, control laws were implemented in the form of state feedback control in which the optimum gain was determined by optimizing a cost function based on tracking error. In another work [22], a robust gain-scheduling MPC was considered with a bi-linear MPC for zone temperature control. The former MPC regulated a damper nonlinear process and managed the fast variations in supply airflow rate due to the change in damper position. The latter MPC controlled the process temperature, which could exhibit time-varying dynamics. The temperature-process MPC produced a reference for the supply airflow rate based on the error between the zone temperature and its set point. The damper-process MPC tracked this supply airflow rate and adjusted the damper position based on the error between the reference and measured supply airflow rate. 5.4.2.2 Controlled Process An HVAC system is composed of many subsystems that can be controlled independently of one another. The most important controlled variables in the HVAC system are zone temperature, humidity, and ventilation rate. The set points of temperature, pressure, and flow rate in the water and refrigerant loops are also controlled variables that are regulated by fans, pumps, compressor, boiler, and valves. Similarly, the temperature, flow rate, and pressure in the air loop are also controlled variables that are controlled by the heating and cooling water flow-rate valves, fans and dampers. The 105

damper position, valve position, compressor speed, boiler fuel consumption rate, fan speed, and pump speed are all manipulated variables. MPC was applied to zone temperature control in [22, 106-109], damper position control in [22], HVAC energy consumption control in [84], hot water supply temperature regulation in [203], optimal storage water temperature profile generation in [107], charging and discharging rate control of an ice storage system in [137], thermal storage of a large-scale cooling system [162], temperature control of multiple-zones in [109, 159, 170], evaporator pressure and cooling set point generation in [159], zone humidity control in [205], temperature control of a MIMO process in [206], and ventilation control in [170]. For instance, an MPC controller was designed for a large university building using a SS model identified by a 4SID method [204]. The MPC controlled the room temperature by regulating the heating-water flow rate into a radiant ceiling heating system. The MPC was used to control thermal storage by controlling the condenser water temperature, the chilled water temperature and the chilled water flow rate for a university campus cooling system [162]. In this work, the models of cooling system components and energy consumption were first determined and validated. Next, the MPC controller was designed to produce the set point for the condenser water supply, the chilled water supply, and the chilled water flow rate used to charge the storage tanks during the night. The designed MPC demonstrated an improved COP and a reduction in the electricity costs compared with the baseline case implemented using operator experience. This result was achieved by increasing the set point temperature and the flow rate of chilled water and by reducing the charging time. In the baseline case, operators charged the tanks with a lower temperature for extended periods of time, resulting in overcharging and greater losses that lowered the efficiency. 5.4.2.3 Building HVAC Systems MPC controllers have been applied to a variety of building HVAC systems. For example, MPC was applied for zone temperature control of a single-story office building with a VAV cooling system without heating or mechanical ventilation [106], zone temperature, and damper process control for a single-zone VAV system [22], and supply-air temperature control of a continuous air volume (CAV) system installed in a factory [21].

106

HVAC systems serve both single-zone and multi-zone buildings. In single-zone buildings, the set points of thermal comfort and IAQ variables are the same in all rooms; whereas, in multi-zone buildings, the set points of the different zones can be controlled by the users. It is easier to design a controller for a single-zone building because simplifications can be used for the geometric and thermal properties of the building and because the insulation between the zones is poor. In this case, coupling cannot be neglected and must be modeled properly for the accurate control of zone temperature, humidity, and air quality. This strategy results in more complex MIMO controllers. Several MPC strategies have been applied to both single-zone and multi-zone buildings, i.e., a single-story office building [106], a factory building [21], a small studio apartment [84], a large university building [48, 203, 204], a test room [105, 108, 109], a shed [107], and a multi-story office building [137]. 5.4.2.4 Energy Conservation Strategy Energy can be conserved by implementing different control strategies, such as thermal storage in the building mass [106] or floor heating mass [107], passive solar gains [107], thermal storage in tank water [105, 137], temperature reset during unoccupied hours [128, 138], night setbacks, pre-cooling during off-peak periods and set-point changes during peak hours [139, 140], optimum start and stop times [141], ventilation control [142, 143], and economizer cycle control [138, 144, 145]. These conservation strategies can be implemented together with MPC to maximize energy savings. The cost function of a predictive controller can be based on energy conservation such that peak loads can be shifted to offpeak hours and energy consumption during peak hours can be minimized. The peak shifting does not always result in lower energy consumptions but may result in lower operating costs in the presence of a variable rate structure. For example, in [105], an optimum amount of thermal energy storage in the tank water was used to compare the performance of MPC with that of other conventional energy storage strategies based on chiller priority and storage priority control. It was found in [105] that thermal energy storage with MPC resulted in a significant operating cost reduction. Even a simple non-predictive strategy such as chiller priority resulted in greater savings than a system without thermal storage. It was shown that passive storage in building mass results in the highest savings for buildings with a large thermal mass [210]. Obviously, passive thermal storage savings are low for buildings with less thermal mass, such as residential buildings

107

5.4.2.5 Prediction Basis and Disturbances The MPC algorithm must predict the future state of the system based on an estimate of internal and external disturbances acting on the system. Internal disturbances occur because of occupant activities, equipment use, and lighting. External disturbances primarily occur because of weather variables, e.g., outside temperature, humidity, solar irradiance, wind velocity, and cloud factor. The internal disturbances can be estimated using the known occupancy and lighting and equipment use schedules [105, 106, 170]. The external disturbances can be estimated using short-term weather forecast models, such as the bin predictor, random walk, and harmonic predictor; linear parametric models such as ARIMA; and nonlinear models such as ANN [93, 211]. The bin predictor models and ANN models can provide near-perfect forecasting. An MPC that uses a forecast generated by these models can outperform other methods that do not use weather forecasting. For example, the effects of weather forecast uncertainty on HVAC control performance in terms of energy consumption and thermal comfort violations were investigated and reported in [164]. The room temperature regulation performance of RBC was compared with those of deterministic MPC (DMPC) and stochastic MPC (SMPC). The RBC used expert knowledge in controller design and was used as a benchmark. A theoretical benchmark known as performance bound (PB) was also used to evaluate the theoretical saving potentials among RBC, DMPC, and SMPC. During the computation of PB, it was assumed that the weather forecast was 100% accurate and without any uncertainty. This assumption allows the calculation of the maximum savings potential of DMPC. The DMPC used linear constraints in the MPC formulation and assumed that the weather forecast was accurate, thus remaining at its expected value. Due to this assumption, the uncertainty in weather variables was not considered, and the DMPC did not perform well when the actual weather varied from the forecast. In constraint and cost function formulation for SMCP, the weather uncertainty was assumed to have a Gaussian distribution. This assumption was validated via analysis of the predictions of the weather forecast model and its actual measurements. The performances of RBC, PB, DMPC, and SMPC were compared based on non-renewable primary energy (NRPE) usage and the amount of comfort violation. The PB performed best because it was a theoretical concept and considered no variations in the predicted and actual weather. The RBC outperformed the DMPC in most cases; whereas, the SMPC outperformed the RBC in all simulated cases with the lowest NRPE and a minimum amount of comfort violations. The results showed that by incorporating weather uncertainty, the SMPC can serve as a superior controller that consumes less energy and produces a 108

zone temperature within the given bounds most of the time compared with an RBC approach. A good weather prediction model can further enhance the SMPC performance. The amount of comfort violations can be decreased, if desired, if using an SMPC scheme, but doing so results in higher energy usage. Researchers have also used the future value of the reference signal [21], prediction of tracking error [22], and historical value of the control signal [108] to predict future system states in MPC design. Apart from the internal and external disturbances discussed above, other disturbances such as coupling between neighboring zones [109], variable air mass flow rates and water inlet temperatures in the AHU [21], and interaction between the evaporators in multi-evaporator systems [159] also act as disturbances in a control system. Certain works used simulated disturbances, e.g., random noise [206] and heating at an unknown rate [159], in their proof of concept. 5.4.2.6 Model for System Dynamics Simulation and Controller Development The MPC controller can use either physics-based models (also known as analytical first principle or forward models) or data-driven models (also known as black-box or inverse models) to predict the system output. Physics-based models are based on the knowledge of the process, parameters that can be determined from manufacturer documentation and application of parameter estimation techniques on measured process data. Physics-based models have been developed for zones [55, 62, 212], mixing boxes [62], AHUs [53, 213], compressors [68, 159], fans [69], pumps [214], valves [88], dampers [22], and ducts [55]. Physics-based models of thermal processes are analogous to electrical RC networks. For simplicity, these models use lumped thermal capacitance and resistance in place of distributed thermal capacitance and resistance. This strategy results in simple dynamic first-order models that represent the thermal process. Data-driven models fit linear and nonlinear mathematical functions to measured data. Examples of data-driven models include ANN [26-29], FL [38, 39], SVM [31], first- and secondorder time delay models [20, 24], and statistical models [e.g., autoregressive (AR), ARX, ARMA, FIR, ARMAX, OE, and BJ models] [41]. The accuracy of data-driven models is high compared with that of physics-based models, but these models suffer from generalization capabilities.

109

Comprehensive models can be developed using HVAC simulation programs such as EnergyPlus [106, 107], TRNSYS [105], and Simulink® [108, 109] for HVAC systems and buildings under consideration. Such models produce highly accurate results that are useful for performance analysis and optimization of HVAC systems. However, these models are generally not used for controller development. The controller is generally developed on simpler physics-based and data-driven models that achieve reasonable accuracy and simplicity. Researchers have generally used comprehensive models in conjunction with simpler models; whereas, simpler models are used for controller development and comprehensive models are applied to simulate the performance of the controller. To develop good quality models, the data should have high accuracy, low noise, and appropriate temporal resolution to capture the process dynamics correctly. For fast-moving processes in HVAC systems (i.e., airflow rate and water flow rate measurements), the sampling rate should be higher compared with that of slow-moving processes (i.e., air temperature and water temperature). In HVAC system control, data sampled at one-minute intervals are appropriate for fast-moving processes, and hourly data are appropriate for slow-moving processes. Median and averaging filters can be applied for removing spike noise and quantization noise, respectively. [215]. The data should also cover a broad range of operating conditions observed by the HVAC system such as variations in weather parameters and occupancy patterns throughout the year. Due to changes in the building and HVAC parameters over time, the model prediction will deviate from the actual process output. To cope with this situation, the models can be updated online. If performance data are available for multiple years, then it is good practice to train and test models on data sets from different years. The accuracy of models can be increased by clustering the data into different seasons or similar outdoor weather conditions [28]. Multiple models can be trained on these data clusters, and an appropriate model can be selected based on input measurements. After a model has been developed, model validation is necessary to verify its accuracy. Model validation can be carried out by comparing model outputs with measurements, analytical solutions of a known problem, or with results of other modeling software [58]. Performance metrics are defined to compare prediction results of different models and their deviations from measured data. Models are compared using AE, MAXAE, MAE, MBE, MSE, APE, MAPE, StdAE, StdAPE, D, RMSE, CV, G, RME, MARE, R2 and CC [26, 28, 29, 32, 39, 40, 56, 91-93].

110

To obtain further insight into model development and its application in MPC, several examples are taken from the literature. For example, in the application of MPC to the HVAC system of a plant [21], the system included a cooling coil whose outlet air temperature must be controlled by manipulating the position of a chilled water control valve. Physics-based models were developed for the valve gear, hydraulics, cooling coil, and temperature sensor to simulate the plant dynamics. The hydraulics were modeled by measuring the valve actuation signal and the resulting water flow-rate and fitting a thirdorder polynomial on the data. A cooling coil dynamic model was obtained from a mass and energy balance of the air and water streams, resulting in first-order differential equations for the air and water temperature inside the cooling coil. A model for a temperature sensor was developed using a firstorder time delay model. The cooling coil and temperature sensor models were converted into linear discrete SS models. In another example, physics-based models were developed in the design of a MPC to simulate the control of zone temperature inside a small studio apartment [84]. The focus of this work [84] was primarily on parameter identification in models for zone temperature, HVAC energy consumption and control signals. The estimated parameters included thermal capacitance and conductance of air and structural nodes of the building. Two types of parameter estimation algorithms were presented and applied to measured data to find estimates of the capacitance and conductance of a building structure and the control input and energy consumption. A rule-based MPC controller was subsequently applied to regulate the zone temperature based on models with estimated parameters, and the effect of model mismatches on the controller performance was studied. Finally, it should be noted that due to the simplicity of linear models in control law development, certain MPC designers often attempt to linearize the obtained models using Jacobian linearization [216] and feedback linearization [21]. Linear models can also be obtained using the prediction error method [159] and system identification techniques [107]. 5.4.2.7 Prediction Horizon, Control Horizon and Time Step The prediction horizon refers to the length of time for which system output is computed by the MPC; whereas, the control horizon denotes the length of time for which the control signal is computed. The time step (or control sampling time) is the time during which the control signal remains unchanged. Typically, for slow-moving processes in HVAC systems, the prediction horizon is 5-48 hours, the control horizon range is 4-5 hours, and the time step is between 1 and 3 hours [21, 107, 203]. The 111

control horizon is generally smaller than or equal to the prediction horizon. The selected horizon depends on the controlled process and its dynamics. For instance, in many indoor applications, a time step of 1 hour is reasonable because temperature change is a slow-moving process. Using a smaller prediction horizon or a faster sampling time could result in degradation of the controller performance due to delays in the temperature process. Using a longer prediction horizon could lead to increased computation time without any further benefit [105, 217]. When applied to fast-moving dynamic processes such as compressor pressure and superheat temperature control, the prediction horizon and control horizon often shrink to a few seconds [159]. In certain applications, a time-variable horizon is also employed. For instance, in optimizing energy consumption over a 24-hour period [106], a shrinking horizon scheme is applied in which the prediction horizon reduces as the time progresses towards the end of the day. 5.4.2.8 Constraints The MPC is also known as constrained control because of its ability to find a solution that does not violate the constraints placed on the inputs, outputs, and actuators. Types of constraints include equality (e.g., capacity limits of the tank, boiler, and chiller), and inequality (e.g., actuator range and rate limit) constraints. For example, the speed at which a damper moves from a fully open to a fully closed position is finite and can be expressed as a rate limit. As another example, due to either manufacturing imperfections or restrictions on the minimum and maximum ventilation rates, the damper operating range may be limited to positions between fully open and fully closed. This type of constrained damper motion is known as the damper range limit constraint [22]. In addition to placing constraints on actuators, rate and range limit constraints can also be placed on controlled variables. For example, to maintain thermal comfort, the zone temperature may not be allowed to change by more than a specified amount per unit time, and the temperature should be maintained within a certain band. To further the understanding of the types of constraints in MPC development, selected examples from the literature are described. In temperature process control, the supply air temperature [21] and/or supply airflow rate [22] were constrained to operate in a given range. For room temperature control in [108], limits were placed on the supply heat flux and indoor temperature. The minimum heat flux was constrained to zero, but its maximum remained unconstrained. For zone temperature and humidity control in [205], constraints were placed on the supply-air fan speed to remain between 0.1 112

and 0.75 of the rated value and on the chilled water valve opening to remain between 0.1 and 1. For the generation of an optimal temperature set point profile for tank water storage in [107], the allowable values of the tank temperature set point were constrained between 30°C and 55°C. For the control of the charging rate of an ice storage system in [137], charge and discharge rate constraints and range constraints were placed on the state of charge of the storage tank. The storage tank and chiller capacities were constrained to provide four times and one time the peak cooling load, respectively. For temperature control of two separate zones in a multi-evaporator system in [159], the VCC constraints included the minimum evaporator pressures, the maximum compressor speed and capacity, and the valve maximum opening. The EEVs and WFVs were constrained to operate within 8%-14.5% and 22%-50% of their ranges, respectively. An output constraint was placed on the superheat to remain between 6°C and 12°C. In [66], constraints were also placed on the minimum and maximum of evaporator cooling, evaporator pressure, pressure differential, and max pressure slew rate. 5.4.2.9 Cost Function The cost function is based on the desired behavior of the system and serves to stabilize the system if the optimal cost can be described by a Lyapunov function [164]. For systems with slow dynamics (i.e., temperature processes), stability is not an issue, and one can choose any form of cost function. The cost function also describes the performance target, such as the minimization of energy consumption and/or operating cost and the maximization of thermal comfort in HVAC systems. Maximizing thermal comfort and minimizing energy consumption are two competing objectives, and a trade-off must be found by placing weights on these factors in the cost function. In the quadratic cost function, the weights provide a trade-off between tracking error and control effort. A linear cost function is used in minimizing such economically driven signals as operating cost, terminal cost and energy cost. The following cost functions or combinations of them are widely used in MPC-based HVAC control: · · · · · Weighted sum of tracking error and control effort [21, 22, 37, 109, 159, 170, 206]; Quadratic cost function for tracking the error and control effort [159, 203, 204]; Sum of the energy cost and demand cost [106]; Norm of the momentary temperature deviation [108]; Sum of the tracking error [107]; 113

· · · ·

Integrated power or energy consumption [106, 208]; Operating cost [105, 137]; Terminal cost [205]; and Dissatisfaction cost [208].

Most researchers have attempted to minimize the weighted sum of the tracking error and control effort, and others have only minimized the sum of tracking error or instantaneous error (operating cost will increase as a result). The latter cost function is useful if there is no incentive to save energy and the price of electricity is constant throughout the operating period. However, certain researchers have only minimized power consumption, operating cost and terminal cost and sacrificed thermal comfort. Such a cost function is useful if a significant cost savings exists at the expense of thermal comfort, i.e., in the case of a variable price structure. The dynamic cost function can also be used to place different weights on thermal comfort and energy consumption based on the energy conservation incentive during the day. The following two examples provide further details on the formulation and use of cost functions in an MPC framework. The proposed MPC for room temperature control in [163] used a two-term cost function. The first term was the squared sum of the tracking error (i.e., the difference between room temperature and desired temperature over the control horizon). The second term represented the energy conservation over the optimization period as a function of the control signal. Because the occupancy varies widely over the day, as does the weather, these factors together represent the uncertainty faced by the controller. A hierarchical MPC (H-MPC) was proposed in [208] for energy consumption reduction in a residential house. The two-level H-MPC consisted of a scheduling MPC (S-MPC) and a piloting MPC (P-MPC). The S-MPC used dissatisfaction and energy consumption cost functions that were minimized over a large horizon of 7 hours with a sampling time of 1 hour to produce a solution that was partially used by the P-MPC. The S-MPC addressed the slow-moving dynamics and the varying price profile of the electricity. The P-MPC operated on a shorter horizon with a sampling time of 5 minutes to track the state sequence generated by the S-MPC and manage the disturbances and fast-moving dynamics. Compared with a centralized MPC, the H-MPC showed superior performance in terms of dissatisfaction cost. 114

5.4.2.10 Optimization Problem After the formulation of the system model, the disturbance model, the constraints and the cost function, MPC solves a constrained optimization problem to compute the optimum control vector. Because gradient-based techniques are usually designed to work with continuous functions and may not even be able to find global minimum of the function, a variety of optimization methods have been proposed. A classification of linear and nonlinear optimization methods for HVAC control is given in [129]. Optimization techniques commonly used by HVAC researchers include linear programming (LP), e.g., simplex search method [106], QP [22], dynamic programming (DP) [107], mixed integer programming (MIP) [137], evolutionary algorithm (EA) [218], particle swarm optimization (PSO) [219], and the GA [220]. In addition to EA, PSO, and GA, other meta-heuristic optimization techniques such as simulated annealing [221], differential evolution, ACO [31], bee algorithms [222], the Tabu search [223], the Harmony search [224], firefly algorithm [225], cuckoo search [226], artificial immune systems [227], the memetic algorithm [228], the cross entropy method [229], and the bacterial foraging method [230] are less common among HVAC researchers and thus present a potential area of research. The following examples illustrate the use of optimization methods in MPC development. In [106], the minimization of energy and demand cost was formulated as a linear program solved using a variation of the Simplex method under the MATLAB® function `Linprog'. In [21], the weighted sum of the tracking error and control effort was minimized using the MATLAB® MPC Toolbox. The QP algorithm in the MPC of the temperature process was used to minimize the tracking error and control effort in [22]. To minimize the quadratic cost function (which penalizes rapid changes in heating water temperature), SciLab's internal quadratic optimization program solver was used in [203, 204]. In [108] a constrained nonlinear multivariable function was minimized using a variation of sequential QP under the MATLAB® `fmincon' function. The purpose was to minimize the deviations in the indoor temperature and the norm of the momentary temperature. Deviations above and below the comfort range were penalized. The DP algorithm was used to minimize the integrated power consumption rate of a heat pump over a period of interest in [107]. The operating cost of a cooling plant over a simulation period was minimized in [137] using DP and MIP. The Wolfe-Dantzig algorithm was applied to solve the QP problem using the QPDANTZ program included in the MATLAB® MPC Toolbox in [159]. Iterative DP (IDP) was applied to solve the convex quadratic optimization problem 115

in [205] to minimize the terminal cost. The quasi-Newton and DP algorithms were applied for passive and active storage optimization, respectively, to minimize the operating cost for time-of-usedifferentiated electricity and fixed-cost natural gas in [105]. The GA technique was used to compute the control vector for MPC in room temperature control under a variable electricity price structure [220]. Compared with a non-optimized base case, the optimized MPC was able to reduce the operating cost of the HVAC system by 30% by shifting the load to off-peak hours. Discomfort was increased during the optimized control scheme, but temperature was maintained within the upper and lower control limits. The supervisory controller developed using a model-based GA in [231] resulted in significant energy savings in the winter or mild seasons and a significant IAQ improvement in the summer season compared with those of a conventional controller. The GA was used to compute optimal set points for supply air flow rate, chiller temperature, and zone temperature. In [219], PSO-based MPC was used to control the temperature and ventilation rate of a greenhouse by forced heating and natural ventilation. Compared with a conventional controller, PSO-based MPC was able to reduce the control effort and the heating and ventilation costs, resulting in greater savings and reduced wear of the components. An improved PSO algorithm known as the differential discrete PSO (DDPSO) was proposed in [232]. The proposed DDPSO achieved a better solution in fewer iterations compared with the standard PSO when applied for building temperature control.

5.5.

Conclusions

Certain important points of MPC development for HVAC control can be summarized from Chapter 5 as follows: · Many attractive choices are available for HVAC system control in the form of conventional controllers, hard controllers, soft controllers, and hybrid controllers. These techniques were reviewed, and the advantages and disadvantages of each technique were highlighted. Compared with most of the other control techniques, MPC generally provides superior performance in terms of lower energy consumption, better transient response, robustness to disturbances, and consistent performance under varying conditions. · The accuracy of the model, weather forecasting and disturbance predictions all affect the energy consumption and performance of MPC. New information such as measured weather variables 116

(wind speed, solar flux, ambient temperature, and humidity) should be incorporated in MPC at each sampling instant to improve controller performance. · Most of the MPC formulations use discrete linear models of the system obtained by either linearizing the SS models around a certain equilibrium point or creating linear ARX models from empirical data. Certain MPC formulations use discretized versions of continuous model equations obtained from physics-based models. The system identification techniques are also used to derive simple linear models for MPC formulations from more complicated and comprehensive models developed in EnergyPlus and TRNSYS. The MPC can be interfaced with comprehensive models built in the EnergyPlus, TRNSYS, and MATLAB® Simulink® platforms to simulate control performance for a real building and actual weather conditions. · Selection of the prediction horizon and sampling time affects the accuracy, computational cost, and response time of MPC. H-MPC and cascade MPC are designed to handle both slow- and fastmoving disturbances. The slow dynamics are controlled by a supervisory-level controller, which operates using a longer time horizon of typically 24 hours and a slow sampling time of typically 1 hour. The fast-moving disturbances are controlled by a lower-level controller that operates on a shorter horizon in the range of 30-60 minutes and using a fast sampling time of typically 5-10 minutes. · Even in its most basic form (such as DMPC), MPC with linear constraints, simple disturbances, and load forecasting models outperforms the conventional control approaches that do not contain any built-in predictive algorithms. · Energy conservation strategies can be easily integrated into MPC design. Thermal storage presents opportunities for peak load shifting and reducing operating costs. The MPC with thermal energy storage outperforms controllers that do not use thermal storage. Buildings with large thermal mass (such as office buildings) could use passive thermal storage by pre-heating or pre-cooling the building during the off-peak period. Buildings with small thermal mass (such as residential buildings) can use tank water for thermal energy storage. The use of thermal storage may result in higher energy consumption but lower costs because of the variable price of electricity throughout the day. The review of HVAC control systems and specifically the factors affecting the MPC performance helped the development of the MPC controller for the TRCA-ASHB significantly in the next chapter. This helped in determining the hierarchical structure of the controller, i.e., MPC on the supervisory 117

layer and on/off controllers in the local level control layer. Also specification of several optimization parameters such as length of the horizon, sampling time and cost function development were aided by this review.

118

Chapter 6 Supervisory Model Predictive Controller Design
This chapter is based on the following journal paper manuscript: · Abdul Afram, Farrokh Janabi-Sharifi, Supervisory Model predictive control (MPC) design for residential HVAC system, manuscript prepared for IEEE Transactions on Control Systems Technology, Dec 2015 Residential HVAC systems generally employ on/off controllers to regulate the temperature of different zones in the house. These controller are in the form of thermostats placed in each zone. The operation of these controllers is very simple, i.e., they turn on the heating or cooling to regulate the zone temperature when it deviates from its set-point. Generally there is no supervisory controller in the house which can use the weather forecast and electricity time of use (TOU) price information to reduce the overall operating cost of the equipment. Lack of a supervisory controller results in higher operating costs of the HVAC system. Ontario has a variable electricity price structure. The electricity is cheapest during the evening, night and early morning, i.e., between 7 PM and 7 AM. During the day, the electricity is more expensive and its price increases 50% during the mid-peak period and 100% during the peak period compared to the off-peak period. Therefore, it makes sense to shift the load to off-peak hours in order to maximize the cost savings. In this chapter, a MPC based supervisory controller is designed to shift the heating and cooling load of the TRCA-ASHB to off-peak hours. Supervisory MPC generates the temperature set-points trajectory for on/off controllers. Temperature sensors were installed in each zone to measure the temperature of each zone. NI Compact FieldPointTM system was used to send control signals to the HVAC system and measure the zone temperature. By employing the supervisory controller with variable set-points resulted in 16% cost savings when compared to the fixed zone temperature set-points at 25°C. More significant savings of about 50% were seen when MPC based centralized controller was compared with the fixed zone temperature set-points of 24°C.

6.1.

Introduction

The original local or subsystem level controllers on the residential HVAC system of TRCA-ASHB were developed by the several original equipment manufacturers (OEMs). Though they properly control the operation of a single subsystem, they do not communicate and share information with 119

each other to optimize the operation of the whole HVAC system. There is no supervisory controller in the system and hence the set-points of the local level on/off controllers are manually set by the equipment operator. These manual set-points of on/off controllers may not be optimal which can result in higher energy consumption. Due to the lack of a supervisory controller, the equipment does not employ any energy conservation strategies and addition of supervisory controller can lead to more than 30% energy savings in an HVAC system [233]. The energy conservation strategies can be implemented as a part of supervisory controller to maximize the savings. The examples of energy conservation strategies include thermal storage in the building mass [106] or floor heating mass [107], passive solar gains [107], thermal storage in tank water [105, 137], temperature reset during unoccupied hours [128, 138], night setbacks, pre-cooling during off-peak periods and set-point changes during peak hours [139, 140], optimum start and stop times [141], ventilation control [142, 143] and economizer cycle control [138, 144, 145]. In this chapter passive thermal energy storage in the building and floor heating mass is used to offset the load to off-peak hours. The purpose of the centralized controller is to optimize the overall HVAC system operation which results in the reduced operating cost. It also allows the implementation of the supervisory MPC to shift the load to off-peak hours for maximizing the cost savings. Local level controllers regulate the temperature of BT and each zone. ERV controller controls the flow rate of the air by controlling the speed of the fan motor at two levels, i.e., low and high. In the original system, the on/off controllers were implemented using thermostats and aquastat. These controllers were replaced by the local level on/off controllers programmed in LabVIEW®. This allows the supervisory controller to dynamically change the set-points of the local level controllers. Original HVAC system did not have a supervisory controller. Centralized controller employs a supervisory controller which is based on the MPC [21-23, 45, 54, 106, 109, 130, 159, 160, 162, 164, 170, 203-205, 207, 209, 211, 212, 217, 219-221, 232]. MPC uses the system model in conjunction with the weather forecast information and variable electricity price information to determine the set-points of the local level controllers resulting in lowest operating cost. The supervisory controller algorithm runs an optimization problem in order to determine the set-points and preheats/precools the house and the BT to store energy during the low price period. Its main aim is to store sufficient energy in the building mass and BT water during the off-peak low price period so that there is no need to run the GSHP during the peak and mid-peak price periods. Storing too much energy could lead to 120

inefficient operation of the HVAC system due to increased losses to ambient and storing too little energy could result in the need to turn on the GSHP during high price period. In order to shift the load to off-peak periods the building should have the following properties: · High thermal capacitance ­ Higher thermal capacitance helps in storing the energy in the building mass and releasing it slowly during the day. High thermal capacitance can be achieved by making the building with materials which can store more thermal energy such as concrete. TRCA-ASHB has high thermal capacitance in the zones due to the concrete slabs in the floors used in installing the RFH systems · Low thermal conductance to the ambient ­ This makes the building insensitive to the ambient temperature. Low thermal conductance or high thermal resistance can be achieved by making the building envelope with higher quality insulation materials. TRCA-ASHB has high thermal resistance since it is constructed with the high quality insulation materials conforming to the latest building codes. The TRCA-ASHB is R-2000 and LEED Platinum certified. · Low Air Infiltration ­ Similar to the low thermal conductance, having low air infiltration makes the building insensitive to the changes in ambient temperature. This can be achieved by making the building envelope air tight and by sealing all the holes and cracks in the building infrastructure. TRCA-ASHB has air tight envelope and blower tests were conducted by the other researchers to ensure this. In order to make the house ventilated, the ERV is used to bring fresh air into the house without affecting the temperature of the zones. · Low internal and external loads ­ If the internal and/or external loads are large, all the energy stored in the building might be consumed by them quickly. The internal loads can be reduced by reducing the equipment use or using more energy efficient equipment and other occupant activities such as cooking during the cooling season. The external loads are considered the uncontrollable disturbance and can be estimated through the weather forecast information. The supervisory controller can use this information to determine the optimum amount of energy to be stored in the building mass. · Appropriate equipment capacity ­ This ensures that the set points can be reached in order to store energy in the building. The building HVAC systems should have sufficient cooling/heating 121

capacity above the nominal capacity of the heating and cooling load of the building. TRCA-ASHB has GSHP which is able to provide sufficient cooling and heating to the AHU and RFH systems to store energy in the building mass. · Incentive to shift the load ­ Without any economic incentive, it is not optimal to store energy in the building as it may results in higher energy consumption. The incentive could be in the form of time of use electricity charges and demand charges. In Ontario, there are no demand charges at residential level but the electricity has time of use price. The mid-peak and on-peak price is about 50% and 100% higher than the off-peak price. Storing energy in the building mass during off-peak hours to shift the load might result in higher energy consumption but results in lower equipment operating cost. · Availability of weather forecast ­ A fairly accurate weather forecast is essential to estimate the cooling and heating load during the day to shift the load to off-peak hours. In Canada, the weather forecast information is provided by the environment Canada through a web server. The weather forecast is fairly accurate and matches closely with the on-site measurements. Without the availability of such service from a public or private entity it will be difficult to estimate the loads properly and the supervisory controller's operation cannot be optimized to maximize the savings. · Standard equipment control interfaces ­ The HVAC system that has to be controlled should have standard equipment control interfaces and should be easy to hook up with a digital controller. In TRCA-ASHB the equipment was connected to the centralized controller through relays and digital/analog I/O cards of Compact FieldPointTM System. All the HVAC equipment in the TRCA-ASHB had standard equipment control interfaces. Without these interfaces, it would not be possible to control the equipment using a non-OEM controller. The rest of the chapter is structured as follow: In Section 6.2, the system description is provided highlighting the different components of the residential HVAC system. The Section 6.2 also provides a very comprehensive block diagram of the system to help understand the heat and mass transfer between different HVAC subsystems. Section 6.3 is based on the centralized controller design. This section highlights the importance of the centralized controller architecture. Section 6.4 provides necessary details of supervisory MPC such as cost function, constraints and system models. The theory presented in Section 6.4 is the foundation of the simulation and experimental research reported in this 122

chapter. The next section, i.e., Section 6.5 gives the details about the implementation of the centralized controller including the hardware selection, modifications to the HVAC system, centralized controller high level block diagram and software architecture. The results of simulations and experiments during both cooling and heating seasons are reported in Section 6.6.

6.2.

System Description

TRCA-ASHB is located in Vaughan, Ontario, Canada. There are four floors inside the house (i.e., basement, 1st floor, 2nd floor and 3rd floor) and an ILS next to the house. A detailed schematic diagram of the HVAC system installed at the TRCA-ASHB is shown in Figure 6-1. The cooling and heating is supplied by the GSHP system which maintains the temperature of the water in the BT. During the winter season, hot water is stored in the BT and during the summer season, cold water is stored in it. The operation of the GSHP can be reversed to supply hot water during the winter season and cold water during the summer season to the BT. GSHP has two pumps which simultaneously circulate the refrigerant and water in the ground loop and BT loop respectively. The BT temperature is monitored by a temperature controller which generates a compressor call (control signal) if the temperature deviates from its set-point. Upon receiving the control signal, GSHP turns the compressor and both pumps on simultaneously. In summer, heat is extracted from the BT and rejected to ground; whereas, in winter the operation is reversed, i.e., cold water is drawn from the BT and hot water is returned to it thereby extracting the heat from the ground. Once the BT water reaches its set-point, the GSHP is turned off. The BT helps to reduce the GSHP cycling. In-law suite has its own AHU called ILAHU which supplies both cooling and heating to the suite. ILAHU receives the hot or cold water from the BT to maintain the temperature of the ILS. Heating inside the house is supplied by a multi-zone RFH system. The heating controller monitors the temperature of each zone and generates the control signals to maintain it at its set-point. There is only one pump and four solenoid valves to control the flow rate of the water in each zone. In order to supply heating to a zone, the controller turns the pump and the corresponding solenoid valve on. The hot water starts flowing in the RFH circuit of that zone and space temperature starts rising. The pump and solenoid valve is turned off when the temperature reaches at its set-point.

123

Zone Temperature Feedback Zone Temperature Controller uRFH uILAHU uILAHU Pump mILAHU,pump WILAHU,pump mw,ILAHU TBT Control Signals uILAHU Fan mILAHU,fan WILAHU,fan ILAHU Supply Air Tsa,4 msa,4 Tra,4 mra,4 Return Air Tsa,3 msa,3 TBT msw,3 Tsa,2 msa,2 TBT msw,2 Tsa,1 msa,1 S TBT msw,1 Tz,4 Qgain,4 In-Law Suite (Zone 4) T Tz,4

Trw,ILAHU mw,ILAHU

Solenoid Valves uRFH,3 S msw,3 uRFH,2 msw,2 uRFH,1 msw,1 uRFH,0

Tz,3 Qgain,3 3rd

3rd Floor (Zone 3)

T

Tra3 mra3 Tz3 Trw3 mrw,3 Tra2 mra2 Tz2 Trw2 mrw,2 Tra1 mra1 Tz1 Trw1 mrw,1

Floor RFH Circuit Tf,3 Tz,2 2nd Floor (Zone 2)

S

Qgain,2

T

2nd Floor RFH Circuit Tf,2 Tz,1 Qgain,1 1st 1st Floor (Zone 1)

T Tf,1

Floor RFH Circuit Tz,0

Supply Water TBT

Return Water Trw,ILAHU uRFH Pump

S TBT msw,0 Supply Air Tsa msa Fan Tra mra

TBT mw,RFH msw,0 Supply mRFH,pump Water WRFH,pump Trw,RFH Return Water mw,RFH Zone Temperature Controller uAHU TBT Supply Water TBT uAHU Pump TBT mw,AHU

Basement Qgain,0 (Zone 0)

Trw0 Basement RFH Circuit Tf,0 mrw,0

T

Tz0

Zone Temperature Feedback Return Air ERV
Return Fan

BT

mAHU,pump Trw,AHU WAHU,pump mw,AHU T TBT Supply Water TBT

Return Water
BT Temperature Controller u GSHP

mAHU,fan WAHU,fan AHU

Exhaust Teai Air In mea Tfa mfa Fresh Air

WERV,return fan mERV,return fan

Teao

Exhaust mea Air Out To mfa Outside Air In

Supply Fan

WERV,supply fan mERV,supply fan uERV

Compressor Pump

uGSHP Pump TBT mw,GSHP

Ventilation Controller Ground Loop

Trw,GSHP mGSHP,BT pump WGSHP,BT pump mw,GSHP

Return Water

WGSHP,compressor GSHP

WGSHP,ground loop pump

Figure 6-1: Schematic diagram of the HVAC system at TRCA-ASHB 124

Cooling inside the house is supplied by a multi-zone AHU which supplies cold air to the 1st, 2nd, and 3rd floor. The basement temperature is not controlled during the summer season. Cooling controller monitors the space temperature in each zone and generates the control signal. Upon receiving the control signal, AHU turns the fan and pump on and opens up the supply air damper for the corresponding zone. The heat is transferred between the hot return air coming from the zone to the cold water coming from the BT and the air becomes cold. The cold supply air enters the zone and lowers its temperature. AHU keeps supplying the cold air to the zone until its temperature reaches the set-point. The house also has a ventilation controller connected to an ERV system which is in fact a heat exchanger. The fresh air is brought into the house and exhaust air is extracted from the house through the ERV which transfers the heat between the two air streams. During the winter, outside fresh air is at a much lower temperature and outgoing exhaust air is at a much higher temperature. When the two streams pass through the ERV, the outgoing exhaust air transfers most of its energy to the incoming fresh air thus pre-heating the fresh air. The opposite happens in the summer season and incoming hot air is pre-cooled by the outgoing cold exhaust air from the house. After passing through the ERV, the fresh air enters the AHU from where it is distributed to all the zones in the house. The AHU and ERV are interlocked which means that whenever the ERV is turned on by the ventilation controller, the AHU turns on automatically. Further information on the HVAC system of TRCA-ASHB is available in the work of previous researchers [39, 40].

6.3.

Centralized Controller Design

6.3.1. Centralized Controller Architecture
The heating and cooling controller architecture is shown in Figure 6-2 and Figure 6-3 respectively. The architecture of the supervisory MPC is shown in Figure 6-4. The heating controller uses one supervisory MPC and six local level on/off controllers; whereas, the cooling controller has one supervisory MPC and five local level on/off controllers due to the fact that the basement is not being cooled down. Supervisory MPC uses the weather forecast information, measured temperature and electricity TOU price to calculate the temperature set-point trajectory which reduces the total operating cost. Inside the MPC weather forecast along with the total calculated cost and estimated temperature is fed to the 125

optimization with a cost function to minimize the cost over the horizon. The constraints on the temperature and flow rates of water and air are also defined. During the optimization process, temperature set-point is generated and sent to the local controller models which in turn each controller sends a control signal to the HVAC subsystem model and change the flow rate of water and air inside the subsystems to regulate the zone and BT temperature at their set-points. The estimated temperature and flow rates are fed-back to the optimization to ensure that the temperature and flow rates remain within their specified constraints. The cost is calculated by integrating the product of the control signals, electricity TOU price and power consumption of the subsystem. The optimization keeps iterating until it finds a temperature set-points trajectory which minimizes the total cost over the horizon. The horizon size and execution frequency of the optimization can be adjusted. The appropriate size of optimization horizon and execution frequency was found by simulating different horizon sizes (between 24-168 hours) and execution intervals (between 0.5-3 hours) and comparing their results. It was found that the moving horizon size of 24-48 hours and execution frequency of 1 hour was optimal for the temperature control of the house since temperature changes slowly. The optimization converges within a couple of minutes with the selected horizon size and execution frequency. By increasing the size of horizon beyond 48 hours and decreasing the execution frequency below 1 hour does not have any significant effect on the accuracy of the optimization but increases the convergence time significantly. Every hour, the optimization executes and produces the optimum set-points trajectory vector for each zone and BT temperature. The first element of the vector is sent to the local controllers and the rest is discarded. Local controllers regulate the temperature of each zone and BT at their set-points. At the next hour, the temperature measurements are made and the optimization is executed again resulting in a new optimum set-points trajectory vectors based on the current system state (measured temperature), weather forecast and electricity TOU price. Again the first element of the optimum set-points trajectory vectors is sent to the local controllers and the cycle keeps repeating forever. The structure of supervisory MPC during both heating and cooling seasons is very similar. The difference comes in the form of the system model used during the heating and cooling season, cost calculations and definition of constraints. Since the RFH is used in winter and AHU is used in summer; therefore, the MPC uses the RFH system model for heating season and AHU system model for the cooling season to find the optimized set-points trajectory. During the cooling season, MPC generates set-points so that the house is pre-cooled; whereas, in the winter season, the set-points are generated 126

so that the house is pre-heated during the off-peak period resulting in the lowest cost of operating the equipment. Another difference comes in the cost calculation since different systems are used for heating and cooling, they consume different amount of power to run. The zone and BT temperature constraints are also different between the two seasons. These constraints are defined in the next section.
Basement Temperature Set-point + Basement Dead-band Error on/off Controller Control Signal Hot Pump and Water Solenoid Valve Basement RFH System Basement Temperature

1st Floor Temperature Set-point + Weather Forecast -

1st Floor Dead-band Error on/off Controller Control Signal Hot Pump and Water Solenoid Valve 1st Floor RFH System 1st Floor Temperature

2nd Floor Temperature Set-point + MPC -

2nd Floor Dead-band Error on/off Controller Control Signal Hot Pump and Water Solenoid Valve 2nd Floor RFH System 2nd Floor Temperature

3rd Floor Temperatur e Set-point + -

3rd Floor Dead-band Error on/off Controller Control Signal Hot Pump and Water Solenoid Valve 3rd Floor RFH System 3rd Floor Temperature

Electricity TOU Price In-Law Suite Temperature Set-point

In-Law Suite Dead-band Error + on/off Controller Control Signal Pump and ILAHU Fan Hot Air In-Law Suite In-Law Suite Temperature

BT Temperature Set-point + -

BT Dead-band Error on/off Controller Control Signal GSHP Compressor and Pumps Hot Water HVAC Subsystems BT Temperature

Buffer Tank

Supervisory Controller

Local Level Controllers

Zones and BT

Figure 6-2: Heating controller architecture

127

1st Floor Temperature Set-point + -

1st Floor Dead-band Error Control Signal on/off Controller Pump and AHU Fan Cold Air 1st Floor Temperature

1st Floor

Weather Forecast

2nd Floor Temperature Set-point + 3rd Floor Temperature Set-point MPC + -

2nd Floor Dead-band Error on/off Controller Control Signal Pump and AHU Fan Cold Air 2nd Floor Temperature

2nd Floor

3rd Floor Dead-band Control Signal Error on/off Controller In-Law Suite Dead-band Control Signal Error on/off Controller BT Dead-band Control Signal Error on/off Controller

Pump and AHU Fan

Cold Air

3rd Floor

3rd Floor Temperature

Electricity TOU Price

In-Law Suite Temperature Set-point + BT Temperature Set-point + -

Pump and ILAHU Fan

Cold Air

In-Law Suite

In-Law Suite Temperature

GSHP Compressor and Pumps Cold Water HVAC Subsystems

Buffer Tank

BT Temperature

Supervisory Controller

Local Level Controllers

Zones and BT

Figure 6-3: Cooling controller architecture

Electricity TOU Price Power Consumption Weather Forecast Measured Temperature Horizon Size Execution Frequency

Total Cost Optimization Temperature Set-point (Minimize + Cost over the Horizon) Error

Calculate Cost

Local HVAC Controllers Subsystems Flow Control Models Models Rate Signal Estimated Temperature

Zones and BT Models Optimum Set-points Trajectory for Each Zone and BT

Figure 6-4: Supervisory MPC architecture

128

6.4.

Supervisory MPC Design

6.4.1. Cost Function
Cost function represents the total cost of operating the HVAC system. It comprises of five terms which are the cost of operating the AHU, ILAHU, RFH, GSHP and ERV. During the winter season, the control signal corresponding to the AHU is zero and; therefore, the corresponding term becomes zero; whereas, during the heating season, the control signal for the RFH is zero and the corresponding term becomes zero. The ILAHU, GSHP and ERV work during all seasons. Cost function is given as follows:

 . J =  ( u AHUWAHU + uILAHUWILAHU + uRFHWRFH + uGSHPWGSHP + uERV WERV ) ETOU dt
1

N

(6.1)

This cost function is positive definite and therefore guaranteeing the existence of the solution. The AHU serves the supply air to three zones and RFH system serves the hot water to four zones in the house so their control signals can be written as follows:

u AHU =  i =1 u AHU ,i ,
3

(6.2)

where i = 1, 2, 3.

uRFH =  j =0 uRFH , j ,
3

(6.3)

where j = 0,1, 2, 3. The power consumption of each subsystem was measured from the house. The power of the AHU, ILAHU and GSHP is divided into pump, fan and compressor power components as follows:

= WAHU WAHU , pump + WAHU , fan , = WILAHU WILAHU , pump + WILAHU , fan , WRFH = WRFH , pump ,
129

(6.4) (6.5) (6.6)

WGSHP = WGSHP ,compressor + WGSHP , BT  pump + WGSHP , ground    loop pump , = WERV WERV , supply   fan + WERV , return   fan .

(6.7) (6.8)

The Ontario electricity time of use price (ETOU) is used. The price structure is given in Table 6-1.

6.4.2. Constraints
The constraints were placed on the zone and BT temperature set-points, and the control signals. For the cooling controller the zone set-point constraints are given as follows:

Tz ,i , sp ,cooling  [22, 25],
where i = 1, 2,3, 4 .

(6.9)

TBT , sp ,cooling  [5, 6].
For the heating controller the zone temperature set-points constraints are given as follows:

(6.10)

Tz , j , sp ,heating  [20, 22],
where = j 0,1   , ..., 4 .

(6.11)

TBT , sp ,heating  [45,50] .

(6.12)

The control signals were constrained to vary between 0 and 1 to mimic the on/off controllers as follows:

u AHU  [0,1], uRFH  [0,1],

(6.13) (6.14) (6.15) (6.16)

uILAHU  [0,1], uGSHP  [0,1].
130

The ERV runs all the time at low speed. Its control signal was fixed at 1, i.e.,

uERV = 1.

(6.17)

The black-box models have higher accuracy compared to the grey-box models but they lack the generalization capabilities of grey-box models when the test data deviates from the training data. The difference in the performance of the grey-box and black-box models was comparatively small. Therefore, grey-box models were chosen to simulate the HVAC system and design the MPC based supervisory controller.

6.4.3. Zone Model
Zone models are developed by writing the heat balance equation for each zone. During the summer season the heat stored in the zone is equal to the heat gained from the ambient, heat extracted by the AHU and direct heat gained from internal and external sources (e.g., equipment use, occupant activities and solar gains). During the winter season, heat stored in the zone is equal to heat lost to the ambient, heat gained through the RFH system and direct heat gains from internal/external sources. The zone models for both cooling and heating seasons are given as follows:
dTz , j 1  = , (UA) j (To - Tz , j ) - msa , j C pa , j (Tz , j - Tsa , j ) + (UA) f , j (Trw, j - Tz , j ) + Qgain, j   dt Cz , j 

(6.18)

where j = 0, 1, 2, 3 Since the basement does not receive the cooling and ILS does not have the RFH system; therefore,

msa ,0 = 0,

(6.19) (6.20)

(UA) f ,4 = 0.
6.4.4. AHU Model

AHU is a heat exchanger which takes the heat from the air and transfers it to the water. AHU model is developed by writing the energy balance equations on the water and air side. The air from the zones and fresh air from ERV is mixed to make the return air entering the AHU 131

Return air temperature and flow rate is given as follows:

Tra

 =

3

k =1 ra , k ra , k

m T mra

,

(6.21)

mra = mra ,k .
k =1

3

(6.22)

The return air is mixed with the fresh air before passing through the cooling coil inside the AHU. The temperature and flow rate of the mixed air is given as:

Tma =

mraTra + m faT fa mma

,

(6.23)

m= mra + m fa . ma
The supply air temperature and flow rate is given as follows:

(6.24)

dTsa 1  = (UA)cc, AHU (Trw, AHU - Tsa ) - msaC pa , AHU (Tsa - Tma ) , dt C pa , AHU 

(6.25)

msa = msa ,k .
k =1

3

(6.26)

The temperature of the supply air each zone 1 to 3 is equal so

T = T= T= Tsa . sa ,1 sa ,2 sa ,3
The flow rate of the supply and mixed air is also equal; therefore,

(6.27)

msa = mma .
The temperature of the water at the outlet of the AHU is given as:

(6.28)

132

dTrw, AHU 1  mw, AHU C pw, AHU (TBT - Trw, AHU ) - (UA ) = - Tsa )  T cc , AHU ( rw , AHU . dt Cwm , AHU 

(6.29)

The flow rate of water and air in the AHU is equal to the product of the control signal and flow rate of the AHU pump and fan respectively.

mw, AHU = mAHU , pump u AHU , msa = mAHU , fanu AHU .

(6.30) (6.31)

The flow rates of the AHU pump and fan are measured from the house. Since the AHU supplies air to the three floors, the total flow rate of the AHU fan is equal to the flow rate of the supply air to each zone. The fan speed changes based on the number of zones being served. The flow rate of the AHU fan is given as:

mAHU , fan = mAHU ,1, fan + mAHU ,2, fan + mAHU ,3, fan .
6.4.5. ILAHU Model
The supply air temperature of the ILAHU is given as follows:

(6.32)

dTsa ,4 1 (UA ) = T - Tsa ,4 ) - msa ,4C pa , ILAHU (Tsa ,4 - Tra ,4 )  ch , ILAHU ( rw , ILAHU . dt C pa , ILAHU 
The temperature of the water at the outlet of the ILAHU is given as:
dTrw, ILAHU 1 [mw, ILAHU C pw, ILAHU (TBT - Trw, ILAHU ) = dt C pw, ILAHU

(6.33)

- (UA )ch , ILAHU (Trw, ILAHU - Tsa ,4 )].

(6.34)

The flow rate of water and air in the ILAHU is equal to the product of the control signal and flow rate of the ILAHU pump and fan respectively.

mw, ILAHU = mILAHU , pump uILAHU ,
133

(6.35)

msa ,4 = mILAHU , fanuILAHU .
The flow rate of the supply and return air is equal to each other; therefore,

(6.36)

ma , ILAHU = m = mra ,4 . sa ,4
The flow rates of the ILAHU pump and fan are measured from the house.

(6.37)

6.4.6. RFH Model
The return water temperature from the RFH system of each zone is given as follows:

dTrw,n 1  = msw,nC pw,n (TBT - Trw,n ) - (UA ) f ,n (T f ,n - Tz ,n )  ,  dt Cwf ,n 
where i = 0, 1, 2, 3.

(6.38)

It is assumed that the temperature of the floor is equal to the return water temperature; therefore,

T f ,n = Trw,n .
The flow rate of the supply and return water is also equal so

(6.39)

msw,n = mrw,n .

(6.40)

The flow rate of the water is given as the product of the flow rate of the RFH pump and control signal.

msw,n = mRFH , pump uRFH ,n .

(6.41)

The flow rate of the RFH pump was measured form the house. The return water from all the zones is combined and a single stream is returned to the BT whose temperature and flow rate is calculated as follows:

134

Trw, RFH

 =

3

n =0

mrw,nTrw,n

mw, RFH
3

,

(6.42)

mw, RFH = mrw,n .
n =0

(6.43)

6.4.7. GSHP Model
The return water temperature of the GSHP is given as:

= Trw,GSHP mw,GSHP C pw,GSHPTBT + cGSHP .
The flow rate of the water in the GSHP-BT loop is given as:

(6.44)

mw,GSHP = mGSHP , BT   pump uGSHP .
6.4.8. BT Model
The temperature of the BT water is given as:

(6.45)

dTBT 1 [mw,GSHP C pw, BT (Trw,GSHP - TBT ) - mw, ILAHU C pw, BT (TBT - Trw, ILAHU ) = dt CBT

- mw, AHU C pw, BT (TBT - Trw, AHU ) - mw, RFH C pw, BT (TBT - Trw, RFH )].

(6.46)

6.4.9. ERV Model

 Teai + Teao To + T fa   dTeao 1  = -  mea C pa , ERV (Teai - Teao ) - (UA )cc , ERV   , dt Cam, ERV  2 2    dT fa  Teai + Teao To + T fa  1  = - (UA )cc , ERV   - m fa C pa , ERV (T fa - To )  . dt Cam, ERV  2 2   

(6.47)

(6.48)

The temperature of the exhaust air at the inlet is equal to the average temperature of the 1st, 2nd and 3rd floor 135

Teai

 =

3

k =1 z , k

T

3

.

(6.49)

The flow rates of the exhaust and fresh air fans were measured from the house. The flow rate of supply and return air based on the control signal can be written as:

mea = mERV ,return   fan u ERV , m fa = mERV , supply   fan u ERV .
6.4.10. Local Level Controller Models

(6.50) (6.51)

Local level controllers were modeled using the PID controllers. It is because the on/off controllers are non-linear controllers and their output signal is discontinuous; therefore, they cannot be simulated by the linear optimization solvers. PID controller is a linear controller and generates a continuous control signal. It was assumed that the PID controller performs similar to an on/off controller in terms of energy consumption of the HVAC system when its output is constrained between 0 and 1. In order to validate this assumption, the operation of the HVAC system was simulated using PID and on/off controllers in MATLAB® Simulink® over a period of 25 days and the total energy consumed by the HVAC system was compared. It was found that both types of controllers performed similarly since the power consumption under both controllers over a simulated period of 25 days was within 2% of each other. TRCA-ASHB Cooling Controller:

= ec , j Tz , j , sp ,cooling - Tz , j ,
where j = 1, 2, 3,

(6.52)

u AHU , j = K p ,c , j ec , j + K i ,c , j ec , j dt + K d ,c , j
ILAHU Cooling Controller:

dec , j dt

.

(6.53)

136

ec ,4 Tz ,4, sp ,cooling - Tz ,4 , =
u ILAHU = K p ,c ,4 ec ,4 + K i ,c ,4 ec ,4 dt + K d ,c ,4 dec ,4 dt .

(6.54) (6.55)

TRCA-ASHB Heating Controller:

= eh ,n Tz ,n , sp ,heating - Tz ,n ,
u RFH , n = K p , h , n eh , n + K i , h , n eh , n dt + K d , h , n deh , n dt ,

(6.56) (6.57)

where n = 0, 1   ,  2,  3. ILAHU Heating Controller:

= eh ,4 Tz ,4, sp ,heating - Tz ,4 ,
u ILAHU = K p , h ,4 eh ,4 + K i , h ,4 eh ,4 dt + K d , h ,4 deh ,4 dt .

(6.58) (6.59)

BT Cooling Controller:

= eBT ,c TBT , sp ,cooling - TBT ,
uGSHP = K p , BT ,c eBT ,c + K i , BT ,c eBT ,c dt + K d , BT ,c deBT ,c dt .

(6.60) (6.61)

BT Heating Controller:

= eBT ,h TBT , sp ,cooling - TBT ,
uGSHP = K p , BT , h eBT , h + K i , BT , h eBT , h dt + K d , BT , h deBT , h dt .

(6.62) (6.63)

137

6.5.

Implementation of the Centralized Controller

6.5.1. Selection of Hardware for Centralized Controller Implementation
The implementation of the centralized controller requires the selection of controller module, sensor modules and data input-output (I/O) modules. Controller module runs the supervisory and local controller software, sensors measure the temperature of the zones and BT. Input modules are used to interface the sensors to the controller and output modules are used to send the controller outputs to the HVAC system. There were two possible solutions for the hardware selection for controller development. First solution was to utilize the same controller and data input-output modules which were already being used in the TRCA-ASHB. These comprise of the NI CFP real time controller cFP-2220, analog input module cFP-AI-111, RTD input module cFP-RTD-122, and digital output module cFP-DO-410. These can be assembled on the 8-slot backplane cFP-BP-4 and can be powered using a 24 VDC power supply. Dwyer RHT-W temperature and humidity sensors can be used to measure the air temperature and humidity which can be connected to the analog input module using the connector block cFP-CB1. PT100 temperature sensor can be used to measure the BT water temperature and can be connected to the RTD input module cFP-RTD-122. The computer can connect with the CFP controller module through network in order to run the supervisory and local level controllers in MATLAB® and LabVIEW® respectively. These programs can also run directly on the CFP controller module for a stand-alone operation. (Note: For new designs NI recommends using the reconfigurable I/O CompactRIO system) The second solution involves using PC based DAQ and control card which can be interfaced with the MATLAB® and LabVIEW®. Such a card can be installed in the PCI-Express slot of the PC and provides several digital and analog I/Os which can be used to read the temperature and control the equipment. The first solution results in a very robust and expandable system which will result in a much more stable controller design at the expense of high equipment cost. The second solution results in a more limited and comparatively less reliable system at a reduced cost. The first solution was chosen to make the system more robust and keep the compatibility with the existing DAQ system in TRCA-ASHB. 138

A complete list of hardware components used for the implementation of CFP based controller are given in Appendix IV.

6.5.2. Modifications to the HVAC System
In order to implement the centralized controller, the operation of the following components was replaced: i. ii. iii. iv. v. ERV built-in ventilation controller BT and GSHP aquastat RFH thermostats x 4 AHU thermostats x 3 ILAHU thermostat x 1

Originally the HVAC system used two thermostats in each zone, i.e., one for cooling and one for heating so there were a total of 7 thermostats (3 for cooling and 4 for heating) inside the house and 1 thermostat in the ILS. This is due to the incompatibility of the heating and cooling systems with each other which cannot be controlled by the single thermostat in each zone. Centralized controller uses only the temperature measurements from each zone using temperature sensors so all 8 thermostats were replaced by 5 temperature sensors for 5 zones. The local level on/off controllers were implemented centrally in the LabVIEW®. The centralized controller generates and regulates the setpoints of each zone and BT. It replaces the existing OEM controllers completely and controls the operation of each subsystem using the standard HVAC control interfaces. For example, in order to control the GSHP, the centralized controller issues the commands `Y1' for compressor call and `O' for reversing valve. The operation of the source and load pumps (also known as ground loop pump and BT loop pump respectively) is automatically handled by the GSHP unit after receiving the compressor call. Though the centralized controller works independently of the OEM controllers, the OEM controllers were not removed. During the hardware implementation of the centralized controller, the interfaces to the subsystems were designed such that the OEM controllers can be disabled. This resulted in two different control systems either of which can be enabled or disabled. For example, the zone thermostats were disabled by adjusting their set-points very high during the cooling season and very low during the heating season so that they would not issue a call for cooling or heating to the AHU 139

or RFH system respectively. The BT temperature was originally controlled by an aquastat which issues the compressor call to the GSHP when the water temperature deviates from the set-point. The reversing valve of the GSHP which controls the heating or cooling mode used to be manually controlled by flicking a SPST switch. The aquastat and manual reversing valve call was bypassed by installing a DPDT switch labeled with "local/aquastat" and "remote/centralized". Once this switch is placed in the remote/centralized position, the centralized controller can issue the compressor call and reversing valve call to control the GSHP and the signals coming from the aquastat and manual SPST switch are ignored. A relay was used to bypass the OEM ventilation controller for ERV and centralized controller was able to control the speed of the ERV fan. The centralized controller can be disabled by stopping the LabVIEW® program which implements all the local level controllers and using the NI MAX to force all the digital outputs to zero.

6.5.3. Centralized Controller High Level Schematic
The high level controller schematic is shown in Figure 6-5. The detailed wiring diagrams of the HVAC interface to the centralized controller are given in Appendix III. The controller inputs/outputs nomenclature is given in Appendix IV. The computer runs the MATLAB® and LabVIEW® software and communicates with the cFP-2220 controller over the Ethernet or Wi-Fi connection. The computer is also connected to the internet in order to download the weather forecast information. A total of 14 digital outputs are used to control the ERV, GSHP, RFH, AHU and ILAHU. Since the NI CFP system outputs a 24 VDC signal; whereas, the HVAC interfaces operate at 24 VAC; therefore, each digital output signal is converted to 24 VAC signal using a relay for each digital output. When activated, the digital 24 VDC signal energizes the coil of the relay. The `common' terminal of the relay is connected to the 24 VAC and `normally open' terminal is connected to the corresponding equipment control interface. Therefore, whenever the digital output is activated, the corresponding control interface receives the 24 VAC signal. Upon receiving the 24 VAC signal, the equipment performs its function e.g., digital output DO4 is connected to the `GSHP Compressor Call' through relay R4; therefore, whenever DO4 is energized, the GSHP compressor turns on.

140

NI® Compact FieldPoint System CH0 Digital Output CH1 Module CH2 CH3 cFP-DO-410 CH4 CH5 B-CFP8-M5 CH6 CH7 CH0 Digital Output CH1 Module CH2 CH3 cFP-DO-410 CH4 CH5 B-CFP8-M6 CH6 CH7 CH0 Analog Input CH1 Module CH2 CH3 cFP-AI-111 CH4 CH5 B-CFP3-M1 CH6 CH7 B-CFP3-M7 CH8 CH9 RTD Input CH0 Module cFP-RTD-122 B-CFP1-M7 Controller Module cFP-2220

DO1 DO2 DO3 DO4 DO5 DO6 DO7 DO8 DO9 DO10 DO11 DO12 DO13 DO14

Relays R1 R2 R3 R4 R5 R6 R7 R8 R9 R10 R11 R12 R13 R14

Remote/Local Control Fan Speed Control GSHP Reversing Valve GSHP Compressor Call Basement Heating Call 1st Floor Heating Call 2nd Floor Heating Call 3rd Floor Heating Call AHU 1st Floor Cooling Call AHU 2nd Floor Cooling Call AHU 3rd Floor Cooling Call AHU Continuous Fan Call AHU Pump Deinterlock ILAHU Control

HVAC Subsystems ERV GSHP RFH

AHU ILAHU

3rd Floor Temperature 3rd Floor Humidity nd 2 Floor Temperature 2nd Floor Humidity st 1 Floor Temperature 1st Floor Humidity Basement Temperature Basement Humidity In-Law Suite Temperature In-Law Suite Floor Humidity BT Temperature

Archetype House
Dwyer RHT-W Dwyer RHT-W Dwyer RHT-W Dwyer RHT-W Dwyer RHT-W PT-100

3rd Floor 2nd Floor 1st Floor Basement In-Law Suite BT Supervisory and Local Controllers

Internet Connected Wifi Router and Network Switch

MATLAB® and LabVIEW®

Figure 6-5: High level schematic of centralized HVAC controller implementation There are a total of 11 analog inputs to measure the temperature and humidity of all the zones and BT. The zone humidity and temperature are measured using the wall mounted Dwyer RHT-W combined humidity/temperature transmitter modules. These modules employ a capacitance polymer based RH sensor and solid state band gap based temperature sensor and require no calibration. They 141

produce dual analog current signals in the 4-20 mA range corresponding to -40°C to +60°C temperature range and 0 to 100% relative humidity (RH) range. The accuracy of the sensors is ±0.3°C and ±2%RH which is sufficient for zone temperature control purpose. The temperature of the BT is measured using the PT-100 temperature sensor. The sensor was installed inside a temperature well created in the BT and is directly in contact with the water. The output of the sensor was connected to the cFP-RTD-122 module.

6.5.4. Centralized Controller Software Architecture
The software architecture of the centralized controller is shown in Figure 6-6. The supervisory controller is implemented in the MATLAB®; whereas, the local level controllers are implemented in the LabVIEW®. The major components of the software can be divided into five modules called weather forecast download, supervisory controller implementation, local controller implementation, interface between supervisory and local controllers and performance analysis. Following subsections briefly explain the implementation details of each module.
Meteorological Service of Canada (MSC) HTTP Data Server http://dd.weatheroffice.ec.gc.ca/

Weather Forecast

Performance Analysis Plot Results t, Tsp,Tz, TBT, u

Local Controllers Tz, Tsp TBT Zone 0 Temperature on/ off Controller Zone 1 Temperature on/ off Controller Zone 2 Temperature on/ off Controller Zone 3 Temperature on/ off Controller Zone 4 Temperature on/ off Controller

Weather Forecast File (csv) t, To Download Weather Forecast from Server and Extract t and To t, To Write Weather Forecast to CSV File t, To Supervisory Controller Electricity TOU Price t ETOU ICs t, Tfb

Write Set-points, Control Signals and Temperature Measurements to CSV File

Combine Data and Update Model Data CSV File t, To, ETOU Calibrated APMoniter Model

Interface between Supervisory and Local Controllers Write Feedback Temperature Measurements to CSV File t, Tfb Read Setpoints for Local Controllers and Control the Temperature t, Tsp

Legend MATLAB APMonitor LabVIEW CSV File

Run Optimization and Generate Temperature Setpoints

t, Tsp

Write Optimized Setpoints to CSV File

BT Temperature on/off Controller

Figure 6-6: Centralized HVAC controller software architecture 142

6.5.4.1

Weather Forecast

Weather forecast is downloaded from the Meteorological Service of Canada (MSC) HTTP data server [234] on a regular basis automatically. The data is updated on the server once a day. Therefore, every day the data is automatically downloaded at 12:00 AM in the comma separated values (CSV) format and stored on the hard drive in CSV format. The data contains the time and outside air temperature for the next 5 days. Plot of the weather forecast and the measured temperature of the outside air data is shown in Figure 6-7. It can be seen that generally the weather forecast is quite accurate and can be successfully used for the MPC controller implementation. Another thing to notice is the variation of the outside air temperature during the test period. At the start of the test period, the weather was warm followed by the colder days which were again followed by very warm days. This pattern is typical of the Toronto summer weather where temperature can vary over a wide range during the day and the night. In the test period, the temperature can be seen to vary between 9°C and 36°C.

35
To Forecast To Meas

30

Temperature (°C)

25

20

15

10 Aug 21 Aug 25 Aug 29 Sep 02 Sep 06 Sep 10

Time

Figure 6-7: Weather forecast data downloaded from the server [234] 6.5.4.2 Supervisory Controller Supervisory controller reads the weather forecast data downloaded from the server and gets the electricity TOU price for the time vector in the data. The electricity TOU price in Ontario is given in Table 6-1 [235]. On the weekdays, the electricity is cheap during the night and expensive during the 143

day; whereas, on the weekends and holidays, the electricity is cheap all day long. The electricity TOU price on weekdays is plotted in the Figure 6-8. Every hour the updated weather forecast data and electricity TOU price is written to the Advanced Process Monitor (APMonitor) model file along with the measured temperature of each zone and BT. Once the model file is updated with the current information, the optimization process is started to generate the optimum set-points trajectory. APMonitor is a modeling language for differential algebraic equations and it does not solve the optimization directly but calls the nonlinear programming solvers such as Advanced Process OPTimizer (APOPT). In our case where the cost function and constraints are linear, the LP is used by the solver to find the solution. After the optimization converges, the first value in each set-point trajectory vector is written to a CSV file. These CSV files are then read by the LabVIEW® program and are given as input to the local level controllers as the new set-points. For the next one hour the set-points remain fixed at this value and then the process is repeated. Optimization interval of 1 hour is appropriate as it results in good control performance and fast convergence of optimization. Using the optimization interval of 30 minutes provides more precise set-points trajectory but results in very long optimization times. A horizon of at least 48 hours for the simulation purposes is better since the first 24 hours data is affected by the initial conditions. If the initial conditions are all measured and accurate then the optimization horizon of 24 hours is sufficient.

Table 6-1: Electricity TOU price in Ontario during summer and winter 2015 [235]
Day Time 07:00 PM to 07:00 AM 07:00 AM to 11:00 AM 11:00 AM to 5:00 PM 5:00 PM to 07:00 PM 12:00 AM to 12:00 AM Hours 12 4 6 2 24 Summer (May 1 to Oct 31) Period Off-Peak Mid-Peak On-Peak Mid-Peak Off-peak Price ($/kWh) 0.800 0.122 0.161 0.122 0.800 Winter (Nov 1 to Apr 30) Period Off-Peak On-Peak Mid-Peak On-Peak Off-Peak Price ($/kWh) 0.83 0.128 0.175 0.128 0.83

Mon to Fri Weekends and Holidays

144

Electricity TOU Price during Summer Season
0.15

Price ($/kWh)

0.1 0 5 10 15 20

Time (Hour) Electricity TOU Price during Winter Season
0.15

Price ($/kWh)

0.1 0 5 10 15 20

Time (Hour)

Figure 6-8: Electricity TOU price during the summer and winter season on weekdays 6.5.4.3 Local Level Controllers Local level controllers are implemented in the LabVIEW®. On/off control is used to control the temperature of each zone and BT since the HVAC system does not have variable speed pumps and fans. The local level controllers regulate the zone temperature and BT temperature at the set-points generated by the supervisory MPC. 6.5.4.4 Interface between Supervisory and Local Controllers A simple method of communication between the MATLAB® and LabVIEW® using the CSV files was used. MATLAB® writes the set-points to the CSV files which are read by the LabVIEW® program. The temperature feedback from the zone and BT is written to the CSV files which are read by the MATLAB® script and used for updating the APMonitor model file. 6.5.4.5 Performance Analysis In order to analyze the performance of the supervisory and local level controllers, the data is written to a CSV file for plotting and post processing in the MATLAB®. At an interval of 5 seconds, the data of time vector, set-points, zone-temperatures, BT temperature and control signals is written to the CSV file. MATLAB® was used to plot this data.

145

6.6.

Results

6.6.1. Cooling Season
The controller was tested in the summer of 2015 between the period August 21 and September 11 for 22 days. The outside air temperature was measured during this period which ranged between 9°C and 36°C. The measured temperature and weather forecast match each other well during this period. The temperature of each zone inside the house was controlled between 22°C and 25°C by the controller. This range was chosen based on the ANSI-ASHRAE Standard 55 [236] which describes the optimal thermal conditions for the human occupancy. According to [236], the zone temperature between 22°C and 25°C falls into comfortable range in summer. 6.6.1.1 Simulation Results

The simulation results are shown in Figure 6-9 and Figure 6-10. First the zone temperature is varied by the supervisory controller in Figure 6-9 to reduce the cost of operating the HVAC system. It can be seen that the controller decreases the set-points gradually during the off-peak period and thus precooling the house. The amount of energy stored depends on the weather forecast. If the weather is going to be very hot, the controller lowers the set-points much further compared to the less warm weather. Pre-cooling the house offsets the HVAC load from mid-peak and on-peak hours to off-peak hours. By looking at the control signal signals it can be seen that the supervisory controller forces the HVAC system to supplying cooling during the off-peak hours and remain turned off during the midpeak and peak hours as much as possible. In order to find the total cost savings by employing the supervisory controller, the set-points of the zone were fixed at 25°C, 24°C, 23°C and 22°C and results were plotted in Figure 6-10 (a), Figure 6-10 (b), Figure 6-10 (c) and Figure 6-10 (d) respectively. The energy consumption and cost for each case was calculated and is shown in Table 6-2. The set-points are plotted against the percentage increase in energy consumption and operating cost in Figure 6-12 and Figure 6-13 respectively. The energy consumed by the HVAC system with the variable set-points is slightly higher than the energy consumed by the HVAC system with 25°C fixed set-points. The HVAC system with supervisory controller consumes about 1.5% more energy than the HVAC system with 25°C fixed set-points. When the set-points are lowered to 24°C, 23°C, and 22°C, the energy consumption increases about 29.1%, 66.6% and 114.6% consecutively. One can see that this increase in energy 146

consumption is not linear as lowering the set-point by 1°C consecutively from 25°C to 24°C, 23°C and 22°C results in an increase in energy consumption of 30.6%, 37.5% and 47.9% respectively. Though the energy consumed by the HVAC system is slightly higher when the variable set-points are generated by the supervisory MPC compared to fixed set-points of 25°C, the cost for operating the HVAC is much lower when supervisory MPC is used. Employing the supervisory controller with variable set-points results in 16.1% cost savings over the fixed set-points of 25°C. The operating cost with fixed set-points increases significantly when the set-points are lowered to 24°C, 23°C and 22°C resulting in 50.2%, 91.6% and 142.3% increase in operating cost respectively. 6.6.1.2 Experimental Results

The variable set-points of the HVAC system were generated by the supervisory controller during the test period. The energy consumption of each of the subsystems e.g., pumps, fans, GSHP was measured and cost was calculated based on the electricity TOU price. The results of the experimental investigations are shown in Figure 6-11 and the energy consumed and cost is shown in Table 6-2. The experimental results match the simulations closely. A few observations regarding the test setup can be made in order to drive down the costs further: 1. The insulation on the BT should be improved to reduce the losses to the ambient. 2. The larger BT with more thermal storage should be installed to make the active thermal storage possible. 3. The insulation of the ILS should be improved to reduce the losses to the ambient.

147

Figure 6-9: Estimated temperature of all zones and BT along with their control signals during cooling season with variable temperature set-points (MPC sampling time = 1 hour)

148

(a)

149

(b)

150

(c)

151

(d) Figure 6-10: Estimated temperature of all zones and BT along with their control signals during cooling season with fixed set-points at (a) 25°C (b) 24°C (c) 23°C (d) 22°C

152

Figure 6-11: Measured temperature of all zones and BT along with their control signals during cooling season (MPC sampling time = 1 hour)

153

Table 6-2: Energy Consumption and Cost Comparison
Energy Consumed (kWh) % Consecutive Increase % Increase ILAHU ILAHU GSHP Cost ($) % Consecutive Increase
0.0 16.1 34.1 41.4 50.7

Meas

Sim

MPC based Variable Set-points MPC based Variable Set-points 25°C Fixed Setpoints 24°C Fixed Setpoints 23°C Fixed Setpoints 22°C Fixed Setpoints

59.4 51.4 44.0 59.4 79.4 105.8

53.1 43.8 47.4 60.5 75.5 93.2

142.7 153.5 153.6 201.3 259.6 334.7

255.2 248.7 245.1 321.2 414.5 533.7 0.0 -1.5 29.1 66.6 114.6 0.0 -1.5 30.6 37.5 47.9

5.9 4.7 5.1 6.8 9.0 11.8

5.5 4.7 5.4 6.8 8.4 10.2

14.5 15.0 17.7 22.9 29.2 37.0

25.9 24.3 28.3 36.6 46.6 59.0 0.0 16.1 50.2 91.6 142.3

MPC based Variable Set-point

100

25°C Fixed Set-point 24°C Fixed Set-point 23°C Fixed Set-point 22°C Fixed Set-point

80

Energy Consumptoin Increase (%)

60

40

20

0 1 1.5 2 2.5 3 3.5 4 4.5 5

Set-point (#)

Figure 6-12: Set-point vs. energy consumption increase

154

% Increase

GSHP

AHU

AHU

Total

Total

140
MPC based Variable Set-point 25°C Fixed Set-point 24°C Fixed Set-point 23°C Fixed Set-point 22°C Fixed Set-point

120

100

Cost Increase (%)

80

60

40

20

0 1 1.5 2 2.5 3 3.5 4 4.5 5

Set-point (#)

Figure 6-13: Set-point vs. cost increase

6.6.2. Heating Season
Since the load of the building can be shifted by storing the passive energy in the building envelope, the scheme only works during the moderate weather. It was seen in the simulations that during the heating season, the controller was able to shift the load to off-peak hours completely when the mean air temperature was above 10°C. When the mean air temperature drops to 5°C, the partial load is shifted to the off-peak hours. When the mean air temperatures falls close to 0°C, the controller was having a very hard time in shifting any significant amount of load to off-peak hours. Finally when the mean air temperature falls to -5°C, almost no load was being shifted to the off-peak hours. There are two reasons for this behavior. First reason is the higher losses to the ambient at lower temperature and the second reason is the lower thermal mass of the building and lack of any active thermal energy storage. As the outdoor air temperature decreases, the losses to the ambient increase due to higher temperature difference between the indoor and outdoor air resulting in higher heat transfer from the zone to the outside. The residential building has a small thermal mass and only a limited amount of energy can be stored into it without scarifying the thermal comfort of the occupants and incurring higher costs. Adding active thermal storage systems will increase the usability of the controller during the very harsh weather in winter.

155

This highlights the passive-only energy storage limitations. Figure 6-14 shows the box plot of the temperature in Toronto over the past 50 years between 1955 and 2005. The historic temperature data was downloaded from the Government of Canada website [236] to see the outside air temperature variations during different times of the year. By looking at the box plot, we can see that the controller will only be able to fully or partially shift the load to off-peak hours during March till November during which time, the mean air temperature remains on or above 0°C. During the much colder months of December, January and February, the energy storage is not useful in cold climates like Toronto. This means that we need a significant amount of active thermal storage in the system to effectively shift the load to off-peak hour.

30

20

Air Temperature (°C)

10

0

-10

-20

-30 1 2 3 4 5 6 7 8 9 10 11 12

Time (Month)

Blue Box: Quartiles 25th and 75th percentiles, Red horizontal line: Median, Black line: Range of the data, Red +: Statistical outliers Figure 6-14: Box plot of the air temperature in Toronto for 50 years [236]

6.7.

Conclusions

In Chapter 6 the centralized controller for the HVAC system was developed. The residential HVAC system uses the standard control interfaces which were connected to a centralized controller implemented in the MATLAB® and LabVIEW®. The centralized controller had a hierarchical 156

structure with the supervisory controller on the top and local level controllers on the bottom. The supervisory controller used MPC to find the optimum set-points trajectory based on the day ahead weather forecast and electricity TOU price information. The set-points were sent to the local level controllers which regulated the temperature of each zone and BT. A detailed system model was developed and calibrated with the test setup at TRCA-ASHB in Vaughan Ontario. The model was used by the MPC supervisory controller during both simulations and implementation to find the setpoints trajectory. The energy consumption of each subsystem component was calculated and compared between the simulations and experiments which matched closely. A reduction of at least 16% was obtained in energy consumption by employing the supervisory MPC compared to a fixed set-point of 25°C. As the fixed set-point was reduced further, more savings were possible. Comparing with a fixed set-point of 24°C, where the thermostats were manually fixed during the summer in TRCA-ASHB, a cost savings of about 50% were seen.

157

Chapter 7 Conclusions and Future Work
7.1. Conclusions

The main objectives of this research work were · · · · · Development of simulation framework for residential HVAC system, Simulation of the existing HVAC systems and control systems, Development of new controller for operating cost reduction, Implementation of the new controller on the TRCA-ASHB, and Verification of the cost savings through comprehensive monitoring.

In order to achieve these objectives, a review of the existing HVAC modeling methods was conducted which identified three main modeling classes, i.e., physics-based (white-box) models, data-driven (black-box) models and grey-box models. In order to find the best modeling technique, the measured data from the TRCA-ASHB was used to develop the black-box and grey-box models of the HVAC system. The performance of the models was evaluated by visual and analytical comparison with the measured data. Based on the analytical comparison, the models were ranked and it was found that the data driven models perform better than grey-box models in most modeling scenarios. The visual comparison revealed that grey-box models perform better than black-box models when the data is noisy and lacks any structure. Grey-box models also have an underlying physics-based structure which aids them to produce better results when the test conditions deviate from the training data where the data-driven models fail. Since the HVAC system works under a variety of weather conditions, the grey-box models are more suitable. Therefore, the grey-box models were chosen for the development of model predictive controller. Since HVAC is a complex system, the whole system was divided into several functional subsystems such as ERV, AHU, BT, RFH and GSHP. In order to develop the grey-box models, the physics-based models were developed first and then measured data was used to find their parameters. The models were calibrated by finding their parameters using nonlinear least squares optimization based parameter estimation techniques in MATLAB® Simulink® control and estimation tools manager. The measured data from the TRCA-ASHB was used during the modeling and validation phases. Once the subsystem models were calibrated, the whole HVAC simulation framework was developed by integrating all the 158

subsystem models. The on/off controllers were added to the system to replicate the performance of the existing HVAC system. The simulation was able to accurately predict the operating cost of the HVAC system under a variety of weather conditions. Since the original HVAC system did not incorporate any energy conservation strategies, a supervisory MPC was developed to reduce the operating cost of the system. The cost function and constraints were formulated and the grey-box models of the single zone HVAC system developed earlier were extended to five zones (i.e., basement, 1st floor, 2nd floor, 3rd floor and in-law suite) in the TRCAASHB. MPC uses the weather forecast and electricity TOU price to adjust the set-points of the local level controllers. Ontario has a variable electricity price structure where the electricity is cheap during the off-peak hours and it is expensive during the peak hours. In order to reduce the operating cost of the system, the supervisory MPC stores energy in the building mass during the off-peak hours. The simulations were carried out to investigate the effects of supervisory MPC on the cost savings and was found that at least 16% cost can be reduced. Since TRCA-ASHB uses a standard residential HVAC system; therefore, the HVAC system did not provide any programmable interfaces where the controller could be implemented immediately to test the cost savings. Rather the HVAC system utilized proprietary OEM controllers which were not programmable by the user. Therefore, a new controller interface was created to test the controller design. The schematics diagrams for the modifications to the HVAC system were developed to interface the new controller to the HVAC system. New temperature sensors were installed inside the buffer tank and five zones to monitor and control their temperature. Several relays and switches were used to design a new interface between the NI CFP based digital output modules and HVAC subsystems. The supervisory MPC was implemented in MATLAB® and local level controllers were implemented in LabVIEW®. A cost savings of 16% were verified through monitoring after the implementation of the controller.

7.2.

Future Work

Despite considerable work on MPC development for HVAC systems, possible areas that require further investigation still exist and are summarized as follows: · Performance comparison of different MPC techniques (i.e., robust MPC, SMPC, D MPC, LBMPC, and H-MPC); 159

· · · ·

MPC development for GSHPs; Investigation of integrating nonlinear modeling methods (i.e., ANN, FL, and SVM) for use in MPC; Study of techniques for comprehensive on-line updates of the model and accurate estimates of disturbances as well as their impact on MPC performance; Investigation of integrating meta-heuristic optimization techniques and their impact on MPC performance. Such methods include simulated annealing, differential evolution, ACO, bee algorithms, the Tabu search, the Harmony search, the firefly algorithm, cuckoo search, artificial immune systems, memetic algorithms, the cross entropy method, and the bacterial foraging method for use in MPC control vector computation;

· ·

Further research on factors that affect MPC performance; Upgrade system hardware for implementation of more advanced local controllers. Add variable frequency drives for the variable speed control of all pumps and fans. Add variable speed compressor in GSHP for variable capacity control;

·

Implementation of soft control (e.g., ANN and FL) based supervisory controllers and comparison with hard control (i.e., MPC) based supervisory control.

7.3.

Contributions

Following are the major contributions of this research: · · · · Produced 7 journal papers and 2 conference papers. The research papers have good number of citations (more than 90 citations so far in less than 2 years); Development of grey-box and black-box models for TRCA-HVAC systems; Comparison of modeling methods and validation of the models with measured data; Hierarchical centralized control system design for residential HVAC system by incorporating the supervisory MPC on the upper level and on/off controllers on the local level for maximization of cost savings and tight process regulation; · · Implementation of the centralized control system on the TRCA-HVAC system; Implementation of new interfaces programmable through MATLAB® and LabVIEW® for future research in controller design. 160

Appendix I: Identified Black-Box Models
ANN Models
ERV ANN Model There are a total of 10 neurons in the hidden layer and 2 neurons in the output layers. The weights and bias values of the ERV ANN model are given as follows:

 2.557 -1.6144 0.776 -0.357   1.117 1.900 -0.754 -1.779     -1.011 0.548 2.300 -1.377     1.511 -0.012 1.786 -0.988   0.362 0.194 0.173 -0.149  vij =  , 0.781   -1.220 -0.735 1.231  -1.111 0.437 1.423 0.045    1.190 -0.651 -0.598   0.246  -0.119 1.278 0.832 2.371     1.644  0.385 -0.782 -1.741 
 -0.129 wki =   -0.164 -0.306 -0.325 0.211 -0.020 1.633 0.245 0.132 -0.060 1.769 0.310 0.325 0.222 -0.459 -0.438 0.104 0.134 0.073  , -0.067  

(AI.1)

(AI.2)

 -3.00   -2.087     1.273     -0.214   -0.212  bij =  ,  0.128   -1.166     1.148   1.896      2.158  

(AI.3)

0.172  cki =  ,  0.223
161

(AI.4)

where v is the weight between input layer and hidden layer, w is the weight between hidden layer and output layer, b is the weight of bias term of the input layer, c is the weight of bias term of the hidden layer, i is the neuron number in hidden layer, j is the input number and k is the output number. AHU ANN Model There is one input layer, one output layer and one hidden layer with 10 neurons in it in the AHU ANN model. The weights are of the network are given as follows:

 -0.594   -1.977  -1.122   2.285  0.499 vij =   2.555  1.650   -1.835  0.960    1.830
 1.185 wki =   -0.736 0.183 0.154 -0.108 0.269 0.043 0.158

3.605 -0.059 -0.135 1.916 -0.691 -0.501 2.324 1.084 -0.039 -2.105
0.169 -0.080

0.793   2.176  3.059   0.466  -1.765 , 1.686  -1.248  1.756  -2.642   -0.098 
-0.299 0.156 -0.244 0.441 -0.461 -1.315 -0.390  , 0.702  

(AI.5)

-0.410 -0.068

(AI.6)

 3.668   2.910     0.810     -0.822   0.293  bij =  ,  0.115   1.729     -2.106   2.739     3.421   

(AI.7)

 -0.759  cki =  .  0.371  162

(AI.8)

BT ANN Model BT model has 8 inputs, one outputs and 10 neurons in the hidden layer. The network weights are given as below:

 1.877  3.180   -0.165   0.135  3.018 vij =   -1.302  -4.675   -1.657  2.555    0.735

-4.443 -3.377 1.493 -1.376 -1.341 -2.906 1.524 -1.306 0.256 1.368 0.653 -0.201 -1.124 -1.452 -2.680 2.778 1.311 -1.815

1.374 2.256 2.163  2.531 -1.439 2.401   0.144 -1.364 0.395 -0.184   -0.061 0.010 -0.075 0.051  -0.044 2.406 -1.340 2.205  , -0.343 -0.363 -1.662 -1.565 0.695 1.254 0.131 0.270 -2.637 0.0484 0.529   4.744 0.343 -0.057 0.088 0.089 0.572 0.618  -0.213 9.933 8.682 0.532 2.972 -1.356 -0.262   0.461 -1.232 -0.587 -0.103 -0.230 -1.829 -0.826  

0.356 -0.053

(AI.9)

wki = [ -0.337

-2.829

0.417 1.005

2.902

-0.306

-0.358

-0.404

-0.106

-1.907 ] ,

(AI.10)

 -0.771  0.467     -0.583    -0.695  0.299  bij =  ,  -0.351  -2.173    0.105  13.506      3.676  

(AI.11)

cki = [ 2.199] .
RFH ANN Model 163

(AI.12)

RFH ANN Model has 5 inputs, 2 outputs and 10 neurons in the only hidden layer. The network weights are given as follows:

 2.129  -2.456   0.277   0.737  -2.355 vij =   -0.223  -1.348   -1.006  1.042    1.484
 0.936 wki =   0.467 0.413 0.580 -0.792 -0.752

-4.190 0.385 0.974 7.280 0.161 -0.548 1.180 -0.768 0.559 -2.114 -3.072 0.839 -0.860 -0.345 0.349 2.705 3.783 -0.459 -0.261 -0.143 0.096 0.674 0.558 -0.370 0.001 2.292
0.906 0.807

3.647 -5.325

0.101 3.641

0.153  -0.357   -2.136   -0.471 0.758  , 0.847  0.674   -2.621 1.219   -6.912  
-0.834 -0.838 -0.788 -0.509 0.401 , 0.174 

(AI.13)

5.782 1.417 -5.753 4.867 0.851 -5.490

(AI.14)

 -2.611  4.830     1.199     -0.805  -0.610  bij =  ,  1.159   -0.330     -1.640   -0.875    2.620   

(AI.15)

 -1.260  cki =  .  -1.040 
GSHP ANN Model

(AI.16)

The GSHP model has 2 inputs and one output. There is one hidden layer with 10 neurons in it. The network weights are given as follows: 164

 1.290 -3.335  -0.176 1.203     -4.095 4.336    3.303   5.959  2.554 4.025  vij =  ,  -2.850 -3.704   -4.188 -1.500     -0.027 4.716   3.632 3.028      2.764 2.247  
= wki

(AI.17)

[ 0.266

0.707

3.154

3.072

-2.069

2.587

-1.119

-0.997

2.119

-1.455] ,

(AI.18)

 -5.637   -0.536     5.309     -2.854   -0.260  bij =  ,  -0.149   -1.484     2.084   3.317     5.284   

(AI.19)

 -1.260  cki =  .  -1.040 

(AI.20)

TF Models
ERV TF Model The individual TFs between each input and output are given as follows:
G11 ( s ) = -2.493s - 5.017 , s + 0.02343

(AI.21)

165

G12 ( s ) =

-17.47 s - 8.653 , s + 0.01917

(AI.22)

G21 ( s ) =

78.16 s + 9.257 , s + 0.0133 -2.09 s + 7.484 , s + 0.02183

(AI.23)

G22 ( s ) =

(AI.24)

G31 ( s ) =

0.7596 s + 0.004357 , s + 0.00002108

(AI.25)

G32 ( s ) =

0.3167 s - 0.01231 , s + 0.03027

(AI.26)

G41 ( s ) =

0.07587 s - 0.007945 , s + 0.00536
0.7401s + 0.01773 . s + 0.01972

(AI.27)

G42 ( s ) =

(AI.28)

AHU TF Model The AHU TF models are given as follows:
G11 = -84.45s + 15.64 , s + 0.11

(AI.29)

G12 =

-16.11s - 0.4277 , s + 0.1278s + 0.003317
2

(AI.30)

G21 =

33.5s - 6.785 , s + 0.1385

(AI.31)

G22 ( s ) =

12.05s + 17.46 , s + 0.0899

(AI.32)

G31 ( s ) =

0.6185s - 0.05163 , s + 0.08041

(AI.33)

166

G32 ( s ) =

0.443s - 0.02464 , s + 0.05804

(AI.34)

G41 ( s ) =

0.6605s + 0.07149 , s + 0.0527
0.2963s - 0.01067 . s + 0.02883

(AI.35)

G42 ( s ) =

(AI.36)

BT TF Model BT TF models are given as follows:
G11 ( s ) = 0.6999 s + 1   .321 , s  +1  .429

(AI.37)

G21 ( s ) =

  - 0.3764  s  0.1076 + , + s  3.509 1.681  s  3.549 + , s  29.9 +

(AI.38)

G31 ( s ) =

(AI.39)

G41 ( s ) =

  - 0.7243  s  0.632 + , s  3.158 +

(AI.40)

G51 ( s ) =

1.634  s  8.551 - , + s  0.7653

(AI.41)

G61 ( s ) =

-0.07016  s  0.05294 + , s  0.08025 +
1.197  s  0.1464 - , s  0.04479 +

(AI.42)

G71 ( s ) =

(AI.43)

G81 ( s ) =

0.01748  s  0.1929 - . s  0.03207 +

(AI.44)

RFH TF Model RFH TF models are given as follows: 167

G11 ( s ) =

-2.433s + 0.04918 , s + 0.7776 s + 0.003914
2

(AI.45)

G12 ( s ) =

0.8227 , s + 0.0305

(AI.46)

G21 ( s ) =

0.01755s - 0.002329 , s + 0.1837
0.001765 , s + 0.03413

(AI.47)

G22 ( s ) =

(AI.48)

G31 ( s ) =

0.08538s + 5.885e - 07 , s + 0.0001047 0.1818  s  0.0006382 - , + s  0.01841
2.034 s + 1   .916 , + s  0.005192

(AI.49)

G32 ( s ) =

(AI.50)

G41 ( s ) =

(AI.51)

G42 ( s ) =

-1.111  s  2.911 + , s  0.01159 +

(AI.52)

G51 ( s ) =

0.02452  s  0.006999 + , + s  0.1882
0.0149  s  0.00624 + . s  0.01145 +

(AI.53)

G52 ( s ) =

(AI.54)

GSHP TF Model GSHP TF models are as follows:
G11 ( s ) = 0.5837 s + 2.314 , s + 1.29 1.089 s + 1.376 . s + 1.441

(AI.55)

G21 ( s ) =

(AI.56)

Process Models
168

ERV Process Model For the ERV process model, the following parameters are identified:

G11 = = Tp 6.834, 14.631, 0.399, = Td = Tz ( s ) : K p 83.311,  G12 ( s ) : K p = -12.99,  Tp == 5.89, 10.455, 1.893, Td Tz = G21 ( s ) : K p = -15.661, 1.229, 16.515,  Tp == Td Tz = -0.748, G22 ( s ) : K p = -100.27,  Tp = Td = Tz = -1.0318, 404.66, 12.681,  899.65, 1.041 G31 ( s ) : K p = Tp = ×106 , 0, 746.01, Td = Tz = G32 ( s ) : K p = 643.55, 4.895 Tp = ×105 , 0, 231.93, Td = Tz = G41 ( s ) : = K p 0.140,  = Tp 2.920, 0, 6.126, = Td = Tz G42 ( s ) : = K p 0.809,  = Tp 20.469,  = Td 0, 17.074, = Tz
AHU Process Model The parameters of the AHU process models are given as follows:

(AI.57) (AI.58) (AI.59) (AI.60) (AI.61) (AI.62) (AI.63) (AI.64)

G11  :  -49.59,  Tp = 0.012576,  Td = 10.076,  Tz = -10.056, (s) K p =
G12  :  K p 91.206,  = Tp 2.3955,  = Td 0,  = Tz 1.9849, (s) =

(AI.65) (AI.66) (AI.67) (AI.68) (AI.69)

G21  :  Tp = 1.1083,  Td = 8.485,  Tz = -1.6173, ( s ) K p = 15.985,  0.46358,  19.192,  G22  :  -2.2153,  Tp = Td = Tz = -0.30385, (s) K p =
G31  :  K p 0.64398,  = Tp 7.4977,  = Td 0,  = Tz 3.0414, (s) =
169

G32  :  -0.25839,  Tp == 1.3887,  Td 0,  Tz = -0.0036893, (s) K p = G41 =  :  = Tp 0.35087,  = Td 0.382,  = Tz 1.2049, ( s ) K p 0.4487,  G42  :  K p 0.44424,  = Tp 12.646,  = Td 0,  = Tz 9.6011. (s) =
BT Process Model The BT process model parameters are given as follows:

(AI.70) (AI.71) (AI.72)

G11 ( s ) : = K p 0.7865,  = Tp 4.7933, 0, 5.365, = Td = Tz G21 ( s ) : K p = -0.029198, 2.346, 22.956,  Tp = Td = Tz = -0.090295, G31 ( s ) : = K p 0.23543, 25.143, 0, 20.152, = Tp = Td = Tz G41= = Tp = Td = Tz ( s ) : K p 0.36367, 33667, 15.308, 2.5586, G51 ( s ) : K p = 8.3168, 0.14978, 5.58,  Tp = Td = Tz = -2.1494, G61 ( s ) : = K p 20.113, 433.56, 0, 2.3087, = Tp = Td = Tz G71 ( s ) : K p = -51.451, 386.72, 7.747, 9.2522, Tp = Td == Tz G81 ( s ) : K p = -87.117,  Tp = 806.49, 1.842, 16.145. Td = Tz =
RFH Process Model The process model for the RFH system is given as follows:

(AI.73) (AI.74) (AI.75) (AI.76) (AI.77) (AI.78) (AI.79) (AI.80)

G11 ( s ) : K p = 2212, 4.3531 Tp = e + 06, 0, Td = Tz = -37.393,
G12 ( s ) : = K p 21.436, 22.453, 0, 4.079, = Tp = Td = Tz
170

(AI.81) (AI.82)

G21 ( s ) : K p = 17.403,  Tp = 7.8141e + 05, 0, 57.395, Td = Tz = G22 ( s ) : K p = 0.2255, 284.05, 0, Tp = Td = Tz = -37.58, 120.4,  9.2344e + 05,  0, 842.84, G31 ( s ) : K p = Tp = Td = Tz = G32 ( s ) : K p = 0.097537, 233.23, 0, Tp = Td = Tz = -68.454, G41 ( s ) : K p = 834.88, 187.76, 0, Tp = Td = Tz = -3.4401, G42 ( s ) : = K p 321.17, 2235.6, 0, = Tp = Td = Tz 12.963, G51 ( s ) : K p = 13.949, 1.5737 Tp = e + 07, 0, Td = Tz = 290.29, G52 ( s ) : K p = 0.00064782, 6.0318, 0, Tp = Td = Tz = -454.67.
GSHP Process Model The process model for the GSHP is given as follows:

(AI.83) (AI.84) (AI.85) (AI.86) (AI.87) (AI.88) (AI.89) (AI.90)

G11 ( s ) : K p = 1.7895, 1.0776, Tp1 = Td = 0,  Tz = -0.18875, G21 ( s ) : = K p 0.95434,  = Tp1 0.6702, 0, 0.76455. = Td = Tz

(AI.91) (AI.92)

SS Models
ERV SS Model The SS matrices of the ERV model are given as follows:

 -0.098 -0.097 0.316   -0.0917 -0.378 0.449   , A=     0.188 0.254 - 1.196  
171

(AI.93)

 0.361 0.075 0.052 0.048   2.34 , B= 7.127 0.071 0.181    -0.246 -1.205 -0.187 -0.117  
11.35 0.158 -0.242  C= ,  4.803 1.146 -0.210 

(AI.94)

(AI.95)

0 0 0  D=  ,  0 0 0 

(AI.96)

 0.085 -0.037   0.165 K=  0.366  - .   0.013 0.054  
AHU SS Model The SS matrices of the AHU model are given as follows:

(AI.97)

 -1.595 0.5276 -0.05634   A =   0.9088 -1.152 -0.03732  ,   0.2625 -0.249 -0.3259  

(AI.98)

 116.1 -13.15 -0.7774 -0.1367  - ,  32.65 B=  5.709 0.3927 0.684    -5.81 -12.43 0.4511 0.09539  
 -3.465 1.4 0.6964  C= ,  1.485 0.232 0.5829 
0 0 0   , D=  0 0 0 

(AI.99)

(AI.100)

(AI.101)

 -0.01765 0.112   K =  0.09162 0.3419  .   0.01419 0.2912   172

(AI.102)

BT SS Model The SS matrices of the BT model are given as follows:

0.004155 0.02577  A= ,  -0.3774 -0.2692 
-0.006566 -0.00614  0.00299  0.0009792 -9.521e - 05 0.0001672 -0001718 -0.004625 B= , -0.00123 0.002522 -0.0005503 -0.02372 0.002746  0.002189 0.301  -0.007617 

(AI.103)

(AI.104) (AI.105) (AI.106)

= C [19.85 - 16.71] ,   D = [ 0 0 0 0 0 0 0 0] ,
 0.02609   . K =   -0.03011
RFH SS Model The SS matrices of the RFH model are given as follows:

(AI.107)

0.04265 0.3962   0.1235  -0.08339 -0.003343 -0.05284  , A=     -0.3163 -0.00799 -0.1667  
0.08755 -0.0005012   -0.1654 -0.0002049 0.008989  0.06231 4.059e - 05 -0.0004579 -0.01489 0.0001322  , = B    0.000115 -0.0008893 -0.06175 0.0005358   0.2178 
0.5151 45.21 -12.98 C= ,  19.86 52.3 -5.322  0 0 0   , D=  0 0 0 

(AI.108)

(AI.109)

(AI.110)

(AI.111)

173

 -0.0256 0.02356   0.01196 K = 0.007556   .   -0.03567 0.02646  
GSHP SS Model The SS matrices of the GSHP model are given as follows:

(AI.112)

A=

[ -1.478] ,

(AI.113) (AI.114) (AI.115) (AI.116) (AI.117)

 B = [ 0.1896 0.03786] , C = [30.91] , D = [ 0 0]  , K=

[ -0.002374].

ARX Models
ERV ARX Model The polynomials of the ERV ARX model is given as follows: For output y1 :

A( z ) = 1 - 2.225 z -1 + 1.144z -2 + 0.3639z -3 - 0.2889z -4 , A2 ( z ) = 0.3061z -1 - 0.361z -2 - 0.05374z -3 + 0.125z -4 ,
-1 - - 1.931z -2 + 2.234z -3 , B1 ( z ) = 1.444 1.477z

(AI.118) (AI.119) (AI.120) (AI.121)

B2 ( z ) = 0.5823 - 8.983z -1 + 12.54z -2 - 4.544z -3 ,
174

B3 ( z ) = 0.2864 - 0.4407z -1 + 0.04508z -2 + 0.1098z -3 ,

(AI.122) (AI.123)

B4 ( z ) = 0.3118 - 0.4645z -1 + 0.0895z -2 + 0.07365z -3 .
For output y2 :

A ( z ) = 1 - z -1 , A1 ( z ) = -0.2886z -1 + 0.3008z -2 + 0.08775z -3 - 0.1055z -4 , B1 ( z ) = 2.1 - 2.023z -1 - 2.783z -2 + 3.115z -3 ,
B2 ( z ) = 3.65 - 9.162z -1 + 5.456z -2 - 0.2346z -3 ,

(AI.124) (AI.125) (AI.126) (AI.127) (AI.128) (AI.129)

B3 ( z ) = 0.1359 - 0.1977z -1 + 0.005757z -2 + 0.05602z -3 , 0.7118 - 1.076z -1 + 0.2945z -2 + 0.07675z -3 . B4 ( z ) =
AHU ARX Model The polynomials of the AHU ARX model is given as follows: For output y1 :

A ( z ) = 1 + 0.1355 z -1 , A2 ( z ) = -0.172 z -1 , B1 ( z ) = -156.2 z -1 , B2 ( z ) = 20.92 z -1 ,

(AI.130) (AI.131) (AI.132) (AI.133)

175

B3 ( z ) = 1.411z -1 , B4 ( z ) = 0.5643z -1.
For output y2 :

(AI.134) (AI.135)

A ( z ) = 1 - 0.0839 z -1 , A1 ( z ) = 0.008997 z -1 ,
B1 ( z ) = 67.33z -1 ,

(AI.136) (AI.137) (AI.138) (AI.139) (AI.140) (AI.141)

B2 ( z ) = -20.36 z -1 , B3 ( z ) = 0.1894 z -1 ,
B4 ( z ) = 0.3039 z -1.
BT ARX Model The polynomials of the BT ARX model are given as follows:

A ( z ) = 1 - 0.9891z -1 , = B1 ( z ) 0.8968 z -1 - 0.8903 z -2 , B2 ( z ) = -0.0003741z -2 , B3 ( z ) = 0.001246 z -1 , B4 ( z ) = 0.00139 z -1 , B5 ( z ) = 0.3303z -2 , 176

(AI.142) (AI.143) (AI.144) (AI.145) (AI.146) (AI.147)

= B6 ( z ) 0.1807 z -1 - 0.1317 z -2 , = B7 ( z ) 0.9286 z -1 - 1.051z -2 , = B8 ( z ) 0.05293z -1 - 0.1874 z -2 .
RFH ARX Model The polynomials of the RFH ARX model is given as follows: For output y1 :

(AI.148) (AI.149) (AI.150)

A( z ) = 1 - 0.4138 0.2844 0.1924  z -1 - z -2 - z -3 - 0.1076 z -4 ,
A2( z ) = 0.002809 0.00905 0.008686 0.00544 z -1 - z -2 + z -3 - 5 z -4 ,

(AI.151) (AI.152)

B1 ( z ) = -0.03828 - 0.09273 0.1923 0.03894 0.08943  z -1 + z -2 + z -3 - z -4 -  0.02763  z -5 - 0.06502  z -6 + 0.1763 z -7 ,

(AI.153)

B2 ( z ) = 0.001114 - 0.0004452 z -1 + 0.0001442 z -2 - 0.001847 z -3 + 0.001898 z -4 - 0.001403z -5 + 0.002113z -6 - 0.0009061z -7 ,
B3 ( z = ) 0.005946 - 0.0005979 z -1 + 0.002146 z -2 + 9.625e - 06 z -3 -0.001437 z -4 + 0.0009412 0.0006967 0.00 z -5 + z -6 - 6672 z -7 , -0.1079 - 0.04678 z -1 - 0.1374 z -2 + 0.06905 z -3 - 0.01242 z -4 B4 ( z ) = -0.07151z -5 - 0.04814 z -6 + 0.1062 z -7 ,
B5 ( z ) = -0.0008986 - 0.0007616 z -1 + 0.002422 z -2 - 0.002347 z -3 +0.0004406 z -4  0.0001253 + z -5 - 0.0005146 z -6 - 0.001101z -7 .
For output y2 :

(AI.154)

(AI.155)

(AI.156)

(AI.157)

177

A( z ) = 1 - 1.488 z -1 + 0.7678 z -2 - 0.3326 z -3 + 0.06497 z -4 , A1 ( z ) = 0.1466 z -1 + 0.02177 z -2 - 0.1645 z -3 - 0.01401z -4 ,
B1 ( z ) = -3.621 + 1.769 z -1 + 6.385 z -2 - 3.108 z -3 + 1.488 z -4 - 1.586 z -5 +0.1363 z -6 - 0.999 z -7 , -0.1281 + 0.1447 z -1 + 0.02243 z -2 + 0.05145 z -3 - 0.09591z -4 B2 ( z ) = +0.03555 z -5 - 0.0521z -6 + 0.02284 z -7 ,
-0.0009122 - 0.0059 z -1 + 0.01068 z -2 - 0.006755 z -3 + 0.003391z -4 B3 ( z ) = +  0.00105 z -5 + 0.002175 z -6 - 0.00469 z -7 ,

(AI.158) (AI.159)

(AI.160)

(AI.161)

(AI.162)

-0.4808 - 0.3495 z -1 + 0.5663 z -2 - 0.5634 z -3 + 0.8628 z -4 B4 ( z ) = -0.3687 z -5  0.319 + z -6 - 0.4443 z -7 ,
B5 ( z ) = -0.002227 + 0.003453 z -1 + 0.001914 z -2 + 0.001743 z -3 z -5 + 0.007161z -6 - 0.005775 z -7 . -0.002906 z -4  0.001266 +
GSHP ARX Model The polynomials of the GSHP ARX model is given as follows:

(AI.163)

(AI.164)

A ( z ) = 1 + 0.114 z -1 , B1 ( z ) = 1.763, B2 ( z ) = 1.081.

(AI.165) (AI.166) (AI.167)

178

Appendix II: Tables for Comparison of Models
Table AII-1: Comparison of ERV Models for output 1 (Teao ) Comparison Metrics Grey-Box Model 2.314 0.013 0.589 0.581 0.762 0.065 0.485 0.066 0.069 0.979 0.959 79.307 ANN Model 1.366 -0.018 0.468 0.344 0.587 0.050 0.354 0.046 0.053 0.987 0.975 84.072 TF Model 1.885 0.021 0.472 0.368 0.607 0.048 0.382 0.047 0.055 0.987 0.974 83.522 Process Model 3.859 -0.190 0.659 0.849 0.922 0.071 0.645 0.075 0.083 0.972 0.944 74.981 SS Model 2.646 0.022 0.699 0.776 0.881 0.079 0.537 0.084 0.080 0.980 0.959 76.080 ARX Model 1.679 0.005 0.394 0.268 0.517 0.044 0.336 0.047 0.047 0.991 0.983 85.953

MaxAE MBE MAE

MAPE Std AE
CV CC
G

MSE RMSE

Std APE

D

Table AII-2: Comparison of ERV Models for output 2 (T fao ) Comparison Metrics Grey-Box Model 1.369 -0.002 0.364 0.211 0.459 0.020 0.280 0.016 0.025 0.970 0.941 74.204 ANN Model 0.754 -0.043 0.214 0.071 0.267 0.012 0.159 0.009 0.014 0.989 0.978 85.023 TF Model 0.874 0.000 0.222 0.083 0.288 0.012 0.183 0.010 0.016 0.987 0.975 83.851 Process Model 1.140 -0.007 0.259 0.094 0.307 0.014 0.164 0.009 0.017 0.985 0.970 82.778 SS Model 1.296 0.008 0.321 0.160 0.400 0.018 0.238 0.014 0.022 0.982 0.964 77.561 ARX Model 0.741 0.003 0.184 0.054 0.232 0.010 0.142 0.008 0.013 0.992 0.985 86.951

MaxAE MBE MAE

MAPE Std AE
CV CC
G

MSE RMSE

Std APE

D

179

Table AII-3: Comparison of AHU Models for output 1 (Two ) Comparison Metrics Grey-Box Model 4.112 0.013 0.391 0.603 0.777 0.033 0.674 0.072 0.056 0.849 0.720 46.609 ANN Model 3.025 0.049 0.331 0.303 0.550 0.026 0.442 0.038 0.040 0.927 0.860 62.169 TF Model 3.372 -0.016 0.452 0.539 0.734 0.037 0.582 0.060 0.053 0.867 0.751 49.513 Process Model 9.570 -0.098 0.741 2.213 1.488 0.057 1.297 0.106 0.108 0.503 0.253 -2.281 SS Model 5.733 0.000 0.523 0.953 0.976 0.043 0.828 0.090 0.071 0.742 0.551 32.897 ARX Model 5.878 -0.003 0.477 0.961 0.980 0.040 0.861 0.094 0.071 0.739 0.546 32.615

MaxAE MBE MAE

MAPE Std AE
CV CC
G

MSE RMSE

Std APE

D

Table AII-4: Comparison of AHU Models for output 2 (Tao ) Comparison Metrics Grey-Box Model 1.433 0.030 0.402 0.253 0.503 0.025 0.304 0.019 0.032 0.883 0.780 26.700 ANN Model 1.041 0.009 0.199 0.072 0.268 0.013 0.181 0.011 0.017 0.921 0.847 60.882 TF Model 1.174 0.043 0.345 0.175 0.418 0.022 0.237 0.015 0.026 0.801 0.642 39.050 Process Model 2.362 0.007 0.216 0.132 0.363 0.013 0.293 0.018 0.023 0.861 0.741 47.136 SS Model 1.473 0.000 0.248 0.135 0.367 0.016 0.272 0.017 0.023 0.845 0.714 46.548 ARX Model 1.346 0.005 0.200 0.095 0.308 0.012 0.235 0.014 0.019 0.894 0.799 55.167

MaxAE MBE MAE

MAPE Std AE
Std APE
CV CC

MSE RMSE

G

D

180

Table AII-5: Comparison of BT Models Comparison Metrics Grey-Box Model 3.759 -0.017 0.826 1.270 1.127 0.019 0.767 0.018 0.026 0.949 0.900 65.449 ANN Model 3.169 -0.010 0.256 0.163 0.404 0.006 0.312 0.007 0.010 0.992 0.984 87.207 TF Model 4.093 -0.033 0.469 0.400 0.633 0.011 0.424 0.010 0.015 0.980 0.960 79.962 Process Model 2.781 0.088 0.545 0.458 0.677 0.013 0.402 0.010 0.016 0.978 0.956 78.555 SS Model 3.438 -0.004 0.518 0.512 0.716 0.012 0.494 0.012 0.017 0.974 0.949 77.330 ARX Model 4.273 0.052 0.596 0.603 0.777 0.014 0.499 0.012 0.018 0.970 0.942 75.394

MaxAE MBE MAE

MAPE Std AE
CV CC
G

MSE RMSE

Std APE

D

Table AII-6: Comparison of RFH Models for output 1 (Tz ) Comparison Metrics Grey-Box Model 0.662 0.040 0.180 0.050 0.224 0.008 0.133 0.006 0.010 0.836 0.700 44.266 ANN Model 1.226 -0.002 0.260 0.104 0.323 0.012 0.191 0.009 0.015 0.595 0.354 19.648 TF Model 0.738 -0.002 0.193 0.057 0.238 0.009 0.140 0.006 0.011 0.820 0.672 40.737 Process Model 2.495 -0.598 0.809 0.990 0.995 0.037 0.580 0.026 0.046 0.320 0.103 -147.598 SS Model 0.605 -0.002 0.181 0.048 0.218 0.008 0.122 0.006 0.010 0.841 0.707 45.768 ARX Model 0.557 -0.013 0.188 0.052 0.228 0.009 0.129 0.006 0.010 0.829 0.686 43.327

MaxAE MBE MAE

MAPE Std AE
Std APE
CV CC

MSE RMSE

G

D

181

Table AII-7: Comparison of RFH Models for output 2 (Twret ) Comparison Metrics Grey-Box Model 5.141 0.011 0.530 0.480 0.693 0.021 0.446 0.017 0.027 0.679 0.462 26.357 ANN Model 7.029 -0.005 0.410 0.428 0.654 0.016 0.510 0.019 0.025 0.719 0.516 30.426 TF Model 6.166 -0.050 0.513 0.477 0.691 0.020 0.462 0.017 0.027 0.682 0.465 26.558 Process Model 6.171 -0.257 0.538 0.531 0.729 0.021 0.491 0.018 0.028 0.691 0.478 22.542 SS Model 5.396 0.001 0.582 0.595 0.772 0.022 0.507 0.018 0.030 0.573 0.329 17.957 ARX Model 3.989 -0.015 0.523 0.442 0.665 0.020 0.410 0.015 0.026 0.716 0.512 29.291

MaxAE MBE MAE

MAPE Std AE
CV CC
G

MSE RMSE

Std APE

D

Table AII-8: Comparison of GSHP Models Comparison Metrics Grey-Box Model 12.786 0.005 0.375 0.645 0.803 0.009 0.710 0.022 0.018 0.971 0.942 75.936 ANN Model 7.984 -0.014 0.289 0.338 0.582 0.007 0.505 0.014 0.013 0.985 0.970 82.566 TF Model 9.414 0.004 0.298 0.397 0.630 0.007 0.556 0.016 0.014 0.982 0.964 81.106 Process Model 9.368 0.000 0.297 0.392 0.626 0.007 0.552 0.016 0.014 0.982 0.965 81.233 SS Model 24.358 0.000 0.929 4.985 2.233 0.022 2.031 0.061 0.049 0.743 0.552 33.080 ARX Model 9.654 0.002 0.299 0.420 0.648 0.007 0.575 0.017 0.014 0.981 0.962 80.588

MaxAE MBE MAE

MAPE Std AE
Std APE
CV CC

MSE RMSE

G

D

182

Appendix III: Wiring Diagrams of HVAC Interface to Centralized Controller
B-CFP8-M5-CH 0 & 1
DO1 DO2

Black

Red

Black

R1

Relay Box
Orange

R2 Fan Low Fan Hi

Brown

Orange

Red

Orange

Orange
Red R4
Green

Green

Red

Green

Fan Speed From ERV Control Board

AHU ERV fan interlock

Fan Speed To Motor

Note: R1 ­ ERV is controlled by centralized controller when energized R2 - When R1 is energized does High or Low Fan Speed Control, and isolates OEM fan speed control

Figure AIII-1: Wiring diagram of ERV interface to the centralized controller
B-CFP8-M5-CH 2 & 3
DO3 DO4

Red R3

GSHP
Red White

Relay Box
25V AC (R)
Yellow

White

A Manual Reversing Valve Control

C

A

C

Aquastat

Double pole Double throw switch A- Aquastat Control C- Centralized Control

Reversing Valve (O) Compressor Call (Y1)

White Green

Figure AIII-2: Wiring diagram of GSHP interface to the centralized controller 183

Red

ERV

Red

B-CFP8-M5-CH 4 to 7
DO 5 DO 6 DO 7 DO 8

Yellow Black

24 VDC R5 R6 Yellow Red
Orange Yellow Purple Brown Grey Green White White Black Blue

R7

R8

Basement Solenoid Valve

1st Floor Solenoid valve

24VDC signal sent to energize RA when either 1 or all 4 relays are energized (R5 ­ R8)

2nd Floor solenoid valve

3rd Floor solenoid valve

Uponor Input 4

Connector Block
+
FROM B-CFP8 RFH 24VDC TO SOLENOID

Purple Yellow Blue Orange Black White Brown Gray

+

3rd flr

+ + + +
Green
Solenoid Valves

+

+

2nd flr

+

+

1st flr

+

+

Pump

White

Uponor Local Control For Solenoids

Uponor Input 4

+24 VDC Black Black
- 24VDC

Black

Black

RA
Green Red

RA Energized when either on or all 4 relays are energized (R5,R6,R7,R8). It isolates the Uponor -24V from the rest of the circuit.

Figure AIII-3: Wiring diagram of RFH interface to the centralized controller

184

Pump Turns on when either 1 or all 4 relays are energized (R5,R6,R7,R8).

BSMT

Relay Box
Red DO 9 R9 Red

Y1 ­ 1st Floor Cooling Call

AHU

Red

White White DO 10 R10

Y2 ­ 2nd Floor Cooling Call RB

Red

B-CFP8 -M6-CH 0 to 3

Red/w DO 11 R11 Black

Y3 ­ 3rd Floor Cooling Call

RC

R13

White DO 13

Red

Green DO 12 R12 G1 ­ Continuous Fan Call Red
Black

RD
Green

Green

R 24 VAC

Uponor Input 3 Pump

When either 1 or all 4 relays are energized (R9 -R12) they energize a corresponding relay (RB ­ RD) which closes the Uponor pump contact for input 3 R13 acts as an override for (pump on) signals

Figure AIII-4: Wiring diagram of AHU interface to the centralized controller
B-CFP8-M6-CH5 DO 14

R14

R 24 VAC

Y Cooling/Heating Call

RE

Uponor Pump Control
Input 2 Output 2 ILAHU Pump

ILAHU

Figure AIII-5: Wiring diagram of ILAHU interface to the centralized controller 185

Circulator Signal

CFP-8-M6-CH4

Appendix IV: Controller Hardware Components and Inputs/Outputs Nomenclature

Table AIV-1: Components of the NI CFP based controller
Part Number NI 778617-08 NI 777317-2220 NI 777318-410 NI 777318-111 NI 777318-122 NI 778618-01 Dwyer RHT-W Omega 10-2-100-1/4-6-E finder 55.34.9.024.0090 finder 60.12.8.024.0040 Description cFP-BP-8 8-Slot Backplane cFP-2220 LabVIEW® Real-Time/Dual-Ethernet Controller 256 MB DRAM cFP-DO-410, Digital Output Module (V source, protected) cFP-AI-111 16 ch, 16-Bit Analog Input Module (mA) cFP-RTD-122, 16 Bit RTD Input Module (RTD, Ohms) cFP-CB-1 Connector Block Combined Humidity/Temperature Transmitter Module PT100 RTD Temperature Sensor Relays ­ 24 VDC Coil Relays ­ 24 VAC Coil Computer Quantity 2 1 2 2 1 5 5 1 15 3 1

Table AIV-2: Controller inputs nomenclature
Address B-CFP3-M1-CH0 B-CFP3-M1-CH1 B-CFP3-M1-CH2 B-CFP3-M1-CH3 B-CFP3-M1-CH4 B-CFP3-M1-CH5 B-CFP3-M1-CH6 B-CFP3-M1-CH7 B-CFP1-M7-CH8 B-CFP1-M7-CH9 B-CFP1-M7-CH0 Tag T72 RH25 T73 RH26 T74 RH27 T75 RH28 T76 RH29 T76 Function Measure temperature of 3rd floor Measure relative humidity of 3rd floor Measure temperature of 2nd floor Measure relative humidity of 2nd floor Measure temperature of 1st floor Measure relative humidity of 1st floor Measure temperature of basement Measure relative humidity of basement Measure temperature of ILS Measure relative humidity of ILS Measure temperature of BT water Input Type Temperature Sensor Relative Humidity Sensor Temperature Sensor Relative Humidity Sensor Temperature Sensor Relative Humidity Sensor Temperature Sensor Relative Humidity Sensor Temperature Sensor Relative Humidity Sensor Temperature Sensor

186

Table AIV-3: Controller outputs nomenclature
Address B-CFP8-M5-CH0 B-CFP8-M5-CH1 B-CFP8-M5-CH2 B-CFP8-M5-CH3 B-CFP8-M5-CH4 B-CFP8-M5-CH5 B-CFP8-M5-CH6 B-CFP8-M5-CH7 B-CFP8-M6-CH0 B-CFP8-M6-CH1 B-CFP8-M6-CH2 B-CFP8-M6-CH3 B-CFP8-M6-CH4 B-CFP8-M6-CH5 Tag DO1 DO2 DO3 DO4 DO5 DO6 DO7 DO8 DO9 DO10 DO11 DO12 DO13 DO14 Name R1 R2 R3 R4 R5 R6 R7 R8 R9 R10 R11 R12 R13 R14 Function ERV Switching to Remote Control ERV High or Low fan speed GSHP reverse valve GSHP Compressor call Basement Heating Call 1st Floor Heating Call 2nd Floor Heating Call 3rd Floor Heating Call AHU 1st Floor Cooling Call AHU 2nd Floor Cooling Call AHU 3rd Floor Cooling Call AHU Continuous Fan Call AHU Pump de-interlock ILAHU Control 00/10 - Low Speed, 01 - Off, 11 High Speed Heating = 1, Cooling = 0 Compressor On = 1, Off = 0 Heating On = 1, Off = 0

Cooling On = 1, Off = 0 Fan On = 1, Off = 0 Pump Off = 1, On = 0 Cooling/Heating On = 1, Off = 0

187

Bibliography
[1] ASHRAE handbook fundamentals: ASHRAE; 2009. [2] ASHRAE handbook heating, ventilating, and air-conditioning systems and equipment: ASHRAE; 2012. [3] ASHRAE handbook heating, ventilating, and air-conditioning applications: ASHRAE; 2011. [4] LeBrun J, Bourdouxhe J-P, Grodent M. HVAC1 toolkit: A toolkit for primary HVAC System energy calculation: ASHRAE; 1999. [5] Brandemuehl MJ, Gabel S, Andresen I. HVAC 2 toolkit: a toolkit for secondary HVAC system energy calculations: ASHRAE; 1993. [6] TRNSYS 16 A transient energy simulation program, Mathematical reference: Solar Energy Lab, University of Visconsin-Madison; 2005. [7] EnergyPlus engineering reference: The Reference to EnergyPlus Calculations: DOE; 2013. [8] Kelly G, Park C, Clark D, May W. HVACSIM+, A dynamic building/HVAC/control systems simulation program. Proc Workshop HVAC Controls Model Simul. Seattle, Washington, USA: IBPSA; 1984. p. 175-85. [9] Kalagasidis AS, Weitzmann P, Nielsen TR, Peuhkuri R, Hagentoft C-E, Rode C. The international building physics toolbox in Simulink®. Energy Build. 2007;39:665-74. [10] Husaunndee A, Lahrech R, Vaezi-Nejad H, Visier J. SIMBAD: A simulation toolbox for the design and test of HVAC control systems. Proc Build Simul. Prague, Czech Republic: IBPSA; 1997. p. 269-76. [11] Wemhöner C, Hafner B, Schwarzer K. Simulation of solar thermal systems with CARNOT blockset in the environment MATLAB® Simulink®. Proc Eurosun 2000 Conf. Copenhagen, Denmark: ISES; 2000. p. 1-6. [12] Kalagasidis AS. HAM-tools: An integrated simulation tool for heat, air and moisture transfer analyses in building physics [PhD Thesis]. Gothenburg, Sweden: Chalmers University of Technology 2004. [13] van Schijndel A, Hensen J. Integrated heat, air and moisture modeling toolkit in MATLAB®. Proc 9th Int IBPSA Conf. Montreal, QC, Canada: IBPSA; 2005. p. 1107-11. [14] Mendes N, Oliveira G, Araujo H, Coelho L. A MATLAB®-based simulation tool for building thermal performance analysis. Eighth Int IBPSA Conf. Eindhoven, Netherlands: IBPSA; 2003. p. 855-62. [15] Novak PR, Mendes N, Oliveira GH. Simulation of HVAC plants in 2 Brazilian cities using MATLAB®/Simulink®. Ninth Int IBPSA Conf. Montreal, QC, Canada: IBPSA; 2005. p. 859-66. [16] Singh J, Singh N, Sharma JK. Fuzzy modeling and control of HVAC systems - A review. J of Sci & Ind Res. 2006;65:470-6. [17] Trcka M, Hensen JLM. Overview of HVAC system simulation. Autom Constr. 2010;19:93-9. [18] Orosa JA, Oliveira AC. Software tools for HVAC research. Adv Eng Software. 2011;42:846-51. [19] Riederer P. MATLAB®/Simulink® for building and HVAC simulation-State of the art. Ninth Int IBPSA Conf. Montreal, QC, Canada: IBPSA; 2005. p. 1019-26. [20] Bi Q, Cai W-J, Wang Q-G, Hang C-C, Lee E-L, Sun Y, et al. Advanced controller auto-tuning and its application in HVAC systems. Control Eng Pract. 2000;8:633-44. [21] Rehrl J, Horn M. Temperature control for HVAC systems based on exact linearization and model predictive control. Int Conf Control Appl (CCA). Denver, Colorado, USA: IEEE; 2011. p. 1119-24. [22] Huang G. Model predictive control of VAV zone thermal systems concerning bi-linearity and gain nonlinearity. Control Eng Pract. 2011;19:700-10. [23] Huang G, Wang S, Xu X. Robust model predictive control of VAV air-handling units concerning uncertainties and constraints. HVAC R Res. 2010;16:15-33.

188

[24] Wang S, Xu X, Huang G. Robust MPC for temperature control of air-conditioning systems concerning on constraints and multitype uncertainties. Build Serv Eng Res Technol. 2010;31:39-55. [25] Kalogirou SA. Artificial neural networks and genetic algorithms in energy applications in buildings. Adv Build Energy Res. 2009;3:83-120. [26] Kusiak A, Li M, Zhang Z. A data-driven approach for steam load prediction in buildings. Appl Energy. 2010;87:925-33. [27] Chen J, Lian Z, Tan L, Zhu W, Zhang W. Modeling and experimental research on ground-source heat pump in operation by neural network. Int Conf Comput Distrib Control Intell Environ Monit (CDCIEM). Changsha, China: IEEE; 2011. p. 459-62. [28] Tang F. HVAC system modeling and optimization: A data-mining approach [MSc Thesis]. Iowa City, IA, United States: The University of Iowa; 2010. [29] Kusiak A, Xu G. Modeling and optimization of HVAC systems using a dynamic neural network. Energy. 2012;42:241-50. [30] Morisot O, Marchio D. Fault detection and diagnosis on HVAC variable air volume system using artificial neural network. Proc IBPSA Build Simul. Kyoto, Japan: IBPSA; 1999. p. 1027-34. [31] Ding L, Lv J, Li X, Li L. Support vector regression and ant colony optimization for HVAC cooling load prediction. Int Symp Comput Commun Control Autom (3CA). Tainan, Taiwan: IEEE; 2010. p. 537-41. [32] Li X, Ding L, Deng Y, Li L. Hybrid support vector machine and ARIMA model in building cooling prediction. Int Symp Comput Commun Control Autom (3CA). Tainan, Taiwan: IEEE; 2010. p. 533-6. [33] Li X, Ding L, Lv J, Xu G, Li J. A novel hybrid approach of KPCA and SVM for building cooling load prediction. Third Int Conf Knowl Discovery Data Min (WKDD) Phuket, Thailand: IEEE; 2010. p. 522-6. [34] Li X, Ding L, Li L. A novel building cooling load prediction based on SVR and SAPSO. Int Symp Comput Commun Control Autom (3CA). Tainan, Taiwan: IEEE; 2010. p. 528-32. [35] Pal A, Mudi R. Self-tuning fuzzy PI controller and its applications to HVAC systems. Int j of comput cogn. 2008;6:25-30. [36] Chen K, Jiao Y, Lee ES. Fuzzy adaptive networks in thermal comfort. Appl Math Lett. 2006;19:420-6. [37] Lü H, Jia L, Kong S, Zhang Z. Predictive functional control based on fuzzy T-S model for HVAC systems temperature control. J of Control Theory and Appl. 2007;5:94-8. [38] Homod RZ, Sahari KSM, Almurib HAF, Nagi FH. RLF and TS fuzzy model identification of indoor thermal comfort based on PMV/PPD. Build Environ. 2012;49:141-53. [39] Soyguder S, Alli H. Predicting of fan speed for energy saving in HVAC system based on adaptive network based fuzzy inference system. Expert Syst Appl. 2009;36:8631-8. [40] Li K, Su H, Chu J. Forecasting building energy consumption using neural networks and hybrid neuro-fuzzy system: A comparative study. Energy Build. 2011;43:2893-9. [41] Yiu CMJ. Statistical modelling and forecasting schemes for air-conditioning system [PhD Thesis]. Hung Hom, Kowloon, Hong Kong: The Hong Kong Polytechnic University; 2008. [42] Safa AA. Performance analysis of a two-stage variable capacity air source heat pump and a horizontal loop coupled ground source heat pump system [MSc Thesis]. Toronto, ON, Canada: Ryerson University; 2012. [43] Dong B, O'Neill Z, Luo D, Trevor B. Development and calibration of a reduced-order energy performance model for a mixed-use building. Proc BS2013: 13th Conf Int Build Perform Simul Assoc. Chambery, France: IBPSA; 2013. p. 636-43. [44] Virk GS, Loveday DL. Model-based control for HVAC applications. Proc Third IEEE Conf Control Appl. Glasgow, Scotland: IEEE; 1994. p. 1861-6.

189

[45] Ma J, Qin SJ, Li B, Salsbury T. Economic model predictive control for building energy systems. Innovative Smart Grid Technol (ISGT). California, USA: IEEE; 2011. p. 1-6. [46] Huh J-H, Brandemuehl MJ. Optimization of air-conditioning system operating strategies for hot and humid climates. Energy Build. 2008;40:1202-13. [47] Penya YK, Borges CE, Agote D, Fernandez I. Short-term load forecasting in air-conditioned nonresidential Buildings. Int Symp Ind Electron (ISIE). Gdansk, Poland: IEEE; 2011. p. 1359-64. [48] Ferkl L, Siroky J. Ceiling radiant cooling: Comparison of ARMAX and subspace identification modelling methods. Build Environ. 2010;45:205-12. [49] Nishiguchi J, Konda T, Dazai R. Data-driven optimal control for building energy conservation. Proc SICE Annu Conf. Taipei, Taiwan: IEEE; 2010. p. 116-20. [50] Watson I. A case study of maintenance of a commercially fielded casebased reasoning system. Comput Intell. 2001;17:387-98.

[51] Zlatanovic I, Gligorevic K, Ivanovic S, Rudonja N. Energy-saving estimation model for hypermarket HVAC systems applications. Energy Build. 2011;43:3353-9.

[52] Iino Y, Murai M, Murayama D, Motoyama I, Kuzusaka S, Ueta K. Hybrid modeling with physical and JIT model for building thermal load prediction and optimal energy saving control. ICCAS-SICE. Fukuoka, Japan: IEEE; 2009. p. 2008-11. [53] Tashtoush B, Molhim M, Al-Rousan M. Dynamic model of an HVAC system for control analysis. Energy. 2005;30:1729-45. [54] Herzog S, Atabay D, Jungwirth J, Mikulovic V. Self-adapting building models for model predictive control. Proc BS2013: 13th Conf Int Build Perform Simul Assoc. Chambery, France: IBPSA; 2013. p. 2489-93. [55] Thosar A, Patra A, Bhattacharyya S. Feedback linearization based control of a variable air volume air conditioning system for cooling applications. ISA Trans. 2008;47:339-49. [56] Wu S, Sun J-Q. A physics-based linear parametric model of room temperature in office buildings. Build Environ. 2012;50:1-9. [57] Homod RZ. Review on the HVAC system modeling types and the shortcomings of their application. J Energy. 2013;2013:1-10. [58] Energy estimating and modeling methods. ASHRAE handbook fundamentals: ASHRAE; 2009. [59] Tahersima F, Stoustrup J, Rasmussen H, Nielsen PG. Thermal analysis of an HVAC system with TRV controlled hydronic radiator. Conf Autom Sci Eng (CASE). Toronto, ON, Canada: IEEE; 2010. p. 756-61. [60] Pedersen CO. A fundamental approach to cooling load calculations for UFADS and stratified spaces. Eleventh Int IBPSA Conf. Glasgow, Scotland: IBPSA; 2009. p. 704-8. [61] Mossolly M, Ghali K, Ghaddar N. Optimal control strategy for a multi-zone air conditioning system using a genetic algorithm. Energy. 2009;34:58-66. [62] Beghi A, Cecchinato L, Paggiaro F, Rampazzo M. VAVAC systems modeling and simulation for FDD applications. Int Conf Control Autom (ICCA). Santiago, Chile: IEEE; 2011. p. 800-5. [63] Zajic I, Larkowski T, Sumislawska M, Burnham KJ, Hill D. Modelling of an air handling unit: A hammerstein-bilinear model identification approach. 21st Int Conf Syst Eng (ICSEng). Las Vegas, NV, USA: IEEE; 2011. p. 59-63. [64] van Schijndel AWM, Schellen HL, Timmermans WJ. Simulation of the climate system performance of a museum in case of failure events. Energy Build. 2010;42:1790-6. [65] Tahmasebi F, Zach R, Schub M, Mahdavi A. Simulation model calibration: an optimization-based approach. Fourth German-Austrian IBPSA Conf. Berlin, Germany: IBPSA; 2012. p. 386-91.

190

[66] Pascual JAF, Garay RS, Torrens JI, Keane MM. Heat ventilation and air conditioning modelling for model based fault detection and diagnosis. Proc BS2013: 13th Conf Int Build Perform Simul Assoc. Chambery, France: IBPSA; 2013. p. 3513-20. [67] Matsushita N, Yoshida H, Suzuki H. Application of the air-conditioning system energy simulation for commissioning (ACSES/CX) tool to HVAC system commissioning Part 2: Application to the substation of a heat source system with bleed-in control. 13th Conf Int Build Performe Simul Assoc. Chambery, France: IBPSA; 2013. p. 1778-85. [68] Jin G-Y, Ding X-D, Tan P-Y, Koh T-M. A hybrid water-cooled centrifugal chiller model. Conf Ind Electron Appl (ICIEA). Beijing, China: IEEE; 2011. p. 2298-303. [69] Wemhoff AP, Frank MV. Predictions of energy savings in HVAC systems by lumped models. Energy Build. 2010;42:1807-14. [70] Cui P, Yang H, Spitler JD, Fang Z. Simulation of hybrid ground-coupled heat pump with domestic hot water heating systems using HVACSIM. Energy Build. 2008;40:1731-6. [71] Yan X, Ren Q, Meng Q. Global optimization of VAV air conditioning system. 8th World Congr Intell Control Autom (WCICA). Jinan, China: IEEE; 2010. p. 5077-81. [72] Dong B. Non-linear optimal controller design for building HVAC systems. Int Conf Control Appl (CCA). Yokohama, Japan: IEEE; 2010. p. 210-5. [73] Ma Y, Borrelli F, Hencey B, Packard A, Bortoff S. Model predictive control of thermal energy storage in building cooling systems. Proc 48th IEEE Conf Decis Control. Shanghai, China: IEEE; 2009. p. 392-7. [74] Burhenne S, Radon J, Pazold M, Herkel S, Antretter F. Integration of HVAC models into a hygrothermal whole building simulation tool. Proc of Build Simul 2011: 12th Conf Int Build Perform Simul Assoc. Sydney, Australia: IBPSA; 2011. p. 1777-83. [75] Energy estimating and modeling methods. Handbook Fundamentals: American Society of Heating, Refrigerating and Air-Conditioning Engineers; 2009. p. 19.1-.39. [76] Mi-Hyun P, Eun-Gyeong S, Heung-Reol L, In-Soo S. Dynamic model and control algorithm of HVAC system for OLEV® application. International Conference on Control Automation and Systems (ICCAS). Gyeonggi-do, Korea: IEEE; 2010. p. 1312-7. [77] Sreedharan P, Haves P. Comparison of chiller models for use in model-based fault detection. Int Conf Enhanced Build Oper. Austin, Texas, United States2001. p. 1-10. [78] Yuan Y, Cao X, Sun L, Lei B, Yu N. Ground source heat pump system: A review of simulation in China. Renewable Sustainable Energy Rev. 2012;16:6814. [79] Xu X. Simulation and optimal control of hybrid ground source heat pump systems [PhD Thesis]. Stillwater, Oklahoma, USA: Oklahoma State University; 2007. [80] Jin H. Parameter estimation based models of water source heat pumps [PhD Thesis]. Stillwater, Oklahoma, USA: Oklahoma State University; 2002. [81] Jin G-Y, Cai W-J, Lu L, Lee EL, Chiang A. A simplified modeling of mechanical cooling tower for control and optimization of HVAC systems. Energy Convers Manag. 2007;48:355-65. [82] Vakiloroaya V, Samali B, Madadnia J, Ha QP. Component-wise optimization for a commercial central cooling plant. 37th Ann Conf IEEE Ind Electron Soc (IECON). Melbourne, Victoria, Australia: IEEE; 2011. p. 2769-74. [83] Li J, Poulton G, Platt G, Wall J, James G. Dynamic zone modelling for HVAC system control. Int J of Model, Identif and Control. 2010;9:5-13. [84] Balan R, Cooper J, Chao K-M, Stan S, Donca R. Parameter identification and model based predictive control of temperature inside a house. Energy Build. 2011;43:748-58.

191

[85] Leclere J, Wurtz F, Wurtz E. A low order envelope model for otimised predictive control of indoor temperature: development methodology and calibration with a numerical model. Proc BS2013: 13th Conf Int Build Perform Simul Assoc. Chambery, France: IBPSA; 2013. p. 2341-8. [86] Liyan J, Zhe Y, Murphy-Hoye MC, Pratt A, Piccioli EG, Lang T. Multi-scale stochastic optimization for home energy management. 4th IEEE Int Workshop on Comput Adv Multi-Sens Adapt Process (CAMSAP). San Juan, Puerto Rico: IEEE; 2011. p. 113-6. [87] Hariharan N, Rasmussen BP. Parameter estimation for dynamic HVAC models with limited sensor information. Am Control Conf (ACC). Baltimore, Maryland, USA: IEEE; 2010. p. 5886-91. [88] Jin G-Y, Tan P-Y, Ding X-D, Koh T-M. Cooling coil unit dynamic control of in HVAC system. Conf Ind Electron Appl (ICIEA). Beijing, China: IEEE; 2011. p. 942-7. [89] Jin G-Y, Cai W-J, Wang Y-W, Yao Y. A simple dynamic model of cooling coil unit. Energy Convers Manag. 2006;47:2659-72. [90] Berardino J, Nwankpa C. Dynamic load modeling of an HVAC chiller for demand response applications. First IEEE Int Conf Smart Grid Commun (SmartGridComm). Gaithersburg, Maryland, USA: IEEE; 2010. p. 108-13. [91] Kumar M, Kar IN. Non-linear HVAC computations using least square support vector machines. Energy Convers Manag. 2009;50:1411-8. [92] Mustafaraj G, Chen J, Lowry G. Thermal behaviour prediction utilizing artificial neural networks for an open office. Appl Math Model. 2010;34:3216-30. [93] Henze GP, Felsmann C, Kalz DE, Knabe G. Impact of forecasting accuracy on predictive optimal control of active and passive building thermal storage inventory. HVAC R Res. 2004;10:153-78. [94] Tahmasebi F, Mahdavi A. A two-staged simulation model calibration approach to virtual sensors for building performance data. Proc BS2013: 13th Conf Int Build Perform Simul Assoc. Chambery, France: IBPSA; 2013. p. 608-13. [95] Casella G, Berger RL. Statistical inference: Duxbury Press Belmont, CA; 1990. [96] ASHRAE. Standard 140-2011 Standard method of test for the evaluation of building energy analysis computer programs. 2011. [97] Ron J, Joel N. Model validation and testing: The methodological foundation of ASHRAE standard 140. ASHRAE 2006 Annu Meeting. Quebec City, Canada: ASHRAE; 2006. p. 367-79. [98] Judkoff R, Neymark J. Home energy rating system building energy simulation test (HERS BESTEST): Volume 1, Tier 1 and Tier 2 tests user's manual. Golden, Colorado, USA: NREL; 1995. [99] ISO. ISO 13792:2012 Thermal performance of buildings - Calculation of internal temperatures of a room in summer without mechanical cooling - Simplified methods. 2012. [100] ISO. ISO 13791:2012 Thermal performance of buildings - Calculation of internal temperatures of a room in summer without mechanical cooling - General criteria and validation procedures. 2012. [101] Annual energy outlook 2012 early release. Energy Information Administration (EIA); 2012. [102] Energy Efficienty Trends in Canada 1990 to 2009. Natural Resources Canada; 2011. [103] ASHRAE. Handbook-fundamentals: American Society of Heating, Refrigerating Air-Conditioning, Engineers; 2009. [104] Afram A, Janabi-Sharifi F. Review of modeling methods for HVAC systems. Applied Thermal Engineering. 2014;67:507-19. [105] Henze GP, Kalz DE, Liu S, Felsmann C. Experimental analysis of model-based predictive optimal control for active and passive building thermal storage inventory. HVAC R Res. 2005;11:189-213.

192

[106] Ma J, Qin J, Salsbury T, Xu P. Demand reduction in building energy systems based on economic model predictive control. Chem Eng Sci. 2011;67:92-100. [107] Candanedo JA, Athienitis AK. Predictive control of radiant floor heating and solar-source heat pump operation in a solar house. HVAC R Res. 2011;17:235-56. [108] Karlsson H, Hagentoft C-E. Application of model based predictive control for water-based floor heating in low energy residential buildings. Build Environ. 2011;46:556-69. [109] Morosan P-D, Bourdais R, Dumur D, Buisson J. Building temperature regulation using a distributed model predictive control. Energy Build. 2010;42:1445-52. [110] Barbosa RM, Mendes N. Combined simulation of central HVAC systems with a whole-building hygrothermal model. Energy Build. 2008;40:276-88. [111] Tariku F, Kumaran K, Fazio P. Determination of indoor humidity profile using a whole-building hygrothermal model. Build Simul. 2011;4:61-78. [112] Li Q. Development of a hygrothermal simulation tool (HAM-BE) for building envelope study [PhD Thesis]. Montreal, QC, Canada: Concordia University; 2008. [113] Mendes N, Barbosa RM, Freire RZ, Oliveira RCLF. A simulation environment for performance analysis of HVAC systems. Build Simul. 2008;1:129-43. [114] Chen Y, Treado S. Development of a simulation platform based on dynamic models for HVAC control analysis. Energy Build. 2014;68:376-86. [115] Ghiaus C, Chicinas A, Inard C. Grey-box identification of air-handling unit elements. Control Eng Pract. 2007;15:421-33. [116] Siemann M. Performance and applications of residential building energy grey-box models [PhD Thesis]. College Park, MD, USA: University of Maryland; 2013. [117] Braun J, Chaturvedi N. An inverse gray-box model for transient building load prediction. HVAC R Res. 2002;8:73-99. [118] Nyika S. Development, validation, and application of general gray-box models for ductless and ducted residential heat pumps [MSc Thesis]. West Lafayette, IN, USA: Purdue University; 2013. [119] Hariharan N, Hariharan N, Rasmussen BP, Rasmussen BP. Parameter estimation for dynamic HVAC models with limited sensor information. Am Control Conf (ACC). Baltimore, MD, USA: IEEE; 2010. p. 588691. [120] Yao Y, Huang M, Mo J, Dai S. State-space model for transient behavior of water-to-air surface heat exchanger. Int J of Heat Mass Transfer. 2013;64:173-92. [121] Yao Y, Yang K, Huang M, Wang L. A state-space model for dynamic response of indoor air temperature and humidity. Build Environ. 2013;64:26-37. [122] Yao Y, Huang M, Chen J. State-space model for dynamic behavior of vapor compression liquid chiller. Int J Refrig. 2013;36:2128-47. [123] Zhang D, Barua R, Fung AS. TRCA-BILD Archetype Sustainable House-Overview of Monitoring System and Preliminary Results for Mechanical Systems. ASHRAE Trans. 2011;117:597-612. [124] Dembo A, Fung A, Ng KLR, Pyrka A. The Archetype Sustainable House: Investigating its potentials to achieving the net-zero energy status based on the results of a detailed energy audit. 1st Int High Perform Build Conf. West Lafayette, IN, USA: Purdue University; 2010. p. 32471-8. [125] Tanha K. Evaluating the performance of two solar domestic hot water systems of the archetype sustainable houses [MASc Thesis]. Toronto, ON, Canada: Ryerson University; 2011. [126] Barua R. Assessment and energy benchmarking for two archetype sustainable houses through comprehensive long term monitoring [MASc Thesis]. Toronto, ON, Canada: Ryerson University; 2010.

193

[127] Safa AA, Fung AS, Kumar R. Comparative thermal performances of a ground source heat pump and a variable capacity air source heat pump systems for sustainable houses. Applied Thermal Engineering. 2015;81:279-87. [128] Weiss MVG. Adaptive neuro energy management control strategies for HVAC systems in buildings [MASc Thesis]. Montreal, QC, Canada: Concordia University; 2006. [129] Wang S, Ma Z. Supervisory and optimal control of building HVAC systems: A review. HVAC R Res. 2008;14:3-32. [130] Afram A, Janabi-Sharifi F. Theory and applications of HVAC control systems ­ A review of model predictive control (MPC). Build Environ. 2014;72:343-55. [131] Zhang J, Fung AS, Jhingan S. Analysis and feasibility study of residential integrated heat and energy recovery ventilator with built-in economizer using an excel spreadsheet program. Energy and Buildings. 2014;75:430-8. [132] Zhang J, Fung AS. Experimental and numerical investigation of the thermal impact of defrost cycle of residential heat and energy recovery ventilators. Energy and Buildings. 2015;97:129-36. [133] Zhang J, Fung AS. Experimental study and analysis of an energy recovery ventilator and the impacts of defrost cycle. Energy and Buildings. 2015;87:265-71. [134] Safa AA, Fung AS, Kumar R. Performance of two-stage variable capacity air source heat pump: Field performance results and TRNSYS simulation. Energy and Buildings. 2015;94:80-90. [135] Safa AA, Fung AS, Leong WH. Part Load Performance of a Two-Stage Variable Capacity Air Source Heat Pump System in Cooling Mode. ASHRAE Trans. 2011;117:158. [136] Safa AA, Fung AS, Kumar R. Heating and cooling performance characterisation of ground source heat pump system by testing and TRNSYS simulation. Renewable Energy. 2015;83:565-75. [137] Henze GP, Dodier RH, Krarti M. Development of a predictive optimal controller for thermal energy storage systems. HVAC R Res. 1997;3:233-64. [138] Naidu DS, Rieger CG. Advanced control strategies for heating, ventilation, air-conditioning, and refrigeration systems - An overview: Part I: Hard control. HVAC R Res. 2011;17:2-21. [139] Platt G, Ward J, Wall J. Optimal supervisory HVAC control: Experiences in Australia. HVAC R Res. 2011;17:297-308. [140] Katipamula S, Lu N. Evaluation of residential HVAC control strategies for demand response programs. ASHRAE Trans. 2006;112:535-46. [141] Canbay CS. Optimization of HVAC control strategies by building management systems case study: Ozdilek shopping center [MSc Thesis]. Izmir, Turkey: Izmir Institute of Technology; 2003. [142] Hart R. Advanced unitary HVAC control sequence. ASHRAE Trans. 2012;118:628-35. [143] Hart R, Callahan JM, Anderson K, Johanning P. Unitary HVAC premium ventilation upgrade. ASHRAE Trans. 2011;117:517-24. [144] Naidu DS, Rieger CG. Advanced control strategies for HVAC&R systems - An overview: Part II: Soft and fusion control. HVAC R Res. 2011;17:144-58. [145] Al-Rabghi OM, Akyurt MM. A survey of energy efficient strategies for effective air conditioning. Energy Convers Manag. 2004;45:1643-54. [146] Yao Y, Chen J. Global optimization of a central air-conditioning system using decomposition­ coordination method. Energy Build. 2010;42:570-83. [147] Zhang J, Zhang K. A particle swarm optimization approach for optimal design of PID controller for temperature control in HVAC. Int Conf Meas Technol Mechatron Autom (ICMTMA). Shanghai, China: IEEE; 2011. p. 230-3.

194

[148] Bai J, Wang S, Zhang X. Development of an adaptive Smith predictor-based self-tuning PI controller for an HVAC system in a test room. Energy Build. 2008;40:2244-52. [149] Bai J, Zhang X. A new adaptive PI controller and its application in HVAC systems. Energy Convers Manag. 2007;48:1043-54. [150] Kulkarni MR, Hong F. Energyoptimal control of a residential space-conditioning system based on sensible heat transfer modeling. Build Environ. 2004;39:31-8. [151] Anderson M, Buehner M, Young P, Hittle D, Anderson C, Jilin T, et al. MIMO robust control for HVAC systems. IEEE Tran Control Syst Technol. 2008;16:475-83. [152] Henze GP, Felsmann C, Knabe G. Evaluation of optimal control for active and passive building thermal storage. Int J Therm Sci. 2004;43:173-83. [153] Gouda MM, Danaher S, Underwood CP. Thermal comfort based fuzzy logic controller. Build Serv Eng Res Technol. 2001;22:237-53. [154] Homod RZ, Sahari KSM, Almurib HAF, Nagi FH. Gradient auto-tuned Takagi-Sugeno Fuzzy Forward control of a HVAC system using predicted mean vote index. Energy Build. 2012;49:254-67. [155] Shepherd AB, Batty WJ. Fuzzy control strategies to provide cost and energy efficient high quality indoor environments in buildings with high occupant densities. Build Serv Eng Res Technol. 2003;24:35-45. [156] Soyguder S, Karakose M, Alli H. Design and simulation of self-tuning PID-type fuzzy adaptive control for an expert HVAC system. Expert Syst Appl. 2009;36:4566-73. [157] Gouda MM, Danaher S, Underwood CP. Quasi-adaptive fuzzy heating control of solar buildings. Build Environ. 2006;41:1881-91. [158] Tsai C-C, Tsai K-I, Su C-T. Cascaded fuzzy-PID control using PSO-EP algorithm for air source heat pumps. Int Conf Fuzzy Theory Appl (iFUZZY). Taichung, Taiwan: IEEE; 2012. p. 163-8. [159] Elliott MS. Decentralized model predictive control of a multiple evaporator HVAC system [MSc Thesis]. College Station, TX, United States: Texas A&M University; 2008. [160] Halvgaard R, Poulsen NK, Madsen H, Jorgensen JB. Economic model predictive control for building climate control in a smart grid. Innovative Smart Grid Technol (ISGT). Washington, DC, USA: IEEE; 2012. p. 1-6. [161] Aswani A, Master N, Taneja J, Krioukov A, Culler D, Tomlin C. Energy-Efficient building HVAC control using hybrid system LBMPC. arXiv preprint arXiv:12044717. 2012:1-7. [162] Ma Y, Borrelli F, Hencey B, Coffey B, Benga S, Haves P. Model predictive control for the operation of building cooling systems. IEEE Tran Control Syst Technol. 2012;20:796-803. [163] Aswani A, Master N, Taneja J, Culler D, Tomlin C. Reducing transient and steady state electricity consumption in HVAC using learning-based model-predictive control. Proc of the IEEE. 2012;100:240-53. [164] Oldewurtel F, Parisio A, Jones CN, Gyalistras D, Gwerder M, Stauch V, et al. Use of model predictive control and weather forecasts for energy efficient building climate control. Energy Build. 2012;45:15-27. [165] Afram A, Janabi-Sharifi F. Gray-box modeling and validation of residential HVAC system for control system design. Applied Energy. 2015;137:134-50. [166] Perez-Lombard L, Ortiz J, Pout C. A review on buildings energy consumption information. Energy Build. 2008;40:394-8. [167] Annual energy outlook 2012 early release. Energy Information Administration (EIA); 2012. [168] Jette I, Zaheer-uddin M, Fazio P. PI-control of dual duct systems: manual tuning and control loop interaction. Energy Convers Manag. 1998;39:1471-82. [169] Moradi H, Saffar-Avval M, Bakhtiari-Nejad F. Nonlinear multivariable control and performance analysis of an air-handling unit. Energy Build. 2011;43:805-13.

195

[170] Yuan S, Perez R. Multiple-zone ventilation and temperature control of a single-duct VAV system using model predictive strategy. Energy Build. 2006;38:1248-61. [171] Rieger CG. Advanced control strategies for HVAC systems in critical building structures [PhD Thesis]. Pocatello, Idaho, United States: Idaho State University; 2008. [172] Zaheer-uddin M, Tudoroiu N. Neuro-PID tracking control of a discharge air temperature system. Energy Convers Manag. 2004;45:2405-15. [173] Afram A, Janabi-Sharifi F. Review of modeling methods for HVAC systems. Appl Therm Eng. 2014;67:507-19. [174] Mirinejad H, Welch KC, Spicer L. A review of intelligent control techniques in HVAC systems. Energytech. Cleveland, Ohio, USA: IEEE; 2012. p. 1-5. [175] Dounis AI, Caraiscos C. Advanced control systems engineering for energy and comfort management in a building environment - A review. Renew Sust Energ Rev. 2009;13:1246-61. [176] Bansal RC, Pandey JC. Load forecasting using artificial intelligence techniques: a literature survey. Int J Comput Appl Technol. 2005;22:109-19. [177] Metaxiotis K, Kagiannas A, Askounis D, Psarras J. Artificial intelligence in short term electric load forecasting: a state-of-the-art survey for the researcher. Energy Convers Manag. 2003;44:1525-34. [178] Harrold MV, Lush DM. Automatic controls in building services. IEE Proc B Electr Power Appl. 1988;135:105-33. [179] Astrom KJ. Theory and applications of adaptive control - A survey. Autom. 1983;19:471-86. [180] Soyguder S, Alli H. An expert system for the humidity and temperature control in HVAC systems using ANFIS and optimization with Fuzzy Modeling Approach. Energy Build. 2009;41:814-22. [181] Pal AK, Mudi RK. Self-tuning fuzzy PI controller and its applications to HVAC systems. Int J of Comput Cogn. 2008;6:25-30. [182] Xu M, Li S, Cai W. Practical receding-horizon optimization control of the air handling unit in HVAC systems. Ind Eng Chem Res. 2005;44:2848-55. [183] Lim D, Rasmussen BP, Swaroop D. Selecting PID control gains for nonlinear HVAC&R systems. HVAC R Res. 2009;15:991-1019. [184] Wang Y-G, Shi Z-G, Cai W-J. PID autotuner and its application in HVAC systems. Am Control Conf. Arlington, Virginia, USA: IEEE; 2001. p. 2192-6. [185] Salsbury TI. A survey of control technologies in the building automation industry. Proc IFAC 16th World Congr. Prague, Czech Republic2005. p. 1396-. [186] Hodgson DA. Investigation of a nonlinear controller that combines steady state predictions with integral action [PhD Thesis]. Fort Collins, Colorado, United States: Colorado State University; 2010. [187] Pasgianos GD, Arvanitis KG, Polycarpou P, Sigrimis N. A nonlinear feedback technique for greenhouse environmental control. Comput Electron Agric. 2003;40:153-77. [188] Al-Assadi SAK, Patel RV, Zaheer-uddin M, Verma MS, Breitinger J. Robust decentralized control of HVAC systems using H-performance measures. J Franklin Inst. 2004;341:543-67. [189] Greensfelder EM, Henze GP, Felsmann C. An investigation of optimal control of passive building thermal storage with real time pricing. J Building Perform Simul. 2011;4:91-104. [190] Yan Y, Zhou J, Lin Y, Yang W, Wang P, Zhang G. Adaptive optimal control model for building cooling and heating sources. Energy Build. 2008;40:1394-401. [191] Sun J, Reddy A. Optimal control of building HVAC&R systems using complete simulation-based sequential quadratic programming (CSB-SQP). Build Environ. 2005;40:657-69.

196

[192] Yu Z, Dexter A. Hierarchical fuzzy control of low-energy building systems. Solar Energy. 2010;84:53848. [193] Liang J, Du R. Thermal comfort control based on neural network for HVAC application. Conf Control Appl. Toronto, Canada: IEEE; 2005. p. 819-24. [194] Ben-Nakhi AE, Mahmoud MA. Energy conservation in buildings through efficient A/C control using neural networks. Appl Energy. 2002;73:5-23. [195] Henze GP, Hindman RE. Control of air-cooled chiller condensor fans using clustering neural networks. ASHRAE Trans. 2002;108:232-44. [196] Li X, Shi Z, Hu S. A novel control method of a variable volume air conditiong system for indoor thermal environment. Int Conf Comput Eng Technol (ICCET). Chengdu, China: IEEE; 2010. p. V2-566-V2-70. [197] Salsbury TI. A new pulse modulation adaptive controller (PMAC) applied to HVAC systems. Control Eng Pract. 2002;10:1357-70. [198] Seem JE. A new pattern recognition adaptive controller with application to HVAC systems. Autom. 1998;34:969-82. [199] Zaheer-uddin M, Al-Assadi SAK, Patel RV. Decentralized preview control for multiple disturbance rejection in HVAC systems. Control Eng Pract. 1994;2:989-1000. [200] Cho SH, Zaheer-uddin M. An experimental study of multiple parameter switching control for radiant floor heating systems. Energy. 1999;24:433-44. [201] Henze GP, Schoenmann J. Evaluation of reinforcement learning control for thermal energy storage systems. HVAC R Res. 2003;9:259-75. [202] Liu S, Henze GP. Experimental analysis of simulated reinforcement learning control for active and passive building thermal storage inventory. Energy Build. 2006;38:148-61. [203] Siroky J, Oldewurtel F, Cigler J, Privara S. Experimental analysis of model predictive control for an energy efficient building heating system. Appl Energy. 2011;88:3079-87. [204] Privara S, Siroky J, Ferkl L, Cigler J. Model predictive control of a building heating system: The first experience. Energy Build. 2011;43:564-72. [205] Xi X-C, Poo A-N, Chou S-K. Support vector regression model predictive control on a HVAC plant. Control Eng Pract. 2007;15:897-908. [206] Xu M, Li S. Practical generalized predictive control with decentralized identification approach to HVAC systems. Energy Convers Manag. 2007;48:292-9. [207] Wallace M, McBride R, Aumi S, Mhaskar P, House J, Salsbury T. Energy efficient model predictive building temperature control. Chem Eng Sci. 2012;69:45-58. [208] Lefort A, Bourdais R, Ansanay-Alex G, Gueguen H. Hierarchical control method applied to energy management of a residential house. Energy Build. 2013;64:53-61. [209] Huang G, Wang S, Xu X. A robust model predictive control strategy for improving the control performance of air-conditioning systems. Energy Convers Manag. 2009;50:2650-8. [210] Zhou G, Krarti M, Henze GP. Parametric analysis of active and passive building thermal storage utilization. J Sol Energy Eng. 2005;127:37-46. [211] Florita AR, Henze GP. Comparison of short-term weather forecasting models for model predictive control. HVAC R Res. 2009;15:835-53. [212] Vasak M, Starcic A, Martincevic A. Model predictive control of heating and cooling in a family house. Proc 34th Int Convention MIPRO. Opatija, Croatia: IEEE; 2011. p. 739-43. [213] Atthajariyakul S, Leephakpreeda T. Real-time determination of optimal indoor-air condition for thermal comfort, air quality and efficient energy usage. Energy Build. 2004;36:720-33.

197

[214] Xu P, Xu T, Shen P. Advancing evaporative rooftop packaged air conditioning: A new design and performance model development. Appl Therm Eng. 2012;40:8-17. [215] Matlab®. Signal smoothing. Signal Processing Toolbox: MathWorks; 2013. [216] Maasoumy MH. Modeling and optimal control algorithm design for HVAC systems in energy efficient buildings [MSc Thesis]. Berkeley, California, United States: University of California at Berkeley; 2011. [217] Henze GP, Yuill DP, Coward AH. Development of a model predictive controller for tankless water heaters. HVAC R Res. 2009;15:3-23. [218] Fong KF, Hanby VI, Chow TT. A robust evolutionary algorithm for HVAC engineering optimization. HVAC R Res. 2008;14:683-705. [219] Zou Q, Ji J, Zhang S, Shi M, Luo Y. Model predictive control based on particle swarm optimization of greenhouse climate for saving energy consumption. World Autom Congr (WAC). Kobe, Japan: IEEE; 2010. p. 123-8. [220] Molina D, Lu C, Sherman V, Harley R. Model predictive and genetic algorithm based optimization of residential temperature control in the presence of time-varying electricity prices. Ind Appl Soc Annu Meeting (IAS). Orlando, Florida, USA: IEEE; 2011. p. 1-7. [221] Aggelogiannaki E, Sarimveis H. A simulated annealing algorithm for prioritized multiobjective optimization - Implementation in an adaptive model predictive control configuration. IEEE Trans on Syst Man Cybern Part B (Cybern). 2007;37:902-15. [222] Zhang X, Fong KF, Yuen SY. A novel artificial bee colony algorithm for HVAC optimization problems. HVAC R Res. 2013. [223] Ha LD, Ploix S, Zamai E, Jacomino M. Tabu search for the optimization of household energy consumption. Int Conf Inf Reuse Integr. Waikoloa Village, Hawai, USA: IEEE; 2006. p. 86-92. [224] Geem ZW, Kim JH, Loganathan GV. A new heuristic optimization algorithm: harmony search. Simul. 2001;76:60-8. [225] Coelho LdS, Mariani VC. Improved firefly algorithm approach for optimal chiller loading for energy conservation. Energy Build. 2012. [226] Yang X-S, Deb S. Cuckoo search via Levy flights. Nat Biol Inspired Comput (NaBIC). Coimbatore, India: IEEE; 2009. p. 210-4. [227] Wang J, Zhang C, Jing Y. Fuzzy immune self-tuning PID control of HVAC system. Int Conf Mechatron Autom (ICMA). Takamatsu, Japan: IEEE; 2008. p. 678-83. [228] Hu M, Weir JD, Wu T. Decentralized operation strategies for an integrated building energy system using a memetic algorithm. Eur J Oper Res. 2012;217:185-97. [229] Rubinstein RY, Kroese DP. The cross-entropy method: A unified approach to combinatorial optimization, Monte-Carlo simulation and machine learning: Springer; 2004. [230] Passino KM. Biomimicry of bacterial foraging for distributed optimization and control. IEEE Control Syst Mag. 2002;22:52-67. [231] Wang S, Jin X. Model-based optimal control of VAV air-conditioning system using genetic algorithm. Build Environ. 2000;35:471-87. [232] Arpaia P, Donnarumma F, Manfredi S, Manna C. Model predictive control strategy based on differential discrete particle swarm optimization. Environ Energy Struct Monit Syst (EESMS). Taranto, Italy: IEEE; 2010. p. 70-3. [233] Hart R. Advanced unitary HVAC control sequence. ASHRAE Transactions. 2012;118:628. [234] Meteorological Service of Canada (MSC) HTTP Data Server. Environment Canada; 2015. [235] Electricity Prices - Time of Use (TOU) Prices. Ontario, Canada: Ontario Energy Board; 2015.

198

[236] ANSI, ASHRAE. Standard 55-2010 Thermal environmental conditions for human occupancy. ASHRAE; 2010. [237] Climate Data - Canadian Weather Energy and Engineering Datasets (CWEEDS). Government of Canada; 2015.

199


