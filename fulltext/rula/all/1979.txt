FAULT DETECTION AND RECOVERY OF SPACECRAFT FORMATIONS AND ATTITUDE

by Daren Lee
B.A.Sc., Engineering Physics, University of British Columbia, 2008

A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of MASTER OF APPLIED SCIENCE in the Program of Aerospace Engineering

Toronto, Ontario, Canada, 2011

c Daren Lee 2011 All rights reserved

Author's Declaration
I hereby declare that I am the sole author of this thesis. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

iii

Abstract
FAULT DETECTION AND RECOVERY OF SPACECRAFT FORMATIONS AND ATTITUDE Daren Lee, Master of Applied Science, Aerospace Engineering Ryerson University, Toronto, 2011

Current satellite operations involve labor-intensive command and control under constant supervision. Currently, spacecraft actuator failures are addressed by uploading new instructions or by sending manned missions to rendezvous and apply in-orbit servicing which imparts additional mission costs and resource expenditures. With the future trend of building small satellite systems, established hardware redundancy solutions will becoming increasingly difficult to implement. This thesis addresses fault tolerant satellite attitude and formation control through the development of a fault observer and autonomous re-configurable control law. The proposed technique can estimate and track actuator faults in the presence of sensor measurements, model uncertainties and disturbances. Similarly, the fault recovery scheme can perform under the same conditions and can converge to desired states in the event the spacecraft becomes underactuated. Numerical orbital simulations and hardware-in-the-loop experiments verify the fault estimation technique both in theory and practice.

v

Acknowledgements

" In theory, there is no difference between theory and practice. But, in practice, there is ..." - Jan L. A. van de Snepscheut After five years of undergrad I thought I was set to enter the work force, never to return to school again. With half a decade of education, one would think a person in his early twenties would be capable of tackling any engineering problem thrown at them. The first few months following your completion of your undergrad is usually accompanied by a sense of pride and self entitlement. Then reality sets in and you're faced with cold hard facts - the sudden realization of not knowing anything becomes apparent. Sure you completed some random undergraduate course in robotics, but does that make you qualified to work on advanced robot-vision algorithms for autonomous micro-UAV navigation? Oh hey, I took a few courses in optics and got to play with lasers; this implies that I must be proficient enough to engineer precise fiber optic gyroscopes using cutting edge rare-earthdoped metals.. Right? Then came the onset of an `engineering' identity crisis. Sure, I took a few courses in electrical engineering, but at the same time I felt that my `skills' could be applied to other problems such as robotics, optical engineering, control systems; the list went on. The truth is, I barely scratched the surface on these topics of interest. Through pondering about who I wanted to become, it became apparent that aerospace engineering covered all of these fields conveniently. Great, now all I needed was to become an aerospace engineer.. or pretend to be one with my engineering physics degree. After this epiphany I would continue applying to jobs, this time expanding to aerospace positions. This lasted for several more months until I finally caught up with reality (again): I didn't know anything about aerospace engineering. John Carmack taught himself aerospace engineering and formed his own private space company hoping to one day build vehicles for tourism and orbital flight. However, not everyone can be John Carmack and not everyone starts their career as a self-taught college drop-out programmer making millions through developing graphic intensive computer vii

games. I was going to have to learn aerospace engineering the traditional way: by going back to school. So why Ryerson University? The truth is, I didn't give it much thought. One day I received a phone call from an enthusiastic professor speaking at a fast-pace asking me to be a part of his lab. Growing tired of waiting for acceptance from other schools and doing jack-all at home, I instantly jumped ship, not knowing what living in Toronto would be like, what kind of lab environment I would be working in or the people I would be interacting with. As it turns out, it was one of the best and not-so-best decisions of my life. And so began two years of master studies in aerospace engineering. It was here where I met some of the most fun-to-work-with-people in my career thus far. Bryan `Sparkie' Stuurman, you are truly an inspiration - your constant need to take things apart and lick the terminals of powered electronics to check for voltage never ceases to amaze me (among other things.. too many to list here). Despite your shortcomings in your post master studies, I'm confident that in the end you'll find your own path. Thanks for the torrent of information, knowledge and humorous remarks throughout my stay here. Noel Abreu, you are the only aerospace engineer from Uruguay I've ever met. That's all I've got. Just kidding. Thanks for inviting me out for all the fun times with you and Suketu Patel (ie: Halloween 2010 - damn epic). Dmitri Ignakov and Tom Dzamba.. get a room you two. Thanks for the countless hours of Starcraft 2 gaming in the lab. Geoff McVittie, you were the greatest source of ridicule in the lab until I arrived.. or not.. this is still up for debate. Thanks for participating in our lab antics when you were not pretending to be busy. Prior to coming to SSDC, I had no idea that conducting nerf dart wars, crashing RC helicopters, or poking and prodding each other with makeshift weaponry (ie: broom sticks, DVI cables, canoe paddles, LED flash lights, x-acto knives) was the norm in a typical aerospace graduate lab setting, but if it wasn't, then you guys definitely made it so. Also: Oct 21 2010, we will never speak of that night again, it was a miracle nothing of value was destroyed (Although I was certainly destroyed by the end of all that). Chris Frenando, lucky you, I hope you enjoy working with your space-qualified toys more than I did with space-unqualified SAFE. Yes, I've said some questionable things in the past two years. Kam Shahid, I'm glad viii

you were there to point them out and expound on them for the rest of your stay here. Your constant onslaught of bitter belittlement and criticism was always a welcome. You've definitely instilled the whole `undergraduates are vermin' meme in all of us; we'll be sure to give new grad students the same treatment despite your absence. To the other paper-mill folks: Surjit Varma and Godard, you guys were definitely a big help in terms of making my thesis possible. Thanks for laying down the foundation in control of underactuated spacecrafts and orbital simulation work which I so desperately needed. I would not be writing this thesis topic without you guys. Thanks to my friends and family. Rei Miyasaka, thanks for being there when I had trouble programming, those nights of trying to decipher C++ would have been a nightmare without you (despite your love for functional programming - yes I will try to learn that too one day, thinking in recursion all the time sounds like a pain though). I wish I had the same level of self-starting ambition you possess. To my dearest brother Jonathan. You've always been there to second guess my prerogative, methodology and way of thinking, but in a constructive way. I know that your knowledge in ee-skills will always surpass mine and I acknowledge that; that's why I asked you so many questions on embedded programming when Sparkie wasn't around. So thanks for the emotional and technical support throughout my master studies. A thanks goes out to everyone I've met and worked with during my undergrad at UBC, I would not be here without you guys too. R.I.P. Berry Chai, you will not be forgotten. And finally, thanks to my parents, Derick and Janet for all the support throughout my master studies. Without your encouragement and sustenance I would not be here where I am today. For that, I am grateful and forever indebt.

ix

For ... Derick, Janet and Jonathan

xi

Contents
Author's Declaration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Abstract . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . List of Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . List of Figures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Nomenclature . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Abbreviations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 Introduction 1.1 1.2 1.3 1.4 Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Motivation & Problem Statement . . . . . . . . . . . . . . . . . . . . . . . Research Objectives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Main Contributions and Thesis Outline . . . . . . . . . . . . . . . . . . . . iii v vii xvii xix xxiii xxv 1 1 5 8 9 13 14 14 16 18 19 22 23 23 26 28 29 31 32 34

2 Fault Detection and Recovery of Spacecraft Formations 2.1 Mathematical Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . 2.1.1 2.1.2 2.2 2.2.1 2.2.2 2.3 2.3.1 2.3.2 2.3.3 2.3.4 2.3.5 2.4 2.4.1 Fault Detection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Underactuated Systems . . . . . . . . . . . . . . . . . . . . . . . . . External Disturbances . . . . . . . . . . . . . . . . . . . . . . . . . Formation Flying Geometry . . . . . . . . . . . . . . . . . . . . . . Literature Review . . . . . . . . . . . . . . . . . . . . . . . . . . . . Broken Super Twisting Sliding Mode Observer Formulation . . . . . Super Twisting Sliding Mode Observer Formulation . . . . . . . . . Information Fusion . . . . . . . . . . . . . . . . . . . . . . . . . . . Fault Detection with Super Twisting Observer . . . . . . . . . . . . Satellite Formation Flying - Thruster Fault Tracking . . . . . . . . xiii

SFF Mathematical Model . . . . . . . . . . . . . . . . . . . . . . . . . . .

Second Order Sliding Mode Observer for Fault Reconstruction . . . . . . .

SFF Thruster Fault Reconstruction with Super Twisting SMO . . . . . . .

Contents
2.5 2.6 2.7 Underactuated Formation Control Law Design . . . . . . . . . . . . . . . . SFF Fault Detection and Recovery . . . . . . . . . . . . . . . . . . . . . . Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40 44 55 57 57 62 64 65 67 68 70 73 78 80 83 87 89 89 89 91 93 98 98 98 101 102 102 104 106

3 Spacecraft Attitude Fault Detection and Recovery 3.1 3.2 3.3 Spacecraft Attitude Mathematical Model . . . . . . . . . . . . . . . . . . . Proposed Attitude Fault Detection Algorithm . . . . . . . . . . . . . . . . 3.2.1 3.3.1 3.3.2 3.3.3 3.4 3.5 Fault Detection with Super Twisting Observer . . . . . . . . . . . . Design of Control Laws . . . . . . . . . . . . . . . . . . . . . . . . . Fully Actuated Control Mode . . . . . . . . . . . . . . . . . . . . . Underactuated Control Mode . . . . . . . . . . . . . . . . . . . . . Proposed Fault Recovery Algorithm . . . . . . . . . . . . . . . . . . . . . .

Attitude Fault Estimation - Numerical Simulation . . . . . . . . . . . . . . Attitude Fault Recovery - Numerical Simulation . . . . . . . . . . . . . . . 3.5.1 3.5.2 Nominal Case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . External Disturbance Case . . . . . . . . . . . . . . . . . . . . . . .

3.6

Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4 Hardware-in-the-Loop Validation 4.1 Single Axis Simulator Fault Detection . . . . . . . . . . . . . . . . . . . . . 4.1.1 4.1.2 4.1.3 4.2 4.2.1 4.2.2 4.2.3 4.2.4 4.2.5 4.2.6 4.2.7 SAS Test Setup . . . . . . . . . . . . . . . . . . . . . . . . . . . . . SMO Fault Estimator Design . . . . . . . . . . . . . . . . . . . . . HWIL Simulation Results . . . . . . . . . . . . . . . . . . . . . . . SAFE System Overview . . . . . . . . . . . . . . . . . . . . . . . . Components . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Ground Station . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Mathematical Model . . . . . . . . . . . . . . . . . . . . . . . . . . Equations of Motion . . . . . . . . . . . . . . . . . . . . . . . . . . System Characteristics . . . . . . . . . . . . . . . . . . . . . . . . . Sliding Mode Observer Design . . . . . . . . . . . . . . . . . . . . . xiv

Satellite Airbed Formation Experiment - Fault Detection . . . . . . . . . .

Contents
4.3 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109 111 111 113 115

5 Conclusions 5.1 5.2 Summary of Contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . Future Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Bibliography

xv

List of Tables
1.1 2.1 2.2 2.3 2.4 2.5 2.6 3.1 3.2 3.3 3.4 4.1 4.2 4.3 4.4 4.5 4.6 4.7 Summary of on-orbit failures of thruster assemblies. . . . . . . . . . . . . . Orbital Parameters for Leader Satellite . . . . . . . . . . . . . . . . . . . . Along-track formation faults . . . . . . . . . . . . . . . . . . . . . . . . . . Circular formation faults . . . . . . . . . . . . . . . . . . . . . . . . . . . . MSE comparison between fusion and non-fusion algorithm . . . . . . . . . Orbital Parameters for Follower Satellite . . . . . . . . . . . . . . . . . . . Projected circular formation faults . . . . . . . . . . . . . . . . . . . . . . Underactuated spacecraft - Simulation parameters . . . . . . . . . . . . . . Torque Faults Applied To Spacecraft . . . . . . . . . . . . . . . . . . . . . Torque Faults Applied To Spacecraft . . . . . . . . . . . . . . . . . . . . . Underactuated Attitude - Simulation parameters . . . . . . . . . . . . . . . Single-axis Simulator specifications . . . . . . . . . . . . . . . . . . . . . . Torque Faults Applied To Spacecraft . . . . . . . . . . . . . . . . . . . . . Torque Commands - Scenario I . . . . . . . . . . . . . . . . . . . . . . . . Torque Faults Applied To SAS - Fault Scenario II . . . . . . . . . . . . . . Single-axis Simulator specifications . . . . . . . . . . . . . . . . . . . . . . Thrust value identification . . . . . . . . . . . . . . . . . . . . . . . . . . . Thruster Commands Applied To Spacecraft . . . . . . . . . . . . . . . . . 4 34 35 37 39 46 46 74 75 78 79 90 94 94 96 99 107 108

xvii

List of Figures
1.1 1.2 1.3 2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8 2.9 Overview of different types of system faults [Tafazoli 2009] . . . . . . . . . A survey of AOCS component failures. Graph taken from [Tafazoli 2009] . The fractioned satellite concept . . . . . . . . . . . . . . . . . . . . . . . . A survey of different spacecraft failures . . . . . . . . . . . . . . . . . . . . Generic FDI Scheme . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ECI and LVLH coordinate frames for leader-follower spacecraft geometry. . Proposed sliding mode observer system for FDI . . . . . . . . . . . . . . . Proposed sliding mode observer system for FDI. Note that different gain values are assigned for both observers, hence the values 1 ,1 and 2 ,2 . . Along-track configuration: Thrust Fault Detection X-axis . . . . . . . . . . Along-track configuration: Thrust Fault Detection Y-axis . . . . . . . . . . Along-track configuration: Thrust Fault Detection Z-axis . . . . . . . . . . Along-track configuration: Observer Error . . . . . . . . . . . . . . . . . . 33 35 35 36 36 37 38 38 38 39 45 47 48 49 49 50 2 3 6 15 16 20 30

2.10 Circular formation fault estimation . . . . . . . . . . . . . . . . . . . . . . 2.11 Circular formation: State observer error . . . . . . . . . . . . . . . . . . . 2.12 Projected circular formation fault estimation . . . . . . . . . . . . . . . . . 2.13 Observer error for projected circular orbit . . . . . . . . . . . . . . . . . . 2.14 Top: State estimate with velocity fusion. Bottom: State estimate without velocity fusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.15 SFF Fault Estimation Flow Chart - Fault detection and Controller reconfiguration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.16 No recovery applied to SFF - Projected Circle Formation . . . . . . . . . . 2.17 Top: Controller Error - Relative position, Bottom Left: Control Effort, Bottom Right: Fault Detector Logic . . . . . . . . . . . . . . . . . . . . . . . . 2.18 Thruster Fault Estimator - Projected Circle Formation . . . . . . . . . . . 2.19 Observer Error - Projected Circle Formation . . . . . . . . . . . . . . . . . 2.20 Follower satellite trajectory in relative frame - Projected Circle Formation xix

List of Figures 2.21 Measured (Top) and Estimated (Bottom) relative state position - Projected Circle Formation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.22 Measured (Top) and Estimated (Bottom) relative state position - Projected Circle Formation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.23 Left Top: Controller Error - Relative position, Left Bottom: Control Effort, Left: Fault Detector - Along Track Formation . . . . . . . . . . . . . . . . 2.24 Thruster Fault Estimator - Along Track Formation . . . . . . . . . . . . . 2.25 Observer Error - Along Track Formation . . . . . . . . . . . . . . . . . . . 2.26 Measured (Top) and Estimated (Bottom) relative state position - Along Track Formation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.27 Measured (Top) and Estimated (Bottom) relative state velocities - Along Track Formation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.1 3.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9 Geometry of orbit motion of rigid spacecraft. . . . . . . . . . . . . . . . . . Proposed sliding mode observer system for FDI . . . . . . . . . . . . . . . Reconfigurable Controller . . . . . . . . . . . . . . . . . . . . . . . . . . . Control torque estimation in the presence of actuator faults . . . . . . . . . Control torque estimation in the presence of actuator faults . . . . . . . . . Control torque estimation in the presence of actuator faults . . . . . . . . . State errors of Sliding Mode Observer . . . . . . . . . . . . . . . . . . . . . No controller reconfiguration - Top: attitude states, Bottom Left: Control Effort, Bottom Right: System Faults . . . . . . . . . . . . . . . . . . . . . Nominal Case - Torque Estimation -  - Axis and  - Axis . . . . . . . . . 3.10 Nominal Case - Observer error for attitude fault recovery . . . . . . . . . . 3.11 Nominal Case - Top: Attitude states, Bottom Left: Control Effort, Bottom Right: Fault Detector . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.12 Nominal Case - State position measurement . . . . . . . . . . . . . . . . . 3.13 Nominal Case - State velocity measurement . . . . . . . . . . . . . . . . . 3.14 External Disturbance Case: Control torque for attitude fault recovery -  Axis and  - Axis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.15 External Disturbance Case: Observer error for attitude fault recovery . . . xx 83 84 81 82 82 79 80 81 54 58 66 68 76 76 77 77 54 52 53 53 51 51

List of Figures 3.16 External Disturbance Case: Left Column: Attitude states and control effort, Right: Fault Detection logic . . . . . . . . . . . . . . . . . . . . . . . . . . 3.17 External Disturbance Case: State position measurement vs estimate . . . . 3.18 External Disturbance Case: State velocity measurement vs estimate . . . . 4.1 4.2 4.3 4.4 4.5 4.6 4.7 4.8 4.9 Single axis simulator with LED angular position feedback on an air bearing Flowchart for SAS HWIL setup . . . . . . . . . . . . . . . . . . . . . . . . Torque Fault Reconstruction - Fault Scenario I . . . . . . . . . . . . . . . . Torque Faults Reconstruction - Estimation Error . . . . . . . . . . . . . . Sliding Mode Observer Residuals - Fault Scenario I . . . . . . . . . . . . . Torque Fault Reconstruction - Fault Scenario II . . . . . . . . . . . . . . . Torque Fault Reconstruction - Estimation Error for Fault Scenario II . . . Sliding Mode Observer Residuals - Fault Scenario II . . . . . . . . . . . . . Picture of the test spacecraft developed by SSDC laboratory at Ryerson University . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.10 Flow chart representation of hardware-in-the-loop simulation framework. . 4.11 Block diagram of the pose estimation procedure. . . . . . . . . . . . . . . . 4.12 Block diagram of the ground station functions. . . . . . . . . . . . . . . . . 4.13 Reference frames for SAFE platform. . . . . . . . . . . . . . . . . . . . . . 4.14 Thruster configuration on the body frame of the SAFE platform. T1 to T4 represent thruster locations . . . . . . . . . . . . . . . . . . . . . . . . . . 4.15 Filtration of commanded thrust signal yields significantly more accurate representation of true system dynamics . . . . . . . . . . . . . . . . . . . . . . 4.16 Flow chart of fault detection process . . . . . . . . . . . . . . . . . . . . . 4.17 SMO Thruster Estimation for the SAFE System . . . . . . . . . . . . . . . 4.18 Sliding Mode Observer Error Residuals . . . . . . . . . . . . . . . . . . . . 105 106 108 109 104 98 100 101 101 102 85 86 86 91 92 94 95 95 96 97 97

xxi

Nomenclature
a e ex ey ez il ml mf re rf rl x y z       µe   d g    semi-major axis of the reference orbit eccentricity of the reference orbit relative radial position tracking error relative along-track position tracking error relative cross-track position tracking error orbit inclination of leader spacecraft mass of the leader spacecraft mass of the follower spacecraft radius of the Earth radial position of the follower spacecraft from the Earth centre radial position of the leader spacecraft from the Earth centre radial separation between leader and follower spacecraft along-track separation between leader and follower spacecraft cross-track separation between leader and follower spacecraft spacecraft pitch angle in-plane tether swing angle spacecraft yaw angle sliding surface boundary layer positive design scalar to determine sliding surface reaching time true anomaly geocentric gravitational constant of the Earth linear sliding manifold (Chapter 4) control torque external disturbance torque gravity gradient torque principal angle of rotation in Euler's theorem (Chapter 4) spacecraft roll angle in-plane formation phase angle (Chapter 2) xxiii

List of Figures  l 0
B BI

axial angular velocity of reaction wheels right ascension of the ascending node of leader spacecraft orbit magnitude of orbital angular velocity of LVLH frame (Chapter 4) angular velocity vector relative to inertial frame expressed in body frame argument of perigee of leader spacecraft orbit

l

List of reference frames B - xyz I - XY Z L - xo y o z o S - XY S - xy spacecraft body-fixed coordinate frame Earth centered inertial reference frame local vertical local horizontal orbital reference frame SAFE platform inertial reference frame SAFE platform body-fixed reference frame

Notational conventions |·| · ( · )0 ) (· (·) (^ ·) (~ ·) [ a× ] absolute value Euclidean norm for vectors, induced norm for matrices ( · ) at t = 0 derivative of ( · ) with respect to time, t derivative of ( · ) with respect to  parameter estimate parameter estimation error skew-symmetric matrix for vector a

xxiv

Abbreviations

ACS AOCS ASMC CW DOF ECI FDI FDIR EMF FTC FUSE GN&C HWIL LEO LOE LQR LVLH SAFE SFF SSDC SMC SMO VSC

Attitude Control System Attitude and Orbit Control System Adaptive Sliding Mode Control Clohessy-Wiltshire Degrees-of-Freedom Earth Centered Inertial Fault Detection and Isolation Fault Detection and Isolation and Recovery Electromagnetic Force Fault Tolerant Control Far Ultraviolet Spectroscopic Explorer Guidance, Navigation, & Control Hardware-In-Loop Low Earth Orbit Loss of Effectiveness Linear Quadratic Regulator Local Vertical Local Horizontal Satellite Airbed Formation Experiment Spacecraft Formation Flying Space Systems Dynamics and Control Sliding Mode Control Sliding Mode Observer Variable Structure Control

xxv

Chapter 1

Introduction

1.1

Background
spacecraft's Attitude and Orbit Control System (AOCS) is considered to be one of the most important component of a spacecraft due to its strong reliance during mission

A

operations. The purpose of the AOCS is to stabilize the spacecraft to some desired location, trajectory or rotational orientation. During a space mission, the AOCS is employed for a variety of tasks, such as controlling the spacecraft's state to accommodate telemetry transfer to a ground station or for directing payload instrumentation such as imaging optics to a particular point of interest. The AOCS also provides positional control, mostly used to achieve a station keeping at a desirable orbital location and altitude relevant to the mission. Using information feedback for position, velocity and attitude from the spacecraft's Attitude Determination System (ADS), the control law in the AOCS determines how to best actuate thrusters, momentum and reaction wheels to achieve the desired system state. When designing the AOCS, strong considerations must be made in regards to the disturbance the spacecraft will experience during its mission life time. Mass properties and moment of inertia of the spacecraft offer insight into this, as well as the location of orbit. In Low Earth Orbit (LEO), the most dominant disturbance force include the gravitational effects from Earth's oblateness, which is known as the second zonal harmonic, or J2 perturbation. Aerodynamic drag is also a common disturbance force in LEO due to its vicinity to the planet's atmosphere which can affect both orbit translational motion as well as attitude in the form of disturbance torques. Other orbital disturbances may include magnetic field and solar radiation pressure which impart forces and torques. The AOCS must apply the appropriate actuation effort to overcome these disturbances or risk de-stabilization of the space vehicle. 1

Chapter 1. Introduction Failure of the AOCS will usually result in mission degradation or at worse, mission failure. The findings of [Tafazoli 2009] surveys over 100 different spacecraft failures from 1980 to 2005. From this study, it can be seen that 32% of all spacecraft failures were due to spacecraft's AOCS as shown in Figure 1.1.

Figure 1.1: Overview of different types of system faults [Tafazoli 2009] . When examining the AOCS in terms of component breakdown, it was found that the actuator faults yield the highest level of failure. Referring to Figure 1.2, thrusters and xenon ion propulsion (XIPS) accounted for 24% while momentum wheels, reaction wheels and gyroscopes accounted for 33%. In other words, 57% of all AOCS failures are directly related to positional thrusters and attitude actuators. A spacecraft can fail for numerous reasons, ranging from the harsh space environment to fundamental design problems or corruption of on-board software. Actuator failures can be divided into categories: reaction wheels and thruster faults. A reaction wheel is an electric motor driven actuator capable of providing angular momentum storage needed to orient the satellite to some desired attitude. Problems encountered by reaction wheels may include failure to respond to control input signals, which can be caused by faulty electronics such as the power supply or motor controller [Murugesan & Goel 1987]. Typical symptoms of this may include slow wheel deceleration or a `lock-in-place' type behavior 2

1.1. Background

Figure 1.2: A survey of AOCS component failures. Graph taken from [Tafazoli 2009]

where the motor controller repeats the same out-dated command and maintains a constant speed. Other fault cases may include more physical cases such as excessive friction between the stator and rotor which may build up over time causing an attenuation or decrease of output torque. Torque bias occurs when constant torque is needed to overcome bearing friction increasing over time due to aging. If left unchecked the bias may cause the motor controller to continuously increase torque commands to the point of actuator saturation. Wheel saturation occurs when the wheel has reached a maximum angular velocity and can not achieve the commanded torque dictated by the control law. Space vehicle thrusters are mainly comprised of a flow control valve and a combustion chamber [Robertson 2003]. The AOCS computer controls the flow of propellant reactants into the combustion chamber where thrust is generated through a nozzle. Thrusters have found dual uses in both orbit position and attitude control, and can act as a source of momentum dumping. Failure modes for this actuator include stuck-open and stuck-close failures, where the flow control valve cannot open or close in each respective case, thus either providing no thrust or constant uncontrolled thrust. Either case can cause a large build up in control error and can easily lead to system instability. The findings of [Robertson 2003] list several AOCS actuator failures from 1990 to 2001 which are shown in Table 1.1. The column labeled impact can either consist of mission interruption, total loss or partial loss. 3

Chapter 1. Introduction A total loss resulted if a satellite experienced a failure preventing it from performing the mission. The shortened life category included failures which caused the mission life time to decrease. Mission interruptions consisted of cases in which the loss of operation persisted for more than a week.

Table 1.1: Summary of on-orbit failures of thruster assemblies. Spacecraft FUSE Cause of Anomaly Two of the four reaction wheels failed, new software uploaded for underactuated control . GPS BII-07 Iridium 27 Terriers ARTEMIS 3-axis stabilization failure due to a second reaction wheel failure. Thruster anomaly depleted operational fuel ACS polarity error controlling magnetic torquer coil. Blockage in xenon flow to ion thruster created stuck-close failure Mission Interruption Total loss Total loss Total loss Impact Mission Interruption

Currently, spacecraft actuator faults have been mitigated by the inclusion of redundant hardware. For instance, nearly all spacecraft with attitude pointing capability come with a redundant oblique wheel which couples with all three axes, enhancing the spacecraft's fault tolerance should one of the other nominal wheels fail. Similarly, additional thrusters are implemented to ensure orbit maneuvering robustness should the nominal thrusters fail. The modification of a control law to adapt to changing plant dynamics is also known as controller re-configuration. Controller re-configuration has been used in many instances to mitigate actuator faults on spacecrafts and is often accomplished through modifying software of the on-board computer from the ground station. 4

1.2. Motivation & Problem Statement

1.2

Motivation & Problem Statement

Traditional satellite control has mostly been accomplished using a manual approach. For instance, the Air Force currently employs thousands of personnel to monitor approximately hundred satellites through the Air Force Satellite Control Network (AFSCN) [Hodges 2008]. The cost for missions involving constellations increases dramatically to support control and monitoring of each individual spacecraft. Autonomous capabilities for spacecraft systems have become a source of great interest in recent years as it can serve as a method to reduce mission costs needed to maintain satellite operation, as well as enhancing a spacecraft's robustness to scenarios involving system failures. Currently, spacecraft autonomy has been primarily used to handle anomalies or to simplify low-level routines during an operation. Such cases may include a spacecraft's `safe mode' where in the instance an anomalous scenario is detected, the on-board computer may automatically shut down certain processes in order to prevent faults [Gomez ]. Implementation of higher levels of autonomy is still considered to be in its infancy with only a handful of experimental validations in controlled tests. One example includes the autonomous guidance and control of a spacecraft tasked with intelligently imaging Earth weather phenomena and prioritizing data to send back based on certain metrics dictated by the payload customer [Sherwood 2008]. The future trend of spacecraft design and space missions will be focused on developing low-cost, low-mass and smaller sized spacecrafts. Spacecraft formation flying is one such derivative of the small-satellite concept which allows for enhanced mission capabilities without the need for constructing a single large satellite. Uses for this technique can be applied to missions related to astronomy, communication or metrology; for instance, the construction of high resolution space interferometers will require a payload of separation distances on the order of kilometers not achievable without formation flying. The Micro-Arc X-ray Second Imaging mission is one such mission which proposes a fleet of 33 spacecrafts flying in formation with the goal of imaging black holes at micro arc second resolution. The fractioned satellite approach takes the formation flying concept a step further by enhancing mission robustness by using a decentralized architecture. In this ideology, one spacecraft is actually replaced by several other miniature satellites working in conjunction and flying in formation, each tasked with different sub-component responsibilities such as 5

Chapter 1. Introduction command and data handling (C&DH) or payload interfacing. Using this approach leads to several benefits, such as modularity, where if one spacecraft responsible for a sub-system fails, the mission can easily be serviced by simply replacing the sub-satellite at fault with a new one. Using this decentralized method ensures no single-point failure - in a traditional monolithic satellite approach failure of a critical sub-system can irreparable and at worst, lead to catastrophic failure. Other examples include the support for more graceful deorbiting to mitigate space debris and save costs for future missions - instead of de-orbiting the entire spacecraft the fractioned satellite concept allows for the reusability of relevant satellite modules from a previous mission for future space flights.

Figure 1.3: The fractioned satellite concept With the onset of these future space mission concepts, new techniques will be needed to address the fault tolerant design of such systems. Given that a satellite's AOCS is the most prone to faults, it is imperative that robust design analysis is considered, especially with such stringent requirements imposed by the future space mission trends. For instance, a small satellite design will be considered to be on the order of 100 kg (microsatellite) to 1 Kg (picosatellites) which leaves little room for redundant hardware used to mitigate or sensors for actuator health monitoring. An analytical approach to fault tolerance will be needed to ensure that the spacecraft is able to determine when a fault occurs and how to best recover from it. The following summarizes problems to be addressed in this dissertation. 6

1.2. Motivation & Problem Statement [PROB1] Nonlinear Dynamics. The equations of motion associated with orbit and attitude dynamics are non-linear in nature. Should a robust fault detector or fault tolerant controller be designed, accommodation of these non-linearities must be considered or risk system inaccuracies in control and estimation due to model mismatches.

[PROB2] Limited Hardware Redundancy. The new trend of smaller low cost satellites means hardware redundancy will become more difficult to implement. Methods must be devised to ensure that these future space missions are fault tolerant without compromising limited space and mass requirements.

[PROB3] Model Uncertainties,external disturbances and measurement noise. The environment of space poses challenges in both estimation and control. Without appropriate control schemes, a space vehicle can be easily driven to an unstable state. Non-linear dynamics coupled with sensor noise and model uncertainties can cause further complications.

[PROB4] Actuator faults. Given the non-linear dynamics and external perturbations a spacecraft experiences, actuator failures of the AOCS component in the presence of orbital disturbances will lead to de-stabilization of the spacecraft. Traditional linear control laws used in AOCS will become unsuitable in such scenarios. Studies in the literature indicates that the AOCS is at the most fault in scenarios involving spacecraft failures. This problem is compounded further with problem statement 2 in which smaller spacecrafts will have less accommodation for redundant actuators.

[PROB5] The Need for Spacecraft Autonomy. The need for spacecraft autonomy has gained considerable interest and will continue to grow as the scope and complexity of space flight increases. Autonomous behavior alleviates the need for constant monitoring and man-in-the-loop at every stage of a satellite's life cycle, thus freeing up resources for more imperative tasks. Objectives achieved in this dissertation should contribute towards this goal. 7

Chapter 1. Introduction

1.3

Research Objectives

Outlined below are research objectives which address the problem statements presented in the previous section. The ultimate goal through completing these objectives is the development of fault detection and recovery scheme working in conjunction to provide precise stabilization spacecraft systems in the presence of orbital disturbances, actuator faults, model uncertainties and measurement noise. [OBJ1] The design of an analytical fault observer for AOCS actuators . With a heavy emphasis on lower mass, power and size for future satellites, one design requirement for the fault observer will be to only make use of minimal sensor feedback. In the context of this work it is assumed that the state feedback in the form of orbital position, velocity, attitude and attitude rates will be available from the inertial measurement unit (IMU) and attitude determination system (ADS). Using strictly only this information should be sufficient for fault estimation. It is assumed that a sensor specifically used to return only a boolean Yes/No fault occurrence status is not available. This ensures that the fault estimation method can be more universally applied to any spacecraft system without having to add redundant fault sensing hardware. The proposed method should only have to apply analytical computations for reconstructing actuator faults. [OBJ2] The design of a fault recovery scheme. Detection of spacecraft actuator fault only covers the first half of the problem. A spacecraft is said to be `underactuated' should loss of actuation occurs along one or more of its nominal controllable axes. This problem statement calls for development of a control scheme capable of autonomously recovering from faults which renders the spacecraft underactuated. [OBJ3] Robustness to model uncertainties and measurement noise. Although processing power is available to handle the computational burdens of non-linear model processes, the fidelity of the model depends on how closely it matches the true plant dynamics. Realistically, not all intricacies can be known. The proposed fault observer and control law should be designed to be perform reliably given uncertainties or model 8

1.4. Main Contributions and Thesis Outline mismatches. The fault observer is expected to still resolve fault estimate in the presence of noise as well.

1.4

Main Contributions and Thesis Outline

To meet the goals of the research objective, satellite formation flying (SFF) and attitude fault detection and recovery were investigated. Approaching the objectives in this manner allowed for independent analysis of the AOCS for both orbit (SFF) and attitude. The fault detection technique was chosen based on findings in the literature in regards to how well the estimation technique accommodated properties such as non-linearities, robustness to measurement noise and uncertainties. Selection of the fault recovery scheme shared similar criteria. 1. Fault Estimation of Spacecraft Actuators (OBJ1, OBJ3, CH2, CH3) To meet the requirements imposed by the objectives and problem statements, an extensive review of estimation techniques were examined. The super-twisting sliding mode observer was selected for its resiliency to noise and model mis-matches. In addition to providing accurate state estimate, it can also be re-purposed for accurate estimation of actuator faults for mechanical systems. Modifications to the super twisting sliding mode observer not found in the literature were developed in order to accommodate additional sensor inputs. 2. Fault Detection and Recovery for Spacecraft Formation Flying Control (OBJ1, OBJ2, CH2) Sliding mode observer fault reconstruction was applied to spacecraft formation concept, successfully estimating thruster faults on all three axes in the LVLH frame for the satellite formation flying scenario. Using this information, a fault detector was developed to indicate when the system becomes under-actuated along the radial and along-track axes. Because of dynamics coupling between these two axes, three axes stability can be maintained through switching to appropriate control laws. Thus, a reconfigurable controller was developed to autonomously switch between control modes 9

Chapter 1. Introduction based on the nature of the under-actuated fault. Robustness to uncertainties was demonstrated for both controller and observer by excluding disturbance information to the plant model. 3. Fault Detection and Recovery for Attitude Control (OBJ1, OBJ2, CH3) In the attitude control scenario, fault torques were estimated using the sliding mode technique in the LVLH frame for a single satellite. Much like the fault detector for the formation flying scenario, three-axes recovery was accomplished using a reconfigurable control law due to coupling between the pitch and yaw axes. The fault recovery scenario was shown to successfully control under different disturbances such as gravity gradient, magnetic torquing, aerodynamic drag and solar radiation pressure. 3. Hardware Verification of proposed Fault Estimator (OBJ1, CH4) Ryerson's Space Systems Dynamics and Control Lab (SSDC) offers several hardware simulators mimicking spacecraft systems for both attitude and formation control. Further validation of the proposed fault detection algorithm through hardware-inthe-loop simulations were accomplished, achieving relatively accurate re-construction of induced actuator faults. Chapter 2 begins with a discussion on the mathematical formulation discussing the relative dynamics between the leader and follower satellite. A literature review follows after that, outlining work done in the areas of SFF fault estimation. After, the proposed fault detection strategy is outlined in detail and applied to the SFF scenario. Numerical simulations demonstrate the fault reconstruction in various formation flying configurations. Next, a fault recovery method is proposed which makes use of the fault reconstructor. Working in-conjunction, more numerical simulations are done to show successful fault detection and recovery in the presence of thruster faults. Following a similar format, Chapter 3 addresses attitude fault detection in the same manner by starting with the derivation of spacecraft attitude dynamics. Using the same fault detection scheme in the previous chapter, reconstruction of actuator faults is achieved follow by implementing a fault detection and recovery scheme. Finally Chapter 4 summarizes a hardware-in-the-loop experiment 10

1.4. Main Contributions and Thesis Outline verifying the proposed algorithm performing fault reconstruction on real physical systems.

11

Chapter 2

Fault Detection and Recovery of Spacecraft Formations

S

pacecraft formation flying is a challenging new concept which will provide a multitude of benefits such as greater cost savings and enhanced reliability. Several space

missions in the near future will require the use of formation flying maneuvers in order to complete various mission objectives. Such examples may include a cluster of satellites functioning together to act as a telescope or interferometer. The Magnetospheric Multiscale mission aims to measure Earth's magnetosphere at key locations with four satellites flying in a tetrahedron-shaped configuration. Future missions such as Terrestrial Planet Finder (TPF) and MicroArcsecod X-ray Imaging Mission (MAXIM) will involve the identification of planets and observation of deep space celestial bodies will require centimeter to micrometer precision. With strong emphasis on precise relative station keeping of formation flying spacecrafts, the need for reliable fault tolerant control laws have been investigated in a variety of aspects. In this chapter, we propose a spacecraft formation fault estimation and control reconfiguration system capable of detecting actuator failures and selecting the appropriate control mode to mitigate the adverse effects of the fault. The fault detection and control system is capable of recovering from complete failures in actuation along several body-frame axes without having to rely on additional thrusters. As a result, redundant thrusters are not required in this mode of control, offering mass savings and less mechanical complications. In terms of fault detection, the proposed scheme makes use of a second order sliding mode observer which not only provides fault detection but full-state estimation in the presence of sensor noise. Much like the fault tolerant control law, the proposed fault observer will not require hardware redundancy for monitoring the health of the actuator and rely only on position and velocity sensor readings. A complete mathematical model of 13

Chapter 2. Fault Detection and Recovery of Spacecraft Formations the leader-follower spacecraft dynamics will be shown, followed by derivation of the fault detection scheme. Next, the fault tolerant control law will also be derived for specific failure cases. The fault reconstruction and reconfiguration scheme has been validated with numerical simulations with a non-linear relative orbital dynamics plant and the results depicting successful fault detection and reconfiguration will be shown.

2.1
2.1.1

Mathematical Preliminaries
Fault Detection

In order to address the spacecraft fault detection and recovery problem, we first begin with establishing the mathematical basis which will be used throughout this dissertation. In equation form, this is represented as

x  = f (t, x, u)

(2.1)

where x  Rn is the system states, t represents time and u  Rm is the control input. For accurate and precise estimation and control techniques, adequate model knowledge and information must be known. As such, time varying non-linear equations of motion are needed to accommodate this requirement. Actuator faults can be included in this model as indicated in Figure 2.1. Each fault in Figure 2.1 is associated with a specific problem one might encounter in regards to spacecraft actuation. Abrupt and permanent faults are likely to occur from severe component damage, such as structural integrity compromises or functional failure of integrated circuits due to deterioration or loose connections. Incipient faults represent a fault occurring slowly over time such as the wearing down of a reaction wheel actuator due to increased friction between stator and rotor. Transient and intermittent faults occur randomly at some specified bounded magnitude and duration. This can represent reoccuring faults, such as periodic disturbance applied on a sensor or orbital disturbances perturbing the spacecraft's motion. For this thesis, it was assumed that fault signals of arbitrary functions can be represented in Figure 2.2. 14

2.1. Mathematical Preliminaries

fault

fault

time Abrupt and Permanent Fault

time Transient Fault

fault

time Intermittent Fault

fault signal

fault

fault signal time Incipient Fault

+

faulty signal

X

faulty signal

Additive Fault

Multiplicative Fault

Figure 2.1: A survey of different spacecraft failures

x  = f (t, x, u + uf )

(2.2)

where uf in equation is the arbitrary signal representing the actuator fault. Fault detection and isolation (FDI) is the approach used to identify and isolate where faults take place in the system. In the literature detection of faults is commonly approached by comparing the expected value and the measured value of a certain parameter - this is also called a residual which is defined in Equation 2.3. r=x ^-x (2.3)

x ^ represents an estimated parameter while x is the parameter associated with a measurement. By comparing measurement versus estimate, one can use this information for simple fault monitoring. Figure 2.2 outlines a typical FDI scheme. In this flow diagram, comparison between a plant model and sensor measurements generates several residuals. The residuals can be used to represent the 'health' of a particular component of interest which maybe prone to faults. One example may include the monitoring of motor properties such as viscous friction, back EMF and bus voltage. In most cases, parameters of interest are inaccessible and must be `indirectly' measured through using estimation al15

Chapter 2. Fault Detection and Recovery of Spacecraft Formations gorithms work in conjunction with the FDI scheme. The process of determining which sub-component is at fault is known as isolation.

State/Parameter Estimator Sensor Measurements

Residual Analysis Fault Detection

True Plant Dynamics

System Model

Model Correction Fault Isolation and Identification

x

f ( x, t , U )

^ x

^, t ,U ) f (x

Fault Detection and Isolation Scheme
Control Inputs

U

Figure 2.2: Generic FDI Scheme Rather than monitoring the residuals of each individual component associated with an actuator and isolating which part is to blame, the work presented in this thesis will reconstruct the actuator's output. In other words the precise estimation of the signal uf is accomplished. By definition, the proposed fault estimator does not isolate faults, rather it detects and estimates its magnitude. In the context of this work, status of the actuator sub-components are not known to the fault estimator and are not relevant to the fault recovery scheme which will be discussed in Section 2.1.2.

2.1.2

Underactuated Systems

Most modern spacecrafts will contain more than the minimum number of actuators required to perform a space mission. Reliability and robustness can be greatly enhanced through actuator redundancy; should the nominal thruster or reaction wheel fail a back-up is ensured to be in place. A system is considered to be underactuated if control along one or more degrees of freedom are no longer becomes available. Mathematically, this can be defined as(Eq.2.4) x  = f (x, t) + B (x, t)u (2.4)

Where x  Rn is the state vector, f (x, t)  Rn represents the nonlinearity of the system, B (x, t)  Rn×m is the input matrix, and u  Rm is the control vector. The dynamical 16

2.1. Mathematical Preliminaries system described by Eq. (2.4) can be classified based on actuator configuration as follows: · Redundant actuation: If m > (n/2), the number of control inputs applied to the system in Eq. (2.4) is more than the number of degrees of freedom to be controlled (n/2). · Underactuated: If m < (n/2), then for the system in Eq. (2.4) with (n/2) degrees of freedom, only m degrees of freedom are actuated, and (n/2) - m degrees of freedom are unactuated. The underactuated scenario where the number of control inputs are less than the degrees of freedom m < (n/2) does not provide any indication if the system is controllable. Dynamic coupling between axis can allow for full control of an underactuated system. With proper control law design, full stabilization on all degree of freedoms can even be achieved. By exploiting these features, re-configurable control laws capable of fault recovery without the aid of redundant actuation is explored in this thesis.

17

Chapter 2. Fault Detection and Recovery of Spacecraft Formations

2.2

SFF Mathematical Model

We begin with a non-linear mathematical formulation of the spacecraft formation flying scenario by defining independent equations of motion of the leader and follower satellite. Starting with the earth center inertial frame, we define a vector rl from the center of the Earth to the leader satellite in the Earth Centered Inertial (ECI) frame. Note that the leader satellite may not necessarily represent a physical object, it may also act as a point of reference for the follower spacecraft(s). Next, we define a vector for the follower satellite taken from the origin of the ECI frame. G(Me + ml ) ¨ rl = - rl rl3 ¨f = - G(Me + mf ) rf r 3 rf (2.5)

(2.6)

where Me is the mass of the earth while ml and mf are the leader-follower masses respectively. The goal of formation flight is to maintain desired relative positioning between the leader and follower spacecraft. As such, motion in the relative frame must be properly defined. The reference frame which will be used to describe this motion will be the local horizontal local vertical frame (LVLH). In this frame, the x, y and z components will be referred to as radial, along-track and cross-track respectively. The radial axis describes position along the Earth's center to the leader point mass while the along-track and crosstrack describe tangential and out-of-plane motion respectively. Because the true anomaly's axis of rotation is parallel to the cross-track direction, this frame will experience rotation about the z-axis. This is defined as: =  µe rl3 (2.7)

 f ¨ = - 2 r  rl

(2.8)

where µe is defined as the geocentric gravitational constant of the Earth. Note that in non-eccentric orbit, no angular acceleration of the true anomaly is experienced. By subtracting the two vectors r l and r f , we arrive at the following relative motion equations. 18

2.2. SFF Mathematical Model

2 + y  ¨ + 2y  - µe (rl + x) + µe + fdx + x ¨ = x  3 rf rl2  2 - 2x  - x ¨ - µe y + fdy + y ¨ = y  3 rf µe y z ¨ = - 3 + fdz + rf

ux ml uy ml uz ml

(2.9) (2.10) (2.11)

where rf = [(rl + x)2 + y 2 + z 2 ]1/2 is the absolute distance of the follower satellite and rl is the absolute distance of the leader. The above equations of motion also include disturbances fdx , fdy and fdz as well as control forces ux , uy and uz for all three LVLH axis. It is important to note that these additional forces are differential, meaning they are disturbance forces experienced relative to the leader's point of reference.

2.2.1

External Disturbances

Orbital disturbances can comprise of a variety of effects, ranging from gravitational perturbation, solar radiation pressure and third body disturbances. In low earth orbit (LEO), the most dominant disturbance force is the second zonal harmonic (J2) which is induced by Earth's oblateness. The J2 perturbation force will cause two main effects: 1) precession of the orbital plane leading to a differential change in the right ascension of the ascending node 2) secular changes in the argument of perigee and mean anomaly due to rotation of the line of apsides in the orbital plane. When including the effect of J2 in the relative formation dynamics, we define the differential disturbance forces acting on the follower with respect to the leader in the LVLH frame. To do this, we must first transform the LVLH coordinates into the ECI frame to calculate the effects of J2. This is done in the following manner. First, defining the leader and follower LVLH positions as rl = [rl , 0, 0] (2.12)

rf = [rf + x, y, z ]

(2.13)

The transformation from LVLH to ECI is first done in three rotations: rotate about the LVLH z-axis by the sum of the argument of perigee and true anomaly (l + ) of the 19

Chapter 2. Fault Detection and Recovery of Spacecraft Formations

Follower

y

r 
x

Z
Earth

r rf
r rl


Leader

z
Perigee

Y X
Figure 2.3: ECI and LVLH coordinate frames for leader-follower spacecraft geometry.

leader satellite. Then, rotate about the new x-axis by the orbital plane inclination il and finally about the new z-axis again by the right ascension of ascending node l of the leader satellite. Defining the appropriate transformation matrices as  cos(l ) - sin(l ) 0 cos(l ) 0 0  (2.14)

 T3 (l ) =   sin(l )

 0  1



   T1 (il ) =  0 cos(il ) - sin(il ) 0 sin(il ) 20 cos(il )

1

0

0

 (2.15)

2.2. SFF Mathematical Model   (2.16)

 T3 (l + ) =   sin(l + ) 0

cos(l + ) - sin(l + ) 0 cos(l + ) 0 1

 0 

The rotation matrix to transform from LVLH to ECI is given as TLE TLE = T3 (l )T1 (il )T3 (l + ) Defining the leader and follower satellite in the ECI frame Rl = TLE rl Rf = TLE rf where Rf = [Xl , Yl , Zl ] and Rl = [Xf , Yf , Zf ] The perturbation force due to J2 on each satellite is given as  {1 - 3µe J2 Re 2   J2l = -  {1 - 2 Rl 5  {3 -  J2 f = - 3µe J2 Re 2    {1 - 5  2Rf {3 - {1 -
5Zl 2 }Xl Rl 2  2  5Zl } Y  l 2 Rl  5Zl 2 }Zl Rl 2 5Zf 2 }Xf Rf 2 2 5Zf }Yf Rf 2 2 5Zf }Zf Rf 2

(2.17)

(2.18) (2.19)

(2.20)

(2.21)

 (2.22)

     (2.23)

where µe is the Earth's gravitational parameter, Re is the radius of the Earth and J2 is the second zonal gravitational coefficient J2 = 1.08263 × 10-3 . Finally, the differential J2 term in the relative dynamics frame can be determined by transforming the difference
-1 back from the ECI frame to the LVLH frame which is given as Fd = TEL [J2f - J2l ].

21

Chapter 2. Fault Detection and Recovery of Spacecraft Formations

2.2.2

Formation Flying Geometry

Desired formation geometry is defined relative to the LHLV frame with the leader satellite at the origin. In this thesis, three formation types will be used to demonstrate the proposed fault detection and control reconfiguration schemes: circular, projected circle and along-track formation. In the circular formation, the leader and follower satellite maintain a fixed distance away from each other at all times while the projected circular configuration maintains fixed distance in the along/cross-track (y/z) plane. Along-track formation maintains the follower spacecraft a fixed distance away without motion in relative frame. The commanded states [xd , x  d , yd , y  d , zd , z d ] were derived mathematically by solving Hill's differential equation through specifying desired formation geometry and imposing non-secular growth initial conditions, as shown in [Sabol 2001]. 1. Circular Formation : In this formation, the leader and the follower spacecraft maintain a constant separation from each other in three-dimensional space and the formation
2 is mathematically defined as x2 + y 2 + z 2 = rc .    m t +  sin      r   xd  c  m t +  =  2 cos  yd   2       m t +  zd 3 sin 

     (2.24)

2. Projected Circular Formation : In this formation, the leader and the follower spacecraft maintains a fixed relative distance when the formation is projected onto the
2 along-track/cross-track (y - z ) plane, and is mathematically defined as y 2 + z 2 = rpc .     m t +  sin    x d     r    pc   = (2.25)  2 cos m t +   yd   2       m t +  zd 2 sin 

3. Along Track Formation : In this formation, the leader and the follower spacecraft maintains a fixed relative distance in the along-track axis defined as x = rat .       1 x d        (2.26) = rat  yd  0        0 zd 22

2.3. Second Order Sliding Mode Observer for Fault Reconstruction Each formation type is defined by a radius rc ,rpc and rat .  is the in-plane phase angle m is the mean anomaly rate between the leader and the follower spacecraft. The variable  specified by
µe a3 c

where ac is the semi-major axis.

2.3

Second Order Sliding Mode Observer for Fault Reconstruction

2.3.1

Literature Review

In the literature, numerous methods exist for estimation and identification of actuator faults for vehicle systems. Most real-time analytical redundancy FDI approaches involve the evaluation of residuals, a value which describes the difference between the expected model and the actual system dynamics. In other words, an internal model of the plant is known to the FDI scheme and sensor feedback is compared to calculate the residual. The residual signals are then processed to determine if a fault has occurred and if so, which sub-system is the fault taking place. The use of sliding mode observers (SMO) is one such method in model-based FDI. SMOs have found uses in many different estimation applications, providing full state feedback from partial state information in the presence of noise and disturbance. SMO estimators have been designed as `virtual sensors' in instances where certain parameters cannot be directly measured due to infeasibility. Additionally, switching mode observers have noticeable resilience to measurement noise similar to that of a Kalman filter [Utkin 2002, Drakunov 1983]. In comparison to other well known or common state estimators, the SMO has been cited as a computationally less complicated approach [Zhurbal 2008]. Another attractive feature about certain SMOs is the ability to operate in the presence of model uncertainties and in some cases, with unknown inputs applied to the system. As a result of this, certain SMO designs can be implemented to aid in detection and reconstruction of faults. In [Talole 2007], using a Luenberger SMO, disturbance applied on an entry guidance system is estimated as well as other system states such as drag and drag rate. Imperfect 23

Chapter 2. Fault Detection and Recovery of Spacecraft Formations knowledge of the plant is used to demonstrate robustness to uncertainties. In a different method [Davila 2005] reconstruction of actuator faults can be obtained by so-called `equivalent output error injection'. This term is the averaged value of the non-linear switching term which arises from the SMO estimator. For instance, in [Yuri B. Shtessel 2010] this work examines SMO fault reconstruction using output equivalent injection analysis for estimating flexible body and sloshing modes for launch vehicles by measuring attitude data. Two methods are presented using the broken super twisting sliding mode observer method. A similar approach in regards to output equivalence injection analysis is employed in [Shraim 2008, Rabhi 2008]. Second order sliding mode differentiators have also been demonstrated to provide estimates of states in scenarios where the derivative of a signal was required to obtain state information. Super twisting differentiators make use of the super twisting algorithm [Levant ]. Much like the above case with the broken super twisting sliding mode observer, the super twisting differentiator can be used for fault detection and various state estimation applications. In [Kazmi 2010], a sliding mode observer is used in parameter estimation for abnormal current levels in a fuel cell system with unknown inputs. In [Benallegue 2008], position, velocity and jerk are estimated from position noise corrupted measurements from an IMU. In the context of spacecraft fault detection, several methods using the sliding mode technique have been shown in the literature. [Jiang 2007] made use of a second order SMO to estimate actuation failures of a reaction wheel system in a pyramid configuration. Using attitude sensor measurements and fault table analysis, failures were identified on four reaction wheels independently. [Wu 2009] presents an attitude control fault detection method using a sliding mode fault detection technique developed by [Edwards 2000]. One unique feature about this technique that is capable of distinguishing sensor and actuator faults so long as they do not occur simultaneously. In [Yuehua Cheng 2008], a Luenberger SMO was developed for microsatellite attitude estimation feedback. Additionally, a sliding mode controller with a built-in attitude perturbation estimator was derived. In [Thein 2008] a Luenberger SMO was developed and compared to an extended Kalman filter for refined attitude state estimation feedback, however, fault detection was not part of the analysis. 24

2.3. Second Order Sliding Mode Observer for Fault Reconstruction In regards to satellite formation flying, there are several areas of work done related to actuator fault detection with the use of sliding mode observers. A large majority of research has been contributed by Qing Wu and Mehrdad Saif which make use of second order sliding mode observers in combination with iterative learning techniques such as fuzzy logic, neural and wavelet networks to detect and isolate faults. In one paper [Wu & Saif 2007], the residual of a second order super twisting sliding mode observer is analyzed with a wavelet network to determine if and where a fault has occurred, as well as the fault magnitude. In a [Wu & Saif ] robust fault diagnosis method is established using a super-twisting second order sliding mode observer and the observer input is analyzed by a PID-type iterative learning algorithm. In [Edwards 2007] the author explores the use of a second order sliding mode observer to reconstruct faults in a leader/follower scenario. The author explicitly states that the FDI SMO observer method by [Edwards 2000] cannot be applied to the spacecraft formation flying problem due to certain restrictions from the plant dynamics. More specifically, the formation flying system is not of minimum phase and relative degree one. Through using a second order super twisting sliding mode observer, actuator faults of the follower satellite are reconstructed by applying a low-pass filter on the output injection signal term. This low-pass filter method is commonly used in many other areas of research in regards to the use of this SMO FDI approach. For instance, in [Kazmi 2010, Shraim 2008, Rabhi 2008] make use of low pass filters to provide smoother estimates of the output injection signal. [Edwards 2007] cites work such as [Davila 2005] as well as [J. Davila 2006] which examines different system identification techniques using the broken super twisting SMO. In the literature fault tolerant control or fault detection are often treated as independent problems, for instance many FDI techniques will discuss fault detection but offer no prognosis to the fault. The converse is also generally true - fault tolerant control law is developed but no form of fault detection is examined. In the case for fault detection and control in satellite formation flying, the problem is sometimes addressed differently: rather than detecting the fault and applying control reconfiguration, a controller is developed which is robust to disturbances or perturbations and actuator faults. This approach, while viable, does not address fault detection directly nor isolate the exact nature of the fault. 25

Chapter 2. Fault Detection and Recovery of Spacecraft Formations In this thesis, an approach similar to the one presented in [Edwards 2007] is adopted with modifications. It is noted that in the literature, most methods which use the broken super-twisting sliding mode observer do not make use of full state sensor feedback. This can be shown in numerous examples such as in [Edwards 2007, May-Win L. Thein 2007, Shraim 2008, Rabhi 2008]. In [Edwards 2007, May-Win L. Thein 2007] only position sensor feedback is used in the state estimation. In many satellite systems, position and linear velocity feedback is usually available to the controller. The super-twisting broken sliding mode observer in its current form cannot accept velocity information without modifications. This thesis presents a simple solution to this by introducing an additional observer to process the velocity information using a super twisting observer and fusing the information with the broken super twisting SMO. While velocity information is not absolutely required, additional information added to the estimation scheme can only enhance its capability. The next section will begin with the mathematical formulation of the broken super twisting observer for fault estimation. After, the the design of a velocity observer will be discussed as well as the information fusion method employed.

2.3.2

Broken Super Twisting Sliding Mode Observer Formulation

Much like most model-based observers, the system plant dynamics are partially known and compared to the measurements. We begin by first expressing a model for the plant system we wish to observe. x  1 = x2 x  2 = f (t, x1 , x2 , u) +  (t, x1 , x2 , u) y = [ x1 , x 2 ] u = U (t, x1 , x2 ) where f (t, x1 , x2 , u) is the non-linear relative spacecraft dynamics with control inputs applied to the system. The  (t, x1 , x2 , u) term represents a portion of the plant which is unknown to the observer. It may represent model imperfections, uncertainties or disturbances. Note that the current formulation of the broken super twisting observer does not make use of the state x2 which represents velocity measurements. This will be addressed 26 (2.27)

2.3. Second Order Sliding Mode Observer for Fault Reconstruction in the information fusion section. Derivations shown here will present a full state feedback observer which only makes use of the x1 position state. The broken super twisting sliding mode observer [Davila 2005] is then formulated as shown below 1 = x x ^ ^ 2 + Z1  2 = f (t, x1 , x x ^ ^ 2 , u ) + Z2

(2.28)

Where Z1 and Z2 are the observer correction variables defined as Z1 = |x1 - x ^1 |0.5 sign(x1 - x ^1 ) Z2 = sign(x1 - x ^1 ) The error dynamics of the observer is given as 1 = x x ~ ~ 2 -  |x ~1 |0.5 sign(~ x1 )  2 = F (t, x1 , x2 , x x ~ ^1 , x ^2 ) - sign(~ x1 ) (2.30) (2.29)

where F (t, x1 , x2 , x ^1 , x ^2 ) is the difference between the observer model plant and the actual plant and x ~1 is defined as the difference between the measurement and estimated state x1 - x ^1 , which is given as: F (t, x1 , x2 , x ^1 , x ^2 ) = f (t, x1 , x2 , u) - f (t, x ^1 , x ^2 , u) +  (t, x1 , x2 , u) |F (t, x1 , x2 , x ^2 )| < f + (2.31) (2.32)

Assuming that the function |F (t, x1 , x2 , x ^2 )| is bounded by f + , then there exists gain values  and  which will allow the observer to converge to the true state of the system. If |F (t, x1 , x2 , x ^2 )| is bounded by a constant value f + , then  > f+ >
2 (+f + )(1+p) -f + (1-p)

(2.33)

0<p<1 The Lyaponov proof of stability for this is given in [Davila 2005]. It can be also shown that other choices for gain values which satisfy the above condition is given as  = 1.1f +  = 1.5(f + )0.5 27 (2.34)

Chapter 2. Fault Detection and Recovery of Spacecraft Formations

2.3.3

Super Twisting Sliding Mode Observer Formulation

The formulation of the super twisting sliding mode observer is actually quite similar to the broken super twisting sliding mode observer. Its purpose in the proposed fault estimation scheme is to process velocity measurements which the previous observer is unable to accommodate. This has been demonstrated in [Kazmi 2010] where rate sensor measurements were used as inputs to the SMO estimator. Given this, it would be useful to take this approach and apply it to fault detection. By processing rate information, a more accurate estimation of faults can be accomplished. The observer equations are as follows: Given we have a plant dynamics equation in the following structure x  2 = f (t, x1 , x2 , u) +  where  is the system disturbance. Rewriting the state equation as x = [x1 , x2 ]T s  = (t, x) +  (t, x)u (2.36) (2.35)

where s(t, x) is designed as the sliding surface. Formulation of the super twisting observer exists provided there are bounded conditions on these terms. M ,m ,  and s0 are positive constants. 0 < m   (t, x)  M |(t, x)|   s s 0 The observer form is given as follows z (t) = z1 (t) + z2 (t)   -u |u| > 1 z 1 =  -sign(s) ^(t, x |u|  1 x 2 = f ^, u) + z (t)   -|s |p sign(s) |s | > s 0 0 z2 =  -|s|p sign(s) |u|  s0 (2.37)

(2.38)

The corresponding sufficient condition for finite time convergence on the true state is 28

2.3. Second Order Sliding Mode Observer for Fault Reconstruction given as:
 >0 m 4 (+) 2  3 M m (-)

>

(2.39)

0 < p  0.5 In [Fridman L.-in W. Perruquetti 2002], it can be shown that the above super-twisting observer can be reduced to the following form. 2 = f ^(t, x x ^ ^1 , x ^2 , u) + z (t) z (t) = z1 (t) + z2 (t) z 1 = -sign(x2 - x ^2 ) z2 = -|x2 - x ^2 |0.5 sign(x2 - x ^2 ) For this thesis, the following super twisting SMO parameters were selected for using velocity as a measurement. The error term to be used in the sliding mode observer will be the difference between the measured and actual relative velocity, x2 - x ^2 . With two observers, one to process position and the other to process velocity measurements, the next step is to fuse the redundant information into a single estimate. Before explaining the information fusion algorithm, it is important to visualize the observer system design. Figure 2.4 illustrates the proposed observer design. (2.40)

2.3.4

Information Fusion

The information fusion technique employed here makes use of a common stochastic framework for fusing measurements. Because the state estimation approach in this thesis uses plant model information, it is possible to generate observer residuals - a term which describes the difference between the estimated and measures states. The aim of information fusion is to obtain an optimal estimate of redundant information. For an unbiased estimator, the optimal choice for this is based on variance minimization. It can be shown [Duta , Sun 2004, Carotenuto 2005] that through choosing weights on measurements based on variance values, one can obtain a linear optimal estimate. Let y ^ = [y1 , y2 ] be a vector of redundant states. Let y ¯ be the linear combination of weighted measurements y ¯ = 1 y1 + 2 y2 29 (2.41)

Chapter 2. Fault Detection and Recovery of Spacecraft Formations

Position Measurement

Broken Super Twisting Sliding Mode Observer

x1

( x, y , z )

^1 x ^2 x Z1 Z2

^2  Z1 x ^1 , x ^2 , u )  Z 2 f (t , x ^1 |0.5 sign( x1  x ^1 ) O1 | x1  x ^1 ) D1sign( x1  x

^, y ^, z ^ ]T ^1 , x ^2 ] [ x ^, x ^, y ^, z [x
residual

Control Input

Plant Model

Information Fusion

U

[U x ,U y ,U z ]

^1 , x ^2 , t , U ) f (x
Super Twisting Sliding Mode Observer

residual

x2 z (t )
Velocity Measurement

^1 , x ^2 , u )  z (t ) f (t , x z1 (t )  z2 (t ) ^2 ) D 2 sign( x2  x ^2 |0.5 sign( x2  x ^2 ) O2 | x2  x
^, y ^, z ^ ]T ^2 ] [ x [x

z1 z2

x2

( x, y , z )

Figure 2.4: Proposed sliding mode observer system for FDI where the weighting values  ^ = [1 , 2 ] are defined as follows k =
1 2 k 2 i=1 1 2 i

(2.42)

Where

1 2 k

is the inverse of the variance of each observer. An intuitive explanation for

this choice of weighting is that the variance is a measure of uncertainty while the inverse of this value gives an indication of the magnitude of information associated with a particular estimate. Given that each sliding mode observer for position and velocity measurement processing outputs residual values, we can calculate the variance of both observers. This is given as:
1
t j =1

k =

1 t

2 (j ) rk

2 i=1

1 t

t j =1

(2.43)

2 (t) ri

Where rk is the residual of each observer, r(t) = e  (t) = [e x, e y , e  z ]. Since this process fuses velocity information, residuals associated with the position state estimates will be discarded. At each time step t, we compute the variance weighting from each residual. 30

2.3. Second Order Sliding Mode Observer for Fault Reconstruction After velocity information has been fused, the resolved observer states will be used to update the plant model along with the control input at that time instance.

2.3.5

Fault Detection with Super Twisting Observer

With state estimation established in the previous section, we now examine the fault detection mechanism which will reconstruct actuator faults and enable the development of a controller reconfiguration scheme to mitigate effects of the fault. The technique employed here is taken from [J. Davila 2006] which demonstrates the use of the super broken twisting algorithm for detection of disturbances. Through using equivalent output injection analysis, it can be shown that for the case when a model of the system is known, external perturbations can be identified. Following the derivations of [J. Davila 2006], we re-write our state equation in the following form x  1 = x2 x  2 = f (t, x1 , x2 ) + uf (t) + u y = [ x1 , x 2 ] u = U (t, x1 , x2 ) Where f (t, x1 , x2 ) represents the three-dimensional non-linear leader/follower relative equation described in Eq. (2.9,2.10,2.11) and u represents the control input which is known to the observer. The uf (t) term contains information related to model uncertainties, disturbances or perturbations. In the context of this thesis, it will represent additive faults on the follower satellite's actuators responsible for maintaining desired relative formation. The associated error equations are written as 1 = x x ^ ^ 2 + Z1  2 = f (t, x x ^ ^1 , x ^ 2 ) + u + Z2 Z1 = |x1 - x ^1 |0.5 sign(x1 - x ^1 ) Z2 = sign(x1 - x ^1 ) 31 (2.44)

(2.45)

(2.46)

Chapter 2. Fault Detection and Recovery of Spacecraft Formations

1 = x x ~ ~2 - |x ~1 |0.5 sign(~ x1 )  2 = F (t, x1 , x2 , x x ~ ^1 , x ^2 ) + uf (t) - sign(~ x1 ) F (t, x1 , x2 , x ^1 , x ^2 ) = f (t, x1 , x2 , u) - f (t, x ^1 , x ^ 2 , u)

(2.47)

(2.48)

When the estimated states converge to the true states (ie: x2 = x ^ 2 , x1 = x ^1 ) and we are left with F (t, x1 , x2 , x ^1 , x ^2 ) = f (t, x1 , x2 , u) - f (t, x ^1 , x ^ 2 , u) = 0  2 = uf (t) - sign(~ x ^ x1 ) = 0 Z2 = sign(~ x1 ) = uf (t) (2.49) (2.50)

Note that in the presence of sensor noise the switching term may produce significant chatter. Using the hyperbolic tan saturation function which replaces the `sign' term is one method of reducing this effect as well as using a low-pass filter to better reconstruct the thruster fault uf (t). The filtered equivalent output injection will take a form such as ¯2 = v=Z 1 Z2 1 + s (2.51)

¯2 represents the filtered output of Z2 using the s-domain transfer function in Where Z Eq.(2.51). The variable  is the filter time constant. Using this as the main fault detection algorithm, the flow chart in Figure 2.4 can be updated as shown in Figure 2.5. With accurate reconstruction of the faults in real-time, fault detection can easily be established by comparing the commanded thrust values with the actual observed thrust values. Before discussing the reconfiguration control laws, initial results of the fault estimation mechanism will be discussed below.

2.4

SFF Thruster Fault Reconstruction with Super Twisting SMO

This section will examine the performance of the proposed fault estimation scheme in the spacecraft formation flying scenario. Using Matlab/Simulink for numerical simulations in ODE45, the thrust failure detection and tracking capabilities of the sliding mode observers 32

2.4. SFF Thruster Fault Reconstruction with Super Twisting SMO

Low Pass Filter

1 1  sW



To Fault Detector & Controller Re-Configuration

Z2
Position Measurement Broken Super Twisting Sliding Mode Observer

x1 [ x, y, z ]T

^1 x ^2 x Z1 Z2

^2  Z1 x ^1 , x ^2 , u )  Z 2 f (t , x ^1 |0.5 sign( x1  x ^1 ) O1 | x1  x ^1 ) D1sign( x1  x

^, y ^, z ^ ]T ^1 , x ^2 ] [ x ^, x ^, y ^, z [x
residual

Control Input

Plant Model

Information Fusion

U

[U x ,U y ,U z ]

^1 , x ^2 , t , U ) f (x
Super Twisting Sliding Mode Observer

residual

x2 z (t )
Velocity Measurement

^1 , x ^2 , u )  z (t ) f (t , x z1 (t )  z2 (t ) ^2 ) D 2 sign( x2  x ^2 |0.5 sign( x2  x ^2 ) O2 | x2  x
^, y ^, z ^ ]T ^2 ] [ x [x

z1 z2

x2

[ x, y, z ]T

Figure 2.5: Proposed sliding mode observer system for FDI. Note that different gain values are assigned for both observers, hence the values 1 ,1 and 2 ,2 .

can be evaluated. The fault is assumed to occur on the follower satellite's thrusters aligned along the LVLH frame. These thrusters are controlled by a PD control law with LQR selected gains. In this simulation, orbital perturbation in the form of relative J2 is modeled and applied on the follower satellite. Multiple simulation scenarios shown here will depict accurate reconstruction of various faults ranging form time-varying to `stuck-closed' type faults on the follower satellite. The observer will receive relative position and velocity information in the leader/follower formation frame and will have knowledge of the commanded inputs of the follower satellite. At a certain time unknown to the controller or observer, an actuator fault is induced. Formation configurations such as along-track, circular and projected circular are tested in this section as well. Below in Table 2.1 is a list of orbital parameters that apply to all the simulation results associated with this section. In terms of sensor modeling, carrier-phase differential GPS (CDGPS) is will be used as 33

Chapter 2. Fault Detection and Recovery of Spacecraft Formations Table 2.1: Orbital Parameters for Leader Satellite Parameter Mass [Kg] Inclination [deg] Agrement of perigee [deg] Agrement of ascending node [deg] Eccentricity Altitude [Km] Value 1 45 0.0 0.0 0.0 500

the relative navigation sensor. The measurement errors associated with these sensors are on the order of 5 cm for relative position and 1 cm/s for relative velocity. The chosen values follow state-of-the-art relative navigation techniques [Ferguson 2001, Bordner 2006]. This is implemented by adding white noise signals to the relative LVLH position and velocity vectors. The variance of the gaussian noise for the relative position and velocity are set to 2 = ( 5 )2 cm2 and  2 = ( 1 )2 cm2 . To demonstrate robustness to uncertainties, the plant 3 3 model contained utilized by the pair of sliding mode observers will have no knowledge of the differential J2 perturbations.

2.4.1

Satellite Formation Flying - Thruster Fault Tracking

We first start by examining the fault detection method in an along-track formation. In this scenario, a formation reconfiguration was defined between 800 (0.0218 orbits) and 1200 ( 0.0327 orbits) seconds which will command the desired relative position from xd = [ 0, 0, manner. As shown in Table 2.2 the thrusters facing the along-track (x) direction will suffer from undesirable sinusoidal time varying thrust while the thrusters aligned in the out of plane (z) axis will be reduced by 50%. Plots for thrust fault detection in the x-y-z axis are shown in Figures 2.6,2.7,2.8 respectively. Even with faults occurring, the sliding mode observer is still capable of tracking system 34
 10 3 3

] to xd = [ 2,

 15 3 , 3



3 3

]. Prior to this, a fault occurs in the following

2.4. SFF Thruster Fault Reconstruction with Super Twisting SMO Table 2.2: Along-track formation faults Thruster Ux [N] Uy [N] Uz [N] t>450 s (0.0123 orbits) Ux cos(t/300) Uy 0.5Ux
X-axis
0.1 0.08 0.06 0.04
Estimated Thrust Actual Thrust Commanded Thrust

Thrust [N]

0.02 0 -0.02 -0.04 -0.06 -0.08 -0.1 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4

Orbit

Figure 2.6: Along-track configuration: Thrust Fault Detection X-axis
Y-axis
0.1 0.08 0.06 0.04
Estimated Thrust Actual Thrust Commanded Thrust

Thrust [N]

0.02 0 -0.02 -0.04 -0.06 -0.08 -0.1 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4

Orbit

Figure 2.7: Along-track configuration: Thrust Fault Detection Y-axis

35

Chapter 2. Fault Detection and Recovery of Spacecraft Formations
Z-axis
0.1 0.08 0.06 0.04
Estimated Thrust Actual Thrust Commanded Thrust

Thrust [N]

0.02 0 -0.02 -0.04 -0.06 -0.08 -0.1 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4

Orbit

Figure 2.8: Along-track configuration: Thrust Fault Detection Z-axis
X
0.1 Error [m] 0 -0.1 0.1 0 -0.1

Y
0.1 0 -0.1

Z

0

0.2

0.4

0

0.2

0.4

0

0.2

0.4

dX/dt
0.01 Error [m/s] 0 -0.01 0.01 0 -0.01

dY/dt
0.01 0 -0.01

dZ/dt

0

0.2 Orbit

0.4

0

0.2 Orbit

0.4

0

0.2 Orbit

0.4

Figure 2.9: Along-track configuration: Observer Error states. Shown in Figure 2.9, it can be seen that the observer converges to the true states well below the standard deviation (0.5 meters) of the applied zero-mean gaussian noise. The exception to this is when faults occur and the error increases momentarily but settles back down to the true state. This sudden discontinuity in error can be explained by the fact that the fault is an un-modeled disturbance which the sliding mode observer must account for in order to properly track system states. Despite these sudden changes in error mismatch, relatively fast convergence is achieved in several seconds. Next, we examine the circular formation scenario. Similar to the previous case, a 36

2.4. SFF Thruster Fault Reconstruction with Super Twisting SMO formation reconfiguration occurs at time 900 and 1200 seconds ( 0.0246 to 0.0327 orbits) which changes the formation radius size from 5 to 10 Km. The fault is given in Table 2.3. Table 2.3: Circular formation faults Thruster Ux [N] Uy [N] Uz [N] t>1000 and t<1500 s (0.0273-0.0409 orbits) 0 0 Uz

As shown in Table 2.3 thrusters in the along and cross track (x-y) plane will reduced to zero during the fault time. Tracking of the thrust faults are shown in Figure 2.10. Observer error in this scenario is shown in Figure 2.11.
X-axis
0.01
Estimated Thrust Actual Thrust Commanded Thrust

Y-axis
0.01

0.005 Thrust [N]

0.005

0

0

-0.005

-0.005

-0.01

0

0.05

0.1

0.15

-0.01

0

0.05

0.1

0.15

Orbit

Orbit

Figure 2.10: Circular formation fault estimation The last case examines thruster fault tracking for the projected circular case. A reconfiguration of formation radius from 5 to 10 Km occurs during 900 - 1700 seconds ( 0.0246 to 0.0464 orbits) with zero thrust available in the along-track and radial direction for approximately 500 seconds. Figures 2.12 and 2.13 show thrust failure tracking and observer error respectively.

37

Chapter 2. Fault Detection and Recovery of Spacecraft Formations
X
0.05 Error [m] 0 -0.05 0.05 0 -0.05

Y
0.05 0 -0.05

Z

0

0.05

0.1

0.15

0

0.05

0.1

0.15

0

0.05

0.1

0.15

dX/dt
0.01 Error [m/s] 0 -0.01 0.01 0 -0.01

dY/dt
0.01 0 -0.01

dZ/dt

0

0.05

0.1

0.15

0

0.05

0.1

0.15

0

0.05

0.1

0.15

Orbit

Orbit

Orbit

Figure 2.11: Circular formation: State observer error
X-axis
0.06 0.04 0.02 Thrust [N] 0 -0.02 -0.04 -0.06
Estimated Thrust Actual Thrust Commanded Thrust

Y-axis
0.06 0.04 0.02 0 -0.02 -0.04 -0.06

0

0.05

0.1

0.15

0

0.05

0.1

0.15

Orbit

Orbit

Figure 2.12: Projected circular formation fault estimation
X
1 Error [m] 0 -1 1 0 -1

Y
1 0 -1

Z

0

0.05

0.1

0.15

0

0.05

0.1

0.15

0

0.05

0.1

0.15

dX/dt
0.1 Error [m/s] 0 -0.1 0.1 0 -0.1

dY/dt
0.1 0 -0.1

dZ/dt

0

0.05

0.1 Orbit

0.15

0

0.05

0.1 Orbit

0.15

0

0.05

0.1 Orbit

0.15

Figure 2.13: Observer error for projected circular orbit

38

2.4. SFF Thruster Fault Reconstruction with Super Twisting SMO Table 2.4 and Figure 2.14 compares the addition and absence of the velocity information fusion which was discussed in the FDI scheme formulation. Mean square error (MSE) between the observer output and the true states are calculated to show that the velocity estimate has been improved. Observer MSE comparison data was taken from the projected circular formation scenario for approximately 1000 seconds (0.0273 orbits). Note that the position state estimates x ^, y ^ and z ^ in Table in 2.4 do not improve substantially with the inclusion of velocity feedback, mostly due the fact that these estimates rely more on the position feedback observer. Table 2.4: MSE comparison between fusion and non-fusion algorithm Thruster x ^ y ^ z ^  x ^  ^ y  ^ z Velocity Fusion MSE [m2 ] 0.3616 0.3579 0.01768 0.0005188 0.0004785 0.001408 No Velocity Fusion MSE [m2 ] 0.3654 0.3579 0.01768 0.06961 0.06766 0.002819

dX/dt
0.7 0.6 Velocity [m/s] 0.5 0.4 0.3 0.2 0 0.02 0.04 0.06
Estimated state Actual state

dY/dt
0.2 0 -0.2 -0.4 -0.6 -0.8 0 0.02 0.04 0.06 1.3 1.2 1.1 1 0.9 0.8 0.7 0 0.02

dZ/dt

0.04

0.06

dX/dt
0.7 0.6 Velocity [m/s] 0.5 0.4 0.3 0.2 0 0.02 0.04 0.06 0.2 0 -0.2 -0.4 -0.6 -0.8 0 0.02

dY/dt
1.3 1.2 1.1 1 0.9 0.8 0.04 0.06 0.7 0 0.02

dZ/dt

0.04

0.06

Orbit

Orbit

Orbit

Figure 2.14: Top: State estimate with velocity fusion. Bottom: State estimate without velocity fusion

39

Chapter 2. Fault Detection and Recovery of Spacecraft Formations

2.5

Underactuated Formation Control Law Design

With a thruster fault detection estimator established, we now focus on developing control laws for controller reconfiguration in the case when the follower satellite becomes underactuated. In context of this section, the underactuated system considered here will encompass the complete failure of one of the three thruster systems needed to maintain relative positioning in the LVLH frame. Control law design for underactuated systems pose numerous challenges to researchers, especially when dealing with non-linear systems in the presence of disturbances. In the literature, it can be seen that sliding mode controllers have been used frequently for its robustness to model uncertainties and disturbances and fast convergence. More specifically, the control law presented in [Godard 2010] will be used as the SFF control strategy. From the relative dynamics equations, it can be seen that there is coupling between the alongtrack (y) and radial (x) direction, making it possible for the development of two independent controllers capable of achieving desired system states should loss of thrust occur on one axis or the other.

2.5.0.1

Sliding Manifold Design

The development of the control laws shown here make use of the linearized state space form of the leader / follower spacecraft dynamics. This is given as the Hill's or the ClohessyWiltshire equation [G.W 1878, Clohessy 1960] which is shown below.              x    0 0 0 0 0 0 0 0 1 0 0 1 0    0    0 0 1     0  0 2    0 0  -2  0 0 0 x   0 0 0       ux      uy      uz  

    y       z     =  x ¨       y ¨   z ¨

0 0 2 0 3 0 0 0

0 2 0 -

    y   0 0 0   z  1    0 0 0 +  mf  1 0 0 x        0 1 0 y     z  0 0 1

(2.52)

where  is the true anomaly of the leader satellite. 40

2.5. Underactuated Formation Control Law Design 2.5.0.2 Case I - Complete Failure of radial (x) axis thruster

In the event we no longer have control along the relative x-axis, we can rewrite the state space formulation in a different coordinate system. The goal of this is to separate the states which have direct control authority from the other underactuated states.
T T

x1 =  A11   0 0 0 0  =  0 0 0 0  2 0 0 0 3   x 1 x 2   A11 0 0 0 1 

x y z x   0

, x2 = 

y  z 

(2.53)

       1 0   0 0 0 - 2       ; A21 =   ; A12 =    0 1  2 0 0  0     2 0  A12  x1 A21 02×2   0 

0

(2.54)

=

   + BU2 ; U2 = 1  uy    mf x2 uz

(2.55)

2.5.0.3

Case II - Complete Failure of along-track (y) axis thruster

Should loss of y-axis along-track control occur, we can go through a very similar approach as in the previous case. Re-formulating our state space equations in a different coordinates as. x1 =  0 0 0 0 A11  x y z y   1 0
T T

, x2 =

x  z 

(2.56)

 (2.57)

       0 0   0 0 0 1  2   3 0 0 -2      =  ; A21 =   ; A12 =   0 1   0 0 0 0  2 0 0 -  0      -2 0 0 0 0 0   x 1 x 2   A11 A12 A21 02×2   x1   0 

=

   + BU2 ; U2 = 1  ux   mf  x2 uz 41

(2.58)

Chapter 2. Fault Detection and Recovery of Spacecraft Formations 2.5.0.4 Control Law Design

The analysis below will examine the error dynamics and the control law derivation which will apply for both radial and along-track under actuated scenarios. Defining the desired trajectory of the relative motion as   x d 1 x d 2   Ad 11 Ad 12
d Ad 21 A22

  xd 1 xd 2

  (2.59)

=

Writing out the error dynamics ei = xi - xd i , we have ¯11 xd + A ¯12 xd e  1 = A11 e1 + A12 e2 + A 1 2 d ¯21 x1 + A ¯22 xd e  2 = A21 e1 + A22 e2 + B2 U2 + A 2 where B2 = [02×2 , I2×2 ]T . ¯ij = Aij - Ad A ij Defining our sliding plane as S = e2 + Ke1 (2.62) (2.61) (2.60)

When the system reaches the sliding surface at some finite time, the sliding plane is set to zero and we are left with S = e2 + Ke1 = 0 e2 = -Ke1 Substituting this back into the error equations ¯11 xd ¯ d e  1 = (A11 - A12 K )e1 + A 1 + A12 x2 (2.64) (2.63)

For motion constrained to the sliding surface (ie: after reaching the sliding manifold at some finite time), trajectory of the reduced-order system will be dictated by the above error dynamics. Thus, appropriate choices of weight gains K must be selected. In this thesis, Matlab's Linear Quadratic Regression (LQR) was chosen to select gain values with the A matrix set to A11 and the B matrix set to A12 . Given our defined sliding plane, we can now choose our Lypanonov candidate function as 42

2.5. Underactuated Formation Control Law Design

V =1 ST S 2  = ST S  V  = S T (e V 2 + K e  1 ) = S T (¨ x2 - x ¨d 1) 2 + Ke Substituting the SFF dynamics into the Lyaponov function  = S T (e 1) V 2 + K e  1 ) = S T (F (x, t) + U2 - x ¨d 2 + Ke  = S T (F (x, t) + U2 - x V ¨d 1) 2 + Ke  = S T (f (x, t) +  + Fdt + U2 - x V ¨d 1) 2 + Ke

(2.65) (2.66)

(2.67)

where F (x, t) is the full non-linear dynamics which also includes the spacecraft differential disturbances and uncertainties unknown to the controller. This term can be written as the sum of the linear component, non-linear terms and orbital disturbances F (x, t) = f (x, t) +  + Fdt . A simple approach to simplify the stability analysis is to assume that these terms are upper bounded by a Lipschitz constant [Godard 2010]. The desired trajectory can also be expressed in a similar way. |||| < L ||Fdt || < LFdt (2.68)

where L and Fdt are the Lipschitz constants associated with each term. Given that these bounds exists, then there exists a second order polynomial function that bounds the lumped nonlinearities and disturbances which can be expressed as follows  =  + Fdt || ||   be negative definite. This can be made possible by choosing our control term to be  1 -  sgn(S ) U2 = -f (x, t) + x ¨d 2 - Ke (2.70)

(2.69)

To achieve Lyaponov stability, the time rate of change of our candidate function must

where sgn represents the sign function which returns either 1 or -1 and  =diag{1 , 2 } is a positive definite matrix. If we substitute this control law back into our Lyaponov candidate function, we find that our negative definite condition is satisfied provided if  is 43

Chapter 2. Fault Detection and Recovery of Spacecraft Formations chosen large enough in magnitude to overcome the bounded difference between the linear and non-linear dynamics  .  = S T (e V 2 + K e  1 ) = S T (F (x, t) + U2 - x ¨d 1) 2 + Ke  = S T (F (x, t) + U2 - x V ¨d 1) 2 + Ke  = S T (f (x, t) +  + Fdt + (-f (x, t) + x V ¨d - K e  1 - sign(S )) - x ¨d + K e 1)
2 2

(2.71)

 = S T ( - sign(S )) V if we choose min ( ) > || || then we have  = S T ( - sign(S )) < 0 V (2.73) (2.72)

An alternative to the discontinuous sign function is to choose a continuous saturation function such as hyperbolic tangent function. This choice has no effect on the closed-loop trajectories, except when on the sliding surface [Edwards C 1998]. It should be noted that the proposed control methodology here lacks full plant model knowledge such as nonlinearities and disturbances.

2.6

SFF Fault Detection and Recovery

With the control formulation now established, the next step is to integrate it with the sliding mode observer fault detection scheme for control reconfiguration. Using equivalent injection analysis described in section 2.3.3 , we are able to determine which thruster is at fault by comparing the reconstructed thruster signal with the commanded signal. If the difference exceeds a minimum threshold after certain duration, control reconfiguration commands will take place. The over-all process can be shown in Figure 2.15 which depicts a flow chart of the fault detection and recovery scheme. After controller reconfiguration has been executed, the fault detection will continuously compare commanded thrust and re-constructed thrust signals incase the system returns to 44

2.6. SFF Fault Detection and Recovery

Controller Reconfiguration Command

Thrust Residual

_

Thrust Force Estimate

^ U

^ ,U ^ ,U ^ ] [U x y z

Sliding Mode Fault Observer

Switching Command Relative Position Measurement

[ x, x, y , y , z , z ]
Re-configurable Control Law Fully Actuated Control Mode Control Input No X-axis Control Mode

U

[U x , U y , U z ]

+

Non-linear SFF Plant Dynamics

State Output

+

No Y-axis Control Mode

Sensor Noise

Actuator Faults

Relative Position Command

Figure 2.15: SFF Fault Estimation Flow Chart - Fault detection and Controller reconfiguration a fully actuated state. Once the disparity between the commanded thrust and estimated thrust falls below the fault threshold, the controller will be commanded to reconfigure back to its original fully actuated control mode. The results shown here demonstrate the successful detection and recovery of a follower satellite suffering from thruster stuck-close faults. Thruster failures have been induced at various times unknown to the controller and observer. Additionally, differential J2 disturbance and CDGPS noise are applied to show further functionality in the presence of uncertainties. The orbital and fault parameters for the first simulation case are listed in Table 2.5. Defining a projected circular formation as the desired trajectory for five orbits, faults will occur for the along-track and radial thrusters specified in Table 2.6. Figure 2.16 displays the resulting behavior of the system if fault recovery is not applied on the formation scenario. Note the large errors in the relative x-axis frame which greatly 45

Chapter 2. Fault Detection and Recovery of Spacecraft Formations Table 2.5: Orbital Parameters for Follower Satellite Parameter Mass [Kg] Inclination [deg] Agrement of perigee [deg] Agrement of ascending node [deg] Eccentricity Altitude [Km] Value 1 45 0.0 0.0 0.0 500

Table 2.6: Projected circular formation faults Thruster Ux [N] Uy [N] Uz [N] t>0.72 and t<1.25 orbits 0 Uy Uz t>1.6 and t<2.13 orbits Ux 0 Uz

exceeds the bounds of the errors found in the fault recovery plot shown in Figure 2.17. The y -axis errors from actuator faults are far much less in magnitude but are still greater than controller error in the fault recovery scenario. When the system returns to its nominal fully functional state, controller errors settle to sub-meter accuracy, however should the fault persist indefinitely the system would surely experience unstable tracking behavior. The next plots describe formation flying scenario with fault detection and recovery applied. Both the x and y axis thrusters of the follower satellite will experience complete failures at times specified in Table 2.6 . From Figure 2.18, we can see that during the specified fault times, the thrust estimation tracks the true actuation while the commanded thrust deviates. From the results in Figure 2.17 and 2.20, it can be seen that the relative formation keeping trajectory remains relatively undisturbed by actuator faults due to successful controller reconfiguration. Position errors were noted to reach approximately 2 meters during the under-actuated phase of the simulation. During the transition from one control mode to the next, the 46

2.6. SFF Fault Detection and Recovery
150 100 50 0 -50 -100 X Y Z

Position Error [m]

0

0.5

1 Orbits

1.5

2

2.5

0.01

0.005 Thrust [N]

0

-0.005

-0.01

0

0.5

1 Orbits

1.5

2

2.5

Figure 2.16: No recovery applied to SFF - Projected Circle Formation

observer error plots in Figure 2.19, it can be seen that the error increases momentarily. This can be explained by the sudden action of the fault being applied on the system; the sliding mode observer must keep track of the system states and as a result slight abrupt jumps in error will occur during the start and end times of actuator faults. Similarly, the control effort plot seen in Figure 2.17 depicts abrupt changes in thrust. This is also related to the transitionary phase between switching control modes, mostly from switching from an under-actuated control mode to a fully-actuated mode. In the underactuated mode, the relative formation errors are usually greater than in the fully actuated case, thus when a fault ends and the fully actuated control mode is active, it applies abrupt control effort to stabilize the system from the remaining error left over by the previous mode. The right plot in Figure 2.17 depicts the fault detector logic. In this context, the value of one denotes a healthy functional controllable axis while a value of zero denotes no thrust 47

Chapter 2. Fault Detection and Recovery of Spacecraft Formations
15 10

Position Error [m]

5 0 -5
X

-10 -15 0 0.5 1 1.5 2

Y Z

2.5

Orbits
Fault Detector 0.01 2 1.5

Control Mode

0.005

Thrust [N]

1 0.5 0 -0.5
X-axis Y-axis

0

-0.005

-0.01

0

0.5

1

1.5

2

2.5

-1

0

0.5

1

1.5

2

2.5

Orbits

Orbits

Figure 2.17: Top: Controller Error - Relative position, Bottom Left: Control Effort, Bottom Right: Fault Detector Logic

available. Fault detection is accomplished by comparing the estimated thrust with the commanded control signal. If the difference passes a specified constant threshold, then a fault occurs and the fault detector logic will change to zero to signify no control is available. When selecting a threshold level, noise in the estimation due to imperfect differential GPS measurements must be taken into account. Generally, the smaller the threshold the faster re-configuration will take place and the less thrust is consumed due to less time spent in an in-effective control mode. The trade off however, is that a lower the fault threshold may increase the chances of incorrect controller reconfiguration. A too small of a threshold value will be sensitive to noise and can inadvertently cause the control to re-configure at the wrong instance. Finally 2.21 and 2.22 depict the estimated states versus the measured 48

2.6. SFF Fault Detection and Recovery
x 10
-3

X-axis Thrust Estimate 1

1

x 10

-3

Y-axis Thrust Estimate

0.5 Thrust [N]

0.5

0

0

-0.5

-0.5

-1

0

0.5

1

1.5

2

2.5

-1

0

0.5

1

1.5

2

2.5

1

x 10

-3

X-axis Commanded/Actual Thrust 1

x 10

-3

Y-axis Commanded/Actual Thrust
Actual Thrust Commanded Thrust

0.5 Thrust [N]

0.5

0

0

-0.5
Actual Thrust Commanded Thrust

-0.5

-1

0

0.5

1 Orbits

1.5

2

2.5

-1

0

0.5

1 Orbits

1.5

2

2.5

Figure 2.18: Thruster Fault Estimator - Projected Circle Formation
X
0.05 0.05 0 -0.05

Y
0.05 0 -0.05

Z

Error [m]

0 -0.05

0

0.5

1

1.5

2

2.5

0

0.5

1

1.5

2

2.5

0

0.5

1

1.5

2

2.5

dX/dt
0.01 0.01 0 -0.01

dY/dt
0.01 0 -0.01

dZ/dt

Error [m/s]

0 -0.01

0

0.5

1

1.5

2

2.5

0

0.5

1

1.5

2

2.5

0

0.5

1

1.5

2

2.5

Orbits

Orbits

Orbits

Figure 2.19: Observer Error - Projected Circle Formation states.

49

Chapter 2. Fault Detection and Recovery of Spacecraft Formations

Fault Detection and Recovery - projected circle formation

0.6 0.4 0.2 Cross Track [km] 0 -0.2 -0.4 -0.6 -0.8 1 0.5 0.2 0 -0.5 Along Track [km] -1 -0.3 -0.4 Radial [km] -0.1 -0.2 0.1 0 0.3

Figure 2.20: Follower satellite trajectory in relative frame - Projected Circle Formation

50

2.6. SFF Fault Detection and Recovery

X measurement
500 [m] 0 -500 1000 0 -1000

Y measurement
1000 0 -1000

Z measurement

0

0.5

1

1.5

2

2.5

0

0.5

1

1.5

2

2.5

0

0.5

1

1.5

2

2.5

X Estimate
500 [m] 0 -500 1000 0 -1000

Y Estimate
1000 0 -1000

Z Estimate

0

0.5

1 1.5 Orbits

2

2.5

0

0.5

1 1.5 Orbits

2

2.5

0

0.5

1 1.5 Orbits

2

2.5

Figure 2.21: Measured (Top) and Estimated (Bottom) relative state position - Projected Circle Formation

dX/dt measurement
0.5 [m/s] 0 -0.5 1 0 -1

dY/dt measurement
1 0 -1

dZ/dt measurement

0

0.5

1

1.5

2

2.5

0

0.5

1

1.5

2

2.5

0

0.5

1

1.5

2

2.5

dX/dt estimate
0.5 [m/s] 0 -0.5 1 0 -1

dY/dt estimate
1 0 -1

dZ/dt estimate

0

0.5

1 1.5 Orbits

2

2.5

0

0.5

1 1.5 Orbits

2

2.5

0

0.5

1 1.5 Orbits

2

2.5

Figure 2.22: Measured (Top) and Estimated (Bottom) relative state position - Projected Circle Formation

51

Chapter 2. Fault Detection and Recovery of Spacecraft Formations The next set of plots in Figure 2.23 and 2.24 show the fault detection and recovery scenario, this time however, in an along-track formation of 500 meters away from the leader satellite. Using the same fault profile as in the projected circle formation, from Figure 2.23, we can see that the error is well bounded after reconfiguration. Observer error is the difference between the true plant state and the SMO estimator. Figures 2.25,2.26 and 2.27 depict this error.
0.5

Position Error [m]

0

-0.5

-1

X Y Z

-1.5

0

0.5

1

1.5

2

2.5

Orbits
x 10
-3

Fault Detector 2 1.5
X-axis Y-axis

1

Control Mode
0 0.5 1 1.5 2 2.5

0.5

Thrust [N]

1 0.5 0 -0.5

0

-0.5

-1

-1

0

0.5

1

1.5

2

2.5

Orbits

Orbits

Figure 2.23: Left Top: Controller Error - Relative position, Left Bottom: Control Effort, Left: Fault Detector - Along Track Formation

52

2.6. SFF Fault Detection and Recovery

x 10 1

-3

X-axis Thrust Estimate 1

x 10

-3

Y-axis Thrust Estimate

0.5 Thrust [N]

0.5

0

0

-0.5

-0.5

-1 0 0.5 1 1.5 2 2.5

-1 0 0.5 1 1.5 2 2.5

x 10 1

-3

X-axis Commanded/Actual Thrust 1

x 10

-3

Y-axis Commanded/Actual Thrust

0.5 Thrust [N]

0.5

0

0

-0.5
Actual Thrust Commanded Thrust

-0.5
Actual Thrust Commanded Thrust

-1 0 0.5 1 Orbits 1.5

-1 0 0.5 1 Orbits 1.5

2

2.5

2

2.5

Figure 2.24: Thruster Fault Estimator - Along Track Formation

X
0.05 0.05 0 -0.05

Y
0.05 0 -0.05

Z

Error [m]

0 -0.05

0

0.5

1

1.5

2

2.5

0

0.5

1

1.5

2

2.5

0

0.5

1

1.5

2

2.5

dX/dt
0.01 0.01 0 -0.01

dY/dt
0.01 0 -0.01

dZ/dt

Error [m/s]

0 -0.01

0

0.5

1

1.5

2

2.5

0

0.5

1

1.5

2

2.5

0

0.5

1

1.5

2

2.5

Orbits

Orbits

Orbits

Figure 2.25: Observer Error - Along Track Formation

53

Chapter 2. Fault Detection and Recovery of Spacecraft Formations

X measurement
0.5 [m] 0 499 -0.5 0 0.5 1 1.5 2 2.5 498 0 501 500

Y measurement
0.1 0 -0.1

Z measurement

0.5

1

1.5

2

2.5

0

0.5

1

1.5

2

2.5

X Estimate
0.5 [m] 0 -0.5 500.5 500 499.5

Y Estimate
0.1 0 -0.1

Z Estimate

0

0.5

1 1.5 Orbits

2

2.5

0

0.5

1 1.5 Orbits

2

2.5

0

0.5

1 1.5 Orbits

2

2.5

Figure 2.26: Measured (Top) and Estimated (Bottom) relative state position - Along Track Formation

dX/dt measurement
0.04 [m/s] 0.02 0 0 -0.02 0 0.5 1 1.5 2 2.5 -0.05 0 0.05

dY/dt measurement
0.02 0 -0.02

dZ/dt measurement

0.5

1

1.5

2

2.5

0

0.5

1

1.5

2

2.5

dX/dt estimate
0.1 [m/s] 0 -0.1 0.1 0 -0.1

dY/dt estimate
0.1 0 -0.1

dZ/dt estimate

0

0.5

1 1.5 Orbits

2

2.5

0

0.5

1 1.5 Orbits

2

2.5

0

0.5

1 1.5 Orbits

2

2.5

Figure 2.27: Measured (Top) and Estimated (Bottom) relative state velocities - Along Track Formation

54

2.7. Summary

2.7

Summary

In this chapter a fault estimation scheme was demonstrated in a satellite formation flying scenario. Fault reconstruction and detection is accomplished through the use of a super twisting sliding mode observer which was used to compare estimated output thrust to the commanded thrust force on the follower satellite. Modifications to existing broken supertwisting sliding mode observer theory is explored to accommodate additional sensor readings for velocity states. Using a basic information fusion process, both relative spacecraft position and velocity measurements are taken into account. In addition to fault reconstruction using the equivalent output error injection method, the observer is also shown to be resilient to disturbances in the form of measurement noise and J2 orbital perturbations. A re-configurable control law using the above fault estimation technique is employed to recover from the follower spacecraft when in an underactuated state. The re-reconfigurable controller was shown to stabilize to the desired system in different failure modes (no control along the radial and cross-track axes) through the use of a nonlinear variable structure controllers (VSC) designed for underactuated scenarios. Using a linearized model of the system dynamics and lacking orbital disturbance information, the controller converged to the desired state despite model mismatch. The next chapter deals with applying the same fault estimation techniques for attitude control of spacecraft systems. Similarly, a re-configurable control law will be designed and demonstrated for different fault modes.

55

Chapter 3

Spacecraft Attitude Fault Detection and Recovery

T

he attitude control sub-system of a spacecraft is critical for the success of many space missions. Precise pointing accuracy capability is required to accommodate the needs

of the payload customer, as well as communication to the ground station during operation. In the presence of external disturbances such as gravity gradient, aerodynamic drag, solar radiation pressure and magnetic torques, robust design of the ACS must be considered. With a large emphasis on attitude control, it is desirable to ensure that a spacecraft's attitude control system is also fault tolerant. One of the major cause of failures of a satellite is to lose attitude control. Recovering to an acceptable performance level from loss of attitude actuation has already been demonstrated for several missions [Lam 2001] [Jerey W. 2002]. However, three-axis stabilization was performed by using on-board redundant hardware in the form of additional reaction control thrusters and magnetic torque bars. With the future shifting to smaller satellite system designs, it is desirable to limit the level of hardware redundancy for attitude actuation due to insufficient space and stringent constraints on mass and power. The call for such requirements and the increased reliance on autonomous fault detection and recovery will be the main motivation behind this work. As such, an appropriate and feasible fault estimation and recovery methodology using analytical redundancy will be investigated.

3.1

Spacecraft Attitude Mathematical Model

We begin the design of the attitude fault detection and recovery algorithm by first defining the equations of motion which govern attitude dynamics of a rigid body spacecraft. As 57

Chapter 3. Spacecraft Attitude Fault Detection and Recovery mentioned earlier, the derivation of this control law is done in the ECI frame. From there, the non-linear re-configurable control law can be derived. The Earth centered inertial (ECI) frame defined by I - XI YI ZI in Figure 3.1 with its origin located at the center of the Earth, the ZI -axis passing through the celestial North pole, the XI -axis directed towards the vernal equinox, and the YI -axis being remaining orthogonal axis. The spacecraft body rotates about Earth defined by the true anomaly  at a distance R. The spacecraft's body rotates with respect to the local vertical local horizontal frame (LVLH) defined as L - x0 y0 z0 . The body frame which remains fixed to the spacecraft's principal axis is represented by the frame B - x y z .
y, y0

 (roll )

x, x0

ZI

 ( yaw)

Earth

ca l Lo


al rtic e V
r R
z , z0  ( pitch)

Perigee
YI

Figure 3.1: Geometry of orbit motion of rigid spacecraft. Rotations will be defined using the 3-2-1 Euler sequence (, ,  ) convention, where  (pitch) rotates about the z -axis (3),  (roll) about the new y -axis (2), and finally  (yaw) about the resulting x-axis (1). The orientation of the body frame with respect to the LVLH frame can be represented by a single directional cosine matrix which is given by equation 3.1. This matrix arises from the product of the three aforementioned rotations defined as C B/L = R1 ( )R2 ()R3 () = Rx ( )Ry ()Rz (), where Rx ( ) denotes the rotation matrix for  rotation about the x-axis, Ry () denotes the rotation matrix for  rotation about the y -axis, and Rz () denotes the rotation matrix for  rotation about the z -axis. 58

O

rb it

XI

3.1. Spacecraft Attitude Mathematical Model   (3.1)

   C B/L =  s  s  c  - c  s  s  s  s  + c  c  s  c    c s c + s s c s s - s c c c

c c

c s

-s

With relation from body frame to LVLH frame established, we now define the spacecraft's angular velocity. For a rigid spacecraft in an elliptical orbit around the Earth, the angular velocity of the body-fixed frame B relative to the ECI frame I expressed in the body frame B is given by  B/I =  B/L +  L/I (3.2)

where  B/L represents the angular velocity of the body frame with respect to the LVLH L - x0 y0 z0 and  L/I represents the angular velocity of the LVLH frame with respect to the ECI frame expressed in the body frame B. Through taking the time derivative of (Eq 3.1), one can obtain an expression for  B/L . Similar analysis can be done to derive  L/I by transforming the true anomaly to the body frame B from the ECI frame. Through further derivation, one can expand the angular velocity expression ( Eq. 3.2 ) to obtain 
B/I

 B/I  y  B/I z

x

  - sin          =  0 cos  sin  cos             +   sin  cos    cos  cos  0 - sin  cos  cos    1 0 - sin  

    (3.3)

The equations of motion a spacecraft's orientation is given by Euler's rigid body equation which is a function of the system inertia Ix ,Iy and Iz along the principal axis as well as the body rates  B/L .

B/I B/I B/I Tx = Ix  x - (Iy - Iz )y z B/I B/I B/I Ty = Iy  y - (Iz - Ix )z x B/I B/I B/I Tz = Iz  z - (Ix - Iy )x z

(3.4) (3.5) (3.6)

Substituting the angular velocity into the rigid body equation of motion, we arrive at the following differential equations (Eqs. 3.7,3.8,3.9 ) which governs the attitude dynamics of the spacecraft for the pitch-, roll- and yaw- axis. 59

Chapter 3. Spacecraft Attitude Fault Detection and Recovery

 cos  cos  -  sin  - (1 - kxz + kyz )(1 +  ) sin  cos  -(1 - kxz - kyz )[(1 +  ) cos  sin  -   cos  ] Tx +(kxz - kyz )(1 +  )2 sin  cos  sin  = 2 Ix  (3.7)

kyz  cos  sin  + kyz  cos  - (1 - kxz + kyz )(1 +  ) sin  cos  -(1 - kxz - kyz )[(1 +  ) cos  cos  -   sin  ] Ty +(1 - kxz )(1 +  )2 sin  cos  cos  = 2 Iy  (3.8)

- kxz  sin  + kxz  + [(1 - kyz ) cos 2 - kxz ](1 +  ) cos  +(1 - kyz )[(1 +  )2 cos2  - 2 ] sin  cos  Tz = 2 Iz  The constants Kxy and Kyz represent ratios of inertial terms given as Iz - Ix Iy Iz - Iy k2 = Ix Ix 1 - k1 = Iz 1 - k1 k2 Iy 1 - k2 = = Iz 1 - k1 k2

(3.9)

k1 =

and and

kxz = kyz

(3.10) (3.11)

For the set of differential equations describing attitude dynamics, the derivative of the generalized coordinate q = [, ,  ]T , is express with respect to the true anomaly using the relations given below:
2  = µa(1 - e ) q q  = q R2 µ q ¨ = [(1 + e cos )q - 2q e sin ] R3

(3.12) (3.13)

where the orbital radius R is described as a function of the semi-major axis a, eccentricity e and the gravitational constant µ. Note that (Eqs. 3.7,3.8 and 3.9) assume eccentricity is zero. 60

3.1. Spacecraft Attitude Mathematical Model

a(1 - e2 ) µ1/3 (1 - e2 ) R= = 2/3 1 + e cos   (1 + e cos )

(3.14)

Because the spacecraft is not treated as a trivial point mass object, disturbance torques will arise due to the inertial properties of the system; ie: gravitational forces acting on point massses of the satellite will cause moments. This can be accounted for by adding gravity gradient torques terms into the equations of motion, which are defined in (Eq. 3.15).

Tx = -

3µ (Iyy - Izz )(cos  sin  cos  + sin  sin  )(cos  sin  sin  - sin  cos  ) R3 3µ Ty = - 3 (Izz - Ixx )(cos  sin  cos  + sin  sin  )(cos  sin ) (3.15) R 3µ Tz = - 3 (Ixx - Iyy )(cos  sin sin - sin  cos  )(cos  cos ) R

Through much algebraical manipulation and non-dimensionalization, the resulting nonlinear ordinary differential equation with gravity gradient disturbances can be expressed in the following form.          U   F         F  +  U           F U

 N11 N12 N13       =  N21 N22 N23     N31 N32 N33

(3.16)

where F , F , and F are the nonlinear terms given by F = p cos  cos  + p cos  sin  - p sin  F = -p sin  + p cos  F = p The coefficients p , p , and p in Eq. (3.17) are p = [(1 - kxz + kyz )(1 +  ) sin  cos  ] - (kxz - kyz )(1 +  )2 sin  cos  sin  + (1 + kxz - kyz )[(1 +  ) cos  sin  +   cos  ] - 3(kxz - kyz )(cos  sin  sin  - sin  cos  ) cos  cos  61 (3.17)

Chapter 3. Spacecraft Attitude Fault Detection and Recovery p = [(1 - kxz + kyz )(1 +  ) sin  sin  ] - (1 - kxz )(1 +  )2 sin  cos  cos  + (1 - kxz - kyz )[(1 +  ) cos  cos  -   sin  ] + 3(1 - kxz )(cos  sin  cos  + sin  sin  ) cos  cos  p = [kxz - (1 - kyz ) cos 2 ](1 +  ) cos  - (1 - kyz )[(1 +  )2 cos2  -  2 ] sin  cos  + 3(1 - kyz )(cos  sin  cos  + sin  sin  ) (cos  sin  sin  - sin  cos  ) The elements of the matrix N in (Eq. 3.32) are given by        sin2  + kyz cos2  kyz cos2  (1 - kyz ) sin  cos  kyz cos  sin (sin2  + kyz cos2  ) kyz cos2  (1 - kyz ) sin  cos  kyz cos  2 cos  + kyz sin2  kyz (1 - kyz ) sin  cos  sin  kyz cos  sin (sin2  + kyz cos2  ) kyz cos2  (1 - kyz ) sin  cos  sin  kyz cos  sin2 (sin2  + kyz cos2  ) + 1 kxz kyz cos2        

The control torque U = [U , U , U ]T is assumed to be non-dimensionalized in (Eq.3.32) and also includes disturbance torques such as solar radiation pressure and aerodynamic drag, which will be defined in a later section. For short-hand notation, the non-linear attitude dynamic equations of motion will be written in the following manner. q = N (q )[F (q, q ) + U ] Where  N11 N12 N13   F   U  (3.19) (3.18)

           F ( q, q ) = U = N (q ) =  N N N F U 22 23   21       N31 N32 N33 F U

3.2

Proposed Attitude Fault Detection Algorithm
Nu-

In the literature it can be seen that much work has been done on fault detection and recovery in the context of attitude actuators for spacecraft systems. merous approaches may include the use of Kalman filtering, statistical inference, 62

3.2. Proposed Attitude Fault Detection Algorithm least squares residual generation and diagnostic fault tree analysis, to name a few [Li 2011][Tudoroiu 2006][Barua 2009][Jiang 2008]. In many of these examples, fault isolation is considered, which allows the exact knowledge of which sub-system in the actuator module is at fault. In such cases, parameter estimation is often applied to determine the health or status of each of the fail-prone components in actuator system. Such parameters may include properties of the actuator that cannot be directly measurable; using a reaction wheel as an example, such estimated parameters may include bus voltage of a reaction wheel, current drawn, bearing friction and back EMF [Jiang 2008]. In this thesis, a fault reconstruction approach was selected which immediately gives information on the magnitude and severity of the fault. Rather than estimate parameters of an actuator, estimation of the true actuation output is done instead. This method was chosen as it provides critical information of actuator effectiveness which can be utilized for controller reconfiguration. Effectiveness of the actuator can be measured by comparing the desired/commanded spacecraft torque with the estimated torque. If the difference deviates past a certain threshold, controller reconfiguration will take place to mitigate the severity of the loss of attitude effectiveness. Unlike traditional fault recovery techniques, the method employed here will not use hardware redundancy; rather, it will be capable of stabilizing attitude dynamics if either the roll or yaw actuation axis remain functional. The choice of fault reconstruction algorithm will be the broken and non-broken super twisting sliding mode observer. Similar to what was done in the satellite formation flying chapter, two observers will be developed, each processing angular position and velocity measurements independently and updating an observer plant model. In the literature, there are numerous cases of the utilization of sliding mode observers for estimating attitude actuator faults [He 2009],[Wu 2007], however most do not use the broken super twisting method for attitude faults. Some of the methods in the aforementioned literature demand requirements such as relative degree and observability, and in some cases, a linearized plant model which may lead to tracking inaccuracies [Edwards 2000]. The sliding mode observer technique offers several advantages, such as taking into account non-linear attitude dynamics and being robust to uncertainties and sensor noise. Another advantage includes the observer's relative simplicity compared to other more common methods [Zhurbal 2008] 63

Chapter 3. Spacecraft Attitude Fault Detection and Recovery which may be too computationally costly.

3.2.1

Fault Detection with Super Twisting Observer

Using the same fault detection technique from the previous chapter, we now apply the same methodology of estimating attitude faults on a satellite which will later be used to enable successful controller reconfiguration to mitigate effects of the fault. The technique employed here is taken from [J. Davila 2006] which demonstrates the use of the super broken twisting algorithm for detection of disturbances. Through using equivalent output injection analysis, it can be shown that for the case when a model of the system is known, external perturbations can be identified. Given our state equation describing the spacecraft attitude behavior as q (t, q, q , U ) = N (q )[F (q, q ) + U ] from Eq. 3.19, we can define our states in the context of the super twisting observer format. With x1 = q and x2 = q . x  1 = x2 x  2 = N (x1 )[F (x1 , x2 ) + U + Uf ] y = [ x1 , x 2 ] u = U (t, x1 , x2 ) The Uf term contains information related to model uncertainties, disturbances or perturbations. In the context of this thesis, it will represent additive faults on the spacecraft's torque actuators. The associated error equations are written as 1 = x x ^ ^2 + Z1  2 = N (x ^ (x x ^ ^1 )[F ^1 , x ^2 ) + U ] + Z2 Z1 = |x1 - x ^1 |0.5 sign(x1 - x ^1 ) Z2 = sign(x1 - x ^1 ) 1 = x x ~ ~ 2 -  |x ~1 |0.5 sign(~ x1 )  2 = Q(t, x1 , x2 , x x ~ ^1 , x ^2 ) + N (x1 )Uf - sign(~ x1 ) Q(t, x1 , x2 , x ^1 , x ^2 ) = N (x1 )F (t, x1 , x2 , u) - N (^ x1 )F (t, x ^1 , x ^ 2 , u) 64 (3.20)

(3.21)

(3.22)

(3.23)

(3.24)

3.3. Proposed Fault Recovery Algorithm In finite time, the estimated states converge to the true states (ie: x2 = x ^ 2 , x1 = x ^1 ) and we are left with Q(t, x1 , x2 , x ^2 ) = f (t, x1 , x2 , u) - f (t, x ^1 , x ^ 2 , u) = 0 2 = N (x1 )Uf - sign(~ x ^ x1 ) = 0 Z2 = sign(~ x1 ) = N (x1 )Uf N -1 (x1 )Z2 = Uf Note that in the presence of sensor noise the switching term may produce significant chatter - the hyperbolic tangent saturation function is one method of reducing this effect as well as using a low-pass filter to better reconstruct the thruster fault Uf (t). The filtered equivalent output injection will be given as ¯2 = v=Z 1 N -1 (x1 )Z2 1 + s (3.27) (3.26) (3.25)

¯2 represents the filtered output of Z2 and  is the filter time constant. With where Z accurate reconstruction of the faults in real-time, fault detection can easily be established by comparing the commanded thrust values with the actual observed thrust values. Figure (3.2) shows a flow chart of the complete observer process in the context of attitude fault detection.

3.3

Proposed Fault Recovery Algorithm

With the choice of the attitude fault estimator established, we now examine the reconfigurable controller. In the literature of controller reconfiguration for satellite attitude sub-systems, many techniques involve the use of redundant hardware to mitigate effects of faults. For instance, in one particular case the Far Ultraviolet Spectroscopic Explorer (FUSE) satellite was performing various payload related objectives when two of the four reaction wheels became non-functional due to excessive friction between the rotor and wheel housing [Jerey W. 2002]. Manual controller reconfiguration was applied by uploading a reprogrammed control algorithm which integrated magnetic torquer bars in the control loop along with the remaining two reaction wheels [Roberts 2004]. Similarly, in a scenario 65

Chapter 3. Spacecraft Attitude Fault Detection and Recovery

Low Pass Filter

1 1  sW



To Fault Detector & Controller Re-Configuration

^1 ) Z 2 N 1 ( x
Angular Position Measurement Broken Super Twisting Sliding Mode Observer

x1

(D , I , J )

^1 x ^2 x Z1 Z2

^2  Z1 x ^1 , x ^2 , u )  Z 2 f (t , x ^1 |0.5 sign( x1  x ^1 ) O1 | x1  x ^1 ) D1sign( x1  x

^, I ^, J^, J^ ] ^ ,D ^ ,I ^1 , x ^2 ] [D [x
residual

Control Input

Plant Model

Information Fusion

U

[U D , U I , U J ]

^1 , x ^2 , t , U ) f (x
Super Twisting Sliding Mode Observer

residual

x2 z (t )
Velocity Information

^ (t , x ^1 , x ^2 , u )  z (t ) f z1 (t )  z2 (t ) ^2 ) D 2 sign( x2  x ^2 |0.5 sign( x2  x ^2 ) O2 | x2  x
^, J^ ] ^ ,I ^2 ] [D [x

z1 z2

x2

(D , I , J )

Figure 3.2: Proposed sliding mode observer system for FDI

involving the Radarsat-1 imaging satellite [Kim 2003], the momentum wheel responsible for pitch control suffered from excessive friction and temperature which resulted in reconfiguring the controller to make use of a back-up reaction wheel. In the literature, numerous controller reconfiguration techniques have been derived. In [Bacconi F. 2003], a "Supervisory Switching Logic" scheme is developed which is responsible for switching to the most appropriate control mode depending on the state of the actuators. Interactive multiple algorithm was used in [Chen 2007] to provide attitude fault detection and diagnosis which commanded a controller reconfiguration based on the type of fault detected - control recovery and fault detection are executed separately. Other examples of separate fault detection and recovery include [Zhang 2007] where two-stage Kalman filter is used to estimate the control effectiveness of a closed-loop attitude controller. One alternative to the re-configuration methodology is to use an adaptive control law to compensate for sudden changes in the system dynamics. [Hu 2011] is one such example in 66

3.3. Proposed Fault Recovery Algorithm which an adaptive sliding mode controller was used to estimate parameters associated with actuator stuck failures. In this thesis, the re-configurable controller will make use of several control laws developed in [Godard 2011]. Unlike some proposed underactuated attitude control schemes ([R.W. Brockett 1999], [Aeyels 1985],[Sontag & Sussmann 1988], [Morin 1996], [Shen & Tsiotras 1999]), the controller utilized here has shown to be robust to uncertainties and disturbances, such as in the case when the moment of inertia is not precisely known. Using a robust nonlinear sliding mode controller, three-axis attitude stabilization can be achieved in the cases with no control torques available on either the yaw or roll axis. In the `no roll' control scenario, the yaw axis controller will be reconfigured to stabilize the satellite's roll and yaw dynamics simultaneously. Similarly, in the `no-yaw' scenario, the roll-axis controller will undergo reconfiguration. The controller itself, however, has no means of detecting faults and relies must rely on external intervention to switch between control modes. Using the sliding mode observer scheme presented in 3.2.1, mismatches in estimated and commanded torque are compared in the form of a residual. If the magnitude of the residual exceeds a certain threshold, a fault alarm is sent to reconfigure the control law to the appropriate control mode and recover from the fault. Note that the proposed fault recovery scheme will only be tested in the case when the actuator is in a `stuck-close' state, meaning zero torque is available along a particular controllable axis. Also, this controller will not be capable of recovering from faults occurring on the pitch body axis due fact that roll and yaw dynamics are completely de-coupled from this state.

3.3.1

Design of Control Laws

In this section we present the theoretical basis for developing nonlinear control algorithms for the rigid body spacecraft mathematical model. The variable structure controller (VSC) will be similar to the controller developed in the previous chapter. 67

Chapter 3. Spacecraft Attitude Fault Detection and Recovery

Controller Reconfiguration Command

Torque Residual

_

Torque Estimate

^ [U ^ ,U ^ ,U ^ ] U D I J

Sliding Mode Fault Observer

Switching Command

Attitude Measurement

q [D,D,I,I,J , J ]
Re-configurable Control Law Fully Actuated Control Mode Control Input No Roll-axis Control Mode State Output

U

[UD , UI ,U J ]

+

Attitude Plant Dynamics

+

No Yaw-axis Control Mode

Sensor Noise

Actuator Faults

Attitude Command

Figure 3.3: Reconfigurable Controller

3.3.2

Fully Actuated Control Mode

The theoretical overview and design of three separate, independent attitude control laws will be designed in this section. Each controller will be capable of stabilizing the system given they are used in a scenario which matches their design purpose. The design will mainly use the Variable Structure Control approach where system dynamics are maintained on a sliding surface. This can be accomplished using a sliding mode control law which makes use of a switching surface which is known to insensitive to plant uncertainties and external disturbances [Godard 2011]. The control law for the nominal fully-actuated system will first be examined in which control authority will be available on all three axes of the spacecraft. In the underactuated case where only two axes (no roll -  or yaw - ) of control are available, two control modes will be developed to accommodate these situations. 68

3.3. Proposed Fault Recovery Algorithm The design of a sliding mode controller begins with defining the sliding surface which is a function of the system states Sf a = q + Kf a q (3.28)

where Kf a is a 3x3 gain matrix of the form and the 'fa' subscript denoting fully actuated.  K 0 K 0 0  (3.29)

 Kf a =   0 0

 0   K

By ensuring that the system dynamics are confined to the sliding plane, stable tracking of desired system trajectories can be achieved. This can be done through further developing the controller using Lyaponov analysis. 1 T V = Sf Sf a 2 a yields
T T V = Sf a Sf a = Sf a (q + Kf a q )

(3.30)

Taking the first derivative with respect to true anomaly of the Lyapnonov function

(3.31)

Recalling that from (Eq.3.18) q = N (q )[F (q, q ) + U ] and substituting this into our Lyaponov derivative equation.
T T V = Sf a Sf a = Sf a [N (q )[F (q, q ) + Uf a ] + Kf a q ]

(3.32)

The goal is to ensure that the first derivative of the Lyaponov function remains negative definite in order to achieve system stability. By substituting a control law which cancels out the system dynamics such that we are left with a switching function, the negative definiteness requirement can be satisfied. This can be done as follows N (q )[F (q, q ) + Uf a ] + Kf a q = -sign(Sf a ) Uf a = -N -1 (q )[sign(Sf a ) + Kf a q ] - F (q, q ) 69 (3.33)

Chapter 3. Spacecraft Attitude Fault Detection and Recovery Where   R3×3 = diag{ ,  ,  } are positive coefficients. The saturation function sat(Sc ) is used to suppress the control chatter. Re-substituting this back into the first derivative of the Lyaponov function yields.
T V = Sf a [-sign(Sf a )] < 0

(3.34)

This proves that V is negative-definite. This implies V is positive definite and for all initial conditions the sliding manifold Sf a will converge to zero in finite time which implies (q, q  0 as t  ).

3.3.3

Underactuated Control Mode

This next section will examine the design of a control laws suited for stabilizing attitude dynamics in the presence of under actuated control axes. Using the sliding mode approach, an algorithm can be developed to maintain 3-axis stability in the case where either no yaw or no roll control is available. Let the state vector of the system be X  R6×1 = [,  , ,  , ,  ]T . The state vector can be divided into two sub-states as X = [x1 , x2 ]T where x1 and x2 represents the unactuated and actuated states, respectively. The unactuated states can be further separated into x1 = [x10 , x11 ]T , where x10  R3×1 = [, ,  ]T in all cases. The value of x11 is dependant on the non-actuatable axis: Case I : (U = 0) No control authority on roll -axis () and full control actuation available on pitch () and yaw ( ) axes. For this case x11 =  , x2 = [ ,  ], and U = [U , U ]T . Similarly, F (q, q ) = [F1 , F2 ]T where F1 = F and F2 = [F , F ]T . Case II : (U = 0) No control authority on yaw -axis ( ) and full control actuation available on pitch () and roll () axes. For this case x11 =  , x2 = [ ,  ], and U = [U , U ]T . Similarly, F (q, q ) = [F1 , F2 ]T where F1 = F and F2 = [F , F ]T Much like in the design of the fully actuated case, the sliding manifold Su which guarantees the desired dynamic behavior is first defined. Prior to this however, the non-linear attitude dynamics must be linearized into the form X = AX + BU . Linearizing (Eq.3.18) 70

3.3. Proposed Fault Recovery Algorithm about the equilibrium state vector (e = e = e = e = e = e = 0) yields the following.  0   k2 -k1  3 1-k1 k2   0  A=  0    0  0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0               

0 -4k1

1 - k2 -k2

0 0 0     0   b1 0 0    0 0 0  0   , B =   0 b2 0 k1 - 1       0 0 0  1   0 0 b3 0

(3.35)

where X  R6x1 = [,  , ,  , ,  ]T and k1 = (Iz - Ix )/Iy and k2 = (Iz - Iy )/Ix . The loss of control on a particular axis is reflected by the value of b, which can either be 1 or 0. Note that because the dynamics of roll and yaw are coupled, the system is still controllable should either of these axes fail. This can be further shown by computing the rank of the controllability matrix when either b2 or b3 is zero. Given the segregated state space representation defined in the two fault cases, we can now re-write (Eq.3.35) as follows   x1 x2   A11 A12 A21 A22   x1 x2   0 B2  U (3.36)

=

+

where Axy represent sub-matrices of the A matrix in (Eq.3.35) and B2 is a column matrix reflecting the control availability of Case 1 or 2. Defining the sliding surface, Su as a linear combination of the states. Su = {x1  R4×1 , x2  R2×1 : x1 + Kua x1 = 0} (3.37)

where Kua  R2×4 is a weighting on the states. When the system reaches the sliding surface at some finite reachability time, Su = 0  t > tr , x2 = -Kua x1 Substituting this relation into Eq. (3.36) gives x1 = (A11 - A12 Kua )x1 71 (3.39) (3.38)

Chapter 3. Spacecraft Attitude Fault Detection and Recovery Control gain Kua can be further divided into two sub-matrices, each associated with the under-actuated and fully-actuated control modes. Kua = [K1 K2 ].  K1 =  K11 K12 K13 K21 K22 K23   and  K2 =  K14 K24  

Choice of the sliding surface gains Kua can be treated as a classical controls problem by considering the A11 and A12 matrices as analogous to the A and B matrices in a linear feedback controller. With the sliding plane, Su (Eq.(3.37)) defined, we now look at the design of the control law procedure. Using the new state representation x1 = [x10 , x11 ]T and x2 , the nonlinear equations of motion given by Eq.(3.18) is transformed to   x11 x2   = ¯11 A ¯12 A ¯21 A ¯22 A         F d  0 + 1    1 +  F2 U d2 

(3.40)

¯11 , A ¯12 = A ¯T , and A ¯22 are the sub-matrices of N and d1  R and d2  R2×1 are where A 21 the external disturbances on the system, and F1 , F2 , U are described in Case 1 and 2. The goal now is to define the control law which will be dictated examination of a Lyaponov candidate function. Substituting the above equation of motion into the first derivative of the sliding surface Su we obtain. 1 V (Su ) = Su T Su 2 Taking the first derivative of V (Su ), V (Su ) = Su T [x2 + K1 x10 + K2 x11 ] (3.42)

(3.41)

Substituting the equation dynamic model Eq.(3.40) without considering disturbances d1 and d2 . ¯21 F1 + A ¯22 F2 + A ¯22 U + K1 x10 + K2 (A ¯11 F1 + A ¯12 F2 + A ¯12 U ) (3.43) V (Su ) = Su T A

72

3.4. Attitude Fault Estimation - Numerical Simulation Choice of control law U must be defined to enure the V (Su ) remains negative definite. Thus, ¯21 F1 + A ¯22 F2 + A ¯22 U + K1 x + K2 (A ¯11 F1 + A ¯12 F2 + A ¯12 U ) - sign(Sua ) = A 10 (3.44)

Where  and sign(Sua ) are positive definite matrix and saturation functions respectively which will act as the switching surface function. Re-formulating this as ¯22 + K2 A ¯12 )-1 sign(Sua ) + (A ¯21 + K2 A ¯11 )F1 + (A ¯22 + K2 A ¯12 )F2 + K1 x U = -(A  10 (3.45) To analyze the proposed control law's stability, we re-substitute U back into 3.44 we obtain the following.

¯21 + K2 A ¯11 )d1 + (A ¯22 + K2 A ¯12 )d2 V (Su ) = Su T -sign(Sua ) + (A

(3.46)

Note that all the non-linear dynamics have canceled out but we are left with terms d1 and d2 left over due to external disturbances not accounted for by the controller. The stability analysis can be simplified by assuming the disturbance terms are bounded by some unknown positive constant p. p  ¯21 + K2 A ¯11 )d1 + (A ¯22 + K2 A ¯12 )d2 (A (3.47)

Provided that  was chosen such that min ( ) > ||p|| then it can be seen that V (Su ) < 0 which satisfies the Lypaponov stability criterion.

3.4

Attitude Fault Estimation - Numerical Simulation

Before simulating fault recovery capabilities, it is important to first demonstrate the fault tracking capabilities of the proposed sliding mode observer. In the following scenario, the full non-linear attitude control and dynamics of a spacecraft was simulated in conjunction 73

Chapter 3. Spacecraft Attitude Fault Detection and Recovery with the fault observer. At a pre-defined time unknown to the fault observer, faults were injected on several axes of the spacecraft. Using position and velocity sensor feedback corrupted by measurement noise, the observer is shown to exhibit relatively accurate fault tracking. Table 3.1 depicts the orbital parameters used for the simulation. Table 3.1: Underactuated spacecraft - Simulation parameters Parameters Orbit rp (km) µe (km3 s-2 ) e Spacecraft MOI Ixx (kg m2 ) Iyy (kg m2 ) Izz (kg m2 ) Initial Conditions [0 , 0 , 0 ] [0 , 0 , 0 ] [80 , -40 , 40 ] [0.001, 0.001, 0.001] 15 17 20 6878 398600 0 Values

Note that the fault values in Table 4.3 are non-dimensional and the simulation is executed with respect to time, not true anomaly. Figures 3.4,3.5 and 3.6 depict accurate tracking of these faults despite the fact that the nature of the attitude faults are unknown to the observer. Estimation convergence on to the true system states can be seen in the observer error plot shown in 3.7 where it can be seen that the sliding mode observer can still function as a relatively accurate state estimator. This is expected as accurate estimation of faults will require good tracking of the true system states. During fault occurances, large jumps in the observer error can be seen, however, this is due to the fact that the observer must re-stabilize to the system states which has changed abruptly due to the torque faults. After convergence (approximately 60-100 seconds), the observer error regains nominal steady state error values of 1 × 10-2 and 1 × 10-4 for angular position and velocity 74

3.4. Attitude Fault Estimation - Numerical Simulation respectively. Table 3.2: Torque Faults Applied To Spacecraft Axis U U U Fault I: t>0.17 and t<0.52 (Orbits) 0 0 U Fault II: t>0.88 and t<1.23 (Orbits) U + sin(t/100) U + sin(t/500) U

For measurement noise, gaussian zero-mean noise of a variance of 0.05 deg and 0.001 deg/s for angular position and velocity were chosen respectively [Griffin & French 2004]. These noise levels translate to approximately 0.1 and 0.01 degree accuracy respectively. In the context of this thesis, it is assumed that an attitude determination system (ADS) exists on the satellite and is used to resolve this level of accuracy using available sensor systems such as star trackers, magnetometers, and rate gyros [Griffin & French 2004]. One additional note is that the error plots in Figure 3.7 indicate that the state estimate of the system is an order of magnitude less than the error from noise, demonstrating the SMO's resilience to measurement disturbance. Given these noise levels and disturbances, the torque estimation was found to be approximately 1 × 10-6 Nm in accuracy ( with occasional large sudden changes in error due to fault occurrences.

75

Chapter 3. Spacecraft Attitude Fault Detection and Recovery

2 1.5 1 0.5 Torque [Nm] 0 -0.5 -1

x 10

-5

 axis

Estimated Torque

-1.5 -2 -2.5 -3 0 0.5 1 1.5 Orbits 2

Commanded Torque Actual Torque

2.5

3

Figure 3.4: Control torque estimation in the presence of actuator faults

2.5 2 1.5

x 10

-5

 axis

Estimated Torque

1 Torque [Nm] 0.5 0 -0.5 -1 -1.5 -2 -2.5 0 0.5 1 1.5 Orbits 2

Commanded Torque Actual Torque

2.5

3

Figure 3.5: Control torque estimation in the presence of actuator faults

76

3.4. Attitude Fault Estimation - Numerical Simulation

0.5 0 -0.5

x 10

-5

 axis

Estimated Torque Commanded Torque

-1 Torque [Nm] -1.5 -2 -2.5 -3 -3.5 -4

Actual Torque

0

0.5

1

1.5 Orbits

2

2.5

3

Figure 3.6: Control torque estimation in the presence of actuator faults


0.04 0.04 0.02 0 -0.02 -0.04 0.02 0 -0.02 -0.04


0.02 0.01 0 -0.01 -0.02



Error [deg]

0 x 10
-4

1

2

3

0 x 10
-4

1

2

3

0 x 10
-4

1

2

3

d/dt
6 4

d/dt
4 2 0

d/dt

10

Error [deg/s]

5

2 0 -2 -2 -4

0

-5

0

1

2

3

-4

0

1

2

3

0

1

2

3

Orbits

Orbits

Orbits

Figure 3.7: State errors of Sliding Mode Observer

77

Chapter 3. Spacecraft Attitude Fault Detection and Recovery

3.5

Attitude Fault Recovery - Numerical Simulation

The previous results detailed a scenario with no fault recovery. This section will make use of fault detection information for autonomous controller reconfiguration. Independent fully actuated and under actuated control schemes are implemented with each mode utilized according to the fault estimator's diagnosis. For instance, in the situation where no roll control has been detected, the fault observer will notify the controller to re-configure to the no-roll mode controller in which the yaw controller is re-configured to simultaneously stabilize the roll and yaw axis. Likewise, a no-yaw control mode is also implemented in which the roll-attitude controller undergoes modification to account for loss of a control axis. For all cases, the following faults in Table 4.4 representing `stuck-close' failures were applied to the system. Table 3.3: Torque Faults Applied To Spacecraft Axis U U U Case 1: t>0.17 and t<1.40 (Orbits) U 0 U Case 2: t>1.67 and t<2.90 (Orbits) U U 0

Note that in these tests, unstable axis of inertias were used to further demonstrate precise control in the presence of instability. See Table 3.4 for a complete list of orbital parameters. Figure 3.8 depicts the spacecraft with no fault recovery with yaw and roll faults within the same 5 orbit duration.

78

3.5. Attitude Fault Recovery - Numerical Simulation

Table 3.4: Underactuated Attitude - Simulation parameters Parameters Orbit rp (km) µe (km3 s-2 ) e Spacecraft MOI Ixx (kg m2 ) Iyy (kg m2 ) Izz (kg m2 ) Initial Conditions [0 , 0 , 0 ] [0 , 0 , 0 ] [10 , -10 , 20 ] [0.001, 0.001, 0.001] 10 17 15 6878 398600 0 Values

60 Attitude [deg] 40 20 0 -20

  

0 x 10
-5

1

2 Orbits

3

4 Fault Detector

5

5 Torque [Nm] 0 -5 -10 -15

2 Control Mode

1

0

-axis -axis

0

1

2 3 Orbits

4

5

-1

0

1

2 3 Orbits

4

5

Figure 3.8: No controller reconfiguration - Top: attitude states, Bottom Left: Control Effort, Bottom Right: System Faults

79

Chapter 3. Spacecraft Attitude Fault Detection and Recovery

3.5.1

Nominal Case

In the nominal case, the non-linear attitude dynamics will experience no disturbance torques. Gravity gradient will be present in the plant model, but not in the observer model. The purpose of this is to show the sliding mode observer's robustness to non-linear un-modeled characteristics. The same noise levels from the previous section will be used here, as with the same attitude fault torque observer technique. Figure 3.9 depict accurate fault tracking in the aforementioned conditions. Using this fault estimation information, successful control law reconfiguration can be seen in Figures 3.11 in which attitude states are stabilized despite the loss of control along one axis. The right column of Figure 3.11 represents the state at which the control mode is in - the value 1 or 0 represents if control is available on a particular axis or not. If no control is detected, control reconfiguration for that axis will take place. Finally, the observer error can be seen in Figure 3.10, which remains relatively bounded and an order of magnitude less than the measurement noise.
6 4 Torque [Nm] 2 0 -2 -4 -6 0 1 2 3 4 5 x 10
-5

-axis
6 4 2 0 -2 -4 -6

x 10

-5

-axis

0

1

2

3

4

5

6 4 Torque [Nm] 2 0 -2 -4 -6

x 10

-5

-axis
6 4 2 0 -2
Commanded Torque Actual Torque

x 10

-5

-axis
Commanded Torque Actual Torque

-4 5 -6 0 1 2 Orbits 3 4 5

0

1

2 Orbits

3

4

Figure 3.9: Nominal Case - Torque Estimation -  - Axis and  - Axis

80

3.5. Attitude Fault Recovery - Numerical Simulation

 Error
0.04 0.04 0.02 0

 Error
0.06 0.04 0.02

 Error

Error [deg]

0.02 0 -0.02 -0.04

0 -0.02 -0.04 -0.02 0 x 10 1
-3

0 x 10

1
-4

2

3

4

5

2

3

4

5

-0.04

0 x 10

1
-3

2

3

4

5

d/dt Error
1 0.5 0

d/dt Error
1 0.5 0

d/dt Error

4

Error [deg/s]

2 0 -2 -4

-0.5 -0.5 -1 -1 0 1 2 3 4 5 -1.5 0 1 2 3 4 5

0

1

2

3

4

5

Orbits

Orbits

Orbits

Figure 3.10: Nominal Case - Observer error for attitude fault recovery

30 Attitude [deg] 20 10 0 -10

  

0 x 10
-4

1

2 Orbits

3

4 Fault Detector

5

1 Torque [Nm] 0.5 0 -0.5 -1

2 Control Mode

1

0

-axis -axis

0

1

2 3 Orbits

4

5

-1

0

1

2 3 Orbits

4

5

Figure 3.11: Nominal Case - Top: Attitude states, Bottom Left: Control Effort, Bottom Right: Fault Detector

81

Chapter 3. Spacecraft Attitude Fault Detection and Recovery

 Estimate
20 15 5 0 -5 5 0 -5 0 1 2 3 4 5 -10 -15

 Estimate
30 20 10 0 -10

 Estimate

[deg]

10

0

1

2

3

4

5

0

1

2

3

4

5

 Measurement
20 15 5 0 -5 5 0 -5 0 1 2 3 4 5 -10 -15

 Measurement
30 20 10 0 -10

 Measurement

[deg]

10

0

1

2

3

4

5

0

1

2

3

4

5

Orbits

Orbits

Orbits

Figure 3.12: Nominal Case - State position measurement

d/dt Estimate
0.06 0.04 0.06 0.04 0.02 0 -0.02 -0.04 0 1 2 3 4 5 0 -0.02

d/dt Estimate
0.06 0.04 0.02 0 -0.02 0 1 2 3 4 5 -0.04 0 1

d/dt Estimate

[deg/s]

0.02

2

3

4

5

d/dt Measurement
0.06 0.04 0.06 0.04 0.02 0 -0.02 -0.04 0 1 2 3 4 5 0 -0.02

d/dt Measurement
0.06 0.04 0.02 0 -0.02 0 1 2 3 4 5 -0.04 0

d/dt Measurement

[deg/s]

0.02

1

2

3

4

5

Orbits

Orbits

Orbits

Figure 3.13: Nominal Case - State velocity measurement

82

3.5. Attitude Fault Recovery - Numerical Simulation

3.5.2

External Disturbance Case

The proposed sliding mode observer fault estimator is further examined under the conditions external disturbance conditions in the form of solar radiation pressure (SRP) and aerodynamic drag. Sensor measurement noise from the previous simulation will be used. In order for precise fault tracking, the addition of external disturbances meant that the observer error will increase substantially; disturbances unknown to the observer can be compensated by re-selecting gains to better match the new Lipschitz constant associated with additional plant disturbances, however this resulted in higher oscillations of the fault tracking due to higher gains. Through testing, it was found that adding in the aerodynamic drag and SRP information into the observer plant model was necessary in order to retain the level of fault estimation fidelity needed to facilitate appropriate control reconfiguration.
-5

4 2 Torque [Nm] 0

x 10

-axis
6 4 2 0

x 10

-5

-axis

-2 -2 -4 -6 -4 0 1 2 3 4 5 -6 0 1 2 3 4 5

4 2 Torque [Nm] 0

x 10

-5

-axis
6 4 2 0

x 10

-5

-axis
Commanded Torque Actual Torque

-2 -2 -4 -6
Commanded Torque Actual Torque

-4 5 -6 0 1 2 Orbits 3 4 5

0

1

2 Orbits

3

4

Figure 3.14: External Disturbance Case: Control torque for attitude fault recovery -  Axis and  - Axis

The disturbances due to solar radiation pressure can be expressed as (in Nm) 83

Chapter 3. Spacecraft Attitude Fault Detection and Recovery
 Error
0.04 0.04 0.02 0 0 -0.02 -0.04 -0.02 -0.04 -0.02 0 x 10 1
-3

 Error
0.06 0.04 0.02

 Error

Error [deg]

0.02 0

0 x 10

1
-4

2

3

4

5

2

3

4

5

-0.04

0 x 10

1
-3

2

3

4

5

d/dt Error
1 0.5 0

d/dt Error
2 1 0

d/dt Error

4

Error [deg/s]

2 0 -2 -4

-1 -0.5 -1 -2 0 1 2 3 4 5 -3 0 1 2 3 4 5

0

1

2

3

4

5

Orbits

Orbits

Orbits

Figure 3.15: External Disturbance Case: Observer error for attitude fault recovery [Kaplan 1976],       Ts  = Sf  (2 × 10-5 )[1 - 2 sin(t  )]      -5  Ts (5 × 10 ) cos(t) Ts   ) (1 × 10-4 ) cos(t  (3.48)

The external torque due to aerodynamic drag [Wie 1998] can be modeled as bias plus cyclic terms in the body-fixed control axes (in Nm),    Ta  Ta Ta    ) + 0.5 sin(2t  )] -[4 + 2 sin(t     = 1.36 Af  1 + sin(t  ) + 0.5 sin(2t )       -[1 + sin(t) + 0.5 sin(2t)] 

(3.49)

where Sf and Af are positive scaling factors. The disturbance torque simulated is of the form Td = Ta + Ts . By choosing scaling factors as Sf = 0.01 and Af = 2 × 10-6 disturbance dynamics represented by (Eqs. 3.49 and 3.48) can emulate the disturbance process due to solar radiation pressure, aerodynamic drag, and magnetic forces. For a spacecraft in LEO (500 km) this is approximately Td  2 × 10-5 Nm [Wertz & Larson 1999]. Figures 3.14, 3.15 and 3.16 demonstrate the sliding mode fault observer tracking the faults and reconfiguring the controller to maintain stable attitude states during roll and yaw-axis faults. Figure 3.16 shows the control logic mode for the roll and yaw axes, which 84

3.5. Attitude Fault Recovery - Numerical Simulation
30 Attitude [deg] 20 10 0 -10

  

0 x 10
-4

1

2 Orbits

3

4 Fault Detector

5

1 Torque [Nm] 0.5 0 -0.5 -1

2 Control Mode

1

0

-axis -axis

0

1

2 3 Orbits

4

5

-1

0

1

2 3 Orbits

4

5

Figure 3.16: External Disturbance Case: Left Column: Attitude states and control effort, Right: Fault Detection logic closely coincides with the faults applied at the specified durations for the simulation. When compared to the nominal case, the external disturbance induces higher inaccuracies in attitude attitude tracking by a few degrees during the underactuated mode. Slight oscillations can be seen in the state angular position. Note that in these tests, gravity gradient was still present in the plant dynamics. While these results require the disturbance forces to be modeled into the SMO, gravity gradient was still neglected.

85

Chapter 3. Spacecraft Attitude Fault Detection and Recovery
 Estimate
20 15 5 0 -5 5 0 -5 0 1 2 3 4 5 -10 -15 0 -10

 Estimate
30 20 10

 Estimate

[deg]

10

0

1

2

3

4

5

0

1

2

3

4

5

 Measurement
20 15 5 0 -5 5 0 -5 0 1 2 3 4 5 -10 -15

 Measurement
30 20 10 0 -10

 Measurement

[deg]

10

0

1

2

3

4

5

0

1

2

3

4

5

Orbits

Orbits

Orbits

Figure 3.17: External Disturbance Case: State position measurement vs estimate
d/dt Estimate
0.06 0.04 0.06 0.04 0.02 0 0 -0.02 0 -0.02 -0.02 0 1 2 3 4 5 -0.04 0 1 2 3 4 5

d/dt Estimate
0.06 0.04 0.02

d/dt Estimate

[deg/s]

0.02

0

1

2

3

4

5

d/dt Measurement
0.06 0.04 0.06 0.04 0.02 0 -0.02 -0.04 0 1 2 3 4 5 0 -0.02

d/dt Measurement
0.06 0.04 0.02 0 -0.02 0 1 2 3 4 5 -0.04 0

d/dt Measurement

[deg/s]

0.02

1

2

3

4

5

Orbits

Orbits

Orbits

Figure 3.18: External Disturbance Case: State velocity measurement vs estimate

86

3.6. Summary

3.6

Summary

In this chapter, a sliding mode observer for the purpose of attitude actuator fault detection was presented. Using the broken super twisting algorithm, the proposed observer design used angular position and velocity to estimate the torque applied on the system. Successful estimation of torque faults have been demonstrated in numerous cases, including in the presence of external and un-modeled disturbances. Additionally, the observer has shown acceptable resilience to measurement noise, being capable of resolving a state estimate of the system an order of magnitude less than the noise applied to the system with simultaneous fault reconstruction. Through fault reconstruction, it was then shown that it was possible to use this information to recover from a no-roll/no-yaw underactuated scenario. By comparing the estimated torque with the applied controller torque, it can be determined which axes is at fault, and then react with a controller re-configuration to mitigate effects of the fault. Using a non-linear variable structure technique, a sliding mode controller was developed for the aforementioned fault cases and was shown to stabilize the system.

87

Chapter 4

Hardware-in-the-Loop Validation

R

yerson's space systems dynamics and control laboratory offers several hardware simulators which can be used to validate various control and estimation algorithms.

In a hardware-in-the-loop validation, control and command signals are generated from a computer based on sensor input from a hardware system representing a spacecraft actuator. The computer will be responsible for data acquisition as well as inducing actuator faults which will be unknown to the fault estimator. Contributions toward hardware testing yielded successful reconstruction of actuator faults. The focus of these tests will be mainly concerned with testing actuator output estimation - fault recovery will be excluded since that was already explored in a previous dissertation.

4.1

Single Axis Simulator Fault Detection

The single-axis simulator (SAS) simulates single-axis attitude control through the use of a brushed servo motor driving a flywheel. Using wireless communication from a computer ground station, torque commands are sent to a microprocessor to drive the motor. The control law, torque commands and desired trajectories are all defined on the ground station. For sensor feedback, an on-board rate gyro gives attitude rate information. The specifications of the motor and its flywheel are defined in table 4.5. A picture of the SAS test setup is shown in Figure 4.1.

4.1.1

SAS Test Setup

In order to test the actuator fault detection scheme, modifications were done to the SAS software to accommodate control input commands from the computer. Doing so enabled 89

Chapter 4. Hardware-in-the-Loop Validation Table 4.1: Single-axis Simulator specifications Parameters On-board processor Communication On-board sensors Momentum Storage (Nm s) Maximum Wheel Speed (kg) Fly Wheel moment of Inertia (kg m2 ) Total Mass (motor,wheel,enclosure,etc) (kg) Total Moment of Inertia Izz (kg m2 ) Values dsPIC30f3011 Microcontroller UM96XM 5V/10mW Radio ADXRS Rate Gyro 0.063668 0.12846 0.000106 0.887 0.000731642

flexible implementation of arbitrary actuator faults in the form of torque commands. Figure 4.2 depicts a flow diagram of the hardware simulation. Using wireless communication from a computer ground station, torque commands are sent to a microprocessor to drive the motor. During simulation tests, the SAS is situated on top of an air bearing that can rotate freely in the yaw axis. The control law, torque commands and desired trajectories are all defined on the ground station. For sensor feedback, an on-board rate gyro gives attitude rate information. In order to accommodate the proposed SMO fault detector algorithm, additional sensor feedback was needed for angular position and velocity. Relying purely on rate-gyro data yields unreliable feedback due to drifting effects when numerically integrating attitude rate data to resolve angular position. Using the same camera system and computer vision algorithms for the SAFE system (see next section for full technical description), attitude vision feedback was introduced to compensate for this, as well as provide an independent sensor source which is needed for the SMO design. Using three LEDs situated in a pattern, the yaw attitude of the reaction wheel air bearing platform can be determined using a camera observing the testbed. To mimic spacecraft systems, an attitude determination system was developed which uses vision system and attitude rate gyro measurements. Building the attitude determina90

4.1. Single Axis Simulator Fault Detection

Figure 4.1: Single axis simulator with LED angular position feedback on an air bearing tion system involved constructing a Kalman filter to process the two sensors and provide a state estimate of the system. The approximate accuracy of the ADS module in terms of noise variance was measured to be 0.0025 and 0.0015 angular position and velocity respectively. With update rates of 10Hz, rate gyro and vision attitude feedback can be resolved and sent to a PID controller where torque command are sent to the motor. To induce faults, control torque fault signals are injected in the simulation model before being sent to the hardware setup. Figure 4.2 depicts the described setup in flow chart form.

4.1.2

SMO Fault Estimator Design

Following the same principles as done in the orbital simulations of the previous chapters, the first step in the design process involves determining the model dynamics. It can be assumed that the reaction wheel is able to produce the commanded torque signal in a 91

Chapter 4. Hardware-in-the-Loop Validation

Rate Gyro Vision System Feedback SAS Hardware Testbed

Torque Command

Reference Attitude

Attitude Determination System

Angular position and rate feedback

Control Law

Induce Fault

Control U

Serial Communication

Sliding Mode Observer Fault Estimator

Fault Estimation

Figure 4.2: Flowchart for SAS HWIL setup relatively quick manner. ¨= U  Izz

(4.1)

Where Izz represents the moment of inertia of the entire rotating ensemble parallel to the axis of rotation (yaw) and U represents the commanded torque. This inertia term includes the platform which the SAS rests on, as well as the SAS itself which houses the motor and electronics. Realistically, the full dynamics of the system may comprise of properties such as viscous friction, non-instantaneous changes in torque and other aspects which can lead to model mismatch. However, to demonstrate robustness and to simplify analysis, these terms will be neglected in the design of the plant model for the fault estimator. Recall that two observers are designed, one for processing position information, and the other for rate feedback. The broken super twisting sliding mode observer [Davila 2005] is then formulated with 92

4.1. Single Axis Simulator Fault Detection the plant model as shown below 1 = x x ^ ^ 2 + Z1  2 = U +Uf + Z2 x ^ Izz (4.2)

Here Uf represents the actuator fault which we wish to reconstruct. Where Z1 and Z2 are the observer correction variables defined as Z1 = |x1 - x ^1 |0.5 sign(x1 - x ^1 ) Z2 = sign(x1 - x ^1 ) (4.3)

Going through the same procedures in the previous chapters, reconstruction of the Uf signal is accomplished by as follows.  2 = Izz Uf - sign(~ x ^ x1 ) = 0 Z2 = sign(~ x1 ) = Izz Uf
-1 Izz Z2 = U f

(4.4)

Note that in the presence of sensor noise the switching term may produce significant chatter - the hyperbolic tan instead of a sign function is one method of reducing this effect as well as using a low-pass filter to better reconstruct the thruster fault Uf (t). The filtered equivalent output injection will take a form such as ¯2 = v=Z 1 I - 1 Z2 1 +  s zz (4.5)

4.1.3

HWIL Simulation Results

The experimental results first begin with defining the system faults imposed onto the system. During simulation, faults are injected in the control loop. The estimation loop's responsibility is to reconstruct these fault signals. In all simulations, the commanded reference trajectory Table 4.2 was specified which repeats itself every 150 seconds. In normal operations, the SAS will autonomously tracks the way-points outlined in Table 4.2. In the first fault scenario, the control law fails to respond to the commanded torque at the times specified in Table 4.3. Instead, the controller resumes its autonomous way-point tracking. Note that the commanded torque signals in Table 4.3 is still being sent 93

Chapter 4. Hardware-in-the-Loop Validation Table 4.2: Torque Faults Applied To Spacecraft Duration [s] t>0 and t<30 t>30 and t<60 t>60 and t<90 t>90 and t<120 t>120 and t<150 Commanded Angle [deg] 45 135 -45 30 -90

Table 4.3: Torque Commands - Scenario I Duration[s] t>150 and t<180 t  180 and t<210 t  210 and t<360
x 10 5
-3

Commanded Torque Signal [Nm] 1 × 10-3 1.5 × 10-3 -1.0 × 10-3
Estimated Torque

Torque [Nm]

0

-5 0 50 100 150 200 250 300 350

x 10 5

-3

Commanded/Actual Torque

Torque [Nm]

0

-5 0 50 100 150 200 250

Actual Thrust Commanded Thrust

300

350

Time [s]

Figure 4.3: Torque Fault Reconstruction - Fault Scenario I

94

4.1. Single Axis Simulator Fault Detection to the fault estimator. The purpose of this test was to demonstrate the fault estimator's resilience to control signals not matching the state measurements. Accurate estimation of the true applied torque depicted in Figure 4.3 on the system is resolved almost immediately after the fault begins. The error plot in Figure 4.4 depicts the error between the true commanded torque and the estimated value. Note that the large discontinuous change in error occurs after the fault signal is induced onto the system which leads to slightly higher residual error, which can be seen in Figure 4.5.
5 x 10
-3

Torque Estimation Error

4

3

2

Torque [Nm]

1

0

-1

-2

-3

-4

-5

0

50

100

150

200

250

300

350

Time [s]

Figure 4.4: Torque Faults Reconstruction - Estimation Error

Observer Residuals
0.05

0.04

0.03

0.02

0.01

Error [rad]

0

-0.01

-0.02

-0.03

-0.04

-0.05

0

50

100

150

200

250

300

350

Time [s]

Figure 4.5: Sliding Mode Observer Residuals - Fault Scenario I

95

Chapter 4. Hardware-in-the-Loop Validation Table 4.4: Torque Faults Applied To SAS - Fault Scenario II Duration [s] t>100 and t<125 t>170 and t<200 t>250 and t<270 Fault Torque Signal [Nm] 5 × 10-3 -5 × 10-3 -U

In the next fault scenario, torque signal faults are induced into the system at different times and values specified in table 4.4.

x 10 5

-3

Commanded Torque

Torque [Nm]

0

-5 0 50 100 150 200 250 300 350

x 10 5

-3

Estimated and Actual Torque

Torque [Nm]

0

-5 0

Actual Torque Estimated Torque

50

100

150

200

250

300

350

Time [s]

Figure 4.6: Torque Fault Reconstruction - Fault Scenario II

Accurate tracking of the true applied torque is depicted in Figure 4.6. The fault estimation error and SMO residual plots can be seen in Figure 4.7 and Figure 4.8 respectively. 96

4.1. Single Axis Simulator Fault Detection
Torque Estimation Error
0.01

0.008

0.006

0.004

Torque [Nm]

0.002

0

-0.002

-0.004

-0.006

-0.008

-0.01

0

50

100

150

200

250

300

350

Time [s]

Figure 4.7: Torque Fault Reconstruction - Estimation Error for Fault Scenario II

Observer Residuals
0.1

0.08

0.06

0.04

0.02

Error [rad]

0

-0.02

-0.04

-0.06

-0.08

-0.1

0

50

100

150

200

250

300

350

Time [s]

Figure 4.8: Sliding Mode Observer Residuals - Fault Scenario II

97

Chapter 4. Hardware-in-the-Loop Validation

4.2

Satellite Airbed Formation Experiment - Fault Detection

4.2.1

SAFE System Overview

Formation testbeds are used for designing formation architectures and validating the performance of closed-loop control algorithms to achieve various formation objectives. The laboratory equipment used to test the proposed concept of underactuated SFF is called the Satellite Airbed Formation Experiment (SAFE) platform. In this dissertation, the SAFE simulator was used to validate a modified version of the proposed fault estimation technique.

4.2.2

Components

A two dimensional, 3 m by 2 m, glass table constitutes the base for the floatation of the leader and follower spacecraft simulators. Each spacecraft simulator is equipped with three air pads to reduce the friction to a micro level. Air is transmitted through porous material of the air pads, under application of pressure where two compressed air tanks feed three air pads via a single regulator, to create an air layer between the glass table and the spacecraft simulator. The physical structure of the SAFE platform is comprised of three parts: the frame

Figure 4.9: Picture of the test spacecraft developed by SSDC laboratory at Ryerson University 98

4.2. Satellite Airbed Formation Experiment - Fault Detection structure, the electronics mount, and the tank module (Fig. 4.9). The frame structure houses both the tank module and electronics mount and is supported by three air pads which provide floatation. The tank module stores two 50 cubic inch, 3000 Psi air tanks. Air from both tanks is fed simultaneously into a header manifold and high pressure regulators which allow the platform to float 10 microns above the glass test bed at 40 to 50 PSI. The electronics mount mates on the top side of the frame structure and is responsible for supporting critical components such as the onboard computer, LED targeting module, battery system and an array of thruster fans for actuation. The on board computer consist of a dsPIC30 microcontroller from Microchip and a UMG96 XM radio from Sparkfun. The main purpose of the on-board computer is to relay actuator instructions from a desktop computer running Simulink to the hardware system. Using several switching transistors, the microcontroller will actuate four ducted fans independently, running at 12.6 volt battery supply. The fan systems only provide translational thrust and are either in an ON or OFF state to simulate a bang-bang control approach. Table 4.5: Single-axis Simulator specifications Parameters On-board processor Communication Actuation Supply Voltage Total Mass Navigation Scheme Values dsPIC30f3011 Microcontroller UM96XM 5V/10mW Radio Four translational Himax EPF200 ducted fans 12.6 V 8 Kg Camera vision system and LED patterns

For guidance, an LED module on-top of the electronics mount is responsible for providing position and attitude information to a camera system over-looking the test bed. Determination of the platform's pose is not actually done on the on-board computer, rather it is accomplished at the ground station where the vision system image processing and control 99

Chapter 4. Hardware-in-the-Loop Validation

Figure 4.10: Flow chart representation of hardware-in-the-loop simulation framework. law reside. For formation flight tests with more than one platform on the glass test bed, LED colors are different for platform identification. Figure 4.10 depicts a flow diagram of the SAFE process. The ground station sends out thruster commands via RS-232 serial UMG96/Xm radio. The SAFE platforms continuously receives a data from the radio for the thruster actuation. There is no downlink of telemetry directly from the spacecraft simulators. Instead, for position and attitude determination, a single camera (Basler A601f) overlooking the entire SAFE platform is used to image the spacecraft simulators. Three LEDs situated on-top of the spacecraft simulators provide visual cue for the vision system to identify and track the simulator's pose. Gain and shutter values of the camera were adjusted to ensure optimal LED detection. The vision system first takes an image (640x480 resolution) from the camera and identifies which set of LEDs correspond to which platform (leader or follower). Next, the image is cropped by a 200x200 dynamic region of interest (ROI) which tracks the platform on the camera image. After the pixel coordinates of the LEDs are identified, they are passed through a clustering algorithm such that the coordinate centroid of each LED is computed - this step is also known as 100

4.2. Satellite Airbed Formation Experiment - Fault Detection

Figure 4.11: Block diagram of the pose estimation procedure. blob detection. The centroid coordinates of the LEDs are passed into a pose estimator (see Figure 4.14) which transforms the pixels coordinates from the camera frame to the inertial frame.

4.2.3

Ground Station
©¨ ©¨ ££ ¡§¨

 ¡¢¡£¤ ¥¦¢§¨© ¨¨ ¥§§¨  ¡%¨¢ ¨¨

 ¡¢¡£¤ ¥¦¢§¨© ££¨ ¥§§¨  ¡%¨¢ ££¨ ¨¨ "('¢§ £©©¤ "¨¨©¨§¦ 0&¡¤1 ££¨

©¤ ¡§¨ ! "¤¢#£© §£ $£¦ ££¡¤§¨¢ ¥§§¨  ¡%¨¢ )¤¨'2¨ £©©¤¢

£¤§£  £©&'§§¡£¤

"('¢§¨ )&&¡¤

Figure 4.12: Block diagram of the ground station functions.

The ground station was designed to be customizable (see Figure 4.14), allowing different control schemes and methodologies to be implemented including fully actuated and under actuated control. Several pre-defined trajectories such as circular formation or along-track 101

Chapter 4. Hardware-in-the-Loop Validation have been included as templates in the guidance block. In the context of this work, actuator fault signals were designed and implemented in this environment.

4.2.4

Mathematical Model

The complete nonlinear equations of motion of the SAFE simulator is depicted below.

4.2.5

Equations of Motion

The relative system equations of motion are derived under the assumption that the leader satellite is a virtual point in the center of the glass table. The follower satellite is moving in a relative trajectory about the leader satellite. Its motion is described by the reference frame S - xy , Fig. 4.13. S - XY is the inertial reference frame. To derive the equations
X

y

x

S



r r

S

Y

Figure 4.13: Reference frames for SAFE platform. of motion in the body frame S - xy , the position vector of the SAFE platform with respect to S - XY frame expressed in S - xy frame can be written as: rxy = x ^ i+y^ j 102 (4.6)

4.2. Satellite Airbed Formation Experiment - Fault Detection Differentiating with respect to time leads to +y  xy = x r ^ i + x^ i ^ j +y^ j  =  ×^  = ×^ Substituting for ^ i i and ^ j j in Eq. (4.7), we have xy = x r ^ i+y ^ j +  × x^ i+y^ j (4.8) (4.7)

where  is the angular velocity vector if the S - xy frame. Eq. (4.8) represents the inertial velocity of the SAFE platform from a given position and velocity in the S - xy frame. Next we derive an expression for inertial acceleration. Differentiating Eq. (4.8) gives, ¨xy = (¨  xy ) +  × ( × rxy ) +   × rxy r x^ i+y ¨^ j ) + 2( × r (4.9)

 xy ) is called coriolis acceleration and the term  × ( × rxy ) is known as The term 2( × r  = k ^ and  ¨k ^, the acceleration is given by centripetal acceleration. Taking  =  ¨= x y 2 x + y ¨ ^ x 2 y + x ¨ ^ r ¨ - 2 - i+ y ¨ + 2  + j Based on Newton's 2nd law, the relative translational equations of motion are y 2 x - y ¨ = fx /ms x ¨ - 2 - x 2 y + x ¨ = fy /ms y ¨ + 2  - (4.11) (4.12) (4.10)

where fx , fy are the control forces, and ms is the mass of the SAFE platform. Given there are four thrusters situated on the sides of the system as depicted in Figure 4.14 Rewriting the equations with respect to this diagram we arrive at y 2 x - y ¨ = (U4 T4 - U2 T2 )/ms x ¨ - 2 - x 2 y + x ¨ = (U3 T3 - U1 T1 )/ms y ¨ + 2  - (4.13) (4.14)

Where Un and Tn represents the thrust value and the ON-OFF command signals respectively for each actuator. Thrust signals Tn can take values of either 1 or 0 while thrust values Un represent the actual thrust mangitude in newtons. Slight electrical and mechanical variations in each thruster yield slightly different performance characteristics, which is why each ducted fan is assigned a different variable representing thrust. 103

Chapter 4. Hardware-in-the-Loop Validation

Figure 4.14: Thruster configuration on the body frame of the SAFE platform. T1 to T4 represent thruster locations

4.2.6

System Characteristics

There are several characteristics of the SAFE system which differ from the expected system model derived in the previous section. For instance, there are significant levels of friction on the table in certain areas which can impact the movement of the platform. The air pucks which provide flotation produce different levels of pressure which may result in one or more puck causing slight torques. While the thrusters are capable of being moved along a linear stage for better center of mass balancing, slight imperfections can also cause residual torques. Another issue may include translational drift due to un-equal puck pressure as well as table slant elevation causing acceleration of the platform along a certain direction. All these disturbances can lead to large differences when comparing the expected performance of the system to the experimental results. While control laws can be implemented to over-come these disturbances by simply using actuator forces large enough in magnitude, developing a system model for estimation purposes can pose quite a challenge. Many of the disturbance effects listed above are simply too infeasible to properly measure or estimate accurately at best. Furthermore, mistaken identification of a disturbance as a fault during fault estimation can occur if the magnitude of the disturbance is large. Because of this, several compromises were made in the development of the sliding mode observer for fault detection to better estimate actuator faults of the SAFE system. One change to the system model was to neglect angular velocity and acceleration. Be104

4.2. Satellite Airbed Formation Experiment - Fault Detection cause the platform is typically rotating slowly (5-0 deg/s) and accurate sensors to measure angular rates are unavailable due to noise and vision system precision, our system model reduces to the following equations of motion. x ¨ = (U4 T4 - U2 T2 )/ms y ¨ = (U3 T3 - U1 T1 )/ms (4.15) (4.16)

The inclusion of angular rates in the system model yielded gross mis-representation of the platform's true position. Discarding these values gave a much more accurate model which correlated with the measurements. Because the fan system is actuated to either be on or off from a binary control signal from a sliding mode control law, actuation commands can switch quite frequently. When inputting this signal to the electric fans, transient rise time effects prevent the actuators from exactly matching the desired control input. Experimentally characterizing this effect is rather difficult and would require precise force sensor measurements. This difficulty is also compounded by the fact that each thruster may output different levels of thrust due to the inherent variations in electrical and mechanical properties. A feasible approximation for the thruster force would be to apply a low pass filter on the binary control signal, depicted in Figure 4.15.
Pre-filtered Thrust Signal 1 1 Filtered Thrust Signal

Commanded Thrust Signal

0.8 Filter output 0 10 20 30 40 Time [s] 50 60 70

0.8

0.6

0.6

0.4

0.4

0.2

0.2

0

0

0

10

20

30

40 Time [s]

50

60

70

Figure 4.15: Filtration of commanded thrust signal yields significantly more accurate representation of true system dynamics

105

Chapter 4. Hardware-in-the-Loop Validation

4.2.7

Sliding Mode Observer Design

The design of the sliding mode observer for the application of SAFE fault detection will differ from the proposed sliding observer design in the majority of the thesis. The SMO will be utilized as a sliding mode differentiator instead, differentiating the velocity signal from a Kalman filter estimating position and positional rates. Using the SMO differentiator to obtain acceleration estimates can be used to yield thrust estimates of the system. Because no velocity sensor is available for the system, the sensor fusion technique will not be used, instead only a single observer will be needed to provide thrust estimates. The main reason for using velocity estimates from the filter than position is mainly because processing only position information to the sliding mode observer was not sufficient to provide an accurate acceleration estimation mainly due to noise.
U
Control Law

1 1W s

Inertial
Camera Vision Pose Estimate

Velocity
Inertial to Body Frame Rotation

Position Attitude

Estimate
Kalman Filter

U
Thrust Estimate Comparison

ªX º R(T ) « » ¬Y ¼

ªxº « y» ¬ ¼

Sliding Mode Observer

Acceleration Estimate

Figure 4.16: Flow chart of fault detection process In order to detect actuator faults, we must analyze the system in the body frame. Prior to entering the Kalman filter, the inertial frame measurements are rotated into the body frame. The velocity estimate from this filter is then processed through the sliding mode observer equations (Eq. 4.17). Note that unlike most sliding mode observer designs control input is neglected due to poor performance - the inclusion of the filtered control input severely disfigures the thrust estimate of the system. Instead, the thrust estimate is resolved independently of the control input, only requiring the x-y velocity Kalman filtered estimate of the system. The observer equations are given below. Figure 4.16 describes this process. 106

4.2. Satellite Airbed Formation Experiment - Fault Detection

2 = f ^(t, x x ^ ^1 , x ^2 , u) + z (t) z (t) = z1 (t) + z2 (t) z 1 = -2 sign(x2 - x ^2 ) z2 = -2 |x2 - x ^2 |0.5 sign(x2 - x ^2 ) ^(t, x1 , x2 , u) is neglected Where x2 is the state velocity of the system. Note that f - normally it would represent been the equations of motion or control input, however, discarding this term forces the observer to re-construct this value based on measurements. Thus, the examination of the filtered response of Z2 will yield an acceleration value for the x-y axis. Once this is done, we can further isolate faults for the Tn thruster in the following manner shown in Table 4.6. Table 4.6: Thrust value identification Estimation Value ^ x ¨ or ^ ¨ y >0 ^ x ¨ or ^ ¨ y <0 X-axis Thrusters ^ U4 = m s x ¨ And U2 =0 ^ U4 = 0 And U2 =-ms x ¨ Y-axis Thrusters U3 = ms^ ¨ y And U1 =0 ^ U3 =0 And U1 = -ms x ¨ (4.17)

Because the acceleration estimate is done along the body frame, we can associate a positive or negative acceleration value with a particular thruster. For instance, provided there is little influence from disturbances, a positive thrust along the x-axis correlates to the left thruster (T4) firing while a negative acceleration is associated with the right thruster (T2). Similarly, a positive y-axis acceleration correlates with the bottom thruster (T3) firing while a negative acceleration along this axis corresponds to the top thruster (T1) firing. In this fault scenario, thruster commands are specified in Table 4.7. During the simulation, the SAFE system will experience loss of control and will not output the desired commanded thrust. Figures 4.17 depict thrust estimation on each actuator. By resolving an acceleration estimation on the body frame a comparison can be made between the commanded thrust and the actual thrust values. During the fault occurrences, clear differences between these 107

Chapter 4. Hardware-in-the-Loop Validation Table 4.7: Thruster Commands Applied To Spacecraft Duration [s] t>50 and t<80
T1 Thruster 0.5
Actual Thrust

T1 ON

T2 ON

T3 ON

T4 ON
T2 Thruster

0.4
Estimated Thrust Commanded Thrust

0.4 Newtons [N] 0.3

0.3

0.2 0.2 0.1 0 0.1

0

20

40

60

80

100

120

0

0

20

40

60

80

100

120

T3 Thruster 0.5 0.4 0.3 0.2 0.1 0 0.5 0.4 0.3 0.2 0.1 0

T4 Thruster

Newtons [N]

0

20

40

60 80 Time [s]

100

120

0

20

40

60 80 Time [s]

100

120

Figure 4.17: SMO Thruster Estimation for the SAFE System

signals can be seen. Due to disturbances and un-modeled characteristics of the system, the precision in the reconstruction will differ from the true thrust value and the estimated at times. Note that the `true' thrust value in these plots are taken from the commanded thrust processed through a low pass filter multiplied by an approximated thrust value Un . These values were obtained experimentally and was found to have an average value of 0.2N, which 108

4.3. Summary
X-axis SMO Residuals 0.04 0.02 [m/s] 0 -0.02 -0.04

0

20

40

60

80

100

120

Y-axis SMO Residuals 0.05

[m/s]

0

-0.05

0

20

40

60 Time [s]

80

100

120

Figure 4.18: Sliding Mode Observer Error Residuals also includes the effects of micro-friction between the air bearings and glass surface. Figure 4.18 represents figures the sliding mode observer error residuals - the difference between the measured and estimated velocity states.

4.3

Summary

In this chapter, sliding mode observer design was applied to hardware testbeds for the purpose of actuator fault detection. The Single Axis Simulator reaction wheel validated the proposed fault detection scheme through accurate torque signal reconstruction in the presence of sensor measurement noise. Both angular position and velocity measurements were processed into separate sliding mode observers and sensor fusion was applied to combine state estimates. In the Satellite Airbed Formation Experiment setup, modifications were done to the observer design to account for several factors including the lack of velocity sensor inputs, disturbances and system uncertainties. The changes to the observer design forced the observer to re-construct control inputs based purely on sensor inputs rather than 109

Chapter 4. Hardware-in-the-Loop Validation relying on a system model describing plant dynamics. Successful correlation between actual the actual thrust signal and the sensor-based estimated variant can be seen.

110

Chapter 5

Conclusions

I

n this dissertation, an investigation into autonomous fault detection and recovery using variable structure observer and controller schemes were explored. Autonomous space-

craft behavior addresses many issues in regards to current and future considerations of space missions, such as the need for more analytical redundancy. In the past decade, over a dozen miniaturized satellites have been deployed, many of which lack the hardware redundancy needed in the event an actuator failure occurs. This is mainly because of the small satellite space and mass constraints which impose severe restrictions on non-vital accessories. To alleviate this, it can be seen that there has been initiatives in the aerospace research community to develop more autonomous spacecraft fault recovery or health monitoring systems. In the formation flying scenario, multiple satellites coordinating together will introduce an even greater level of complexity in mission operations. Because formation flying will most likely involve miniaturized satellites for maximal cost savings and effectiveness, analytical redundancy will most likely be required in these high risk missions in which maintaining formation sizes are critical to mission success.

5.1

Summary of Contributions

This work explored autonomous fault detection and recovery through the development of a new extended version of the broken super twisting sliding mode observer technique. Because most spacecraft systems will have positional and rate information, it was desirable to develop an observer system that can process both pieces of information. The broken super twisting sliding mode observer offered fault detection and state estimation capabilities through only processing positional information but was unable to process rate. By using sensor fusion techniques based on variance weighting, a second observer was used to 111

Chapter 5. Conclusions process rate information. The sensor fusion was responsible for dynamically weighting state estimates based on the variance of the observers such that redundant information can be resolved as a single estimate. Successful testing of this scheme yielded more precise state estimates for both the formation flying scenario and spacecraft attitude dynamics. Using the equivalent injection analysis, fault information was extracted from the observer and sent to a fault detector. By comparing the commanded control signal with the estimated output of the actuator, a fault can be determined by checking to see when this disparity crossed a threshold. Fault information was then sent a controller reconfiguration law which control mode to use based on the nature of the fault. In both the formation flying and attitude control scenario, fault recovery was established when the spacecraft was detected to be underactuated. In satellite formation flying, this occurred when no radial or no alongtrack control was detected in the LVLH frame. Similarly, in the attitude dynamics case, the spacecraft became underactuated when no roll or yaw (along-track and cross-track respectively). Through control law reconfiguration, full three-axis stabilization was achieved in these failure events. Successful fault reconstruction and recovery was demonstrated in the presence of unmodelled disturbances. To further validate the proposed fault detection scheme, hardware-in-the-loop tests were conducted to show fault detection applied on real systems. Using a single-axis reaction wheel, torque faults were induced into the system which remained unknown to the observer. Reconstruction of the true torque in a simulated hardware environment in the presence of sensor noise and model uncertainties was accomplished and shown to match the true torque of the system. Applying the fault technique on the satellite airbed formation experiment setup required modifications to the fault reconstruction algorithm due system disturbances and uncharacteristic dynamics. Through using the sliding mode observer as a differentiator, acceleration estimation on the body frame of the platform was shown to correlate with the commanded thrust signal, thus allowing for fault reconstruction based on sensor measurements only.

112

5.2. Future Work

5.2

Future Work

While this thesis covers variable structure observer utilization for the purpose of fault estimation, it only exposes a small range of possible selections of the vast number of fault estimators and sensor fusion schemes which exist in the literature. Due to limited time, only a handful of hardware-in-the-lo op tests were performed to validate the proposed fault reconstruction technique. Several topics for future investigation have been identified for the proposed sliding mode observer technique. The broken sliding mode observer was chosen mostly due to its simplicity and ease of use with its drawback being unable to process rate measurements. In the literature, there are many variants of the sliding mode observer, some which can easily be designed to accept additional sensor measurements. However, a large majority of these observers do not provide a clear method of reconstructing actuator fault signals as SMO design has traditionally been utilized for state estimation. Additionally, many SMOs may require mathematical restrictions based on the type of plant system in order to function. A more thorough literature review should be examined which addresses SMO design without requiring a two-observer approach while performing simultaneous state estimation and fault detection. Should the two-observer approach be further investigated, work on improving the sensor fusion methodology for redundant state estimate should be looked into. The sensor fusion method utilized in this dissertation is quite basic compared to the more advanced techniques which exist in the literature today. For instance, statistical inference using methods such as a Dempster-Shafer approach is one popular advanced technique which can be implemented. Improvements to the current sensor fusion technique may include using a 'forgetting factor' approach to covariance estimation which can allow for faster convergence to the optimal state estimate between two redundant states. Using the 'forgetting factor' method does not weight the entire residual history unlike the current implemented method, instead it weights the current history more, allowing the covariance estimate to be more up-to-date with the current measurement. Additionally, experimentation of fusing the fault estimate should also be considered, as both observers are capable of fault reconstruction. The current fault detection scheme compares the estimated control output with the 113

Chapter 5. Conclusions commanded control input. Should the two differ by a constant threshold value, an alert is sent to the controller reconfiguration law. This scheme is quite basic and is dwarfed by the vast number of 'intelligent' fault detection schemes, such as the usage of neural networks and fuzzy logic to discern faults. This method also suffers in the presence of higher levels of noise which can severely affect the fault detection scheme triggering false positives. A dynamic threshold value that is a function of several parameters such as noise level may be a better alternative and should also be investigated. Further investigation should be considered in regards to the fault estimation scheme on the satellite airbed formation experiment (SAFE). While fault reconstruction proved successful for the single axis simulator (SAS), modifications to the proposed SMO was done in order to accommodate the deficiencies of the SAFE system. In the current SMO design, successful state and fault estimation requires an accurate deterministic model of the plant. Unfortunately, this is not the case with SAFE as it suffers from numerous disturbances which have proven difficult to model. Three-degrees of freedom fault estimation should be feasible, so long as the SAFE platform does not experience abrupt levels of viscous friction between the air bearings and the glass surface or does not suffer from parasitic torque from thruster center of mass mis-alignment or is not influenced by gravitational anomalies due to improper elevations of the glass surface which the platform rests on. Once these issues are addressed, system modeling of SAFE will be much more feasible and the proposed fault estimator will function without the need for modifications.

114

Bibliography
[Aeyels 1985] Aeyels, D, "Stabilization by Smooth Feedback Of The Angular Velocity of a Rigid Body," Systems and Control Letters, Vol. 6, No. 1, 1985, Pages: 59­63. 67 [Bacconi F. 2003] Bacconi F., Angeli D., Mosca E., "Attitude Control of Asymmetric Spacecrafts Subject to Actuator Failurs," IEEE Conferenc on Control Applications - Proceedings, Vol. 98, Italy, August 26, 2003, Pages: 474­479. 66 [Barua 2009] Barua, A., Sinha P. Khorasani K., "A Diagnostic Tree Approach for Fault Cause Identification in the Attitude Control," Acta Astronautica, Vol. 45, No. 3, July 2009, Pages: 983­1002. 63 [Benallegue 2008] Benallegue, A., Mokhtari A. Fridman L., "High-order Sliding-Mode Observer For a Quadrotor UAV," International Journal of Robust and Nonlinear Control, Vol. 18, No. 4-5, 2008, Pages: 427­440. 24 [Bordner 2006] Bordner, R.E., Wiesel W.E., "Trajectory Estimation for Satellite Clusters," Journal of Guidance, Navigation and Control, Vol. 40, No. 1, 2006, Pages: 172­178. 34 [Carotenuto 2005] Carotenuto, S., Iannelli L. Manfredi S. Santini S., "Sensor Fusion by Using a Sliding Observer for an Underwater Breathing System," 44th IEEE Conference on Decision and Control, and the European Control Conference,, Seville, Spain, Dec 12-15, 2005, Pages: 7662­7667. 29 [Chen 2007] Chen, X.-Q., Zhang Y.-C. Geng Y.-H. Li H.-Y., "IMM/EA-based On-Orbit Reconfigurable Fault-Tolerant Control for Satellite Attitude Control System," Xi Tong Gong Cheng Yu Dian Zi Ji Shu - Systems Engineering and Electronics, Vol. 29, No. 2007, 2007, Pages: 774­777. 66 [Clohessy 1960] Clohessy, W., Wiltshire R, "Terminal Guidance Systems for Satellite Rendezvous," American Journal of Astronautical Sciences, Vol. 27, No. 9, 1960, Pages: 653­658. 40 115

Bibliography [Davila 2005] Davila, J., Fridman L. Levant-A., "Second-Order Sliding-Mode Observer for Mechanical Systems," IEEE Transactions of Automatic Control, Vol. 50, No. 11, 2005, Pages: 1785 ­ 1789. 24, 25, 27, 92 [Drakunov 1983] Drakunov, S.V., "An Adaptive Quasioptimal Filter with Discontinous Parameters," Automation and Remote Control, Vol. 44, No. 9, 1983, Pages: 1167­1175. 23 [Duta ] Duta, M., Henry M., "The Fusion of Redundant Seva Measurements," IEEE Transactions on Control Systems Technology. 29 [Edwards C 1998] Edwards C, Spurgeon S.K, Sliding Mode Control - Theory and Application, Taylor and Francis Ltd, London, UK, 1998. 44 [Edwards 2000] Edwards, C., Spurgeon S.K. Patton-R.J., "Sliding Mode Observers for Fault Detection and Isolation," Automatica, Vol. 36, No. 4, 2000, Pages: 541­553. 24, 25, 63 [Edwards 2007] Edwards, C., Fridman L. Thein-M.-W.L., "Fault Reconstruction in a

Leader/Follower Spacecraft System Using Higher Order Sliding Mode Observers," Proceedings of the 2007 American Control Conference, New York, NY, July 9-13, 2007, Pages: 408­413. 25, 26 [Ferguson 2001] Ferguson, Busse, How J, "Navigation Performance Predictions For The Orion Formation Flying Mission," AIAA Space 2001 - Conference and Exposition, Albuquerque, NM, Aug 28-30, 2001. 34 [Fridman L.-in W. Perruquetti 2002] Fridman L.-in W. Perruquetti, J. P. Barbot, Sliding Mode Control in Engineering, Marcel Dekker, New York, Ny, 2002. 29 [Godard 2010] Godard, Kumar, K.D., "Robust Control of Underactuated Spacecraft Formations," Proceedings of the 15th Canadian Aeronautics and Space Institute (CASI) ASTRO Conference, Vol. 15, Toronto, ON, May 4-6, 2010, Pages: 1­6. 40, 43 116

Bibliography [Godard 2011] Godard, G., Kumar K.D., "Robust Attitude Stabilization of Spacecraft Subject To Actuator Failures," Acta Astronautica, Vol. 68, No. 7-8, 2011, Pages: 1242­ 1259. 67, 68 [Gomez ] Gomez, M., "A Typical Spacecraft Autonomoy System," International Conference on Machine Learning (ICML) Workshop on Machine Learning Technologies for Autonomous Space Applications, Johns Hopkins University Applied Physics Laboratory, Aug 21 - 24. 5 [Griffin & French 2004] Griffin, M, & French, J, Space Vehicle Design, AIAA Education, New York, NY, 2nd édition, 2004. 75 [G.W 1878] G.W, Hill, "Researchers in the Lunar Theory," American Journal of Mathematics, Vol. 1, No. 1, 1878, Pages: 5­26. 40 [He 2009] He, R., Chen X. Geng Y. Zhang Y., "Integrated Fault Detection and Faulttolerant Based Sliding Mode Observer," 2009 4th IEEE Conference on Industrial Electronics and Applications, ICIEA 2009, Xi'an, China, May 25-27, 2009, Pages: 3454­3457. 63 [Hodges 2008] Hodges, L., Woll R., "Air Force Satellite Control Network (AFSCN) Support for Operational Responsive Space (ORS)," 6th Responsive Space Conference, Vol. 6, Los Angeles, CA, April 28 - May 1, 2008, Pages: 100­106. 5 [Hu 2011] Hu, Q., Zhang Y. Huo X. Xiao B., "Adaptive Integral-Type Sliding Mode Control for Spacecraft Attitude Maneuvering Under Actuator Stuck Failures," Chinese Journal of Aeronautics, Vol. 24, No. 1, 2011, Pages: 32­45. 66 [J. Davila 2006] J. Davila, L. Fridman, A. Poznyak, "Observation and Identification of Mechanical Systems via Second Order Sliding Modes," Proceedings of the 2006 International Workshop on Variable Structure System, Alghero,Italy, June 5-7, 2006, 2006, Pages: 232­237. 25, 31, 64 [Jerey W. 2002] Jerey W., Brian F., "FUSE In-orbit Attitude Control with Two Reaction Wheels and No Gyroscopes," Proceedings of SPIE - The International Society for 117

Bibliography Optical Engineering, Future EUV/UV and Visible Space Astrophysics Missions and Instrumentation Conference, Vol. 4854, Waikoloa, HI, Aug. 22-23, 2002, Pages: 274­285. 57, 65 [Jiang 2007] Jiang, T, Khorasani K, "A Fault Detection, Isolation and Reconstruction Strategy For a Satellite's Attitude Control Subsystem with Redundant Reaction Wheels," Proceedings of the IEEE International Conference on Systems, Man and Cybernetics, Vol. 4413851, Montreal , QC, October 7, 2007, Pages: 3146­3152. 24 [Jiang 2008] Jiang, T., Khorasani K.a Tafazoli, "Parameter Estimation-Based Fault Detection, Isolation and Recovery for nonlinear satellite models," IEEE Transactions on Control Systems Technology, Vol. 4, July 2008, Pages: 799­808. 63 [Kaplan 1976] Kaplan, M.H., Modern Spacecraft Dynamics and Control, John Wiley and Sons, New York, NY, 1976. 84 [Kazmi 2010] Kazmi, I.H., Bhatti A.I. Iqbal M., "Parameter Estimation of PEMFC system with Unknown Input," Proceedings of the 11th International Workshop on Variable Structure Systems, Mexico City, Mexico, June 26 - 28, 2010, Pages: 301­306. 24, 25, 28 [Kim 2003] Kim, Y.V.a, Deraspe G.b, "Resolving RADARSAT-1 Momentum Wheels failure problem," 54th International Astronautical Congress of the International Astronautical Federation (IAF), the International Academy of Astronautics and the International Institute of Space Law, Vol. 3, Bremen, Germany,, Sept-Oct 29-3, 2003, Pages: 1331­1339. 66 [Lam 2001] Lam, Q., Sanneman P., "A Mixed-Mode Attitude Control System Strategy for Actuator Failure Accommodation," Proceedings of the AIAA Guidance, Navigation, and Control Conference and Exhibit, Vol. 1, Montreal, Canada, Aug. 6-9, 2001, Pages: 483­496. 57 [Levant ] Levant, A., "Sliding order and sliding accuracy in sliding mode control," International Journal of Control. 24 118

Bibliography [Li 2011] Li, Z, Liu G. Zhang R. Zhu Z., "Fault Detection, Identication and Reconstruction For Gyroscope in Satellite Based on Independent Component Analysis," Acta Astronautica, Vol. 68, No. 7-8, 2011, Pages: 1015­1023. 63 [May-Win L. Thein 2007] May-Win L. Thein, Julie K. Thienel, "Relative Position Estimation and Control for Precision Formation Flying of Two Spacecraft Formations," Proceedings of the AIAA Guidance, Navigation and Control Conference and Exhibit, Vol. 4, Hilton Head, South Carolina, August 20-23, 2007, Pages: 3913­3922. 26 [Morin 1996] Morin, P., "Robust Stabilisation of the Angular Velocity of a Rigid Body With Two Controls," European Journal of Control, Vol. 2, No. 1, 1996, Pages: 51­56. 67 [Murugesan & Goel 1987] Murugesan, S., & Goel, P.S., "Fault-tolerant Spacecraft Attitude Control System," Sadhana (India), Vol. 11, No. 1 and 2, 1987, Pages: 233­261. 2 [Rabhi 2008] Rabhi, A., M'Sirdi N.K. Naamane A. Jaballah B., "Second Order Slidingmode Observer for Estimation of Vehicle Dynamic Parameters," International Journal of Vehicle Design, Vol. 48, No. 3/4, 2008, Pages: 190­207. 24, 25, 26 [Roberts 2004] Roberts, B.A., Kruk J.W. Ake T.B. Englar T.S.-Class B.F. Rovner-D.M., "Three-axis Attitude Control with Two Reaction Wheels and Magnetic Torquer Bars," Proceedings of AIAA Guidance, Navigation , and Control Conference, AIAA 2004-5245, Vol. 4, Providence, RI, Aug. 16-19, 2004, Pages: 2465­2472. 65 [Robertson 2003] Robertson, B., Stoneking E., "Satellite GN&C Anomaly Trends,"

Guidaance and Control 2003: Advances in the Astronautical Sciences, Vol. 113, Breckenridge, CO, Feb. 5-9, 2003, Pages: 531­542. 3 [R.W. Brockett 1999] R.W. Brockett, R.S. Millman, H.H. Sussmann, Asymptotic Stability and Feedback Stabilization, Birkhauser, Boston, 3rd édition, 1999. 67 [Sabol 2001] Sabol, C., Burns R. McLaughlin C.A, "Satellite Formation Flying Design and Evolution," Journal of Spacecraft and Rockets, Vol. 38, No. 2, 2001, Pages: 270­ 278,35,36. 22 119

Bibliography [Shen & Tsiotras 1999] Shen, H., & Tsiotras, P., "Time-optimal control of axisymmetric rigid spacecraft using two controls," Journal of Guidance, Control, and Dynamics, Vol. 22, No. 5, 1999, Pages: 682­694. 67 [Sherwood 2008] Sherwood, R., Chien S. Tran D. Cichy B.-Castano R. Davies-A. Rabideau G., "The ST6 Autonomous Sciencecraft Experiment," IEEE Aerospace Conference Proceedings, Vol. 6, Big Sky, MT, Mar 5 - 12, 2008, Pages: 1­6. 5 [Shraim 2008] Shraim, H., Ouladsine M. Fridman L., "Vehicle Parameter and States Estimation via Sliding Mode Observers," Lecture Notes in Control and Information Sciences, Vol. 375, 2008, Pages: 345­362. 24, 25, 26 [Sontag & Sussmann 1988] Sontag, E.D., & Sussmann, H.J., "Global Stabilization of Linear Discrete-Time Systems With Bounded Feedback," Systems and Control Letters, Vol. 12, No. 3, 1988, Pages: 213­217. 67 [Sun 2004] Sun, S.-L., "Multi-sensor Information Fusion White Noise Filter Weighted by Scalars Based on Kalman Predictor," Automatica, Vol. 40, No. 9, 2004, Pages: 1447­1453. 29 [Tafazoli 2009] Tafazoli, M., "A study of on-orbit spacecraft failures," Acta Astronautica, Vol. 64, No. 2, 2009, Pages: 195­205. xix, 2, 3 [Talole 2007] Talole, S.E., Benito J. Mease K.D., "Sliding Mode Observer for Drag Tracking in Entry Guidance," Proceedings of the AIAA Guidance, Navigation and Control Conference and Exhibit, Vol. 5, Hilton Head, SC, Aug. 20-23, 2007, Pages: 5122­ 5137. 23 [Thein 2008] Thein, May-Win L., "Comparative Observer-Based Nutation Control Techniques for NASA Magnetospheric Multiscale (MMS) Mission Spacecraft," Proceedings of the AIAA Guidance, Navigation and Control Conference and Exhibit, Honolulu, Hawaii, Aug 18-21, 2008. 24 [Tudoroiu 2006] Tudoroiu, N., Sobhani-Tehrani E. Khorasani K. Letia-T. Tudoroiu R.-E., "Real-time Fault Diagnosis of Satellite Attitude Control System Based on Sliding120

Bibliography Window Wavelet and DRNN," IECON Proceedings (Industrial Electronics Conference), Paris, France, Nov. 6-10, 2006, Pages: 264­269. 63 [Utkin 2002] Utkin, V.I. Chang, H.-C, "Sliding Mode Control on Electro-Mechanical Systems," Mathematical Problems in Engineering, Vol. 8, No. 4, 2002, Pages: 451­473. 23 [Wertz & Larson 1999] Wertz, J.R., & Larson, W.J., Space Mission Analysis and Design, Microcosm and Kluwer, New York, NY, 3rd édition, 1999. 84 [Wie 1998] Wie, B., Space Vehicle Dynamics and Control, AIAA Inc., Reston, VA, 1998. 84 [Wu & Saif ] Wu, Qing, & Saif, Mehrdad, "Robust Fault Diagnosis of a Satellite System Using a Learning Strategy and Second Order Sliding Mode Observer," IEEE SYSTEMS JOURNAL. 25 [Wu & Saif 2007] Wu, Qing, & Saif, Mehrdad, "Robust Fault Detection and Diagnosis for a Multiple Satellite Formation Flying System Using Second Order Sliding Mode and Wavelet Networks," Proceedings of the 2007 American Control Conference, Marriott Marquis Hotel at Times Square, July 11-13, 2007. 25 [Wu 2007] Wu, L., Zhang Y.-Li H., "Research On Fault Detection for Satellite Attitude Control Systems Based on Sliding Mode Observers," 2009 IEEE International Conference on Mechatronics and Automation, ICMA 2009, Changchun, China,, Aug 9-12, 2007, Pages: 4408­4413. 63 [Wu 2009] Wu, L., Zhang Y.-Li H., "Research on Fault Detection for Satellite Attitude Control Systems Based on Sliding Mode Observers," Proceedings of the IEEE International Conference on Mechatronics and Automation, Changchun, China, August 9-12, 2009, Pages: 4408­4413. 24 [Yuehua Cheng 2008] Yuehua Cheng, Bin Jiang, Xian Zhang, "A Micro-satellite Attitude System Using Sliding Mode Observer and Sliding Mode Controller with Perturbation Estimation," Proceedings of the 2008 2nd International Symposium on Systems and 121

Bibliography Control in Aerospace and Astronautics, ISSCAA 2008, Shenzhen,China, Dec, 2008. 24 [Yuri B. Shtessel 2010] Yuri B. Shtessel, Charles E. Hall, Simon Baev-Jeb S. Orr, "Flexible Modes Control Using Sliding Mode Observers: Application to Ares I," Proceedings of the AIAA Guidance, Navigation, and Control Conference, Toronto, Ontario, Aug. 2-5,, 2010. 24 [Zhang 2007] Zhang, Y.Ch., Chen X.Q. Chen M. Geng Y.H., "A Novel Approach for Satellite Attitude Reconfigurable Fault-Tolerant Control," ICIEA 2007: 2007 Second IEEE Conference on Industrial Electronics and Applications, 2007, Pages: 2612­ 2616. 66 [Zhurbal 2008] Zhurbal, A., Idan M., "Effect of Estimation on the Performance of an Integrated Missile Guidance and Control System," Proceedings of the AIAA Guidance, Navigation and Control Conference and Exhibit, Vol. 98, 2008. 23, 63

122

