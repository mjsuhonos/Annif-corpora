COOPERATIVE SUBCARRIER AND POWER ALLOCATION IN OFDM BASED RELAYING SYSTEMS
by

Hamed Rasouli BSc, University of Tehran, Tehran, Iran, 2003 MSc, Iran University of Science and Technology, Tehran, Iran, 2006
A Dissertation Presented to the School of Graduate Studies at Ryerson University in partial fulfilment of the requirements for the degree of Doctor of Philosophy in the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2012 c Hamed Rasouli, 2012 

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A DISSERTATION I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my dissertation may be made electronically available to the public.

ii

ABSTRACT

Cooperative Subcarrier and Power Allocation in OFDM based Relaying Systems

c Hamed Rasouli, 2012  Doctor of Philosophy Electrical and Computer Engineering Ryerson University

The increasing use of relays in wireless communication systems is a driving force to explore innovative techniques that can improve the quality of service as well as enhance the coverage of wireless systems. Orthogonal frequency division multiple access (OFDMA) is widely deployed in broadband wireless systems to effectively combat the frequency selectivity of the wireless fading channel. Wireless relays are used in practical OFDM-based wireless systems such as WiMAX to increase the capacity and diversity order of the system. To fully exploit the benefits of OFDMA, relaying systems require efficient management of resources, including power and subcarriers. The difficulty in resource allocation in a relaying system is the nonconvexity of the optimization problem caused by the inter-relationship of all the resources through the relay station. Therefore, suboptimal and heuristic algorithms are proposed to assign power and subcarriers to the users in the relaying system while maintaining flexible fairness in resource allocation. In this dissertation, we improve the efficiency of subcarrier and power allocation algorithms with flexible fairness in the downlink of an amplify-and-forward (AF) OFDM relaying system. We propose an asymptotically fair subcarrier allocation algorithm that provides flex-

iii

ibility in the fairness index for possible improvement in the total throughput of the system by using a group-based approach. We investigate the problem of power allocation for an AF relaying scheme by considering three different objective functions: average SNR, average BER, and outage probability. The results are presented for various relay locations and different total power in the system. It is shown that the solution to the power allocation problem does not depend on the objective function when the relay is closer to the mobile user for different objective functions. By deriving the capacity of the AF relaying, a new parameter, called cooperation coefficient, is introduced to quantify the cooperation level from the relaying links in the data rate of the the mobile station. Assuming flat power allocation and using the cooperation coefficient parameter, a cooperative subcarrier allocation algorithm is proposed that increases the total throughput of a multi-user OFDM relaying system by approximately 15%. We also propose a two-step solution for subcarrier and power allocation of an AF relaying system. In the first step, the total power is allocated to the users and relays based on the power ratio found for the single-relay system. In the second step, subcarriers are assigned to the users based on the cooperative subcarrier allocation algorithms. Based on our finding, the total throughput of the system improves by 25% using the two-step procedure. By applying the proposed asymptotically fair idea to the two-step subcarrier and power allocation, we maintain a flexible fairness and further increase the total throughput in an OFDM relaying system.

iv

Acknowledgements

I would like to express my deepest gratitude to my supervisor, Professor Alagan Anpalagan for his generous support and supervision, and for the great experience that he shared with me. I learned valuable lessons from his professional and positive attitude. I will never forget his encouragement when I faced difficulties and encountered frustration during my Ph.D studies. His careful reviews of this dissertation contributed significantly to its improvement. Without his endless support, my achievements would have not been possible. I would like to thank my thesis committee, Dr. Matthew Kyan, Dr. Bobby Ma, Dr. Isaac Woungang, and the external examiner, Dr. Shahram Shahbazpanahi, for taking the time and effort to review this dissertation. Appreciation also goes to administrative staff at the school of graduate studies and department of electrical and computer engineering for all the instances in which their assistance helped me along the way. Special thanks to my friends and colleagues in radio resource management radio access and networking (RRM & RAN) research group for their fruitful discussions and professional collaborations. Last, but not least, I would like to express my deep appreciation to my parents, for all their encouragement, understanding, support, patience, and true love throughout all the ups and downs.

v

Contents
Abstract . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . List of Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . List of Figures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . List of Acronyms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 Introduction 1.1 1.2 1.3 1.4 1.5 Relaying in Wireless Communication . . . . . . . . . . . . . . . . . . . . . . Radio Resource Allocation . . . . . . . . . . . . . . . . . . . . . . . . . . . . Research Focus and Motivation . . . . . . . . . . . . . . . . . . . . . . . . . Research Contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Thesis Outline . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . iii v ix xiv xv 1 3 6 8 11 12 14 15 16 18 21 25 27

2 OFDM Wireless Systems: Basic Concepts and General Model 2.1 2.2 2.3 2.4 2.5 2.6 Wireless Fading Channel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Mathematical Model of Radio Channel . . . . . . . . . . . . . . . . . . . . . Multiple Access Techniques . . . . . . . . . . . . . . . . . . . . . . . . . . . OFDM System . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . General OFDM-based Relaying System Model . . . . . . . . . . . . . . . . . Chapter Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

vi

3 Non-Cooperative Subcarrier Allocation Techniques 3.1 3.2 3.3 3.4 Subcarrier Allocation: System Model and Parameters . . . . . . . . . . . . . Throughput-Oriented Subcarrier Allocation . . . . . . . . . . . . . . . . . . Fairness-Oriented Subcarrier Allocation . . . . . . . . . . . . . . . . . . . . . Asymptotically Fair Subcarrier Allocation . . . . . . . . . . . . . . . . . . . 3.4.1 3.4.2 3.5 Subcarrier Allocation to Groups . . . . . . . . . . . . . . . . . . . . . Subcarrier Allocation to Users . . . . . . . . . . . . . . . . . . . . . .

28 31 34 35 37 39 41 42 42 43 46 48 50 50 52 53 54 55 56 57 63 66 72 78 81 81

Performance Evaluation: Throughput and Fairness . . . . . . . . . . . . . . 3.5.1 3.5.2 Simulation Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3.6 3.7

Analysis of the Proposed Algorithm . . . . . . . . . . . . . . . . . . . . . . . Chapter Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4 Cooperative Relaying Techniques 4.1 4.2 Single-Relay System Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . Relaying Techniques . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.2.1 4.2.2 4.2.3 4.3 AF Relaying . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . DF Relaying . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . EF Relaying . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Performance of Different Relaying Schemes . . . . . . . . . . . . . . . . . . . 4.3.1 4.3.2 4.3.3 4.3.4 Average SNR . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Average Capacity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Outage Probability . . . . . . . . . . . . . . . . . . . . . . . . . . . . Bit Error Rate . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4.4

Chapter Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5 Power Allocation for AF Relaying Scheme 5.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

vii

5.2

SNR-based Power Allocation . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.2.1 5.2.2 5.2.3 BER-based Power Allocation . . . . . . . . . . . . . . . . . . . . . .

83 84 86 87 91 93 94 96 97 98

Outage-based Power Allocation . . . . . . . . . . . . . . . . . . . . . Numerical Results and Discussion . . . . . . . . . . . . . . . . . . . .

5.3

Chapter Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6 Cooperative Subcarrier and Power Allocation in Relaying Systems 6.1 Multi-user Relaying System Model . . . . . . . . . . . . . . . . . . . . . . . 6.1.1 6.1.2 6.1.3 6.2 Cooperation Coefficient . . . . . . . . . . . . . . . . . . . . . . . . . . The pdf of Cooperation Coefficient . . . . . . . . . . . . . . . . . . . Statistics of Cooperation Coefficient . . . . . . . . . . . . . . . . . . .

Cooperative Subcarrier Allocation . . . . . . . . . . . . . . . . . . . . . . . . 101 6.2.1 6.2.2 6.2.3 Throughput-Oriented Cooperative Subcarrier Allocation . . . . . . . 101 Fairness-Oriented Cooperative Subcarrier Allocation . . . . . . . . . 103

Asymptotically Fair Cooperative Subcarrier Allocation . . . . . . . . 105

6.3

Performance Evaluation: Capacity and Fairness . . . . . . . . . . . . . . . . 108 6.3.1 6.3.2 6.3.3 Simulation Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . 109 Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109 Discussion of Results . . . . . . . . . . . . . . . . . . . . . . . . . . . 113

6.4

Two-Step Power and Subcarrier Allocation . . . . . . . . . . . . . . . . . . . 118 6.4.1 6.4.2 Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119 Discussion of Results . . . . . . . . . . . . . . . . . . . . . . . . . . . 119

6.5

Chapter Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122 124

7 Conclusions and Future Work 7.1 7.2

Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124 Future Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126 129 viii

Bibliography

List of Tables
4.1 4.2 4.3 TDMA transmission protocol for the relaying system. . . . . . . . . . . . . . Performance comparison for different relaying techniques. . . . . . . . . . . . Optimum relay location for AF relaying scheme. . . . . . . . . . . . . . . . . 52 79 79

ix

List of Figures
1.1 2.1 2.2 2.3 2.4 3.1 3.2 3.3 3.4 3.5 3.6 4.1 4.2 4.3 4.4 4.5 4.6 4.7 Inter-relationship diagram between the chapters. . . . . . . . . . . . . . . . . Multipath channel model. . . . . . . . . . . . . . . . . . . . . . . . . . . . . OFDM transceiver system model. . . . . . . . . . . . . . . . . . . . . . . . . OFDM PHY/MAC layer system model. . . . . . . . . . . . . . . . . . . . . . Multi-user relaying system model. . . . . . . . . . . . . . . . . . . . . . . . . Two-step asymptotically fair subcarrier allocation. . . . . . . . . . . . . . . . Average fairness versus number of OFDM symbols, Total throughput versus number of OFDM symbols, Average fairness versus number of OFDM symbols, Total throughput versus number of OFDM symbols, = 6. . . . . . . . . . . = 6. . . . . . . . . . = 12. . . . . . . . . . = 12. . . . . . . . . . 12 16 22 24 25 40 44 44 45 45 47 51 55 56 57 . 59 . 60

Fairness vs. throughput in asymptotically fair subcarrier allocation. . . . . . The relaying system model. . . . . . . . . . . . . . . . . . . . . . . . . . . . EF Relaying Combination Scheme. . . . . . . . . . . . . . . . . . . . . . . . The relaying system model, case (a). . . . . . . . . . . . . . . . . . . . . . . The relaying system model, case (b). . . . . . . . . . . . . . . . . . . . . . . Average SNR comparison for AF and DF relaying as a function of Average SNR comparison for AF and DF relaying as a function of Average SNR comparison for AF and DF relaying as a function of , , , =3 =

= 3 . 61

x

4.8

Average SNR comparison for AF and DF relaying as a function of 20dBm, =3

,

= 62

.. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . , =

4.9

Average SNR comparison for AF and DF relaying as a function of 20dBm, =

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . , =

62

4.10 Average SNR comparison for AF and DF relaying as a function of 20dBm, =3

.. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ,

63

4.11 Average capacity comparison for AF and DF relaying as a function of =3

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ,

64

4.12 Average capacity comparison for AF and DF relaying as a function of =

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ,

65

4.13 Average capacity comparison for AF and DF relaying as a function of

=3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.14 Average capacity comparison for AF and DF relaying as a function of = 20dBm, =3 ,

65

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ,

66

4.15 Average capacity comparison for AF and DF relaying as a function of = 20dBm, =

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ,

67

4.16 Average capacity comparison for AF and DF relaying as a function of = 20dBm, =3

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ,

67

4.17 Outage probability comparison for AF and DF relaying as a function of =3

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ,

69

4.18 Outage probability comparison for AF and DF relaying as a function of =

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ,

70

4.19 Outage probability comparison for AF and DF relaying as a function of

=3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.20 Outage probability comparison for AF and DF relaying as a function of = 20dBm, =3 ,

70

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

71

xi

4.21 Outage probability comparison for AF and DF relaying as a function of = 20dBm, =

, 71

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ,

4.22 Outage probability comparison for AF and DF relaying as a function of = 20dBm, =3

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . , , , , =3 =

72 . 75 . 75

4.23 Average BER comparison for AF and DF relaying as a function of 4.24 Average BER comparison for AF and DF relaying as a function of 4.25 Average BER comparison for AF and DF relaying as a function of 4.26 Average BER comparison for AF and DF relaying as a function of 20dBm, =3

= 3 . 76 = 76

.. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . , =

4.27 Average BER comparison for AF and DF relaying as a function of 20dBm, =

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . , =

77

4.28 Average BER comparison for AF and DF relaying as a function of 20dBm, 5.1 5.2 =3

.. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

77 88

The ratio of power allocated to the relay for different relay locations. . . . . BER performance of the BER-based and SNR-based power allocation schemes for different relay locations. . . . . . . . . . . . . . . . . . . . . . . . . . . .

89

5.3

Outage performance of the outage-based and SNR-based power allocation schemes for different relay locations. . . . . . . . . . . . . . . . . . . . . . . . 90

5.4

Average BER and outage probability, closed-form equation vs. optimum numerical point,
0

= 10dB. . . . . . . . . . . . . . . . . . . . . . . . . . . . .

91 94 95 96 99

6.1 6.2 6.3 6.4 6.5 6.6

Practical multi-user relaying system model. . . . . . . . . . . . . . . . . . . . General multi-user relaying system model. . . . . . . . . . . . . . . . . . . . Single-relay system model. . . . . . . . . . . . . . . . . . . . . . . . . . . . . pdf of cooperation coefficient for different relay location, .. . . . . . . . . .

Mean of cooperation coefficient for different relay locations,

. . . . . . . . . 100 . . . . . . . 100

Variance of cooperation coefficient for different relay locations,

xii

6.7

Total throughput and fairness index versus the number of OFDM symbols, = 2, = 0.5, = 256. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110

6.8

Total throughput and fairness index versus the number of OFDM symbols, = 3, = 0.5, = 256. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110

6.9

Total throughput and fairness index versus the number of OFDM symbols, = 4, = 0.5, = 256. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111

6.10 Total throughput and fairness index versus the number of OFDM symbols, = 6, = 0.5, = 256. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111

6.11 Total throughput versus number of users for throughput-oriented algorithms, = 0.7, = 256. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113 =

6.12 Total throughput versus number of users for fairness-oriented algorithms, 0.7,

= 256. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114

6.13 Total throughput versus number of users for throughput-oriented algorithms, = 0.5, = 256. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114 =

6.14 Total throughput versus number of users for fairness-oriented algorithms, 0.5,

= 256. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115

6.15 Total throughput versus number of users for throughput-oriented algorithms, = 0.3, = 256. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115 =

6.16 Total throughput versus number of users for fairness-oriented algorithms, 0.3,

= 256. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116

6.17 Total throughput versus number of users for throughput-oriented algorithms with power allocation, = 0.7, = 256. . . . . . . . . . . . . . . . . . . . . 119

6.18 Total throughput versus number of users for fairness-oriented algorithms with power allocation, = 0.7, = 256. . . . . . . . . . . . . . . . . . . . . . . . 120

6.19 Total throughput versus number of users for throughput-oriented algorithms with power allocation, = 0.5, = 256. . . . . . . . . . . . . . . . . . . . . 120

xiii

6.20 Total throughput versus number of users for fairness-oriented algorithms with power allocation, = 0.5, = 256. . . . . . . . . . . . . . . . . . . . . . . . 121 = 12, = 256. . . . . 121

6.21 Total throughput versus normalized relay location,

xiv

List of Acronyms
1G 2G 3G 4G AF APA AWGN BER BS cdf CDMA CSI D DF DSA EF FDMA FFT IEEE IDFT IFFT ISI LTE First Generation Second Generation Third Generation Fourth Generation Amplify and Forward Adaptive Power Allocation Additive White Gaussian Noise Bit Error Rate Base Station cumulative density function Code Division Multiple Access Channel State Information Destination Decode and Forward Dynamic Subcarrier Allocation Estimate and Forward Frequency Division Multiple Access Fast Fourier Transform Institute of Electrical and Electronics Engineers Inverse Discrete Fourier Transform Inverse Fast Fourier Transform Inter-Symbol Interference Long Term Evolution

xv

MAC MIMO ML MRC MS OFDM OFDMA PA pdf PEP PN PSD QoS R RMS RS S SNR TDMA WiMAX WINNER WMAN

Medium Access Control Multiple-Input-Multiple-Output Maximum Likelihood Maximal Ratio Combiner Mobile Station Orthogonal Frequency Division Multiplexing Orthogonal Frequency Division Multiplexing Access Power Allocation probability density function Pairwise Error Probability Pseudo-Noise Power Spectral Density Quality of Service Relay Root Mean Square Relay Station Source Signal to Noise Ratio Time Division Multiple Access Worldwide Inter-operability for Microwave Access Wireless World Initiative New Radio Wireless Metropolitan Area Network

xvi

Chapter 1 Introduction
Rapid development of wireless communication technologies and systems during the last decade has provided ubiquitous high data communication to mobile users by also developing new hardware and standards. Second-generation (2G) wireless systems were very successful to enhance the quality of speech communications in cellular systems. Their success prompted the development of third-generation (3G) wireless systems. While 2G systems such as GSM, IS-95, and cdmaOne were designed to carry speech and low-rate data, 3G systems were designed to provide high-data-rate services. During the evolution from 2G to 3G, a variety of wireless systems, including GPRS and IMT-2000 has been developed [1]. The fourth generation (4G) wireless systems support comprehensive and personalized services, providing stable system performance and quality of service. The data rates considered for 4G systems in reasonably large areas do not appear to be feasible with the conventional cellular architecture due to very high transmission rates and high-frequency spectrum [2]. High data rates envisioned for 4G systems are two orders of magnitude higher than those of 3G systems. This demand creates serious power concerns, since it is well known that for a given transmit power level, the symbol (and thus bit) energy decreases linearly with the increasing transmission rate [3]. The spectrum that will be released for 4G systems will almost certainly be located well above the 2 GHz band used by the current 3G systems [4].

1

The radio propagation in these bands is significantly more vulnerable to non-line-of-sight conditions, which is the typical mode of operation in today's urban cellular communication. One solution to these two problems is to increase the density of base stations significantly, which results in considerably higher deployment costs, and would only be feasible if the number of users would also increase at the same rate. On the other hand, the same number of users will have a much higher demand in transmission rates, making the aggregate throughput rate the bottleneck in future wireless systems. Under the working assumption that users will not be willing to pay the same amount per data bit as for voice bits, a drastic increase in the number of base stations does not seem economically justifiable. It is obvious from this discussion that more fundamental enhancements in the system architecture are necessary for the very ambitious increase in throughput and coverage requirements of future wireless systems.

Future Wireless Communications
The future wireless communication systems should provide ubiquitous services, the architectural issues involved, and describe approaches to dynamic spectrum assignment and adaptive resource management [5]. In addition to advanced transmission techniques [6] and multiple antenna technologies [7], major modifications are required in the wireless system architecture to enable an effective signal coverage in the system. The integration of relaying capability into conventional wireless networks is perhaps the most promising architectural upgrade in the future generation of wireless systems [2]. Wireless relays are specified in wireless system standards. The IEEE 802.16j [8­10] amendment provides specification for mobile multihop relay features and functions to enhance coverage, throughput, and system capacity of WiMAX networks. There has been an increasing trend toward the implementation of the relays in recent generation of wireless systems [2]. Wireless world initiative new radio (WINNER), a European Union funded project, has made some relevant contributions to the area of wireless relaying systems [11]. 2

The new standards for next generation of wireless services, such as IEEE 802.16 for wireless metropolitan area networks (WMAN) provide heterogeneous services over broadband channel. However, a successful deployment of the new standards faces a number of challenges, e.g., scarce spectrum, complex time-varying wireless channel, and providing quality of service for heterogeneous traffic.

1.1

Relaying in Wireless Communication

One way to combat fading effects in the system is through communication diversity; i.e., transmitting several independent replicas of the signal in orthogonal channels so that the probability that all of them go into deep fade decreases. Diversity can be achieved in different forms including temporal diversity, frequency diversity, and antenna diversity. Theoretical studies have shown that multiple-transmit and multiple-receive antenna can provide spatial diversity in the system [12]. The conventional antenna diversity schemes [13] have some limitations. The spacing between antenna elements needs to be larger than half a wavelength to avoid fading correlation and antenna coupling. In many practical wireless applications, wireless devices are so miniaturized that such spacing between multiple antenna cannot be employed. One of the methods to achieve spatial diversity is through the use of relay terminals, where each relay re-transmits the signal received from a remote source to the destination [14]. Cooperative relay terminal is an important physical layer concept that can assist the wireless network to achieve higher throughput and coverage, lower energy consumption and a longer lifetime of wireless routes [15]. The concept of relaying has been studied from information theory perspective in [16] for the first time. Relaying has been suggested to be used in the earlier cellular systems to extend the coverage for those areas that the base station cannot cover [17]. Using nearby mobile users for relaying was proposed in [18] for total throughput enhancement. The main idea is that after selecting a partner from the in-cell mobile users, each user detects a faded

3

and noisy version of the partner's transmit signal and combines this signal with its own to construct its transmit signal. It was shown in [19, 20] that the cooperative system achieves higher throughput compared to the non-cooperative one. Different relaying protocols have been proposed for cooperation among users [21]. The transmission of the signal by the source and relay should be done over orthogonal channels which could be in time, frequency, code or space, to mitigate interference. The capacity of various TDMA-based relaying protocols in a system with one source, relay and destination was analyzed in [22]. A distributed space-time coding technique was proposed for a system with one or two assisting relays in [23, 24]. It was shown that this design achieves a diversity gain over a point-to-point system with the same bandwidth.

Fixed and Mobile Relays
Fixed relays are low-cost and fixed radio infrastructures without wired backhaul connections. They store the data received from the base station (BS) and forward to the mobile stations (MS), and vice versa. Fixed relay stations (RS) typically have smaller transmission powers and coverage areas than a BS [25]. The IEEE 802.16j specification has incorporated fixed relays to enhance the WiMAX performance. Fixed relay is also a very strong candidate technology for 4G, with possible mesh extensions in a later standard release. Mobile relays differ from fixed relays in the sense that the RSs are mobile and are not deployed as the infrastructure of a network. Mobile relays are therefore more flexible in accommodating varying traffic patterns and adapting to different propagation environments. For example, when a target MS temporarily suffers from weak channel conditions or requires relatively high-rate service, its neighboring MS's can help and provide multihop coverage or increase the data rate by relaying the information to the target MS. Two types of mobile relay systems can be distinguished: moving networks and mobile user relays. The moving network employs dedicated RS's on moving vehicles (e.g., trains) to receive data from the BS and forwards to the MS's onboard, and vice versa. The purpose of the moving network is to 4

improve the coverage on the vehicle. The mobile user relay enables distributed MS's to selforganize themselves into a wireless ad hoc network, which complements the cellular network infrastructure using multihop transmissions. Currently, moving networks are supported by the IEEE 802.16j WiMAX standard. A number of advanced mobile relays concepts are being evaluated for the 4G standard.

Advantages of Relays
Fixed relays can be deployed strategically and cost effectively in cellular networks to extend coverage, reduce total transmission power, enhance the capacity of a specific region with high traffic demands, and/or improve signal reception. By combining the signals from the relays and possibly the source signal from the BS, the MS is able to exploit the inherent diversity of the relay channel. Similar to fixed relays, mobile relays can enlarge the coverage area, reduce the overall transmit power, and/or increase the capacity at cell edges. On the other hand, due to their opportunistic nature, mobile relays are less reliable than fixed relays since the network topology is highly dynamic and unstable. Theoretical studies [18] have shown that mobile user relays have a fundamental advantage in that the total network capacity, measured as the sum of the throughput of the users, can scale linearly with the number of users given sufficient infrastructure support. Mobile user relay is therefore a desirable enhancement to future cellular systems.

Challenges with Relays
The disadvantages of fixed relays are: (1) the additional delay introduced in the relaying process and (2) the potentially increased levels of interference due to frequency reuse at the RS's. As the most mature cooperative multiple-input-multiple-output (MIMO) technology, fixed relay has attracted significant support in major cellular communication standards. However, mobile user relays also face huge challenges in routing, radio resource man5

agement, and interference management. The major disadvantage of mobile user relays is that MS batteries can be used up by relay transmissions even if the user does not use them. Mobile user relays also complicate the billing problem (i.e., who shall pay the bill when a user helps other users as a relay). In this dissertation, we adopt fixed relay scenario due to its practicality; however, the presented results are not dependent on whether the relays are fixed or mobile.

1.2

Radio Resource Allocation

Radio resources, such as bandwidth and transmit power, would not be sufficient to support further communication demand unless advanced technologies are developed to achieve higher efficiency of resource utilization [26]. The traditional approach of statically managing the resources has resulted in a waste of scarce spectrum and power, because an extra margin in the link budget is required to maintain an acceptable performance in worst-case fading. Therefore, it is essential to adaptively control the resource utilization in order to achieve higher bandwidth and/or power efficiencies, as well as to provide better quality of service (QoS) while functioning under bandwidth and power constraints. Orthogonal frequency division multiplexing (OFDM) is known as one of the leading candidates for supporting broadband and multimedia services in the future wireless systems [15]. OFDM transmission is well-known for its high spectrum efficiency and robust performance over heavily impaired wireless links. OFDM has already been adopted in 802.11a, 802.11g, and 802.16 standards and is now considered as one of the main air interfaces for fourthgeneration (4G) wireless systems [15]. The advantages of OFDM technique are, but not limited to:  It is spectrally efficient because the subcarriers are very dense.  It provides a good tool to combat the frequency-selectivity of the wireless channel.

6

 It is easy to implement with the help of fast-fourier-transform (FFT).  The OFDM-based multiple access technique provides a good tool for various levels of QoS by assigning different number of subcarriers to different users Subcarrier and transmit power are two crucial parameters in an OFDM system that can be allocated dynamically to the users to increase the efficiency of the system.

Subcarriers
When there are multiple users sharing the same wireless media, independent fading experienced by the users can be exploited to achieve additional capacity gain. This is typically referred to as multi-user diversity gain. Multi-user diversity was first explored in [27] to increase the system throughput in the uplink of a cellular system. In OFDM systems, subcarriers in deep fade for a given user may not be faded for other users. Dynamically allocating the subcarriers to users according to their channel conditions ensures that each subcarrier is allocated to the user with high channel gains, hence effectively improving spectrum utilization. It is quite unlikely for a subcarrier to be in deep fade for all the users in the system. Dynamic subcarrier allocation (DSA) takes advantage of this fact and assigns subcarriers to the users based on the instantaneous subcarrier gains.

Transmit Power
Adaptive power allocation (APA) allocates power levels on the respective subcarriers so that the data rate is maximized subject to the constraint on the total transmit power. The solution of this problem can be found using the Lagrange multiplier technique [28], even though the problem is combinatorial or non-convex. According to the solution, more power is allocated when the channel gain is high and vice versa. This algorithmic solution is popularly known as water-filling [29]. The joint DSA and APA determines the subcarrier and power allocation to all the users in the system. In principle, allocating different power levels 7

to individual subcarriers should improve the performance. However, previous studies [30] have shown that performance improvements are marginal over a wide range of signal-to-noise ratios (SNRs) for a system without relays.

1.3

Research Focus and Motivation

Relaying techniques are integrated with OFDM based wireless systems to improve the system performance by taking advantage of both techniques. To fully exploit the benefits of relaying in an OFDM system, efficient management of resources, such as subcarriers and power, is required. Relaying systems should manage their spectral resources in order to maximize their performance metrics such as throughput and fairness in the system. The relay station parameters play a major role in the resource allocation to the active users in the OFDM relaying system. The difficulty in the optimization is the non-convexity of the objective function in the resource optimization problem. Many resource allocation schemes have been proposed in the literature for non-cooperative OFDM systems to realize the multiuser diversity [31]. In general, two major categories of resource allocation problems are proposed in the literature for non-cooperative systems according to the objective function of the optimization problem [32]:  Maximizing the data rate for a given power budget (rate adaptive maximization)  Minimizing the total transmit power for a given data rate (power margin minimization) In [33], subcarrier, bit, and power allocation were jointly optimized to minimize the total transmit power (margin adaptive) under the constraints of each users minimal data rate. This work was followed by numerous research investigations of how to appropriately formulate the optimization problem for various communications scenarios, how to balance the overall system performance and QoS constraints and, how to implement the algorithms in real-time. Max-Min subcarrier allocation algorithm was proposed to ensure fairness among

8

the non-cooperative users with sacrificing the throughput [34]. It was shown in [35] that by following a two-step greedy subcarrier allocation and then water-filling power allocation, the system achieves its maximum throughput (rate adaptive). This two-step procedure greatly reduces the complexity of the resource allocation problem in the system and we also resort to two-step procedure. Due to the importance of relaying techniques in OFDM systems, researchers have recently focused on the subcarrier and power allocation strategies specifically for OFDM relaying systems [36]. A system with a single base station communicating with multiple users over orthogonal channels with multiple relays was considered in [37]. The optimization problem was formulated for a multi-user decode-and-forward (DF) relaying system and a heuristic algorithm was proposed to find a suboptimal relay assignment and power allocation over each relay transmit power. A resource allocation scheme for multiuser relaying systems with selective relaying was investigated in [38]. Selective relaying is a technique through which the source adaptively chooses to relay on certain subcarriers depending on the potential gains [39]. A heuristic solution was proposed in [38] composed of three steps. The first step was to sub-optimally allocate the subcarriers to different users based on proportional rate fairness. The next step was a two-step iterative approach to find relay decisions and power allocation at the source during the first phase and at the relay during the second phase. The last step is a water-filling algorithm to allocate power at the source during the second phase to all non-relaying subcarriers. Subcarrier allocation was considered in [40] to maximize the sum-rate in the downlink of a decode-and-forward (DF) OFDM relaying systems with a total power constraint. Three heuristic algorithms were proposed and it was shown that the OFDM relaying systems with the proposed algorithms outperform the OFDM system without relays. The optimum power allocation for a multi-hop relaying system with different number of hops was investigated for DF relays in [40]. Another subcarrier and relay allocation algorithm was proposed in [41] to satisfy the minimum rate of the users in an OFDM relaying system. Relay stations were assigned to

9

mobile stations and subcarriers were allocated to mobile stations to satisfy the minimum rate requirements in either non-cooperative mode (i.e., direct communication with the base station) or in cooperative mode with one of the available relay stations. Simulation results showed that the presented algorithm achieved a near optimal resource allocation. The margin-adaptive bit and power loading problem was investigated for a system with an amplify-and-forward relay in [42]. Simulation results have shown that the proposed approaches in [42] could improve the power efficiency of the system. A comprehensive centralized radio resource management algorithm for the downlink of an OFDM cellular system with fixed relays was discussed in [43]. In their proposed algorithm, factors such as the opportunities in frequency, spatial, and diversities irrespective of the geographical relay deployment, were exploited, and a fairness-aware joint routing and scheduling algorithm was proposed.

Criticisms of Existing Work
The proposed solutions for resource allocation in the non-cooperative OFDM systems may not be suitable for the OFDM relaying system and may not provide the desirable level of throughput and fairness in an OFDM relaying system. Furthermore, no solution has been proposed so far to achieve a specific level of fairness when absolute fairness is not required in the system. Most of the proposed algorithm for the multi-user relaying system are yet heuristic and hard to implement as well. Moreover, they do not take advantage of the pre-existing solutions already proposed for non-cooperative multi-user systems.

Motivation for Current Work
In this dissertation, we formulate the problem of subcarrier and power allocation in the downlink of an OFDM-based multi-user relaying system and introduce a new framework for cooperative subcarrier allocation. We introduce "cooperation coefficient" as a parameter that quantifies the cooperation between mobile station and relay station, and propose to 10

apply this parameter for modifying the objective value in any non-cooperative subcarrier allocation algorithm. There are non-real-time applications that do not require instantaneous fairness. We formulate the problem of asymptotically fair subcarrier allocation and propose a solution that provides flexible fairness in the system. We will consider a unified relaying system model with homogenous mobile stations and propose our two-step subcarrier and power allocation algorithms based on the cooperation coefficient and the asymptotically fair subcarrier allocation.

1.4

Research Contributions

This dissertation, 1. first proposes a two-step asymptotically fair subcarrier allocation scheme as a tool to balance throughput and fairness in the non-cooperative OFDM system, 2. then derives closed-form expressions for unified performance comparison with optimum relay locations and different allocated power ratio, 3. derives closed-form expressions for the optimum power distribution ratio in an amplifyand-forward relaying system based on three different objective functions, 4. introduces cooperation coefficient as a parameter to quantify the level of cooperation in the relaying system and proposes a two-step subcarrier and power allocation algorithm in the downlink of a multi-user OFDM relaying system to optimally allocate resources. Figure 1.1 shows the inter-relationship between different chapters of this thesis. In this dissertation, we improve the throughput of the subcarrier and power allocation algorithms in the downlink of an amplify-and-forward OFDM relaying system with flexibility in fairness and simplicity in implementation.

11

OFDM System Model (Ch. 2)

Non-cooperative Subcarrier Allocation (Ch. 3)

Cooperation Techniques (Ch. 4)

Asymptotically Fair Subcarrier Allocation (Ch. 3)

Cooperative Subcarrier Allocation (Ch. 6)

Optimal Power Allocation for AF Relaying (Ch. 5)

Cooperative Subcarrier and Power Allocation (Ch. 6)

Figure 1.1: Inter-relationship diagram between the chapters.

1.5

Thesis Outline

The remainder of this dissertation is organized as follows. In the next chapter, we present a brief overview of the OFDM system and the main characteristics of the wireless fading channel, and present the general relaying system model considered in this thesis. The benchmark non-cooperative subcarrier allocation algorithms, such as throughput-oriented, fairness-oriented and asymptotically fair algorithms are reviewed in Chapter 3. In Chapter 4, we review the different relaying schemes and compare their performance in terms of average SNR, capacity, average BER and probability of outage. We then present the problem of power allocation in a single-user AF relaying system in Chapter 5. The closed-form expressions are derived for different objective functions, namely, average SNR, average BER and outage probability. The optimum power distribution ratio are compared for these different objective functions and different relay locations. In Chapter 6, we introduce the concept of

12

cooperation coefficient for an AF relaying and analyze its properties. We formulate the problem of resource allocation in an AF relaying system and heuristically solve it by a two-step subcarrier and power allocation procedure by using the concept of cooperation coefficient. Finally, we conclude the dissertation in Chapter 7 and present some directions for the future work. The inter-relationship between different chapters of this dissertation is illustrated in Figure 1.1.

13

Chapter 2 OFDM Wireless Systems: Basic Concepts and General Model
The emerging wireless transmission technologies such as WiMAX [15] has increased the data rate and range of wireless communications beyond the limits of the conventional technologies. To efficiently utilize the spectrum and overcome the deficiencies of wireless fading channels, orthogonal frequency division multiplexing (OFDM) has been introduced. OFDM technique mitigates the multipath fading and the interference in the faded radio environment very effectively. It also provides a robust and flexible tool for dynamic resource allocation in the wireless system. Due to these reasons, we adopt OFDM as the medium access scheme in this thesis. In this chapter, we briefly review the characteristics of wireless channel and the challenges in the design of wireless communication systems. Then, we present an overall review of multiple access schemes and explain how OFDM can improve the performance of a wireless system. We explain the OFDM system model more explicitly next and discuss how it can be incorporated into dynamic resource allocation. The chapter ends with the discussion of our relay-based communication system model which is the core of this thesis work.

14

2.1

Wireless Fading Channel

Transmission over wireless channel poses large attenuation and random variation in the received signal. We characterize these attenuation and variation in this section. Signal attenuation is mainly caused by path-loss due to the dissipation of the radiated power in the propagation channel. Path-loss models generally assume that it is a function of transmitterreceiver distance. Shadowing is caused by large obstacles between the transmitter and receiver that attenuate the signal power through absorbtion, reflection, scattering and diffraction. Shadowing causes slow variations in the received signal with respect to signal duration and is sometimes referred to as "slow fading" in the literature. Path-loss and shadowing are also known as "large-scale fading" in the modeling of a wireless channel [12]. Multipath fading, also known as "small-scale fading", is caused by constructive and destructive addition of different multi-path components of the signal introduced by the wireless channel. This causes time-varying reception of the signal at the receiver. Multipath fading causes frequency selective fading and inter-symbol interference (ISI). Frequency selectivity of the channel results from destructive interference of the transmitted signal and causes deep fading in some frequency components of the received signal. Time dispersion of the received symbol causes interference to the next received symbol and results in ISI at the receiver. The traditional technique to combat ISI is to use equalizers at the receiver. Doppler effect occurs as a result of relative motion of transmitter and receiver. It causes frequency dispersion of the original signal over a larger frequency band. In this thesis, we need to model the wireless channel for analyzing the performance of the proposed resource allocation algorithms. Hence, we present the mathematical model of the radio channel in the next section that will be used in the simulation and analysis of the proposed resource allocation algorithms in the later chapters.

15

2.2

Mathematical Model of Radio Channel

We model the wireless communication channel as a linear time variant system as done in [12]. By considering multipath fading and the Doppler effect, the wireless impulse response is time-variant and is written as:
-1  =1 (2 + )

( , ) =

()

( -

( )),

(2.1)

 ( )

1

2

Np

a1

;

a2

;

aNp

;


Figure 2.1: Multipath channel model. where (.), , , and

h(t,  )

(.) refer to the complex-valued amplitude, Doppler frequency,

phase constant, number of multipaths, and delay profile for path respectively. The equation for ( , ) in (2.1) can be interpreted as a tapped delay line as shown in Figure 2.1. In practice, the number of taps can be very large. Therefore, only those taps with a delay greater than the inverse of the input signal bandwidth are considered. Fading characteristics depend on delay spread, coherence bandwidth and Doppler spread. We explain these characteristics and their effects on frequency selectivity and ISI as follows.

Delay Spread
Delay spread shows how much the delay terms in (2.1) are spread over time. To define this parameter, we use the time invariant model of the channel. The channel time-invariant impulse response is a simplified version of time-variant channel impulse response in (2.1) 16

without the time index. It can be written as:
-1  =0

( ) =

( -

)

(2.2)

The mean of the channel delay, ¯, is defined as 
-1 =0   -1 =1 

¯=

2

2

(2.3)

To quantify the amount of delay spread in the wireless channel, we use the root mean square (RMS) of the channel delay as follows: 
-1 =0

=

RMS of the delay spread represents the weighted variance of the delay spread proportional to the energy of the received signal. The symbol duration of the received signal, be much larger than to prevent ISI at the receiver. , should



-1 =0

 (

 2

- ¯ ) 2

(2.4)

Coherence Bandwidth
Coherence bandwidth, , is a parameter that quantifies the frequency dispersion of the
1

wireless channel. The minimum frequency difference between

and

2

required for the

channel response to be uncorrelated is called coherence bandwidth of the channel. The frequency autocorrelation function of the wireless channel can be written as:


( ) =

{ ( , 0)

( -  , 0)},

(2.5)

where (.) denotes the complex conjugate. tion. The coherence bandwidth,

( , ) is the time-variant channel transfer func-

, is the spectral width over which  ( ) is zero outside . Frequency selective fading can be assumed flat 17

of it. To avoid distortion of signal at the receiver, the signal bandwidth should be smaller than the channel coherence bandwidth,

fading over a bandwidth less than be inversely related; i.e., 
1

. Coherence bandwidth and delay spread are known to [44].

Doppler Spread
Doppler spread or frequency dispersion, , quantifies the time-varying nature of the wireless

channel and results in time-selectivity of the wireless channel. Doppler spread causes the received signal to be spread in the frequency domain. The time autocorrelation function of the wireless channel is written as:


( ) =

{ (0, )

(0, -  )}.

(2.6)

The coherence time,

, is the minimum time duration for which

( ) can be assumed

zero. If the signal duration is greater than

the channel would change during the trans-

mission. Coherence time and Doppler spread are related by: 1

 where

,

(2.7)

is the maximum Doppler spread. If the bandwidth of the signal is larger than

the effect of Doppler spread is negligible.

2.3

Multiple Access Techniques

Multiple users require access to the wireless resources in the system without interfering with one another. Therefore, multiple access protocols are introduced for communication in wireless multi-user systems to satisfy each user's quality of service (QoS) requirements. In this section, we briefly review the most popular multiple access schemes.

18

Frequency Division Multiple Access (FDMA)
FDMA divides the radio resource into non-overlappping frequency bands. These frequency bands are exclusively allocated to users in an FDMA system. The main issue in the FDMA systems is the design of sharp filters at the receiver to cancel the interference caused by adjacent channels. FDMA was used in the first generation (1G) of cellular mobile communication systems such as AMPS and DECT standards. The main advantages and disadvantages of FDMA can be listed as follows [44]: Advantages:  The amount of ISI is low and no equalization is required.  System complexity and overhead is low. Disadvantages:  Costly bandpass filters are required to minimize adjacent channel interference.  Duplexers are needed for transmission and reception.

Time Division Multiple Access (TDMA)
TDMA divides the radio resource into non-overlapped time slots. These time slots are exclusively allocated to users in a TDMA system. TDMA was used in the second generation (2G) of cellular mobile communication systems such as GSM and IS-95. The main advantages and disadvantages of TDMA can be listed as follows [44]: Advantages:  Duplexers are not required since users use different time slots for transmission and reception.  Battery can last longer since the transmissions are not time-continuous. Disadvantages: 19

 Adaptive equalization is required at the receiver.  High time synchronization is needed at the transmitter and receiver.

Code Division Multiple Access (CDMA)
Users share the total radio resource in frequency and time in CDMA systems. CDMA employs spread-spectrum technology which assigns distinct codes to different users. The code is a pseudo-noise (PN) sequence with near-zero cross correlation. The signal sequence is spread over a large bandwidth and appears noise-like for the non-intended users. CDMA is used in second and third generation (3G) cellular mobile communication system such as IS-95 and WCDMA. The main advantages and disadvantages of CDMA can be listed as follows [44]: Advantages:  Multipath fading is substantially reduced since the signal spread over a large bandwidth.  There is a soft capacity limit in the system as the quality of service degrades as the number of users increases. Disadvantages:  Interference is very high in the system due ot the nature of CDMA scheme.  Accurate power allocation scheme is required and the near-far problem occurs due to high power transmissions.

Orthogonal Frequency Division Multiple Access (OFDMA)
OFDMA divides the radio resource into overlapped orthogonal frequency bands by using OFDM technology. The orthogonal frequency bands are exclusively allocated to users. The

20

data signal of each user is divided into several parallel data streams and modulated over multiple subcarriers assigned to that user in an OFDMA system. OFDMA is widely used in third and fourth generation (4G) cellular mobile communication systems such as WiMAX and LTE. The main advantages and disadvantages of OFDMA can be listed as follows [44]: Advantages:  The equalization is simpler and spectrum is exploited more efficiently.  It can be easily implemented by inverse fast Fourier transform (IFFT) and fast Fourier transform (FFT).  ISI is easily removed by employing guard intervals. Disadvantages:  Linear transmitter is required due to high peak-to-average power ratio.  Frequency synchronization is required due to high sensitivity to Doppler spread. OFDMA is the main focus of this thesis. In the next section, we concentrate more on OFDM systems and explain the characteristics of OFDM system.

2.4

OFDM System

OFDM is one of the most promising multi-carrier transmission schemes in wireless communication systems. This is mainly due to its resistance to frequency selective fading, high data rates and high spectral efficiency [32]. Multi-carrier OFDM technology was introduced in 60's for the first time [45]. The proposed concept was a fairly simple concept; but took some time to be implemented in modern communication systems. The major challenge in implementation of OFDM concept was the requirement of a large number of sinusoidal generators at the receiver and a large number of filters at the receiver. This challenge was resolved by using IFFT and FFT at the transmitter and receiver respectively which paved the way for 21

deployment of the OFDM concept. The main idea of OFDM is to split a wide-band signal into several orthogonal narrow-band signals. For this purpose, a high data-rate data stream is divided into parallel low-rate data stream, , = 1, 2, ..., , as illustrated in Figure

2.2. The narrow-band signals are modulated by orthogonal subcarriers using IFFT. A guard interval greater than the delay spread is added between the OFDM symbols to eliminate ISI. A cyclic copy of OFDM symbol is inserted in the guard interval. OFDM symbols are modulated by a carrier of higher frequency after passing through the parallel to serial convertor. The reverse action is taken place to regenerate the high-rate data stream at the receiver.

OFDM Transmitter
Input Data Signal Serial to Parallel Adding Cyclic Prefix Parallel to Serial Carrier Modulation

IFFT

Wireless Channel
Output Data Signal Parallel to Serial Removing Cyclic Prefix Serial to Parallel Carrier Demodulatio

FFT

OFDM Receiver
Figure 2.2: OFDM transceiver system model.

Physical Layer in OFDM
Large number of low-rate data and narrow-band subcarriers increase the robustness of the OFDM system to combat ISI and frequency selective fading. It also provides immunity against impulsive noise. The subcarrier bandwidth is very small; therefore, the fading process can be assumed flat over each subcarrier. OFDM symbol length becomes much larger than the delay spread which results in the elimination of ISI from the system and removes the need for an equalizer at the receiver. Orthogonality of subcarriers allows the subcarriers to 22

overlap, and hence provides a more efficient spectrum utilization compared to FDMA. We review the baseband model of OFDM signal here. The digital signal is first modulated into , = 0, 1, ..., - 1, symbols (QAM or PSK). Symbol is carried by the 'th

subcarrier. The subcarriers

symbols are summed to generate the OFDM baseband signal ( ). The
-1

0 , 1 , ...,

overlap in the frequency domain. However, the orthogonality of

the subcarriers ensures that the symbols can be separated at the receiver. The time-domain representation of the baseband OFDM signal ( ) can be written as:
-1  =0

()=

2

,

0 < ,

(2.8)

where

is the OFDM symbol duration, and it is

times the original symbol duration, <

.

The discrete version of the OFDM signal over 0  (2.8) at time instances = . as:
-1  =0
2

is obtained by sampling ( ) in

( )=

,

= 0, 1, ...,

-1

(2.9)

According to (2.9), samples of the OFDM signal, ( ), are related to the original symbols through the inverse discrete fourier transform (IDFT). ( )'s can be easily calculated using IFFT.

Medium Access Control (MAC) Layer in OFDM
The original motive of OFDM scheme was to combat frequency selectivity of the radio channel when all the subcarriers were assigned to one user at a time. As discussed earlier, OFDM can be used as a multi-user access technique where each subcarrier can be allocated to different users at different times. OFDMA is shown to be a superior access technology compared to TDMA and CDMA in the literature [46]. The fine granularity of resources for OFDMA increases the flexibility and efficiency of OFDMA compared to other schemes.

23

Dynamic subcarrier allocation (DSA) provides diversity gain in the system. A subcarrier that is in deep fade for one user may have a high gain for another user. Allocating the subcarriers to the users with higher subcarrier gains improves the total rate of the system. To guarantee QoS for all the users in the system, a scheduler at the MAC level is required in the system to manage subcarrier allocation among the users in the system.

Subcarrier Gain

...
Subcarrier Number

User 1 User 2 . . .

User K

Multiuser Subcarrier and Power Allocation

Adaptive Modulation and Coding

OFDM Transmitter

OFDM Receiver

Figure 2.3: OFDM PHY/MAC layer system model.

Adaptive modulation and coding is another technique that allows different modulation and coding scheme based on the received SNR (assigned subcarrier gain). Less number of bits and higher order of coding are assigned to low-gain subcarriers. The main objective of adaptive modulation and coding is to compensate for the variations of wireless fading channel. This can either improve the bit error rate (BER) or efficiency of the radio channel. The transmitter needs a good estimate of the channel to be able to implement the adaptive modulation and coding. The data rate reduction caused by using adaptive modulation and coding in the system is modeled by the SNR gap, which is defined as the difference between 24

the SNR needed to achieve a data rate for a practical system and the theoretical SNR [47]. Figure 2.3 illustrates the PHY/MAC layer issues of an OFDM system. The subcarrier gains of the users are retrieved at the receiver by inserting the known pilot signals intermittently in the original OFDM signal at the transmitter. After subcarriers are all assigned to the users according to the subcarrier allocation algorithm, the adaptive coding and modulation scheme is chosen according to the QoS requirements of the user. The effective transmission rate of the user can be calculated by knowing the coding rate and modulation order.

2.5

General OFDM-based Relaying System Model

In this thesis, we consider the downlink of a single-cell OFDM-based relaying system. Figure 2.4 illustrates this general multi-user relaying system model used.

Mobile Station

Relay Station

Base Station

Figure 2.4: Multi-user relaying system model.

25

The major elements in this model are: Base station (BS), relaying station (RS) and mobile station (MS). Compared to the traditional multi-user system, relay stations are the new system components. The major functionality of RS in the downlink is to transmit a copy of the received signal from BS to MS by following the relaying protocol. RS's are assumed to be pre-assigned to MS's. All the MS's are assumed to be experiencing similar channel statistics. All the RS's are also assumed to be experiencing similar channel statistics as well. Therefore, we have considered the homogenous MS's and RS's in the system and left the heterogenous case as the future work of this dissertation. The data rate reduction according to adaptive modulation and coding is not considered in our calculation of the users' data rate, and we assume the Shannon capacity equation as for the data rate of the users on each subcarrier. WiMAX standard uses multiples of 1.25MHz as for the total bandwidth of the system. We use WiMAX channel parameter to model the characteristics of the wireless channel. We assume a frequency selective channel model with bandwidth of frequency of 10 = 30Hz. The coherence bandwidth is = 1.25MHz and Doppler =

= 100kHz which implies

. The OFDM channel is composed of

= 256 subcarriers. Therefore, the bandwidth

of each subcarrier is less than the coherence bandwidth of the channel, and the fading process over each subcarrier can be assumed flat. We assume an interference-free channel with AWGN noise. The BS-MS subcarrier is assumed to be normalized, and the path loss exponent is three in all our simulation and analysis. All other subcarrier gains are normalized according to BS-MS subcarrier. The main focus of this thesis is subcarrier and power allocation for the illustrated system model with flexibility in fairness. The problem formulation and the solution are addressed in the following chapters.

26

2.6

Chapter Summary

The main characteristics of wireless channel were reviewed in this chapter. Delay spread, coherence bandwidth and Doppler spread are important characteristics of wireless fading channel that play a major role in modeling the wireless channel. Medium access techniques were also reviewed and their main advantages and disadvantages were mentioned. OFDM was shown as an appropriate physical layer technique to combat frequency selectivity of the wireless channel which provides an appropriate framework for dynamic resource allocation in the OFDMA system. Dynamic subcarrier allocation enhances the performance of the OFDM system by taking advantage of the frequency-selectivity of the channel. We also presented our general multi-user relaying system model used in this thesis. We will adopt a TDMA-based OFDM relaying protocol and consider the subcarrier and power allocation problem with flexibility in fairness for such system model in the following chapters.

27

Chapter 3 Non-Cooperative Subcarrier Allocation Techniques
Wireless spectral resources are normally assigned statically and shared by multiple users suffering from time-varying multi-path fading. The inflexibility of this architecture leads to inefficient usage of resources in wireless systems. Channel-aware scheduling strategies [48] have been proposed to adaptively transmit and dynamically assign wireless resources based on the channel state information (CSI). The key idea is to choose a user in good channel condition for transmission over a frequency band. Benefiting from the independent channel variations across the users, channel-aware scheduling can substantially improve the performance through multi-user diversity. Multi-user diversity was first explored in [27] to increase the system throughput for the uplink of a cellular system. Efficiency of resource utilization can be improved significantly by implementing techniques that exploit the independence of fading processes for multiple users in the system. OFDM is one of the promising multi-carrier technologies that divides the wide-band channel into multiple narrow-band subcarriers [49]. Multi-carrier systems realize the multiuser diversity more efficiently compared to the single-carrier systems [26]. In an OFDMA system, subcarriers can be assigned dynamically among multiple users to improve the overall

28

performance of the system [50]. Multiple users in an OFDM system experience mutually independent attenuations on their subcarriers. Some users may experience deep fades on a number of subcarriers, while some others may have a strong gain on the same subcarriers. If deep-faded subcarriers are allocated to a user, due to fixed multiple-access schemes such as time division multiple access (TDMA) or frequency division multiple access (FDMA), these subcarriers will not be efficiently utilized in the system. Dynamic resource allocation algorithms are categorized in the literature from different perspectives. Considering the goal of the optimization problem in subcarrier allocation, algorithms are classified into two groups: "margin adaptive" [33, 51] and "rate adaptive" [34, 52­57]. The main objective in margin adaptive algorithms is to minimize the total transmit power of the system while maintaining each user with its required quality of service requirements; such as data rate and BER. The main objective in rate adaptive algorithms is to maximize the total system throughput with the constraint on the total transmit power. The formulated optimization problem to allocate subcarriers and power to the users is very complex to solve. Sub-optimal algorithms have been generally proposed to reduce the complexity of the subcarrier allocation algorithms. It was proved in [35] that allocating the subcarriers to the users with the highest gain, and then allocating the total power to the subcarriers according to water-filling [29], maximizes the total throughput of the system. Therefore, a two-step resource allocation procedure was generally considered in the OFDM systems [35]. The subcarriers are allocated to the users according to their subcarrier gains in the first step. In the second step, the power is allocated to the subcarriers (users). Allocating the subcarriers to the high-subcarrier-gain users imposes unfairness on the lowsubcarrier-gain users. To resolve this problem, fairness among the users should be considered in subcarrier allocation procedure. The instantaneous throughput-fairness trade-off can be modeled by introduction of "user satisfaction" concept [52]. Since it is unlikely to fully satisfy different demands of all the users, we can define a function called "utility function" and maximize the average utility sum of the system in order to maximize the overall user

29

satisfaction in the network instantaneously [58]. Maximizing the total throughput of the system according to the total transmit power and other system constraints; i.e., rate adaptive problem, is one of the design challenges in wireless communication systems. Therefore, we adopt the rate adaptive problem in this chapter (and throughout this thesis) and investigate the relevant issues. There are mainly two classes of rate adaptive algorithms in the literature: throughput-oriented and fairness-oriented. The throughput-oriented subcarrier allocation algorithms maximize the instantaneous throughput of the system. Throughput-oriented algorithms sacrifice the fairness in the system to optimize the throughput. In contrary to throughput-oriented algorithms, fairness-oriented algorithms maximize the instantaneous fairness among the users in the system. In this chapter, we introduce a new rate adaptive subcarrier allocation algorithm that maintains a trade-off between throughput and fairness in the system. We apply a group-based approach to balance the achieved level of fairness in the system. In the first step, the subcarriers are allocated to each group using a fairness-oriented algorithm [34]. In the second step, the subcarriers are allocated to the users in each group using a throughput-oriented algorithm [35]. The proposed technique is called "asymptotically fair" subcarrier allocation algorithm. The non-real-time applications that do not require instantaneous constant data rates can benefit from the proposed asymptotically fair algorithm. We will modify this algorithm for the multi-user cooperative and relaying system in Chapter 6. In the following sections, the non-cooperative multi-user system model is reviewed and the design parameters are explained. The throughput-oriented and fairness-oriented subcarrier allocation algorithms are reviewed next. We introduce the asymptotically fair subcarrier allocation algorithm and end the chapter with simulation results and conclusion.

30

3.1

Subcarrier Allocation: System Model and Parameters

The problem of subcarrier allocation in a non-cooperative multi-user OFDM system is formulated here. A single-cell OFDM system with users is considered. There are subcarriers }. .

in the system to be allocated. The set of all subcarriers is denoted by The total bandwidth of the system is

= {1, 2, ...,

; therefore, each subcarrier has bandwidth of

The wireless channel is modeled as described in Chapter 2. Additive white Gaussian noise (AWGN) is present with single-sided noise power spectral density (PSD) level of subcarriers and all users. Flat Power Allocation Dynamic subcarrier allocation provides the opportunity to allocate the high-gain subcarriers to the users; therefore, the total power is only consumed for the high-gain subcarriers. It was shown in [59] that for a single-user OFDM system, the total rate is very close to its maximum when the power is allocated only to the high-gain subcarriers. It was later suggested in [34] to assume a flat power allocation among the subcarriers to reduce the complexity of resource allocation problem. It was also shown in [35] that the throughput of the system degrades negligibly by flat power allocation compared to water-filling approach [29] when high-gain subcarriers are allocated to the users in the system. Multi-user diversity provides the possibility of allocating only the high-gain subcarriers to the users in the system, hence decreasing the variance of the allocated subcarrier gains. Water-filling approach pours more power into high-gain subcarriers and allocates no power to the low-gain subcarriers [12]. If all the allocated subcarriers are high-gain and have almost the same level, the optimum power allocation (water-filling) solution would be very close to the flat power allocation. This leads to comparable performance between optimum and flat power allocation. Unless stated otherwise, we assume a flat power allocation throughout this
0

for all

31

thesis. User Data Rate The subcarrier allocation matrix, C = [ allocated to which user.
, ,

]

×

, specifies which subcarrier(s) should be is allocated to user ; otherwise
,

= 1, if and only if subcarrier

it is zero. None of the users shares subcarrier, so in case

= 1 then

,

= 0 for all = .

The total transmit power at the base station is assumed to be and is equally divided between all the th user, , is given by: = where
,

over the whole bandwidth

subcarriers. In such a system, the data rate for the


=1

,

is the SNR of the th subcarrier for the th user and is given by: 
0 ,

( log2 1 +

,

)

,

(3.1)

,

=

2

,

(3.2)

and 

,

is the gain for user

and subcarrier

and

is the transmit power of user

on

subcarrier . Equation (3.1) provides the error-free data rate of the wireless channel; however the achieved data rate in practical systems is less than what is suggested by Shannon theory in (3.1). The difference between the SNR needed to achieve a data rate for a practical system and the theoretical SNR is called SNR gap. The SNR gap, , was studied for MQAM in [47]. It was shown that for a target BER of , the SNR gap, , can be calculated as: - ln(5 ) , 1 .5

=

(3.3)

and consequently the data rate according to this data rate is calculated as: 
=1

=

,

log2 1 +

(

,



)

.

(3.4)

SNR gap can be considered as a constant factor that degrades the performance of the 32

system. In this thesis, we assume a zero-gap system and do not consider the effect of the SNR gap in the calculation of the users' data rates. The total data rate of the system, is simply the summation over the data rate of all the users and is calculated by: 
=1 =1

,

=

,

( log2 1 +

,

) ,

(3.5)

Fairness Index Fairness can be defined in terms of different parameters of the system. It can be defined in terms of bandwidth, where each user is assigned an equal number of subcarriers [60] or it can be defined in terms of power where each user is allocated equal portion of the power from the power budget. It is very common to define the fairness in terms of data rates, where the objective is to allocate the resources to the users such that the users achieve the same data rate. In this thesis, we define the fairness index in terms of the data rates. Assuming equal data rate requirements among the users, the fairness index, terms of the instantaneous data rate, , as [34, 56]: ( )2 is defined in the literature in

=

=1 =1 (

is a real number in the interval [ 1 , 1] with the maximum value of one when equal data rate is achieved for all the users, and minimum value of whole bandwidth and takes over all the subcarriers. Delayed Fairness Index We define the "delayed fairness index" for evaluation of the proposed subcarrier allocation scheme. Non-real-time users do not require instantaneous fairness and can wait for a few OFDM symbols. Therefore, it is convenient to consider the summation over consecutive
1



)2

.

(3.6)

when one user dominates the

33

OFDM symbols in the definition of fairness index. We define the delayed fairness index as: ( )2

=

=1 =1 (

where

is the summation of

over

consecutive OFDM symbols. The defined delayed



)2

,

(3.7)

fairness index describes the fairness of the subcarrier allocation algorithm over the past consecutive OFDM symbols. We will use the average of the delayed fairness index, [ ],

as a parameter in the proposed asymptotically fair subcarrier allocation algorithm. The average of delayed fairness index, [ ], is taken over time (OFDM channel realizations).

3.2

Throughput-Oriented Subcarrier Allocation

The throughput-oriented subcarrier allocation problem in a multi-user OFDM system is formulated as follows [35]: ( log2 1 + 
0 ,

max
,


=1 =1

,

2

)

,

(3.8)

subject to: C1 : C2 :
,

 {0 , 1 },
=1 ,

 , 



= 1,

Constraints C1 and C2 guarantee that the subcarriers are not shared by the users and once a subcarrier is assigned to a user it will not be allocated to another user. Flat power allocation is assumed over all the subcarriers; therefore, the total power, over the , is divided equally

subcarriers. Based on the theorem proved in [35], the data rate of a multi-user

OFDM system is maximized when each subcarrier is assigned to only one user that has the best channel gain for that subcarrier. The results indicate that a flat transmit PSD would 34

hardly reduce the total data rate of a multi-user OFDM system provided that the proper subcarrier allocation is applied. The main goal in throughput-oriented subcarrier allocation is to maximize the total data rate of multi-user OFDM system without considering the fairness. Throughput-oriented algorithm is sometimes referred to as greedy algorithm. The summary of the greedy subcarrier allocation algorithm is as follows [35]:

 Initialization , = 0,  , = 0,  = {1, 2, ..., },

 Subcarrier Allocation ­ for = 1 to find satisfying 
,

,

   ,    {1, 2, ..., ).

}

= 1, = + log2 (1 +
,

­ end  End

3.3

Fairness-Oriented Subcarrier Allocation

The fairness-oriented subcarrier allocation problem in a multi-user OFDM system is formulated as follows [34]: max min
,


=1

,

( log2 1 +


0

,

2

) ,

(3.9)

35

subject to: C1 : C2 :
,

 {0 , 1 },
=1 ,

 , 

Constraints C1 and C2 guarantee that subcarrier sharing by the users and is not permitted in the system. Flat power allocation is assumed over all the subcarriers; therefore, the total power, , is divided equally over the subcarriers. Fairness-oriented algorithm



= 1,

maximizes the fairness among the users in the system by maximizing the data rate of the minimum-rate user in each step of subcarrier allocation. In the first step, one subcarrier is allocated to each user where the channel gain is the highest for that user. In the next step, the user with the lowest data rate is prioritized for subcarrier allocation. The procedure continues until all the subcarriers are allocated. Because the algorithm tries to maximize the data rates of the users with the minimum data rate in each step, it is also referred to as Max-Min subcarrier allocation algorithm. Max-Min subcarrier allocation algorithm can be summarized as [34]:

 Initialization , = 0,  , = 0, 
,

=

log2 (1 + },

,

),  ,

= {1, 2, ...,

 Subcarrier Allocation ­ for = 1 to (a) find satisfying  ­ end
,

,



,



= 1, with

=

(b) update

-{ }  = =1 36

,

,

­ while

(a) find

= 

satisfying



;

 = 1, 2, ..., (b) for the found , find n satisfying
,


,

,

 with

 = -{ }  = =1



= 1,

(c) update ­ end  End

,

,

3.4

Asymptotically Fair Subcarrier Allocation

Thus far, we reviewed algorithms that maximize two important metrics in subcarrier allocation; i.e., throughput and fairness. Throughput and fairness are however conflicting performance metrics. To maximize the throughput, system will allocate more subcarriers to the user with higher subcarrier gain which may cause radio resource monopolization by a small number of users, leading to unfairness. On the other hand, to maintain the fairness, the system will have to allocate more resources to the users in worse channel conditions and; as a result, the system throughput will degrade accordingly. As stated earlier, the ultimate goal in throughput-oriented algorithms is to achieve the largest possible throughput. In fairness-oriented algorithms, the main objective is to maintain the fairness among the users. The trade-off between throughput and fairness has been recently re-visited in the literature. An adaptive fair scheduling scheme was proposed in [61] to increase the total throughput of the system by sacrificing the fairness. A hybrid scheduling scheme was proposed in [62] for a TDMA-based system. The users were proposed to be grouped so that the channel could

37

be allocated to one user of each group at a time. The grouping procedure was proposed to be done based on the users's distance from the base station. Here, we propose a two-step grouping-based subcarrier allocation procedure to maintain this trade-off in the OFDM system. The question that arises is "would it be possible to design a subcarrier allocation algorithm that reaches a certain level of fairness in the system?". The proposed algorithm provides the possibility of mixing the throughput-oriented algorithm with the fairness-oriented algorithm. We can formulate the problem of asymptotically fair subcarrier allocation algorithm as: 
=1 =1

max
,

,

log2 1 +

(


0

,

2

) ,

(3.10)

subject to: C1 : C2 : C3 :
,

 {0 , 1 },
=1 ,

 , 

 [

= 1,

]=

All the constraints are similar to the fairness-oriented except for C3 that enforces a specific average delayed fairness,  (0, 1), in the system. Flat power allocation is assumed over all , is divided equally over the subcarriers.

the subcarriers; therefore, the total power,

We propose a technique to reach the required level of average delayed fairness in the system. An interesting point which has not received enough attention is whether throughputoriented subcarrier allocation algorithms are asymptotically fair or their delayed fairness index converges to unity for large values of . That is, in a known radio environment, how long (in terms of symbol duration) the users would have to wait to achieve a certain degree of delayed fairness. The idea of waiting users to achieve fairness is not considered in the utility function approach [50]. To maintain a trade-off between throughput and fairness in the system, we propose the idea of grouping the users here. It is assumed that a grouping algorithm has grouped all the users into equal-sized groups with 38 users in each group.

Obviously,

should be divisible by ; and therefore,

=

× . It should be noted

that the users are not cooperating within each group and the purpose of grouping is for implementation of the proposed algorithm. Here, we assume that all the users are in similar average channel condition (distance); therefore, the grouping strategy would not have any effect on the obtained results. By grouping the users in the system, we can divide the subcarrier allocation procedure into two steps: subcarrier allocation to the groups, and then subcarrier allocation within each group. In the first step, subcarriers are allocated to the groups. In the second step, subcarriers are allocated to the users of each group. To derive the solution, we introduce the group allocation matrix, D = [
,

]

×

. The group allocation matrix determines which

subcarrier is assigned to which group of users in the system. The problem of resource allocation in such a grouped multi-user OFDM system with the elements of two matrices: D = [ subcarrier
,

subcarriers is to determine ]
×

]

×

and C = [

, ,

.

,

= 1, if and only if

is allocated to group ; otherwise, it is zero.

= 1, if and only if subcarrier

is allocated to user ; otherwise, it is zero. None of the users shares subcarrier, so in case
,

= 1 then

,

= 0 for all = . Figure 3.1 illustrates the two-step subcarrier allocation.

3.4.1

Subcarrier Allocation to Groups

The first step is to allocate the subcarriers to each group. The fairness-oriented algorithm is chosen for group allocation part of the proposed algorithm. The objective value in subcarrier allocation to groups is the total data rate of each group. Hypothetically the allocated subcarrier is equally shared by all the users of that group. The group-subcarrier-allocation is as follows:

 Initialization

39

Subcarrier Gain

...
Subcarrier Number

Group 1 Group 2 . . .

Group G

Subcarrier Allocation to the Groups

Subcarrier Allocation to Users (Group 1) . . . Subcarrier Allocation to Users (Group 2)

Subcarrier Allocation to Users (Group G)

Figure 3.1: Two-step asymptotically fair subcarrier allocation.

,

= 0,  , = 0,  =
,

,

obj

=

= {1, 2, ...,

log2 (1 +  }

,

),  ,
,

=( -1) +1

, 

 Group Subcarrier Allocation ­ for = 1 to (a) find  ­ end ­ while = 
,

satisfying obj ,  obj , = 1, = with -{ }  =



 obj ,

(b) update

=1

,

40

(a) find

satisfying



;

 = 1, 2, ..., (b) for the found , find n satisfying obj ,  obj , 
,

 =

 -{ }  = obj ,

= 1,

(c) update ­ end  End

with

=1

,

3.4.2

Subcarrier Allocation to Users

After group subcarrier allocation is performed, the user allocation is done independently for each group based on the obtained group allocation matrix, D. The subcarrier allocated to a group is allocated to the user that has the highest channel gain for that subcarrier. The user-subcarrier-allocation procedure is as follows:

 Initialization , = 0,  , = 0, 
,

=

log2 (1 + },

,

),  ,

= {1, 2, ...,

 User Subcarrier Allocation ­ for = 1 to

41

(a)

=  satisfying
, ,

(b) find  ­ end  End

 = 

,



that

,

=1

=1 with
=1 , ,

(c) update

The average fairness constraint,

[

] = , can be later used as a parameter for choosing = 1 and = 1 the asymptotically fair

the proper grouping size. As a special case, if

algorithm turns into the fairness-oriented and throughput oriented algorithms respectively.

3.5

Performance Evaluation: Throughput and Fairness

We compare the performance of the asymptotically fair algorithm with throughput-oriented and fairness-oriented algorithms in terms of average fairness and throughput. Asymptotically fair algorithm is shown to outperform the fairness-oriented algorithm in terms of throughput. It also outperforms the throughput-oriented algorithm in terms of the average fairness. Overall, the asymptotically fair algorithm provides a flexible tool in subcarrier allocation to make a balance between throughput and fairness in the system.

3.5.1

Simulation Parameters

The OFDM channel is modeled as frequency selective with six independent multipaths and exponential delay profile. It is assumed that the total bandwidth, into = 1.25MHz is divided

= 256 subcarriers. The average SNR for all subcarriers is assumed to be 20dB. Total

of 10, 000 channel realizations are used and the results are averaged. Simulations are run for system with 6 and 12 users and the results are presented here. In the asymptotically

42

fair subcarrier allocation algorithm, the group sizes are assumed to be divisible by the total number of users. Therefore, we assume users. = 2, 3 for = 6 users and = 2, 3, 4, 6 for = 12

3.5.2

Simulation Results
=

The simulation results for a multi-group system are shown in Figures 3.2 to 3.5 for

6 and 12 respectively. According to Figures 3.3 and 3.5, when the number of users in the group increases the average total throughput approaches the total throughput of the throughput-oriented algorithm. On the other hand, according to Figures 3.2 and 3.4, by decreasing the number of users in a group, the average delayed fairness of the system approaches the average delayed fairness of the fairness-oriented algorithm. The user subcarrier allocation is throughput-oriented, therefore by increasing the number of users in each group (larger group sizes), the asymptotically fair algorithm tends to behave similar to the throughputoriented algorithm. On the other hand, the group subcarrier allocation is fairness-oriented (smaller group sizes). By decreasing the number of users in each group, the asymptotically fair algorithm tends to behave similar to the fairness-oriented algorithm. As observed in Figures 3.2 and 3.4, increasing the number of users in the groups results in a slower convergence of the average fairness index to the maximum fairness index. This can be explained by the probability theory. The throughput-oriented algorithm assigns subcarriers to the users based on the highest subcarrier gain in the group. Assuming that all the groups have users with similar probability density function (pdf) conditions, it gets less probable that a certain user in the system attains the highest-subcarrier status in the system. Therefore, it practically takes more time for all the users in the group to be assigned subcarriers, and the realization of a higher fairness in the system requires more waiting time for the users. For instance, to reach an average fairness of 0.9, the system has to wait OFDM symbols for = 2, 3, 4, and 6 respectively for 43 = 5, 10, 15, and 25

= 12. The waiting time is

1
E[F ]=0.9
v

0.9

0.8
Average Fairness, E[Fv]

0.7

0.6
v=5 v=10 v=25

0.5

0.4 Fairness-oriented Algorithm Asymptotically Fair Algorithm, I=2 Asymptotically Fair Algorithm, I=3 Throughput-oriented Algorithm 5 10 15 Number of OFDM Symbols 20 25 30

0.3

Figure 3.2: Average fairness versus number of OFDM symbols,

= 6.

8.4 8.2 8 7.8 7.6 7.4 7.2 7 6.8 6.6 6.4 Throughput-oriented Algorithm Asymptotically Fair Algorithm, I=3 Asymptotically Fair Algorithm, I=2 Fairness-oriented Algorithm

Total Throughput (bps per Hz)

5

10

15 Number of OFDM Symbols

20

25

30

Figure 3.3: Total throughput versus number of OFDM symbols,

= 6.

44

1
E[Fv]=0.9

0.9 0.8
Average Fairness, E[Fv]

0.7 0.6 0.5
v=5 v=10 v=15 v=25

0.4 0.3 0.2 0.1

Fairness-Oriented Algorithm Asymptotically Fair Algorithm, I=2 Asymptotically Fair Algorithm, I=3 Asymptotically Fair Algorithm, I=4 Asymptotically Fair Algorithm, I=6 Throughput-oriented Algorithm 5 10 15 Number of OFDM Symbols 20 25 30

Figure 3.4: Average fairness versus number of OFDM symbols,

= 12.

8.4 Throughput-oriented Algorithm Asymptotically Fair Algorithm, I=6 Asymptotically Fair Algorithm, I=4 Asymptotically Fair Algorithm, I=3 Asymptotically Fair Algorithm, I=2 Fairness-oriented Algorithm

8.2

8
Total Throughput (bps per Hz)

7.8

7.6

7.4

7.2

7

6.8

6.6

5

10

15 Number of OFDM Symbols

20

25

30

Figure 3.5: Total throughput versus number of OFDM symbols,

= 12.

45

= 5, and 10 OFDM symbols for

= 2, and 3 respectively for

= 6. For a higher

number of users in the group, the waiting time would be more. According to the required average fairness index and the allowable waiting time in the system, it is possible to find the suitable group size in the system. For instance, for a system with = 12 and = 0.9 and

allowable waiting time of 20 OFDM symbols, it is preferable to choose

= 4, according to

Figure 3.4. For higher average fairness index and smaller waiting time, it is better to have smaller group size. The maximum fairness is achieved when = 1 or when no grouping is

done in the system. For lower fairness index and higher waiting time, it is reasonable to have larger group sizes in the system. The proposed approach sacrifices the fairness partially to increase the total throughput of the system.

3.6

Analysis of the Proposed Algorithm

The proposed subcarrier allocation algorithm allocates the subcarriers in two steps: groupallocation and user-allocation. Group-allocation is performed to maintain the fairness among total data rate of different groups. This is achieved by using Max-Min subcarrier allocation algorithm. In the user-allocation step, the subcarriers are allocated to the users within the group using the greedy algorithm to maximize the throughput of each group. Our proposed subcarrier allocation fills the gap between the fairness-oriented and throughput-oriented algorithms and provides a balanced solution for subcarrier allocation in the system. Figure 3.6 shows how the asymptotically fair algorithm provides a balanced approach to maintain throughput and fairness in the system. Assuming Max-Min and greedy algorithm as two extreme cases, asymptotically fair algorithm can be more fair or more efficient according to the group size. How small or large the groups should be, depends on the required level of fairness in the system. In other words, the proposed algorithm provides a better fairness index for small group sizes and is more efficient for large group sizes. There are some cases that it may not be possible to divide all the users into equal size

46

Maximum Fairness

Larger Group Size

Maximum Throughput

Max-Min Subcarrier Allocation
Fairness

Asymptotically Fair Subcarrier Allocation
Smaller Group Size

Greedy Subcarrier Allocation
Efficiency

Figure 3.6: Fairness vs. throughput in asymptotically fair subcarrier allocation.

groups, e.g., when

= 13. We propose to group the users into equal sized groups as much = 13, we divide them into six groups with = 2 users

as possible. For instance, when

plus one single user. Since group sizes are unequal ( = 1, 2), the subcarrier allocation to the groups is performed based on proportionally fair subcarrier allocation in [56] with This approach can be followed for other similar scenarios of unequal group sizes. How the grouping of the users should be done in the system is another interesting subject worthy of more exploration. Here, we assumed homogenous users where all the users experience similar fading characteristics, and therefore assumed that groups are randomly formed. However, in a practical system each user undergoes different fading process depending mainly on the location of the user with respect to base station. As the proposed algorithm has two steps, it is not clear what should be chosen as for the grouping policy. Is it better to group weak users with strong users? or grouping similar users results in a better performance? This is an open question that should be addressed. One quick solution might be to normalize all the channel gains with the average channel gain of each user to harmonize all the users in the system, and then perform the grouping. Another possibility is grouping the weak user with the strong user. This approach forces us to use the fairness-oriented algorithm for allocating the subcarriers within each group and use the throughput-oriented = 1, 2.

47

algorithm for allocating the subcarriers to the groups of users. Investigation of these different approaches and any other possible solution are left as the future work of this thesis.

Practical Scenario
In this section, we discuss possibility of adjusting the level of fairness in the system by using the proposed asymptotically fair subcarrier allocation algorithm. According to the required fairness index in the system and the maximum allowable waiting time, it is possible to find the proper grouping size in the proposed two-step subcarrier allocation. The proposed algorithm can adaptively increase fairness or efficiency of the algorithm by changing the group size. Here, we introduce a practical scenario for applying the proposed asymptotically fair algorithm. Let's assume that the system requires a delayed fairness index of for the last OFDM

symbols. We initialize the subcarrier allocation algorithm by using the fairness-oriented algorithm for the first symbols. After these symbols, the system reaches  1. At

this stage, asymptotically fair algorithm can start allocating the subcarriers. The two-step procedure starts with the smallest group size continuously over the last = 2 and watches for the delayed fairness index

symbols. If the delayed fairness index goes over the required

level , a larger group size will be chosen. If the delayed fairness index goes below the required fairness level , a smaller group size will be chosen. The process adaptively changes the group size to achieve the required level of fairness in the system with the possibility to increase the throughput compared to the the absolutely fair algorithm.

3.7

Chapter Summary

In this chapter, we reviewed some of the important subcarrier allocation algorithms proposed in the literature for non-cooperative OFDM systems. The subcarrier allocation algorithms were classified as throughput-oriented and fairness-oriented. While throughput-oriented sub48

carrier allocation maximizes the throughput, fairness-oriented subcarrier allocation prioritizes the fairness in the system. The main contribution of this chapter is the introduction of the asymptotically fair subcarrier allocation. We proposed the asymptotically fair subcarrier allocation as a third class of subcarrier allocation algorithm besides throughput-oriented and fairness-oriented algorithms. The asymptotically fair algorithm was shown to maintain a trade-off between throughput and fairness in the system by grouping the users in the system. In the first step, subcarriers were allocated to the groups of users by using the fairness-oriented algorithm. In the second step, subcarriers were allocated to the users within each group by using the throughput-oriented algorithm. According to the allowable waiting time of the users, the group size can be determined to maintain a certain level of fairness index in the system. By controlling the fairness degradation, the proposed asymptotically fair algorithm increases the throughput of the system. Non-real-time applications do not require instantaneous fairness among the users and can wait for a few OFDM symbols to achieve an acceptable level of fairness in the system. The proposed algorithm can be specifically suitable for these applications and increase the total throughput of the system compared to the fairness-oriented algorithm. We presented the simulation results for a harmonized network where all the users were experiencing similar channel parameters and average channel condition. It is possible to further consider a system with users in weak and strong channel conditions and investigate how the grouping strategy might affect the total performance of the system. These three discussed algorithms in this chapter will be used as a benchmark to evaluate the performance of subcarrier allocation algorithms for a cooperative OFDM system in the following chapters.

49

Chapter 4 Cooperative Relaying Techniques
Different relaying protocols and techniques have been proposed in the literature [22] to increase the diversity order, capacity and bandwidth efficiency of wireless systems. In this chapter, we study a single-relay wireless system as the building block of our general cooperative OFDM system model. We explain the different relaying schemes that exist in the literature and classify them into three main categories based on the functionality of the relay: amplify-and-forward (AF) relaying, decode-and-forward (DF) relaying, and estimateand-forward (EF) relaying. We compare the performance of these different relaying schemes in terms of average SNR, average capacity, outage probability, and average BER. The comparison is done for three different power ratio allocated to the source and the relay. In the following, we explain the characteristics of these schemes in detail and study their performance in terms of average SNR, average BER, average capacity and outage probability. The chapter ends with a summary.

4.1

Single-Relay System Model

The traditional relaying system model is a network consisting of a source ( ), a relay ( ) and a destination ( ) which is the primary building block of any larger relaying system and is illustrated in Figure 4.1. 50

 , 

S
 , 
  , 

D

R
Figure 4.1: The relaying system model.

The destination receives the signal via two independent paths:

-

path and

- -

path where the former is referred to as the direct link and the latter is referred to as the relaying link. The relay works in a half-duplex mode; i.e., it cannot transmit and receive on the same channel simultaneously. We assume independent Rayleigh fading for the channel ( ) ( ) gains in our system model. Therefore, we assume   0, 2 ,  0 , 2 and ( )   0, 2 . (., .) represents the complex Gaussian random variable with the first = 3 and the effect of log-normal shadowing is neglected in our analysis. - , - and - channel gains in Figure

parameter as the mean and the second parameter as the variance. The path loss exponent is assumed to be

The instantaneous and average SNR of 4.1 are defined and as:  2
0 2

=

,

=

 2
0 2

,

=

2
0 2

(4.1)

¯ =
0

,

¯ =
0

,

¯=
0

,

(4.2) denotes the indirect

where

0

is the variance of AWGN for all the noise terms. Subscript

channel and subscript defined SNR's in (4.1),

represents the relaying channel in (4.1) and (4.2) respectively. The , and , are scaled versions of the square of the channel gains,

 2 ,  2 and 2 respectively. The probability density function (pdf) of these SNR's is

51

exponential [63] and can be written as:     1 exp(- ), ¯ ¯    0,     1 exp(- ), ¯ ¯    0, 0 < 0.



( )=

0 < 0.



( )=

0 < 0.

(4.3)

(

)=

    1 exp(- ), ¯ ¯   0,

(4.4)

The pdf of the channel gains in (4.3) and (4.4) is used in the next sections to evaluate the performance of different relaying schemes.

4.2

Relaying Techniques

TDMA-based relaying protocol is the most common and simplest form of protocol among the relaying protocols in the literature. This protocol is the most-employed protocol in practical systems such as IEEE 802.16j standard [11]. Hence, we consider a TDMA-based transmission relaying protocol for cooperation among terminals in our relaying system model. Table 4.1: TDMA transmission protocol for the relaying system. timeslot 1 timeslot 2 S transmits R listens transmits D listens listens

As described in Table 4.1, the source broadcasts its signal to the relay and destination in the first timeslot. The relay terminal receives a copy of the signal, processes the received signal according to the relaying technique and forwards it to the destination in the second timeslot. Three different relaying techniques have been proposed in the literature: amplify-and-forward (AF), decode-and-forward (DF) and estimate-and-forward (EF). In the following, we discuss the details of these relaying techniques. 52

4.2.1

AF Relaying

Amplify-and-forward (AF) relay, also known as analog repeater, is a low complexity relay. This relaying technique was initially used as the line-repeater for long-distance wired communications. In AF relaying scheme, the relay terminal is transparent to modulation and coding of the communication protocol. We refer to the amplify-and-forward relay terminal as AF relay throughout this thesis. In the first timeslot, the source broadcasts its unit-energy signal,
0,

to AF relay and the destination. The received signals at the relay and destination

are as follows: = = where and   
0

+ , + ,

(4.5) (4.6)



0

are the received signal from the source at the destination and the relay and are the AWGN noise at the destination and the relay respectively. is the symbol period. The AF relay normalizes the signal

respectively.

is the source transmit power, and

received in the first timeslot, amplifies and re-transmits it to the destination in the second timeslot. The relay has access to the variance of - channel, 2 , and normalizes the  received signal from the source by the factor of { 2 } defined in (4.8). The normalized signal is then transmitted to the destination in the second phase with power signal from the AF relay, , at the destination can be written as:  . The received

=

 

{ 2 }
2

+

,

(4.7)

{ 2 } = where



+

0,

(4.8) { 2 } is the

is the additive noise at the destination from the relaying branch.

average energy of the received signal at the relay in the first timeslot and is given as in (4.8). The destination combines both signals received from the source and the relay by using a maximal ratio combiner (MRC). In some literature [23, 64­67], it is assumed that 53

the backward channel ( -

instantaneous normalization and assume that the AF relay normalizes the received signal from the source using { 2 } as in (4.8).

channel) is available at the relay and the AF relay normalizes   2 + 0 . In this thesis, we do not consider the received signal from the source using

4.2.2

DF Relaying

Known also as digital relaying, DF relaying is a technique that requires more processing time and hardware at the relay. DF relay decodes the received signal from the relay and performs error-correction on the decoded signal, if required. The relay then re-transmits the correctly decoded signal to the destination. The received signal at the source and the relay is similar to the AF relaying case in the first timeslot and is described similarly as in (4.5) and (4.6) respectively. The received signal from the DF relay at the destination terminal can be written as:

=





0

+

.

(4.9)

The MRC combiner at the destination combines the received signal from the source and the destination. The decoding process at the relay can be done differently. Some literature [68] have assumed that the DF relay is only capable of detecting the errors. The relay intelligently stops the transmission in case any error is detected at the relay. In this case, the received signal at the DF relay can be written as:     

=



0

+

, if no error occurs at the relay if error occurs at the relay

(4.10)

where the MRC combiner at the destination does not know if the relay has decoded the signal correctly; therefore, it adds up noise when the signal is decoded incorrectly at the relay. It should be noted that the error-detection is equivalent to error-correction for the 54

   ,

case of binary signalling. In this thesis, we assume error-correction at the DF relay when referring to the DF relay and use (4.9) for the received signal at the destination from the DF relay.

4.2.3

EF Relaying

Unlike the DF relay, estimate-and-forward (EF) relay, a digital relay, does not run any error-correction (or error-detection) after it decodes the signal. EF relay blindly transmits the error-containing version of the signal, ^0 to the destination [69]. EF relay requires less hardware and complexity compared to DF relay. The received signal from the relay at the destination terminal in EF relaying is given by: 

=

 ^0 +

.

(4.11)

A diversity combining method was proposed in [69] and further analyzed in [70, 71] based on the maximum likelihood (ML) detection theory. Figure 4.2 illustrates this combination scheme where
0

and

1

are the decision parameters and depend on the modulation scheme.

y

t0 g (.)
detector

yr

gr (.)

t1

f(.)

Figure 4.2: EF Relaying Combination Scheme.

( ) in Figure 4.2 is a non-linear function and is given by: (1 - ¯ , ) exp( ) + ¯ , ( ) = ln ¯ ¯,) , exp( ) + (1 - 55 [ ]

(4.12)

where ¯ , is the average BER of the source-relay link. In the following sections, we compare the performance of these relaying schemes in terms of average SNR, average BER and outage probability.

4.3

Performance of Different Relaying Schemes

By using the pdf of the SNR's, we evaluate the performance of the relaying system model in terms of average SNR, average capacity, average BER and outage probability. In the following, we compare the performance of the different relaying schemes for two different cases. In the first case, (a) it is assumed that all the terminals are located on a normalized equilateral triangle, and the total transmit power is the variable. In the second case, (b) the total power is fixed and the relay is moving from the source towards the destination on the line connecting the source to the destination. The two cases are shown in Figure 4.3 and 4.4 respectively.

S

D

R
Figure 4.3: The relaying system model, case (a).

The system total transmit power, the relay in three different ratio: ( )

, is assumed to be divided between the source and =3 ,( ) = , and ( )3 = . Examining

different power ratio to the source and the relay helps us to compare the performance of different relaying schemes more effectively.

56

S

R

D

Figure 4.4: The relaying system model, case (b).

4.3.1

Average SNR

The average SNR of the relaying schemes are compared. For the EF relaying, the SNR at the destination terminal contains error of the - channel; therefore, the average SNR at

the destination for the EF relaying is not a good parameter to evaluate the performance of the system and we do not consider it here. In the following, the average SNR of the AF relaying and DF relaying are discussed. Average SNR for AF relaying As mentioned earlier, relay has access to the variance of - channel,
2 2

, and normalizes

the received signal from the source by the factor of { 2 } = as: =   
0

+

0.

We can rewrite (4.7)

2

+

0

+~ ,

(4.13)

where the effective noise term, ~ , is Gaussian and its variance is
2 ~

=

0

(

1+

(

 2 2 +

0

))

.

(4.14)

The destination terminal combines both signals from the source and the relay by using a maximal ratio combiner. For this combiner, the total SNR at the output of the combiner is the summation of the SNR's from the diversity branches [3]. The instantaneous SNR of the direct link, , is given as in (4.1). The instantaneous SNR of the relaying link is calculated

57

as: =
0

(

 2  2 . 2 + 0 +  2 ) , can be written as:  2  2
0

(4.15)

The instantaneous SNR in AF relaying,
2

=
0

 +

0

0

2
0

+

 2 + 1

=

+

¯ +

+1

.

(4.16)

By taking the average over ,   and  , the average SNR at the destination, ¯ calculated as: ¯ = [ ]= [
0

is

2 +

0

2
0

+

 2  2 0

 2 + 1 0

]

.

(4.17)

Due to the independence between ,   and  , the expectation can be taken over each channel gain separately as: [ [ [ 2 +  2  2 0 ]]]

¯

=



 



0

0

2
0

+

 2 + 1 0

.

(4.18)

Integration over the pdf's of 2 ,  2 and then  2 results in the expression for the average SNR as:  2 + 1 ( ) ( ) ¯ (¯ + 1) ¯ +1 ¯ +1 =¯+¯ - exp , 1 ¯ ¯ ¯
0

¯

=¯+

 , 

[

0

0

2

+

 2  2
0

]

(4.19)

where ¯ =

2 0

and

1(

) is the exponential integral function and is defined as: 
 -

1(

)=

.

(4.20)

Average SNR for DF relaying The instantaneous SNR of the DF relaying scheme at the destination terminal is the summation of the received SNR's from the direct and the relaying links and can be written

58

as: = The average SNR, ¯ 2
0

+

 2
0

=

+

.

(4.21)

, is calculated by taking the average over all the channel gains: [ 2
0

¯

=

+

 2
0

]

=

[

2

2

+
0 0

]

=¯+¯ .

(4.22)

Average SNR Comparison The average SNR of AF and DF relaying schemes is plotted in Figures 4.5-4.7 and 4.8-4.10 by using equations (4.19) and (4.22) respectively. In all of our results in this section, we assume a normalized noise variance of
0

=1

. In Figures 4.8-4.10, the average SNR's . It is assumed

of the two schemes are compared as a function of total transmit power, that

is divided between the transmitting nodes; source and relay, according to the three
2

power ratio mentioned earlier. The channel variances are normalized as

=

2

=

2

= 1.

This implies that the terminals are located equi-distant from each other (case (a)).

30 DF Relaying, Ps=3Pr=0.75 AF Relaying, Ps=3Pr=0.75 25

Average SNR at Destination [dB]

20

15

10

5

0 5

10

15 20 Total Transmit Power [dBm]

25

30

Figure 4.5: Average SNR comparison for AF and DF relaying as a function of

,

=3

.

59

DF Relaying, P =P =0.5 30
r s

AF Relaying, Pr=Ps=0.5

25
Average SNR at Destination [dB]

20

15

10

5

0 5

10

15 20 Total Transmit Power, Pt [dBm]

25

30

Figure 4.6: Average SNR comparison for AF and DF relaying as a function of

,

=

.

Figures 4.5-4.7 show that the average SNR of DF relaying is slightly higher than AF relaying when the terminals are located equi-distant from each other. The additive noise at the relay results in a lower average SNR at the destination terminal for the AF relaying compared to DF relaying. According to (4.22), average SNR for DF relaying is a linear function of ¯ and ¯ . Considering the equal power allocation, = =
2

, the average . For AF

SNR for DF relaying becomes a linear function of the total transmit power, relaying, the average SNR can similarly be written as a function of

. The argument of

exponential integral and exponential function in (4.19) becomes a constant value for equal power allocation. Therefore, the average SNR for AF relaying behaves linearly with the total transmit power, . Another interesting point to notice is that the different in the average

SNR between DF and AF relaying increases as a higher portion power is allocated the relay. The average SNR for DF relaying is not a function of total transmit power. The average SNR for AF relaying degrades as a higher portion of power is allocated to the relay. This can be explained by amplification of noise at the relay. 60

30 DF Relaying, Pr=3Ps=0.75 AF Relaying, Pr=3Ps=0.75 25

Average SNR at Destination [dB]

20

15

10

5

0 5

10

15 20 Total Transmit Power [dBm]

25

30

Figure 4.7: Average SNR comparison for AF and DF relaying as a function of

,

=3

.

In Figures 4.8-4.10, we compare the average SNR of the AF relaying with DF relaying as a function of the relay location (case (b)). The relay is located and total power unit away from the source

= 20dBm is divided between the source and the relay according to the - channel

three power ratio mentioned earlier. Assuming a normalized variance for the
2

= 1, we have

2

=

-3

,

2

= (1 - )-3 (path loss exponent is 3).

As illustrated in Figures 4.8-4.10, the average SNR for the AF relaying is maximized at different points for different relay locations. The average SNR for DF relaying increases steadily as the relay gets closer to the destination. The average SNR for DF relaying is higher than that of AF relaying and this difference is even larger when the relay is located closer to the destination. It is evident that due to the additive noise at the relay, average SNR for AF relaying is less than average SNR for DF relaying. As the relay gets closer to the destination, the - channel gets stronger and results in a higher average SNR for DF

relaying. Due to the amplification of AWGN noise at the relay in AF relaying, the average SNR does not follow the same increasing pattern of DF relaying. 61

26 DF Relaying, Ps=3Pr=0.75 AF Relaying, Ps=3Pr=0.75 24

22
Average SNR at Destination [dB]

20

18

16

14

12

10 0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source, di

0.7

0.8

Figure 4.8: Average SNR comparison for AF and DF relaying as a function of 20dBm, =3 .

,

=

40 DF Relaying, Ps=Pr=0.5 38 36
Average SNR at Destination [dB]

AF Relaying, Ps=Pr=0.5

34 32 30 28 26 24 22 20 0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source, di

0.7

0.8

Figure 4.9: Average SNR comparison for AF and DF relaying as a function of 20dBm, = .

,

=

62

30 DF Relaying, Pr=3Ps=0.75 AF Relaying, Pr=3Ps=0.75

25
Average SNR at Destination [dB]

20

15

10

5 0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source, di

0.7

0.8

Figure 4.10: Average SNR comparison for AF and DF relaying as a function of 20dBm, =3 .

,

=

4.3.2

Average Capacity

The maximum error-free data rate of a communication channel is defined as its Shannon capacity limit [3]. Shannon proved that the capacity of a communication channel with bandwidth and SNR of is log2 (1 + ) for AWGN channel. We consider this formula

for the data rate of the relaying schemes. Due to the reason mentioned earlier, we do not consider the EF relaying case here. The maximum error-free data rates of AF and DF relaying schemes at the destination terminal are calculated as follows: ( log2 1 + = ) ,

=

2

+

¯ + +

+1 ) .

(4.23)

2

( log2 1 +

(4.24)

The division by two in (4.23) and (4.24) is because the transmission protocol takes two timeslots for each symbol. 63

Average Capacity Comparison The average data rates of AF and DF relaying can be calculated by taking the average of (4.23) and (4.24)numerically. Figures 4.11-4.13 and 4.14-4.16 compare the average data rates of AF and DF relaying schemes respectively as a function of total transmit power, relative relay location, other (case (a)) and , and

respectively. The terminals are assumed equi-distant from each is divided between source and relay. For DF relaying, the effect of

additive noise at the relay is removed in the decoding process which results in a slightly higher average capacity compared to AF relaying.

5

DF Relaying, Ps=3Pr=0.75Pt
4.5

AF Relaying, Ps=3Pr=0.75Pt

Average Data Rate at Destination [bps per Hz]

4

3.5

3

2.5

2

1.5

1

0.5

5

10

15

20

25

30

Total Transmit Power [dBm]

Figure 4.11: Average capacity comparison for AF and DF relaying as a function of =3 .

,

In Figures 4.14-4.16, we compare the average capacity of AF and DF relaying when the relay is located on the line connecting the source to the destination terminal and from the source (case (b)). The total transmit power unit away

= 20dBm is divided source and

relay. The average data rate of DF relaying is higher than that of AF relaying for any relay location. The average capacity of DF relaying steadily increases as the relay gets closer to 64

5 DF Relaying, Ps=Pr=0.5Pt 4.5 AF Relaying, Ps=Pr=0.5Pt

Average Data Rate at Destination [bps per Hz]

4

3.5

3

2.5

2

1.5

1

0.5 5

10

15 20 Total Transmit Power, Pt [dB]

25

30

Figure 4.12: Average capacity comparison for AF and DF relaying as a function of = .

,

5 DF Relaying, Pr=3Ps=0.75Pt 4.5 4 3.5 3 2.5 2 1.5 1 0.5 0 5 AF Relaying, Pr=3Ps=0.75Pt

Average Data Rate at Destination [bps per Hz]

10

15 20 Total Transmit Power [dBm]

25

30

Figure 4.13: Average capacity comparison for AF and DF relaying as a function of =3 .

,

65

the destination. The behavior of the average capacity is very similar to the average SNR, because the capacity equation in (4.23) and (4.24) is logarithm of SNR which an increasing function of SNR.
5.5 DF Relaying, Ps=3Pr=0.75Pt AF Relaying,Ps=3Pr=0.75Pt

Average Data Rate at Destination [bps per Hz]

5

4.5

4

3.5

3 0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source, di

0.7

0.8

Figure 4.14: Average capacity comparison for AF and DF relaying as a function of = 20dBm, =3 .

,

The instantaneous capacity formula in (4.23) and (4.24) will be used in Chapter 6 for the computation of the total throughput of a cooperative relaying system.

4.3.3

Outage Probability
, is defined as the probability that the instantaneous SNR at
.

The probability of outage, the destination,

, goes below a certain threshold, at point

This probability is equivalent to the
.

cumulative distribution function (cdf) of

To obtain the outage probability at point


at the destination terminal, it suffices to calculate (or estimate) the cdf of

for any of the relaying schemes. There is no proper definition of SNR for EF relaying and therefore, we do not consider it here. 66

6 DF Relaying, Ps=Pr=0.5Pt AF Relaying, Ps=Pr=0.5Pt 5.5
Average Data Rate at Destination [bps per Hz]

5

4.5

4

3.5

3 0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source, di

0.7

0.8

Figure 4.15: Average capacity comparison for AF and DF relaying as a function of = 20dBm, = .

,

6.5 DF Relaying, Pr=3Ps=0.75Pt AF Relaying, Pr=3Ps=0.75Pt 6
Average Data Rate at Destination [bps per Hz]

5.5

5

4.5

4

3.5

3

2.5 0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source, di

0.7

0.8

Figure 4.16: Average capacity comparison for AF and DF relaying as a function of = 20dBm, =3 .

,

67

Outage Probability for AF Relaying The SNR at the destination terminal in AF relaying is given by (4.16) and can be written as the summation of the direct link SNR and the relaying link SNR. Direct link SNR is in fact , and as stated earlier can be modeled by an exponential random variable with parameter =
1 ¯

as in (4.3). The pdf of the indirect link SNR can be approximated by an exponential =
1 ¯

random variable with parameter

+

1 ¯

[72]. ,


Using the moment generating function approach, the pdf of the of be written as:


(

), can

(

)=

(

-

-

-

-

)

.

(4.25)

Therefore, the probability of outage for AF relaying is calculated as: 
1 ¯


[ = Prob

<



]

= +
1 ¯

 0

(

)

=
1 ¯ 1 ¯

- (

(
-

-



) -1 - -1 )

-

(

-



-1

)

=

1 ¯ 1 ¯

-

-

1 ¯

(

-

 ¯

) -1 -

1 ( ¯

1 +¯ )

1 ¯

-

-

1 ¯

(4.26)

Outage Probability for DF Relaying The SNR at the destination terminal for DF relaying is given by (4.21). Using the moment generating approach for pdf of the summation of two independent random variables, the probability of outage for DF relaying is derived as:
1 ¯¯

=

(

- 1 ¯

 ¯

-

-

-

 ¯

1 ¯

)

.

(4.27)

Outage Probability Comparison The outage probability of AF and DF relaying are compared in Figures 4.17-4.19 and Figures 4.20-4.22. In Figures 4.17-4.19, all the terminals are assumed to be equi-distant from each other and the total transmit power, , is divided between source and destination (case (a)).

68

The outage probability, equations in (4.26) and (4.27) are plotted as a function of

. As

expected, DF relaying experiences a lower outage probability. The decoding at the relay removes the destructive effect of AWGN noise at the relay and provides a higher SNR at the destination. In Figures 4.20-4.22, the relay is located units away from the source and on the line

connecting source to the destination (case (b)). Similar to the previous case and due to the same reason, the outage probability for DF relaying is lower than that of AF relaying. As the relay gets closer to the destination, higher SNR for -
10
0

-

channel becomes stronger which results in a

channel and a lower outage probability at the destination.

DF Relaying, Ps=3Pr=0.75 AF Relaying, Ps=3Pr=0.75
-1

10
Outage Probability at Destination

10

-2

10

-3

10

-4

10

-5

5

10

15 20 Total Transmit Power [dBm]

25

30

Figure 4.17: Outage probability comparison for AF and DF relaying as a function of =3 .

,

69

10

0

DF Relaying, Ps=Pr=0.5 AF Relaying, Ps=Pr=0.5
-1

10
Outage Probability at Destination

10

-2

10

-3

10

-4

10

-5

5

10

15 20 Total Transmit Power, Pt [dBm]

25

30

Figure 4.18: Outage probability comparison for AF and DF relaying as a function of = .

,

10

0

DF Relaying, Pr=3Ps=0.75 AF Relaying, Pr=3Ps=0.75
-1

10
Outage Probability at Destination

10

-2

10

-3

10

-4

10

-5

5

10

15 20 Total Transmit Power [dBm]

25

30

Figure 4.19: Outage probability comparison for AF and DF relaying as a function of =3 .

,

70

10

-2

DF Relaying, P =3P =0.75
s r

AF Relaying, Ps=3Pr=0.75

Outage Probability at Destination

10

-3

10

-4

10

-5

0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source, di

0.7

0.8

Figure 4.20: Outage probability comparison for AF and DF relaying as a function of = 20dBm, =3 .

,

10

-2

DF Relaying, Ps=Pr=0.5 AF Relaying, Ps=Pr=0.5

Outage Probability at Destination

10

-3

10

-4

10

-5

0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source, di

0.7

0.8

Figure 4.21: Outage probability comparison for AF and DF relaying as a function of = 20dBm, = .

,

71

10

-2

DF Relaying, Pr=3Ps=0.75 AF Relaying, Pr=3Ps=0.75

Outage Probability at Destination

10

-3

10

-4

10

-5

0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source, di

0.7

0.8

Figure 4.22: Outage probability comparison for AF and DF relaying as a function of = 20dBm, =3 .

,

4.3.4

Bit Error Rate

The instantaneous BER for non-coherent BFSK demodulation at the destination terminal is calculated by [3]: = where 1 2
-

,

(4.28)

is the instantaneous SNR at the destination. The instantaneous BER is averaged

over all the possible channel gains to obtain the average BER, ¯ , at the destination terminal. ¯ =

, ,  [

]

(4.29)

In the following, we discuss the average BER for different relaying schemes.

72

BER for AF Relaying The average BER at the destination terminal for AF relaying, ¯ the instantaneous SNR of AF relaying in (4.29): [ 1 2
-

, is derived by applying

¯

=

, ,  [

]=

, , 

(

+¯

+

+1

)]

.

(4.30)

From the independence of ,   and  , we can write: ¯ = [ [ [ 1 2
-

 

 



(

0

2 +

0 0

 2 2+ 0

 2 0  2 +1

) ]]]

.

(4.31)

Integrating over ,   and then  , would yield ¯ ¯ 0 .5 )( +1 (
2 0

as follows: (
0 2

=(

2 0

2 0

+1

) 1+ ¯

)
0

1

2

(

0 2

))

BER for DF Relaying

0 .5 )( ) 1+ =( ¯+1 ¯ +1

(

( )
1 ¯

1 1 ¯

¯

( ))

.

(4.32)

The average BER at the destination terminal for DF relaying, ¯ the instantaneous SNR of DF relaying in (4.29): ¯ [ 1 2 ( )] .

, is derived by applying

=

,  [

]=

, 

-

+

(4.33)

From the independence of  and  , we derive ¯ ¯ = [ [ 1 2
-

as follows:
 2

 



(

0

2 +

0

) ]]

.

(4.34)

73

Integrating over , and then   would yield ¯ ¯ =( 0 .5 )( +1

as follows:

2 0

2 0

+1

BER for EF Relaying

).

(4.35)

The average BER at the destination terminal for EF relaying, ¯

, is derived in [70] by

approximating (4.12) with a piecewise function. Assuming non-coherent BFSK, the average BER at the destination terminal is calculated as:

¯

= Pr{ 0 - >
1 0

1

< 0

0

= 0} × Pr{
1

1

< - 1
1

0

= 0} + Pr{ 0 +
0

1

< 0 
1

0

= 0}
1 0

×Pr{

1

= 0} + Pr{ 0 +

< 0 -

1





1,

= 0} × Pr{-

1



= 0}

(4.36) The closed-form derivation for the average BER of EF relaying is fully presented in [70] for noncoherent BFSK and in [71] for coherent BFSK. BER Comparison The average BER of AF, DF and EF relaying are compared in Figures 4.23-4.25 and Figures 4.26-4.28 for case (a) and case (b) as well as different power ratio. EF relaying performs slightly better than AF relaying, while DF relaying outperforms all the other schemes. The average BER of DF relaying tends to decrease steadily as the relay gets closer to the destination. For EF and AF relaying the minimum average BER occurs close to the midpoint of source and destination. The average BER for EF relaying approaches to average BER of DF relaying when relay is closer to the source, and it approaches to average BER of AF relaying when relay is closer to the destination. The clipping function, ( ) in (4.12) for EF relaying, passes almost all the signal received from the relay when the BER of the - channel is

74

10

0

AF Relaying, Ps=3Pr=0.75Pt EF Relaying, Ps=3Pr=0.75Pt DF Relaying, Ps=3Pr=0.75Pt 10
-1

Average BER at Destination

10

-2

10

-3

10

-4

10

-5

5

10

15 20 Total Transmit Power, Pt [dBm]

25

30

Figure 4.23: Average BER comparison for AF and DF relaying as a function of

,

=3

.

AF Relaying, Ps=Pr=0.5Pt EF Relaying, Ps=Pr=0.5Pt DF Relaying, Ps=Pr=0.5Pt 10
-1

Average BER at Destination

10

-2

10

-3

10

-4

10

-5

5

10

15 20 Total Transmit Power, Pt [dBm]

25

30

Figure 4.24: Average BER comparison for AF and DF relaying as a function of

,

=

.

75

10

0

AF Relaying, Pr=3Ps=0.75Pt EF Relaying, Pr=3Ps=0.75Pt DF Relaying, Pr=3Ps=0.75Pt 10
-1

Average BER at Destination

10

-2

10

-3

10

-4

10

-5

5

10

15 20 Total Transmit Power, Pt [dBm]

25

30

Figure 4.25: Average BER comparison for AF and DF relaying as a function of

,

=3

.

10

-2

AF Relaying, Ps=3Pr=0.75Pt EF Relaying, Ps=3Pr=0.75Pt DF Relaying,, Ps=3Pr=0.75Pt

Average BER at Destination

10

-3

10

-4

10

-5

0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source, di

0.7

0.8

Figure 4.26: Average BER comparison for AF and DF relaying as a function of 20dBm, =3 .

,

=

76

10

-2

AF Relaying, Ps=Pr=0.5Pt EF Relaying, Ps=Pr=0.5Pt DF Relaying, Ps=Pr=0.5Pt

Average BER at Destination

10

-3

10

-4

10

-5

0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source, di

0.7

0.8

Figure 4.27: Average BER comparison for AF and DF relaying as a function of 20dBm, = .

,

=

10

-1

AF Relaying, Pr=3Ps=0.75Pt EF Relaying, Pr=3Ps=0.75Pt DF Relaying, Pr=3Ps=0.75Pt
-2

10
Average BER at Destination

10

-3

10

-4

10

-5

0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source, di

0.7

0.8

Figure 4.28: Average BER comparison for AF and DF relaying as a function of 20dBm, =3 .

,

=

77

very close to zero, and this occurs when the relay is close to the source. This is the reason for why the performance of EF relaying approaches to the performance of DF relaying when the relay is close to the source.

4.4

Chapter Summary

We considered a single-relay cooperative system with a source and a destination. Different relaying schemes were reviewed according to the functionality of the relay. We classified the relaying schemes into three main groups: AF relaying, DF relaying and EF relaying. AF relay is the simplest form of relay where it amplifies the received signal from the source and forwards it to the destination. DF relay receives the signal from the source, decodes and transmits an error-free version of the decoded signal to the destination. EF relay, on the other hand, receives the signal from the source, decodes it and transmits an error-containing version of the signal to the destination. DF relaying is the most complex scheme among the other schemes and, requires decoding and error-correction at the relay which adds to the delay and power consumption at the relay. On the other hand, AF relaying is the simplest scheme among others and does not require much of complexity at the relay terminal. We analyzed and compared the performance of these relaying schemes in terms of average SNR, average capacity, outage probability and average BER. The derived equations showed that DF relaying has the highest, and AF relaying has the poorest performance among the other relaying schemes. These results indicate the direct relationship between the complexity and performance of different relaying schemes. We presented the results for three different power allocation to the source and the relay in this chapter. AF relaying is chosen as the relaying scheme later for the multi-user relaying system model in this dissertation for its simplicity and transparency of the relay in the relaying process. In the AF relaying, all the channel gains appear in the SNR expression at the destination which makes it easier for better analysis, while for DF and EF relaying, we lose

78

track of

-

link due to the decoding process at the destination. Table 4.2 summarizes unit from the source along = =
2

the comparison for AF relaying schemes for the relay placed

the line connecting the source to destination with equal power allocation (

).

Table 4.2: Performance comparison for different relaying techniques. AF relaying low maximum at  0.5 maximum at  0.55 minimum at  0.7 minimum at  0.55 DF relaying high maximum at  1 maximum at  1 minimum at  1 minimum at  1 EF relaying medium N/A N/A N/A minimum at  0.4

Complexity Average SNR Average capacity Outage probability Average BER

Table 4.3 summarizes the optimum relay location for AF relaying for the three different power ratio to achieve the optimum performance in the system. It is observed that the optimum relay location for the AF relay depends not only on the performance metric, but as well as Table 4.3: Optimum relay location for AF relaying scheme. =3 maximum at maximum at minimum at minimum at = maximum at maximum at minimum at minimum at =3 maximum at maximum at minimum at minimum at

Average SNR Average capacity Outage probability Average BER

 0.65  0 .7  0 .8  0.65

 0 .5  0.55  0 .7  0.55

 0.35  0 .4  0.55  0.45

Most of the research work in the literature such as [73, 74] is based on derivation of an estimate for the upper-bound of the performance metrics. The main contributions of this chapter can be summarized as:  Derivation of closed-form expressions for average SNR, average BER and outage probability for different relaying schemes

79

 Unified performance comparison with optimum relay location for different relaying schemes and three different power allocation ratio The problem of optimum power allocation to the source and relay is discussed for the AF relaying scheme in the next chapter.

80

Chapter 5 Power Allocation for AF Relaying Scheme
5.1 Introduction

Different relaying schemes were discussed in Chapter 4 and their performance were compared for three various power ratio to the source and the destination. In this chapter, we mainly focus on the power allocation problem to the source and the destination in such a relaying system model. Power optimization in a wireless system is a crucial problem for the wireless terminals that have limitation in size and transmit power. Based on how much channel state information (CSI) is available at the source and relay, power allocation schemes can be categorized in two main groups: closed-loop and open-loop. Closed-loop power allocation requires the instantaneous or partial CSI to be known at the transmitter side. An adaptive closed-loop power allocation scheme was proposed in [66] for a non-regenerative relaying system to increase the capacity of the system. The main drawback of close-loop schemes is that they require CSI feedback in the system. Open-loop power allocation schemes do not require the instantaneous CSI at the transmitter side and still work without it; however, they require some knowledge about the statistical

81

properties of the CSI at the transmitter side. An open-loop power allocation scheme was proposed in [75] to minimize the outage probability of non-regenerative and regenerative systems. Another power allocation scheme was proposed in [73] to maximize the average SNR at the destination for a single-relay system. It was shown there that the performance of the system improves compared to a system with equal power allocation. Based on the upper-bound of the pairwise error probability (PEP), the authors in [76] proposed to allocate half of the total power to the source, and the other half to the relays in a multiple-relay system where the relays are equidistant from source and destination. Based on the union upper-bound of PEP, an open-loop power allocation was proposed in [74]. AF relaying is selected as the relaying scheme for the multiuser relaying system in Chapter 6. In this chapter, we consider the single-relay system model discussed in Chapter 4 and study the power allocation problem for the AF relaying schemes. The question is "how to divide the total transmit power, among the source and the destination?". The question is

answered by optimizing three different objective functions: average SNR, average BER and outage probability. Using the Lagrangian multiplier method [28], we present a closed-form solution for optimization of these objective functions for each relaying scheme and study any possible discrepancies in the performance of AF relaying schemes. The main contribution of this chapter is a unified comparison of power allocation schemes based on the objective function of the optimization problem. The power ratio derivations presented in this chapter can be applied to any system with source-relay-destination triplet. We will apply some of these results in the power allocation step of cooperative subcarrier and power allocation in Chapter 6. Derivation of closed-form expressions for the average SNR, average BER and outage probability for AF relaying was earlier presented in Chapter 4. Here, we obtain the optimum closed-form expressions for the optimal power allocation of a single-relay system considering different objective function in optimization. The rest of this chapter is organized as follows. SNR-based power allocation is formulated and discussed and the results are presented. BER-

82

based and SNR-based optimal power allocation are investigated next and the chapter ends with a summary.

5.2

SNR-based Power Allocation

The SNR-based power allocation (PA) maximizes the average SNR at the destination terminal and allocates the total transmit power, problem is formulated as: [
¯ (¯ +1) ¯

, to the source and the destination. The

max
,

¯+¯ -

exp

(

¯ +1 ¯

)

1

(

¯ +1 ¯

)]

subject to: 0 0

+  

=

.

Note that we derived the average SNR in (4.19). We re-write the objective function of the above optimization problem as: ~
2

+ ~

2

-

~

2

(~ ~

2 2

+ 1)

exp

(~

2

+1
2

~

)

1

(~

2

+1
2

~

)

,

(5.1)

where ~ =

0

and ~ =

0

. The optimization objective function is simplified to obtain the

closed-form expressions for the optimum ~1 and ~2 . Exponential integral function is known to be bounded as [77]: 1 2
1( -

ln 1 +

(

2

)



1(

)

-

( ) 1 ln 1 + .

(5.2)

) can be approximated for

> 1 by its upper-bound in (5.2); therefore, the average

SNR at the destination can be bounded as: 83

¯ ~(  ~
2

2

+

2

)-

~

2

(~ ~

2 2

+ 1)

( ln 1 +
2

~ ~ +
2

2

+1 ~

)
2 2 2

+ ~

2

-

~

2

(~ ~

2 2

+ 1) ( 1+

1
~ ~ 1 1+
2 +1 2

)= ~

~ ~ 2+ ~

+1

,

(5.3)

Lagrangian method [28]. The Lagrangian function for SNR-based scheme is defined as: ~ ~ 2+ ~
2

( ) wherein (5.3), it is assumed that ln 1 + 1 

. The optimization problem is solved using

where ~ = ~ + ~ = as follows:

(

~, ~,

0

. Setting

)

= ~


2

+

~

2 2

+1
 

-

~

=

 ~

=

= 0 , the optimum ~ is found

(

) ~ + ~ - ~ .

(5.4)

~

=

(~

+ 1) + 2- 2

2



(~

2

+ 1)2

2

-(

2

-

2

)( ~
2

2

+ 1)( ~
2

2 2

+ ~

2

+ 1)

(

-

)

, (5.5)

where =( ~
2 2

-

2 2

-

2 2

).

(5.6)

can be simply calculated by using the constraint ( ~ + ~ = ~ ).

5.2.1

BER-based Power Allocation

The BER-based PA minimizes the average BER at the destination terminal and is formulated as follows: min
,

[

subject to:

(

¯ +1

0.5 )(

¯ +1

+

) 1+ =   84 .

(

¯

( )
1 ¯

1

¯

( ) )]
1 ¯

0 0

Note that we derived the average BER in (4.32). To simplify the problem, we re-write the objective function of the above optimization problem as: ( ~
2

where ~ and ~ are defined similar to SNR-based power allocation. To find the closed-form expressions for ~1 and ~2 , the objective function should be simplified. By using the upperbound of the exponential integral as in (5.2), the average BER expression is upper-bounded as: 0 .5 ¯  2 ~ ( + 1)( ~ When ~
2 2 2

0 .5 ( )( ~ 2+1 ~

2

+1

) 1+

(

1 ~ 2

~

)

1 2

(

~

1
2

))

,

(5.7)

+ 1)

( ~ 1+

2

ln( ~ ~ 2

2

+ 1)

) .

(5.8)

 1, ~

2

 1 and ~ ¯  2 ~

 1, we have: 1
2

~

2

+

ln( ~ 2 ) . 2 ~ 2~ 2
2

(5.9)

To find the optimum power allocation in a closed-form expression, ln( ~ imated by ln( ~
2

) is approx-

) to simplify the derivations. The optimization problem is solved using

Lagrangian method [28]. The Lagrangian function for BER-based scheme is written as: 1 2 ~
2 2

Setting

 ~

=

(

~, ~,
 ~

=

)

=
 

+

= 0 , the optimum ~ is found as follows:  (2 ~ (3 ~ 2 (2

( ) ln( ~ 2 ) ~ + ~ - ~ . - 2 ~ 2~ 2

(5.10)

~

=

2

2

+ 4

2

~ (3 +2

+ 1)

2

+

+

2

+ 1))2 + 4 4 +2

2

+ 1)

,

(5.11)

85

where = ln( ~ ~
2

) - 1.

(5.12)

can be simply calculated by using the constraint ( ~ + ~ = ~ ).

5.2.2

Outage-based Power Allocation

Outage-based power allocation minimizes the probability of outage at the destination terminal and is formulated as follows: min
,

[

-

subject to:

(

-



-1 - =

+  

)

-

(

-



-1

)

]

0 0

.

Note that we have derived outage probability earlier in (4.26). The outage probability in (5.14) can be approximated by: ( - 1 + ( 2
2  ) + ((

=

-

) 3 ) ) - 

-

(

-

1 + ( 2

2  ) + ((

(5.13)

) 3 ) ) ,  ( .)

where the exponential function is approximated by its Taylor series expansion and

represents the higher order terms. Neglecting the higher order terms, the outage probability can be approximated by: 1  2
2  2 

=

2~

2

(

1 ~
2

+

1 ~
2

)

=

2  2 2 2

(~

2

+ ~ ~2~

2

) .

(5.14)

86

The Lagrangian function for outage-based scheme is defined as [28]: ~, ~,
2  2 2 2

( Setting
 ~

)


=

(

2

+
2

2

)

-

(

) ~ + ~ - ~ .

(5.15)

=

 ~

=



= 0 , the optimum ~ is found as follows: ( ~ (4
2

~

-4 ) = + 2 4( - 2 )

~(

2

2

2

-

)

4(

)2
2

+ 16 ~ 2 -
2)

2( 2

-

2)

.

(5.16)

~

can be simply calculated by using the constraint ( ~ + ~ = ~ ).

5.2.3

Numerical Results and Discussion

In this section, the optimal power allocation results of BER-based, SNR-based, and outagebased schemes are compared. The closed-form equations presented here are general results and can be applied to any AF relaying system with a source, one relay and a destination. Therefore, it can be applied to both cases shown in Figures 4.3 and 4.4 in Chapter 4. In our analysis, the relay is considered to be located on the line connecting the source to the destination as discussed as (case (b)) in Figure 4.4. This case is more relevant to the multiuser model in Chapter 6. The optimum power ratio are numerically evaluated using a grid-based search [78] and compared with the closed-form expressions obtained in the previous section to verify the results. We assume a system model in which the distance between source and destination is normalized to one, and the relay is located at the destination (0 < < 1). This implies that unit from the source, and 1 -
2

unit from )- . We

= 1,

2

=

-

and

2

= (1 -

assume path-loss exponent of

= 3 in our analysis.

The optimum power allocation ratio is compared for three different schemes and different relay locations in Figure 5.1. The obtained power ratio expressions match very well with the numerically derived optimum points bearing a tolerable difference. The derived equation

87

1

SNR-Based
0.9

SNR-based PA (Formula Existing), Pt/N0= 20dB SNR-based PA (Formula), Pt/N0= 20dB SNR-based PA (Numerical), Pt/N0= 20dB Outage-based PA (Numerical), Pt/N0= 20dB Outage-based PA (Formula), Pt/N0= 20dB BER-based PA (Numerical), Pt/N0= 20dB BER-based PA (Formula), Pt/N0= 20dB

0.8
Power Ratio Allocated to the Relay (P /P )
t 1

0.7

0.6

Outage-Based
0.5

0.4

0.3

BER-Based

0.2

0.1

0 0.1

0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source (d1)

0.7

0.8

0.9

Figure 5.1: The ratio of power allocated to the relay for different relay locations.

for SNR-based scheme in the figure is closer to the numerically obtained optimum points, compared to the existing equations in [73], confirming the validity of our results. It is also observed that the ratio of the power allocated to the relay is higher for the SNR-based scheme when the relay is closer to the source. All power allocation schemes for AF relaying lead to the same power ratio for the case that relay is close to the destination. The optimum power ratio for BER-based PA and outage-based PA are very close as shown in Figure 5.1; therefore, the BER and outage performance of these two schemes should be very close as well. In this section, we compare the average BER and outage probability of these two schemes with SNR-based power allocation. By using the optimum power ratio taken from Figure 5.1 for the BER-based case and substituting them in (4.32) for the average BER, Figure 5.2 is plotted. It is observed that the BER-based scheme has a better performance compared to the SNR-based scheme for different values of ~ and different relay locations for the case that the relay is closer to the source. When the relay gets closer to the destination both schemes perform similarly in 88

10

-1

SNR-based, Pt/N0= 10dB BER-based, Pt/N0= 10dB SNR-based, Pt/N0= 20dB Pt = 10dBm BER-based, Pt/N0= 20dB SNR-based, Pt/N0= 30dB BER-based, Pt/N0= 30dB

10

-2

BER at the Destinaiton (P )

e

10

-3

P = 20dBm t 10
-4

10

-5

P = 30dBm t
-6

10

0.1

0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source (di)

0.7

0.8

0.9

Figure 5.2: BER performance of the BER-based and SNR-based power allocation schemes for different relay locations.

terms of average SNR. The same approach can be followed for the outage probability. The outage-based and SNR-based optimum power ratio taken from Figure 5.1 are substituted in for the outage probability to plot Figure 5.3. It is observed that the performance of the relaying system is better when the outage probability is selected as the objective function in optimization. The results are similar to the one we obtained for average BER in a relaying system. An interesting point to notice is how the performance of the system changes for BERbased and outage-based schemes for different relay locations. As the relay gets closer to the source, the BER performance of both BER-based and outage-based PA outperform the SNR-based scheme; however, all the schemes perform the same as the relay gets closer to the destination. Allocating smaller portion of power to the relay implies a longer lifetime for the mobile relays that are on battery power. Not only is less power consumed in the relay but also better performance is achieved by using the right objective function. The performance

89

10

-1

SNR-based, Pt/N0= 10dB Outage-based, Pt/N0= 10dB SNR-based, Pt/N0= 20dB

)

10

-2

Pt = 10dBm

Outage-based, Pt/N0= 20dB SNR-based, Pt/N0= 30dB Outage-based, Pt/N0= 30dB

Approximate Outage at the Destinaiton (P

out

10

-3

10

-4

Pt = 20dBm

10

-5

10

-6

P = 30dBm t

10

-7

0.1

0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source (di)

0.7

0.8

0.9

Figure 5.3: Outage performance of the outage-based and SNR-based power allocation schemes for different relay locations.

degradation for the SNR-based scheme is negligible compared to the BER-based and outagebased schemes. To verify the performance of the closed-form equations and to compare them with the performance of the numerically evaluated optimum points, we have simulated and found the average BER and outage probability of the single-relay system. The results are presented in Figure 5.4 for
0

= 10dB. It is obvious that the performance degradation due to the

approximations made for finding the closed-form optimum power ratio is negligible. The capacity of an AF relaying link is the logarithm function of the SNR; therefore, maximizing the SNR in the relaying system implies maximization of the capacity. The optimum SNR-based power ratio obtained in this chapter will be applied in the cooperative resource allocation in Chapter 6.

90

BER-based, Numerical, Pt/N0= 10dB BER-based, Equation, Pt/N0= 10dB

Outage-based, Numerical, Pt/N0= 10dB Outage-based, Equation, PtL/N0= 10dB

BER Upperbound at the Destinaiton (P )

e

10

-2

Approximate Outage at the Destinaiton (P

out

)

10

-2

0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source (d )
i

0.7

0.8

0.2

0.3

0.4 0.5 0.6 Normalized Relay Distance from the Source (d )
i

0.7

0.8

Figure 5.4: Average BER and outage probability, closed-form equation vs. optimum numerical point, 0 = 10dB.

5.3

Chapter Summary

In this chapter, we studied different power allocation strategies for an AF relaying system. By using the derived equations in Chapter 4 for the average SNR, average BER and outage probability, we formulated the problem of optimum power allocation in an AF relaying system according to these three different objective functions. Considering the objective function in power allocation, the closed-form equations were derived for the optimum power ratio of the source and the relay. We showed that the derived optimum power ratio are very close to the numerically evaluated optimum power ratio for the three different objective functions. It was observed that BER-based and outage-based schemes allocate a smaller portion of the transmit power to the relay compared to the SNR-based scheme. The illustrated results emphasize that the results of average SNR optimization would not be necessarily the same as the results of average BER optimization nor outage probability optimization in an AF relaying system. This is a new finding which has not been reported in the literature. The three different schemes perform very similarly especially when the relay is close to the destination. Capacity of a relaying system is an increasing function of SNR at the destination.

91

Therefore, the SNR-based power allocation also maximizes the capacity at the destination. The SNR-based power allocation will be applied to the cooperative multi-user system to increase the efficiency of the relaying system in the next chapter.

92

Chapter 6 Cooperative Subcarrier and Power Allocation in Relaying Systems
Considering the vast shift towards new 4G OFDM relay-based technologies, such as WiMax [2], it is important to consider multi-user resource allocation in the relay-based communication system. How to allocate the system resources; i.e., subcarrier and power, to the mobile users and relays in the system is a problem worthy of investigation. Subcarrier and power allocation in a multi-user OFDM relaying system is the focus of this chapter. We earlier presented the general multi-user system model in Chapter 2. We revisit this system model here in Figure 6.1. We assume an AF TDMA-based relaying protocol similar to what was described in Chapter 4. One RS is assigned to every MS in the system to accommodate the relaying. BS-MS pair plus RS build up a unit that is similar to the single-relay model investigated in Chapters 4 and 5. We will take advantage of this similarity and apply the optimal power allocation results presented in Chapter 5 to the multi-user relaying system to increase the power efficiency of the system. Based on the capacity equations derived for the AF relaying system in Chapter 4, a new parameter called cooperation coefficient is defined. Cooperation coefficient concept is applied to the subcarrier allocation algorithm to increase the throughput of the multi-user relaying system.

93

Mobile Station

Relay Station

Base Station

Figure 6.1: Practical multi-user relaying system model.

The rest of the chapter is organized as follows. We first define the cooperation coefficient and analyze its characteristics in the system. The multi-user AF relaying system model is presented next. The cooperative subcarrier allocation problem is formulated and the algorithm is proposed. Following, the two-step subcarrier and power allocation is the final topic discussed. The chapter ends with simulation results and conclusion.

6.1

Multi-user Relaying System Model

The relay station is the new system component in the infrastructure-based model in Figure 6.1. The general multi-user system model is illustrated in Figure 6.2. Each mobile station is assigned to the nearest relay station. In Figure 6.2, are assigned to to
3. 1, 5 1

to

4

to

8

are assigned to

2,

and finally

9

to

12

are assigned

The transmission protocol is the same as in Chapter 4 for an AF relaying system. 94

MS1 MS12 MS2 MS3 MS11

RS1

MS4

RS3
MS10

BS

MS9

RS2
MS6 MS8 MS7

MS5

Figure 6.2: General multi-user relaying system model.

95

's are located 's.

units away from

.

is located

units from

and

unit from

Assuming that the with power

'th subcarrier is assigned to

,

broadcasts

's signal

in the first timeslot. The assigned relay station, with power
,

, receives a copy of the after normalization in

received signal and amplifies and forwards it to

the second timeslot. We use the system model in Figure 6.2 for analysis in the later sections. The triplet of , and is similar to the single-relay system introduced earlier

in Chapter 4. Figure 6.3 shows the equivalent single-relay system model similar to the earlier model in Chapter 4. , and in Figure 4.1 are renamed as , and in Figure

6.3 respectively to match with the infrastructure-based system model in Figure 6.2.

hk , n ,  k2, n

BS
hik ,n ,  i2k ,n

MSk RSj
hrk ,n ,  r2k ,n

Figure 6.3: Single-relay system model.

In Figure 6.3,  gains between

,

is the 'th subcarrier assigned to , and between to and

1.



,

and 

,

are the channel

and

respectively. The index represents denotes the relaying path from to

the indirect path from .

and the index

6.1.1

Cooperation Coefficient

According to Figure 6.3 and following the analysis provided earlier in Chapter 4, the maximum error-free data rate for can be written as:
,

,

=

2

( log2 1 +

0



,

 +
0

2

0

0



, , 0

2  
,

,

2

2
,

+

2 + 1

) ,

(6.1)

96

where

is the total bandwidth divided into

subcarriers. We notice that the data rate in
,

(6.1) is the function of the direct paths and indirect paths. Therefore, as:
,

can be rewritten

=

2

( log2 1 +

0

where

,

is the contribution level from

in the data rate of
,

(



,

 +

2

,



,

)  ,
2

)

(6.2)

on the 'th subcarrier. can be written as:

We define this parameter as cooperation coefficient. Therefore,
,

,

=
0

0


, 0

,

2
,

2
,

+



2 + 1

.

(6.3)

It should be noted that the cooperation coefficient cannot exceed one; i.e., the cooperation level in the capacity from the indirect path is always less than the direct path.

6.1.2

The pdf of Cooperation Coefficient

The cooperation coefficient is a random variable. We first intend to find the probability density function (pdf) of cooperation coefficient and then its mean and variance to understand and analyze its characteristics. According to the definition of cooperation coefficient in (6.3), the cooperation coefficient is a function of  cooperation coefficient in (6.3) can be rewritten as:  , +
,

, the indirect subcarrier gain. The

=
2

(6.4)

where  = 

,

2 and

=

, ,

+

0

. We have dropped the indices in (6.4) for clarity and  . We

of analysis. It is observed that the cooperation coefficient is a function of assume a Rayleigh distribution for 
,

; therefore,  has an exponential distribution [63].

97

Therefore, we assume an exponential pdf for  with    

=

1
2 ,

as follows:

- 

( ) =

,  0  < 0.

(6.5)

Therefore, following the procedure in [63] for finding pdf of a function of a random variable, the pdf of cooperation coefficient, , is as follows: ( )

  , 0,

( )=

(1 - )2

1-

(6.6)

The pdf of cooperation coefficient is shown in Figure 6.4 for different relay location, and equal power allocation to base station and relay station. We assume a normalized distance for - pair; i.e., = 1. is located on the line connecting to

closer to zero implies that the effect of indirect link in the total data rate of mobile station is very small and, having a cooperation coefficient closer to one means that both the indirect and indirect links have almost the same impact on the total data rate. It is observed in Figure 6.4 that as the relay station gets closer to the mobile station, the cooperation coefficient is more likely to have values closer to one, which translates into a better performance for the cooperation protocol. As the relay station gets closer to the mobile station,  gets stronger which results in a cooperation coefficient closer to one.

and the path-loss index is three ( = 3). This implies different values for 2 , 2 and . ( ) Cooperation coefficient is distributed in the interval of 0, 1 . A cooperation coefficient

6.1.3

Statistics of Cooperation Coefficient

Mean of the cooperation coefficient will be used in the proposed cooperative subcarrier allocation algorithm in the next section. According to the definition of the mean for a random variable, it is possible to find a closed-form equation for mean of cooperation coefficient based

98

14 Pn/N0=20dB, di=0.7 P /N =20dB, d =0.5
n n 0 0 i i

12

P /N =20dB, d =0.3

10

8
f (a)
A

d = 0.3
i

6

di = 0.7

4 di = 0.5 2

0 0

0.1

0.2

0.3

0.4

0.5 a

0.6

0.7

0.8

0.9

1

Figure 6.4: pdf of cooperation coefficient for different relay location,

.

on its pdf. Similar to the previous section, we assume Rayleigh distribution for the subcarrier gains. This is a fair assumption for an OFDM-based system. The closed-form formula for mean of the cooperation coefficient when relaying channel has Rayleigh distribution is calculated as: [ ]= 
1

( )
0

=1+

E 1 (- ),

(6.7)

where E1 ( ) is the exponential integral introduced earlier in Chapter 5. Variance of cooperation coefficient helps us understand the characteristics of cooperation coefficient. This variance, assuming Rayleigh pdf for the subcarrier gains, can be calculated as: var[ ] = [ 2 ] - ( [ ])2 = +
2

Mean and variance of the cooperation coefficient are shown in Figures 6.5 and 6.6 respectively as a function of the distance between the relay station and base station. 99

( E 1 (- ) 1 -

) E 1 (- ) .

(6.8)

1 P /N =20dB
n 0

0.9 0.8
Mean of cooperation coefficient, E(a)

0.7 0.6 0.5 0.4 0.3 0.2 0.1 0 0.2

0.3

0.4 0.5 0.6 Normalized RS distance from BS, di

0.7

0.8

Figure 6.5: Mean of cooperation coefficient for different relay locations,

.

0.06 P /N =20dB
n 0

0.05
Variance of cooperation coefficient, var(a)

0.04

0.03

0.02

0.01

0 0.2

0.3

0.4 0.5 0.6 Normalized RS distance from BS, di

0.7

0.8

Figure 6.6: Variance of cooperation coefficient for different relay locations,

.

100

The mean of cooperation coefficient is closer to zero when to one when is closer to

is closer to

, and closer

. This implies that the closer the relay station is to the

mobile station, the higher the average contribution of the indirect link would be. This is intuitively compatible with the definition of the cooperation coefficient. The cooperation coefficient and its mean are used later to develop the cooperative subcarrier allocation algorithm. Variance of cooperation coefficient will be used in analyzing the performance of the cooperative subcarrier allocation algorithm.

6.2

Cooperative Subcarrier Allocation

The problem of subcarrier allocation in the downlink of a multi-user OFDM relaying system is considered. Performing joint subcarrier and power allocation in the system exponentially increases the complexity of the resource allocation algorithm as well as the time needed to find the optimized solution. Base station has to rapidly update the resource allocation information to benefit effectively from the dynamic nature of the environment. It is preferable to separate the subcarrier and power allocation of the resource allocation algorithm in order to reduce the complexity of the problem [56] to achieve a suboptimal, yet practical, solution. Here, we consider a flat power allocation and focus on the problem of subcarrier allocation in the relaying system. We assume a relaying system with users and relay stations with

subcarriers to be allocated to the users. The power allocation to mobile stations and relays will be discussed in the section 6.4.

6.2.1

Throughput-Oriented Cooperative Subcarrier Allocation

The main goal of throughput-oriented cooperative subcarrier allocation in a multi-user OFDM relaying system is to maximize the total throughput and is formulated as follows: [ 
=1 =1

max
,

,

2

( log2 1 + 101

0

( 

,

2 +

,



,

] ) ) 2 ,

(6.9)

subject to: C1 : C2 :
,

 {0 , 1 },
=1 ,

 , 



= 1,

The constraints C1 and C2 guarantee that subcarriers are not shared in the system similar to the non-cooperative problem formulation in (3.8). Total power between the base station and the relay station over is equally divided

subcarriers. By taking a close look

at the capacity equations in (6.9), it is observed that the data rate is not only a function of mobile stations's subcarrier gain,  and cooperation coefficient,
, ,

, but also depends on the indirect subcarrier gain, 

,

,

. Therefore, the objective value in assigning the subcarriers

to the mobile stations should also include the cooperation coefficient and the relay station's subcarrier gain. We choose the objective value as 
,

2 +

,



,

2 for user . As stated earlier, we

have chosen flat power allocation to decrease the complexity of the algorithm. The summary of the throughput-oriented cooperative subcarrier allocation algorithm is as follows:

 Initialization , = 0,  , = 0,  obj
,

= 

,

2 +

,



,

2

 Subcarrier Allocation ­ for = 1 to find to maximize obj
,

,

,

= 1, = + 
=1 , ,

.

­ end

102

 End

The throughput-oriented cooperative subcarrier allocation algorithm is a fairly simple procedure. In the first step, all the variables are initialized and the objective value is calculated for all the subcarriers of all the users. In the next step, each subcarrier is assigned to the user that has the highest objective value for that subcarrier. The procedure continues until all the subcarriers are allocated. This algorithm does not consider the fairness among users in the system. In the next section, we introduce the fairness-oriented subcarrier allocation algorithm (which was earlier discussed in section 3.3) for the cooperative relaying system by modifying the objective value in subcarrier allocation.

6.2.2

Fairness-Oriented Cooperative Subcarrier Allocation

The main goal of fairness-oriented cooperative subcarrier allocation in a multi-user OFDM relaying system with equal power allocation is to maximize the total throughput with maintaining the fairness among the users and is formulated as follows: [ 
=1

max min
,

,

2

log2 1 +

(

0

(



,

2 +

,



,



)) 2

]

,

(6.10)

subject to: C1 : C2 :
,

 {0 , 1 },
=1 ,

 , 



= 1,

By modifying the objective value for a fairness-oriented subcarrier allocation algorithm, the fairness-oriented cooperative subcarrier allocation algorithm is proposed as follows:

 Initialization 103

,

= 0,  , = 0,  = {1, 2, ..., } 2 +
,

obj

,

= 

,



,

2

 Subcarrier Allocation ­ for = 1 to K (a) find satisfying obj  = ­ end ­ while = 
, ,

 obj =1

,

 =

 

(b) update

with

=1

,

,

-{ }

(a) find

satisfying

 find 

;

 = 1, 2, ..., (b) for the found obj 
, ,

satisfying 

 obj =1

,

(c) update  = = ­ end  End

and
=1 ,

with ,
,

-{ }

104

In the first step, all the variables are initialized and objective value is calculated for all the subcarriers of all the users. In the second step, one subcarrier is assigned to each user based on the objective value; i.e., one subcarrier is assigned to each user (in a greedy pattern). After all the users have been assigned one subcarrier each, in the third step, the user with the lowest data rate is given the priority to choose its next subcarrier. This procedure continues until all the subcarriers are allocated. The cooperative subcarrier allocation algorithm proposed here requires instantaneous knowledge of cooperative coefficient at the base station (besides  coefficient is a function of 
,

 and 

,

), which itself

implies availability of the knowledge of the relaying channel at the base station. Cooperation
,

 and its availability at the base station requires continuous

feedback of the relaying subcarrier gain to the base station. We further propose to use the mean of cooperation coefficient in cooperative subcarrier allocation. Based on the results found for the mean of cooperation coefficient for Rayleigh pdf in the previous section, we can calculate the mean of cooperation coefficient and use it to modify the objective value of cooperative subcarrier allocation. Mean of cooperation coefficient can be found based on the distance between the relay station and the mobile station. We will show that by using the mean of cooperation coefficient instead of its instantaneous value the total throughput of the system degrades comparably . In the worst case scenario, when no information about the mean of cooperation coefficient is available, we can assume a uniform distribution for cooperation coefficient and calculate the mean. As will be shown later, the cooperative algorithm still achieves a better performance compared to the non-cooperative one.

6.2.3

Asymptotically Fair Cooperative Subcarrier Allocation

We consider the asymptotically fair subcarrier allocation algorithm (introduced earlier in Chapter 3.4) for the cooperative system model in Figure 6.2. The problem of asymptotically

105

fair cooperative subcarrier allocation is formulated as: [ 
=1 =1

max
,

,

2

( log2 1 +

0

( 

,

2 +

,



,

] ) ) 2 ,

(6.11)

subject to: C1 : C2 : C3 :
,

 {0 , 1 },
=1 ,

 , 

 [

= 1,

]=

All the constraints are the similar to the fairness-oriented except for C3 that enforces a specific average fairness,  (0, 1), in the system. We apply the same idea proposed

before for allocating the subcarriers to the users in an asymptotically fair manner. The proposed subcarrier allocation algorithm assigns the subcarriers in two steps. In the first step, subcarriers are allocated to the groups. In the second step, subcarriers are allocated to the users within each group. To perform the asymptotically fair subcarrier allocation, the users are grouped into groups with
,

users in each group. , determines which subcarrier should be assigned

Group allocation matrix, D = [

]

×

to which group of users. The problem of resource allocation is to determine the elements of two matrices: D = [
,

]

×

and C = [

,

]
,

× ×

.

,

= 1, if and only if subcarrier

is

allocated to group ; otherwise it is zero.

= 1, if and only if subcarrier

is allocated to

user ; otherwise it is zero. In the following we present the two steps of asymptotically fair cooperative subcarrier allocation. Subcarrier Allocation to Groups The first step is allocating the subcarriers to the groups of users. Similar to the noncooperative system, fairness-oriented algorithm is chosen for group allocation. The objective value in subcarrier allocation to groups is the total data rate of each group. The groupsubcarrier-allocation is as follows: 106

 Initialization , = 0,  , = 0,   obj , = =( = {1, 2, ..., , 

-1) +1

,

}

 Group Subcarrier Allocation ­ for = 1 to (a) find  ­ end ­ while = 
,

satisfying obj ,  obj , = 1, = with -{ }  =



 obj ,

(b) update

=1

,

(a) find

satisfying



;

 = 1, 2, ..., (b) for the found , find n satisfying obj ,  obj , 
,

 =

 -{ }  = obj ,

= 1,

(c) update ­ end  End

with

=1

,

Subcarrier Allocation to Users After group subcarrier allocation is performed, the user allocation is performed independently for each group based on the obtained group allocation matrix, D. The cooperative 107

throughput-oriented subcarrier allocation is used for allocating the subcarriers within each group. The user-subcarrier-allocation procedure is as follows:

 Initialization , = 0,  , = 0,  obj
,

= 

,

2 + },

, ,



,

2 ,  ,

= {1, 2, ...,

 User Subcarrier Allocation ­ for = 1 to (a) find  ­ end  End
,

that maximizes obj =1 with = 

,

 that

,

=1

(b) update

=1

,

,

6.3

Performance Evaluation: Capacity and Fairness

In this section, the performance of cooperative subcarrier allocation is compared with noncooperative subcarrier allocation in terms of total throughput and fairness. The general relaying system model in Figure 6.2 is considered here. We have two sets of simulations. First, the performance of the cooperative algorithms proposed in this chapter is compared with the performance of non-cooperative algorithms. In the second set of simulations, the incorporation of cooperation coefficient in cooperative subcarrier allocation is investigated.

108

6.3.1

Simulation Parameters

The wireless channel is modeled as frequency selective with six independent multipaths and exponential delay profile as in [56]. The total bandwidth of the system is assumed = 1.25MHz and the total transmit power is that there are = 20dBm in the downlink. It is assumed

= 256 subcarriers to be allocated to the users and the average received

SNR at the mobile station from the base station is equal for all users and all subcarriers (¯
,

= 20dB). All the relay stations are located

units away from the base station. All the units away from the

mobile stations are located

units away from the base station and

assigned relay station. We assume a normalized distance between base station and mobile stations ( = 1). Total number of 10, 000 channel gains realizations are used and the results are averaged.

6.3.2

Simulation Results

Cooperative vs. Non-cooperative Subcarrier Allocation In the first set of simulations, we compare the total throughput and fairness index of the cooperative algorithms proposed earlier in this chapter with the non-cooperative algorithms discussed in Chapter 3. Throughput-oriented, fairness-oriented and asymptotically fair algorithm are the benchmark algorithms. The instantaneous value of the cooperation coefficient is assumed to be available at the base station for calculation of the objective value in subcarrier allocation algorithm. The relay stations are located half-way between mobile stations and base station ( = = 0.5). The total throughput and fairness graphs are illustrated

in Figures 6.7 to 6.10. Effectiveness of Cooperation Coefficient In the second set of simulations, we investigate the availability of the cooperation coefficient at the base station. We also run the simulation for different relay locations and investigate

109

1.1
5.6

5.4

Cooperative Greedy Non-Cooperative Greedy Cooperative Asymptotically Fair, I=2 Cooperative Max-Min Non-Cooperative Asymptotically Fair, I=2 Non-Cooperative Max-Min

1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 Cooperative Max-Min Non-Cooperative Max-Min Cooperative Asymptotically Fair, I=2 Non-Cooperative Asymptotically Fair, I=2 Cooperative Greedy Non-Cooperative Greedy 5 10 15 20 Number of OFDM Symbols 25 30

Total Capacity (bps per Hz)

5.2

5

4.8

4.6

4.4

Average Fairness Index, E[Fv ]
5 10 15 20 25 30

0.2
4.2

0.1

Number of OFDM Symbols

Figure 6.7: Total throughput and fairness index versus the number of OFDM symbols, = 0.5, = 256.

= 2,

1.1
5.6

5.4

Cooperative Greedy Cooperative Asymptotically Fair, I=3 Non-Cooperative Greedy Cooperative Max-Min Non-Cooperative Asymptotically Fair, I=3 Non-Cooperative Max-Min

1 0.9 0.8
Average Fairness Index, E[Fv ]

Total Capacity (bps per Hz)

5.2

0.7 0.6 0.5 0.4 0.3 Cooperative Max-Min Non-Cooperative Max-Min Cooperative Asymptotically Fair, I=3 Non-Cooperative Asymptotically Fair, I=3 Cooperative Greedy Non-Cooperative Greedy 5 10 15 Number of OFDM Symbols 20 25 30

5

4.8

4.6

4.4

0.2
4.2 5 10 15 20 25 30

0.1

Number of OFDM Symbols

Figure 6.8: Total throughput and fairness index versus the number of OFDM symbols, = 0.5, = 256.

= 3,

110

5.6

5.4

Cooperative Greedy Cooperative Asymptotically Fair, I=4 Non-Cooperative Greedy Cooperative Max-Min Non-Cooperarive Asymptotically Fair, I=4 Non-Cooperative Max-Min

1.1 1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 Cooperative Max-Min Non-Cooperative Max-Min Cooperative Asymptotically Fair, I=4 Asymptotically Fair, I=4 Cooperative Greedy Non-Cooperative Greedy 5 10 15 20 Number of OFDM Symbols 25 30

5.2

5

4.8

4.6

4.4

Average Fairness Index, E[Fv ]
5 10 15 20 25 30

Total Capacity (bps per Hz)

4.2

0.1

Number of OFDM Symbols

Figure 6.9: Total throughput and fairness index versus the number of OFDM symbols, = 0.5, = 256.

= 4,

1.1
5.6

5.4

Cooperative Greedy Cooperative Asymptotically Fair, I=6 Non-Cooperative Greedy Non-Cooperative Asymptotically Fair, I=6 Cooperative Max-Min Non-Cooperative Max-Min

1 0.9 0.8
Average Fairness Index, E[Fv ]

Total Capacity (bps per Hz)

5.2

0.7 0.6 0.5 0.4 0.3 Cooperative Max-Min Non-Cooperative Max-Min Cooperative Asymptotically Fair, I=6 Non-Cooperative Asymptotically Fair, I=6 Cooperative Greedy Non-Cooperative Greedy 5 10 15 Number of OFDM Symbols 20 25 30

5

4.8

4.6

4.4

0.2
4.2 5 10 15 20 25 30

0.1

Number of OFDM Symbols

Figure 6.10: Total throughput and fairness index versus the number of OFDM symbols, = 6, = 0.5, = 256.

111

how it might affect the performance of the cooperative and non-cooperative algorithms. In terms of availability of cooperation coefficient, we consider the Monte-Carlo simulations for the following four cases: 1. Perfect knowledge of instantaneous cooperation coefficient at the base station is assumed to be available at the base station (cooperative algorithm, instantaneous ). 2. Mean value of the cooperation coefficient is computed at the base station by using (6.7) based on . This implies that the base station knows the pdf of cooperation

coefficient (cooperative algorithm, mean of ). 3. No knowledge about the statistics and instantaneous value of cooperation coefficient is assumed to be available at the base station. Base station assumes a ( ) uniform distribution in the interval of 0, 1 for cooperation coefficient and therefore, = 0.5 for mean of cooperation coefficient (cooperative algorithm, ( ) = 0.5).

uses

4. Cooperation coefficient is not used in subcarrier allocation process (non-cooperative algorithm). We assume a normalized distance between base station and mobile stations ( = 1) and three different relay locations, specifically = 0.3, 0.5, 0.7 which results in = 1- = 37, 8, 2.9 = 0 .7 , 0 .5 , 0 .3

respectively. We assume that all the mobile stations are located unit away from the assigned relay station.

The throughput-oriented and fairness-oriented are simulated for the system model in Figure 6.2. The total throughput of the system (bit per second per Hz) versus different number of users is shown in Figures 6.11-6.16. The throughput-oriented and fairness-oriented algorithms are referred to as greedy and Max-Min respectively. It is observed that all the cooperative algorithms provide better performance compared to non-cooperative algorithm both for throughput-oriented and fairness-oriented algorithms. When the relay station is 112

closer to the mobile station (smaller values of ), better performance improvement is achieved compared to the non-cooperative case. This is due to the pdf of cooperation coefficient, as it is seen in Figure 6.4. Cooperation coefficient distribution is shifted closer to one when the relay station is closer to the mobile station. This translates into a better cooperation throughput.

di = 0.7 5.2 5.1 5
Total Capacity (bits/s/Hz)

Cooperative Greedy, Instantaneous a Cooperative Greedy, Mean of a Cooperative Greedy, E(a) = 0.5 Non-cooperative Greedy

4.9
10%

4.8 4.7 4.6 4.5 4.4 4.3 4.2 2

4

6

8 10 Number of Users (K)

12

14

16

Figure 6.11: Total throughput versus number of users for throughput-oriented algorithms, = 0.7, = 256.

6.3.3

Discussion of Results

According to Figures 6.11 to 6.16, the throughput of the cooperative subcarrier allocation algorithms can be improved up to about 15% over the non-cooperative subcarrier allocation algorithms in [34, 35]. It may seem that a uniform average SNR for all the mobile stations has led to a fairness index equal to one for fairness-oriented algorithm; however, it should be noted that the instantaneous received SNR's on different subcarriers are different due to multipath fading. The throughput-oriented algorithm assigns the subcarriers to the users to 113

4.45 di = 0.7 4.4 Cooperative Max-Min, Instantaneous a Cooperative Max-Min, Mean of a Cooperative Max-Min, E(a) = 0.5 Non-cooperative Max-Min

4.35
Total Capacity (bits/s/Hz)

4.3
4%

4.25

4.2

4.15

4.1 2

4

6

8 10 Number of Users (K)

12

14

16

Figure 6.12: Total throughput versus number of users for fairness-oriented algorithms, 0.7, = 256.

=

5.6 di = 0.5 5.4 Cooperative Greedy, Instantaneous a Cooperative Greedy, Mean of a Cooperative Greedy, E(a) = 0.5 Non-cooperative Greedy

5.2
Total Capacity (bits/s/Hz)

5
14%

4.8

4.6

4.4

4.2 2

4

6

8 10 Number of Users (K)

12

14

16

Figure 6.13: Total throughput versus number of users for throughput-oriented algorithms, = 0.5, = 256.

114

di = 0.5 4.55

Cooperative Max-Min, Instantaneous a Cooperative Max-Min, Mean of a Cooperative Max-Min, E(a) = 0.5 Non-cooperative Max-Min

4.5
Total Capacity (bits/s/Hz)

4.45
6%

4.4

4.35

4.3

4.25

4.2 2

4

6

8 10 Number of Users (K)

12

14

16

Figure 6.14: Total throughput versus number of users for fairness-oriented algorithms, 0.5, = 256.

=

5.6 di = 0.3 5.4 Cooperative Greedy, Instantaneous a Cooperative Greedy, Mean of a Cooperative Greedy, E(a) = 0.5 Non-cooperative Greedy

5.2
Total Capacity (bits/s/Hz)
15%

5

4.8

4.6

4.4

4.2 2

4

6

8 10 Number of Users (K)

12

14

16

Figure 6.15: Total throughput versus number of users for throughput-oriented algorithms, = 0.3, = 256.

115

4.45 di = 0.3 4.4 Cooperative Max-Min, Instantaneous a Cooperative Max-Min, Mean of a Cooperative Max-Min, E(a) = 0.5 Non-cooperative Max-Min

4.35
Total Capacity (bits/s/Hz)

4.3
6%

4.25

4.2

4.15

4.1

4.05 2

4

6

8 10 Number of Users (K)

12

14

16

Figure 6.16: Total throughput versus number of users for fairness-oriented algorithms, 0.3, = 256.

=

maintain fairness index instantaneously close to one. Using the mean of cooperation coefficient in cooperative subcarrier allocation results in a better performance compared to the non-cooperative algorithm. It is observed that the performance of the subcarrier allocation algorithm is degraded by using an inaccurate estimate of the cooperation coefficient mean in case 3. Another interesting point worthy to note is that when the relay station is closer to the mobile station, cooperative algorithm with instantaneous mean of and cooperative algorithm with

have almost the same performance. When the relay station is moved closer to

the base station, we note a bigger gap between the performance of these two cases. This difference can be explained by looking at the variance of the cooperation coefficient. When relay is closer to the mobile station, variance is lower which implies a smaller deviation of instantaneous cooperation coefficients from its mean value. The performance difference can also be justified by analyzing the pdf of the cooperation coefficient.

116

For the relay location closer to the mobile user the pdf of cooperation coefficient in Figure 6.4 is concentrated around its mean value. This implies that the instantaneous value of the cooperation coefficient is more likely to be close to its mean value; or it can be claimed that the mean value of cooperation coefficient is a good estimate of its instantaneous value when the relay is closer to the mobile station. By using a good estimate of the cooperation coefficient in subcarrier allocation a comparable performance improvement is achieved. When relay station is closer to the base station the cooperation coefficient is more likely to be close to zero, and the mean of the cooperation coefficient is almost zero as seen in Figure 6.5. Using the wrong estimate for the mean of cooperation coefficient ( ( ) = 0.5) results in performance degradation in Figure 6.15 and 6.16. The throughput of the multi-user relaying system can also be compared for different relay station locations. With equal power allocation, it is observed that when the relay station is located at the mid-point between the base station and the mobile station, the throughput of greedy and max-min algorithms are greater than for the other relay locations. This can be explained by looking at the average capacity of the single-relay system model. The average capacity of the single-relay system model in Chapter 4 was presented in Figures 4.14-4.16. It was observed there that the average capacity at the destination terminal is maximized when the relay is at the mid-point between source and destination. The optimum power allocation for a single relay system was discussed in Chapter 5. The results for SNR-based power allocation indicated that the equal power allocation is the optimum solution when the relay is at the midpoint between source and destination. This means that in the simulated result, only in Figures 6.13 and 6.14, optimum power allocation is assumed. We would like to investigate the possibility of throughput improvement by using the optimum power allocation in Figure 5.1 for other relay locations. In the next section, we consider a two-step subcarrier/power allocation procedure. After the subcarrier allocation procedure is done, we perform the power allocation to single-relay system. and based on the results of a

117

6.4

Two-Step Power and Subcarrier Allocation

Flat power allocation among the subcarriers was shown to degrade the throughput of the non-cooperative system negligibly compared to the optimum power allocation [35]. In the previous section, we assumed an equal power allocation over all the subcarriers for both and and different relay locations. In this section, we propose a two-step solution for - -

subcarrier and power allocation. We follow an equal power allocation to all the

triplets and for the subcarriers allocated to them, and optimize the power allocation to and over each subcarrier.

The power allocation over one subcarrier in a multi-user system is similar to the power allocation in a single-relay system discussed in Chapter 5. The closed-form solution to the power allocation problem for the single-relay system was presented there for different objective functions. We apply the solution of SNR-based power allocation in Chapter 5 to the proposed cooperative subcarrier allocation algorithms. The proposed two-step subcarrier and power allocation procedure can be summarized as follows: 1. The total power is equally divided between subcarriers. Therefore, / is

assigned to each subcarrier. 2. Power allocation for and is performed over each subcarrier according to (5.5)

by considering the relay location. 3. By updating the allocated power to and in cooperative subcarrier allocation,

the cooperation coefficients and the objective values in cooperative subcarrier allocation are updated. 4. Cooperative subcarrier allocation is performed by using the updated objective values.

118

6.4.1

Simulation Results

The simulated results of the proposed power+subcarrier allocation are illustrated in Figures 6.17 to 6.20 for different number of users and different relay locations. We have kept all the simulation parameters the same as the previous section to have a fair comparison.
5.6 di = 0.7 5.4 Cooperative Greedy with PA Cooperative Greedy Non-cooperative Greedy with PA Non-cooperative Greedy

5.2
Total Capacity (bits/s/Hz)

5

4.8

4.6

4.4

4.2 2

4

6

8 10 Number of Users (K)

12

14

16

Figure 6.17: Total throughput versus number of users for throughput-oriented algorithms with power allocation, = 0.7, = 256.

6.4.2

Discussion of Results

For all the different relay locations illustrated in Figure 6.17 to 6.20, the cooperative subcarrier allocation with power allocation perform better than cooperative subcarrier allocation with equal power allocation. Power allocation even improves the performance of the noncooperative algorithms. It is also observed that the throughput improvement is higher when is closer to .

In Figure 6.21, we compare the throughput of the multi-user relaying system for different relay locations and hence, examine the effectiveness of the two-step subcarrier and power 119

4.7 di = 0.7 Cooperative Max-Min PA Non-cooperative Max-Min PA Cooperative Max-Min Non-cooperative Max-Min

4.6

Total Capacity (bits/s/Hz)

4.5

4.4

4.3

4.2

4.1 2

4

6

8 10 Number of Users (K)

12

14

16

Figure 6.18: Total throughput versus number of users for fairness-oriented algorithms with power allocation, = 0.7, = 256.

5.6 di = 0.5 5.4 Cooperative Greedy with PA Cooperative Greedy Non-cooperative Greedy with PA Non-cooperative Greedy

5.2
Total Capacity (bits/s/Hz)

5

4.8

4.6

4.4

4.2 2

4

6

8 10 Number of Users (K)

12

14

16

Figure 6.19: Total throughput versus number of users for throughput-oriented algorithms with power allocation, = 0.5, = 256.

120

di = 0.5 4.55

Cooperative Max-Min with PA Cooperative Max-Min Non-cooperative Max-Min with PA Non-cooperative Max-Min

4.5
Total Capacity (bits/s/Hz)

4.45

4.4

4.35

4.3

4.25

4.2 2

4

6

8 10 Number of Users (K)

12

14

16

Figure 6.20: Total throughput versus number of users for fairness-oriented algorithms with power allocation, = 0.5, = 256.

5.6 Cooperative Greedy, Optimal PA Cooperative Greedy, Equal PA Cooperative Max-Min, Optimal PA Cooperative Max-Min, Equal PA

5.4

5.2
Total Capacity (bits/s/Hz)
8%

5

4.8

4.6
9%

4.4

4.2

4 0.2

0.3

0.4

0.5 0.6 Normalized Relay Location (di)

0.7

0.8

Figure 6.21: Total throughput versus normalized relay location,

= 12,

= 256.

121

allocation scheme as a function of relay location ( ). The two-step cooperative subcarrier and power allocation algorithms are compared with cooperative subcarrier allocation algorithms with equal power allocation. It is observed in Figure 6.21 that by adding the power allocation step to the cooperative subcarrier allocation algorithm the throughput of the system can be increased by 8% for cooperative throughput-oriented subcarrier allocation, and 9% for cooperative fairness-oriented subcarrier allocation. This improvement is on top of the earlier reported 15% improvement over the non-cooperative subcarrier allocation. This implies that by implementing the two-step subcarrier and power allocation procedure it is possible to achieve up to 25% improvement in the total throughput of the system. Cooperative subcarrier allocation with equal power allocation performs very similar to cooperative subcarrier allocation with optimal power allocation when the relay is close to the mid-point of and , since the equal power allocation is the optimum solution

according to Figure 5.1 in Chapter 5.

6.5

Chapter Summary

In this chapter, the problem of subcarrier allocation in the downlink of an OFDM relaying system was formulated. Cooperation coefficient was introduced to quantify the level of cooperation between and in the relaying system. The cooperation coefficient was and and also the average SNR

defined as a function of the relaying channel between of -

channel. The probability density function (pdf) was derived for the cooperation

coefficient. Using the derived pdf for the cooperation coefficient, its mean and variance were found in closed-form. Cooperation coefficient and its mean were proposed to be used by modifying the objective value in the cooperative subcarrier allocation algorithm. The cooperative subcarrier allocation algorithm was shown to outperform the non-cooperative one for Max-Min and greedy subcarrier allocation algorithms. It was observed that by using the mean of cooperation

122

coefficient instead of its instantaneous value, the performance of the cooperative subcarrier allocation algorithm degrades comparably. Assuming an inaccurate estimate for the mean of cooperation coefficient, cooperative subcarrier allocation algorithm was simulated and shown to have a lower data rate than the case where we use the accurate mean value, but still better performance compared to the non-cooperative algorithms. We further proposed to use the results of the single-relay power allocation in the multi-user relay system. It was observed that we could improve the throughput of the cooperative subcarrier allocation by performing the power allocation prior to subcarrier allocation. The proposed two-step subcarrier and power allocation was shown to improve the throughput of the system by 25%. We can extend our work to other cooperation protocols and other relaying system models. Proportional data rates can be also considered and the performance of the cooperative algorithm can be evaluated. Other algorithms proposed for non-cooperative system can also be modified and applied to the proposed model and their performance can be investigated.

123

Chapter 7 Conclusions and Future Work
The success of wireless systems in supporting high-data-rate communications in a large commercial scale is strongly tied to the performance of resource allocation schemes. OFDM is the most reliable and flexible multiple access technique which supports dynamic allocation of resources, such as subcarriers and power, to the mobile users. The fourth generation of wireless communication systems are mostly based on OFDM and employ wireless relays to extend the coverage of the network. Therefore, we considered the subcarrier and power allocation in the downlink an OFDM relaying system to increase the efficiency of algorithms. This unified framework has not been considered for an OFDM relaying system that supports flexibility in fairness.

7.1

Conclusions

This dissertation focused on the subcarrier and power allocation in the downlink of a homogeneous OFDM relaying system with flexibility in fairness. By considering a suboptimal approach, the two-step subcarrier and power allocation was proposed for an OFDM relaying system. This approach is well accepted for subcarrier and power allocation of the noncooperative OFDM systems in the literature. To provide a trade-off between throughput and fairness in the system, an asymptotically fair subcarrier allocation algorithm was pro124

posed. By using the asymptotically fair algorithm, it is possible to control the fairness level in the system to achieve throughput improvement in the system. In Chapter 3, we proposed an asymptotically fair subcarrier allocation algorithm that realizes a variable fairness index by grouping the users in a non-cooperative OFDM system. Assuming similar fading characteristics of different mobile stations, we proposed to group the network users into equal-sized groups, and allocate the subcarriers in two steps: group subcarrier allocation and user subcarrier allocation. In group subcarrier allocation, a fairness-oriented algorithm was proposed to be used to assign the subcarriers to the groups. In user subcarrier allocation, a throughput-oriented algorithm was proposed to be used to assign the subcarriers to the users in each group. By adjusting the size of group, it is possible to maintain a trade-off between throughput and fairness in an OFDM system. We derived the expressions for average SNR, average BER and outage probability for for different relaying schemes in Chapter 4 for a basic system model composed on source, relay and destination. These performance metrics were compared for different relative relay locations and three different power allocation ratio. The optimization problem for optimum power allocation to the source and the relay was the focus of Chapter 5. We derived the closed-form expressions for optimum power ratio for an amplify-and-forward relaying scheme based on the objective function in the optimization process. It was shown that the allocated power ratio is not dependent on the objective function when the relay is closer to the destination. Having addressed the power allocation for a system with one relay, we investigated the subcarrier and power allocation for a multi-user OFDM relaying system in Chapter 6. we analyzed the capacity of an amplify-and-forward relaying scheme and introduced cooperation coefficient as parameter that quantifies the cooperation level of the relay station in the data rate of the mobile station. By using the concept of cooperation coefficient, the cooperative subcarrier allocation was proposed and shown to outperform the non-cooperative subcarrier allocation. Availability of the cooperation coefficient requires the availability of RS-MS

125

channel at the base stations which is the main drawback of the proposed algorithm. Mean of cooperation coefficient was proposed to be used instead of its instantaneous value to eliminate the requirement for the availability of the instantaneous RS-MS channel at the base station. The statistics of cooperation coefficient was analyzed and its mean and variance were derived as a function of the channel statistics. It was shown that the performance of cooperative subcarrier allocation algorithm by using the mean of cooperation coefficient degrades but still outperforms the non-cooperative subcarrier allocation algorithm. The closed-form power ratio derived in Chapter 5 were applied in the two-step cooperative subcarrier and power allocation. It was shown that by using the two-step procedure the throughput of the system increases compared to the equal power allocation.

7.2

Future Work

This dissertation addressed several resource allocation problems which are based on the homogeneous system model. However, the proposed algorithms and schemes do not rely on the number of relay stations or other system demographics. There are some relevant issues that can be investigated as the future work following the work in this dissertation. Throughout this work, we considered a homogenous system and proposed our algorithms based on the homogeneity of the system. For instance, in Chapter 4, all the users were assumed to have similar fading statistics. Grouping the users were proposed to be random for the asymptotically fair algorithm due to homogeneity of the users (same distance from the base station). Assuming a non-homogenous system is an idea worthy of further exploration. Grouping the users based on the channel characteristics might be an option while grouping the weak user with strong user is another point to consider for further investigation. It is also possible to employ the throughput-oriented for group subcarrier allocation and the fairness-oriented for the user subcarrier allocation. DF and EF relaying are other relaying schemes that are used in some cases. The

126

performance-based power allocation presented in Chapter 5 can be extended to other relaying schemes to compare the allocated power ratio for different relay locations. Similarly, the two-step subcarrier and power allocation in Chapter 6 can be considered for other relaying schemes in OFDM relaying systems. Non-homogeneous relay locations (and users) can be considered and cooperation coefficient can be used for assigning the relays to users and propose a three-step solution: relay, power and subcarrier allocation. The subcarrier and power allocation problem can also be explored for a cooperative system where the mobile users are grouped to cooperate.

127

List of Publications
1. H. Rasouli and A. Anpalagan, "A two-step subcarrier and power allocation in the downlink of an amplify-and-forward OFDM relaying system", Submitted to IEEE Transactions on Wireless Communications 2. H. Rasouli and A. Anpalagan, "Performance of power allocation schemes in an amplifyand-forward single-relay system with diversity at destination", Submitted to International Journal of Autonomous and Adaptive Communications (invited paper) 3. H. Rasouli and A. Anpalagan, "Space-time coded cooperative wireless communications" book chapter accepted by NOVA Publishers for a book titled Advances in Communications and Media Research, ISBN: 978-1-61324-794-5, 2011, 15 pages 4. H. Rasouli and A. Anpalagan, "Subcarrier allocation for a cooperative OFDM wireless system with grouped user", Wireless Personal Communications, pages 751-767, April 2010 5. H. Rasouli and A. Anpalagan, "Performance of power allocation schemes in a two-Hop AF relay system with faded direct link" IEEE International Wireless Communications and Mobile Computing Conference, pages 749-753, July 2011 6. H. Rasouli and A. Anpalagan, "An opportunistic subcarrier allocation algorithm based on cooperative coefficient for OFDM relaying systems" IEEE International Wireless Communications and Mobile Computing Conference, pages 178-183, July 2011 7. H. Rasouli and A. Anpalagan, "SNR-based vs. BER-based power allocation for an amplify-and-forward single-relay wireless system with MRC at destination", IEEE Queens Biennial Symposium on Communications, pages 429-432, May 2010 8. H. Rasouli and A. Anpalagan, "An asymptotically fair subcarrier allocation algorithm in OFDM systems", IEEE Vehicular Technology Conference, pages 1-5, April 2009 128

9. H. Rasouli, S. Sadr and A. Anpalagan, "A fair subcarrier allocation algorithm for cooperative wireless networks with grouped users", IEEE Global Communication Conference, pages 1-6, December 2008 10. H. Rasouli and A. Anpalagan, "A novel distributed space-time block coding protocol for cooperative wireless relay networks", IEEE Vehicular Technology Conference, pages 1-5, September 2008

129

Bibliography
[1] S. Hui and K. Yeung, "Challenges in the migration to 4G mobile systems," IEEE Communications Magazine, vol. 41, no. 12, pp. 54 ­ 59, Dec. 2003. [2] R. Pabst and et. al., "Relay-based deployment concepts for wireless and mobile broadband radio," IEEE Communications Magazine, vol. 42, no. 9, pp. 80­89, Sep. 2004. [3] J. G. Proakis, Digital Communications. McGraw-Hill, 2002. [4] W. Chung, N. August, and D. Ha, "Signaling and multiple access techniques for ultra wideband 4G wireless communication systems," IEEE Wireless Communications, vol. 12, no. 2, pp. 46 ­ 55, April 2005. [5] R. Berezdivin, R. Breinig, and R. Topp, "Next-generation wireless communications concepts and technologies," IEEE Communications Magazine, vol. 40, no. 3, pp. 108 ­ 116, March 2002. [6] M. W. et. al, "A conceptual study of OFDM-based multiple access schemes," Technical Report Tdoc 117/96, ETSI STC SMG2 meeting no 18, Helsinki, Finland, May 1996. [7] V. Tarokh, H. Jafarkhani, and A. Calderbank, "Space-time block coding for wireless communications: performance results," IEEE Journal on Selected Areas in Communications, vol. 17, no. 3, pp. 451­460, Mar. 1999.

130

[8] IEEE Standard, Revision of IEEE Std 802.16-2004, "IEEE standard for local and metropolitan area networks part 16: Air interface for broadband wireless access systems," May 2009. [9] IEEE Standard 802.16j-2009 (Amendment to IEEE Std 802.16-2009), "IEEE standard for local and metropolitan area networks part 16: Air interface for broadband wireless access systems amendment 1: Multiple relay specification," June 2009. [10] IEEE Standard 802.16m-2011(Amendment to IEEE Std 802.16-2009), "IEEE standard for local and metropolitan area networks part 16: Air interface for broadband wireless access systems amendment 3: Advanced air interface," May 2011. [11] D. Soldani and S. Dixit, "Wireless relays for broadband access," IEEE Communications Magazine, vol. 46, no. 3, pp. 58­66, Mar. 2008. [12] D. Tse and P. Viswanath, Fundamentals of Wireless Communication. University Press, 2005. [13] V. Tarokh, H. Jafarkhani, and A. Calderbank, "Space-time block codes from orthogonal design," IEEE Transactions on Information Theory, vol. 45, no. 5, pp. 1456­1467, Jul. 1999. [14] J. Boyer, D. Falconer, and H. Yanikomeroglu, "Multihop diversity in wireless relaying channels," IEEE Transactions on Communications, vol. 52, no. 10, pp. 1820­1830, Oct. 2004. [15] S. Peter and R. Heath, "The future of WIMAX: Multihop relaying with IEEE 802.16j," IEEE Communications Magazine, vol. 47, no. 1, pp. 104­111, Jan. 2009. [16] T. Cover and A. E. Gammel, "Capacity theorems for the relay channel," IEEE Transactions on Information Theory, vol. 22, no. 5, pp. 572­584, Sep. 1979. Cambridge

131

[17] V. Sreng, H. Yanikomeroglu, and D. D. Falconer, "Coverage enhancement through twohop rayleigh in cellular radio systems," IEEE Wireless Communications and Networking Conference, vol. 5, pp. 881­ 885, Mar. 2002. [18] A. Sendonaris, E. Erkip, and B. Aazhang, "Increasing uplink capacity via user cooperation diversity," IEEE Symposium on Information Theory, p. 156, Aug. 1998. [19] ----, "User cooperation diversity - part I: System description," IEEE Transactions on Communications, vol. 51, no. 11, pp. 1927­ 1938, Nov. 2003. [20] ----, "User cooperation diversity - part II: Implementation aspects and performance analysis," IEEE Transactions on Communications, vol. 51, no. 11, pp. 1939­ 1948, Nov. 2003. [21] Y. Yang, H. Hu, J. Xu, and G. Mao, "Relay technologies for WIMAX and lte-advanced mobile systems," IEEE Communications Magazine, vol. 47, no. 10, pp. 100­105, Oct. 2009. [22] R. Nabar, H. Bolcskei, and F. Kneubuhler, "Fading relay channels: Performance limits and space-time signal design," IEEE Journal on Selected Areas in communications, vol. 22, no. 6, pp. 1099 ­ 1109, Aug. 2004. [23] P. Anghel and M. Kaveh, "Multi-user space-time coding in cooperative network," IEEE ICASSP, vol. 4, pp. 73­76, Apr. 2003. [24] ----, "On the performance of distributed space-time coding systems with one and two non-regenerative relays," IEEE Transactions on Wireless Communications, vol. 5, no. 3, pp. 682­692, Mar. 2006. [25] H. Hu, H. Yanikomeroglu, D. D. Falconer, and S. Periyalwar, "Range extension without capacity penalty in cellular networks with digital fixed relays," IEEE GLOBECOM Conference, vol. 5, pp. 3053 ­ 3057, Nov./Dec. 2004. 132

[26] S. Ali, K. Lee, and V. Leung, "Dynamic resource allocation in OFDMA wireless metropolitan area networks [radio resource management and protocol engineering for IEEE 802.16]," IEEE Wireless Comunications, vol. 14, no. 1, pp. 6 ­ 13, Feb. 2007. [27] R. Knopp and P. Humblet, "Information capacity and power control in single-cell multiuser communications," IEEE International Conference on Communications, pp. 331­ 335, June 1995. [28] S. Boyd and L. Vandenberghe, Convex Optimization. 2004. [29] A. Goldsmith, "The capacity of downlink fading channels with variable rate and power," IEEE Trans. Veh. Technol., vol. 46, no. 3, pp. 569­580, August 1997. [30] Y. J. Zhang and K. B. Letaief, "Multiuser adaptive subcarrier-and-bit allocation with adaptive cell selection for OFDM systems," IEEE Transactions on Wireless Communications, vol. 3, no. 4, pp. 1566­1575, September 2004. [31] S. Sadr, A. Anpalagan, and K. Raahemifar, "Radio resource allocation algorithms for the downlink of multiuser OFDM communication systems," IEEE Communications Surveys and Tutorials, vol. 11, no. 3, pp. 92 ­ 106, Fall 2009. [32] K. B. Lataief and Y. J. Zhang, "Dynamic muliuser resource allocation and adaptation for wireless systems," IEEE Wireless Communications Magazine, vol. 13, no. 4, pp. 38­47, August 2006. [33] C. Y. Wong, R. S. Cheng, K. B. Letaief, and R. D. Murch, "Multiuser OFDM with adaptive subcarrier, bit and power allocation," IEEE Journal on Selected Areas in Communications, vol. 17, no. 10, pp. 1747­1758, October 1999. Campbidge University Press,

133

[34] W. Rhee and J. M. Cioffi, "Increase in capacity of multiuser OFDM system using dynamic subchannel allocation," Proc. IEEE International Vehicular Tehcnology Conference, vol. 2, pp. 1085­1089, May 2000. [35] J. Jang and K. B. Lee, "Transmit power adaptation for multiuser OFDM systems," IEEE Journal on Selected Areas in Communications, vol. 21, no. 2, pp. 171­178, February 2003. [36] S. Kim, X. Wang, and M. Madihian, "Optimal resource allocation in multi-hop OFDMA wireless networks with cooperative relay," IEEE Transactions on Wireless Communications, vol. 7, no. 5, pp. 1833 ­ 1838, May 2008. [37] S. Kadloor and R. Adve, "Relay selection and power allocation in cooperative cellular networks," IEEE Transactions on Wireless Communications, vol. 9, no. 5, pp. 1676 ­ 1685, May 2010. [38] Z. Hasan, E. Hossain, and V. Bhargava, "Resource allocation for multiuser OFDMAbased amplify-and-forward relay networks with selective relaying," IEEE International Conference on Communications, pp. 1 ­ 6, June 2011. [39] O. Duval, Z. Hasan, E. Hossain, F. Gagnon, and V. K. Bhargava, "Subcarrier selection and power allocation for amplify-and-forward relaying over OFDM links," IEEE Transactions on Wireless Communications, vol. 9, no. 4, p. 1293 1297, April 2010. [40] R. Kwak and J. Cioffi, "Fundamental power-allocation for cooperative relay networks," IEEE Communications Conference, pp. 1 ­ 5, June 2009. [41] M. Awad and X. Shen, "OFDMA based two-hop cooperative relay network resources allocation," International Conference on Communications, pp. 4414 ­ 4418, May 2008.

134

[42] Y. Ma, N. Yi, and R. Tafazolli, "Bit and power loading for OFDM-based three-node relaying communications," IEEE Transactions on Signal Processing, vol. 56, no. 7, pp. 3236 ­ 3247, July 2008. [43] M. Salem, A. Adinoyi, H. Yanikomeroglu, and Y. Kim, "Radio resource management in OFDMA-based cellular networks enhanced with fixed and nomadic relays," IEEE Wireless Communications and Networking Conference, pp. 533 ­ 544, April 2010. [44] T. S. Rappaort, Wireless communications: principles and practice. Prentice-Hall, 2002. [45] B. Saltzberg, "Performance of an efficient parallel data transmission system," IEEE Transaction on Communications, vol. 15, pp. 805­811, 1967. [46] H. Yin and S. Alamouti, "OFDMA: A broadband wireless access technology," IEEE Sarnoff Symposium, March 2006. [47] A. J. Goldsmith and S.-G. Chua, "Variable-rate variable-power mqam for fading channels," IEEE Transactions on Communications, vol. 45, no. 10, pp. 1218­1230, October 1997. [48] X. Liu, E. Chong, and N. Shroff, "Opportunistic transmission scheduling with resourcesharing constraints in wireless networks," IEEE Journal on Selected Areas in Communications, vol. 19, no. 10, pp. 2053 ­ 2064, Oct. 2001. [49] H. Schulze and C. Luders, Theory and Applications of OFDM and CDMA Wideband Wireless Communications. John Wiley, 2005. [50] G. Song, "Utility-based resource allocation and scheduling in OFDM-based wireless broadband networks," IEEE Comunication Magazine, vol. 43, no. 12, pp. 127 ­ 134, Dec. 2005. [51] G. Zhang, "Subcarrier and bit allocation for real-time services in multiuser OFDM systems," In IEEE Communications Society, vol. 5, pp. 2985­2989, June 2004. 135

[52] G. Song and Y. G. Li, "Adaptive subcarrier and power allocation in OFDM based on maximizing utility," Proc. of IEEE Vehicular Technology Conf., vol. 2, pp. 905­909, April 2003. [53] G. Song and Y. Li, "Adaptive resource allocation based on utility optimization in OFDM," IEEE GLOBCOM Conference, vol. 2, pp. 586 ­ 590, Dec. 2003. [54] G. Song and y. Li, "Cross-layer optimization for OFDM wireless networks-part I: theoretical framework," IEEE Transactions on Wireless Communications, vol. 4, no. 2, pp. 625 ­ 634, Mar. 2005. [55] ----, "Cross-layer optimization for OFDM wireless networks-part II: algorithm development," IEEE Transactions on Wireless Communications, vol. 4, no. 2, pp. 614 ­ 624, Mar. 2005. [56] Z. Shen, J. G. Andrews, and B. L. Evans, "Adaptive resource allocation in multiuser OFDM systems with proportional rate constraints," IEEE Transactions on Wireless Communications, vol. 4, no. 6, pp. 2726­2737, November 2005. [57] Z. Shen, Multiuser Resource Allocation in Multichannel Wireless Communication Systems. Ph.D. dissertation, Dept. Electrical and Computer Engineering, The University of Texas at Austin, 2006. [58] W. Kuo and W. Liao, "Utility-based resource in wireless networks," IEEE Transactions on Wireless Communications, vol. 6, no. 10, pp. 3600 ­ 3606, Oct. 2007. [59] P. S. Chow and J. M. Cioffi, "Bandwidth optimization for high speed data transmission over channels with severe intersymbol interference," Proc. IEEE Globecom, vol. 1, pp. 59­63, December 1992. [60] Y. Otani, S. Ohno, K. ann Donny Teo, and T. Hinamoto, "Subcarrier allocation for mulit-user OFDM system," Asia-Pasific Conference on Communications, October 2005. 136

[61] G. Aniba and S. Aissa, "Adaptive proportional fairness for packet scheduling in hsdpa," IEEE GLOBECOM, vol. 6, pp. 4033 ­ 4037, Dec. 2004. [62] L. Yang, M. Kang, and M. Alouini, "On the capacity-fairness tradeoff in multiuser diversity systems," IEEE Trans. Veh. Technol., vol. 56, no. 4, pp. 1901 ­ 1907, July 2007. [63] A. Papoulis and S. Pillai, Probablity, Random Variables, and Stochastic Processes. McGraw Hill, 2002. [64] M. O. Hasna and M.-S. Alouini, "End-to-end performance of transmission systems with relays over rayleigh-fading channels," IEEE Transactions on Wireless Communications, vol. 2, no. 6, pp. 1126­1131, November 2003. [65] P. Anghel and M. Kaveh, "Exact symbol error probability of a cooperative network in a rayleigh-fading environment," IEEE Transactions on Wireless Communications, vol. 3, no. 5, pp. 1416 ­ 1421, Sept. 2004. [66] S. Jingmei, Z. Qi, S. Chunju, W. Ying, Z. Zhang, and P. Zhang, "Adaptive optimal transmit power allocation for two-hop non-regenerative wireless relaying system," IEEE Vehicular Technology Conference, pp. 1213­1217, May 2004. [67] C. Conne and I. Kim, "Outage probability of multi-hop amplify-and-forward relay systems," IEEE Transactions on Wireless Communications, vol. 9, no. 3, pp. 1139 ­ 1149, March 2010. [68] M. Souryal and H. You, "Diversity performance of a practical non-coherent detect-andforward receiver," IEEE Global Communications Conference, pp. 1­6, Dec. 2008. [69] J. N. Laneman and G.W.Wornell, "Energy-efficient antenna-sharing and relaying for wireless networks," Proc. IEEE Wireless Communications and Networking Conference (WCNC), 2000. 137

[70] D. Chen and J. N. Laneman, "Modulation and demodulation for cooperative diversity in wireless systems," IEEE Transactions on Wireless Communications, vol. 5, no. 7, pp. 1785­1794, July 2006. [71] P. Liu and I.-M. Kim, "Average BER analysis for binary signallings in decode-andforward dissimilar cooperative diversity networks," IEEE Transactions on Wireless Communications, vol. 8, no. 8, pp. 3961­3968, August 2009. [72] K. G. Seddik and et. al., "Outage analysis and optimal power allocation for multinode relay networks," IEEE Transactions on Signal Processing, vol. 14, no. 6, pp. 377­380, June 2007. [73] X. Deng and A. M. Haimovich, "Power allocation for cooperative relaying in wireless networks," IEEE Transactions on Wireless Communications, vol. 9, no. 11, pp. 994­996, November 2005. [74] M. M. Fareed and M. Uusal, "BER-optimized power allocation for fading relay channels," IEEE Transactions on Wireless Communications, vol. 7, no. 6, pp. 2350­2359, June 2008. [75] M. O. Hasna and M.-S. Alouini, "Optimal power allocation for relayed transmissions over rayleigh-fading channels," IEEE Transactions on Wireless Communications, vol. 3, no. 6, pp. 1999­2004, November 2004. [76] Y. Jing and B. Hassibi, "Distributed space-time coding in wireless relay networks," IEEE Transactions on Wireless Communications, vol. 5, no. 12, pp. 3524­3536, Dec. 2006. [77] M. Abramovitz and I. Stegun, Handbook of Mathematical Functions with Formulas, Graphs, and Mathematical Tables. New York: Dover, 1970. [78] D. P. Bertsekas, Nonlinear Programming. Athena Scientific, 2nd ed., 1999.

138

