Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2009

The forward and inverse problems of magnetoacousto-electrical tomography (MAET)
Andrew Hrbek
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Atomic, Molecular and Optical Physics Commons Recommended Citation
Hrbek, Andrew, "The forward and inverse problems of magneto-acousto-electrical tomography (MAET)" (2009). Theses and dissertations. Paper 858.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

THE FORWARD AND INVERSE PROBLEMS OF MAG N ETO-ACOUSTO-ELECTRICAL TOMOGRAPHY (MAET)
by Andrew Hrbek BSc. Physics, University of Toronto, Toronto, Ontario, 2004 A thesis presented to Ryerson University in partial fulfillment of the requirements for the degree of Master of Science In the program of Biomedical Physics Toronto, Ontario, Canada, 2009 ©Andrew Hrbek, 2009

PROPERTY OF RYERSON UNIVERSITY LIBRARY

Author's Declaration

The Forward and Inverse Problems of

I hereby declare that I am the sole author of this thesis. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

Magneto-Acousto-Eiectrical Tomography (MAET)

MSc., Biomedical Physics, Ryerson University, Toronto, Canada, 2009

Andrew Hrbek

I further authorize Ryerson University to reproduce this thesis by photocopying or by
other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

Abstract

This thesis investigates a potential imaging method to provide high spatial resolution impedance information, known as Magneto-Acousto-Eiectrical Tomography (MAET). Both the forward and the inverse problems in MAET are explored by theoretical analysis and numerical simulations. The current density distribution that would exist in a sample if Andrew Hrbek a current were to be applied through the measurement electrodes or a coil is first mapped by applying the reciprocity theorem of electromagnetism. Once the current distribution is known, it is possible to calculate the conductivity from this current density by solving a system of ordinary differential equations for the conductivity. These are obtained by applying the method of characteristics on the relevant Maxwell's equations involving the conductivity.

ii

iii

Acknowledgements

Table of Contents
Author's Declaration ..........................................................................................................ii

I would like to thank Dr. Yuan Xu, who invited me to join his research team in the area of bioimpedance. He always offered some valuable words of wisdom to help guide me in the right direction and to avoid disaster. He would also share all of his knowledge, expertise, and time, often with enthusiasm. Any idea I had to suggest was always welcome, no matter how unlikely it was.

Abstract ............................................................................................................................iii Acknowledgements ..........................................................................................................iv Table of Contents ..............................................................................................................v List of Figures .................................................................................................................viii List of Appendices .............................................................................................................x

I appreciate having Dr. Carl Kumaradas and Dr. Vladislav Toronov as members of my graduate committee. Not only were they always willing to find the time in their busy schedules to attend my presentations on this research, but they also took the effort to advise me on how to improve it and make it more understandable. Symbols Used in the Thesis .............................................................................................xi Chapter 1 Background ..................................................................................................... 1

1.1 Electrical Impedance of Biological Tissue .................................................... 1 1.2 Electrical Impedance Imaging ..................................................................... 10
I also thank Dr. Jahan Tavakkoli and Dr. Carl Kumaradas for participating in my
defense committee. Their timely insight into how my thesis will be seen by the world at large was invaluable.

1.3 Magneto-Acousto-Eiectricai-Tomography (MAET) ..................................... 12
Hypothesis in MAET ..................................................................... 13 Chapter 2 The Forward Problem in MAET ..................................................................... 14

Special mention also goes to the graduate students, both present and past, the faculty and staff, and the undergraduate students in the Biomedical Physics undergraduate program for making my time at Ryerson memorable.

2.1 Theory ......................................................................................................... 14 2.1.1 Lorentz Force ..................................................................................... 14 2.1.2 Poynting's Theorem ...........................................................................22 2.1.3 Reciprocity Theorem ..........................................................................24

iv

v

3.2.3.1 Results ...................................................................................80 2.2 Methods .......................................................................... ······ ····················· .28 2.2.1 The Lead Field Current Density ......................................................... 28 2.2.1.1 Results ............................................. ~ ..................................... 33 2.2.1.2 Discussion ....................................................................... ····· .35 2.2.2 The Coil Field Current Density ........................................................... 35 2.2.2.1 Results ...................................................................................44 2.2.2.2 Discussion .............................................................................46 Chapter 3 The Inverse Problem in MAET ......................................................................47 3.1 Theory .............................................................................. ·· .. ······················· .4 7 3.1.1 The Method of Characteristics ...........................................................48 3.1.2 The Conductivity as the 'Energy' ....................................................... 50 3.1.3 Liouville's theorem .............................................................................51 3.2 Methods ........................................................................... ·... ·.. ······ .. ··········· .54 3.2.1 Poisson's equation ...................................................................... ······ .54 3.2.2 Faraday's Law and the Inverse for the Coil Field.·............................. 59 3.2.2.1 Results ...................................................................................61 3.2.2.2 Discussion .............................................................................74 3.2.3 Inverse for the Lead Field .................................................................. 74 3.2.3.2 Discussion .............................................................................90 Chapter 4 Discussion and Future Work .......................................................................... 91 4.1 Initial Conditions of the Conductivity ...........................................................91 4.2 Noise and Computational time ....................................................................92 4.3 Practical Considerations in the Resolution ................................................. 94 4.4 The Prospects of Three Dimensional Imaging ............................................ 94 4.5 Other Considerations ..................................................................................97 References ...................................................................................................................122

vi

vii

List of Figures

Figure 17 Reconstruction with constant conductivity initial conditions ........................... 85 Figure 18 Image obtained after 100 updates ..................................................................86

Figure 1 Lead field current density.................................................................................33 Figure 2 Magnitude of lead field current density.............................................................34 Figure 3 Coordinates used for current loop ....................................................................41 Figure 4 Plot of conductivity ............................................................................................44 Figure 5 Plot of coil field current density .........................................................................45 Figure 6 Linear conductivity trajectories .........................................................................63 Figure 7 Reconstructed conductivity for Figure 4 ........................................................... 64 Figure 8 Off-center Gaussian conductivity ......................................................................68 Figure 9 Scatterplot of conductive anomaly trajectories ................................................. 70 Figure 10 Gaussian conductivity reconstruction .............................................................71 Figure 11 Simulated phantom with homogeneous conductivity ...................................... 72 Figure 12 Reconstructed phantom .................................................................................73 Figure 13 Trajectories for lead field reconstruction ......................................................... 80 Figure 14 Happyface conductivity distribution ................................................................ 82 Figure 15 Reconstructed happyface conductivity ........................................................... 83 Figure 16 Forward problem with linear conductivity ....................................................... 84

Figure 19 Phantom with vertical conductivity variation ................................................... 87 Figure 20 Reconstructed phantom with vertical conductivity variation ........................... 87 Figure 21 Phantom with horizontal conductivity variation ............................................... 88 Figure 22 Error in the channel ........................................................................................89 Figure 23 Noise in the coil field reconstruction ...............................................................92 Figure 24 Noise in the lead field reconstruction ..............................................................93 Figure 25 Electric field at the ultrasound focus ............................................................. 120 Figure 26 Electric field at the ultrasound focal plane .................................................... 121

'/'

I

viii

ix

Appendices
Appendix A : Electrical Impedance Tomography (EIT) ................................................... 99 A.1 Introduction ..............................................................................99 A.2 Sheffield systems ..................................................................... 100 A.3 Physical motivation .................................................................. 101 A.4 Reciprocity and the Sensitivity matrix ........................................... 102 A.5 Optimization and Reconstruction ................................................ 104

Symbols Used as Variables and Operators
S~mbol

Descri12tion arbitrary units conductance capacitance permittivity distance conductivity area current density x,y,z components of the current density

A.U.

G

c
£

d
(]'

A
A.6 Conclusion .............................................................................. 108

J
Appendix 8 : Ultrasound ............................................................................................... 11 0 8.1 Thermodynamics of Ultrasound ............................................................ 11 0 8.2 Fluid Mechanics of Ultrasound .............................................................. 112 8.3 Focused Ultrasound .............................................................................. 118

Jx,Jy,Jz

E
I
v(subscript)

electric field current voltage identity matrix volume surface area element surface charge

I
Ill,

v

fzdS

s
Q

X

xi

(1J

angular frequency

D
)

electric field displacement variation operator delta function Kronecker delta permeability domain domain boundary unit normal to surface position, distance angle elliptic integrals Curve arbitrary constants rate of change of the listed variables with respect to a parameter s, used in Liouville's theorem.

complex part of a complex number, }
2

= -1

a
6(... )

y

admittance impedance resistance Lagrangian kinetic energy potential energy generalized coordinate (for the Lorentz force) time derivative of generalized coordinate mass velocity potential vector potential charge force

z
R
L

a

subscripts

f.-l

T

n an
" n

u
q

r,r
(},rp

. dq q=dt
m
v

K(k), E(k)

r
a,b,c

¢;
A
itJili

. dx . dy . dz x = ds 'y = ds 'z = ds ' . da . du . dp 0"=-,u=-,p=ds ds ds
H

e
I

F

Lyapunov function number density

B
H

magnetic field vector

N
magnetic field intensity

p

xii

xiii

r
J

curve of initial conditions Jacobian

Chapter 1. Background

r=dt
A" v

.

dy

rate of change of parametrized with respect tot, used in curve

r

the lead field reconstruction eigenvalue eigenvector radial trajectory length del operator partial derivative with respect to

1.1 Electrical Impedance of Biological Tissue

While electrical parameters have long been measured for every possible substance known, the need to consider the electrical behaviour of complex substances can arise from the interest in how well any modality which depends on these parameters will perform. Unlike pure substances, biological tissue is very heterogeneous in structure, and one can expect the electrical behaviour, a property of the material, to also exhibit complex behaviour [1 ,2].

l

v
at vu
~

t
subspaces of eigenvectors and

"

ui

vi

respectively

Biological tissue is organized into cells, which comprise 80°/o of the volume. Cells have a closed outer boundary, known as a membrane, which separates the extracellular fluid from the intracellular fluid. The extracellular fluid is the medium outside of the cell which contains mostly electrolytes and occupies the interstitial fluid between cells. The

o-. =A
l l

singular values entropy pressure adiabatic bulk modulus
~ s

s
"

intracellular fluid is the medium inside the cell and it contains the protoplasm that supports the organelles and the nucleus of the cell. As the intra- and extra- cellular fluids occupy the bulk of the biological tissue both within and between cells, it is the free ions in these fluids which then become the carriers of charge. For a fluid containing dissociated ions there will be charges contained in both

p

K
I
IIIII

s

=-VepJ av
'!afl

stress tensor wavenumber velocity potential

the cation (positive charge) and anions (negative charge). The ionic conductivity depends on the concentration, mobility, and degree of dissociation of the ions, as well as the temperature and viscosity of the fluid. For biological tissue, the most common

k
<I>

ions are sodium, potassium, calcium, and chloride.

xiv

1

Apart from the fluid phase, the other major influence in the conductivity of tissue is the cell membrane. It is a thin and elastic structure of proteins and lipids, 55o/o and 43°/o by composition respectively. The structure is that of the classic lipid bi-layer often shown in . texts on cell biology. The lipid molecules have a hydrophobic and a hydrophilic side, and in an aqueous environment the hydrophillic heads attract together and form two surfaces that orient towards both the intracellular fluids and extracellular fluids. In the region between these two surfaces are the hydrophobic ends of all the lipid molecules which bond together in a region devoid of water thus effectively separating the intracellular and extracellular fluids. The direct current conductivity of the membrane will be very poor as the ions, carriers of electrical current, cannot pass through the nonaqueous region contained in the lipid bilayer. This feature of the membrane is electrically equivalent to a capacitor. This is somewhat an oversimplified picture, as any living cell does need to pass substances through the membrane. To this end, various proteins are dispersed throughout the membrane to act as narrow channels to allow water and ions to pass through the membrane, effectively making the membrane more of a leaky capacitor. The cell membrane is an insulator, but it is also a dielectric as it is capable of being polarized by an external electric field. Although biological tissue is a very complex structure, a simple but effective model of biological tissue may be based upon the electrical behavior of the extracellular and intracellular fluids, as well as the cell membrane, using a conductance
G and capacitance C in parallel respectively. The quantities are defined as :

material relative to E 0 . These two values are customarily lumped together into a single factor E. A and d represent a simplified conversion of three dimensional field quantities

J, the current density, and E, the electric field, to the scalar quantities I,
= J · iiA,
where ii is the normal to A. Likewise, if a charge is accelerated

the current, and VI , the voltage. Over an area A , the current is the total flux of current density, I

by an electric field E over a distance d , then it has fallen through a potential

VI

-. --=E · d . Us1ng J =aE, the quantities may be rewritten as

I G = - and VI

CVI

= £E · iiA. The second result deserves some attention, since the electric field may = Q,
Q is the charge.
(j

also have a flux through A, and with Gauss' law on the right hand side CVI where

The electrical conductivity

is a macroscopic measure of the current density created in

a conductor when an electric field is applied. For biological tissue, the extracellular and intracellular fluids are the conductors,and the current density is due to the movement of ions. The permittivity is a measure of how much the electric field in the material is reduced from the free-space electric field. For insulators, the charges cannot move, but if the material is polar, then there will be charge distributions separated by some finite distance, called dipoles. An applied electric field will orient these dipoles so that they together generate an opposing field, and the net electric field in the insulator is then

G=

(jA

smaller than the free-space electric field by a factor of the relative permeability. In reality biological materials will contain both dipoles from bound charges and mobile

d
Where
(j

denotes the conductivity of the material, E 0 denotes the dielectric permittivity

charges although these two categories are by no means fixed, and a moving charge can be trapped by any heterogeneity and become a bound charge. Similarly, an

of free space and its value is 8.854e-12 F/m, and Er denotes the permittivity of the

2

3

arbitrary field may cause charges to separate, and with this polarization, act as a single large dipole. The macroscopic description of the electrical properties of tissue is simplistic but it is far more practical to do than the microscopic view as the latter would be very complicated due to the extreme heterogeneity found in biological tissue. admittance Y = : The two possible extremes of electrical behaviours may now be treated by using a simple circuit model with the capacitance in parallel with a resistance. In such a model, if a constant DC voltage is applied across such a circuit then a conduction current Icond
I

I= GV1

+ C dVI
dt

= (G + joC)V0 e 1ax. With the definitions of G
d

and C, the current is

now I

= (a+ j O£) · A V0 e 1ax, and as the ratio of current divided by voltage is an
=

(a-+ j ox::)· ~ . As far as material properties are concerned, the

complex value in the brackets may be considered as a complex valued conductivity:
(J'

+ j O£ . The admittance is a measure of the current carrying capability of a material,

= GVI

will flow, and a charge of

Q = cv/

will be stored in the capacitance. is applied to the circuit, with

which is useful if that material is conductive and a current source is applied. With such an arrangement, a nonzero current will produce some voltage drop along the path of the

Suppose now that a sinusoidal voltage V1 (t) an amplitude of

= V0 cos OJt

current. In other words, for some current and admittance, the voltage is the dependent variable. Another way to analyze the same problem is to consider how much current is produced for a given voltage. In this picture the material now limits the flow of a current with a given impedance. The impedance is the reciprocal of the admittance

V0 and angular frequency OJ = 21lj , in which

f

is the frequency of the

source. The charge on the 'plates' of the capacitance are now charging and discharging with a frequency of f. With alternating current there will be a flow of displacement current
Idisp

= dQ = C dV = -mCV0 sinOJt. By comparison, the conduction current is
1

Z

= y = J.

1

~

For a pure (real) resistance R this wouJd mean that R

1 =G . In this

dt

dt

I cond = GV0 cos OJt . Of course the total current flowing through the material will be the

model the impedance is given by Z

=

1
G+ joC
1

- - - · - , and the current-

1

d

a+jO£ A

.

dV1 sum I= I disp + Icond, or in terms of the circuit parameters, I= GV1 + C-- . The dt
conduction and displacement currents are out of phase by 90 degrees, as a result of the differences in the trigonometric functions. The better way express this phase difference is to use exponentials with complex arguments instead of trigonometric functions for the applied voltage. Instead, let V(t)

voltage relationship is given by VI

=

a+jO£ A

·!!.._I · . In terms of the resistance

R

'

the

impedance becomes Z =

·

1+ jmRC

R

= V0 e 1ax

in which j

2

= -1, in which the real part

In the model, the biological tissue behaves as a real resistance for low frequencies as there is negligible displacement current. The impedance is Z ~ R and the mat~rial is a conductor. As the frequency increases, the displacement current contributes more

takes on the physical relevance. The total current is now

4

5

significantly to the overall current, so the impedance will have more capacitive character. For most materials the conductivity adds to the polarization, but to a lesser extent. Although there is a minimal conductivity, the permittivity will be high.

a

and the permittivity £ are not constant, but In the MHz frequency range, another dispersion, known as

instead vary with frequency of the applied signal. This frequency dependence of the material properties is called dispersion, and biological tissue exhibits several different types of dispersions over a wide frequency range. Since the model accounts for both moving and fixed charges, one can analyze these dispersions in terms of dipoles and charge carriers. At low frequencies, the dipoles can easily align themselves in response to the applied field and the charge carriers, the ions, have a significant field to travel relatively larger distances. For the charge carriers, it is also more likely that they may become trapped at an interface or defect because of the longer possible path. As a result of this trapping, further polarization is created and in effect the conductivity will be low and the permittivity is high. At higher frequencies, the dipoles have less time to respond to a changing field, so it is

f3 -dispersion, takes place.

The cell membrane will still prevent most ions from flowing through, but fewer ions will become trapped there because the shorter half-cycle of the alternating field prevents them from travelling far. As a result, there are fewer bound charges to create an opposing field to the applied field and the polarization is smaller, and the applied field is now stronger within the cell. Polarization of any constituent molecules such as proteins will still occur and contribute more to the overall permittivity. It is in this region that the capacitive reactance of the membrane now begins to decrease and effectively short the membrane resistance. The relative magnitudes of the two types of current, displacement and conduction, are best seen as a ratio of the two,

1
disp

= 0£ . At the megahertz range, this ratio will be
(J

J cond
((£

more difficult for them to oppose the field, so their polarization effect disappears. For the free ions that carry charge, the field may change before they travel an appreciable distance, so that the length of their path is now shorter for each shorter half-cycle of signal. With smaller distances travelled by the charge carriers, the likelihood that they will become trapped and contribute to the permittivity diminishes. Since the ions still are
> 1Ut 1

very small compared to unity, (J

<< 1, even though the relative permittivity may high.

For frequencies up to the MHz range, biological tissue is primarily conductive, and treating it electrically like a real resistance is justified. Tissue is a very inhomogeneous structure, and because of this it is difficult to make consistent measurements of its electrical properties. At low frequencies, cells may be considered as insulators suspended in a conductive fluid, but at higher frequencies, such as the MHz range, the membrane reactance becomes lower so that the dispersion in the membrane and the interior of the cell must now be accounted for. Also, the tissue itself may contain several different kinds of cells, each with their own electrical properties, all together within an extracellular matrix which may also have its own electrical behaviour. Unlike a standardized sample of single and identical cells, living

able to move, the conductivity increases, as fewer of them become trapped. The dispersion that occurs at frequencies below 1OkHz is called a -dispersion, and it is a result of free ions becoming trapped at interfaces, or cell membranes, and creating significant polarization due to the trapping of ions of both charges. Any dipoles are able to readily orient themselves and thus create an opposing field to the signal which also

6

7

tissue will have even more complicated behaviour as it may be an integral component of several systems, such as the cardiovascular or nervous system. Some tissues also have anisotropic behaviour in that the dielectric and conductive quantities are dependent on direction. This occurs in muscle or bone, for example, in which the forces act predominantly in one direction, so the tissue is able to accommodate this anisotropy in its normal function. As a result, the conductivity along a cell in muscle fiber may be more than the conductivity of adjacent cells. The anisotropy of tissue will still be dependent on frequency, and especially so if the effect is due to cell membranes, which at higher frequencies will exhibit a lower reactance and a corresponding decrease in the direction dependence. The anisotropy is just one physiological trait of certain tissues that may be detected with a change in conductivity. Often another factor in the conductivity is the water content. Fat is a poor conductor in comparison to muscle, and any change in the relative compositions in these two substances will lead to a significant change in the conductivity. This would lead to the conclusion that the conductivity is dependent on the concentration of fluid in the material. On one side of the conductivity spectrum is blood, which is almost entirely liquid and very conductive, and on the other side is skin or fat which make relatively poor conductors. Skin in particular, is also very inhomogeneous, and it consists of three layers called the epidermis, dermis, and subcutaneous tissue and its main purpose is to protect the body from the environment. Of these, it is the epidermis, which is the outermost layer and composed of dead cells, that poses the
' lilt

reasoning may now be expanded to whether differences in the physiology of the same tissue may now be differentiated according to differences in impedance. Detecting these variations can determine the presence of a tumor, which is an abnormal growth of tissue surrounded by normal healthy tissues. It has no useful function and grows to the detriment of the normal biological environment around it. With a background of a known conductivity ranges for healthy tissue, a localized region of higher conductivity due to the cancer may be visible in an otherwise lower-conducting tissue, for example. A study by Smith on tumor liver tissue showed a considerable difference in the electrical properties between healthy and normal tissues. Tumor conductivity was found to be 67.5 times higher than that of the normal liver, and the permittivity was 2-5 times higher. For such an increase in conductivity, it is likely that the tumor will have a higher water content. The relative difference in the electrical properties between tissue and tumor will depend on the type of tissue as well as the stage of the tumor itself, as both factors will influence the amounts and distributions of biological conductors and insulators, so it may not be possible to generalize these results. Even so, there has been considerable work done so far to develop devices that may be used to determine the electrical conductivity of biological tissue so that this phenomenon may be better understood and detected.

greatest resistance making it a very effective insulator near DC especially when dry. One item of great interest is the possibility of using impedance measurements for the non-invasive measurements of the physiological changes and differences in tissues. Given that there are many different tissues each with their own structures and electrical properties, one can imagine that impedance measurements would be able to reconstruct these differences and offer a view of these relative variations. The

8

9

1.2 Electrical Impedance Imaging

A later imaging modality, known as MREIT [3] (magnetic resonance electrical impedance tomography), was designed to overcome the ill-posed ness in the reconstruction that plagued EIT. It makes use of MRI (Magnetic Resonance Imaging) in

Any electrical impedance imaging device will apply some current or voltage to the object of interest. The electrical properties, being the conductivity and the permittivity are then inferred from measurements of the electromagnetic quantities elsewhere in the material which are the response to the applied field. In principle, this method of imaging is safe and makes use of easily available technology, so it is no surprise that it is the subject of considerable research interest for clinical application. The established and documented techniques in impedance measurement to date are electrical impedance tomography (EIT), magnetic resonance electrical impedance tomography (MREIT), and magnetic induction tomography (MIT). Historically, the first impedance images were done using EIT (electrical impedance tomography). (see appendix A for a full account). Typically, sixteen electrodes are placed about the circumference of a patient for Sheffield systems, the standard model for this device. For each set of measurements, current is injected in any two adjacent electrodes while voltage measurements are taken from the remaining fourteen. Then the current source is shifted to the next pair of electrodes with which the voltages are collected from the remaining electrodes, and the cycle continues until all adjacent pairs of electrodes have been used as a current source. The conductivity is obtained from the transfer impedance derived from these voltage measurements for a given current configuration. The major drawback to this method is known as the ill-posed ness of the inverse problem. The finite sets of measurements, which are confined to the boundary of the test subject, severely limit the spatial resolution possible. There are other problems including errors in the placement of electrodes, as well as the insensitivity of the electrode voltages to a change in conductivity deep in the interior of the object.

conjunction with a injected currents. These currents will produce an induced magnetic flux within the object which is synchronized with the MR imaging pulse sequence. If two currents in two different directions are injected in sequence, then by using the magnetic flux densities, a cross-sectional image of conductivity distribution may be obtained. A high spatial resolution may be obtained in this image using an additional boundary voltage measurement. One major disadvantage to this technique is the high costs associated with the MRI, as well as the shielding effect from the electrodes. Unlike the previous two techniques, MIT [4] does not require any direct physical contact of the sensors to the object that is to be imaged. Instead, a magnetic field is applied from one or more generator coils to induce eddy currents in the study object, so that the region of interest is penetrated with an oscillating magnetic field. The primary field generated by the exciting coil as well as the secondary field created by the induced eddy currents are then detected by another set of coils known as receiving coils. The manner in which the measurements are taken is similar to EIT. For example, if there are n measurement coils and m excitation coils per layer, forming a ring, then the total number of measurements possible is m(n-1) if every coil about the circumference is an excitation coil once. Unlike EIT, MIT can also measure the permeability of the material in addition to the conductivity. The measurements are performed in a manner similar to EIT with its electrodes now replaced by exciting and receiving coils, and the inverse problem is also nonlinear and ill-posed. The resulting conductivity image from this technique also has a poor resolution.

10

11

1.3 Magneto-Acousto-Eiectricai-Tomography (MAET)

inverse problem (are the signals or measurements sufficient to reconstruct the conductivity). The current investigation of the feasibility of MAET has two components: experiment and theory. This thesis investigates the theoretical aspects of MAET and

Given the present state of devices intended for imaging electrical properties and their capabilities, there is still no commercial device capable of producing high-resolution images of the conductivity. Continuing research may hopefully develop one that will find use in the future. One potential imaging method for current density and electrical impedance is known as MAET (Magneto-Acousto-Eiectro-Tomography),[5,6] and it relies on the action of ultrasound in a static magnetic field to image the electrical properties of tissue. This idea has already been reported in the literature by other authors, notably by Han Wen [7], although in his paper it was referred to as Hall Effect Imaging. An ultrasonic pulse is transmitted into a sample in a direction perpendicular to the magnetic field. Charged particles in the medium are displaced by the acoustic vibration, and since they are moving in a magnetic field, experience the Lorentz force. As the material is itself neutral because it is composed of equal numbers of positive and negative charges, then these charges are separated and a voltage signal is produced on the surface of the sample. As the ultrasound wave propagates through the sample, the time-varying voltage signal represents the degree to which the charges separate along the signal path. Unlike EIT, in which the signal source is confined to the surface of the sample, the sound beam may be swept throughout the sample. Provided that the magnetic field is always
,1 11 ,

compares its predictions to the experimental findings when possible. This thesis also investigates the inverse problem of the modality, which is an important part of its feasibility.

Hypothesis in MAET

The hypothesis behind MAET is essentially two-fold, both of which are addressed in the thesis: The first hypothesis is that the lead field current density or the coil field current density may be mapped pointwise, at least to a good approximation in a volume conductor. The validation of this hypothesis is largely experimental, but there are some theoretical considerations also, owing to the application of the reciprocity theorem of electromagnetism in experimental work and its justification of the simulations to which the experimental results were compared. The first hypothesis is the motivation behind the forward problem. The second hypothesis, which is the feasibility of obtaining the conductivity once the lead or coil field current density is known, will be addressed in more detail when the inverse problem is introduced.

present, this source of EMF has been compared to a moving battery. As an ultrasound is being used to ultimately drive an electrical signal at the output, it is assumed that the resolution similar to that from ultrasound may be obtained in MAET. Although Wen's paper [7], upon which MAET is based, promises two or three dimensional conductivity images with Hall Effect Imaging there is only a brief derivation of the forward problem (the physics needed to get a signal) and no mention of the

12

13

Chapter 2 The Forward Problem in MAET

differentiated with respect to a function similar to the way an ordinary function can be differentiated with respect to an independent variable. The first variation of the Lagrangian under the integral sign is:

2.1 Theory

o fut = r(aL &J +a~ &JJdt.

Jl dq

dq

The theory behind the forward problem in MAET is presented here. It is based on classical electrodynamics. The topics are the Lorentz force, Poynting's theorem, and the reciprocity theorem in electromagnetics as a background to the analysis of the forward problem. Notice that &j =

J dqJ == !!_(&]).Using integration by parts, vl dt dt

2.1.1 Lorentz Force

Since it is the path of least time that is being solved for, the function q is varied only within the interval, and it is fixed at either endpoint,

&j lbdy == 0.

Now

MAET depends on the Lorentz force acting upon moving ions to generate a signal. It is the critical component in this modality. Its importance merits this section, devoted to the derivation of the Lorentz force and its consequences.

Jloq dt

r( ~~J!!_(&J )dt = Jlaq r( a~J(&i )dt =- f!!_(a~J(&J )dt dt iJq
8 JLdt,

which may be substituted into the expression for The familiar expression for the Lorentz force may be obtained through the first variation of the Lagrangian function as popularized by Lanczos [12]. The Langrangian is defined
ih

I

as L == T- U, which is the difference between kinetic and potential energies, T and U respectively. It is the integral JLdt with which the first variation is taken to zero, commonly denoted as If the variation in q,

d (dLJ &j - -. &j J dt = 0 . f8Ldt == ~-dL dq dt dq

8 Ldt == 0. The assumption here is that L == L( q, q), and it is a
dL _ !!_(dLJ == O. dq dt dq

J

&j,

is zero, then the Euler-Lagrange equation is obtained:

functional of q == q(t) and q == q(t), which are independent coordinates. Unlike ordinary derivatives, the

8 operation acts only on functionals,

but a functional may be

14

15

The Euler-Lagrange equation may be used to obtain the Lorentz force. A few preliminaries must be done first. More generally, a position q a and a velocity each have three components determined by the value of the index, which is

qa

For two independent vectors can

qa

and

qf3

from any orthogonal coordinate system, their

a == 1,2,3 .

Jacobian is the Kronecker delta

aq/3

a· ~a == 8a/3 .

In the problem of ions in a magnetic field, the velocity of the moving ions is much

1 smaller than the speed of light, so the kinetic energy is just T == - mq aii a, where m is 2
the particle mass. The summation convention is used for repeating indices within a term unless otherwise noted. This means that

Using this result the conjugate momentum is obtained:

iiaiia == q1q1 +q 2q2 +q 3q3.
The other derivative of the Lagrangian is just with respect to the generalized coordinate:

Two possible potentials on a test charge e are caused by electric and magnetic fields in the form of a scalar potential ¢ and a vector potential is U ==

Aa. Following [13], this potential

aL a¢ a (. a¢ (. aAa aqa -==-e-+eq A ) ==-e-+e q +A ) aq/3 aq/3 aq/3 a a aq/3 a aq/3 aq/3 a .
The Euler-Lagrange equation was derived under the assumption that positions and velocities were independent coordinates, and a simplifying assumption which may be used here is q a == 0. The assumption is a uniform velocity. The expression for

e¢- eqaAa, which is dependent on both the positions and velocities. The

Lagrangian is [see 14]:

a·

__!__
aq/3

a

is

aq/3
If the generalized coordinates are vectors, the Euler-Lagrange equation becomes: now:

aL d [ ar O aq/3 - dt aq/3 - .
Ill

J_

- - == -e-- + eq a--.

aL

a¢

.

aAa aq/3

aq/3

aq/3

The derivatives of the Lagrangian with vectors are its gradients:

The last term evaluates to familiar expressions of vector identities using tensor calculus [15],

iia-a == q · V ~/3 + qx VxA /3' aq/3

aA

(- - )

(-

(_

_))

16

17

where each term is the

fJ -th

component of the corresponding vector. The time the vector potential is related to the magnetic flux density by Law in terms of the vector potential is:

derivative of the conjugate momentum is the force:

B == V x A, and Faraday's

d ( (JL dA13 dt dqp =mqp+edt.

J .. J

Vx E+af ==0.

- (- aAJ

dL == dL By the Euler-Lagrange equation, -d ( --.-. 1t follows that
dt dqp dqp

Since this curl is zero, then it is the curl of a scalar potential -

VtjJ = E + aA.
dt

The Lorentz force may now be expressed in terms of the electric field

The total time derivative of the vector potential is

dA aA (--: -)-==-+ q·VA,
dt dt
which may be substituted into the equation for force, along with changing tensor indices to vector notation:

and the magnetic flux density

B == Vx A:

This result is valid for the small velocities in MAET, and it is by no means a fundamental or given equation in electrodynamics. It is a geodesic, or a path of least time, for a

- == -eV¢-e-+e aA (vx (-)) , F VxA
dt
that
lh

. charged particle traversing arbitrary electric and magnetic potentials. The Lorentz force acts on moving charges, and the velocity is assumed uniform, which is not strictly the case with MAET since the oscillatory velocity is alternating direction by accelerating. However, if the charge separation has a smaller timescale than the change in velocity, then a uniform velocity during the charge separation is justified. If the force on a charge is force

q is a velocity and in ordinary coordinates, may be represented with v .

Recalling Faraday's Law of induction,

- - as VxE==--

F ==eli+ (v x B)J , then it may be considered identical to the

dt'

F == eE' created by a new field £' == E + (v x B).The electric field seen by an

observer moving with the charge (the rest frame) is E, but the electric field seen acting

18

19

on the charge by an observer in the lab frame will be

£' = E + (v x B), for small

Returning to the expression for the electric field for MAET which is there are two terms. The first, The second,

£'

=-V¢ +

(v x B),

velocities compared to the speed of light. For MAET, it is the current density that is of great importance:

V¢

is the conservative term, and it is due to charges.

vx B

is a non-conservative term, otherwise known as an impressed field.

By virtue of charge separation, In MAET, the interaction between the fluid mechanics associated with ultrasound and

V¢ alone cannot maintain any steady current, but

when a forcing electric field is applied, such as

vx B, then a current may be

-· = - V -¢+( the resulting electric field E
linked by the velocity

-) for a static magnetic field with -aA. = 0 is vx B
dt

maintained, since this field regenerates charge lost to conduction. Any accumulated electrostatic charge that contributes to the gradient of the scalar potential always be modified by the impressed field. In the next section, a theorem will be developed known as the reciprocity theorem in electromagnetism. With reciprocity applied to MAET, a current at surface electrodes is assumed to be injected into a phantom, known as the lead field. The voltage at the

V¢, may

v. A simulation was done (see appendix B) to explore the finite

dimensions of a realistic ultrasound focus as well as any effects of its wave nature on the induced electric field. A direct simulation reveals more details, although such an approach is also computationally time-consuming. This variational approach used to derive the Lorentz force is open to at least two extensions. In this case, the trajectory of a single charged particle was only considered, but in a real fluid there will be an immense number of them. Also, the issue of conductivity was not addressed, but its effects may be included as a term in the Lagrangian which decreases the kinetic energy of the particle and is both position and velocity dependent. As the conductivity increases, less kinetic energy is lost to friction, and as the conductivity decreases more kinetic energy is lost. The Lorentz force would then include a damping term representing this friction, which is inversely related to the conductivity. Once the damping factor to the Lorentz force is included, the next step
/h

leads is then proportional to the inner product of this current density with those of the impressed field

vx B produced at the ultrasound focus. While the lead field current

density may now be more easily visualized over the entire phantom, it is done at the expense of including any wave properties from the contribution of the ultrasound since the lead field current density is now mapped point-wise.

would be to find the Hamiltonian from the Lagrangian by using a Legendre transform, and then extending this Hamiltonian to an ensemble of particles. This approach, not yet attempted, will lead to a statistical mechanics interpretation of the conductivity for dissociated ions, and for now it remains only a possible avenue in further work.

20

21

2.1:2 Poynting's Theorem

The two previous equations may be added: Poynting's Theorem will be derived in this section. It is a statement of the conservation of energy of an electromagnetic field in the form of a continuity equation [13]. Its derivation is also the basis of how the reciprocity theorem is derived from Maxwell's equations. The only difference between the two theorems is that Poynting's theorem involves one field, whereas the reciprocity theorem involves two independent fields. The energy in an electromagnetic field is a critical point in the analysis of the forward problem in MAET, because the reciprocity theorem in electromagnetism allows a simpler forward model with fewer computational demands at the expense of neglecting the wave properties of ultrasound. The derivation of Poynting's theorem begins with Faraday's law and Ampere's law. The identity:

E. atjj + fi. atf3 =E. (v X fi )- fi. (v x£)- J. E
The left hand side may be grouped as a single time derivative:

_l_a 1 (cE ·E + flli· ii)= E · (Vxii)- ii ·(Vxi)-J. E.
2

E. (vxfi)-fi. (vx£)= -V. (ffxfi)
may be substituted into the previous equation, to get Poynting's theorem:

Vx E = -a 1 B (Faraday's Law)
V X fi = J +a 1 D (Ampere's Law)
The vector Ex H is the Poynting vector, which is a flux of energy into (or out of) a Together with the relations for the material:

- B=JIH
D=t:E
111 ,,

control volume which contains a density of energy ££ 2

+ JIH 2 . The term

] .

E

represents power dissipated by a current. For oscillations in the frequency domain, the time derivative is replaced by a factor of j OJ and the following is obtained :

The inner product of Faraday's Law may be taken with H:

Jm(c£ ·E+ flli·ii)+ v·(.Exii)= -1.£.

The inner product of Ampere's Law may be taken with E:

22

23

2.1.3 The Reciprocity Theorem

Poynting's theorem leads to a continuity equation of the energy of the electromagnetic field, and the flux vector Ex fi is known as the Poynting vector. So far, all that has been considered is the energy as an inner product of two electric field vectors These two equations may then be added together to form.

E and
Using the constitutive relations Ba = JlaH a and Db = £bEb on the left hand side of the previous equation leads to:

two magnetic field vectors H both from the same field . This concept of energy may now be generalized into inner products for two independent fields Ea fi a ,and Eb fibto what is known as the reciprocity theorem [16]. Consider Faraday's Law for field a and Ampere's Law for field b:

Assuming a single frequency of oscillation for each field using the frequency domain eliminates the derivatives with respect to time leads to:

With two fields, there are now four possible sets of constitutive relations defined for each field.

j(J)af1aiib . ii a + j(J)b£bEa . Eb = Ea . (v xiib )-fib . (v X Ea )- ] b . Ea.
The right hand side may be simplified by the identity:

This simplification leads to:

ill .,,

The left hand side may be simplified by assuming a common frequency of oscillation OJ to each field, using OJa = OJb =OJ leads to: The inner product of Faraday's Law for field a may be taken with fib, and the inner product of Ampere's Law for field b may be taken with

Ea:

24

25

For both fields, the material properties are the same,

fla = flb = /1

and

£a = £b = £,

because the independent fields exist in the same material in question:

fJb.E;a -]a ·EbdV=O.
n
In reciprocity, the field quantities which are actually used in the above integral are referred to as impressed fields, otherwise known as non-conservative fields which are

}m(pHb · Ha +££a · Eb) = -V · (Ea X fib)- Jb · Ea ·
Another equation may easily be obtained by interchanging the a and b indices, since Ampere's Law could have been used for field a and Faraday's Law could have been used for field b :

not the result of charges, but they serve to alter the distribution of charges. Recalling the expression for the total electric field derived from the Lorentz force:

E;' =-V¢+(vxli)
The conservative term is Subtraction of the last two equations leads to

V¢, and the non-conservative, or impressed term, is

(v x B). Being an inner product between an electric field and a current density, the
physical quantity present in the reciprocity theorem is that of power dissipation, which implies a flow of current. A steady current may only be produced in the presence of non-

or by considering the conductivities aa and ab which relate the current densities

conservative fields, so their use is justified. Having arrived the final form of the reciprocity theorem in electromagnetism, it is now possible to examine the forward problem of MAET, which is the current density produced with a known conductivity.

Ja = aaEa

and

Jb = abEb:

V· (E aX Hb)- V· (E bX Ha)+ (jbEb· Ea- (jaEa· Eb = 0 ·
Since the material is the same for both fields, for consistency both conductivities must be the same a a = ab =a. The reciprocity becomes:

V ·(E a X Hb)- V· (EbX Ha ) = 0 ,
111 .,

and

The last expression may be integrated over the entire domain of the material:

26

27

2.2 Methods
The conductivity (J' is interchangeable and it may be multiplied with E 1ead instead

ofE focus :
The 'reciprocity theorem is the chosen method of analysis in MAET for its simplicity. It will be applied towards two special cases of MAET. The first case uses electrodes for measurement and consequently involves a lead field current density, and the second case which uses a pickup coil and consequently involves a coil field current density.

I
Q

] lead .

(vX B)- E focus . (J'Elead d V = 0' or
B)- E focus · ] lead d V
= 0·

f ] lead · (V X
Q

2.2.1 The Lead Field Current Density

The electric field at the focus,

v x B, may be expressed is as the negative gradient

-v

¢ focus

of a potential

¢ focus :

Consider two fields, one designated with a subscript lead , and the other denoted with a subscript focus to distinguish them. For the purposes of measurement, it is the lead field J 1ead which is the current that would be produced in the volume if there were a current source applied at leads located on the boundary. In reality, these leads are used lated to the current density J 1ead . The real source of emf, or to measure a voltage re. electromotive force, is the field E focus , the electric field produced at the focus of the ultrasound. Using these quantities in the reciprocity theorem leads to:

I
Q

] lead ·

(v X B)+ V¢ focus · ] lead dV = 0 ·
'f/ ocus

The second term may be rearranged as a divergence of

A.fi

]

lead ·

·

JV
Q

0

(tfJfocuJ /ead }iv = f¢focus
Q

V Jlead dV + JV t/Jfocus
0

0

J lead d V

o

Q

Before continuing with the reciprocity theorem, more needs to be known about ] Consider Ampere's Law:

lead ·

V X H1ead

= ]

1 ea

d

+a t 151ead ·

''I

fJlead · E focus - J focus · E lead dV
Q

=0 ·
The divergence of Ampere's Law is zero :

. In MAET,

Efocus = vX B is the impressed electric field at the ultrasound focus:
f J lead · (V X
Q

V . (V X fi lead ) = V . (Jlead + a t 15/ead ) = 0 ·
Assume that ]lead

B)- J focus · E lead dV = 0 ·

= (J'Elead

and a t jjlead

= }OJ£Elead , then in the frequency domain:

28

29

V· (Jlead + at fJ lead ) == O'Elead + JOJ£Elead
Using the assumption that 0' >> j

== ((J + JOJ£)£lead

tjJfocus (r2 ) - tjJfocus(~) measures only those components of
those of

Jlead

that coincide with

OJ£

in MAET, which operates in the MHz range of

v x B in that region. In the extreme case, if the only nonzero component of

frequencies, along with negligible permittivity contributions in that frequency range, Ampere's Law simplifies to:

vx [3 is the x-component, and in addition it is a delta function, then the potential
difference ¢focus (r2 ) - ¢focus (fi) will provide a point-wise evaluation of the x-component of ]lead at the focus. This is the idea behind the experimental determination of the lead field current density. In general, the reciprocity theorem also justifies the numerical simulations of this current density as a verification of experimental results, although

v.
Returning to:

(Jlead

+a tjjlead) == v. ]lead

== 0.

n
if

JV ·

(¢focus]lead

)dv == J¢focus V ·]leaddV + JV ¢focus· ]leaddV'
n n
focus]lead

experimental results to date have only obtained a single component of the lead field current density. In this case a simulation may be done for the entire lead field current density, and from the results, only a single component may be singled out.

V

·]lead

== 0 then

n

JV ·(¢

}tv == JV ¢focus
n
focus]lead

· ]leaddV ·

The solution of the forward problem for the lead field current density with a known

But by the divergence theorem

n

JV ·(¢

)dv == J ¢focus]lead · iidS ·
an

conductivity 0', consists of solving :

V· J lead
an
with insulating boundary conditions:
] lead .

== 0 '

The reciprocity theorem now becomes

J]lead · (v X B)dv == - J ¢focus]Zead · iidS .
n

For a point source at the surface: ]lead

==I0 [8(r- ~)- 8(r- r2 )]n

n== 0 '

on the surface, the final result for unit injected current represented by I 0 == 1 is:

as the current density is contained only in the domain. The lead field may be solved for from Poisson's equation since
J lead

J]lead · (v X B}tv == ¢focus (r2)---¢focus(~)
n
If the emf, which is

== -oV ¢lead '

vx B, is only highly localized at the focus and zero everywhere

and the divergence of the current density is:

else. The integral becomes a distribution in which the voltage output

V ·]lead == -V · oV ¢lead

== 0 ·

30

31

The boundary conditions are of the Neumann type since the current density is proportional to the gradient of the potential,

2.2.1.1 Results

since

an is the gradient normal to the surface of the domain.

The COMSOL simulations of J 1ead in Figures 1 and 2 were compared to experimental measurements of the lead field current density obtained from the actual MAET setup.

In practice, Poisson's equation is best solved using COMSOL, a finite element method software package, which is ideal for solving partial differential equations. It is a very versatile tool for visualizing solutions of a wide range of these equations with modest hardware and software requirements. It is also user-friendly, and indeed all of the work done in COMSOL for this thesis was done using its graphical user interface.
"§'
Streamline Plot of the Lead Field Current Density
Max: 2.91

]lead

is the current density which arises from a current density caused by a current
:::)

2

·c:
u

--~
ID

injected into the domain. It is an impressed field, yet it may be solved through electrostatics. The rationale is that in a purely electrostatic problem, the opposing but mobile charges would temporarily create a current in a conductor, and with conduction the field would eventually go to zero as the numbers of free charges decrease. In the
-5
-4
-3

::!.
"' ')(
<:(

·c:
ro

.3
0)

2!
1.5
' iii

'ii
1
-2
-1

>

t: (I)
1

u

c

Q.l

D

'E
~
(.)

~

0

1

2

3

4

5

case of an impressed field, the sources may be charges, but the charge density is fixed
Horizontal Axis (A.U.)

a; i.L
tv
Q.\ _J

-o -o

to maintain a constant field. The governing equation is

V·]lead = 0, and it holds true

05

for charge free space. In practice, to incorporate sources from a charge density, Ampere's Law must be modified for two point sources of opposite sign which may be represented as delta functions:
l ol.

v.

]lead

= 8(r- r;)- 8(r- r2)

Min: 1.1~9

The electrodes in this model are assumed to have a point sized region of contact which maintains a constant charge density, and these source terms to the divergence may be represented in COMSOL as the weak form.

Figure 1. Lead field current density in a phantom-shaped domain represented as streamlines. The point of contact of the electrodes is represented as a point source at either end of the domain. The intensity of the horizontal component of the current density peaks within the channel. The experimentally determined current density may be compared to this model.

32

33

The models from COMSOL, also have another use, which is to test the inverse problem of finding the conductivity from the lead field current density. This will be addressed in the latter part of the thesis. The experimental determination of the lead field current density was done by Syed Haider in his thesis [24]. Phantoms with uniform conductivity were used in the actual MAET setup, and the results were compared with these simulations.

2.2.1.2 Discussion

The lead field current may be obtained reliably for an arbitrary domain with modest computational requirements. The current density is obtained from the solution of Poisson's equation with Neumann boundary conditions which is a well-known partial

Lin e Plot of the Hori zontal Component of the Lead Field Current Density

differential equation with standard boundary conditions. The current density obtained in the COM SOL forward model of the lead field current density will be used in the latter

::i ~
·u;
c

part of the thesis to ascertain whether the conductivity may be obtained.
0.8

;::Cl)

I

I
.r
. ' ..

,.
., .
' .

I
! .

'
r
..
In the phantom with the lead field, a voltage signal was measured by the electrodes,

c

c
Cl)

u 'C a;
i:i:
"'C
Cl)

:::l

t:

0.7

I
·

2.2.2 The Coil Field Current Density

..,

0.6

...J

0 ..., ·.::
::c:
CD

~
0

0.5

.

.

!.
1 ·

.; . ." l'

... '
I

:.
!
2

which was the inner product of this lead field current density with the electric field produced by the vibrations in the phantom caused by the ultrasound in a magnetic field.

-5 0

a o.. ·c:
'C

Cl)

!
-1

I
0

By using the reciprocity theorem, this lead field could be mapped throughout the domain formed by the sample, as though a current were injected through the electrodes. Any
3

..,

C)

::E

0.3 t::::::==:::::......;__ _ __._._ _ ___.._ _ _____;· . ____ ___;_:::::::=====::::::1
-3

-2

components common to both the field

vx B

and the lead field will contribute to a

i

. ~11

Hori zontal Axis (A.U.)

voltage signal at the electrodes. However, another way to find the current density is to use a pickup coil next to the sample, so that its axis is parallel to the direction of wave

Figure 2. Magnitude of the horizontal component of the current density along the horizontal line of symmetry in Figure 1. Experiments were only able to determine this component of the lead field current density.
A typical model of the lead field current density takes only several minutes to complete with roughly 30,000 elements using a standard desktop computer.

propagation of the ultrasound, and the coil is placed on the side opposite to that upon which the ultrasound is incident. The

vx B

field from the ultrasound focus will produce

a current density with a possibly unknown distribution, but with reciprocity the problem may be reversed. It is easier to find the current density produced by a current injected into the coil, and any components common to the fields produced by the coil and

34

35

ultrasound will generate a signal at the leads of the coil. The reciprocity theorem will now be derived for this case. Recalling the results of the reciprocity theorem:

VX Ecoil

=- jOJBcoil ·

fJb ·Ea -]a ·EbdV=O.
n
Consider two fields, one designated with a subscript subscript field

This is more easily solved if the vector potential of the magnetic induction vector is used:

coil, and the other denoted with a

Bcoil =

VX Acoif· -

focus to distinguish them. For the purposes of measurement, it is the lead
When this is substituted into Faraday's law, the result is:

J coil which is the current that would be produced in the volume if there were a

current source applied at leads of the pickup coil. In experiments, these leads would be used to measure a voltage related to the current density

V X (Ecoil + jOJAcoil ) = 0'
which is equivalent to the curl of the gradient of a scalar potential

J coil . As with the

V x (- V¢coil )= 0 .

measurements with the electrodes, the real source of emf is the field

Efi

OCUS

1

the electric The electric field induced by the coil is:

field produced at the focus of the ultrasound. Putting these quantities into the reciprocity theorem leads to:

E coil = - V¢coil - JOJAcoil · f J coil · E focus - J focus · E coildV = 0 ·
n
The current density is:

The impressed electric field due to ultrasound in a static magnetic field is as before.

Efiocus = v x B

J coil
The conservative electric field is -

= 0'(- V¢coil - JwA.coit ).
and the impressed electric field is -

Jcoil is the field created in the phantom if 1 ampere of current is injected into Jcoil, Faraday's law is first needed:

V¢coil

j wAcoil .

the pickup coil. To find
~~I
;I

The latter result may now be used in the reciprocity theorem:

VX Ecoil = -d tBcoil'
along with Ohm's law ]

fJcoil · (vxB}iV =-}OJ JaV¢Jocus · AcoildV
n n
The integral on the right hand side may be changed to a surface integral by applying the divergence theorem:

coil = O'Ecoil.

In the frequency domain, Faraday's law becomes:

n

J o\7 ·

(¢focus ·

Acoa }iv = J o\7 ¢focus · Acoil d v + J a¢focus (V · A coa }iv .
n n

36

37

By the choice of gauge,

V · Acoil = 0, the reciprocity now becomes:
{I)

along with

V · Acoil = 0

as the current choice of gauge provides the magnetostatic

n

J Jcoil · (v

XB

'}Jv = - J J aV · (¢focusAcoil }lv = n

J{I) Ja(¢focusAcoil }ndS ·
~

relation between the vector potential and current density. This simplification allows for a magnetostatic analogue to Poisson's equation for electrostatic fields:

The evaluation of the rightmost integral cannot proceed any further unless more is known about Acoil, which is the vector potential generated by a current flowing through a coil. This requires a temporary detour from this application of the reciprocity theorem. A general analysis of the vector potential begins with Ampere's law, simplified for a negligible displacement vector D . This is consistent with the lead field current density discussed earlier, because the frequency range of MAET excludes significant permittivity contributions and magnetic fields may be considered to be magnetostatic: with the solution:

A . (r) = _E_ coli 4TC

~- -,~ ailspace r - r

f ] wire(r') dV'.

This integral applies to the entire volume allspace which encloses all current densities and Q. This solution for the vector potential is a vector relation, and it may only be resolved into three independent vector equations only if Acoil (r) and

V X Bcoil = p}wire·
J wire is the current density flowing through an arbitrary loop, or coil . Application of the
vector potential

J wire(r') are

· -

expressed in Cartesian components. With a relation for the vector potential, reciprocity for the coil may now continue: Recalling reciprocity relation derived earlier:

vX Acoil = [3coil to Ampere's law allows for a relation between the
- V XV XAcoil = J w ire · 1-

current density and the vector potential:

fJcoil · (v X B '}Jv = a(¢focus Acoil }ndS,
n an
the vector potential may now be expressed in terms of the current density in a wire,

J

11

I

ill .1!11

The vector identity:

-coil. (B-\JV J1 J (/h J ]lr wire(r')dV'] '""'dS fJ vx p =4 a 'rfocus -r'l n . n an allspace
TC

Noting that

r'

applies to all space, and

r

applies to the surface of the phantom, if the

coil is located at a distance near the phantom then

lr-r'l > 0 only for ] wire(r') '# 0.

38

39

The integral

J ~:ire ?.? dV' therefore exists for all regions of space. Also Jw ire(r')
allspace

r-r

~t/Jf ocus = J]coil · (v X B)dv ·
Q

J
may be considered as a test function, and
1

:ire~~ r-r

(-')
vanishes as

IF- i''l--7

.
oo,

which

Experimentally, the coil field current density

J coil

is mapped to within the resolution of

ultrasound and its values during the scan can be determined experimentally with voltage measurements ~t/Jf ocus at the coil terminals. It is the coil field J coil that is of interest for simulations, and now attention will shift to a more precise way in which it may be obtained, starting with a description of the model of the coil itself. The following

means that it has support, although not necessarily on a finite interval.

J :ire~~
allspace
1

J

(-')

r-r

dV' may be treated as a distribution[23] which assigns a
. J wire

number to a test function. In this case, an approximation that the value

(r')

may be assigned

derivation of the vector potential from a coil at all points in space is an excerpt from [13], and it is only provided here for completeness.

Jwir e(r)

may be applied because

~:i re ?.? contributes to the integral r-r

z

significantly only when

lr- r'l is sufficiently small.

This approximation will greatly simplify the reciprocity to

r

The factor - j OJ f.lCY may be safely omitted because it is dimensionless and acts only

4Jr

.~!Ill

II ;Ill

as a proportionality. In terms of the current and voltage at the coil:

r
Figure 3. Coordinates used for the current loop, known as the coil
A practical assumption is to treat the coil as a single loop provided that all of the turns

fJcoil ·
Q

(vxB)dV =~t/Jfocuslwire ·

The final expression if I wire = 1 for 1 ampere of current injected into the coil is:

occupy a volume of thickness small in comparison to the radius of the coil. For a single loop of a line source of current density lying in the x-y plane centered at the origin with a

40

41

radius of size

a , it is best to use ordinary spherical coordinates (r ,8, rp)

in Figure 3.

Then the current density in the coil is:

1coil
and the governing equation is:

=

a{- V¢ coil -

Jm.Acoa ) ,

J wire

-

t5(r- a) = J wire ,.rn · ,. =Iot5(cos 8) a

-

V· ]coil = 0'
with boundary conditions

If the current density has a component only in the potential:

rp

direction then so will the vector

Jcoil · ii = 0 ,

A coil = A coil ,rp ·
The x and y components of the current density are:

for a unit normal oriented outward on the surface of the domain. The divergence of the current density leads to an inhomogeneous Poisson's equation for the scalar potential
¢ coil '

J wire,x = -J wire,rp sin(/)' J wire,y = J wire, rp cos(/)' and J wire,z = 0.
The vector potential is:

Acoa - Acoil rp r' '

_

( e)=

.Ja 2 + r 2 + 2arsin8
K(k)
and

l61rj.ll 0 a

[

(2- k2 )K(k)2E(k )] 2 '
k
is:

With Neumann boundary conditions in the potential, () n¢coil

= 0.

From the analysis of the reciprocity theorem, it was shown that time dependence may where the argument of the elliptic integrals

E(k)
.

be safely neglected and only the amplitudes are significant. The induced electric field is simplified to:

k2=
i

4arsin8 a 2 + r 2 + 2ar sin()

II

II

ii

Ecoil
and the coil field current density is:

=-

Vr/Jcoil -

A coil '

The x and y components of the vector potential are found in the same way as the Cartesian components to the current density:
A coil ,x

"I

~

f it) ~

=-

A coil ,rp

sin(/),

A coil,y

=

A coil,rp

cos(/),

A coil,z

= 0·
With time-dependence neglected, Poisson's equation from the divergence of the coil

The current density found earlier from Faraday's law is:

field current density is:

42

43

still with the same boundary condition

an¢coil = 0.

Arrow Plot of the Coil Field Current Density

.. . . . .. .-

...

- - - -· - .. .. .. -. - - - -:. - - - :-:

.
' ·

.
.....

...

- - -: - -- - --·

-. .. ·:
~

.

2.2.2.1 Results
0

~

""

This is the forward problem for the coil field, and like the lead field, it may be solved with COMSOL for an arbitrary domain. Reciprocity allows the coil field to be measured by experiment, and justifies its numerical simulation as comparison to experiment.
-3 .
...

-2

..
.

.....:

..

- - - :. - -· - - - ·- - -1

-2

.:
..

""

"

.. ~

'

.

- ..
·3

Horizontal Axis (A.U.)

Conductivity Distribution in the Coil Field Forwanl Problem
Max: l.:a:>

Figure 5. Plot of the coil field current density. The coil axis lies at the center of the domain and is suspended at a height of half of its radius from the surface.
l.1

Being the forward problem, the conductivity is known, and it may be any continuous function of position. The coil field current density may now be obtained by specifying this conductivity and solving the corresponding Poisson's equation. Like the lead field, the coil field is an impressed field as it really is emf generated by an oscillating current in a coil. The time dependence is however implicit not only for the sake of simplifying the model, but it is allowed by the application of the reciprocity theorem. A typical coil
-3

-2

-1

Horizontal Axis (A.U.)

Min:

o.aro

field simulation with about 30,000 finite elements will only take several minutes to complete

Figure 4. Plot of the conductivity of the domain in a COMSOL model of a square slab domain. In this model the conductivity is linearly increasing in the xdirection (horizontally).

44

45

2.2.2.2 Discussion

Chapter 3. The Inverse Problem in MAET
experimenta~

The application of this forward model include validation of possible (future)

work and testing the inverse, which is the determination of the conductivity from the coil field current density J coil·

3.1 Theory

Until now, the forward problem has been developed extensively in which a known conductivity allows a current density to be calculated. Now it is time to explore the inverse problem, which is to determine the conductivity from the current density. The relations between these two quantities involve the first derivatives of the conductivity in the form of first order partial differential equations. Provided that first derivatives exist, every first order partial differential equation has a solution. Recalling the hypothesis for MAET: · In the forward problem, the lead field or coil field current density may be mapped in a volume conductor. · In the inverse problem, the conductivity may be obtained from the lead field or coil field current density
,p

;Iii

Ill

iii

The second hypothesis will now be tested with the method of characteristics. The method of characteristics has the consequences of Lyapunov functions and Liouville's theorem which will be explored in the theory.

1~11

46

47

3.1.1 The Method of Characteristics

The surface S

= {x,y,u(x,y)}

is constructed by a union of curves

r =: {x(s),y(s),u(s)}
The method of characteristics [17] offers a way to solve for the conductivity by converting partial differential equations to an equivalent system of ordinary differential equations. It is a general technique that may be applied to any first-order partial differential equation in any number of variables, although the following work involves mainly two independent variables. Given the linear equation: between the normal to

parameterized by s. For any point along the curve r, the

tangent vector is defined as (x(s),j;(s), u(s)),

where ( x s , y s , u s

. ( ) . ( ) . ( )) = _ (dx(s) , dy(s) , du(s)) , ds ds ds au ax au ay

and it is also perpendicular to the normal (-(x,y),-(x,y),-1). The inner product

.

S and the tangent to

r

is also zero:

au . au a(x,y)-(x,y) + b(x,y)-(x,y) == c(x,y), ax ay
the solution is the surface S

(au (x, y), au (x,y),-1). (.X(s), y(s),u(s)) = au x(s) +au y(s)- u(s) = 0.
~ ~ ~ ~

= {x,y,u(x,y)}.
The tangent vector to

S must be equal to the tangent vector of r, as the vector field

To find this solution it is first useful to express the partial differential equation as an inner product:

(a(x(s),y(s)),b(x(s),y(s)),c(x(s),y(s))) is also tangent tor. (a(x(s ), y(s)),b(x(s ), y(s)), c(x(s ), y(s ))) = (x(s ), y(s ), u(s)).

au au (a(x,y),b(x, y),c(x,y)) · (-(x, y),-(x, y),-1) = 0. ax ay
This inner product suggests that the vector (a(x,y),b(x,y),c(x,y)) is perpendicular .

The curves r

= {x(s),y(s),u(s)}

are the solutions of the system of equations, known

as characteristic equations:

au au au ' to(-a (x,y),-(x,y),-1). The vector (-(x,y),-(x,y),-1) is the normal to S, so X ay ax ay
at each point {x,y,u(x,y)} the vector (a(x,y),b(x,y),c(x,y)) must lie in the tangent plane of S.

au

- = a(x(s),y(s)),

dx ds

dy ds

= b(x(s),y(s)),

du ds

= c(x(s),y(s)).

The curves r are known the characteristic curves for:

au au a(x,y)-(x,y)+b(x,y)-;-(x,y) ax oy

= c(x,y),

48

49
PROPERTY OF YERSO NUNIVE RSITY LIBRARY

and once they are solved for using the characteristic equations, they may be pieced together to form the surface S

= {x,y,u(x,y)}

instability. The conductivity in the inverse problem is the colloquial energy of the system of ordinary differential equations used to make the trajectories for its solution.

which is the solution to the POE.

3.1.2 The Conductivity as the 'Energy'

3.1.3 Liouville's theorem

The forward problem was initially an electrodynamics problem, but the inverse is analogous to a mechanical problem, as it now involves trajectories. Given that

Now that the method of characteristics has provided both a phase space and a Lyapunov function, Liouville's theorem may be applied to find the density of trajectories in phase space. It is a statement of particle conservation in which a large number of trajectories in the phase space are compared to that of a fluid [20]. Let p be the density of particles in a volume V of phase space. The number of particles in the volume of phase space is:

x = a(x(s),y(s)) and y = b(x(s),y(s)) provide the coordinates of the phase space,
one quantity that is highly pursued in the solution of systems of ordinary differential equations is the energy, although this name is used in a different context from the more familiar physical energy. It is more formally called the Lyapunov function to prevent confusion, and normally there is no way to find it except by trial and error. If the Lyapunov function is defined as H, its derivative is defined as [see 18,19,21]

N=

fpdv.
Q

H = dH x + dH y. The conditions on this function are that H > 0
dx dy
stability, a decreasing energy is necessary,

everywhere, and for The number of particles in the test volume may change, because of a flux through the surface of that volume. The flux is:

H~ 0

(it is easier to go downhill than it is to

go uphill). Using the method of characteristics automatically provides

H in the form of

u(x,y).
In systems of ordinary differential equations obtained by solving for the conductivity using the method of characteristics, the Lyapunov function will be the conductivity since

~ "dS = dN -. f pv·n ()Q dS
The negative sign is justified because the direction of the normal to the surface outward for a closed surface, and if the velocity

n is

v is perpendicular to that surface then

o- = dO' x + dO' y for two independent variables. The conductivity also fulfills the
dx dy
requirement that it is positive everywhere, that is, a> 0. The stability criterion 6" ~ 0 for a varying conductivity will also apply, since an increasing conductivity can lead to

the flux integral is positive and represents particles leaving the closed volume V. The continuity equation in terms of the integrals is then:

50

51

fdp dV + jpV ·iidS = 0 . n ds an
Using the divergence theorem:

The term on the left may be simplified since:

fJJV. nds = fv. (jJV)dv,
an an
and continuity becomes :

ap . ap , p= -x+-y+-z ax ay az

. (ap .

·J

and continuity becomes:

n

f[ap + v. (jJV)Jdv = o, ds
pointwise.

ay +- = 0, or -1 p . + - +ay +- = 0. p + p - +ax dy dz p ax dy az
Liouville's theorem has consequences:

. (a.x

azJ

(a.x

azJ

over the entire volume, or:

dp + V · (pv) = 0 ds

Suppose that this phase space consists of only the rectilinear coordinates x, y, z. The volume element of the phase space will be continuity equation is:

If the phase space trajectories diverge, -

dV = dxdydz,

and

v = (x, y, z). The
will decrease, so that -

. ax

a.x + _z a· +az > 0, then the density of particles
ay dz

1

p

jJ < 0, along the trajectory path.

·I, ·

!
, I

ap -x+-y+-z ap . ap + p -+-+ay -+ =0 . ds dx dy dz dx dy dz
The total time derivative of p is:

(ap .

·J (a.x

azJ

If the trajectories converge together, then density increases.

a.x + _z a· +az < 0, and -1 p. > 0, so the
ax ay dz p

:·

t!

dp dp . dp . dp . dp -=-x+-y+-z+ds dx dy dz ds '
but suppose that p is autonomous in that it does not depend on s explicitly. This would imply that

Since each particle can be associated with one trajectory, then the density of particles is identical to the density of trajectories. It is this density that is also a function of the 'energy', or more precisely the Lyapunov function H. The conductivity has already been identified as such a function, so it will be seen through the method of characteristics that

dp ds

= 0, and the continuity equation is:

p = p( o) , and t.he density of trajectories may be related to the conductivity.
For now, Liouville's theorem will be applied just to evaluate the relative change in the number trajectories in terms of changes in the conductivity. It will also be used as a test to compare the
~tability

ap . ap . ap ·J +p(a.x - +ay - +azJ - =0. (-x+-y+-z dx dy dz ax ay dz

of the system of ordinary equations obtained when the method

52

53

of characteristics is applied for both Poisson's equation and, more importantly, Faraday's Law. The left hand term involves a gradient of the conductivity gradient into partial derivatives leads to:

V(J', and expanding this

3.2 Methods

The method of characteristics along with Liouville's theorem have been introduced as a tool for solving first order partial differential equations. They may now be applied to any partial differential equation involving the conductivity and current density, with the goal of solving for the conductivity for a given current density. The two partial differential equations considered will be both Poisson's equation (the divergence of the current density), and Faraday's law.

As a dot product of normal and tangent vectors, this POE becomes

(a x(J', aY(J'' a (]',-1) ·(a xt/J, ayf/J, a t/J, -CJV
2 2

2

f/J) = 0.

The goal is to find a surface S

={x,y,z,(J'(x,y,z)} with a tangent vector:
ca x¢, ay¢J, az¢,-aV 2 ¢).

(.X, y, z, 0') =
The characteristic equations are:

..

,,,,

..

3.2.1 Poisson's equation

!! !!
IJ

i

=dx =a x¢(x(s),y(s),z(s)) y =dy =a y¢(x(s),y(s),z(s)) ds ds
ds f/J(x(s),y(s),z(s)) 0' = d(J' z ds

" !!

!!

The method of characteristics can be used to solve for the conductivity in Poisson's equation by reducing the POE for an unknown conductivity to a system of ordinary differential equations. In a space with no sources it is:

!! .. ,,

z = dz =a
with solution curves

= -aV 2 ¢J(x(s),y(s),z(s))

,,

ii

"

:J

r= {x(s),y(s),z(s),(J'(s)}

parameterized by .s.

II

Now the divergence of the phase space (.X, y, z) is: Suppose for the moment that potentials are the quantities being measured, and that the conductivity can be obtained from these measurements. Expanding the divergence in Poisson's equation leads to:

54

55

'

but the equation for the derivative of the conductivity is - -

2 o= V ¢. The two right (5

1

c:T(s) = O"(s) _a_(Jx(x(s),y(s),z(s))J + a [Jy(x(s),y(s),z(s))J + ... ax(s) O"(s) ay(s) O"(s) _a_(Jz(x(s),y(s),z(s))J. az(s) O"(s) ,
Although the conductivity O"(s) is also the Lyapunov function, it may be treated as an independent coordinate, leading to :

hand sides of both equations both equal the Laplacian of the potential, equating the two left hand sides leads to:

1 . a.x a_y -0"+-+-+-= 0 . 0" ax ay az
This has the form of Liouville's equation with

az

-a-=- p, so that if the conductivity (5 p
0" > 0 and p > 0. For a decreasing

1

1

increases, then so does the trajectory density, for

conductivity, the phase space will diverge, as the trajectories move apart since,

- + _z +- > 0, and for convergent trajectories the conductivity will
ax ay

a.x

a·

az

0"= ...
increase.

az

In MAET, the problem is different, and it is the current density which is measured. The characteristic equations now must be expressed in terms of the current density. These are:

(

dx~s) (Jx(x(s),y(s),z(s)))+ dy~s) {Jy(x(s),y(s),z(s)))+ dz~s) (Jz(x(s),y(s),z(s)))J
too-- V ·J = 0.
= _]_{Jx,Jy,Jz ) is:
(5

This simplifies

x

.

=-

J x(x(s),y(s),z(s)) . y

O"(s)

=-

J y(x(s),y(s),z(s)) .

O"(s) c:T(s) O"(s)

z

=-

J 2 (x(s),y(s),z(s))

O"(s)

, and

The divergence of (X,j;,Z)

-

a.x a_y az 1- -+-+-=--V·J. ax ay az 0"

-

2 a a2 a2 f/J(x(s),y(s),z(s)) + f/J(x(s),y(s),z(s)) + f/J(x(s),y(s),z(s)) . 2 2 [ ax(s) ay(s) . az(s) 2

J

In terms of the divergence, the equation

o-- V·J = 0 becomes:

The fourth equation may be expressed in terms of derivatives of current density:

56

57

Which is identical to Liouville's theorem with 0' = p . . Since the divergence of the current density is zero,
0' =canst. The conductivity

3.2.2 Faraday's Law and the Inverse for the Coil Field

V · J = 0, it follows that 6" = 0 , and
The method of characteristics may also be applied to Faraday's law:

O'(s) may now be eliminated from all of the characteristic

equations as it is a common constant. These equations may now be multiplied simultaneously by - O'(s) because it is an independent coordinate to give the following characteristic equations :

VxE=-JmB.
The complex angular frequency factor may be omitted:

- = J x(x(s),y(s),z(s)), - = J y(x(s),y(s),z(s)), - = J z (x(s), y(s),z(s)),
~ ~ ~

dx

dy

dz

VxE=-B,
and using Ohm's law ] =

and

dO'=O.
ds

O'E,

expressed as a direct relationship between current

density and conductivity [22]:

The result of using the method of characteristics to determine the conductivity from the current density in Poisson's equation is that the conductivity will be an indeterminate constant. The direction of the integration is done along the current density. It does not mean that the conductivity is nonexistent, but rather it cannot be inferred from using the divergence of the current density. The curl may now be expanded into:

Vx

- (JJ 0'

=-B.

~\o- xJ+

-( 1

J-

O"

1 (-) =-B. VxJ

The leftmost term as a gradient of conductivity is:

V- xJ=--VO'XJ,
(J'

-(1J - 1- (]'2

and the entire relation now becomes:

1 1 (- ) =-B. --VO'XJ+VxJ
(]'2
(J'

58

59

This vector equation may be expanded into three components in Cartesian coordinates The z-component of

_ _ V x J , which

aJY ax

aJ ay
x ,

is - - _

can now be treated as any function

_1
() 2

(J (J

a(JJ + _!_(aJz _ aJY J= -B Y az z ay () ay az x
a()_ J z ax
X

of x and y, and it may be abbreviated as To find the surface

(v x J t (x, y).
r
= {x(s), y (s), O"(s)},

S = {x ,y,O"(x,y)} as a union of curves

_1 (J a()_ J a())+ _!_(aJx _ aJz )
(} 2

az

(} az

ax

= -B

y

the characteristic equations are :

_1
() 2

a(J_J a(JJ+_!_(aJY _aJx J=-B x dy y dX () dX dy z

- - = -Jy(x(s),y(s)),

dx(s) ds

dy(s) = J x(x(s),y(s)), ds

For a thin domain, it may be assumed that

oJZ'oJZ'oJZ ,Jz ' and d(J are negligible dX ay dZ az

so that only the third curl equation may be used. It may be rearranged to :

3.2.2.1 Results

As a product of tangent and normal vectors it is:

The method of characteristics has offered a very practical way to convert Faraday's law

(

- J
y'

J -(J(aJy - aJ X ax dy
X '

J-

() 2

B
Z

J. (a() d(J -1J = o dX ' dy ' .

into a form that may be more easily solved, but the system of ordinary differential equations (ODE's) is nonlinear so that it is only possible to solve this system numerically, especially since the current densities and the magnetic field are nonanalytic functions . In practice, MATLAB is the best environment for the solution of this system. The coil field current density components are first solved for as in the Poisson equation forward problem for a given 0" with COMSOL:

aV tPcail

-v·aV tPcaa = v·O"Acail with the boundary condition an¢caa = o.

60

61

Once these current densities are known, they may then be used to for the system of ODE's. Unlike the characteristic equations for Poisson's equation, the trajectories are perpendicular to the current density, and the conductivity is obtained along these curves. As the streamlines of the current density form closed loops, there will be a single point in the domain where all of these trajectories intersect. This is called the
2 .... . .... . . . . .. . .

3 .. .. . ... .... ....... ... . ..... .. .... .... ........ .. . ... .. .. . ... .. ...... .. .. .... ... .. .. .

Scatterplot of the Linear Conductivity Trajectories

fixed point and it occurs when J x == 0 and J Y == 0, which is roughly close to the axis of
the coil, depending on the local gradient of conductivity. This fixed point is unstable and trajectories move away from it. The real parameters is arbitrary, and it increases along the integration. The initial conditions are { x(O) , y (O) , a(O)} at s == 0 as the system is an initial value problem. There is no rule for finding the initial conductivity at the fixed point, but once the fixed point is known, even an erroneous initial conductivity will quickly converge to the correct conductivity along the trajectory. The coil method of conductivity reconstruction is capable of distinguishing between constant conductivities. To see .how, it is sufficient to solve:
-3~------~------~------~------~------~------~
(U

1 ..... .

u
t

>

Q)

-2 ...... ... .... , .. . .

Il l Il l

a : !!i "'

ii!

O"(s) == -a(s)(VxJt(x(s), y (s))-a(s) B z(x(s) ,y(s)) == 0,
which at the fixed point s == 0 has the solution

2

-3

-2

-1

0

1

2

3

Horizontal Axis (A.U.)

Figure 6. Characteristic curves for the coil method for the linear conductivity in

a(O) = _

(V x Jt (x(O),y(O))
B z(x(O), y (O))

Figure 4. The coil field current density in the COMSOL forward model is used to determine the trajectories, which are always perpendicular to it. The trajectories are more rarefied in the region of higher conductivity (right), and are more dense

In the absence of a known conductivity, this is preferred because it offers a value that is at least within an order of magnitude to the subsequent values. The necessary prerequisites to reconstruct the linear conductivity distribution in Figure 4 have been presented to allow for a reconstruction in MATLAB.

in a region of higher conductivity. The fixed point lies within the disk at (0,0). The change in density of the trajectories is a result of Liouville's theorem, and it will affect the resolution. Increasing conductivities will become harder to resolve.

62

63

Plot of Linear Conductivity Reconstruction from Coil -3

x(s) == -Jy(x(s),y(s)) y(s) == Jx(x(s),y(s))
The linear approximation in a neighbourhood {x(s ), y(s)} to the fixed point

-2

{x(O), y(O)} is
::>
....... -1

-a yJ y ][x(s)- x(O)] ayJx y(s)- y(O)
Solving for the eigenvalues of the Jacobian will allow an estimate of how much the vector {.X(s),y(s)} diverges near the critical point. These eigenvalues ~ ,~ may be found by solving the characteristic equation obtained by taking the determinant of the

2

Jacobian.

-2

-1

0

2

3

Horizontal Axis (A.U.)

:::
I t'

Ill

'" II! ,, ,

"' "' :::

"'

Figure 7. Reconstructed conductivity for Figure 4 for the forward problem. The typical time required for completion is about 20 minutes for several hundred trajectories. Once obtained, they conductivities along these trajectories are interpolated together.

along with the associated eigenvectors eigenvectors amounts to :

i\, v 2 . Using these eigenvalues and

!jj

!!!

Ill

!:: ,,,

otl

'"
II

~: I,,

;::

Normally these eigenvectors are orthogonal to one another and parallel to { x( s ), y( s)} . Along with the initial conditions, it is important to consider the stability at the fixed point. For the purposes of reconstruction, it is important that this point is unstable, because outgoing trajectories can be used to map the conductivity throughout the domain as long as there is a nonzero current density. To analyze the stability at the fixed point, only the first two of the characteristic equations are considered: The divergence of More importantly, ~

;ii

> 0 and .A-2 > 0. These positive eigenvalues indicate that all

trajectories are guaranteed to move away from the fixed point.

a~ a~ .v . }is -f { v +----}- == ~ + A av av
1,

2

2

> 0.

1

2

64

65

The volume of the space occupied by

{v1, v2 }

is expands near the origin. Similarly, the

Assuming that p trajectories:

> 0 and a > 0 , the conductivity may related to the density of

divergence may be applied to the first two characteristic equations for a more global expression:

-+-=d J -d J --VxJ dX dy y y
X X

a.x a_y

_ (- -)
Z

pp

1. (1 .+ .-DJ
=- (}' (}'
(J'n z

.

As the conductivity increases, the density of trajectories traversing the region will It is just the trace of the Jacobian used for linearization, and it applies to every trajectory at every point. For a negative curl of the current density, the coordinates {x(s), y (s)} will diverge, while they will tend to converge in a region of positive curl. has the same sign as the divergence of the phase space. An increase in conductivity The stability may be also evaluated by using Liouville's theorem, developed earlier, for the coil. Revisiting the third equation of the characteristic equations, which is the rate of the change of the conductivity along a trajectory: This level of instability can become a serious issue if the conductivity increases too
-) o- = -(}' (v X J z -

decrease, but the presence of the magnetic field will also contribute to the loss of trajectories since the continuity equation in the conductivity is inhomogeneous, and aB z

will result in an increased divergence to which the aB z will add further to the instability, and the density of trajectories will decrease dramatically.

(}'

2

Bz '

rapidly. One such example is a Gaussian conductivity anomaly of Figure 8. If the peak of the conductivity had coincided with the coil axis, then

it may be rewritten in terms of the divergence of the phase space as:

a< 0

away from the fixed

point, the trajectories are unconditionally stable, and a reconstruction is possible. In figure 8, the peak conductivity is off-axis, and the conductivity along some trajectories will increase, that is

a.x +a_y J-a 2Bz , or by rearrang1ng . t erms 1 ·t . o- = a (1s: dx dy

o- > 0 , leading to instability. Unlike the linear conductivity example

done previously, this increase is sharp to the extent that very few trajectories cross the region.

By comparison, the Liouville's theorem with the density Is:

1 . (a.x -p+ - +a_yJ - = 0. p dx dy

66

67

the coil field, but it can be overcome by changing from Cartesian coordinates to polar
Conductive Anomaly Max: 1.938

coordinates. Let x = l cos B and y = l sin B. For a fixed angle B, .X = i cos B and

3

y = i sin B with
1.9

l = 0 coinciding with the fixed point. l is the distance from the fixed

2
1.8 1.7

point and its rate of change is

i = ~x2 + y 2 = ~ J x 2 + J Y 2 , which is positive
space. The system of the characteristic equations is

semidefinite. The use of l is as a constraint, which only allows solutions along a straight line from the fixed point in

::i ~
..!!

::i ~

1.6 15 1.4 13

{x, y)

<
-1
Q)

X

'ii u

> t;
~

~

reduced from a system of three differential equations to a system of two differential equations:

"f

= c
e

>

u

i(s)
1.2

= ~J

X

(l(s) cos B, l(s) sino? + J y (l(s) cos B, l(s) sin
2

or

O"(s)
-3

= -O"(s)(V x

Jt {l(s) cos B,l(s) sin B)- O"(s) Bz(l(s) cos B, l(s) sin B),
B fixed for each trajectory.
Cartesian coordinates may be to form the set of and y(s)

-2

-1

0
Horizontal Axis (A.U.)

2

3

1

Min: 1.00

For each

B the solution curves are {l(s),O"(s)}.

Figure 8. Off-center Gaussian conductivity forward problem done with COMSOL. Modifications to the phase space associated with the inverse to the coil forward problem become a necessity when the conductivity increases significantly away from the fixed point

recovered by using x(s)

= /(s)cosB

= /(s)sinB

coordinates {x(s), y (s),O"(s)}. Sets of these coordinates may be collected by solving these equations for fixed surface

B at increments within the interval BE [0,2JZ']

to build the

{x, y, 0"( x, y)}.

For this system of ODE's with a single unstable fixed point common to all trajectories, a sufficient increase in conductivity away from a fixed point where the trajectories have already diverged may cause them to completely avoid that region. This is a serious practical problem for increasing conductivities in using the method of characteristics for

68

69

Scatterplot of Conductive Anomaly Traj ectories
····· ···· ·· ··· · ··· ·· ······· · · ·· · · ········· ·· :· ······ ·· ······:·· ··· ·· ·· ·· ····:···· ···· ··· ·· ·· ..... . . .. . . . . .~- ........ .... . .~- . . ......... . . -~

:

:

Gaussian Conductivity Reconstruction

!

!

:"'"""""''('''""" ""'! """""""

:

:

3
1.9

.. . -..... ... --1· .. .. ..... ... . 1...... ... --· ···~ .. ....... .! . .. -.. --.. -.... r . . .. - .. . .... . .
2
· · · · · ······· · ·

. . ···· · · ····· ·:·· · ···· · ··· · · ··:· . . · ·· ·· · ····· · · . . . . . . . .
.

2

1.8

1.8
...........

. . . . .

:·

··

0

·

0

.......

0

0

..

.. :

.

. . . .

·

·

0

·

··

·

. . . .. .... : .... .. ... ....... :.. ......... .. . . . . . . . .
. . . .
0 .. .. .. .

.

1.7 1.6

::::> ·:;:
·.;::;
(..)
~

-~
> .....

~

......

.

...

.

......

~

...

..

..

...

.

.

...

.

:::)

~ 1.6
:>-. ....

~ 0

1.5

-~
"0

u ::;,
c
0

1.4 1.2
. . ··· ······ ·· ··)··· ········ ·· , .... .. ... ... .. ·· ···· ·· ·· ···r···· ·· ··· ··: ····· ····· ····

g_ N 23_
Q)

4I

.S?
t

co
Q)

"U

>

-1

c
0

u

(..)

-2
4

0.8-r----r------.---i-----f----~----k

3

2

0 Vertical Axis (A.U.)

-1

-2

-3

-

-2

-1 0 Hori zont aI Axis (A. U.)

2

3

Figure 9. With modifications, the trajectories are constrained to straight lines in (x,y) space originating from the fixed point, which is visible in this plot as a central disk. The time required for a reconstruction with a modified phase space is no different from the unmodified one. The time required to complete 400 trajectories with MATLAB is about 20 minutes on a standard desktop computer. These trajectories are then interpolated together to form the image in Figure 10.
The inverse does not necessarily need to be confined to a thin slab domain. Domains with geometries resembling those of the actual phantom used in experiments may be used to test the performance of the inverse. An example is included in Figure 11, the forward problem, and Figure 12, the inverse problem. The coil field current density may be obtained from the solution of the for-Ward problem with COMSOL. The coil field current density may then be used in the system of ordinary differential equations, which lends itself to a solution in MATLAB.

Figure 10. The off-center Gaussian may now be reliably reconstructed with the modified phase space.

70
71

Reconstructed Phantom Conductivity

3
Phantom with a Homogeneous Conductivity
Max: 1.00

1

2
1.5
~

2
.7

s. .,
<(

0.5 0

x
u

:i

<i
b

c

.7
~

1
~
(()

.,..-....

::)

~
0
:~ u
:::J

'«;

>

1: -0.5 CD
-1

> u :s
"'CS

<{
('(5

X

= u

-1 .5

-~ t:

-o

::>-.

c:
0

-2
-4
-3

> -1
-2
-1

Q.)

u

0 Horizontal Axis (A.U.)

2

3

4

-2
Min: l .DCe-6

-2 Figure 11. Simulated phantom with uniform conductivity forward problem with COMSOL. The coil axis in this model is centered at the geometric center of this object, and the coil field current density is obtained from this simulation for use
I I

-1

0

1

2

3

Horizontal Axis (A. U.)

Figure 12. Conductivity obtained from the coil field current density distribution in the simulated phantom. The fixed point of the reconstructing trajectories was located in the center of the channel, and the modified phase space was used. The trajectories are rays with a common fixed point and are inherently unable to reproduce sharp edges such as those adjacent to the channel in this example, but this problem may be alleviated by moving the coil axis to another location in the domain. About 500 trajectories were needed with a runtime of a half hour.

in the inverse. Although the model has a constant conductivity, the boundaries deserve attention, because the conductivity needs to be continuous in its spatial derivatives.

I

72
73

3.2.2.2 Discussion

~~) = -JY(x(s),y(s)), d~~) = J x(x(s),y(s)),
da(s) = -a(V'xJt(x(s),y(s)) ds

and

The method of characteristics applied to Faraday's Law has proven, at least in principle, to provide a reliable reconstruction of the conductivity for the coil field current density. In spite of its ability to reproduce distinct constant conductivities, the unaltered method is inherently unstable. The instability can, however, be remedied by modifying the phase space so that trajectories originating from the fixed point are constrained to propagate along straight lines in a direction away from the fixed point. This modification increases the stability because the trajectories cannot diverge as a result of a conductivity increase. Even so, the trajectories still diverge away from the coil axis and resolution can be expected to diminish away from the coil axis. The utility of solving Faraday's law with the method of characteristics may also be applied to solving for the conductivity from the lead field current density. and for a conductivity a

Unlike the coil field, only relative changes in the conductivity may be obtained, as the method cannot distinguish between constant conductivities with different values.

If

da(s) ds

= 0 , then

(- -) VxJ z

=0,

> 0 , the conductivity can have any value.

There is no fixed point, because

(.X, y) =t (0,0)

in the lead field, and the initial conditions

will also be different, due to the geometry of the field. In the reconstruction of the conductivity from the lead field current density, initial conditions do not start from a

I I
I

I l
I

I!
I
I

I

single point, but they are located along a parameterized curve, possibly one which has

I

3.2.3 Inverse for the Lead Field

its own characteristic equations. It cannot be any curve, and it has to provide uniqueness, so that trajectories do not intersect. In what follows, this criterion for uniqueness will show which curves for initial conditions are admissible.

I

l

I
I

'

::

The inverse for the coil field forward problem can now be slightly modified to find the conductivity from the forward problem of the lead field. The method of characteristics is applied to [25]: Suppose a curve of initial conditions has another parameter, called t. In the characteristic equations for the electrodes, this parameter t may be inserted without changing them.

., .

,I

- - = -J (x(s,t),y(s,t)),
Y

dx(s,t) ds

c(v(s,t) = Jx(x(s,t),y(s,t)), and ds

and the characteristic equations are:

da(s, t) = ds

-a(v x Jt (x(s, t), y(s, t))

74

75

The solutions of these equations will be x

= x(s, t), y = y(s, t), e7 = e7(s, t), for any real

s , with the initial condition determined by t. For uniqueness with two parameters, it is
sufficient to consider only r = (x(s,t), y(s, t) ). The conductivity e7(s, t) is determined along r.lftwotrajectories r=(x(s,t)),y(s,t))) and r=(x(s,t2),y(s,t2)) intersect for t 1 = t 2 , then there may also be two values of the conductivity at the intersection. In this scenario the conductivity may be non-unique, and it is of utmost importance to avoid it by finding the conditions which guarantee no intersection between trajectories. At s = 0, the initial conditions to the characteristic equations associated with Faraday's Law are:
x

-

dx

-

dx

J= ds dy ds

dt dy ' dt

and the determinant of J is

IJI = (~; )( ~)- (~ )(~~) F 0.
~; =-JY and ~ =J x along with the characteristic
dt

The inverse of J will only exist if, and only if, its determinant is non-zero. At s = 0,

= xinit and y =Yinit

.

Also,

x(O, t)

= YI (t) 'y(O, t) = r2 (t)'

equations for the curve of initial values dx =

y1 (t)

and dy =

dt

y2(t)

apply, as the initial

and the curve of initial conditions is:

points of (x(s),y(s)) are now being considered exclusively along the curve of initial values. All four values may be substituted into the determinant for J:

:1 I

!I :
I

'' I ·I I

The characteristic equations for the curve of initial conditions are:

J=

-J

,, ,. '' If l

)I

( Jx

y

( : xinit (t), 1
'

:t Yinit (t)) = (tl (t), t2 (t)) ·

The determinant is One choice of the curve

IJI = (- J Xr
Y

2 )-

(J x )(r1 )

-:t-

0.

,. ,,

Both characteristic equations have·two parameters, ( s, t) , which are used to determine unique values of (x, y). This implies a transformation (s, t) -t (x, y). To determine whether or not this transformation is invertible, and ultimately whether unique values of

y which guarantees a nonzero determinant for any arbitrary
YJ = J
X

nonzero current density is

and

r=J
2

y.

The determinant in this case is

(s, t) will lead to unique values of (x, y), the Jacobian J of the transformation must be
found:

IJI = J

2
X

+ J y2

-:t- 0. This would imply that . the characteristic equations of the current

density in Poisson's equation will provide reliable starting points for finding the conductivity via Faraday's law. These initial points may be found at points along the streamline of the current density:

76

77

and the conductivity equation in terms of the divergence is:

d d d (-d xinit (t) , -d Ytnit (t) , -d a t t t

init (t))

= (J X ( xinit (t), Ytnit (t)), J y ( xinit (t) , Yinit (t)),O).

.

'

.

_!_ o- _( a.x + a_y J = 0 .
a

The respective phase spaces from Faraday's law and from Poisson 's equation , because their trajectories are perpendicular to each other. Given the two phase spaces: For comparison , the Liouville equation is:

a x a y

1 . (a.x -p+ - +a_yJ - = 0. p

a x a y

The dot product

(x,y, a)Faraday · (x,y, a)Poisson = 0

everywhere, and the two

Assuming that

p > 0 and a> 0 , _!_ p = _ _!_&.The trajectories will tend to avoid p a

trajectories are nowhere tangent to each other. Although any streamline tangent to the current density will be sufficient for generating initial points, it is a straight line joining the two electrodes as a generator for initial conditions that is often convenient. The reason for this is mainly due to the geometry of the phantom involved. It is symmetrical about such a line, and the domain tends to narrow abruptly near the centre into a channel. In this case, the current density about this channel will predominantly contain a component parallel to a straight-line joining the two electrodes. With such a line of initial conditions, the domain may be split into two halves, each containing trajectories that move away from the initial points on the line . It is also worth considering Liouville's theorem for stability. Using the equations:

regions of higher conductivity, but not to the extent as the trajectories in the coil, since the continuity equation lacks the forcing term aB z . The advantage with better stability is that in practice, there are no modifications needed as those used for the coil. MAT LAB is still the best environment for the solution of the inverse for the lead field. The lead field current density components are first solved for as Poisson equation forward problem for a given a with COMSOL:

oV ¢1 ead

in the

-v.oV ¢lead == 0 with the boundary condition an¢lead = 0.
Once the current densities are known, they may then be used to determine the trajectories along which the conductivity is determined.

the divergence of the phase space is:

78

79

3.2.3.1 Results
It has been found that the initial conditions all lie on a streamline, and this curve divides the domain into two regions. Trajectories beginning at initial conditions along the streamline will traverse only one of the regions with the characteristic equations so far. The current density due to the lead field has a very different geometry from the coil and a plot of the phase space trajectories now contains separatrices, boundaries which separate two trajectories with very different long-term behaviours, shown in Figure 13. There is no longer a single fixed point and individual trajectories do not intersect each other anywhere throughout the domain. This system may be modified so that the trajectories will fill the other region

x == -Jy y · == J

X

o- == -(j(vxJ)

Z

1

1.5

Separatrix (red)

In practice, both equations are used to obtain points domain.

(x,y , (})

for all regions in the

Unfortunately, determining the initial conductivities may be a problem under certain
::)

,...... 0.5
(f)

~
·;::
<(
(ij

circumstances. Although the initial x and y coordinates may be found along streamlines
Streamline of
- --:1!:H..............._........~._.~._.~._- Initial Points

0

of the current density, the initial conductivities cannot, because the initial conductivities also lie along a streamline of the current density. Recalling the results seen previously with Poisson's equation, the conductivity distribution cannot be obtained along a streamline. The lack of any prior knowledge of the conductivity distribution along any

.E

(..)

(black) -0.5

>
Ill 1

Q)

.
"

-1

streamline of the current density may pose a problem. One solution to this dilemma is to use a streamline which traverses a region of known
1.5

'

-1 .5 -1.5

-1

-0_ 5

0

0.5

Horizontal Axis (AU.)

background conductivity. Then the initial conductivities along the streamline are known and the trajectories may use the coordinates along this streamline as initial positions.

Figure 13. Trajectories for lead field reconstruction. The horizontal line contains the initial conditions and the trajectories fill the domain. The vertical line is the separatrix, which separates trajectories with long term behaviour. The trajectories are perpendicular to the lead field current density, which is obtained from the COMSOL forward model.

80 81

Happyface Conductivity Distribution
Max: 2.035 2 1.9 1.8 1.7

Happyface Conductivity Distribution Reconstruction 1

0.5

0.5
...-

s.
<(

~
0

"' x
u

s.
>
~
:::1

:::)

1.6
1.5

:::>
(/)

...-

-;

~

~
X

1.6

:::>
...... :~ ...... (.J
-o
:::J

~
>.,.

>

'E Cl)
-05

-= c
u

<(
1.4
1.3

0

1.5
1.4

=

u

ro

t:::

>

Q)

u

0

c

1.2

1.3

-0.5
-1 0
1;1

1.2 1.1
-0.5 0 0.5 Horizontal Axis (A.U.)

0.5

1

1

1\.tn: 1.00

lil

il

iI

Horizontal Axis (A.U.)

,. ,.

)I'

1

1

!'

Figure 14. Happyface conductivity distribution. The domain is mostly filled with a region of constant conductivity, and it is possible to find a streamline which traverses only this region. This may be used for initial conditions to find the conductivity in Figure 15. This COMSOL forward model will generate current densities which are then used to generate the trajectories in the reconstruction.

Figure 15. Reconstructed happyface conductivity using the background conductivity. The time needed to complete 400 trajectories is comparable to the coil, about 30 minutes.
Another solution to uncertain initial conductivities uses the observation that the calculated conductivity eventually converges to the real conductivity after a longer trajectory time. The remedy for the lack of initial conductivities is to sample the neighbourhood of the initial line to determine whether the conductivity changes along the trajectories. This is done by solving the characteristic equations for very short trajectories for each initial condition and then updating the initial conductivity once each

82
83

integration has terminated, with the conductivity at the end of the trajectory. There is no limit on how many times the initial conductivity may be updated, except computational time. The initial conductivity will slightly improve with each update, but the updated conductivities may also converge to very unrealistically small values. While the idea behind making repetitive updates is to make the initial conductivity converge to the correct form, each update must be multiplied by a scaling factor to ensure that the new maximum is the same as the maximum of the pre-updated conductivity. By doing successive updates over short trajectories near the initial conditions, the intent is to create an overall longer path composed of many short trajectories. Also, conductivity updates along these short trajectories will take into account the local distribution of conductivity near the initial conductivity.

The only option at present is to begin at the line of symmetry in the horizontal axis in Figure 17. The initial conductivity along this line will be a constant due to the lack of knowledge of the actual initial conditions along the initial conditions. An example is provided in Figure 16 in which the conductivity changes everywhere. There is no longer any streamline which traverses a region of constant conductivity and conductivity distribution along any streamline cannot be inferred otherwise.
Conductivity Reconstruction with Constant Initial Guess

1

0.5
,--.....

::::;.
Max: 2!:D

~
U)

c:(

X

0

~'I' ~I ~II

r.ll l

u
0.5

(1!i

t:

. I

~I t

~:

;-

>
::i
0

Q)

"'

s.
~

~

s.
z:.
ti

-0.5

iii (.I

2
u
-05

l: ID

'1:1

>

= = 0

-0.5
-1
-1

0 Horizontal Axis (A.U.)

0.5

1

0
Horizontal Axis (A.U.)

0.5

1
Min: 0 500

Figure 17. Conductivity obtained from a constant conductivity along the initial conditions. The initial conditions lie along the horizontal line of symmetry. Without knowledge of the conductivity along these initial conditions, the

Figure 16. Forward problem with COMSOL in which the linear conductivity in the x-direction. The conductivity is changing everywhere in the domain.

conductivity is not well represented near the line, but it eventually converges to the correct value.

84

85

Reconstructed Linear Conductivity
Channel with a Line arty Varying Conductivit¥
Max: 2 45

0.5
,.........

::)

::::>

05

~
(I)

~
t3

:::i

$
X

L5
0

:~

:::=-. ......

.!!

<

c:{
u
t
(U

X

0 .75 -0.5

]

"0

='

>

'f CD
.{)5

0 (.)

c:

>

(l)

0.5
-1

-1

.{)5

0

0.5

"'rt5.cx&7

Horizontal Axis (A.U.)

-0.5

0
Horizontal Axis (A.U.)

0.5

1

Figure 19. The forward problem of a phantom with linearly varying conductivity in the vertical direction.

"I I'
I
I

Figure 18. Image obtained after 100 updates of the initial conductivity. The conductivity near the initial conditions may be sampled repetitively with very short trajectories near the initial conditions to obtain an improved profile of the conductivity along the initial conditions. Such sampling will increase the runtime to roughly several hours for 400 trajectories.
This reconstruction may be used for other domains, such as those with a geometry resembling the phantom used for experiments. The geometry of the lead field current density allows for trajectories that will fill the domain, so that sharper edges in the boundary are better represented in the reconstruction.
-0.5 0 Horizontal Axis (A. U.) 0.5

Figure 20. Linearly varying conductivity obtained from current density. The reconstruction allows for sharp edges about the central channel.

86

87

Horizontal Conductivity Reconstruction

However, a lack of knowledge of the conductivity at the initial conditions can also hinder a proper conductivity reconstruction. In Figures 21 and 22, the conductivity now varies linearly along the horizontal direction which coincides with the predominantly horizontal current density.
_....
~

0.5
~
(/)

Channel with a Horizontal Conductivity Variation
Max: 245

~
(U

X

0

.5
.4 .3

~ :::)
:~ t)
::J
""0

>..

(..)

c
0

1

1::

>
0.5

Q)

(.)

-0.5

.2
.1

x <(
u ~
'ij
G)

s. .,
0

:::)

s
> ~

3'

LS

~
::::1

-0.5

0
Horizontal Axis (A.U.)

0.5

>

= u
-05

-= c

Figure 22. The reconstructed conductivity with an error in the channel.
Although the geometry can be reasonably reconstructed, the correct conductivity cannot be returned. The conductive region is more constrained and the current density in the

-1

center of the channel can only have an x-component. The characteristic curves can only
-1
-0 5
0
0.5

1

Min: 1.2Se-6

be vertical, and with the technique of repetitive short trajectories used, these trajectories will only be able to travel along regions of constant conductivity. An unconstrained domain allows the characteristic lines to curve more so that conductivity gradients away

Horizontal Axis (A.U.)

Figure 21. Forward problem of a linearly varying conductivity in the horizontal direction. The lead field current density is obtained from this forward model.

from the initial conditions may be integrated both vertically and horizontally. The trajectory geometry is a major factor in the ability of this inverse to function.

88

89

3.2.3.2 Discussion

Chapter 4. Discussion and Future Work
In closing, the reconstruction of the conductivity may be achieved for the lead field current density in addition to the coil field current density. Its properties, when applied to the lead field, differ greatly from those of the coil field. The geometry of the lead field current density changes the initial conditions from the fixed point seen in the coil field to a streamline of the current density. In particular, the conductivity along the streamline of current density can be indeterminate unless it is known background conductivity. The reconstruction involving the lead field current density is, however, more stable to increases in conductivity than its coil field equivalent. With stability also comes improved resolution, because the characteristic curves do not diverge so easily. The application of the method of characteristics to the solution of Maxwell's equations for the conductivity has been proven to provide reasonable reconstructions from either the lead field current density or the coil field current density, with few caveats. The method has not been tried on current densities obtained from experimental data, which may have unexpected effects on its ability to obtain the conductivity. There is also room for improvement in the handling of noise in the current density. Given all of the uncertainties of its further use, it is helpful to know the important aspects of the theory behind the method of characteristics, so that improvements may be carefully applied. This theory has been presented throughout this thesis as needed. In future work there are several avenues to the improvement and extension of this method.

4.1 Initial Conditions of the Conductivity

The initial conditions of the conductivity have not yet been addressed entirely. For the coil method, they are not as major an impediment as they are for the reconstruction with the lead field. The conductivity was already found to correspond to the 'energy' function of the phase space created by the method of characteristics when applied to first order partial differential equations involving the current density and the conductivity. This 'energy', not necessarily the physical energy, is often referred to as the Lyapunov function, and it is typically found by trial and error. In a physical system it may be the Hamiltonian from which the equations of motion are derived. Any ongoing research in differential equations is likely to include newer analytical techniques that may help to

90

91

determine an appropriate Lyapunov function given only trajectories parallel and perpendicular to the current density. Perhaps such a technique may aid the lead field reconstruction by providing at least an initial estimate of the conductivity distribution along the line of initial conditions. Finding initial conductivities more effectively will also serve in realizing three dimensional images of the conductivity.
(/)

Lead Field Current Density Reconstruction with 10 Percent Noise -0.2
.2

-0.4

1.8

~ -0.6 co

4.2 Noise and Computational time

· t:

(.)

>
-0.8

One issue of importance to imaging is noise. In this thesis, most of the reconstructions were done without noise, to assess their inherent properties. For actual current density data, it is prudent to test the reconstruction for behaviour with noisy data.
-0.8 -0.4 -0.6 Horizontal Axis (AU.) -0.2

Figure 24. Noise in the lead field reconstruction.
Coil Field Current Density Reconstruction 'With 10 Percent Noise

Figures 23 and 24 are a comparison of noise of the coil field and lead field responses of ten percent noise in the respective current densities. Fortunately, the main image is obvious, but the characteristic curves are also pronounced. In comparison to noise-free

:::>
(J)

~1

1.7 1.6

simulations, the time taken for data with ten percent noise added is roughly ten times longer for the same number of trajectories. Typically 400 trajectories are needed for a reasonable resolution in the inverse with a run-time on the order of a half hour. With noise, the time to complete this number of trajectories will be on the order of a day. Possible remedies in the near future may be to apply filtering to the noisy data to exclude high frequency oscillations, or to include regularization [25] in the reconstruction to exclude a rapidly varying conductivity along the trajectories. In the presence of noise,

~

~ 0
(ij

~ -1
-2

· -e

u

-3

-1

0

2

3

the determination of initial conductivities may also become more problematic.

Horizontal Axis (AU.)

Figure 23. Noise in the coil field reconstruction.

92
93

4.3 Practical Considerations in the Resolution
_1 (J d(Y -J d(Y)+_!_(dJx _ ()Jz )=-B

o-2

z

dx

x dz

o- dz

dx

Y

The profile of the ultrasound cross-section has been assumed to be a delta function so that we can obtain an ideal distribution of current density point-wise. In experiments, the resolution of the current density distribution is limited by the beam diameter of the ultrasound wave. Consequently, the resolution of the reconstructed electrical conductivity cannot have a better resolution than the ultrasound beam diameter even in an ideal reconstruction case (see Appendix 8.3 for focused ultrasound). In addition, noise in the experimental data will deteriorate the image resolution further due to the cut-off of the high frequency component of the signal. This is the common These equations may be converted to their equivalent characteristic equations

.

feature of all imaging modalities.

4.4 The Prospects of Three Dimensional Imaging
Also the characteristic equations from Poisson's equation may be included In the present stage of MAET experiments, the current density distribution is
ob~ained

in

a thin (compared with the ultrasound wavelength) sample due to the oscillatory nature of ultrasound waves. Therefore, two dimensional image reconstruction was concentrated upon in this thesis. The method to measure the current density in the interior of a thick sample is being investigated, and the question of three dimensional images will be addressed. Recall that Faraday's law originally had three components, although only the third was used. Four sets of phase spaces will require four parameters (s 1 , s 2 , s 3 , s 4 ) .The coordinates which these parameters will determine are:

(x, y, z, o-) == (x (s 1 , s 2 , s 3 , s 4 ), y (s 1 , s 2 , s 3 , s 4 ), z (s 1 , s 2 , s 3 , s 4 ), o- (s 1 , s 2 , s 3 , s 4 ) ) , since
the conductivity is now also a coordinate. With four phase spaces, there is every possibility that the transformation (s 1 ,s 2 ,s 3 ,s 4 ) ---7 (x,y,z,a) will determine unique conductivities. The Jacobian for this transformation is:

_1

(J deY -Jz dCY)+_!_(dJz _ ()JYJ=-B o- 2 Y dz dy o- dy dz x

94

95

ax

as] as

ay

J= az1

as] aa as]

ax as2 ay as2 az as2 aa as2

ax as4 ay as4 az as3 as4 aa aa as3 as4

ax as3 ay as 3 az

space will be orthogonal to each of the three other equations, even if they are not orthogonal to each other. It may be possible to use Poisson's equation trajectories as initial conditions for the three curl equations to find the conductivities in the yz, xz, and xy planes throughout the three dimensional domain. The question of initial conductivities will also be important here. All of these data will be four dimensional points, but MATLAB is very capable of interpolating such points. Hopefully this will lead to the three dimensional images of conductivity alluded to in Wen's paper [7].

Using the values from the four phase space equations,

0

Jz
0

-Jz J= J -o{VxJt -a2 Bx
and the determinant of
I

-Jy Jx
0

- a(V X Jt -0" 2 By - a(v x Jt -a 2 Bz
is

-J

X

Jx Jy Jz
0

4.5 Other Considerations
'

The method of characteristics applied to partial differential equations of the conductivity resulting from Maxwell's equations has been able to provide conductivity images for at least two configurations in current density, the lead field and the coil field. The differences between these configurations are a result of the different geometries of the

,,, ,

J

II

I' ~I I'

I :!

I

,

or

a(J · J).] · ((vxl)+ aB) in vector notation.
unconditionally in the coil reconstruction, that is if

current density. The original configuration tested was the coil field, and the highlights in the conductivity

jJj :t. 0

B i= 0,

or conditionally for a

reconstruction were: · · · · A fixed point, which required only one initial conductivity. The ability to reconstruct absolute conductivities. Prone to great instability unless modified. The inherent resolution is limited by the divergence of the trajectories resulting from Liouville's theorem, and it decreases further away from the coil axis.

change in the conductivity with the electrodes for

B = o provided that Vx J :t. 0.

There is much work that needs to be done in this area, and nothing has been tried, but there is one possible route that may be attempted. Recall that from the lead field reconstruction, the curve of initial conditions needed to be orthogonal to the characteristic equations that determined the trajectories. The Poisson equation phase

96 97

The lead field reconstruction had different properties due to the different current density geometry, and its main features are: · The initial conditions lie on a streamline of current density, and the conductivity along that streamline must be known. · · · Is only able to reconstruct relative conductivities. Relatively stable, with arbitrary conductivity anomalies.

Appendices

Appendix A: Electrical Impedance Tomography

The background to electrical impedance tomography is presented here for comparison The inherent resolution is still limited by diverging trajectories, but not to the extent seen in the coil. The initial conditions lie along a streamline of current density, and the resulting trajectories can fill the phantom more uniformly. The overall resolution is better than that for the coil. Aside from the different configurations and their reconstruction properties, use of the method of characteristics is based on the assumption that the current density and the conductivity are both continuous functions of position with continuous first derivatives. It is anticipated that even in the presence of noise, real current densities with real conductivities will indeed have these properties even with noise and smoothing of the data. Although real conductivities may change over short distances, a sudden jump, such as a Heaviside step function is unlikely. Electrical impedance tomography is an imaging modality that makes use of an applied This system of reconstruction is relatively new, but given these considerations, it should be pursued further, especially now that its basic properties are known. electrical current to probe the inside structure of a body. The method is sensitive to electrical conductivity since a known current is injected into the body and the resulting electrical potential is then measured at regular points along the boundary. It is possible to then reconstruct these voltage measurements in such a way as to obtain a picture of the conductivity distribution within the body. Since alternating currents can be used, it is also possible to measure the impedance, although it is the conductivity (real resistance) that is more often done. to MAET. Like MAET, EIT is a device intended to measure the conductivity in a volume conductor, and its analysis consists of both a forward and inverse problem. Unlike MAET, it is already in widespread use, although its resolution is poor due to the illposedness of the inverse problem. Due to the similarities between MAET and EIT, the inverse for EIT was also considered as a possible method of reconstruction in MAET, although a more appropriate technique was found.

A.1 Introduction

98

99

A.2 Sheffield systems

Sheffield systems need multiplexers to switch current to adjacent electrode pairs and this switching will introduce extra shunt capacitance on the electrodes. As a result, only the real (resistive) component of the voltage is used while the reactive component is

The most common EIT systems are the 16 electrode systems with a single current source from Sheffield. There are three versions : the mark 1, mark 2, both of which are single frequency, and the multifrequency mark 3. The mark 1 supplies current at 50kHz at 1 rnA, and the potentials are measured from the remaining electrodes. The mark 2 operates with a 5 rnA sinusoidal current source at a frequency of 20.83kHz, which is generated using a DAC that reads a ROM lookup table as it is very difficult to generate stable sine waveforms otherwise. Using any other waveform will lead to corrupted signals as only certain harmonics would be corrupted by the complex impedance ,of biological tissue. The current source is coupled via a transformer primarily for safety reasons to allow the subject to float with ground potential so as to prevent electric shock. A current sensing resistor is then placed in series with the subject to monitor current. Differential voltages are then measured between adjacent electrodes using AC coupled instrumentation amplifiers. These instrumentation amplifiers are then
I

ignored, omitting any impedance reconstruction. For any object with cylindrical symmetry, there are normally 16 electrodes evenly distributed about the circumference per layer. This measurement strategy is called the Sheffield measurement protocol and adjacent electrodes between layers are used to apply current while voltages are measured along the remaining electrodes about the circumference except for those electrodes closest to the current sources. For 16 electrodes there will be 16 measurement patterns each with 13 voltage measurements along the circumference for a total of 208 per layer. Of the 208 measurements, only 104 are non-redundant due to reciprocity.

A.3 Physical motivation

II
I
I

transformer coupled to OTA's or variable gain amplifiers. These OTA's (operational transconductance amplifiers) usually operate as matched transistor pairs so AC coupling will allow proper biasing of the transistor bases. Since instrumentation amplifiers are used, it is important that they have a high CMRR. Ideally, if the two inputs are tied to the same voltage then the output of such an amplifier should be zero. Any mismatch between input impedances will inadvertently cause a differential input voltage and nonzero amplified output. Problems with CMRR worsen with increasing frequency, but they may be compensated for by adding an extra current source far away from the electrodes so as to create an extra voltage and reduce the common mode seen by all amplifiers. For such compensation the gain must be kept relatively low so that unwanted oscillations do not occur. The divergence of Ampere's Law is: For a single frequency
OJ,

I

I

;i

!!

The physics behind EIT is governed by Maxwell's equations. or or

Vx fi = j (J£E + J

(Ampere's Law) (Faraday's Law).

vX E = -JOJf-LH
- Jill -.

with the fields being related to material properties by :

D = cE and B =

-

-

100

101

v. (vxii )= v. (JO£E +1)= o.
V · J = 0, J = aE , and E = - V¢, the divergence in terms of the gradient of the potential leads to Poisson's equation. - V · oV ¢ = 0 with a
For a constant current, Neumann boundary condition

The second term can be rewritten using integration by parts and the divergence theorem.

- f1 m·V¢ddV= JV·(¢d] m)dV= f¢d1m·ndS.
n n an

dn¢ = 0

also known as Kirchoff's current law. Poisson's For the point of contact for the electrode,

equation is also known as the forward problem as its solution will determine the potential

J m = I 0 8dm

and:

¢

at the boundary. The preferred method of solution to Poisson's equation is

by finite elements.

f¢d] m· ndS = f¢dio8dm dS = Vd io,
an an
at the point of contact of the electrodes. The reciprocity is now:

A.4 Reciprocity and the Sensitivity matrix

a k fv ¢d · V ¢m dV = -I 0 Vd,
n
for a constant conductivity for the kth simplex. For a unit injected current I 0 any ·change in
vd

In the discretized forward model the domain is divided into k regions each with a constant conductivity and measurements are taken from m electrodes for a drive pattern
Ill
II
II

is entirely due to a change in

(J' k :

d. This is a situation in which we are trying to infer the interior fields from those at the boundary. This is done by applying the reciprocity theorem. Let ] interior fields about
d

and

E d

be the

8Vam = -Jak JV ¢a · V ¢m dV.
n
This leads to the Jacobian:

!! !;

ak and Jmand

Embe boundary fields near the electrodes. The

reciprocity theorem relates these quantities:

fJd .£m dV- fJm.£ddV=O. n n
Using the interior conductivity a kwith potentials f/Jd and t/Jm : This is a linear transformation that relates the measured voltages to the individual conductivities within the domain and it is obtained from the forward problem. The

fakV¢d ·V¢mdV- fJm ·V¢ddV=O.
n n

Jacobian of voltage with respect to conductivity is appropriately named the sensitivity matrix as it measures the degree to which measured voltages are affected by changes in conductivity and it is practical way of making simulations compatible with experiment.

102

103

A.5 Optimization and reconstruction

Although it is desirable from an optimization point of view to have many slack variables, the main disadvantage lies with experimental error and noise. Any error in the measured voltage could likely result in a suboptimal determination of all conductivities.

With the Jacobian, if there are as many conductivity regions as there are measurements then by finding the inverse of the Jacobian one should be able to use these measurements to find the distribution of conductivities. 208 total measurements can only determine 104 conductivities in 104 subdivisions of a cylindrical cross-section uniquely due to reciprocity. Unfortunately, this is poor resolution, as this is far greater than the millimeter resolution for ultrasound for anatomy-sized dimensions. One might wish to increase the resolution by introducing more conductivity regions for the same domain, for example to 256 or 512. In that case, the Jacobian is no longer a square matrix but a rectangular one. The excess conductivities introduce slack into the corresponding voltages so that the transformation from voltages to conductivities is no longer unique and matrix inversion is no longer straighforward. In this case we must consider some way to 'guess' at the conductivity so that its corresponding voltages match the observed voltages as closely as possible.
II
I

One way to invert the matrix J dm,k == J is to use singular value decomposition. As the Jacobian is non-square then there will be two possible ranks determined by the number of conductivities and voltage measurements. This leads to two metrics J HJ and JJ H both of which are positive definite square matrices but differ in rank. The superscript H denotes the Hermitian transpose where the conjugate of complex entries is taken.

J H J has a complete set of eigenvectors

vi with real eigenvalues Ai. These
ui also with
Or == 0- 1 . The ranks

eigenvectors may then be normalized so that their subspace forms a unitary matrix

pr
of

==

v-

1

·

Similarily JJH also has a complete orthonormal basis

eigenvalues

A.i,

and its subspace of all eigenvectors is the matrix

0 and V will depend on which quadratic form is greater in rank. The singular values

av Tthe Jacobian is: __!!!!!:_ == - fv ¢d · V ¢ aak n

are simply the square roots of these eigenvalues. cti ==

ji; . The norm

m

dV == Jdm, k .

The linear transformation between voltages and conductivities is t5Vdm == J dm ,kt5ak. For excess conductivities there will be fewer linear equations in more unknowns

a k.

~.Suppose that there exists a matrix
(}"}

1

I:ii == cti padded with zeros so as to make it an

Consequently, there will remain a number of arbitrary conductivities that may give a solution to Vdm. Given this immense subset of feasible conductivities we choose those conductivities that minimize:

m x n matrix, then

J

JV == UL. If V is a unitary matrix then V can be decomposed into == ULVr with I:== or JV. Once the eigenvectors and eigenvalues are known then

104

105

the inverse is J- =

1

Or.- 1vr

with

Lii -1 =

~
l

a.

is simply the transpose of l:.
1

as a penalty function. If the conductivity happens to be a step function, then its gradient will be a delta function, and at least in the ideal case, the penalty will have a value only

" -1 "T II J -1 = UL v . It solves Ja-

vmeasured

II 2 as J-

v measured

=a' for the conductivity.

at the discontinuity and zero value elsewhere. The use of a Jacobian is based on the assumption of a linear relationship between voltage and conductivity for small conductivity variations. For realistic calculations it is likely that this relationship is nonlinear and that the optimization so far is only somewhat useful. It is still possible to use the optimization covered so far, but as successive approximations to the true conductivity. Keeping in mind that the Jacobian and its inverse are an array of gradients, and that

The singular value decomposition alone is not sufficient to solve practical problems which involve noise. It may inadvertently change in the rank of the Jacobian, so that its inversion leads to erroneous results. One common method is to introduce regularization, and there are several kinds, two of which will be covered. They all involve constraining the conductivity so that it retains 'reasonable' values while at the same time the inverse, though not exact exists. The first is Tikhonov regularization and it is essentially a simple penalty function:

J H Vmeasured is a gradient vector of the

conductivity, allows the use of gradient search methods throughout conductivity space. A gradient search method may be visualized as a search for a hill or valley depending on whether a maximum or a minimum are desired. For a maximum, the search direction should be a positive gradient and for a minimum it should be a negative gradient, as

The a is a Lagrangian multiplier and its value enforces how small the conductivity should be. The singular value solution is (}'mm .
1

care with signs is important. One way of finding the zero of a gradient (extremum) is to consider Newton's method of finding zeros. In the single variable case
xn+I

= (JH J + a I)-

2

1

JHVmeasured ' where I · 1s

il

an identity matrix. In the event that

A= 0

(lower rank Jacobian), at the very least

a min

avoids a zero denominator. One modification to the optimized conductivity is to adjust the penalty term to allow conductivities centered about some background conductivity

= xn- 1 f (xn)

?n)

solves f(x)

= 0 and this may be modified to x
n

+I

=x
n

-

f

f'?n)
1

(xn )

ao: a min
choice of

=

minaiiJa-

Vmeasured

r + a lla- aoll
2

to solve

j 1 (xn ) = 0. For the multivariable case with a vector of conductivities, the

2

to constrain the contrast. Helpful as

Tikhonov solution may be repeatedly used to accomplish this as:

it seems, Tikhonov regularization may not always offer a good reconstruction. The

a

presupposes the conductivity distribution and may lead to a form of

a n+l

= an + (J n HJ n + a 2 I) -l J nH v measured +regularization .

'cheating'. The other form of regularization is total variation regularization. It measures the degree to which the conductivity changes (or oscillates) over the domain. It is defined as TV( a)=

The vector of conductivities will then be updated after every iteration along with the Jacobian. The stopping criterion is when the variation in conductivity

~V a~V.
n

J n H Vmeasured is

Even if the amplitude of the conductivity is small, for below some tolerance, which is when a minimum in the conductivity is obtained . Unlike

example, any high frequency spatial oscillations will be filtered out when this is added

106

107

the single variable case, second derivatives are neglected (although they need not be) for simplification purposes. These optimization methods and their variants work for practical reconstructions in EIT. They are all seemingly unconstrained optimizations, and they all search conductivity space to find the set of conductivities that will allow the forward problem to match experimental measurements with varying success. The reconstruction of EIT is not so straightforward and it is amazing how far simple optimization can lead to success given the ill-posed ness of the problem. Although it is not apparent, the constraints are indirectly used in the objective functions in the form of the Jacobian, and in a standard optimization they would be multiplied by Lagrangian multipliers. As the Jacobian is included in the objective function, all constraints are always active saving much algebra which would otherwise result, though at the cost of adequately representing nonlinear conductivities.

conductivity together with regularization in EIT was surpassed by a more applicable method. Optimization is useful if no relation is known to exist between measured (in EIT it is voltage, in MAET it is current density) and inferred (conductivity) quantities. In MAET, there was a definite relation, and optimization was not needed.

References: Holder, DavidS., Electrical Impedance Tomography: Methods History
and Applications , lOP Publishing 2005

A.6 Conclusion
I

·I

This year marks the 30th anniversary of Electrical Impedance Tomography (EIT}. It uses well defined physics and easily available technology to image conductivity (and impedance) safely, but research continues for improved impedance imaging. The inverse for EIT was presented in detail because it was tried as a prototype to the inverse in MAET. Both modalities are designed to measure the electrical conductivity within a volume conductor, but it is MAET which promises higher resolution conductivity images, made possible by an emf created inside the volume by ultrasound. The inverse for MAET should also accommodate this innovation, and indeed the optimization in the

108

109

Appendix B : Ultrasound

where U is the internal energy, P is the pressure, and V is the volume. For a simple relation, the entropy is a function of pressure and volume,

S= S(P, V).

Its differential in

The forward problem of MAET depends on ultrasound to resolve the lead or coil field current density. The contribution of ultrasound is approximated to a point source of emf in the application of the reciprocity theorem, so that the lead or coil field current density may now be mapped point-wise with either a simulation or experimentally. While this simplifies the model considerably, it neglects the wave properties of the ultrasound. This appendix explores the effect of the wave nature of the applied ultrasound on the induced emf.

terms of the two independent quantities is

ds=(asJ dP+(asJ

aP

v

av

dv.
p

The subscripts V and P with the partial derivatives just indicate which variable is held constant when that derivative is taken. For an adiabatic change,

dS = 0, and the result is a relation between the pressure and dP =-(a~)

There will be three sections in which the wave equation is derived and then incorporated into the Lorentz force to visualize a more complete induced emf.

volume.

as v

(as]

av

dv.
p

8.1 Thermodynamics of Ultrasound
For three variables, the possibilities that any variable is a function of the other two is s = MAET relies on the action of an ultrasound. As described by Cobbold [8], the acoustical part of MAET may be considered using thermodynamics [9]. Relations involving the entropy aP) (asJ (av) =-l,or ( as v av p aP s

I I

S(P, v)'

p=

P(s, v) ,and v = v(P,S ), which lead to the relation

(a~) (asJ as v av

=-(aP).
p

av s

S are often referred to as the TdS , or 'tedious'
The pressure-volume relation now becomes a seemingly trivial:

relations, in which the entropy may be a function of any two of the temperature, pressure, or volume, leading to three possible relations. The combined first and second laws are:

dP = TdS = dU +PdV,
The adiabatic bulk modulus is defined as:

(ap). dV. av s

110

111

Ks

=-v(aPJ a ,
v

this section is to ultimately arrive at a wave equation. Starting with continuity, if a fluid has a density, then its total mass is :

s

~

and volume is related to density as V =-, and dV = - dp. Substitution of these 2

1

1

m= JpdV,
Q

p

p

values into the pressure-volume relation leads to:

over an arbitrary volume in Q, and any change in the mass, which is:

Om= f()p dV,

at Qat

The differential may be expressed in terms of the pressure:

can be attributed to an outward flux of mass leaving the test volume through the boundary

an '
- JpV·nds.

an
This is a very desirable result for thermodynamics. It is known as an equation of state, which relates thermodynamic variables. In this case, the pressure and density (reciprocal of volume) are related, the temperature is the dependent variable but indeterminate, and the entropy change (heat dissipation) is zero, in an idealized process otherwise known as isentropic. With zero entropy change lies the assumption that all of the PdV work done to compress the fluid is stored in the fluid as its internal energy Using the divergence theorem:

,,

JpV. nds =
an

Jv. (j]V}Jv ,
n

allows the divergence of the flux to be related to the rate of change of density:

dU with no energy losses by heat dissipation, since dU + PdV = 0.

Q

ap + V - · (pv -)dV = 0 , S at ap + V · (jJV) = 0 point-wise. at

8.2 Fluid Mechanics of Ultrasound
'

or

Using tensor notation, conservation is: Aside from the equation of state, the other important relations involve the conservation of mass, known as continuity, and momentum, as outlined by Kundu [1 0]. The goal of

112

113

where repeated indices in a term represent a sum. In addition to continuity, conservation of momentum may be expressed in a similar manner by replacing the density p with which implies that

pvf3

as now it is the momentum that is conserved. A test volume will

arap . fp == - - . The inhomogeneous term may now expressed 1n terms ax a

of the stress tensor in the momentum balance equation: have a density of momentum, and any change in this density will be the flux of momentum density through the surface of the volume:

In the simplest case for a fluid, which is that for an ideal gas, in which only normal

fp is a force density, and unlike the case for mass conservation, this inhomogeneous
term represents a loss (or gain) to the total momentum per unit volume. Expanding the left hand side, the momentum conservation is:

forces act and there is a lack of shearing forces, rafJ == - P 6af3, where P is the pressure and

6afJ

is the Kronecker delta. The negative sign indicates that the pressure is

directed opposite to the outward normal to the surface, so it is directed towards the interior of the test volume. As the outward flux of momentum is balanced by the inward body force the net sum of forces is zero:

The bracketed term vanishes due to mass conservation:

p( av f3 + v avf3 J== f . at a axa f3
The total force is the volume integral

In terms of more familiar vector notation, momentum balance becomes:

JfpdV,
v

but by the divergence theorem, it may

av _ --) ==-VP. p ( a(+v·Vv
The total time derivative for the velocity is:

also be the divergence of a stress r af3 applied at the surface:

dv av n-==-+v· vv,
--+

dt

at

114

115

and it will allow some simplification to the more familiar form of Euler's equation:

while differentiating the modified continuity equation with respect to time:

d (- -) -2-+PoV·v =0. dt dt
The gradient in the pressure is the force density which accelerates fluid volumes with density

d p

2

p. The continuity equation

is:

Eliminating

V · v leads to:

dp - ( ) ar+V· pV =0,
but it is also easier to introduce the total time derivative for the density,

and using the equation of state to relate the density to the pressure:

.

-=-+v·Vp.
dp + pV ·v = 0. To obtain a wave equation in pressure, it is dt

dp dt

dp dt

- -

(p J
-

Ks

-1

d2P - - 2 = V · VP,
dt

or - = 2

d 2P dt

( Ks . -

-

p .

JV · VP or JUSt d P - = V P.
.
2
2

dt 2

The final result is the wave equation for pressure for acoustic waves for infinitesimal amplitudes. Here the speed of the wave is

Continuity then becomes

~.

the velocity, which is common to both the continuity equation and Euler's equation that is eliminated. A simplifying assumption that may be applied now is to assume that the density varies about some equilibrium density p 0 :

The wave equation presented so far will have two solutions, namely P = P0 eJ(k-r-ax) and P = P0 eJ(k·r+ox), where

k is the wavenumber and P0

is the amplitude.

dp -+p 0 V·v=O dt '
and

Using the first solution of the two, the gradient of the pressure is Euler's equation, -

V P=

jkP, but by

dv

-=--VP.
dt Po
1 _

dv

1 -

dt

= _j_kP, so the pressure will need to be integrated with respect
p
1k-P
, or just v = -

·-

to time using a factor of - - to obtain the velocity, v = -

_

kp

jm

ap

ap

.

Taking the divergence of the modified Euler's equation leads to: Judging by the Euler equation, the velocity will have the same direction as the pressure

-) =--V·VP, 1 - -d (V·v

gradient, so that the waves are longitudinal, and the velocity

v is the parlicle

dt

Po

displacement velocity in which fluid flows into regions of lower pressure and away from

116

117

regions of higher pressure. The particle displacement velocity is very different from the wave velocity.

is treated as a continuum of point sources. The pressure in space is then the summation of these point source contributions. If the size of the transducer is much larger than the acoustic wavelength, then the

8.3 Focused Ultrasound

velocity potential may be found by making use of the point source solution to the Helmholtz equation in spherical coordinates,

e -fk·r
l~'l

.As the surface is continuous, the
<I>(r) may be evaluated as a

In practice, an ultrasound transducer not only has a finite size, but it also has a curvature, so that the pressure produced is focused into a relatively small volume. The plane wave solutions derived so far are more of an idealization of a focused transducer but the basic relations still hold. In re-visiting Euler's equation:

velocity potential will then be an integral over the entire surface of the transducer face. Using a spherical coordinate system, [11] the integral for
'

series of Bessel functions. Taking the negative of the gradient of the velocity potential will lead to the x,y, and z components of the particle displacement velocity

v, which is

dv =--1 VP dt Po '

the quantity of interest since it is the velocity with which the ions in the phantom move through a magnetic field. By virtue of this movement, the charges are then separated by the Lorentz force. Using the effect of a Lorentz force on a charged fluid particle due to its velocity, a solution was made using COMSOL. Recalling that electric field is a gradient of a scalar potential, density is

v may be the gradient of a potential <I>, known as the velocity potential. Substitution of v = -V<I> into Euler's equation leads to:
the velocity

1 -d (V<l> ) =-VP. dt Po
Using these plane wave solutions, the derivatives with respect to time and spatial coordinates will simplify this to kfP =-

J = a(E + vx B), and that the

E =-V¢, the expression for the current

1=a(-V¢+vxB).
V· J = 0, which in terms of the

jk P, and the pressure is just jp0 aA> = p. Po OJ

The governing equation is Kirchoff's current law potential is

The pressure and velocity potential are just proportional to one another and can be interchanged. This approach also has the advantage that both the velocity potential and the pressure are scalars, which is simpler to work with. For any transducer of arbitrary geometry, the method of Green's functions is used, in which the face of the transducer This equation may be solved using the Poisson equation solver in COMSOL, using particle displacement velocities obtained numerically.

- V· (lJV' f/J + a(v X jj )) = 0 , along with the boundary condition J ·n= 0.

118

119

The focal region is clearly distinguished in Figure 25. The simulated transducer was positioned above the page facing down towards the phantom. The magnetic field is assumed to have only a constant positive, and nonzero y component in this simulation, so that

The assumption in the reciprocity theorem, is that the ultrasound would resolve the lead field current density to within the size of a point, but this is just an approximation. Instead, the field from the ultrasound has the form shown in Figure 26. In this plot, the electric field is significant in a finite volume, but reciprocity may still be applied.
Electric Field Intensity along Horizonti!ll Axis
3~--~--~--~----~--~--~----~--~---:--~

vx B

is known.

In the actual experiments, the focal point would be scanned along the x-axis (horizontal line of symmetry), and the current density would be deduced from voltage measurements at electrodes placed on either side of this line of symmetry. With the
2.5

. ... -... . ... - -. . . .. .... .. . .

. . .- .. -- .. -. ~ . . ---. ..... -

reciprocity theorem, it is far more practical to consider the lead field, and to assume that the focus "illuminates" a small portion of the lead field.
::i
"iii c
2

.....·.............. L............. ..

:

s.
"'0

~

1.5

.... : .... --. -· -. -- --~- .. -- .. -. ---- -. ). -------.... -- ..i ----.-.-----.-.

Ma x: 2.586

-=
a;

s
u

:

:

u::

... ...... .. .............. .-........... ... ) ............. ............. .... .

:

Electric Field Distribution at Ultrasound Focus

i!i
0.5 1.5

~ Cll

...... ·... ....... '·· ··········· · · · · · "

······ ·············

::;
~
1
~ ttl c
~
Cll

0

0.5 :E

-=
0
Cll

-0 .5

-5

-4

-3

-2

-1

0

2

3

4

5

u:::
0

Horizontal Axis (A.U.}

:e w

-0.5
Horizontal Axis (A .U.)

Figure 26 Electric field at ultrasound focal plane along horizontal axis line of symmetry.

-1

Min: ·1.341

The value of the lead field current density near zero on the horizontal axis will be a centroid weighted about this function. An integral of this electric field a test function such as the lead field current density is known as a distribution[23], since the electric field

Figure 25 Electric field at the ultrasound focus

vanishes quickly to zero along the Horizontal Axis in Figure 26 as the axis value increases or decreases from zero.

120

121

References

10. Kundu , Pijusk K., Cohen, Ira M. (2002) Fluid Mechanics Second Edition, Elsevier Science (USA) 11. Chen,X. ,Schwartz, Karl Q. ,Parker, Kevin J , "Radiation pattern of a focused transducer: A numerically convergent solution", J. Acoust. Soc. 94(5),

1. Miklavcic, D., Pavsel, N., Hart, F.X., "Electrical Properties of Tissues"., Wiley Encyclopedia of Biomedical Engineering, John Wiley & Sons, Inc., 2006. 2. Gabriel (2007) Dielectric properties of biological materials Handbook of Biological Effects of Electromagnetic Field3rd edn ed F Barnes and B Greenbaum (Boca Raton, FL: CRC) 3. Kwon, 0., Woo, E., Yoon, J., Seo, K.,"Magnetic resonance electrical impedance tomography (MREIT) Simulation study of J-Substitution algorithm", IEEE 160-167,2002.

November 1993. 12. Lanczos, Cornelius (1970) Variational Principles of Mechanics, University of Toronto Press 13. Jackson (1962) Classical Electrodynamics John Wiley & Sons Inc. 14. Goldstein, Herbert (1980), Classical Mechanics Second Edition, Addison-Wesley Publishing Company 15. McConnell, A.J. (1957) Applications of Tensor Analysis, Dover Publications 16. Ballantine, S. "Reciprocity in electromagnetic, mechanical, acoustical, and interconnected systems", Proc. IRE, vol.17, pp. 929-951, June 1929. 17. Levandosky, J., Math 220A Lecture Notes, "http://www.stanford.edu/class/math220a/handouts/firstorder.pdf', Stanford. 18. Sanchez, David A. (1968) Ordinary Differential Equations and Stability Theory:An Introduction, W.H. Freeman and Company 19. Krusemeyer, Mark (1994) Differential Equations, Macmillan College Publishing Company 20. Path ria, R.K (1972) Statistical Mechanics, Butterworth-Heinemann 21. Plaat, Otto (1971) Ordinary Differential Equations, Holden-Day, Inc. 22.Xu, Yuan, He, Bin, "Magnetoacoustic tomography with magnetic induction (MATMI)", Phys. Med. Bioi 50 (2005) 5175-5187 23. Strauss, Walter A. (1992) Partial Differential Equations an Introduction, John Wiley & Sons. 24. Haider, Syed (2008) "Magneto-Acousto-Eiectrical Tomography: A Potential Imaging Method For Current Density and Electrical Impedance", Ryerson University

Trans. Biomed. Eng., vol.49,pp.

4. Griffiths, H.,"Magnetic Induction Tomography", Meas. Sci. Techno/., vol.12, pp.1126-31 ,2001. 5. S. Haider, A. Hrbek, Y. Xu, "Magneto-Acousto-Eiectrical Tomography: A New Imaging Modality for Electrical Impedance", 13th International Conference on

Electrical Bioimpedance combined with the 8th Conference on Electrical Impedance Tomography, Graz (Austria), 2007. 6. S. Haider, A. Hrbek, Y. Xu, "Magneto-Acousto-Eiectrical Tomography: A Potential Method For Imaging Current Density and Electrical Impedance", Physiol. Meas., vol.29, pp. S41-S50, 2008. 7. Wen H (2000) "Feasiblility of biomedical applications of Hall effect imaging", Ultrason. /mag 22,123-136. 8. R.S.C. Cobbold, Foundations of Biomedical Ultrasound, New York, Wiley 2007 9. Zemansky, Mark W., Dittman, Richard H., (1997), Heat and Thermodynamics Seventh Edition, McGraw-Hill Companies Inc.

122

123

25. Sumi, C., Ko, H., "Robust reconstruction of a physical parameter distribution using fewer field measurements of another physical variable: resolution of the problem of determination of conductivity", Meas. Sci. Techno!. 12 (2001) 589596.

124

