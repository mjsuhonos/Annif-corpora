On the Testing and Validation of Stray Light Attenuation for Microsatellite Star Tracker Baffles
by Martin Marciniak, B.Eng Aerospace Engineering Ryerson University, 2012

A thesis presented to Ryerson University in partial fulfilment of the requirements for the degree of
Master of Applied Science

in the Program of
Aerospace Engineering

Toronto, Ontario, Canada 2014 c Martin Marciniak

Declaration of Authorship
I, Martin Marciniak, hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners. I confirm that:

I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my thesis may be made electronically available to the public.

Signed:

Date:

ii

RYERSON UNIVERSITY

Abstract
Department of Aerospace Engineering Master of Applied Science On the Testing and Validation of Stray Light Attenuation for Microsatellite Star Tracker Baffles by Martin Marciniak

This thesis describes strategies to perform stray light testing in an earthbound laboratory while accounting for atmospheric and surface scattering phenomena that make these measurements difficult. We present a method to analyze and predict the stray light performance for a baffled star tracker optical system. This method involves a hybrid stray light analysis procedure that combines experimental measurements of a star tracker lens optics and uses ray-tracing to obtain attenuation curves. We demonstrate these analytical techniques using an engineering model ST-16 star tracker from Sinclair Interplanetary along with a baffle prototype. The system attenuation curve's accuracy is validated by comparing independently measured baffle attenuation curves with equivalent ray-tracing models. Additionally, exclusion angles are defined for the ST-16 sensor by calculating the false detection rate that varies with system attenuation levels. These techniques provide a versatile alternative to conventional testing for preliminary design stages for a star tracker baffle that emphasizes the use of modest infrastructure.

Acknowledgements
I would like to thank my advisor, Dr. John Enright, whose patience and forethought has guided this research in the right direction. I would also like to thank Doug Sinclair of Sinclair Interplanetary who generously provides his hardware so that this research may continue. This gratitude also extends to my fellow lab mates, both past and present, Tom, Dmitri, Geoff, Marce, Brendon, Ilija and Laila, that continue to make SAIL a special place to be part of.

iv

Contents
Declaration of Authorship Abstract Acknowledgements Contents List of Figures List of Tables Abbreviations Physical Constants Symbols ii iii iv v vii ix xi xiii xv

1 Introduction 2 Background Theory 2.1 Stellar Photometry . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.1.1 Photon Flux and the Spectral Irradiance of the Sun and Vega . . 2.1.2 Stellar Magnitudes . . . . . . . . . . . . . . . . . . . . . . . . . . 2.2 ST-16 Star Tracker . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.3 Attenuation Targets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.3.1 Stray Light Model and the Target Starlight Model . . . . . . . . 2.3.2 Star Detection Threshold, False Detection Probability, and False tion Rates . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.4 Stray Light Testing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.5 Radiative Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

1 5 5 6 8 9 11 13 18 21 24

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Detec. . . . . . . . . . . . . . .

v

Contents 3 Analysis Strategies 3.1 The SAIL Test Facility . . . . . . . . . . . . . 3.2 Lens Characterization . . . . . . . . . . . . . 3.2.1 Stray light Measurements of the ST-16 3.2.2 Lens Attenuation curve of the ST-16 . 3.3 ST-16 Lens Attenuation Analysis . . . . . . . 3.4 Ray Tracing . . . . . . . . . . . . . . . . . . . 3.4.1 Zemax Stray Light Experiment . . . . 3.4.1.1 Global Settings . . . . . . . . 3.4.1.2 Baffle Model . . . . . . . . . 3.4.1.3 Source Model . . . . . . . . . 3.4.1.4 Lens Response Model . . . . 3.4.1.5 Detector Model . . . . . . . 3.4.2 Speeding Up the Simulation . . . . . .

vi 27 29 31 34 38 41 43 44 46 46 47 47 48 49

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

4 Baffle Model Validation 55 4.1 Baffle Attenuation Verification . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55 4.2 Dedicated Laboratory Verification . . . . . . . . . . . . . . . . . . . . . . . . . . 57 4.3 Orbital Verification . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58 5 Baffle Design Applications 61 5.1 Determining Exclusion Angles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61 5.2 Baffle Comparisons . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62 5.3 Stray Light Path Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64 6 Summary and Future Work 69 6.1 Future Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70 6.2 Closing Remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

A Zemax OpticStudio 14 Additional A-1 Lens Coating File . . . . . . . . . A-2 Simulation Object Setup Macro . A-3 Data Acquisition Macro . . . . . A-4 Data Processing Macro . . . . . . A-5 Short Rigid Baffle Drawings . . .

Files . . . . . . . . . . . . . . . . . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

71 71 75 78 83 86

Bibliography

91

List of Figures
1.1 1.2 2.1 Illustrating common baffle elements using a profile view of a multi-staged baffle design. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Geometric visualization of the exclusion angle for a good baffle and a poor baffle. 3 4

Comparing the Solar and Vegan spectral irradiance curves across the visual and near infrared spectrum. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.2 The Aptina Imaging MT9P031 sensor quantum efficiency. . . . . . . . . . . . . . 2.3 A simplification of the detector logic, illustrating both a false detection and a true star detection. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.4 The relationship between the star detection threshold and the DRS. . . . . . . . 2.5 Illustrating stray light dependency on sensor orientation. . . . . . . . . . . . . . . 2.6 A typical illumination scenario for a star tracker . . . . . . . . . . . . . . . . . . 2.7 False detection rate as a function of system attenuation . . . . . . . . . . . . . . 2.8 Illustrating the illuminated volume of air described by Kemp and Wyatt, and the discrepancy introduced by shading the entrance aperture . . . . . . . . . . . . . . 2.9 An illustration of light interaction with a translucent material . . . . . . . . . . . 2.10 A surface interaction that models scattering . . . . . . . . . . . . . . . . . . . . . 3.1 3.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9 3.10 3.11 3.12 3.13 3.14 Visualizing the fully illuminated test. . . . . . . . . . . . . . . . . . . . . . . . . . Visualizing the blocked beam test. . . . . . . . . . . . . . . . . . . . . . . . . . . A conceptual visualization of the SAIL stray light measurement experiment . . . An ST-16 star tracker mounted to the motorized gimbal . . . . . . . . . . . . . . The required signal manipulations to isolate for the true stray light response. . . The MT9P031 detector's Bayer pattern illustrating the 8 different pixel channels Off-axis performance attenuation measurements . . . . . . . . . . . . . . . . . . . Sample stray light image J (17 ), illustrating dominant gradients present in the image . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . The progression of illumination gradients as the sensor deviates from the beam . The relative geometry of the baffled star tracker. . . . . . . . . . . . . . . . . . . the converted Zemax model highlighting key simulation objects. . . . . . . . . . . The relationship between the average standard deviation and the number of analysis rays . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . The relationship between the average standard deviation and the number of scattered rays . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . The relationship between the average simulation times and the number of analysis rays . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . vii

8 10 12 13 14 18 20 23 24 25 28 28 29 30 35 37 40 41 42 45 45 51 51 52

List of Figures 3.15 The relationship between the average simulation times and the number of scattered rays . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.1 4.2 5.1 5.2 5.3 5.4 5.5 5.6 5.7 Cut-away view of the ST-16 anodized baffle design . . . . . . . . . . . . . . . . . Comparing ray tracing baffle models . . . . . . . . . . . . . . . . . . . . . . . . . Determining the exclusion angle from the false detection rate curve and calculated system attenuation curves . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . False detection probabilities due to lunar stray light . . . . . . . . . . . . . . . . The new generation Acktar lathed baffle engineering model . . . . . . . . . . . . Comparing the measured baffle attenuation curves of the anodized and lathed baffles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Relative contributions of scatter types to the detector total incident power . . . . Ray scattering paths at high offset angles . . . . . . . . . . . . . . . . . . . . . . The effect of flipping the bevel direction . . . . . . . . . . . . . . . . . . . . . . .

viii

52 56 57

62 63 63 64 65 66 67

List of Tables
2.1 3.1 3.2 3.3 3.4 Bright Reference Fluxes as Seen by the ST-16 Star Tracker . . . . . . . . . . . . Lens Characterization Measurement Summary Source Model Parameters . . . . . . . . . . . . Lens Model Parameters . . . . . . . . . . . . . Detector Model Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 32 48 48 49

ix

Abbreviations
BRDF CMOS COTS DRS FOV HR ND SAIL SI SNR Bidirectional Reflection Distribution Function Composite-Metal-Oxide-Semiconductor Commercial-Off-The-Shelf Designed Reference Star Field Of View Hemispherical Reflectance Neutral Density Space Avionics and Instrumentation Laboratory Sinclair Interplanetary Signal-to-Noise Ratio

xi

Physical Constants
Speed of Light Planck's Constant c h = = 2.997 924 58 × 108 6.626 069 57 × 10-34 [ms-1 ] [Js]

xiii

Symbols

A D F F DR I Iamb Iful J L P Pr df S f m npps npps ntot texp x

Area Dark Signal Photon Flux False Detection Rate Pixel Intensity Ambient Signal Full Illumination Signal True Stray Light Signal Light-Only Signal Power False Detection Rate System Transmissivity Spectral Irradiance Stellar Magnitude Number of Pixels per Image Number of Pixels per Sample Total Number of Image Pixels Exposure Time Intensity Variable for Distributions

m2 [-] ph/s/m2 [-] ph or [-] [-] [-] [-]/s [-] W [-] [-] W /m2 /nm [-] [-] [-] [-] s ph

 q

Attenuation Quantum Efficiency xv

[-] [-]

Symbols  µ   Optical Wavelength Gaussian Mean Parameter Gaussian Standard Deviation Parameter Normalized Standard Deviation Curve nm ph ph [-]

xvi

I dedicate this to my friends, family and loved ones.

xvii

Chapter 1

Introduction
Star trackers are attitude measurement devices that measure, identify star distribution and compute an attitude using a catalogue of known stellar positions. The device captures an image of a star field, finds star positions within the image, and compares patterns formed from the image stars to patterns calculated from a catalogue. Successfully identifying the catalogue star counterparts permits calculating the sensor orientation with respect to the catalogue's reference frame. The orientation accuracy strongly relies on the sensor's ability to resolve stars as precisely as possible. The sensor is designed to image stars within its field of view (FOV). A small fraction of light from within the FOV will take undesired paths to the detector. Additionally, undesired light originating from outside the FOV is frequently found within images. We collectively call all these undesirable light paths as stray light. To ensure the quality of the star field image, we must prioritize the acceptance of starlight and rejection of stray light. Bright celestial objects, like the Sun, Moon, and sunlit Earth surfaces are potent sources of stray light. They will contribute image noise in the form of excess photons. Too many photons will saturate the detector and will render the star scene unusable. Less extreme levels of stray light result in a raised background signal level where shot noise will cause variations in the raised background. Spontaneous background signal elevations near a star image can shift its centroid and detector areas with dense concentrations of signal elevations can be interpreted as stars to the detector's logic. This drives the need to develop a light shielding element, a baffle, to reject stray light. The more tolerant a star tracker system is to stray light, more regions of the sky become suitable to yield orientation solutions.

1

Chapter 1. Introduction

2

The elimination of all possible stray light paths within the baffle is a problem of geometry. In general, longer designs with multiple specialized stages perform better[1]. Figure 1.1 shows a two-staged baffle design explored by Schenkel and illustrates the concept of a baffle vane. Vanes are strategically placed baffle components that restrict incoming light to the sensor's FOV. However, vanes introduce additional surface area just outside the FOV that light can unintentionally reflect off of and illuminate the sensor. To minimize this problematic surface area, vanes must be sharpened to a knife edge. The modelling of these knife edges proves crucial for accurately determining the attenuation of a baffle found later in the thesis. Our industry partner, Sinclair Interplanetary (SI) provides the sensors used for our research. These sensors are wide FOV devices that are designed and marketed towards microsatellites. The star trackers are consequently small, and large multistaged baffles (such as the one portrayed in Figure 1.1) are unsuitable. Smaller alternatives have been designed by SI and a majority of this thesis is dedicated to finding effective ways the characterize the performance of these baffles. In the context of this thesis, baffle performance refers to the stray light rejection, or attenuation, properties of the baffle. Performance is dependent on the baffle's orientation with respect to a light source and is usually represented as a curve where attenuation levels increase (get better) at increasing offset angles relative to the source. Attenuation curves can be generated for optical components individually, but the most useful curve is the baffled star tracker system curve, denoted as the system attenuation curve, which consists of the detector optics combined with the baffle. The system attenuation curve is a useful metric because it allows us to clearly see the minimum offset angle required to image stars unhindered by solar stray light. This angle is called the exclusion angle and bounds the region of the sky that is too close to a bright object to return a trustworthy attitude measurement from the star tracker. Figure 1.2 illustrates the geometric definition of the exclusion angle. The unit sphere in this diagram represents all possible orientations that the sensor can take in a flight scenario. The unit vector u ^bs represents the pointing direction of the sensor, called the boresight vector. The area on the unit sphere that surrounds u ^bs represents the sensor's FOV. Likewise, the unit vector u ^bo represents the direction of a bright object relative to the sensor. The circular regions of the unit sphere that surrounds this bright object are too bright for the sensor to reliably differentiate stars. The larger region, characterized by the exclusion angle 1 , represents the unacceptable region defined by using a poor baffle. Similarly, the smaller region represents the same bright region but is characterized by a smaller exclusion angle 2 obtained through using a better baffle.

Chapter 1. Introduction

3

Vanes

Knife Edge

To Sensor

Stage 1

Stage 2

Figure 1.1: Illustrating common baffle elements using a profile view of a multi-staged baffle design[4].

The easiest way to obtain an attenuation curve is to measure it experimentally. Unfortunately, creating a stray light experiment in a laboratory will prove difficult. System attenuation curves for precise star trackers cross a large dynamic range of attenuation and atmospheric scattering will prevent measuring very small attenuations. Common efforts to reduce atmospheric scattering will also introduce unwanted surface scattering that will compromise attenuation measurements. There exist modern day facilities[2][3], well used by NASA, CSA, and the ESA, that specialize in stray light testing and have access to state-of-the-art equipment that minimizes atmospheric and surface scattering. However, during initial baffle design stages, where frequent tests are beneficial, these facilities are impractical due to their popularity. Flexibility is important when conceptually designing a baffle. Many varying designs should be easily evaluated and compared rapidly. Additionally, it is extremely useful to observe the performance change due to varying a single parameter within a baffle design. Evaluating multiple designs using conventional experimental stray light testing requires a physical baffle for each design, which in turn would raise the initial design stage cost. Therefore other means of stray light testing that emphasize versatility must be explored. This thesis presents strategies and applications of stray light testing while focusing on versatility. This is done through introducing our hybrid stray light analysis technique. We measure the attenuation of the star tracker sensor using a method derived from prior innovations in stray light testing. Those results are integrated within the Zemax OpticStudio 14 non-sequential ray tracing

Chapter 1. Introduction

4

Bright Object

Too Bright FOV

2
1

 

 Unit Sphere Sensor Location

Figure 1.2: Geometric visualization of the exclusion angle for a good baffle and a poor baffle.

environment (henceforth referred to as Zemax) along with digital baffle models to simulate physical stray light testing. Zemax ray tracing cannot be used alone because modelling the behaviour of the star tracker optics would introduce too many uncertainties to make trustworthy attenuation estimates. Utilizing the hybrid stray light analysis technique enables the rapid evaluation of baffle designs to facilitate the selection of the best candidate to move forward in the design process. In Chapter 2, we present a review of concepts used to compare different intensity objects, as well as a review historical approaches to stray light testing. Simultaneously, this chapter discusses an analytical method of establishing attenuation targets to define the exclusion angle. Chapter 3 discusses how the Space Avionics and Instrumentation Laboratory (SAIL) in Ryerson University is used as a stray light laboratory. This chapter elaborates on how to use our star tracker's composite-metal-oxide-semiconductor (CMOS) detector hardware as a photometric device to determine stray light illumination levels. Ray tracing is introduced as a means to determine attenuation data for an optical system and this chapter details how to use Zemax to simulate stray light analysis. Chapter 4 discusses shortcomings of using a ray tracing engine and potential means of reinforcing the accuracy of simulation results. Chapter 5 considers the application of the previously discussed analyses to gain insight on the light behaviour within a baffled star tracker optical system and how these insights can be used to improve baffle designs. Chapter 6 summarizes the contributions of this thesis and provides directions this research can pursue in the future.

Chapter 2

Background Theory
In this chapter we review necessary knowledge to interpret illumination information from the star tracker detector in the context of imaging stars. A probabilistic model is then developed that describes the likelihood of the star tracker to falsely detect a star purely due stray light captured in star scene images. Historical approaches to stray light testing are reviewed while focusing on low cost solutions. Finally, we review radiative transfer phenomena that will be the primary focus of our ray traced stray light simulations in Chapter 3.

2.1

Stellar Photometry

To meaningfully compare the brightness of sensor regions, we need to construct a framework that enables us to quantify illumination information obtained from the sensor. The brightness of stars is measured on a logarithmic "magnitude" scale and the framework in this chapter enables the conversion between stellar magnitudes and light flux values. Light flux measures the radiated power of a luminous object. This quantity expresses the power per unit area emitted by an object as observed by the detector. However, because the star tracker sensor is a photon counting detector (each pixel accumulates photons over an exposure), we convert all units of energy into photons and describe the light emitted by a luminous object as a photon flux. This quantity is used to describe the incoming light from the Sun and stars in a way that is compatible with how the sensor functions. A star tracker is designed with a stellar magnitude threshold that describes the dimmest stars that the sensor can reliably differentiate from the image background. Dimmer stars can often be observed, however these stars can be mistakenly interpreted as background noise. Similarly, 5

Chapter 2. Background Theory

6

image noise can be interpreted as a star and we call these stars "false detections." The threshold magnitude at which the star trustworthiness deteriorates is called the designed reference star (DRS). We wish to describe the brightness of the DRS threshold in terms of a photon flux. Doing so will allow the calculation of an expected photon count for the DRS and which will determine how much stray light could be interpreted as a false detection.

2.1.1

Photon Flux and the Spectral Irradiance of the Sun and Vega

Determining the amount of false detections expected in an image requires representing the amount of light present in the image due to the stray light source. The dominant source of stray light under normal orbital conditions is the sun and we need to determine how many photons to expect on average. This is done through combining solar emissivity data with the light accepting properties of the detector. Knowing the solar flux gives insight into the expected amount of photons for unattenuated sunlight. Additionally we need to clarify the amount of light that would be considered a star to determine whether stray light can spontaneously cause a false detection. This criteria is based on the DRS threshold and is specified as a stellar magnitude. The stellar magnitude scale is based on Vega, which acts as a reference star to the stellar magnitude system. Vegan emissivity data is used to calculate the Vegan flux which permits the calculation of the DRS flux threshold. Every star in the celestial sphere emits light of different intensities at varying wavelengths. This relationship is a function of the star's elemental composition, the current stage of the star's evolution, and whether there is an absorptive medium in between the star and the observer. The accumulation of a star's wavelength dependant emissivity is assembled into a spectral irradiance curve denoted as f (). The spectral irradiance of a star can be measured, and is typically obtained from spacecraft photometric missions. For instance, the Space Telescope Science Institute's CALSPEC catalogue is a survey of approximately 130 stars that adheres to the Hubble Space Telescope (HST) standard for calibration[5]. However, the amount of photons striking the detector is highly dependent on the sensor. For example, a star emitting primarily ultraviolet light will appear very dim to a sensor designed to image infrared light. A detector's sensitivity to light of different wavelengths is represented by a passband or a function that represents which electromagnetic wavelengths are accepted and

Chapter 2. Background Theory

7

which are rejected. For photon counting detectors the passband is called the quantum efficiency, q (), and describes the likelihood that a photon is converted into a photoelectron at the pixel. Combining an object's spectral irradiance with a sensor's response to light of different wavelengths we calculate how bright the object appears to the detector. The brightness is quantified as a photon flux, which describes the expected photon arrival rate per unit area at the detector location. Bessel and Murphy state that the total photon flux from a celestial object is given by the following formula [6].

Fph =

f () · S () ·

 d h·c

(2.1)

Where Fph is the total photon flux across all wavelengths,  represents the electromagnetic radiation wavelength, and f () is the spectral irradiance of the celestial body and is expressed in terms of a power per unit area per unit wavelength. S () is the optical system's response function, h is Planck's constant, and c is the speed of light in vacuum. S () is the combination of sensor specific effects such as mirror reflectivity, atmospheric transmission, lens transmission, glass filter transmission, and finally the sensor quantum efficiency[6]. Eq. Equation (2.1) allows us to calculate how many photons a source will contribute at the detector plane. For simplicity, we assume perfect transmittance throughout every optical component and only account for the quantum efficiency of the detector. This is justified through star tracker operational environment, where we expect zero atmospheric absorption due to the vacuum of space. Furthermore we speculate that any lens and sensor glass absorption is negligible. The solar spectral irradiance is documented by the American Society of Testing and Materials under the designation E 490 - 00a. The data presented within this standard is the Zero Air Mass Solar Spectral Irradiance which has been accumulated by high-altitude aircrafts, spacecrafts, the earth's surface and previous solar spectral irradiance models[7]. This data measures the spectral irradiance of the sun as seen from outside the Earth's atmosphere, where the sunlight remains unaffected by the atmosphere. Vega, otherwise known as Alpha-Lyrae, is a bright star in the night sky that resides in the Lyra constellation. Historically, this star is significant because it served as a reference point for stellar magnitude systems and is therefore used to calculate the DRS flux threshold. Vega's spectral irradiance is provided by the CALSPEC spectrophotometric star catalogue[8].

Chapter 2. Background Theory

8

Figure 2.1 compares the Solar and Vegan spectral irradiance. The Solar spectral irradiance is roughly ten orders of magnitude stronger than the vegan spectral irradiance across all wavelengths present in the figure. This reflects conventional intuition because the Sun is much closer to the earth than Vega. With this spectral irradiance data combined with the star trackers passband, Equation (2.1) can be numerically integrated to determine the photon flux for these two objects as observed by the sensor.

2.1.2

Stellar Magnitudes

We have laid out a technique to quantify the amount of expected stray light from the Sun and the expected light from the reference star Vega. The stellar magnitude system describes the brightness of stars relative to a bright reference object. Historically this object has been Vega and the brightness of all others stars is described as a magnitude relative to Vega. The DRS

10

0

Spectral Irradiance f , W/m2 /nm

10

-2

10

-4

10

-6

Vega Sun

10

-8

10

-10

10

-12

200

400

600 800 Wavelength , nm

1000

1200

Figure 2.1: Comparing the Solar and Vegan spectral irradiance curves across the visual and near infrared spectrum.

Chapter 2. Background Theory

9

threshold is specified in terms of a stellar magnitude. In order to represent this value as a flux, we need to define the stellar magnitude scale and the flux of the reference object. Stellar magnitudes are defined on a logarithmic scale:

mx = -2.5 log10

Fx F0

(2.2)

Equation (2.2) defines a system for which positive magnitude values translate to dimmer stars with respect to the reference object, and conversely negative magnitudes translate to stars brighter than the zero-point. The photon flux ratio between a pair of stars offset by five magnitudes (i.e. m1 = 1.3 and m2 = 6.3) is fixed to a factor of 100. From Bessell and Murphy's research[6], they describe that there exist stellar magnitude systems that affix Vega to the zero-point of the system (mvega = 0) or define a hypothetical zero point with respect to Vega (mvega = 0.03). To keep consistent with Bessell and Murphy's paper we will restrict ourselves to the latter case. If we fix the photon flux of Vega to mvega = 0.03, then we can calculate the flux for a magnitude zero star (F0 ) by inverting Equation (2.2). This is the photon flux for a theoretical star that serves as the reference point for the magnitude system defined by the sensor quantum efficiency. After this flux is known, the flux for any magnitude object can be calculated and we will use Equation (2.2) to determine the flux for the DRS.

2.2

ST-16 Star Tracker

The stellar photometric concepts from Section 2.1 are applied to the ST-16 star tracker model from SI. We cannot determine the expected light flux from a celestial object without first considering how the sensor responds to different wavelengths of light. The ST-16 star tracker use an Aptina Imaging MT9P031 monochrome sensor accepts light from a broad passband that overlaps with a significant portion of the Johnson-Cousin's UBVRI spectrum[6]. Dzamba[9] provides the sensor's passband in terms of a quantum efficiency curve. We combine the sensor passband information with the spectral irradiance of the previously described stars to determine the flux values for these objects. The flux values are used to calculate the flux of the DRS threshold using the stellar magnitude scale. The Aptina Imaging MT9P031 monochrome sensor does not absorb light of all wavelengths, rather, it converts photons into electrons according to its quantum efficiency curve q (). This

Chapter 2. Background Theory

10

curve describes the fraction of incident photons converted into electrons upon striking sensitive elements[6]. Figure 2.2 plots the MT9P031 sensor quantum efficiency and shows which parts of the electromagnetic spectrum will result in a response from the sensor. The sensor is sensitive to a broad spectrum of visible light along with the near infrared but fails to detect ultraviolet and far infrared light. This relationship is important because the magnitude system discussed earlier is entirely based on the light flux that is detectable by the sensor. In absolute terms, an object may intensely radiate power across a wide electromagnetic spectrum but will appear very faint if the sensor cannot detect much of that radiation. The DRS threshold for the ST-16 star tracker targets magnitude 5.75 stars. Stars dimmer than magnitude 5.75 will be susceptible to perturbations from stray light within the image. Table 2.1 accumulates the important flux parameters used in this thesis. The solar flux is obtained by numerically integrating 2.1 while using the zero air mass solar spectral irradiance curve detailed previously and the MT9P031 quantum efficiency. The same process will generate

1 0.9 0.8 Sensor Quantum Efficiency q 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0 200

400

600 800 Wavelength , nm

1000

1200

Figure 2.2: The Aptina Imaging MT9P031 sensor quantum efficiency[9].

Chapter 2. Background Theory
Table 2.1: Bright Reference Fluxes as Seen by the ST-16 Star Tracker.

11

Object Sun Full Moon Reference Star m0 Vega DRS

Magnitude m ­26.70 ­12.60 00.00 00.03 05.75

Flux Value F 1.0145 × 1021 2.3203 × 1015 2.1161 × 1010 2.0585 × 1010 1.0606 × 108

Unit ph/s/m2 ph/s/m2 ph/s/m2 ph/s/m2 ph/s/m2

Vega's flux when using the Vegan spectral irradiance. The reference star flux is calculated fixing the Vegan photon flux to mvega = 0.03 and calculating the zero magnitude flux through inverting Equation (2.2). The reference star flux value is useful because it permits calculating any flux by specifying the stellar magnitude. The DRS flux is calculated from the specified DRS magnitude and the reference star flux using Equation (2.2). The primary stray light source for a star image is sunlight. With the light flux values described in Table 2.1 we can begin analyzing the degree of stray light in an image and determining the likelihood that it will deteriorate an image by creating false detections.

2.3

Attenuation Targets

Although the attenuation of stray light as it propagates through a baffle and travels within the lens is determined by baffle geometry and surface properties, one can take knowledge from star tracking algorithm processes to better estimate required baffle performance for a sensor. A star tracker is an inherently noisy device, and any particular attitude computing algorithm should be tolerant of false stars. False stars will originate from anomalous illuminated objects (like dust particles or rocks) that wander into the FOV or from spontaneous spikes in signal levels on the detectors. Intense levels of stray light will blind the sensor, but dimmer levels of stray light will raise the background noise and contribute to the spontaneous false detection rate. We begin by analyzing the probability of a window area on the detector to appear as a star, and then infer the probability of a false star appearing anywhere on the detector. The probabilistic model is parametrized conveniently such that it is dependent on the system attenuation factor. Specifying a tolerable false detection rate will directly specify the target system attenuation factor. This target attenuation is combined with the measured system attenuation curve in order to determine the exclusion angle for the system. Consider Figure 2.3 as an example of the star detection logic for a small one dimensional portion of the detector. The stray light present on the detector will generate a raised background signal

Chapter 2. Background Theory

12

level. Starlight is overlapped on top of the stray light response. An integrated intensity value is taken by summing the intensities across a small window of adjacent pixels. Should the variations of the background signal result in a value that surpasses the detection threshold, then that area is considered a star. Illustrated in Figure 2.3 is a false detection according to this threshold as well as a true detection. The detection threshold is specified relative to the mean background level and is obtained from the DRS star. Figure 2.4 shows the comparison between the intensity distribution between the DRS star and the stray light variation distribution. The star detection threshold is determined by choosing an intensity that will very likely detect a DRS star. In Figure 2.4, the area under the DRS distribution is predominantly greater than the star detection threshold. That is to say that this threshold is very likely to detect a DRS star. The other curves are described as the stray light variation distributions and they describe the likelihood that a sample window containing stray light will deviate from the mean stray light level described in Figure 2.3. For weak attenuations (orientations closer to the stray light source), the area under the distribution curve that surpasses the star detection threshold is greater than the same area for a strong attenuation. It is far more likely to experience a false detection at weaker attenuations.

Star Detection Threshold

Mean Stray Light Level False Detection True Detection

Integrated Intensity Stray Light Response Star Response

Detector Dimension

Figure 2.3: A simplification of the detector logic, illustrating both a false detection and a true star detection.

Chapter 2. Background Theory

13

Star Detection Threshold Probability Stray Light Variation Distribution

DRS Intensity Distribution

Weak Attenuation



Strong Attenuation

Intensity False Detection Probability

Figure 2.4: The relationship between the star detection threshold and the DRS.

2.3.1

Stray Light Model and the Target Starlight Model

We wish to analyze the probability that a sample window on the detector will be classified as a false detection. To do so we need to determine the photon intensity distribution of a pixel. Once the intensity distribution of a pixel is known, the intensity distribution for any group of adjacent pixels is found by summing the individual pixel distributions. Consider Figure 2.5 as the typical illumination condition between the sensor and a bright light source, where emphasis is placed on directly illuminated areas. In these diagrams, the sensor attempts to image dim stars in the presence of the bright object, however due to the relative orientation between the sensor and the bright object, undesired bright light enters the baffle aperture. In Figure 2.5a, the sensor boresight points directly at the bright object and the lens is directly illuminated. In contrast, Figure 2.5b demonstrates the sensor deviating an angle  away from the bright object and half of the lens is directly illuminated. If  increases, the directly illuminated area of the lens will decrease until the sensor is no longer directly illuminated as shown in Figure 2.5c. At this point the only light that enters the sensor is reflected off of the baffle surfaces. A further increase of  will reduce the directly illuminated surface area of the baffle. Figure 2.5d shows that once the sensor is completely perpendicular to the incident light, no stray light will enter the baffle.

Chapter 2. Background Theory

14

Bright Object

Bright Object

Incident Light Boresight Vector Boresight Vector 

(a) Sensor boresight aimed at the (b) Sensor boresight rotated away bright object. from the bright object.
Bright Object Bright Object

Incident Light

Incident Light

 Boresight Vector



Boresight Vector

(c) Incident light no longer strikes (d) Direct light no longer enters the the detector directly. baffle. Figure 2.5: Illustrating stray light dependency on sensor orientation.

Chapter 2. Background Theory

15

The system attenuation sys between the baffle aperture and the detector has a clear dependency on the relative orientation between the sensor boresight and the source. This is a result of many compounding effects; once the source exits the FOV, photons will strike the detector by scattering off of surfaces within the baffle. On more rare occasions, photons will scatter directly off of knife edges that lay outside the FOV. These effects are subject to both manufacturing quality of the geometry and the surface properties of the internal coating[10]. The expected amount of photons collected on a detector pixel follows a modified version of the intensity equation described by Dzamba[9].

¯px = sys () · Fsrc · texp · Apx I

(2.3)

¯px represents the expected photon count for a pixel on the detector. sys is the net Where I optical system attenuation, which is an accumulation of the attenuations provided by the baffle, the lens, and the glass on the detector. The exact optical properties of many components may be unknown if using a commercial off-the-shelf (COTS) equipment; by lumping system uncertainties into this parameter it provides a method to evaluate the system performance while avoiding the need to develop a lens model for COTS lenses. Fsrc is the flux generated by the stray light source; texp is the exposure time for the pixel. This is the time through which the pixel accumulates charge within its well. Equation (2.3) provides the expected photon count for a given pixel. This is a value that describes the average photon count of a pixel over many identical trials. An pixel's photon count will vary from trial to trial because of shot noise, which is a result of the probabilistic nature of light. This variation is proportional to the square root of the expected photon count described by Equation (2.3). The probability distribution function for photon arrival rates is governed by a Poisson distribution, however at large photon arrival rates given by intense sunlight, the Poisson distribution can be approximated by a Gaussian distribution.
2

- 1 e pdf px (x) =  2 · px

x-µpx  2px

(2.4)

Equation (2.4) describes the probability distribution for the photon count of a pixel as a Gaussian distribution. The Gaussian parameters describing this distribution are stated in Equation (2.5) and Equation (2.6).

Chapter 2. Background Theory

16

¯px µpx = I
2 ¯px px =I

(2.5) (2.6)

An appropriate sample window to determine false detection probabilities is the typical size of a star on the detector. For the ST-16 star tracker, Dzamba's[9] study approximates the diameter of a star to be 12 pixels. The total expected photon count is a summation of the individual pixel photon count distributions. We proceed with the assumption that the stray light is uniformly distributed onto the detector's surface. While the exact stray light projection onto the detector surface is not normally uniform, for simplicity we will concern ourselves with the average distribution across the detector. This can easily be rectified at a later date with more complete knowledge of the optical system to provide better estimates. The photon count distribution for a sample window of size npps pixels is determined by Equation (2.7). This formulation parametrizes the photon count distribution of a sample window in terms of the system attenuation factor sys .
npps
2

pdf samp (x) =
1

- 1  e 2 · px

x-µpx  2px

(2.7)

Equation (2.7) can be simplified into Equation (2.8).
2

- 1 pdf samp (x) =  e 2 · samp

x-µsamp  2samp

(2.8)

Where the Gaussian parameters that describe Equation (2.8) are defined in Equation (2.9) and Equation (2.10).

¯px µsamp = npps · I
2 ¯px samp = npps · I

(2.9) (2.10)

Recall from 2.3 that we do not concern ourselves with the absolute number of photons within the sample window, we are only concerned the variation away from the mean stray light level. In other words, we wish to look at the probability that the variance of the stray light distribution results in a false detection. This is achieved by shifting the photon count distribution described

Chapter 2. Background Theory

17

by Equation (2.8) such that the distribution is centred on 0. We change the definition of Equation (2.9) to Equation (2.11).

µsamp = 0

(2.11)

Equation (2.8) now characterizes the variance distribution for a sample containing a uniform stray light background. We use this distribution to calculate the probability of a false detection. This is obtained by calculating the area under the probability curve that surpasses the star detection threshold. The star detection threshold is obtained from the intensity distribution of the DRS. Figure 2.6 shows a cross sectional diagram of a star tracker optical system highlighting two main light paths. We see that the starlight within the field of view focuses to a small area on the detector. The majority of the starlight that enters the lens falls onto this area. We need to determine the photon count distribution for the DRS light that enters the lens. The total amount of photons that result from the scenario portrayed in Figure 2.6 is obtained similarly to Equation (2.3).

¯drs = Fdrs · texp · Acs I

(2.12)

Where Fdrs is the flux emitted by the DRS. For the ST-16 this corresponds to a magnitude 5.75 star. This flux quantity has been previously calculated in Section 2.2. Acs is the area of the light collecting surface; in the case of Figure 2.6, this value would be the area of the exposed lens. The photon count distribution is obtained similarly to Equation (2.4).
2

- 1 e pdf drs (x) =  2 · drs

x-µdrs  2drs

(2.13)

The Gaussian parameters describing this distribution are stated in Equation (2.14) and Equation (2.15).

¯drs µdrs = I
2 ¯drs drs =I

(2.14) (2.15)

Chapter 2. Background Theory
Unwanted Stray Light
Desired Star Light

18

Primary Scatter

Lens

Detector

Secondary Scatter

Figure 2.6: A typical illumination scenario for a star tracker.

We now have an expression for both the stray light variance distribution and the DRS photon count distribution. To calculate the false detection probability we require the star detection threshold which is derived from Equation (2.13).

2.3.2

Star Detection Threshold, False Detection Probability, and False Detection Rates

The ST-16 is designed to reliably image DRS stars. The star detection threshold is defined in terms of the likelihood of the DRS photon count distribution exceeding the star detection threshold. We can specify a likelihood, Pr drs , that describes how often the star tracker is designed to see DRS stars. The star detection threshold Isdt thus satisfies Equation (2.16).


Pr drs =
Isdt

pdf drs (x) dx

(2.16)

Equation (2.16) describes the area under the DRS curve found in Figure 2.4. If the star tracker is designed reliably image DRS stars, Pr drs must be a high probability (Pr drs consequently drives Isdt to lower values. 1), which

Chapter 2. Background Theory

19

The false detection probability, Pr fd , is the likelihood that the stray light variance distribution surpasses Isdt . This is mathematically expressed as Equation (2.17).


Pr fd =
Isdt

pdf samp (x) dx

(2.17)

Recall that Equation (2.17) describes the probability of a sample window to exceed the star detection threshold. To extrapolate this probability to the rest of the detector area we construct a quantity called the false detection rate FDR. Equation (2.18) takes into account the size of the sample window (specified by the number of pixels in the sample npps ) and the total number of pixels across the detector ntot to determine the expected number of false detections in an image.

FDR =

ntot Pr fd npps

(2.18)

Equation (2.18) describes how susceptible the optical system is to stray light at a given orientation with respect to a stray light source. To summarize, the star detection threshold is fixed to the DRS. The DRS for the ST-16 is a magnitude 5.75 star as observed from the Aptina sensor. The ST-16 has been designed such that the detection threshold captures 95% of potential DRS stars in an image. This specifies the star detection threshold Isdt which defines the false detection probability Pr fd . The stray light variance distribution changes in width as sys varies according to Equation (2.10). Therefore the false detection rate FDR is a function of sys . Figure 2.7 relates system attenuation sys and the image false detection rate on the detector FDR. For extremely weak attenuations, the expected amount of false detections is large. The false detection rate decreases as the system attenuation strengthens (the system rotates away from the stray light source). Given a large rotation away from the stray light source, the number of false detections expected for an image decreases to the point where FDR is negligible. For typical orientations, the star tracker makes attitude calculations off of a healthy supply of bright stars. As a result, the star tracker tolerates a small amount of false detections. Figure 2.7 also plots a constant false detection rate of five detections per image that is tolerable by the ST-16 under normal circumstance. the intersection of the two lines yields the attenuation

Chapter 2. Background Theory
10
5

20

10

4

False Detection Rate FDR

10

3

10

2

10

1

False Detection Rate 5 False Detections per Image

10

0

10

-1

10

-2

10

0

10

-1

10 10 10 System Attenuation Factor sys

-2

-3

-4

10

-5

10

-6

Figure 2.7: False detection rate as a function of system attenuation.

requirement to provide a tolerable false detection rate for the star tracker. The attenuation at which this intersection occurs is calculated to be approximately sys 10-5.25 .

Recall that the system attenuation of the baffled star tracker is a function of its deviation angle away from a stray light source (see Figure 2.5), we can define a exclusion angle that the sensor will likely not see false detections due to stray light. This exclusion angle is defined by the attenuation that the FDR curve crosses the tolerable false detection rate criteria. The more tolerant the star tracker's star detection logic to false stars (i.e. a higher false detection rate threshold), a smaller exclusion angle is needed to provide the required attenuation. This process only looks at the responses due to photoelectrons, that is to say that other noise sources from the sensor circuitry are assumed to be negligible. The advantage of this characterization of the false detection rate is that we have determined a criteria for the exclusion angle of a system in terms of parameters that describe the star tracker sensor. This allows us to compare the attenuation curve of a system to the required system attenuation to deduce the exclusion angle from measurements or predictions. This allows the option to redesign a baffle such that the exclusion angle it provides is as small as possible.

Chapter 2. Background Theory

21

2.4

Stray Light Testing

It is advantageous to measure the stray light rejection of the optical system directly with a photometric instrument to dismiss optical attenuation uncertainties. We desire to create a laboratory set-up that captures the light power transmission through the optical system as a function of the orientation between the detector field of view and an incident light beam. However there are several reasons why this is not a trivial process. In this section we examine how previous researchers have made stray light measurements with similar limitations that the SAIL lab possesses Kemp and Wyatt[11] state that a measurement or calibration should be conducted under conditions which reflect the environment where the instrument normally operates in. The microsatellite star trackers manufactured by Sinclair Interplanetary operate in exoatmospheric conditions. Under normal viewing conditions, sunlight is approximately 1013 times stronger than the starlight our sensors are designed to observe. These illumination conditions are difficult to replicate in an earthbound laboratory. Heinisch and Jolliffe[1], developed the basic stray light experimental procedure that measures attenuations directly. They were tasked to evaluate baffle designs for a sensor that imaged magnitude 4 stars in the presence of solar light. To confirm their numerical simulations, they measured the baffle attenuation curves independent of the sensor. The set-up consisted of a collimated Xenon arc light source that passed through a filter that simulated the solar spectrum. The baffles were fixed to a rotating mount such that the centre of rotation coincided with the centre of the baffle's entrance aperture. A calibrated photometer took two measurements, one at the baffle entrance aperture and one at the parent sensor's location with respect to the baffle. The ratio between the fore and aft values was interpreted as the baffle's nondimensionalized attenuation for the current orientation. Attenuations were sampled incrementally as the motor rotated away from the beam. Confining the stray light experiment within a room will introduce a raised ambient light level due to surface scattering. Illuminated equipment surfaces will scatter light back into the field of view of the sensor where it compromises the dark background[10]. Careful beam management is required to ensure that severe surface scatterings do not degrade measurements. Heinisch and Jolliffe's test room was painted black as was all the relevant equipment. The light source was shrouded to prevent light leakage from gaps in the source enclosure. Background levels of illumination were measured with the photometer while using a cone that emulates the field of view (FOV) permitted by a chosen baffle design. The measurements showed a

Chapter 2. Background Theory

22

background illumination at a steady light level 10-7 times dimmer than their source. All of their baffle attenuation measurements were at least an order of magnitude above this level. Kawano et al.[12] also used an enclosed clean room environment for their stray light testing. To alleviate surface scattering within their experiment, they erected a light trap internally coated with a specular black surface to direct rays entering the field of view into a dark cavity. They claim that the light trap significantly reduced the surface scattering observed in the FOV and the light trap absorbed almost all incident light. Moving the stray light experiment outside removes the need to worry about surface scattering from walls within the FOV. Bock et al.[13] chose to perform their measurements on rooftop, where they changed their apparatus such that it rotated towards the sky at increasing offset angles. Pointing at the sky reduced the chance that an object would appear near the FOV but is subject to weather conditions: an overcast sky would not be dark enough for stray light testing. A separate experiment performed by Lewis et al.[14] encountered background illumination issues with detectable sky radiance, faint clouds, and haze during their measurements. Regardless of location, air quality will determine the ability to produce the range of intensities required for these tests. Dust particles, aerosols, and air molecules all produce scattering effects when photons interact with these particles. The photon interaction behaves as a point source and slightly illuminates all directions relative to the interaction. Should the scattering event occur within the instrument field of view, a fraction of the incident power will introduce illumination into the primary optical path. The above phenomena, when combined, limits the beam attenuation that can be measured and results in the optical system appearing to attenuate light worse than if the tests were performed in orbit[15]. Kemp and Wyatt[15] analyzed the magnitude of atmospheric scattering. Atmospheric scattering is caused by two phenomena, Rayleigh and Mie scattering. Rayleigh scattering occurs when light passes through a medium consisting of particles much smaller than the light's wavelength, and results in the particle scattering the incident light in all directions. Mie scattering occurs when the particles are larger and similar in size to the incident light's wavelength. They showed that an air filtration system can minimize Mie scattering effects but Rayleigh scattering will remain as long as measurements are performed in atmosphere[15]. Their work showed that the atmospheric scattering is proportional to intersecting volume of air between the sensor FOV and the illuminated column of air. For their configuration, with a 10.2cm diameter beam and a 5 full angle baffle, they measured atmospheric scattering levels between 10-7 and 10-10 times the power of the incident beam within their clean room and showed that their atmospheric scattering measurements were primarily Rayleigh in nature.

Chapter 2. Background Theory

23

To measure below the sys = 10- 7 threshold, the atmospheric and surface scatter must be removed from the measurements. Kemp and Wyatt[15] shifted their baffle away from their mount's centre of rotation, such that light only entered the baffle at orientations nearly coincident with the beam. Otherwise, the beam illuminates the air in front of the sensor; if proper beam management is exercised, the signal measured with this configuration is due to the illuminated air. Measuring atmospheric scatter in this way allows estimating the atmospheric scatter contributions present in the normal measurements. Knowing both the regular measurement and the atmospheric contribution allows the isolation for the desired response. Bock et al.[13] introduced an obstruction into their beam to shade the baffled detector to obtain a similar effect. Lewis et al.[14] also shaded their baffled detector but reasoned that with a large enough beam, the illuminated air volume discrepancy between the shaded and unshaded detector, as visualized in Figure 2.8, would be negligible. These previous endeavours in atmospheric stray light testing serve as a foundation for the stray light tests performed in the SAIL laboratory. We design an experiment similar to Heinisch and Jolliffe's[1], but we do not measure the attenuation of the baffled system directly. The attenuation of the detector optics is measured separately from all other elements and predictions for the baffled system attenuation are calculated through using Zemax.

FOV

FOV

Incident beam Incident beam

Obstruction

Illuminated Air Volume Illuminated Air Volume

(b) The illuminated volume of air (a) The illuminated volume of air when blocking direct light from enunder normal circumstances. tering the baffle. Figure 2.8: Illustrating the illuminated volume of air described by Kemp and Wyatt, and the discrepancy introduced by shading the entrance aperture.

Chapter 2. Background Theory

24

2.5

Radiative Properties

In the later sections of this thesis, we model the propagation of light within an optical system using ray tracing techniques. The ray-tracing program provides visualization tools to help gain intuition about how an optical system behaves in response to a light source. However to fully understand and appreciate how the ray tracing program calculates ray paths, a miniature review of light behaviour is required. Let us consider a beam of light striking a translucent material as portrayed in Figure 2.9. Energy must be conserved within system defined by the black box.

Pin = PR + PT + PA

(2.19)

Equation (2.19) states the energy balance within the system. Pin describes the total power of the incident beam entering the system. PR describes the power reflected off of the material surface and encompasses all reflection types, both specular and scattering. PT describes the power transmitted through the material as the transmitted beam crosses through the system boundary. PA describes the power absorbed by the material, and accounts for any imbalances that occur between the input energy and the transmitted and reflected energy. These parameters can be normalized to be independent of the incident energy entering the system. Equation (2.19) can be rewritten in terms of attenuation coefficients:





Material Surface

System



Figure 2.9: An illustration of light interaction with a translucent material.

Chapter 2. Background Theory

25

Incident Ray Surface Normal  Scattered Ray



  

Figure 2.10: A surface interaction that models scattering.

Pin PR PT PA = + + Pin Pin Pin Pin

(2.20)

1=R+T +A

(2.21)

Where R, T , and A represent the reflective, transmissive, and absorptive normalized attenuation coefficients respectively. Zemax applies these principles to most surface interactions within the stray light testing experiment. Black diffuse materials such as those coated inside the baffle scatter light in all directions including the specular reflection direction. Their behaviour is described as somewhere between two idealized scenarios, the specular reflective case and the Lambertian diffuse scattering case. A Lambertian scattering model is defined such that the power of the scattered ray PR is the same regardless of the direction it leaves the interaction point.

Chapter 2. Background Theory

26

Figure 2.10 shows the standard mathematical model of a scattering event. The power density per unit solid angle is constant across all permissible directions away from the Lambertian scattering event. In reality, most applicable dark coatings deviate away from the Lambertian idealization. They are characterized by a property called the Bidirectional Reflectance Distribution Function (BRDF) which describes the reflectance, R, of a scattering event depending on the incident light orientation and the observer orientation with respect to the interaction point[16]. For example, the power of the scattered ray in Figure 2.10 is described as follows.

PR = BRDF (I , I , R , R ) · Pin

(2.22)

Where I , I , R , and R are the spherical coordinates that describe the orientation of the incident ray and the reflected ray. Breault[16] states that there is a clear dependency on the angle of incidence of the illuminating beam, and there is a directional bias in terms of reflection paths. Scattered light prefers directions "forward" of the interaction point as opposed to reflecting "backward". To fully characterize the BRDF of a material requires many measurements over a range of beam incidence angles. Coating suppliers frequently simplify the BRDF of a material in terms of a hemispherical reflectance HR. The hemispherical reflectance can be thought of as the average surface reflectance taken over the exposed hemisphere portrayed in Figure 2.10.

BRDF (I , I , R , R ) dA HR (I , I ) =
Ahs

(2.23) dA
Ahs

2

 2

BRDF (I , I , R , R ) sin (R ) dR dR HR (I , I ) =
0 0

2

(2.24)

Where Ahs is the surface area of the unit hemisphere that the BRDF is applicable over. The hemispherical reflectance is used with Lambertian scattering models in the event that full BRDF is not known. For the Zemax stray light analysis performed later in this thesis, no BRDFs for the baffle coatings were used. The scatter model is strictly a Lambertian model using the hemispherical reflectances provided from literature.

Chapter 3

Analysis Strategies
The hybrid stray light testing procedure involves characterizing the star tracker lens attenuation independently from the rest of the optical system. The lens attenuation curve is converted into a variably transmissive material (based on an incoming ray's incident angle) within a Zemax non-sequential ray-tracing environment. The lens data, together with baffle geometry and its surface properties, permit the estimation of the net attenuation of the optical system sys . Characterizing the lens as a blackbox system is more advantageous due to the component's complexity, where details of internal lens elements may not be known. This is in contrast to the baffle, where the geometry is designed and there are useful resources that document the properties of dark surface coatings[17][18] for aerospace applications. The measurement procedure is largely based on the developments presented in Section 2.4. Our technique is particularly interesting because the star tracker's CMOS detector was used as the photometric instrument as opposed to a conventional photometer such as a photomultiplier tube; this introduced issues resulting from underlying CMOS sensor mechanics. One primary concern was the separation of photon sources during measurement. In addition to surface scattering and atmospheric scattering, additional detector counts will accumulate in each pixel well due to internal thermal and electrical properties of the sensor circuitry[19]. This requires three separate measurements for a given orientation with respect to an incident beam. A measurement must be taken with all light sources eliminated, another with the collimated beam targeting the entrance aperture of the optical system, and finally one such that the sensor observes only an illuminated column of air. A visualization of these tests is provided in Figure 3.1 and Figure 3.2.

27

Chapter 3. Analysis Strategies

28

The dark measurement is used to estimate the dark signal background level within the other images. If the dark background signal is known, then the light generated detector counts within the other images can be isolated for. The atmospheric scattering measurement is then used to cancel out the atmospheric contribution of the fully illuminated aperture measurement much like the method proposed by Bock et al.[13]. After both operations, the doubly corrected measurement eliminates the extra illumination caused by the set-up. By performing these operations over a range of offset angles (between facing the beam and perpendicular to it), the lens stray light response is characterized by an attenuation curve and imported into ray-tracing software. In theory the procedure described above can be applied to

Surrounding Structures

Atmospheric scatter Stray light rays

Collimated Beam

Figure 3.1: Visualizing the fully illuminated test.
Surrounding Structures

Atmospheric scatter

Test Beam

Obstruction

Figure 3.2: Visualizing the blocked beam test.

Chapter 3. Analysis Strategies

29

Motorized Mount

Detector
Mirrors

Light Source

Integrating Sphere

Collimating Lens

Figure 3.3: A conceptual visualization of the SAIL stray light measurement experiment.

the entire star tracker optical system, but requires significant equipment investments. Atmospheric effects will limit the directly measurable attenuation to between 10-7 and 10-9 depending on environment conditions[15]. To isolate for the real response for far off axis measurements requires robust equipment with careful beam management and a dedicated large clean room. Ideally the testing should be performed in a vacuum chamber. The baffle designs are modelled in Autodesk Inventor 2015 CAD software and imported into the Zemax ray-tracing environment. Appropriate coatings models are mapped to the correct surfaces alike to their physical counterparts. The stray light experiment is then reconstructed within the ray-tracing environment and proceeds through a series of measurements that measures the optical power detected as a function of the offset angle relative to the source beam. Coupled with the developments in Section 2.3, this method estimates the stray light rejection of a baffled star tracker system and predicts the solar exclusion angle for the optical system.

3.1

The SAIL Test Facility

Laboratory tests were conducted at SAIL within Ryerson University inside a dark-room. Figure 3.3 provides an overview to the stray light experimental set-up. The light source consisted of a 75 W Xenon arc-lamp, that resembles the solar spectrum. The lamp immediately illuminates an integrating sphere to ensure that the exiting beam profile is homogeneous. Without the integrating sphere, the beam cross section will vary in both intensity and in colour.

Chapter 3. Analysis Strategies

30

The exit of the integrating sphere is collimated using a single lens to produce a beam approximately 8 cm in diameter. Collimating the light changes the apparent distance of the source (with respect to the sensor) to infinitely far away, like a star. It also preserves the beam's brightness which is important when trying to detect signals at strong attenuations. A diverging beam's flux will drop proportionally to how far the beam travels which will consequently make signals at large deviations difficult to detect. The experiment occupies an area that is often used to perform sensitive calibration procedures for the Sinclair Interplanetary star trackers. Thus one goal of this experiment was to create an apparatus that did not move any other equipment. To keep the stray light experiment as straightforward as possible, one would keep the beam length as small as necessary, however doing so would require moving the calibration equipment and reflecting the beam provides a convenient alternative. The sensor is attached to a three-axis motorized gimbal as displayed in Figure 3.4. The gimbal is used to control the sensor's orientation with respect to the incident beam. As the test platform rotates the lamp response translates in the direction defined by the rows on the detector. The walls of the dark-room are painted a matte black colour to mitigate stray reflections. Indicator LEDs on the outside and inside of computer chassis, LCD back-lights (even when blanked), gaps between the entrance doors and the floor, and stray illumination from the lamp enclosure can all produce significant ambient illumination that is detectable by the sensor. These sources are masked when possible or separated from the sensor FOV with opaque screens.

Figure 3.4: An ST-16 star tracker mounted to the motorized gimbal.

Chapter 3. Analysis Strategies

31

3.2

Lens Characterization

The goal of lens characterization is to obtain the attenuation curve for the star tracker independent of the baffle, in order to import it into Zemax. The true stray light response of the lens is overlapped with environment noise in the form of unwanted photons and sensor noise in the form of dark current. The experiment begins using the set-up shown in Figure 3.3. Initially the sensor is oriented such that the sensor boresight (optical axis) is coincident with the beam ( = 0 ). Measurements are sampled at regular offset angle intervals between completely coincident and perpendicular to the beam. There are two interesting offset angle regions that should be sampled, one region where the source is clearly within the FOV termed the "on-axis" region, and the other where the source is outside the FOV termed the "off-axis" region. The on-axis region is typically defined by large areas of saturated pixels, and the off-axis region is likely to have interesting internal reflections and stray light gradients within the image. Regardless of the type of sensor used in the star tracker lens assembly, three measurements are required to characterize the sensor's lens attenuation. These measurements are all detailed in Table 3.1. The modifier column in Table 3.1 describes what variables can be changed in order to control the signal level at the detector. If we consider the pixel model presented in Equation (2.3), either the source flux or the detector exposure time can manipulate the signal level. The exposure time setting for the sensor can scale the signal level, but neutral density (ND) filters provide broadband light attenuation that coarsely adjusts the source flux once introduced into the beam. The true response is obtained within the full illumination measurement. However this data is masked by the other noise sources as depicted previously in Figure 3.1. The true stray light response is due to light paths that enter the optical system immediately after reflecting off of the second mirror (see Figure 3.3). These are photons that enter the optical system, scatter within and terminate at the sensor. These light paths will generate more intense off-axis phenomena because they experience the least amount of attenuation. The purpose of the ambient measurement configuration is to estimate the unwanted illumination present in the fully illuminated measurement. This is done through removing direct light paths into optical system as seen in Figure 3.2 while preserving the sensor's orientation with respect to the beam. Detector response during these measurements are due to atmospherically scattered light, scattered paths off surfaces in the test chamber, and dark detector response.

Chapter 3. Analysis Strategies
Table 3.1: Summary of All Measurements Needed to Obtain the Lens Attenuation.

32

Measurement Type

Signal Types True Response

Purpose

Modifiers

Full Illumination

Ambient Scatter Surface Scatter Dark Signal

Contains the true response of the lens assembly.

texp nd

Ambient Scatter Ambient Surface Scatter Dark Signal

Measures the unwanted signals present in the environment. Used to remove unwanted signal from Full illumination measurement. Measures the dark response of the sensor. Used to remove dark signal from illuminated images.

texp nd

Ambient Scatter Dark Surface Scatter Dark Signal

texp

To estimate the elevated background signal due to internal sensor processes, we need to take measurements of the scene without any illumination. Light sources are turned off and an opaque lens cap is fixed to the sensor to prevent any light response on the detector. The dark signal is proportional to the exposure time setting and therefore exposure times must match between the dark measurement and the illuminated images to be corrected. This is critical because the dark response does not scale with any ND filter attenuation. To isolate for the true stray light response and the lens attenuation we need to manipulate the signals obtained from these three measurements. Let Iful represent the signal obtained from the fully illuminated measurement. Likewise let Iamb and D represent the signals obtained from the ambient and dark measurements respectfully. The signals from the illuminated measurements (Iful and Iamb ) varies with the sensor's orientation with respect to the incident beam . The light response within these measurements varies with the attenuation from ND filters nd and varying the exposure time texp . The signals and their independent variables are listed in Equation (3.1) through to Equation (3.3).

Iful = f (, texp , nd )

(3.1)

Chapter 3. Analysis Strategies Iamb = f (, texp , nd ) D = f (texp )

33 (3.2) (3.3)

The ambient and fully illuminated measurements are free to use different sets of ND filters as well as different exposure times subject to the condition that they are measured at the same orientation. The subscript indices 1 and 2 are used to simply denote the difference between the two configurations. To gauge the background signal level properly, the ambient signal should have a higher signalto-noise ratio (SNR). The ambient light signal will be much less intense than that of the fully illuminated measurement. Should the same manipulation parameters be used between the fully illuminated and the ambient measurement, the SNR will be very small. Thus the manipulation parameters should be changed in order to collect more light. However, if the light induced signal is still small, ND filters can be removed to raise the signal. Both illuminated measurements must be first "dark corrected" to isolate for light induced detector counts. We introduce a new manipulated signal L that represents the light-only response of the detector.

Lful = Iful (, t1 , nd,1 ) - D (t1 ) Lamb = Iamb (, t2 , nd,2 ) - D (t2 )

(3.4) (3.5)

Both light-only signals represent the light present in their own measurement configurations of texp and n d. In order to remove the ambient signal from Lful , we need to normalize both lightonly signals to bring them to a common scale. The true response is isolated via Equation (3.6).

J=

Lful (, t1 , nd,1 ) Lamb (, t2 , nd,2 ) - t1 · nd,1 t2 · nd,2

(3.6)

These operations are summarized in Figure 3.5. The advantage of isolating the true light signal in this way is that there is no need to keep the illumination configurations constant between the fully illuminated and ambient measurements. By blocking the beam in the ambient measurement, the light entering the detector is greatly reduced, and the manipulation parameters (texp and sys ) can be changed to compensate for the decrease in signal.

Chapter 3. Analysis Strategies

34

The true stray light response J is then converted into an attenuation by normalizing each measurement to the on-axis maximum.

lens () =

J () J (0 )

(3.7)

This technique can be expanded to take advantage of multiple pixels, specifically in the form of images from the Aptina CMOS sensor. The basic signal flow remains the same as described in Figure 3.5 but instead is applied as a per pixel operation.

3.2.1

Stray light Measurements of the ST-16

To characterize the lens stray light response of the ST-16, we cannot use a separate instrument to measure flux information. We require a technique in order to obtain flux measurements from the CMOS detector. The CMOS detector outputs information in terms of a matrix of digital counts. We must use the pixel intensity model described in Section 2.3.1 to convert digital counts into flux information. However, we cannot use a single set of measurements to describe the attenuation of the sensor because of the surface and atmospheric scattering effects present in an earthbound laboratory. Thus a framework is required to interpret pixel digital counts into a representation of flux and lens attenuation. The Aptina sensor outputs information in the form of an image, however in order for an image to be usable for photometry it must satisfy the following criteria. The sensor must be exposed for long enough to clearly see any response to the incident light, however, it is important that no pixel is found in a saturated state otherwise information loss occurs. Therefore a successful image is obtained when the exposure time (texp ) is increased such that the maximum intensity regions within image are just below the saturation limit. Longer exposure times will accumulate more stray light signal at a faster rate than dark noise signal and thereby increase the SNR. The main concern for these measurements is the large dynamic range that the attenuation curve varies through. During the on-axis region, attenuation values should be closest to unity, and attenuations should be much smaller (around the order of   10-6 ) when approaching further off-axis. This means that the expected light levels during the on-axis region are much brighter than those off-axis. For star tracker applications, the Aptina Imaging MT9P031 operates at a high gain setting in order to image dim stars; direct light from the source will saturate the detector. For each illuminated measurement, the manipulation parameters must be changed such that pixel saturation

Chapter 3. Analysis Strategies

35

does not occur. However, the Aptina sensor exposure time is restricted to a small dynamic range between 0.01s and 1s with a nominal setting of 0.1s. This allows two decades of signal control through manipulating the exposure time. In order to prevent saturation for on-axis measurements, we need to use ND filters to attenuate the incident beam. By using ND filters we can obtain scaled down illumination data for onaxis regions without information loss. For on-axis orientations, multiple ND filters are used

Full Meas.
Signals:
-Direct light -Surface scatter -Atmospheric scatter -Dark Signal

Ambient Meas.
Signals:
-Surface scatter -Atmospheric scatter -Dark Signal

Dark Meas.
Signals:
-Dark Signal

 match

 match
Signals: -Direct light -Surface scatter -Atmospheric scatter

Signals: -Surface scatter -Atmospheric scatter

1 

1 

1  1 

Signals: -Direct light

Figure 3.5: The required signal manipulations to isolate for the true stray light response.

Chapter 3. Analysis Strategies

36

consecutively to provide a significant flux attenuation, and when transitioning to off-axis regions, ND filters are removed one at a time to maintain a high SNR whilst avoiding saturation. Due to interface bandwidth constraints with the ST-16, we do not download full-frame images. Instead, 14 complete rows are sampled in 7 pairs across the centre of the image with equidistant spaces in between each pair. The rows are sampled in pairs to capture full local permutations of the sensor's Bayer pattern. A full Bayer pattern will clearly identify any damaged pixels that do not match their neighbours. The rows are sampled across the middle region of the pixel array because the light response is concentrated around the optical axis. This is particularly important for on-axis angle ranges where the source is within the FOV and translates through the centre of the pixel array. For simplicity we shall continue to refer to these as "images". Noise will always remain relevant for CMOS detectors and . Photon shot noise will result in varying levels of intensity for a pixel between consecutive images; average intensity level across several consecutive images will reduce the effect of shot noise. These precautions are needed to ensure that pixel saturation is likely to be caused by stray light response rather than a spontaneous processes. This enables the use of algorithmic logic to increase exposure times towards high intensity values without being susceptible to faulty pixels. The SAIL tests used 3 consecutive images to reduce temporal noise, as well as used a simple neighbourhood average filter that averaged three row pixels (including the target pixel and the two adjacent row neighbours on each side) to reduce consistent unexplained saturation. The SAIL stray light lens characterization tests used an offset angle range between 0 and 45 evenly sampled at 1 intervals. The sensor is mounted to the motorized gimbal such that the source translates across the image along the row direction. When the source is off-axis, we expect that any stray light gradients are unidirectional and vary only in the row direction. This allows us to be confident that fewer row samples can still sufficiently describe the entire image, at least for off-axis orientations. The ambient measurement requires special consideration for two reasons. Atmospheric scattering is proportional to the volume defined by the intersection of the sensor field of view and the collimated beam[15], and this volume should be preserved between both illuminated measurements to prevent a misleading correction. Figure 2.8 illustrates the discrepancy introduced by blocking a portion of the beam. The volume of illuminated air can be preserved by shifting the sensor backwards thus increasing the intersection volume. The sensor in Figure 2.8b can be moved backward away from the beam until both illuminated volumes are equal. The ambient measurements were performed by blocking beam from directly illuminating the lens. No attempt

Chapter 3. Analysis Strategies

37

G12 R1 G11 R2 G12 R1 G11 B2 G21 B1 G22 B2 G21 B1

G12 R1 G11 R2 G12 R1 G11
B2 G21 B1 G22 B2 G21 B1

G12 R1 G11 R2 G12 R1 G11
B2 G21 B1 G22 B2 G21 B1

Figure 3.6:

The MT9P031 detector's Bayer pattern illustrating the 8 different pixel channels[20].

was made to duplicated illuminated volume sizes for the SAIL stray light tests; increasing the degrees of freedom for the set-up would introduce more problems than necessary. Surface scatter off of objects within the test chamber will persist unless properly managed. No sophisticated beam dumps were created to control the surface scatter, but all primary paths to the detector were blocked with opaque screens. The reason being that whatever phenomena raised the background signal level still exists in the fully illuminated measurement and will remain to some degree in the ambient measurement should the sensor orientation remain fixed. Complications arise when considering different pixel channel offsets for the ST-16; in the absence of light, the CMOS will return in an uneven but repeating background subject to the detector's Bayer pattern. One single mean background signal level does not fully describe the dark response of the sensor; every pixel is mapped to one of eight different pixel channels {G11 , G12 , G21 , G22 , R1 , R2 , B1 , B2 } that each pixel's signal is read through. Figure 3.6 shows the detector pixel array configuration as well as the Bayer pattern of signal channels assigned to each pixel. Each signal channel has a unique analog offset, so the dark signal accumulated over an exposure will also reflect this offset. Thus the dark images for the ST-16 were assembled from calculating the channel means from the dark images D. Subtracting the channel means from the illuminated images Iful and Iamb yield the light-only response images Lful and Lamb .

Chapter 3. Analysis Strategies

38

3.2.2

Lens Attenuation curve of the ST-16

The entire purpose of this analysis is to characterize the ST-16 lens assembly as an attenuation curve so that it can be expressed in Zemax. The lens characterization measurements will yield the true response images for all orientations sampled. This section derives how to convert the isolated true response image J into a lens attenuation lens . To determine the lens attenuation curve we need to expand Equation (3.6) to take into account multiple pixel measurements across the image. According to Equation (3.6), every pixel within the stray light image, J is an expression of the local electromagnetic power present over the area of the pixel. This is because although the pixel originally measures a photon count in terms of digital counts, J is normalized by the exposure time which intentionally converts the measurement into a power. A given pixel is therefore a measurement for a rearranged version of Equation (2.3). We make the distinction between J which is a representation of the entire image and an individual pixel signal Ji . ¯px,i I = px () · Fsrc · Apx texp · nd,i

Ji () =

(3.8)

Where px,i represents the local attenuation provided by the lens at the pixel location. To generate an attenuation curve that represents the entire lens, we concern ourselves with the net attenuation captured by the entire scene. This is achieved by calculating the total power, P , measured across the entire image.
nppi nppi

P () =
i=1

Ji () = Fsrc · Apx ·
i=1

px,i ()

(3.9)

Where both nppi represents the number of pixels in the image. To properly interpret Equation (3.9), we must rearrange the equation in terms of the mean pixel attenuation,  ¯ px .
nppi

px,i ()  ¯ px () =
i=1

nppi

(3.10)

Combining Equation (3.9) and Equation (3.10), we obtain the critical relationship between the total power detected by the image and the mean lens attenuation.

Chapter 3. Analysis Strategies

39

P () = Fsrc · Apx ·  ¯ px () · nppi

(3.11)

The expression for the attenuation curve is now readily apparent as a normalized version of Equation (3.11).

lens () =

P () P (0 )

(3.12)

Equation (3.12) is the expression used to find the normalized attenuation curve of the lens, and represents the change in attenuation for the sensor as the orientation deviates from the on-axis maximum (that occurs at  = 0 ). The variables included in Equation (3.11), which consist of {Fsrc , Apx , imax , jmax } are all equipment dependant. If the source remains constant throughout the entire measurement procedure, then normalizing the total power curve P () by the maximum total power P (0 ) will eliminate the source flux variable. Likewise if all sensor parameters remain constant throughout all measurements (as they should), then all sensor variables will cancel as well leaving the normalized lens attenuation curve lens (). Equation (3.12) will return the lens attenuation curve upon isolating the true stray light response images. However, confidence in the attenuation curve remains uncertain. Attenuations with a large variability can suggest two things: either a strong gradient is present within the image, or the integrity of the image measurement is compromised with a low SNR and needs to be remeasured. The variability quantity serves as a verification check that the attenuation measurements are suitable for Zemax. To gauge the variability of each image, we look towards the standard deviation of each image ¯ (). J. We introduce the mean detector power P

¯ ( ) = P ( ) P nppi Which then leaves the image standard deviation in the following expression.

(3.13)

 ( ) =

1 nppi

nppi

¯ () J i ( ) - P
i=1

2

(3.14)

Equation (3.14) provides insight into the average deviation from the mean detector power for a given image J (). However, we must realize that Equation (3.14) still contains the consistent

Chapter 3. Analysis Strategies

40

variables Fsrc and Apx . To properly compare the standard deviation to the normalized attenuation curve, we require to normalize Equation (3.14) with P (0 ), which removes those variables and preserves the same scaling as Equation (3.12).

 =

 () P (0 )

(3.15)

Figure 3.7 plots the results of Equation (3.12) and the standard deviation levels of Equation (3.15) for the ST-16 star tracker. This gives an overview of the attenuation throughout the angle range along with how these values deviate from the mean attenuation. This presentation allows to clearly see areas of interest for the sensor equipment. For the ST-16 sensor, we see a strange illumination increase throughout the 26 - 31 range which is likely due to an internal reflection occurring. The noise floor further suggests that this is an internal reflection because the noise values are raised within this region. Baffle design for this sensor would should prevent stray light paths that enter the sensor at incident angles within this range.

10 Normalized Lens Attenuation lens

0

Lens Attenuation Noise Floor

10

-2

10

-4

10

-6

10

-8

10

-10

0

5

10

15

20

25

30

35

40

45

Boresight Offset Angle , deg.

Figure 3.7: Off-axis performance attenuation measurements.

Chapter 3. Analysis Strategies

41

680 681 703 704 Detector Row Index 726 727 748 749 771 772 794 795 816 817 500 1000 1500 Horizontal Pixel Location 2000 2500

Figure 3.8: Sample stray light image J (17 ), illustrating dominant gradients present in the image. Intense regions are coloured red and dim regions are coloured blue.

3.3

ST-16 Lens Attenuation Analysis

For offset angles beyond the on-axis angle range, the illumination gradient within each image is primarily one dimensional in nature. Figure 3.8 shows a visualization of a direct light image (J) at an offset angle of 17 . One can clearly see that each sampled row pair is very similar to the others. Illumination gradients in the off-axis region are primarily one dimensional in nature which reinforces our previous assumption. By averaging the sensor values between all the rows in an image, the spatial variations can be distinguished without the need of interpreting color data. Each image J consists of 14 rows, assuming a one dimensional gradient along the row axis, the rows can be averaged to collapse the image into one single curve. These curves are plotted in Figure 3.9 and shows the spatial variations of J sampled at regular angle intervals. The initial light beam maximum starts at the centre of the image and then proceeds to travel to the left as the offset angle is increased. As the beam travels further off-axis, some dimmer maxima begin to occur. It is worth noting that the strongest of the dimmer maximum lies alongside to the interesting feature within Figure 3.7.

Chapter 3. Analysis Strategies

42

10

0

10 Normalized Pixel Response

-1

10

-2

Source Travel Direction

03 deg. 10 deg. 17 deg. 24 deg. 31 deg. 38 deg. 45 deg.

10

-3

10

-4

A

10

-5

10

-6

10

-7

B 0 500 1000 1500 Horizontal Pixel Location 2000 2500

Figure 3.9: The progression of illumination gradients as the sensor deviates from the beam.

Figure 3.9 shows two different internal reflections. Both features labelled as "A" and both features labelled as "B" are the same internal reflection. "A" and "B" both begin as very faint features at the left side of the figure. As the offset angle increases, the features move towards the right and becomes more pronounced as the feature moves closer to the right edge of the image. One can see the similar shapes that both "A" features possess with each other, the more pronounced reflection is a scaled up version of the fainter feature. The same can be seen for "B" by comparing the shape of both reflections. One can clearly see the variability within the faint portions of each curve. The only way to minimize the variability and therefore increase the trustworthiness of the measurement is to ensure more light enters the lens at these orientations. Within these sections, a framework has been presented to analyze the stray light attenuation characteristics for a CMOS sensor using carefully designed measurements. With this kind of characterization, we can model the sensor within the Zemax environment as a blackbox element

Chapter 3. Analysis Strategies

43

in order to gauge the effectiveness of a complete optical system assembled from the lens and a baffle.

3.4

Ray Tracing

A ray-tracing program is a tailored computational engine that gives the end user total control over the light propagation within an optical system. The purpose of moving an analysis to a ray-tracing program is to calculate attenuation curves for whole star tracker optical systems without the issues that arise from using CMOS equipment, atmospheric and surface scattering phenomena. Within the ray-tracing environment, we can trivially simulate a space environment where the only signal measurement is due to the true stray light response. This means that all computational resources are devoted to tracing "useful" ray paths with regards to sources of light; the only ray paths considered are ones that originate from the stray light source in contrast to the experimental method that measures ambient rays present in the environment. Another advantage of ray-tracing is that it is trivial to change a variable within an experiment. Consider a technician that wishes to observe the attenuation impact of extending the length of a baffle design. Using the conventional experimental method, two baffle prototypes would be needed to permit the comparison. With ray-tracing, the two prototypes are digitally modelled and little resource investments are needed to complete the experiment. However, the benefits of ray-tracing are paired with drawbacks. Modelling stray light within a ray-tracing environment is computationally taxing problem, and consequently, robust simulations that trace millions of rays take several minutes to calculate (depending on the geometry's complexity). An attenuation curve is the result of accumulating the simulation results over many orientations; compounded with the simulation runtime, an attenuation curve magnifies the time required to generate a solution. Additionally, an attenuation curve will appear noisy at high off-axis angle. This means that several attenuation curves need to be generated to predict the true attenuation properties of an optical system. The time required to generate an attenuation curve will be on the order of hours if not days. The other drawback is the inherent uncertainty of using a simulation to obtain attenuation results. Some properties of the optical system, primarily the reflectivity of baffle coatings, may not be easily measurable for small research groups and therefore the uncertain properties must be modelled using similar properties found in literature. The accuracy of attenuation curves generated from ray-tracing are subject to the assumptions used when modelling each component. This requires the validation of ray-tracing predictions through using additional measurements.

Chapter 3. Analysis Strategies

44

Nevertheless, ray-tracing remains a useful tool to obtain insight into the attenuation properties of an optical system. Coupled with the attenuation targets described in Section 2.3, ray-tracing enables the rapid estimation of exclusion angles for star trackers. This section describes how to create a Zemax version of the stray light experiment, and examines how to increase the effectiveness of a ray-tracing simulation.

3.4.1

Zemax Stray Light Experiment

The Zemax implementation of the stray light experiment aims replicate the conceptual layout shown in Figure 3.3. The stray light experiment is performed in a non-sequential environment because we expect rays to interact multiple times with the baffle interior. The environment is 3-dimensional and there is full control over the position and orientation of every object with respect to a global coordinate system. However, each component can be "nested" within a parent object and therefore inherit the coordinate system of the parent object. This enables the definition of an object's orientation with respect to another object, and is particularly useful for rotating the baffled optical system. If the detector and the lens element are nested within the baffle, then rotating the baffle will rotate the other components to match their relative orientations. The simulation consists of four basic components as seen in the bottom of figure Figure 3.11; the source, the baffle, the lens model, and the detector. Rays are generated randomly at the source and fired toward the entrance aperture of the baffle. Depending on the orientation of the baffle, rays can either travel directly into the detector (if the source is within the FOV), or strike a baffle surface. Rays are allowed to scatter around within the baffle and attenuate their energy according to the baffle internal surface coating. As a ray propagates towards the detector, it passes through an energy attenuating surface that is parallel to the detector surface but offset slightly in front of the detector (in the direction of the baffle entrance). The ray then terminates at the detector and its energy is recorded. The total power measured by the detector is saved to a text file and compared to the other orientations. Each component is defined through a customizable Zemax object that emulates the behaviour of its real-world counterpart, and will be discussed in detail in the following sections. The data acquisition portion of the experiment can be entirely automated and the Zemax ZPL macro files are attached within the appendix. These programs require the user to initially generate the objects within the environment, specify the appropriate baffle model, and surface

Chapter 3. Analysis Strategies

45

Figure 3.10: The relative geometry of the baffled star tracker.

Source Object

Baffle Object

Lens Object (Attenuator)

Detector Object

Global Origin

Ray Direction

Rotation Direction

Figure 3.11: the converted Zemax model highlighting key simulation objects.

coating mappings. The set-up macro will set each object to its appropriate relative distance and the correct parent objects. The ray trace macro will simulate many orientations relative to the incident beam and save all power data to a text file, where it is further processed in MATLAB.

Chapter 3. Analysis Strategies 3.4.1.1 Global Settings

46

Most ray-tracing behaviour is dictated by object specific rules, however there are two critical parameters that could potentially ruin simulations if left unaltered. The first is the "Minimum Relative Ray Intensity", which enforces a minimum relative energy intensity difference for a ray as it interacts with a surface. This value should be set to a value smaller than the expected reflectivity of the baffle coating. This value was set to 10-12 . Setting this to a small number will ensure that the ray persists in the environment until it is terminated using other criteria. The other setting is the "Minimum Absolute Ray Intensity", which enforces a minimum ray intensity that a ray must possess in order to continue being traced. This value was is set to 10-20 . This value must be set low in order for rays to be picked up at high offset angles where they typically reflect several times before striking the detector. These parameters are non-dimensional because they are specified relative to a source ray's energy.

3.4.1.2

Baffle Model

The baffle object is an Autodesk Inventor Assembly file created from drafts provided SI. The baffle drafts are found in the appendix (Appendix A-5). Zemax can import the geometry described in a CAD file and create a 3-dimensional object compatible with the ray-tracing engine. The surfaces of the baffle are divided into two groups. One group has a mirror coating applied to it which reflects all rays with a specular behaviour. The mirror coating is applied to the external surfaces of the baffle; the mirror surface acts as a filter that reflects non-critical rays outwards which terminates the incident ray. All other surfaces have a diffuse black coating applied that representing the reflectivity a black matte anodized Aluminium coating. This surface possesses a hemispherical reflectance of 4% according to literature[21]. The material is completely opaque; therefore 96% of a ray's incident energy is absorbed by the aluminium and the residual energy scatters outward using a Lambertian scattering model. Upon interacting with the baffle, the original ray's energy is recorded and the ray is terminated. Several new rays are generated at the source of the interaction and the original ray's reflected

Chapter 3. Analysis Strategies

47

energy is divided between the new rays. This behaviour is controlled by the number of scattered rays parameter, nscat . The new rays then propagate in random directions outward from the interaction point. This process repeats indefinitely until the ray is terminated by either failing the minimum absolute ray intensity criteria, exiting the optical system via the entrance aperture, or striking the detector. If nscat is defined to be large, simulation times will increase exponentially. The baffle models are created such that their local coordinate system origin is located on the plane defined as the top of the baffle. The origin resides in the centre of the entrance aperture. This is done deliberately to ensure that the rotations within Zemax occur at this location. The baffle object serves as an anchor coordinate system for the lens object and the detector object coordinate systems.

3.4.1.3

Source Model

The source is defined as a uniform collimated beam that approximates a point source at infinity. This is achieved through choosing a planar source object. Ultimately, any source object shape is sufficient as long as the entire entrance aperture is illuminated. The source must therefore be offset away from the optical system a distance equal to half of the baffle width at minimum; this guarantees a clearance between the source object and the optical system for all offset angles. The source power can be chosen arbitrarily because the final results total power quantities are normalized relative to the maximum when calculating system attenuation factors. The parameter "Number of Analysis Rays" nrays controls how many initial rays are generated at the source object; each ray's initial power is an equal fraction of the source's total power. This number should be high in order guarantee a good sample of rays are striking the detector for all orientations where few rays will terminate at the detector. This parameter will greatly affects computational time.

3.4.1.4

Lens Response Model

Prior to reaching the detector, each ray is attenuated based on its incident angle relative to the detector. We define a custom surface coating that uses the lens data found in Figure 3.7. The lens data provided is in terms of a normalized attenuation as a function of incident angle, and can be easily programmed into a Zemax coating file. The coating text file is included in the

Chapter 3. Analysis Strategies
Table 3.2: List of all source object parameters that are changed from default values.

48

NS Component Property Object Type Ref Object Number of Layout Rays Number of Analysis Rays X Half Width Y Half Width

Value Source Ellipse 0 15 100000 15 15

Comment Closest shape to system entrance aperture. Shares Global Coordinate System. Irrelevant, controls ray rendering. Controls simulation "robustness". Size must be larger than entrance aperture (shares dimensions with CAD model). Size must be larger than entrance aperture (shares dimensions with CAD model).

Table 3.3: List of all lens object parameters that are changed from default values.

NS Component Property Object Type Ref Object X1 Half Width Y1 Half Width Z Length X2 Half Width Y2 Half Width

Value Rectangular Volume 2 23 20.5 0.5 23 20.5

Comment Shape is arbitrary, but size must be large enough so that no ray can avoid attenuation. Inherits baffle coordinate system. Geometric definition. Geometric definition. Geometric definition. Geometric definition. Geometric definition.

appendix (Appendix A-1) and is inserted in the Zemax COATING.DAT file within the TABLE coating section. Zemax linearly interpolates the lens data for incident angles between the sampled points. If a ray strikes the surface at a degree greater than the maximum provided angle, the attenuation of the maximum angle is applied to the ray. The coating must be applied to a single surface of a transparent 3 dimensional object. Any shape is sufficient such that there is an attenuating plane between the last vane (i.e. vane-1 in Figure 3.11) and the detector.

3.4.1.5

Detector Model

The detector is modelled as a square shaped plane that is placed offset of vane-1 as described in Figure 3.11. The detector is centred on the baffle central axis and placed at 0.89mm away

Chapter 3. Analysis Strategies
Table 3.4: List of all detector object parameters that are changed from default values.

49

NS Component Property Object Type Ref Object X Half Width Y Half Width # X Pixels # Y Pixels X Angle Min X Angle Max Y Angle Min Y Angle Max

Value Detector Rectangle 2 15 15 200 200 -90 90 -90 90

Comment Shape is arbitrary, but rectangle reflects the same shape as the real sensor detector. Inherits baffle coordinate system. Geometric definition. Geometric definition. Specifies pixel density. Specifies pixel density. Only accept rays striking the detector from the front. Only accept rays striking the detector from the front. Only accept rays striking the detector from the front. Only accept rays striking the detector from the front.

from the exit surface of the vane. The size of the detector is required to encompass the area exposed by the aperture. Additionally, the detector should be slightly larger then the last vane aperture to detect rays terminating at high incidence angles.

3.4.2

Speeding Up the Simulation

A ray trace using robust settings can take a long time to yield a solution. For stray light simulations, most rays do not hit the detector. There are however, some techniques that we use to guide the simulation to be effective. The system attenuation factors during the on-axis angle range are uninteresting with respect to that all attenuations where the source is in the FOV will be too large to conclude an exclusion angle. The detector response within this range is dominated by direct rays, and the scattered response is negligible. We therefore sample the system attenuation factor at varying increments. The on-axis measurement at 0 is mandatory for any attenuation measurement. A coarse sampling period of every 5 is used during the 0 to 30 offset angle range; intervals can be much larger but it is useful to see how quickly the attenuation drops as the source transits outside the field of view. However, outside of this range, direct rays do not strike the detector and the response is due to scattered rays. Scattered rays are heavily guided by the random number generator (i.e.

Chapter 3. Analysis Strategies

50

randomly picked directions after each scatter) and there will be some variance between repeated measurements. A finer sampling period of every 0.5 is used during a 30 to 60 offset angle range to gauge any structure apparent in the attenuation curve. The macro file used to execute this procedure is included in the appendix (Appendix A-3). Left unaided, orientations with strong attenuation levels require an excessive amount of rays traced. Simulations at high off-axis orientations heavily benefit from Importance Sampling. Importance Sampling enforces a scattering event to propagate towards a desired direction while scaling the ray energy by the probability of the event happening. The probability that a ray scatters in a direction is dictated by the orientation of the BRDF at the scatter location. An Importance Sampling target is created at the centre of the detector object. If this target is within line-of-sight from the scattering event, scattered rays are forced to choose directions toward the detector. If the target is not within line-of-sight, conventional scattering is modelled as it was beforehand. Importance sampling speeds up the simulation significantly by ignoring meaningless ray paths and yields much quicker solutions when compared to the unaided method. To increase the effectiveness of Importance sampling, the size of the source can be manipulated to guide more rays into the baffle. As the system rotates away from the source beam, the projected area of the baffle aperture as seen from the source becomes smaller. If left unchanged, rays will strike the outside of the baffle and reflect towards empty space and terminate. To force more rays into the baffle, the source shape is scaled by the cosine of the offset angle such that all the analysis rays are focused into the baffle. This is beneficial because it increases the spatial ray density and increases to likelihood that a ray will bounce off of a knife edge. Additionally, a survey was performed to ascertain a balance between nscat and nrays that yields efficient simulation times. A number of simulations were conducted on a consistent machine that examined the relationships between nscat , nrays , simulation times, and attenuation standard deviations. The system attenuation factors at high offset angles vary between repeated measurements. For a given set of nscat and nrays , 10 attenuation curves are generated for every 0.1 between 30 to 60 . A standard deviation in terms of attenuation values is calculated for every angle. The average standard deviation across this angle range is calculated to provide a measure of consistency for the configuration of nscat and nrays . This measure does not reflect the accuracy to the true attenuation curve value.

This process is repeated for all permutations of pairs from the sets nscat = {50, 545, 1040, 1535, 2030, 2525, 3020, 3 and nrays = {1000, 10900, 20800, 30700, 40600}. The results are displayed in Figure 3.12 to Figure 3.15. For each plot, lines of constant nscat or nrays is provided.

Chapter 3. Analysis Strategies

51

x 10 3 Average Standard Deviation in Attenuation  ¯

-7

2.5

2

nscat = 50 nscat = 545 nscat = 1040 nscat = 1535 nscat = 2030 nscat = 2525 nscat = 3020 nscat = 3515 nscat = 4010 nscat = 4505 nscat = 5000

1.5

1

0.5

0.5

1

1.5 2 2.5 3 3.5 4 Number of Analysis Rays nrays

4.5 x 10

5
4

Figure 3.12: The relationship between the average standard deviation and the number of analysis rays.
x 10 3 Average Standard Deviation in Attenuation  ¯
-7

2.5

nrays = 1000 nrays = 10900 nrays = 20800 nrays = 30700 nrays = 40600

2

1.5

1

0.5

0

1000 2000 3000 4000 Number of Scattered Rays nscat

5000

Figure 3.13: The relationship between the average standard deviation and the number of scattered rays.

Chapter 3. Analysis Strategies

52

30

25 Average Simulation Time tcalc , s

20

15 nscat = 50 nscat = 545 nscat = 1040 nscat = 1535 nscat = 2030 nscat = 2525 nscat = 3020 nscat = 3515 nscat = 4010 nscat = 4505 nscat = 5000 0.5 1 1.5 2 2.5 3 3.5 Number of Analysis Rays nrays 4 4.5 x 10 5
4

10

5

0

Figure 3.14: The relationship between the average simulation times and the number of analysis rays.

40 35 Average Simulation Time tcalc , s 30 25 20 15 10 5 0 0 1000 2000 3000 4000 Number of Scattered Rays nscat 5000 nrays = 1000 nrays = 10900 nrays = 20800 nrays = 30700 nrays = 40600

Figure 3.15: The relationship between the average simulation times and the number of scattered rays.

Chapter 3. Analysis Strategies

53

In general, a higher nscat will improve the consistency between repeated calculations. At the time of calculation, logic dictates that nscat should strongly affect the average simulation time. However Figure 3.15 shows that nscat yields little affect on the average simulation time at least for the scattered ray parameters tested. Further tests should analyse if higher values for nscat will significantly affect the simulation times in exchange for the increased consistency. The average simulation time for a configuration of nscat and nrays is dominated by the choice of nrays . The scattered rays parameter yields little effect on the simulation times. The ideal balance between nscat and nrays for the set of parameters tested is nscat = 3020 and nrays = 40600 which is attributed to a middle-ground in terms of consistency and an average simulation time of tcalc  26s.

Chapter 4

Baffle Model Validation
Up to this point, a process is described that calculates the system attenuation curve for a given baffle and lens. There are several attenuation uncertainties that arise from the interaction of stray light within the baffle. Does the baffle coating attenuate light as literature describes? How accurately does the baffle model describe reality? We answer these questions by performing stray light analysis on the baffle independent of the sensor optics. A baffle attenuation curve is measured using an auxiliary photometer and afterwards compared with baffle attenuation curves generated using identical methods presented in Chapter 3. The comparison provides insight on the accuracy of the original ray tracing models.

4.1

Baffle Attenuation Verification

The baffle for the ST-16 was designed to be mounted and assembled on top of the star tracker, encasing the lens in a 41mm × 46mm × 49mm volume. A sectioned view is provided in Figure 4.1. Four vanes are placed slightly outside of a 15 degree full angle field of view cone. The unit is manufactured from aluminium and is anodized to provide a dark matte surface at a near 4% reflectance[17]. To validate our ray tracing computations we measured the stray light rejection of the baffle alone with a radiometer using Heinisch and Jolliffe's method and compared the results to ray tracing predictions of the baffle alone. The radiometer is a pre-calibrated ILT1400 portable radiometer by International Light Technologies; it measures the irradiance of the observed scene and outputs a power flux reading to the digital screen. The illumination scenario is identical to that of Figure 3.3, however instead of the star tracker, the radiometer is mounted to the 55

Chapter 4. Baffle Model Validation

56

Figure 4.1: Cut-away view of the ST-16 anodized baffle design.

gimbal via foam board and the anodized baffle is placed in front of the radiometer. The centre of rotation for the gimbal is very close to the centre of the baffle's entrance aperture. Light flux measurements are taken every 1 from the range of 0 to 85 . A measurement consists of taking a short video of the ILT1400's dimly lit display panel, and sampling frames according to the display panel's 2Hz refresh rate. The mean light flux is calculated per orientation and plotted afterwards. Figure 4.2 summarizes the results of the anodized baffle stray light measurements compared to Zemax experiments replicating the same conditions. The square markers represent the results of the laboratory experiment; there was no need to remove atmospheric scattering because all basic measurements were at least two orders greater than the 10-7 threshold described in literature[15]. The other relationships represent the results of Zemax ray tracing for the baffle models. The first major insight is the modelling of the vane knife edges. The knife edge radius was initially modelled as perfectly sharp by default during CAD modelling but literature states that depending on manufacturing techniques, different degrees of sharpness are possible[22]. Pancrazzi et al. report that grinding techniques produce edges of around the order of 0.05mm and diamond milling techniques produce edge radii at least an order of magnitude smaller. By varying this parameter in the CAD model, the slope of the trends at high offset angles changed. This led to the conclusion that the knife edges of the physical baffle were likely to be similar to those produced by grinding. The assumed reflectivity also appeared to be too optimistic; by varying this parameter, a reflectivity of around 8% at visible wavelengths matched the laboratory measurements. The discrepancy between the laboratory measurements

Chapter 4. Baffle Model Validation
1

57

10

10

0

Laboratory Measurements 4% Refl. Perfect K.E. 4% Refl. 0.05mm K.E. 8% Refl. 0.05mm K.E.

10 Baffle Attenuation b

-1

10

-2

10

-3

10

-4

10

-5

10

-6

0

10

20

30 40 50 60 Boresight Offset Angle , deg

70

80

90

Figure 4.2: Comparing ray tracing baffle models.

and the Zemax predictions for angles below 25 are attributed to the smaller acceptance cone of the photometer in comparison to the FOV of the baffle. Together, these corrections to the ray tracing model lead to greater confidence for performance estimates than trusting published data alone.

4.2

Dedicated Laboratory Verification

Ultimately, our predictions for far off-axis attenuation performance for a baffled star tracker is speculation based on the best available knowledge. Verifying the ray tracing simulations using the baffle measurements directly, leads to strong trust in the behaviour of the baffle model within the ray tracing environment. To confirm our system attenuation predictions, direct measurements using a baffled star tracker in a laboratory would be ideal. However the SAIL laboratory is not suited to measure the predicted low attenuations confidently. To completely confirm our predictions we must use a robust facility that can reliably mitigate the problems introduced in earthbound stray light testing. Modern robust stray light testing facilities combine these advancements in large, extremely clean, and highly customized laboratories. The stray light measurement facility at Utah State

Chapter 4. Baffle Model Validation

58

University's Space Dynamics Laboratory[2] uses a 100f t long dark clean room and erects a specialized black specular enclosure to direct surface scatter away from the sensor field of view. The Centre Spatial de Li` ege in Belgium uses a custom 3m diameter black vacuum chamber that envelops their motorized mount[23]; the vacuum ideally removes all atmospheric scattering effects. These facilities, although robust, are expensive to schedule and more expensive to replicate. Alternatively, we are arranging stray light tests to be performed in cooperation with the Laboratory of Atmospheric and Space Physics (LASP) in Boulder, Colorado. Their stray light laboratory condenses and collimates a beam of sunlight to use as the light source within their clean dark room. The sun provides an intense source of light that requires no power but consequently demands consistent good weather for measurements. The intense sunlight will yield a strong stray light response at high off-axis angles. Unfortunately the tests will be performed in atmosphere and will need to estimate the atmospheric and ambient background signal to isolate for stray light response as described in Section 2.4 and Section 3.2. Unfortunately collaborating with another research group from the United States about ITAR regulated hardware proves to be lengthy legal process. We expect to perform these tests within the next couple of months.

4.3

Orbital Verification

There exists an alternative strategy to verify the hybridized stray light characterization procedure described herein. Sinclair Interplanetary presently has star tracker hardware aboard several satellites in orbit. We can feasibly orient a satellite such that the star tracker can take measurements at varying offset angles away from the sun. The problem with an orbital verification of a baffled star tracker is that the flux of the sun cannot be controlled; we cannot dim the sun to obtain useful on-axis measurements. A problem of normalization ambiguity arises. If we isolate for the stray light response within the imaged star fields, we do not know what reference total power (P (0 )) to normalize the measurements about. We can discern attenuations relative to the brightest measurement taken. This allows the construction of a local attenuation curve that can be compared to predicted full attenuation curves. If the shape of the local measured attenuation curve and the corresponding portion of the predicted attenuation curve primarily differ in terms of a scaling coefficient, then we can conclude that the attenuation curves generated via ray tracing are accurately reflecting reality.

Chapter 4. Baffle Model Validation

59

Alternatively, we can use stellar flux information from the imaged star scene to gauge the intensity of the stray light response. Star position information, coupled with catalogued photometric data of these stars should yield plenty of redundant illumination information. Stray light gradient intensity levels can then be estimated from the stellar illumination and total stray light power can be calculated. The on-axis reference total power can then be estimated via the methods presented in ?? and the normalized attenuation curve for the measured angle range can then be compared to ray traced predictions. The orbital verification is an attractive alternative because no atmospheric and surface scattering is guaranteed from the space environment.

Chapter 5

Baffle Design Applications
Throughout this thesis we establish a methodology to calculate the attenuation curves for a baffled star tracker. Chapter 4 has dealt with questioning the accuracy of such an analysis The final goal for these analyses is to deduce useful conclusions about baffle designs and to somehow use these conclusions to improve the microsatellite baffles made by SI. This chapter discusses several applications of this thesis material, both in individual parts or as a whole, when applied to designing and evaluating baffles.

5.1

Determining Exclusion Angles

Combining the sensor dependent false detection probability curve from ?? and the baffled system attenuation curves created from Section 4.1 allows the calculation of exclusion angles. Before we determine the exclusion angle, Figure 5.1 provides valuable insight on the stray light behaviour of the ST-16. Within the angle range between  = 0 and  = 10 , the source is within the FOV of the system and the attenuation is very weak. Beyond this angle range into the range described by  = 10 and  = 30 , the source transits outside the FOV and illuminates by indirect paths that reflect off of the internal lens assembly. Additionally, scatter becomes increasingly relevant. The response within the angle range described by orientations above  = 30 is solely due to scattered light. The attenuation within this angle range appears to be noisy, this is because the attenuation for these angles is incredibly susceptible to the random number generator. Figure 5.1 plots the calculated system attenuation curve provided by the ray tracing software against a false detection rate of 5 false detections per image provided by Figure 2.7. The 61

Chapter 5. Baffle Design Applications
10
0

62

Ray Tracing Results Solar 5 FD Attenuation Normalized System Attenuation sys
-2

10

10

-4

10

-6

10

-8

0

10

20 30 40 Boresight Offset Angle , deg.

50

60

Figure 5.1: Determining the exclusion angle from the false detection rate curve and calculated system attenuation curves.

intersection between these two curves such that further off-axis attenuations lay beneath the threshold will yield an estimate of the solar exclusion angle; for the anodized plate baffle design, the solar exclusion angle is therefore approximately 29 . Lunar and earth-limb exclusion angles can be calculated given the appropriate light flux information, and will be smaller than the solar exclusion angle. The full moon has a visual magnitude of roughly mmoon = -12.6 according to Greenbaum et al.'s research[24], and roughly translates to a light flux 5 · 105 times dimmer than the sun. Figure 5.2 plots the same false detection rate analysis as described in Section 2.3. One striking interpretation from Figure 5.2 is that while pointing directly at the Moon, the stray light false detection rate is very small. However, the Moon will definitely saturate the Aptina detector on the ST-16 and therefore our lunar exclusion angle is defined as the angle at which the Moon leaves the FOV. Therefore the lunar exclusion angle is approximately 10 which confirms our intuition.

5.2

Baffle Comparisons

Regardless of the lens characterization accuracy for the system attenuation curves, the performance differences between two systems using different baffles will be subject the the performance

Chapter 5. Baffle Design Applications
10 10 10 10 10 10 10 10 10
2

63

1

0

False Detection Rate FDR

-1

-2

-3

-4

-5

-6

False Detection Rate 5 False Detections Per Image
0

10

10 System Attenuation Factor sys

-1

Figure 5.2: False detection probabilities due to lunar stray light.

Figure 5.3: The new generation Acktar lathed baffle engineering model.

differences between the baffle attenuation curves. Considering two systems using different baffles, the only variable parameter is the attenuation provided by the baffles. The baffle attenuation curves could be predicted using ray tracing but measuring the attenuation curves directly will yield more confident results. Figure 5.3 displays a new prototype baffle from Sinclair interplanetary that has roughly the same dimensions as the anodized aluminium baffle but is lathed from one block of aluminium. The lathed baffle uses a much darker matte coating than the anodized baffle and is expected to perform more favourably for all angle ranges.

Chapter 5. Baffle Design Applications
1

64

10

10

0

Anodized Plate Baffle Acktar Lathed Baffle

10 Baffle Attenuation b

-1

10

-2

10

-3

10

-4

10

-5

10

-6

0

10

20

30 40 50 60 Boresight Offset Angle , deg

70

80

90

Figure 5.4: Comparing the measured baffle attenuation curves of the anodized and lathed baffles.

The lathed baffle attenuation has been measured using an identical experiment as the one described in Section 4.1, and both the anodized and lathed baffle attenuation curves are plotted in Figure 5.4. The Lathed baffle in general performs much better than the anodized baffle. There is an anomalous raised background level for the lathed baffle between 20 and 35 that is speculated to be an unaccounted light leakage from the source, but otherwise the lathed baffle possesses better performance for all other off-axis angles.

5.3

Stray Light Path Analysis

There exist some significant stray light paths between 36 and 48 within Figure 5.1 that drive the system attenuation above the false detection threshold. Performing ray tracing of the baffled star tracker within Zemax is advantageous because the simulation results can be saved and pruned afterwards to gain insight to dominant stray light paths. Upon closer inspection of the ray databases, we can compare the light paths between orientations just before, during, and after the anomalous hump in the attenuation curve. The results are summarized in Figure 5.5. At high orientation angles, the light source remains out of the field

Chapter 5. Baffle Design Applications

65

100 90 80 Incident Power Contribution 70 60 50 40 30 20 10 0 36 38 40 42 44 46 48 50 Boresight Offset Angle , deg. 52 54 Primary Scatter Secondary Scatter Other

Figure 5.5: Relative contributions of scatter types to the detector total incident power.

of view of the instrument, thus scattered photons enter the detector. The scattered photons are organized into three groups, primary, secondary, and the remaining photons. The groups reflect how many times each ray interacts with the baffle surfaces, where the 'other' group lumps the tertiary and above scattered photons into a single group. There are several competing effects occurring within the angle range described in Figure 5.5. As the offset angles increase, less light enters the baffle aperture. This effect if proportional to the cosine of the offset angle . The primary scatter is proportional to the number of knife edges directly illuminated. Through this angle range, there is a transition from three illuminated knife edges to two as can be seen in Figure 5.6; however during this transition, the bevelled portion of the third vane becomes perpendicular to the incoming light and promotes more direct light paths to the detector from the increased exposed surface area. This can be directly observed in Figure 5.6c and is speculated to be the cause of the anomalous hump within Figure 5.1. At higher angles, the bevelled surface becomes eclipsed and no longer illuminates the detector. Knife edges become the dominating contribution to the power incident on the detector as predicted by Figure 5.5.

Chapter 5. Baffle Design Applications

66

(a) 36 Primary Scattered Rays

(b) 36 Secondary Scattered Rays

(c) 46 Primary Scattered Rays

(d) 46 Secondary Scattered Rays

(e) 55 Primary Scattered Rays

(f) 55 Secondary Scattered Rays

Figure 5.6: Ray scattering paths at high offset angles.

Secondary scatter remains proportional to the projected area of the baffle's entrance aperture. At lower offset angles, greater portions of the baffle surface areas are directly illuminated and in turn illuminate the other internal surface. As the directly illuminated areas shrink, the secondary scattering areas shrink as well. This can be seen directly within the second column of Figure 5.6 and is reinforced by the decreasing contributions of secondary scatter to the total power incident on the detector according to Figure 5.5. Knife edge scatter intensity are minimized by ensuring the sharpest possible edges permitted by manufacturing techniques. This will reduce the directly illuminated areas of the knife edges and reduce the scatter intensity. Secondary scatter will dominantly be affected by the internal surface properties of the baffle; darker, less reflective surfaces will minimize the secondary scatter intensity.

Chapter 5. Baffle Design Applications
10
0

67

SRB Original SRB Flipped Vane 10 System Attenuation Factor sys
-2

10

-4

10

-6

10

-8

10

-10

0

10

20 30 40 Boresight Offset Angle 

50

60

Figure 5.7: The effect of flipping the bevel direction.

Ray tracing simulations were conducted on an alternate anodized baffle design of which the vane-2 bevel was flipped. The results are documented in Figure 5.7. Flipping the bevel largely did not change the feature between 35 -45 . However, the flipped vane did make the attenuation at higher offset angles better. The variations within Figure 5.7 are caused by using half of the number of attenuation curves when compared to Figure 5.1. The more individual curves that are used to generate the net attenuation curve, the smoother and closer it approaches to the true attenuation curve. This entire process is governed by the random number generator and is heavily susceptible to undersampling.

Chapter 6

Summary and Future Work
This thesis presents strategies and considerations relevant to the attenuation performance estimation of star trackers and their baffles. The required attenuation for the ST-16 optical system to operate reliably in a solar environment is calculated and compliments literature. The primary contribution of this thesis is the hybrid stray light analysis procedure. This is a valuable and versatile alternative to conventional experimental testing. Complete experimental testing requires committing resources to construct a baffle prototype such that the system's performance can be evaluated experimentally. The hybrid analysis evaluates the system performance of a baffled star tracker computationally with Zemax using an experimentally obtained characterization of the star tracker optics. This strategy will prove invaluable when evaluating potential designs for a baffle. Multiple prototype baffles can be evaluated rapidly without constructing a prototype. The secondary contribution of this thesis is validating the hybrid stray light analysis. To gain confidence in our estimation procedure, the baffle's attenuation is evaluated with both physical measurements and ray tracing software, leading to modelling adjustments. The system attenuation curve is presented and stray light paths are revealed for the anomalous region between 36 and 52 offset from the incident beam. The path analysis has shown a critical bevel surface that is likely causing the decreased attenuation, and through reversing this bevel, the decreased performance is removed. We define exclusion angle based on a principle of a false detection rate which specifies a target system attenuation to meet false detection criteria. The estimates of the ST-16 baffle performance by the hybrid method are combined with these attenuation targets to quantify the

69

Chapter 6. Summary and Future Work

70

exclusion angles for the ST-16 star tracker. The techniques discussed should provide a solid foundation for interested parties to perform their own stray light testing for their star trackers.

6.1

Future Work

Ideally to gain full confidence in our estimation procedure, we require a suitable facility that can provide the dynamic range needed to measure up until attenuations of around 10-9 using the full optical system. We are currently pursuing a partnership with the University of Colorado Boulder's LASP to aid our measurements, and expect results in the near future. Before the LASP tests, we will develop a validation technique based off of orbital measurements. A disadvantage unfortunately exists to characterizing the system attenuation as a curve. This representation removes all information about local light concentration on the detector. For example, attenuation values at orientations where the light source is just outside of the detector FOV cone yield no information on any intensity gradients found in the image. The lens characterisations have measured the existence of such gradients and they would result in noticeable local saturation on an in flight scenario. Intensity gradients could be significant in the comparison of two similarly performing baffles using the conventional system attenuation. Further endeavours will focus on the characterization of intensity gradients as a function of offset angle.

6.2

Closing Remarks

The true value of this work is in the applicability of the hybrid stray light analysis method. These techniques permit the interested party to rapidly obtain feedback for anything from small design changes, such as changing the diameter of a component, to more extreme changes like completely changing the baffle geometry. This is all enabled by the ray-tracing environment coupled with CAD software. The final destination of this research is to perform a complete baffle optimization to see which components can be varied and how we can maximize the performance of the baffle given the size constraint. Lessons learned from this research can be applied to any microsatellite star tracker baffle but also any stray light rejection device.

Appendix A

Zemax OpticStudio 14 Additional Files
A-1
ANGL 0

Lens Coating File

TABLE L E N S O N L Y A T T E N U A T I O N WAVE 0.390 0 0 0.7936935772 0.7936935772 0 0 0 0 WAVE 0.700 0 0 0.7936935772 0.7936935772 0 0 0 0 ANGL 1 WAVE 0.390 0 0 0.6874945582 0.6874945582 0 0 0 0 WAVE 0.700 0 0 0.6874945582 0.6874945582 0 0 0 0 ANGL 2 WAVE 0.390 0 0 0.5368565297 0.5368565297 0 0 0 0 WAVE 0.700 0 0 0.5368565297 0.5368565297 0 0 0 0 ANGL 3 WAVE 0.390 0 0 0.8286781235 0.8286781235 0 0 0 0 WAVE 0.700 0 0 0.8286781235 0.8286781235 0 0 0 0 ANGL 4 WAVE 0.390 0 0 0.9134837451 0.9134837451 0 0 0 0 WAVE 0.700 0 0 0.9134837451 0.9134837451 0 0 0 0 ANGL 5 WAVE 0.390 0 0 1.0000000000 1.0000000000 0 0 0 0 WAVE 0.700 0 0 1.0000000000 1.0000000000 0 0 0 0 ANGL 6 WAVE 0.390 0 0 0.8138554305 0.8138554305 0 0 0 0 WAVE 0.700 0 0 0.8138554305 0.8138554305 0 0 0 0 ANGL 7 WAVE 0.390 0 0 0.9066028949 0.9066028949 0 0 0 0 WAVE 0.700 0 0 0.9066028949 0.9066028949 0 0 0 0 ANGL 8 WAVE 0.390 0 0 0.8126002430 0.8126002430 0 0 0 0

71

Appendix: Zemax OpticStudio 14 Analysis Files
WAVE 0.700 0 0 0.8126002430 0.8126002430 0 0 0 0 ANGL 9 WAVE 0.390 0 0 0.0150437940 0.0150437940 0 0 0 0 WAVE 0.700 0 0 0.0150437940 0.0150437940 0 0 0 0 ANGL 10 WAVE 0.390 0 0 0.0005170762 0.0005170762 0 0 0 0 WAVE 0.700 0 0 0.0005170762 0.0005170762 0 0 0 0 ANGL 11 WAVE 0.390 0 0 0.0003183358 0.0003183358 0 0 0 0 WAVE 0.700 0 0 0.0003183358 0.0003183358 0 0 0 0 ANGL 12 WAVE 0.390 0 0 0.0002427617 0.0002427617 0 0 0 0 WAVE 0.700 0 0 0.0002427617 0.0002427617 0 0 0 0 ANGL 13 WAVE 0.390 0 0 0.0002283734 0.0002283734 0 0 0 0 WAVE 0.700 0 0 0.0002283734 0.0002283734 0 0 0 0 ANGL 14 WAVE 0.390 0 0 0.0001095863 0.0001095863 0 0 0 0 WAVE 0.700 0 0 0.0001095863 0.0001095863 0 0 0 0 ANGL 15 WAVE 0.390 0 0 0.0000866786 0.0000866786 0 0 0 0 WAVE 0.700 0 0 0.0000866786 0.0000866786 0 0 0 0 ANGL 16 WAVE 0.390 0 0 0.0000726004 0.0000726004 0 0 0 0 WAVE 0.700 0 0 0.0000726004 0.0000726004 0 0 0 0 ANGL 17 WAVE 0.390 0 0 0.0000641127 0.0000641127 0 0 0 0 WAVE 0.700 0 0 0.0000641127 0.0000641127 0 0 0 0 ANGL 18 WAVE 0.390 0 0 0.0000425807 0.0000425807 0 0 0 0 WAVE 0.700 0 0 0.0000425807 0.0000425807 0 0 0 0 ANGL 19 WAVE 0.390 0 0 0.0000364803 0.0000364803 0 0 0 0 WAVE 0.700 0 0 0.0000364803 0.0000364803 0 0 0 0 ANGL 20 WAVE 0.390 0 0 0.0000317812 0.0000317812 0 0 0 0 WAVE 0.700 0 0 0.0000317812 0.0000317812 0 0 0 0 ANGL 21 WAVE 0.390 0 0 0.0000297650 0.0000297650 0 0 0 0 WAVE 0.700 0 0 0.0000297650 0.0000297650 0 0 0 0 ANGL 22 WAVE 0.390 0 0 0.0000282477 0.0000282477 0 0 0 0 WAVE 0.700 0 0 0.0000282477 0.0000282477 0 0 0 0 ANGL 23 WAVE 0.390 0 0 0.0000261924 0.0000261924 0 0 0 0 WAVE 0.700 0 0 0.0000261924 0.0000261924 0 0 0 0 ANGL 24 WAVE 0.390 0 0 0.0000238558 0.0000238558 0 0 0 0 WAVE 0.700 0 0 0.0000238558 0.0000238558 0 0 0 0 ANGL 25 WAVE 0.390 0 0 0.0000217439 0.0000217439 0 0 0 0 WAVE 0.700 0 0 0.0000217439 0.0000217439 0 0 0 0

72

Appendix: Zemax OpticStudio 14 Analysis Files
ANGL 26 WAVE 0.390 0 0 0.0000212177 0.0000212177 0 0 0 0 WAVE 0.700 0 0 0.0000212177 0.0000212177 0 0 0 0 ANGL 27 WAVE 0.390 0 0 0.0000269615 0.0000269615 0 0 0 0 WAVE 0.700 0 0 0.0000269615 0.0000269615 0 0 0 0 ANGL 28 WAVE 0.390 0 0 0.0000359879 0.0000359879 0 0 0 0 WAVE 0.700 0 0 0.0000359879 0.0000359879 0 0 0 0 ANGL 29 WAVE 0.390 0 0 0.0000364641 0.0000364641 0 0 0 0 WAVE 0.700 0 0 0.0000364641 0.0000364641 0 0 0 0 ANGL 30 WAVE 0.390 0 0 0.0000334758 0.0000334758 0 0 0 0 WAVE 0.700 0 0 0.0000334758 0.0000334758 0 0 0 0 ANGL 31 WAVE 0.390 0 0 0.0000283186 0.0000283186 0 0 0 0 WAVE 0.700 0 0 0.0000283186 0.0000283186 0 0 0 0 ANGL 32 WAVE 0.390 0 0 0.0000098483 0.0000098483 0 0 0 0 WAVE 0.700 0 0 0.0000098483 0.0000098483 0 0 0 0 ANGL 33 WAVE 0.390 0 0 0.0000094828 0.0000094828 0 0 0 0 WAVE 0.700 0 0 0.0000094828 0.0000094828 0 0 0 0 ANGL 34 WAVE 0.390 0 0 0.0000083137 0.0000083137 0 0 0 0 WAVE 0.700 0 0 0.0000083137 0.0000083137 0 0 0 0 ANGL 35 WAVE 0.390 0 0 0.0000072633 0.0000072633 0 0 0 0 WAVE 0.700 0 0 0.0000072633 0.0000072633 0 0 0 0 ANGL 36 WAVE 0.390 0 0 0.0000068416 0.0000068416 0 0 0 0 WAVE 0.700 0 0 0.0000068416 0.0000068416 0 0 0 0 ANGL 37 WAVE 0.390 0 0 0.0000068004 0.0000068004 0 0 0 0 WAVE 0.700 0 0 0.0000068004 0.0000068004 0 0 0 0 ANGL 38 WAVE 0.390 0 0 0.0000062918 0.0000062918 0 0 0 0 WAVE 0.700 0 0 0.0000062918 0.0000062918 0 0 0 0 ANGL 39 WAVE 0.390 0 0 0.0000060830 0.0000060830 0 0 0 0 WAVE 0.700 0 0 0.0000060830 0.0000060830 0 0 0 0 ANGL 40 WAVE 0.390 0 0 0.0000041435 0.0000041435 0 0 0 0 WAVE 0.700 0 0 0.0000041435 0.0000041435 0 0 0 0 ANGL 41 WAVE 0.390 0 0 0.0000038322 0.0000038322 0 0 0 0 WAVE 0.700 0 0 0.0000038322 0.0000038322 0 0 0 0 ANGL 42 WAVE 0.390 0 0 0.0000037517 0.0000037517 0 0 0 0 WAVE 0.700 0 0 0.0000037517 0.0000037517 0 0 0 0 ANGL 43

73

Appendix: Zemax OpticStudio 14 Analysis Files
WAVE 0.390 0 0 0.0000037950 0.0000037950 0 0 0 0 WAVE 0.700 0 0 0.0000037950 0.0000037950 0 0 0 0 ANGL 44 WAVE 0.390 0 0 0.0000037584 0.0000037584 0 0 0 0 WAVE 0.700 0 0 0.0000037584 0.0000037584 0 0 0 0 ANGL 45 WAVE 0.390 0 0 0.0000040698 0.0000040698 0 0 0 0 WAVE 0.700 0 0 0.0000040698 0.0000040698 0 0 0 0 ANGL 46 WAVE 0.390 0 0 0.0000040546 0.0000040546 0 0 0 0 WAVE 0.700 0 0 0.0000040546 0.0000040546 0 0 0 0 ANGL 47 WAVE 0.390 0 0 0.0000038305 0.0000038305 0 0 0 0 WAVE 0.700 0 0 0.0000038305 0.0000038305 0 0 0 0 ANGL 48 WAVE 0.390 0 0 0.0000036154 0.0000036154 0 0 0 0 WAVE 0.700 0 0 0.0000036154 0.0000036154 0 0 0 0 ANGL 49 WAVE 0.390 0 0 0.0000035182 0.0000035182 0 0 0 0 WAVE 0.700 0 0 0.0000035182 0.0000035182 0 0 0 0 ANGL 50 WAVE 0.390 0 0 0.0000029029 0.0000029029 0 0 0 0 WAVE 0.700 0 0 0.0000029029 0.0000029029 0 0 0 0 ANGL 51 WAVE 0.390 0 0 0.0000027991 0.0000027991 0 0 0 0 WAVE 0.700 0 0 0.0000027991 0.0000027991 0 0 0 0 ANGL 52 WAVE 0.390 0 0 0.0000001640 0.0000001640 0 0 0 0 WAVE 0.700 0 0 0.0000001640 0.0000001640 0 0 0 0

74

Appendix: Zemax OpticStudio 14 Analysis Files

75

A-2
obj_srce obj_bffl obj_lens obj_det1 obj_det2 OR = 15

Simulation Object Setup Macro
= 1 = 2 = 3 = 4 = 5

RES = 200 ! Geometry - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! SETN SCPROPER TY 1 , obj_srce , 2 , 0 , 0 SETN SCPROPER TY 1 , obj_bffl , 2 , 0 , 0 SETN SCPROPER TY 1 , obj_lens , 2 , 0 , 2 SETN SCPROPER TY 1 , obj_det1 , 2 , 0 , 2 SETN SCPROPER TY 1 , obj_det2 , 2 , 0 , 2 SETN SCPOSITI ON 1 , obj_srce , 1 , 0 SETN SCPOSITI ON 1 , obj_bffl , 1 , 0 SETN SCPOSITI ON 1 , obj_lens , 1 , 0 SETN SCPOSITI ON 1 , obj_det1 , 1 , 0 SETN SCPOSITI ON 1 , obj_det2 , 1 , 0 SETN SCPOSITI ON 1 , obj_srce , 2 , SETN SCPOSITI ON 1 , obj_bffl , 2 , SETN SCPOSITI ON 1 , obj_det1 , 2 , 25.000 0.000 0.000

SETN SCPOSITI ON 1 , obj_lens , 2 , -35.000 SETN SCPOSITI ON 1 , obj_det2 , 2 , -35.775 SETN SCPOSITI ON 1 , obj_srce , 3 , SETN SCPOSITI ON 1 , obj_bffl , 3 , SETN SCPOSITI ON 1 , obj_lens , 3 , SETN SCPOSITI ON 1 , obj_det1 , 3 , SETN SCPOSITI ON 1 , obj_det2 , 3 , SETN SCPOSITI ON 1 , obj_srce , 4 , SETN SCPOSITI ON 1 , obj_bffl , 4 , SETN SCPOSITI ON 1 , obj_lens , 4 , SETN SCPOSITI ON 1 , obj_det1 , 4 , SETN SCPOSITI ON 1 , obj_det2 , 4 , SETN SCPOSITI ON 1 , obj_srce , 5 , SETN SCPOSITI ON 1 , obj_bffl , 5 , SETN SCPOSITI ON 1 , obj_lens , 5 , SETN SCPOSITI ON 1 , obj_det1 , 5 , SETN SCPOSITI ON 1 , obj_det2 , 5 , SETN SCPOSITI ON 1 , obj_srce , 6 , SETN SCPOSITI ON 1 , obj_bffl , 6 , SETN SCPOSITI ON 1 , obj_lens , 6 , 0.000 0.000 0.000 0.000 0.000 90.000 0.000 90.000 90.000 90.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000

Appendix: Zemax OpticStudio 14 Analysis Files
SETN SCPOSITI ON 1 , obj_det1 , 6 , SETN SCPOSITI ON 1 , obj_det2 , 6 , 0.000 0.000

76

! Geometry - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! ! Parameters - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! S ET NS CP A RA ME TE R 1 , obj_srce , S ET NS CP A RA ME TE R 1 , obj_srce , S ET NS CP A RA ME TE R 1 , obj_srce , S ET NS CP A RA ME TE R 1 , obj_srce , S ET NS CP A RA ME TE R 1 , obj_srce , S ET NS CP A RA ME TE R 1 , obj_srce , S ET NS CP A RA ME TE R 1 , obj_srce , S ET NS CP A RA ME TE R 1 , obj_srce , S ET NS CP A RA ME TE R 1 , obj_srce , 1 , 100 2 , 10000 3, 1 4, 0 5, 0 6 , OR 7 , OR 8, 0 9, 0 # Layout Rays # Analysis Rays # Power ( watts ) # Wavenumber # Color # X Half Width # Y Half Width # Source Distance # Cosine Exponent # Gauss Gx # Gauss Gy # Source X # Source Y # Minimum X Half Width # Minimum Y Half Width ( no touchy ) ( no touchy ) # Explode # Scatter Fraction # Scatter Rays # Importance Sampling # Importance Sampling ( no touchy ) ( no touchy ) ( no touchy ) ( no touchy ) ( no touchy ) ( no touchy ) ( no touchy ) ( no touchy ) ( no touchy ) ( no touchy ) ( cosmetic )

( changes in the database calcula ( no touchy ) ( no touchy )

( changes in the database

( changes in the database calcula ( no touchy ) ( no touchy ) ( no touchy ) ( no touchy ) ( no touchy ) ( no touchy )

( changes in the database calcula

S ET NS CP A RA ME TE R 1 , obj_srce , 10 , 0 S ET NS CP A RA ME TE R 1 , obj_srce , 11 , 0 S ET NS CP A RA ME TE R 1 , obj_srce , 12 , 0 S ET NS CP A RA ME TE R 1 , obj_srce , 13 , 0 S ET NS CP A RA ME TE R 1 , obj_srce , 14 , 0 S ET NS CP A RA ME TE R 1 , obj_srce , 15 , 0 S ET NS CP A RA ME TE R 1 , obj_bffl , SETN SCPROPER TY SETN SCPROPER TY SETN SCPROPER TY SETN SCPROPER TY 1 , obj_bffl , 1 , obj_bffl , 1 , obj_bffl , 1 , obj_bffl , 1, 0 8, 0, 1 9, 0, 1 151 , 0 , 1

152 , 0 , "1 5 11.5 1.5707" 1 , 23 2 , 20.5 3 , 0.5 4 , 23 5 , 20.5 6, 0 7, 0 8, 0 9, 0 1 , 17 2 , 17 3 , RES 4 , RES 5, 0 6, 0 7, 0 8, 2 9, 0 # X1 Half Width # Y1 Half Width # Z Length # X2 Half Width # Y2 Half Width # Front X Angle # Front Y Angle # Rear X Angle # Rear Y Angle # X Half Width # Y Half Width # X Pixels # Y Pixels # Data Type # Color # Smoothing # Scale # Plot Scale # Front Only # PSF Wave # X Angle Min # X Angle Max # Y Angle Min # Y Angle Max

S ET NS CP A RA ME TE R 1 , obj_lens , S ET NS CP A RA ME TE R 1 , obj_lens , S ET NS CP A RA ME TE R 1 , obj_lens , S ET NS CP A RA ME TE R 1 , obj_lens , S ET NS CP A RA ME TE R 1 , obj_lens , S ET NS CP A RA ME TE R 1 , obj_lens , S ET NS CP A RA ME TE R 1 , obj_lens , S ET NS CP A RA ME TE R 1 , obj_lens , S ET NS CP A RA ME TE R 1 , obj_lens , S ET NS CP A RA ME TE R 1 , obj_det1 , S ET NS CP A RA ME TE R 1 , obj_det1 , S ET NS CP A RA ME TE R 1 , obj_det1 , S ET NS CP A RA ME TE R 1 , obj_det1 , S ET NS CP A RA ME TE R 1 , obj_det1 , S ET NS CP A RA ME TE R 1 , obj_det1 , S ET NS CP A RA ME TE R 1 , obj_det1 , S ET NS CP A RA ME TE R 1 , obj_det1 , S ET NS CP A RA ME TE R 1 , obj_det1 ,

S ET NS CP A RA ME TE R 1 , obj_det1 , 10 , 1 S ET NS CP A RA ME TE R 1 , obj_det1 , 11 , 0 S ET NS CP A RA ME TE R 1 , obj_det1 , 12 , -90 S ET NS CP A RA ME TE R 1 , obj_det1 , 13 , 90 S ET NS CP A RA ME TE R 1 , obj_det1 , 14 , -90 S ET NS CP A RA ME TE R 1 , obj_det1 , 15 , 90

Appendix: Zemax OpticStudio 14 Analysis Files
S ET NS CP A RA ME TE R 1 , obj_det1 , 16 , 0 S ET NS CP A RA ME TE R 1 , obj_det1 , 17 , 0 S ET NS CP A RA ME TE R 1 , obj_det2 , S ET NS CP A RA ME TE R 1 , obj_det2 , S ET NS CP A RA ME TE R 1 , obj_det2 , S ET NS CP A RA ME TE R 1 , obj_det2 , S ET NS CP A RA ME TE R 1 , obj_det2 , S ET NS CP A RA ME TE R 1 , obj_det2 , S ET NS CP A RA ME TE R 1 , obj_det2 , S ET NS CP A RA ME TE R 1 , obj_det2 , S ET NS CP A RA ME TE R 1 , obj_det2 , 1 , 15 2 , 15 3 , RES 4 , RES 5, 0 6, 0 7, 0 8, 2 9, 0 # Polarization # Mirroring # X Half Width # Y Half Width # X Pixels # Y Pixels # Data Type # Color # Smoothing # Scale # Plot Scale # Front Only # PSF Wave # X Angle Min # X Angle Max # Y Angle Min # Y Angle Max # Polarization # Mirroring

77

S ET NS CP A RA ME TE R 1 , obj_det2 , 10 , 1 S ET NS CP A RA ME TE R 1 , obj_det2 , 11 , 0 S ET NS CP A RA ME TE R 1 , obj_det2 , 12 , -90 S ET NS CP A RA ME TE R 1 , obj_det2 , 13 , 90 S ET NS CP A RA ME TE R 1 , obj_det2 , 14 , -90 S ET NS CP A RA ME TE R 1 , obj_det2 , 15 , 90 S ET NS CP A RA ME TE R 1 , obj_det2 , 16 , 0 S ET NS CP A RA ME TE R 1 , obj_det2 , 17 , 0

! Parameters - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! UPDATE ALL OUTPUT SCREEN PRINT " END "

Appendix: Zemax OpticStudio 14 Analysis Files

78

A-3
!

Data Acquisition Macro

! Notes - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! ! SE TNSCPOSI TION surface , object , code , value ! Sets the x , y , z or tilt x , tilt y , tilt z position of any object in the NSC editor . ! This keyword requires 3 numeric expressions that evaluate to integers specifying the ! non - sequential components surface number , the object number , and a code . The code is 1 through 6 ! for x , y , z , tilt x , tilt y , tilt z , respectively . The fourth argument is the new value for the ! specified position . ! ! SE TN S CP AR AM E TE R surface , object , parameter , value ! This keyword requires 3 numeric expressions that evaluate to integers specifying the ! non - sequential components surface number , the object number , and the parameter number . The fourth ! argument is the new value for the specified parameter . ! ! NSDD Surf Det # Pix # Data ! This is the detector command that pulls the relevant data ! ! Surf = 1 , always . ! Det # requires the object number of the desired detector . ! If Det # = 0 then all detectors are cleared . If < 0 then then abs ( Det #) is cleared ONLY . ! Pix # if positive number , then that pixel ' s value is returned . ! If Pix # = ... ! ! ! ! ! ! ! ! ! ! ! ! Data refers to the desired data to return . ! If Data = ... ! ! ! ! ! ! NSTR surf , source , split , scatter , usepolar , ignore_errors , random_seed , save , savefilename , filter , z ! Notes - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! ! Begin Script - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! ! Simulation Config - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! d2r = 3 . 1 4 1 5 9 2 6 5 3 5 9 / 1 8 0 OR = 15 ! OR = 15 for SRB # Conversion between degrees to radians 0: Flux 1: Flux / Area 2: Flux / S ol id An g le Pi xe l ...? 3: Normalized Flux ( Only supported if Pix # is positive integer ) 0: Sum of the total flux in position space , average flux / area in position space , or -1: Maximum flux or flux / area . -2: Minimum flux or flux / area . -3: Number of rays striking the detector . -4: Standard deviation ( RMS from the mean ) of all the non - zero pixel data . -5: The mean value of all the non - zero pixel data . respectively . -9 , -10 , -11 , -12 , -13: The RMS radius , x , y , z , or xy cross term distance or angle of

space for all pixels for that detector object , for Data = 0 , 1 , or 2 , respecti

-6 , -7 , -8: The x , y , or z coordinate of the position or angle Irradiance or Intensity

with respect to the centroid . These are

# Radius ( mm ) to the outer vane ' s startin

Appendix: Zemax OpticStudio 14 Analysis Files

79

n_rays n_sc

= 10000 = 20

# Set the number of total rays for the NSC simula

# Set the number of total rays for the NSC simula

sc_frac = 1 S ET NS CP A RA ME TE R 1 , 1 , 2 , n_rays sta_iFOV = 0 fin_iFOV = 0 inc_iFOV = 0 sta_oFOV = 30 fin_oFOV = 60 inc_oFOV = 5 sta_j fin_j inc_j = 1 = 1 = 1 # Starting angle ( degrees ) for within the FOV # Final angle ( degrees ) for within the FOV # increment angle ( degrees ) for within the FOV # ^ out of the FOV # ^ out of the FOV # ^ out of the FOV # Starting loop index ( integer ) # Final loop index ( integer ) # Loop increment ( must be 1)

! Object Numbers as found in the non - sequential object editor . obj_source obj_baffle obj_det1 obj_det2 = 1 = 2 = 4 = 5

! Non - Sequential Ray Trace Parameters NSTR_surf NSTR_source NSTR_split NSTR_scatter NSTR_usepolar NSTR_ignore_errors N S T R _ r a n d o m_ s e ed NSTR_save NSTR_filter$ = "" = 1 = 1 = 1 = 0 = 1 = 0 = 0 = 1 # Must be 1 , always . #0 enables all sources . # Splitting not modelled ( waste of time ) # Scattering required # Applies the lens coating transmi ssivity # Prevents the solver from interrupting # Random seed always # Save rays to a database file # Store an UNFILTERED database

! Simulation Config - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! ! Reset Orientation - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! SETN SCPOSITI ON 1 , obj_baffle , 4 , 0 SETN SCPOSITI ON 1 , obj_baffle , 5 , 0 SETN SCPOSITI ON 1 , obj_baffle , 6 , 0 SETN SCPROPER TY 1 , obj_baffle , 8 , 0 , sc_frac SETN SCPROPER TY 1 , obj_baffle , 9 , 0 , n_sc UPDATE ALL ! Reset Orientation - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! ! SOURCE IN FOV - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! j = 1 # Initializes first loop value FOR i = sta_iFOV , fin_iFOV , inc_iFOV ! Recalculate Geometry - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! # Set X - tilt to zero # Set Y - tilt to zero # Set Z - tilt to zero # Scatter Fraction # Scatter Rays ( no touchy ) ( no touchy )

Appendix: Zemax OpticStudio 14 Analysis Files
SETN SCPOSITI ON 1 , obj_baffle , 4 , i SETN SCPOSITI ON 1 , obj_baffle , 5 , 0 SETN SCPOSITI ON 1 , obj_baffle , 6 , 0 S ET NS CP A RA ME TE R 1 , obj_source , 3 , COSI ( i * d2r ) S ET NS CP A RA ME TE R 1 , obj_source , 6 , OR S ET NS CP A RA ME TE R 1 , obj_source , 7 , OR * COSI ( i * d2r ) UPDATE ALL # Scale the source power

80
# Set X - tilt angle

# Set the correct source width to project onto th

! Recalculate Geometry - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! x = NSDD (1 ,0 ,0 ,0) # Clear all detectors

! Ray database file name - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! FORMAT "%#03 i " LIT str_loop$ = $STR ( j ) FORMAT "%3.1 e " LIT str_n_rays$ = $STR ( n_rays ) FORMAT "%#02 i " LIT str_sc$ = $STR ( n_sc ) FORMAT "%#05.2 f " LIT str_ang$ = $STR ( i ) s t r _ R D B _ f i le n a m e $ = " L "+ str_loop$ + " R " + str_n_rays$ + " SC " + str_sc$ + " D " + str_ang$ + ". ZRD "

! Ray database file name - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! ! Return Data - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! TIMER T = ETIM () # Begin timer # End timer and save elapsed time

NSTR NSTR_surf , NSTR_source , NSTR_split , NSTR_scatter , NSTR_usepolar , NSTR_ignore_errors , NSTR_random_se ! Return Data - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! ! Screen Feedback - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! FORMAT "%#06.4 e " LIT str_T$ = $STR ( T ) s t r _ R D B _ f i l e n a m e 2 $ = " L "+ str_loop$ + " R " + str_n_rays$ + " SC " + str_sc$ + str1$ = $PATHNAME ()+"\"+ s t r _ R D B _ f i l e n a m e $ str2$ = $PATHNAME ()+"\"+ s t r _ R D B _ f i l e n a m e 2 $ RENAMEFILE str1$ str2$ OUTPUT SCREEN print str_loop$ , " " , str_ang$ , " " , str_T$ ! Screen Feedback - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! NEXT ! SOURCE IN FOV - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! ! SOURCE OUT OF FOV - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! FOR j = sta_j , fin_j , inc_j

" D " + str_ang$ + " T " + str_T

Appendix: Zemax OpticStudio 14 Analysis Files
FOR i = sta_oFOV , fin_oFOV , inc_oFOV

81

! Recalculate Geometry - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! SETN SCPOSITI ON 1 , obj_baffle , 4 , i SETN SCPOSITI ON 1 , obj_baffle , 5 , 0 SETN SCPOSITI ON 1 , obj_baffle , 6 , 0 S ET NS CP A RA ME TE R 1 , obj_source , 3 , COSI ( i * d2r ) S ET NS CP A RA ME TE R 1 , obj_source , 6 , OR S ET NS CP A RA ME TE R 1 , obj_source , 7 , OR * COSI ( i * d2r ) UPDATE ALL ! Recalculate Geometry - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! x = NSDD (1 ,0 ,0 ,0) # Clear all detectors # Scale the source power # Set X - tilt angle

# Set the correct source width to project onto th

! Ray database file name - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! FORMAT "%#03 i " LIT str_loop$ = $STR ( j ) FORMAT "%3.1 e " LIT str_n_rays$ = $STR ( n_rays ) FORMAT "%#02 i " LIT str_sc$ = $STR ( n_sc ) FORMAT "%#05.2 f " LIT str_ang$ = $STR ( i ) s t r _ R D B _ f i l e n a m e $ = " L "+ str_loop$ + " R " + str_n_rays$ + " SC " + str_sc$ + " D " + str_ang$ + ". ZRD "

! Ray database file name - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! ! Return Data - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! TIMER T = ETIM () # Begin timer # End timer and save elapsed time

NSTR NSTR_surf , NSTR_source , NSTR_split , NSTR_scatter , NSTR_usepolar , NSTR_ignore_errors , NSTR_random_se ! Return Data - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! ! Screen Feedback - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! FORMAT "%#06.4 e " LIT str_T$ = $STR ( T )

s t r _ R D B _ f i l e n a m e 2 $ = " L "+ str_loop$ + " R " + str_n_rays$ + " SC " + str_sc$ + str1$ = $PATHNAME ()+"\"+ s t r _ R D B _ f i l e n a m e $ str2$ = $PATHNAME ()+"\"+ s t r _ R D B _ f i l e n a m e 2 $ RENAMEFILE str1$ str2$ OUTPUT SCREEN print str_loop$ , " " , str_ang$ , " " , str_T$

" D " + str_ang$ + " T " + str_T

! Screen Feedback - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -!

Appendix: Zemax OpticStudio 14 Analysis Files
NEXT NEXT

82

! SOURCE OUT OF FOV - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! OUTPUT SCREEN PRINT " END " ! End Script - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -!

Appendix: Zemax OpticStudio 14 Analysis Files

83

A-4

Data Processing Macro

str_RDBdir$ = $PATHNAME () + "\" str_RDBlist$ = str_RDBdir$ + "*. ZRD " ! Object Numbers as found in the non - sequential object editor . obj_source obj_baffle obj_det1 obj_det2 = 1 = 2 = 4 = 5 # Output filename # Clears output file

str_outname$ = " data . txt " str_outname$ = str_RDBdir$ + str_outname$ OUTPUT str_outname$ FORMAT "%1 i " LIT str_ baffleob j$ = $STR ( obj_baffle ) FINDFILE str_RDBname$ , str_RDBlist$ LABEL 1 if ( SLEN ( str_RDBname$ ))

# Returns first database filename

# Checks if filename is nonzero

! Screen Feedback - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! OUTPUT SCREEN PRINT str_RDBname$ # Provide visual feedback ! Screen Feedback - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! ! Return Data - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! tmp$ = $LEFTSTRING ( str_RDBname$ ,13) str_NRs$ = $RIGHTSTRING ( tmp$ ,8) tmp$ = $LEFTSTRING ( str_RDBname$ ,17) str_scs$ = $RIGHTSTRING ( tmp$ ,2) tmp$ = $LEFTSTRING ( str_RDBname$ ,23) str_ang$ = $RIGHTSTRING ( tmp$ ,5) ang = SVAL ( str_ang$ ) tmp$ = $LEFTSTRING ( str_RDBname$ ,35) str_tim$ = $RIGHTSTRING ( tmp$ ,11) ! Baffle Rotations SETNS CPOSITI ON 1 , obj_baffle , 4 , ang SETNS CPOSITI ON 1 , obj_baffle , 5 , 0 SETNS CPOSITI ON 1 , obj_baffle , 6 , 0 UPDATE ALL ZRDPLAYBACK str_RDBname$ , 1 , obj_det1 , 1 , "" TP1 = NSDD (1 , obj_det1 ,0 ,0) NH1 = NSDD (1 , obj_det1 , -3 ,0) # Returns computation time from filename # Returns offset angle from filename # Returns scattered rays from filename # Returns number of rays from filename

Appendix: Zemax OpticStudio 14 Analysis Files

84

ZRDPLAYBACK str_RDBname$ , 1 , obj_det2 , 1 , "" TP2 = NSDD (1 , obj_det2 ,0 ,0) NH2 = NSDD (1 , obj_det2 , -3 ,0) filt$ = " X_HIT (" + str_b affleobj $ + " ,0)" ZRDPLAYBACK str_RDBname$ , 1 , obj_det2 , 1 , filt$ SC_dir = NSDD (1 , obj_det2 ,0 ,0) pSC0 = SC_dir / TP2 *100 filt$ = " X_HIT (" + str_b affleobj $ + " ,1)" ZRDPLAYBACK str_RDBname$ , 1 , obj_det2 , 1 , filt$ SC_pri = NSDD (1 , obj_det2 ,0 ,0) pSC1 = SC_pri / TP2 *100 filt$ = " X_HIT (" + str_b affleobj $ + " ,2)" ZRDPLAYBACK str_RDBname$ , 1 , obj_det2 , 1 , filt$ SC_sec = NSDD (1 , obj_det2 ,0 ,0) pSC2 = SC_sec / TP2 *100 pSC3p = 100 - pSC0 - pSC1 - pSC2 ! Return Data - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! ! String Formatting2 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! FORMAT "%8.6 e " LIT str_TP1$ = $STR ( TP1 ) str_TP2$ = $STR ( TP2 ) str_NH1$ = $STR ( NH1 ) str_NH2$ = $STR ( NH2 ) FORMAT "%#06.2 f " LIT str_pSC0$ = $STR ( pSC0 ) str_pSC1$ = $STR ( pSC1 ) str_pSC2$ = $STR ( pSC2 ) str_pSC3p$ = $STR ( pSC3p ) ! String Formatting2 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! ! Write to File - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! OUTPUT str_outname$ , APPEND PRINT str_ang$ , " " , str_NRs$ , " " , str_scs$ , " " , str_tim$ , " " , str_TP1$ , " " , ! Write to File - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -! FINDFILE str_RDBname$ , str_RDBlist$ GOTO 1 ENDIF OUTPUT SCREEN PRINT " END " # Returns next database filename

str_TP2$ , " " , str_NH1

Appendix: Zemax OpticStudio 14 Analysis Files

85

A-5

Notes:
46.5 33.5

1. Remove all burrs and sharp edges

2. M3 x 0.5 Helicoil Thread Diam. = 3.15mm Depth = THRU Thread Depth = Fully Threaded

SECTION A-A
Note 2 - 4 Holes 48.5 4.5 41.5

46 44.5 38.5

7.5

1.5

A

Appendix: Zemax OpticStudio 14 Analysis Files

Short Rigid Baffle Drawings

O 2.6 - 3 Holes Evenly Spaced

39.541 33.5 36.5

R 5 x8 4.5 1 x 1 CHAMFER
O 23 O 38

7.5

R 3.5 x 4

A
1 x 1 CHAMFER

R 3 x4

1.5

UNLESS OTHERWISE SPECIFIED Tolerances (Unless Otherwise DIMENSIONS ARE IN MILLIMETERS Specified): X.X ±0.1mm
PROJECT

Sinclair, SAIL, SFL Startracker
PART DESCRIPTION

University of Toronto Institute for Aerospace Studies Space Flight Lab 4925 Dufferin St. Toronto, Ontario M3H 5T6 Phone: (416) 667-7916 Fax: (416) 667-7799
DRAWN BY: APPROVED BY: DATE:

Baffle Housing
SIZE MATERIAL

SFL-Star-MEC-AD007

86

Cordell Grant XXXXXXXXXX

10/7/2010
DATE:

A1
SCALE

Aluminum 6061-T6
VERSION

11/4/2010

1:1

1.1

SHEET 1 OF 2

Notes:

1. Remove all burrs and sharp edges except where otherwise noted.

B SECTION A-A

42.8 39.9 21.4 ±0.025 2.9 Sharp Edge Required Do Not File
O 3.15 x 4

1 (or 0.040")

Appendix: Zemax OpticStudio 14 Analysis Files

A

A

37.8 34.9
0 45° -1

2.9 R 3.5 x 4
O 18.1 +0.1 -0.0

DETAIL B

18.9 ±0.025

UNLESS OTHERWISE SPECIFIED Tolerances (Unless Otherwise DIMENSIONS ARE IN MILLIMETERS Specified): X.X ±0.1mm
PROJECT

Sinclair, SAIL, SFL Startracker
PART DESCRIPTION

University of Toronto Institute for Aerospace Studies Space Flight Lab 4925 Dufferin St. Toronto, Ontario M3H 5T6 Phone: (416) 667-7916 Fax: (416) 667-7799
DRAWN BY: APPROVED BY:

Baffle Vane #1 Cordell Grant XXXXXXXXXX
DATE: SIZE MATERIAL

SFL-Star-MEC-AD011

87

10/25/2010
DATE:

A1
SCALE

Aluminum 6061-T6
VERSION

10/25/2010

1:1

1.0

SHEET 1 OF 1

Notes:

1. Remove all burrs and sharp edges except where otherwise noted.

B SECTION A-A

42.8 39.9 21.4 ±0.025 2.9 Sharp Edge Required Do Not File
O 3.15 x 4

1 (or 0.040")

Appendix: Zemax OpticStudio 14 Analysis Files

A

A

37.8 34.9
0 45° -1

2.9 R 3.5 x 4
O 21.21 +0.1 -0.0

DETAIL B

18.9 ±0.025

UNLESS OTHERWISE SPECIFIED Tolerances (Unless Otherwise DIMENSIONS ARE IN MILLIMETERS Specified): X.X ±0.1mm
PROJECT

Sinclair, SAIL, SFL Startracker
PART DESCRIPTION

University of Toronto Institute for Aerospace Studies Space Flight Lab 4925 Dufferin St. Toronto, Ontario M3H 5T6 Phone: (416) 667-7916 Fax: (416) 667-7799
DRAWN BY: APPROVED BY:

Baffle Vane #2 Cordell Grant XXXXXXXXXX
DATE: SIZE MATERIAL

SFL-Star-MEC-AD010

88

10/25/2010
DATE:

A1
SCALE

Aluminum 6061-T6
VERSION

10/25/2010

1:1

1.0

SHEET 1 OF 1

Notes:

1. Remove all burrs and sharp edges except where otherwise noted.

B SECTION A-A

42.8 39.9 21.4 ±0.025 2.9 Sharp Edge Required Do Not File
O 3.15 x 4

1 (or 0.040")

Appendix: Zemax OpticStudio 14 Analysis Files

A

A

37.8 34.9
0 45° -1

2.9 R 3.5 x 4
O 24.2 +0.1 -0.0

DETAIL B

18.9 ±0.025

UNLESS OTHERWISE SPECIFIED Tolerances (Unless Otherwise DIMENSIONS ARE IN MILLIMETERS Specified): X.X ±0.1mm
PROJECT

Sinclair, SAIL, SFL Startracker
PART DESCRIPTION

University of Toronto Institute for Aerospace Studies Space Flight Lab 4925 Dufferin St. Toronto, Ontario M3H 5T6 Phone: (416) 667-7916 Fax: (416) 667-7799
DRAWN BY: APPROVED BY:

Baffle Vane #3 Cordell Grant XXXXXXXXXX
DATE: SIZE MATERIAL

SFL-Star-MEC-AD009

89

10/25/2010
DATE:

A1
SCALE

Aluminum 6061-T6
VERSION

10/25/2010

1:1

1.1

SHEET 1 OF 2

Notes:

1. Remove all burrs and sharp edges

2. Length (L) Variants:

A) L = 0.328in. +0.000/-0.002 B) L = 0.376in. +0.000/-0.002 C) L = 0.435in. +0.000/-0.002

O 0.1875 ±0.004 in.

Appendix: Zemax OpticStudio 14 Analysis Files

L

O 0.125 ±0.004 in.

UNLESS OTHERWISE SPECIFIED Tolerances (Unless Otherwise DIMENSIONS ARE IN MILLIMETERS Specified): X.X ±0.1mm
PROJECT

Sinclair, SAIL, SFL Startracker
PART DESCRIPTION

University of Toronto Institute for Aerospace Studies Space Flight Lab 4925 Dufferin St. Toronto, Ontario M3H 5T6 Phone: (416) 667-7916 Fax: (416) 667-7799
DRAWN BY: APPROVED BY: DATE:

Baffle Spacers (No Stop)
SIZE MATERIAL

SFL-Star-MEC-AD020

90

Cordell Grant XXXXXXXXXX

20/02/2011
DATE:

A1
SCALE

Aluminum 6061-T6
VERSION

04/11/2010

1:1

1.0

SHEET 1 OF 1

Bibliography
[1] RP Heinisch and CL Jolliffe. Light baffle attenuation measurements in the visible. Applied optics, 10(9):2016­2020, 1971. [2] John C Kemp, John L Stauder, Stephen B Turcotte, and Harry O Ames. Terrestrial black hole for measuring high-rejection off-axis response. In Optical Science, Engineering and Instrumentation'97, pages 45­56. International Society for Optics and Photonics, 1997. [3] Y Stockman, L Aballea, A Baeke, D Beghuin, M Fran¸ cois, ML Hellin, S Marcotte, E Mazy, M Taccola, and J Versluys. Stray light testing of the proba v payload. In SPIE Remote Sensing, pages 888911­888911. International Society for Optics and Photonics, 2013. [4] Frederick W Schenkel. A self deployable high attenuation light shade for spaceborne astronomical sensors. In Instrumentation in Astronomy, pages 109­116. International Society for Optics and Photonics, 1972. [5] Ralph C Bohlin. Spectrophotometric standards from the far-uv to the near-ir on the white dwarf flux scale. The Astronomical Journal, 111:1743, 1996. [6] Michael Bessell and Simon Murphy. Spectrophotometric libraries, revised photonic passbands, and zero points for ubvri, hipparcos, and tycho photometry. Publications of the Astronomical Society of the Pacific, 124(912):140­157, 2012. [7] ASTM International. Solar constant and zero air mass solar spectral irradiance tables. Technical Report E490-00a, American Society for Testing and Materials, 2006. [8] RC Bohlin. Hubble space telescope spectrophotometry and models for solar analogs. The Astronomical Journal, 139(4):1515, 2010. [9] Tom Dzamba and John Enright. Ground testing strategies for verifying the slew rate tolerance of star trackers. Sensors, 14(3):3939­3964, 2014. [10] C Leinert and D Kl¨ uppelberg. Stray light suppression in optical space experiments. Applied Optics, 13(3):556­564, 1974. 91

Bibliography

92

[11] Clair L Wyatt. Theory and methods of radiometric calibration. In 20th Annual Technical Symposium, pages 217­222. International Society for Optics and Photonics, 1976. [12] Hiroyuki Kawano, Haruhiko Shimoji, Shoji Yoshikawa, Katsumasa Miyatake, Kazumori Hama, and Shuji Nakamura. Suppression of sun interference in the star sensor baffling stray light by total internal reflection. In Optical Systems Design 2005, pages 59621R­ 59621R. International Society for Optics and Photonics, 2005. [13] JJ Bock, AE Lange, H Matsuhara, T Matsumoto, T Onaka, and S Sato. Cooled baffle system for spaceborne infrared telescopes. Applied optics, 34(13):2268­2277, 1995. [14] Isabella T Lewis, Arno G Ledebuhr, Timothy S Axelrod, and Scott A Ruddell. Stray-light reduction in a wfov star tracker lens. In San Diego,'91, San Diego, CA, pages 306­324. International Society for Optics and Photonics, 1991. [15] John C Kemp and Clair L Wyatt. Terrestrial measurement of the performance of highrejection optical baffling systems. Optical Engineering, 16(4):164412­164412, 1977. [16] Robert P Breault. Problems and techniques in stray radiation suppression. In 1977 SPIE/SPSE Technical Symposium East, pages 2­23. International Society for Optics and Photonics, 1977. [17] Michael Bass, Casimer Decusatis, Jay Enoch, Vasudevan Lakshminarayanan, Guifang Li, Carolyn MacDonald, Virendra Mahajan, and Eric van Stryland. Handbook of Optics, Third Edition Volume IV: Optical Properties of Materials, Nonlinear Optics, Quantum Optics, volume 4. McGraw-Hill Professional, Oct 2009. ISBN 978-00-7149-892-0. [18] Susan HCP McCall, Stephen M Pompea, Robert P Breault, and Nancy L Regens. Reviews of black surfaces for space and ground-based optical systems. In San Diego'92, pages 158­170. International Society for Optics and Photonics, 1993. [19] James R. Janesick. Scientific Charge-Coupled Devices, volume 1. SPIE Publications, Jan 2001. ISBN 978-08-1943-698-6. [20] Aptina Imaging. Mt9p031-cmos digital image sensor data sheet, 2014. [21] Michael Bass, Casimer Decusatis, Jay Enoch, Vasudevan Lakshminarayanan, Guifang Li, Carolyn MacDonald, Virendra Mahajan, and Eric van Stryland. Handbook of Optics, Third Edition Volume II: Design, Fabrication and Testing, Sources and Detectors, Radiometry and Photometry, volume 2. McGraw Hill Professional, Sep 2009. ISBN 978-00-7162-927-0.

Bibliography

93

[22] M Pancrazzi, S Viv` es, F Landini, C Guillon, C Escolle, and J Garcia. Optimization of baffle configuration for stray light reduction. In SPIE Optical Engineering+ Applications, pages 886205­886205. International Society for Optics and Photonics, 2013. [23] E Mazy, Y Stockman, and ML Hellin. Design and modelisation of a straylight facility for space optical instrument. In SPIE Optical Systems Design, pages 855007­855007. International Society for Optics and Photonics, 2012. [24] Adam Greenbaum, Mary Knapp, Greg Schaalman, Timothy Henderson, and Sara Seager. Low-mass high-performance deployable optical baffle for cubesats. In Aerospace Conference, 2013 IEEE, pages 1­12. IEEE, 2013.

