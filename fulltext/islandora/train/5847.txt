OPTIMAL SWITCHING FREQUENCY FOR AEROSPACE POWER CONVERTER SYSTEMS

By

Tharmini Thavaratnam BASc, University of Waterloo, Canada, 2011

A thesis presented to Ryerson University in partial fulfilment of the requirements for the degree of Master of Applied Science in the Program of Electrical and Computer Engineering

Toronto, Ontario Canada, 2016 Tharmini Thavaratnam 2016

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A THESIS

I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners.

I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

I understand that my thesis may be made electronically available to the public.

ii

OPTIMAL SWITCHING FREQUENCY FOR AEROSPACE POWER CONVERTER SYSTEMS Master of Applied Science 2016, Tharmini Thavaratnam Electrical and Computer Engineering, Ryerson University

ABSTRACT

Switching frequency is one of the main deciding factors in development of a power converter system for aerospace applications. The filter is one of the major components that significantly contribute to the overall system weight and efficiency. The design of the filter, including inductor and capacitor is determined by the switching frequency. On the other hand, the device switching loss is proportional to the loss, which in turn changes the design of thermal system. Thus selection of optimal switching frequency is essential for power converter systems used in aerospace industry. The objective of this study is to select the optimal switching frequency when the overall converter weight is minimal. In this study, switching frequencies ranging from 9kHz to 20kHz is selected based on current IGBT technology. Proven design algorithm for passive filter is adopted in the optimization. Partial verification for power efficiency is conducted via simulation and experiment results.

iii

ACKNOWLEDGEMENTS

I would like to express my deep gratitude and heart-felt thanks to my supervisor Dr. David Xu for his valuable guidance, patience, kindness, and consistent encouragement throughout the course of the work. I am grateful to Dr. Chushan Li and Dr. Zhijian Fang for their tremendous help in conducting my experiments and suggestions. I would also like to thank all my friends in LEDAR Lab for their suggestions and support. I would like to express my sincere thanks to my Program Administrator Dawn Wright for her continuous support during these years. I express my respect and intense gratitude to my parents who were the source of inspiration and support all through my life. Special thanks to my husband, Mathan Shanmugarasa, who supported me in every possible way to see the completion of this work. Financial support from Dr. David Xu, Honeywell, and Ryerson University are gratefully acknowledged.

iv

TO MY PARENTS

v

TABLE OF CONTENTS

ABSTRACT ...................................................................................................................................... iii ACKNOWLEDGEMENTS ................................................................................................................ iv LIST OF TABLES ........................................................................................................................... viii LIST OF FIGURES ........................................................................................................................... ix LIST OF APPENDICES .................................................................................................................... x CHAPTER 1 INTRODUCTION ......................................................................................................... 1 1.1 Background of the Study ................................................................................................................ 1 1.2 Literature Review of More Electric Aircraft .................................................................................. 2 1.3 Background Information about Aerospace Electrical Power System ...................................... 3 1.4 Relevant Studies about Optimization of Aerospace Power Systems ...................................... 5 1.5 Thesis Motivation and Objective ................................................................................................. 10 1.5.1 Research Questions and Methodology Overview ............................................................. 13 1.5.2 Scope of Work and Study Limitation ................................................................................... 14 1.6 Thesis Outline ................................................................................................................................ 15 CHAPTER 2 SELECTION OF PASSIVE COMPONENTS ........................................................... 17 2.1 Introduction ..................................................................................................................................... 17 2.2 Sinusoidal Pulse Width Modulation Technology ....................................................................... 18 2.3 Selection of Inductor for the Passive Output Filter ................................................................... 20 2.4 Selection of Capacitor for the Passive Output Filter ................................................................ 23 CHAPTER 3 INDUCTOR DESIGN ................................................................................................. 25 3.1 Selection of Magnetic Material .................................................................................................... 25 3.2 Selection of Magnetic Core .......................................................................................................... 28 3.3 Optimization of Inductor Design .................................................................................................. 29 3.3.1 Inductor Weight Calculation .................................................................................................. 31 3.3.2 Inductor Loss Calculation ...................................................................................................... 32 3.4 Summary of Optimized Inductor Design .................................................................................... 36 CHAPTER 4 OPTIMIZATION ......................................................................................................... 38 4.1 Inverter Loss Calculation .............................................................................................................. 38 4.1.1 Conduction Loss of the Inverter ........................................................................................... 38 vi

4.1.2 Switching Loss of the Inverter .............................................................................................. 39 4.2 Optimization of the Weight of the Overall Power System ....................................................... 41 4.2.1 Design Variables .................................................................................................................... 42 4.2.2 Objective Function ................................................................................................................. 42 4.2.3 Formulation of the Optimization Problem ........................................................................... 43 4.2.4 Optimization Results .............................................................................................................. 43 4.3 Optimization Summary ................................................................................................................. 44 CHAPTER 5 SIMULATION AND EXPERIMENT .......................................................................... 45 5.1 Introduction ..................................................................................................................................... 45 5.2 Verification by Simulation ............................................................................................................. 46 5.3 Verification by Experiment ........................................................................................................... 47 5.4 Simulation and Experiment Results Discussion ....................................................................... 49 CHAPTER 6 CONCLUSIONS ........................................................................................................ 55 6.1 Conclusions .................................................................................................................................... 55 6.2 Major Contributions ....................................................................................................................... 55 6.3 Future Work .................................................................................................................................... 55 APPENDICES .................................................................................................................................. 57 REFERENCES ................................................................................................................................ 72

vii

LIST OF TABLES
Table 2-1 Inductor Values versus the Switching Frequency for Various Examples ...................... 23 Table 3-1 Magnetic Properties for Selected Amorphous Material .................................................... 27 Table 3-2 Parameter Values used for Inductor Design ...................................................................... 31 Table 3-3 Inductor Core Loss Values between the Switching Frequencies 9kHz and 20kHz ..... 34 Table 3-4 Inductor Copper Loss Values between the Switching Frequencies 9kHz and 20kHz . 35 Table 3-5 The Inductor Design Parameter Values for Frequencies 9kHz to 14kHz ...................... 37 Table 3-6 The Inductor Design Parameter Values for Frequencies 15kHz to 20kHz.................... 37 Table 5-1 Power Loss Calculation and Experiment Results ............................................................. 53

viii

LIST OF FIGURES
Figure 1-1 Schematic of MEA Power Distribution ................................................................................. 3 Figure 1-2 (a) Constant Speed Drive of Aircraft Power Generation; 1(b) Integrated Drive Generator of Aircraft Power Generation ................................................................................................. 4 Figure 1-3 Variable Frequency Aircraft Power Generation .................................................................. 4 Figure 1-4 VSCF Starter or Generator System I ................................................................................... 5 Figure 1-5 VSCF Starter or Generator System II .................................................................................. 6 Figure 1-6 Proposed 3-Phase Active Output Filter (AOF) Topology for 400Hz VSCF.................... 7 Figure 1-7 Overview of Supply, Active Power Filter (APF) and Load, which drives a compressor of an Electrical Environmental Control System (E-ECS) ..................................................................... 8 Figure 1-8 Aircraft Onboard Power Grid ................................................................................................. 9 Figure 1-9 The PWM+SSPS FB-TPC Topology proposed by Xiaoqing .......................................... 10 Figure 1-10 Schematic of Three-Phase Inverter with LC Filter and RL Load ................................. 11 Figure 2-1 Schematic of Single Phase Inverter with LC Filter and RL Load ................................... 17 Figure 2-2 SPWM Signal Generation .................................................................................................... 19 Figure 2-3 Sinusoidal PWM of a Two-Level Voltage Source Inverter .............................................. 19 Figure 2-4 LC Filter Inductor Values for Half Switching Cycle at 15kHz ......................................... 21 Figure 2-5 Selected Inductance Value versus Switching Frequency ............................................... 22 Figure 2-6 The Fast Fourier Transform (FFT) Waveform for one Example .................................... 24 Figure 2-7 Obtained Capacitance Value versus Switching Frequency ........................................... 24 Figure 3-1Typical Magnetization Curve ................................................................................................ 26 Figure 3-2 Vitroperm 500F Material B-H Loop .................................................................................... 28 Figure 3-3 EE Core with Geometrical Dimensions ............................................................................. 29 Figure 3-4 Inductor Weight versus Switching Frequency .................................................................. 32 Figure 3-5 Flowchart for the Optimized Design of the Filter Inductor Lf .......................................... 36 Figure 4-1 Inverter Total Loss versus Switching Frequency ............................................................. 41 Figure 4-2 Weight of Heatsink versus Switching Frequency ............................................................. 43 Figure 4-3 Weight of the Heatsink and Inductor versus Switching Frequency ............................... 44 Figure 5-1Experimental Setup for Power Loss Verification ............................................................... 45 Figure 5-2 Back to Back Voltage Source Inverter Version 2 ............................................................. 46 Figure 5-3 Experiment Setup for VSI with FPGA LCD Display used to run PWM Signal ............. 47 Figure 5-4 Three-Phase DC to AC Power Converter Connected with Output LC Filter ................ 48 Figure 5-5 Oscilloscope Waveforms for Line-to-Line Inverter Voltage, Filter Capacitor Voltage, and Inductor Current for Phase A .......................................................................................................... 49 Figure 5-6 Phase A Inductor Current for both Experiment and Simulation for 400VDC ............... 50 Figure 5-7 Inverter Line-to-Line Voltage for Experiment and Simulation with 400VDC ................ 51 Figure 5-8 Oscilloscope Waveforms for Inductor Current for Phase A at 500VDC ....................... 52

ix

LIST OF APPENDICES
APPENDIX A ............................................................................................................................ 57 APPENDIX B............................................................................................................................ 59 APPENDIX C............................................................................................................................ 61 APPENDIX D............................................................................................................................ 64 APPENDIX E............................................................................................................................ 66 APPENDIX F............................................................................................................................ 68 APPENDIX G ............................................................................................................................ 70

x

CHAPTER 1 INTRODUCTION 1.1 Background of the Study Frequency is one of the common factors in designing power converter systems for aerospace applications. To maintain the power density of energy conversion, fundamental frequency of 400Hz power systems are preferred over conventional 50Hz or 60Hz [1]. Aircraft power generation developed in stages started from constant speed drive to variable speed constant frequency (VSCF) based aircraft electric power system which consists of a rectifier, DC-link followed by a pulse width modulated (PWM) inverter with passive output LC filters to generate sinusoidal output voltage to the load [2]. In low power supplies the switching frequency of the inverter may be increased in order to reduce the need for filtering [3]. However, the limited switching frequency by the switching devices in high power applications resulted in larger size LC filters. Insulated gate bipolar transistor (IGBT) switching devices have improved the performance of PWM inverters for driving the motor. The newer generation IGBTs can handle switching frequencies up to 20kHz [4]. Due to the increased number of electrical systems and their rising power ratings in airplanes, the optimization of devices and actuators regarding efficiency and power density has become significantly important [5]. Over the past decades, there were numerous research projects have been conducted for making the aircraft light weight considering the redesign of active filters and the overall power systems [1, 2], [5 - 9]. Selection of switching frequency for the aerospace power converter system is usually assumed with some kind of experience, for example 2.5kHz, 10kHz, or 20kHz [10] [12]. Griffo in [11] proposed a procedure for the design and optimization of passive DC filters by aiming at the minimization of the total filter weight with guaranteed stability margins and power quality performances for aerospace applications by assuming the switching frequency as 10kHz. This thesis aims at the study conducted by verifying the switching frequency ranges between 9kHz and 20kHz while designing the inductor of the output LC filter. For each switching frequency within the selected range, inductor is designed considering
1

the weight and efficiency optimization of the overall converter system. In this study, the maximum switching frequency is set as 20kHz since the current IGBT modules can be energized up to 20kHz without de-rating. It will avoid additional modules add weight to the overall system. This chapter starts with the literature review of more electric aircraft (MEA) followed by the background information about aerospace electrical power system configurations. A comprehensive review on the relevant studies conducted for various methods is then provided. 1.2 Literature Review of More Electric Aircraft Based on Quigley's publication from 1993 [13], "MEA concept is based on utilizing electric power to drive aircraft subsystems which historically have been driven by a combination of hydraulic, electric, pneumatic, and mechanical power transfer systems". According to [14] - [16], it is understood that during World War II, the concept of MEA has been considered by military and they found out that it was unfeasible at that time due to the insufficient electrical power generation capability. As mentioned in [16], the research of MEA over the centralized hydraulics abroad aircraft has been started since 1990s. MEA has been introduced to overcome the drawbacks of the conventional architectures and has advantages including improved fuel consumption, lower maintenance, and operation costs [17]. Even though the electrical power doesn't require a heavy infrastructure and is very flexible, it still suffers some drawbacks such as low power density compared to hydraulic power and may pose a higher risk of fire in case of a short circuit. As per [16], Figure 1-1 shows the schematic of MEA power distribution of an advanced on-board energy power management and drive systems for advanced commercial aircraft. According to [16], it was believed in 2007 that this system has more potential for future improvement because of the energy efficiency based on the worldwide research conducted during the time.

2

Figure 1-1 Schematic of MEA Power Distribution 1.3 Background Information about Aerospace Electrical Power System As mentioned in [16], the development of reliable, solid-state, high power density, power related electronics contributed mainly to the feasibility of an electric aircraft nonpropulsive power system. Based on Rosero's publication from 2007 [16], "Generator power control units, inverters, converters, and motor controllers consist of state-of-the art silicon based power semiconductor switching devices that include IGBTs". The evolution of aircraft power generation system started with constant speed drives (CSD) which are implemented by a mechanical gears between the variable speed jet engine and a 400Hz synchronous generator [1], [17- 18]. The mechanical gear system is a hydro-mechanical variable ratio drive that couples the jet engine shaft to the synchronous generator via stages of gears and hydraulic cylinder cluck. However, CSD has several disadvantages such as low efficiency, frequent and costly maintenance requirement, and large size and weight of the CSD system [19]. In

3

addition, the hydro-mechanical coupling and the synchronous generator need to be placed next to each other [19]. For many years, electrical power for aerospace applications has been generated using a variable ratio gearbox-mounted wound-field synchronous machine to obtain a three phase 115V AC system at a constant frequency of 400Hz. This machine is known as a constant frequency integrated drive generator (IDG). Figure 1-2 shows the aircraft power generation stage development from constant speed drive to integrated drive generator [1].

Figure 1-2 (a) Constant Speed Drive of Aircraft Power Generation; 1(b) Integrated Drive Generator of Aircraft Power Generation

Although, IDG configuration improves power density of the aircraft's power generation stage, it shares all the other abovementioned CSD disadvantages. Figure 13 shows the variable frequency (VF) system which eliminates the mechanical coupling and requires the electrical loads to be operated over a frequency range 350Hz to about 750Hz [20].

Figure 1-3 Variable Frequency Aircraft Power Generation
4

However, operating experiences under the new requirements have shown that a replacement for the gearbox using power electronics has obvious advantages [16]. A high quality three phase AC-DC conversion plus subsequent DC-AC conversion is one of the steps involved in achieving these objectives. The resulting system is known as variable speed constant frequency (VSCF) system and it results in dramatic improvement in system size and performance. Figure 1-4 and Figure 1-5 show the VSCF system which consists of a rectifier, DC-link, followed by a PWM inverter with passive output LC filter [1], [17 - 20].

Figure 1-4 VSCF Starter or Generator System I

1.4 Relevant Studies about Optimization of Aerospace Power Systems Over the past years, there were numerous research projects have been conducted for making the aircraft light weight considering the redesign of active filters and the overall power systems. Fahad [1] proposed a new active output filter (AOF) for VSCF power system in aerospace applications. The proposed AOF is envisioned as a power semiconductor filter block. As shown in Figure 1-6, in the proposed system, the passive LC output filter components are replaced by an H-bridge and it is operated at
5

high frequency to inject voltage harmonics to achieve a sinusoidal output voltage to the load. Fahad's proposed AOF concept offers significant reduction in size and weight compared to passive LC filter. The switching frequency used for this suggested example is assumed as 50kHz.

Figure 1-5 VSCF Starter or Generator System II Similarly, Sabastian [5], proposed a design and implementation of control algorithm for an active power filter (APF) in aviation. The solution allows the use of simple diode bridge rectifiers in all power electronic devices within the subnet, which results in increased reliability, power density, and reduced costs. Figure 1-7 shows the system overview where Lnet represents the generator and cable impedance, which is realized by an air choke in laboratory test setup. The DC-link voltage is generated using a diode bridge rectifier and the six-pulse motor is driven by a duplex inverter stage. Also, the APF with floating DC-link, inverter and ripple filter is arranged parallel to the main power flow. The challenges are supply frequency variations from 360 Hz up to 800Hz and the frequency step of 50Hz in millisecond. Also, the inductance between the APF and supply must be very small due to the requirement of low weight and volume. Sabastian is also assumed the switching frequency as 50kHz in his example design.

6

Figure 1-6 Proposed 3-Phase Active Output Filter (AOF) Topology for 400Hz VSCF

Johannes [7] proposed architecture to optimize the weight of an aircraft power supply system through a high 270VDC main voltage. High voltage means lower cable weight. Johannes added that the converters inside the loads can be build much lighter when using a 270VDC supply in a modern aircraft. Figure 1-8 shows the onboard power grid of an aircraft. Johannes concluded that 270VDC supply could reduce the weight of the devices by 230kg in addition to the reduced cable weight. Erdelyi [8] proposed a design consideration and optimization of homopolar inductor alternators of aerospace power systems. As a logical sequence, a means to find the main dimensions of a new design for a specific aerospace power system is presented. Xiaoqing [9] proposed a PWM plus secondary side phase shift controlled (PWM+SSPS) full bridge three port converter (FB-TPC) for aerospace power system to interface the solar source, battery, and load together and provide stable and continuous power to the load. Figure 1-9 shows the topology of the proposed FB-TPC in which the two source ports on the primary side are connected to a PV source and a battery

7

respectively which the output port is connected to a load. This topology has advantages of simple structure, high integration, high power density, small size, and weight.

Figure 1-7 Overview of Supply, Active Power Filter (APF) and Load, which drives a compressor of an Electrical Environmental Control System (E-ECS)

Milijana [10] proposed a three phase multilevel active shunt filter with a low switching frequency to mitigate the lowest order carrier frequency terms. Low carrier frequencies lead to reference voltage phase delay and attenuation and can introduce significant baseband harmonics. In addressing these problems, Milijana proposed an improved modulation approach in this work that allows duty cycle updating (N-1) times per switching period for each H-bridge of one phase of the N-level converter rather than only once or twice as in the regularly sampled PWM. Griffo [11] introduced a design optimization of passive DC filters for aerospace applications. A procedure for the design and optimization of passive DC filters is introduced, aiming at the minimization of the total filter weight with guaranteed stability
8

margins and power quality performances at 10kHz switching frequency. Griffo concluded that for a given filter topology, the proposed optimization procedure minimizes filter weight while satisfying stability and power quality constraints. Also, the proposed procedure is flexible enough to be easily extended to design optimization of single or multi-load systems with more complex filter topologies.

Figure 1-8 Aircraft Onboard Power Grid

Naayagi [12] proposed a new model that produces equations for root mean square (RMS) and average device currents and RMS and peak inductor or transformer currents to the steady state analysis of the bidirectional dual active bridge (DAB) DC-DC converter. The proposed model can serve as an important teaching-cum-research tool for DAB hardware design for devices and passive components selection, soft switching operating range estimation, and performance prediction at the design stage. This part of the thesis provided the background information of electrical power converter system used in aircrafts. It summarized the development stages of the power generation towards the MEA power converter systems. It also discussed about the related study conducted in the relevant field with optimizing the weight of the aircraft power converter system. Several example studies that are conducted within the recent years are discussed in detail with the proposed topologies presented by the authors.
9

Figure 1-9 The PWM+SSPS FB-TPC Topology proposed by Xiaoqing

1.5 Thesis Motivation and Objective Three phase voltage source PWM converter is among the most widely used power electronics converters for power conversion application in many areas. Reducing the power loss of a converter without increasing volume or cost in hardware has always been a much challenging goal [21]. Soft-switching full-bridge inverters have been proposed to reduce the switching loss even at high switching frequencies. However, soft-switching inverters require auxiliary switches and diodes, which in some configurations require even higher ratings than those of the main switches [22]. Switching frequency is usually fixed for PWM methods for three-phase converters for design and control convenience [23]. Simply treating the switching frequency to be constant could lose an important freedom for system performance improvement. Besides constant switching frequency PWM, variable switching frequency PWM is going to be developed to utilize the variable of switching frequency [23]. Optimal variable switching frequency scheme to reduce the combined switching loss and inductor core loss of a single phase grid connected inverter has been introduced in the past decade to be used for generic applications while meeting a given THD requirement without hardware changes [21] ­ [27]. Variable switching frequency scheme has not been introduced yet in aerospace industry as the research is underway for other types of converters and single phase grid connected inverters used in generic applications to improve the efficiency of the
10

converter system. For aerospace industry, weight of the overall system is more important than the efficiency of the system. As per the detailed literature review on the researches conducted on optimization of aerospace power converter systems in the above section of this thesis, it's concluded that the methods proposed are using newly introduced hardware. This thesis is mainly focused on a method to select the best switching frequency for the existing system considering the inductor of the output LC filter design while optimizing the overall system weight and efficiency. This method can be implemented without major hardware changes to the power converter system used in aerospace applications. This thesis mainly focused on the DC-AC side inverter along with the LC filter of the VSCF power converter system used in aerospace applications. Figure 1-10 shows the schematic of the studied three phase two level inverter along with the LC filter and the motor drive. The main objective of this thesis is to design the LC filter inductor for each switching frequency within the range of 9kHz to 20kHz by minimizing the weight and power loss of the inductor. Once the LC filter is designed for each switching frequency, based on the total weight and the power loss of the studied partial system, the appropriate switching frequency can be selected for specific application. At first, the equations for output voltage, , and load current, , have been

defined as (1.1) and (1.2) shown where Vdc is the DC voltage, line voltage, is RMS phase load current, and

is the output line to

is phase angle of the load.

Figure 1-10 Schematic of Three-Phase Inverter with LC Filter and RL Load
11

(1.1)

(1.2)

The output voltages are generated by an IGBT based PWM inverter and the switching ripple is filtered by a LC filter. In low power supplies, the switching frequency of the inverter may be increased in order to reduce the need for filtering [3]. However, at higher power levels, the switching frequency is limited by the switching devices. Since the supply frequency is 400Hz, the 7th harmonic has a maximum frequency of 2.8kHz. As an example, 50kW, 540VDC, 0.8pf motor drive, 3-phase 2 level 400Hz system is analyzed by varying the frequency and designing the inductor using the proposed method in this thesis. For the example design, using (1.3) ­ (1.6) the base values are calculated. The example calculations are shown below for the example design discussed in this thesis. In this example design, VLL is used as 220V. (1.3)

(1.4)

(1.5)

(1.6)

12

1.5.1 Research Questions and Methodology Overview In general, increasing switching frequency is an effective way to reduce passive components and increase power density, until the increased loss in switching devices and in passive components outweigh the benefit of the increased frequency [13]. Therefore, there will be an optimal switching frequency which depends on the system for a specific application. The resonant frequency fres of the LC filter can be selected using (1.7) where fo is the fundamental frequency 400Hz used in aerospace applications, and Lf, Cf are LC filter inductor and capacitor, respectively. (1.7)

As shown in (1.7), when the fo is 400Hz, the filter frequency fres has to be minimum 2kHz. In that case, switching frequency has to be higher than 2kHz. This is the reason in this thesis, the lower frequency studied is set as 9kHz. Also for the maximum frequency for the selected range is set as 20kHz as the IGBT modules can be used without de-rating them which will avoid additional modules add weight to the overall electric power system. Aircraft electrical loads can be broadly categorized into subsystem controllers and avionics systems, electrically powered actuation, lighting, and heating. Because of the constantly increasing power demand onboard of an aircraft, higher voltage levels are required [28]. Power quality issue for AC electrical systems can cause efficiency and operational problems. Harmonics can exist in aircraft that utilize primary generation of constant frequency AC [29]. The type of the particular converter in an aircraft depends on the supplying voltage and especially the converters which have an AC input or output voltage need filters or power factor corrections to reduce the harmonics which are produced by a rectifier or the inverter [7]. In aircraft applications, all loads have to abide fix harmonic current rules. The ratios of allowed harmonic currents are referenced to the fundamental component of the load current. Therefore, all loads have to use filters to eliminate the harmonics.
13

This thesis focused on designing the LC filter for each switching frequency using the proposed method. After the LC filter parameter values are obtained, the inductor of the LC filter is designed using the optimization method to reduce the weight of the inductor. Once the optimal design of the inductor is finalized for each switching frequency within the selected range as discussed above in this thesis, the power loss of the inverter is calculated. Finally, using the weight of the inductor and the power loss of the inverter, optimization model is obtained to minimize the weight of the power converter system used in aerospace applications. Using the objective function and the constraints, the best switching frequency selection method proposed is analysed. 1.5.2 Scope of Work and Study Limitation This thesis builds on the scoping study recently conducted in reducing the weight of the inverter and LC filter inductor used in aerospace electric power system. Main scope of this thesis is to propose a method to choose the best switching frequency for each power converter system used in aerospace application. This study also generalizes the method for generic applications where the weight is not the major driving factor compares to the power loss of the overall system. In this study, the power loss of the inverter is considered to choose the heatsink size needed to cool the inverter. The heatsink weight and the inductor weight are considered when drawing the conclusion for each aerospace application where the power loss is not as important as the weight in aerospace applications. Around half of the electrical power distribution system weight is caused by the converters approximately 400kg at short- and midrange aircraft [30]. Therefore, a weight optimization of these internal converters can highly contribute to the weight reduction of the whole electrical power system. For example, saving one kilogram in the equipment means also a possible weight reduction of the aircraft structure and the engine by an additional 600g [7]. Saving of 1.6kg of the aircraft weight translates into lower fuel consumption and an extended performance. Saving one kilogram of weight will reduce costs by approximately $4500 at a short and midrange aircraft over a 20 year period operation [7], [29].
14

The limitation of this study is that the capacitor weight is not considered in the objective function when optimizing the total weight of the power converter system used in aerospace applications. In addition to that, the proposed method was limited in conducting the experiment for verification of the results. The proposed method is partially verified using de-rated power converter system and the available existing inductor in the lab without redesigning the entire inductor using the design parameters proposed in this thesis for LC filter inductor design. Therefore, the experimental results verify the methods and calculations proposed in this thesis. 1.6 Thesis Outline This thesis is organized to provide the detailed information about the research work on the method proposed for the selection of best switching frequency for aerospace power converter system in six chapters. Chapter one presents the background information about the electrical power system used in aerospace industry followed by the literature review. In addition, this chapter states the motivation and the objectives of this research. Chapter two presents the details of the selection of passive components for the power converter used for aerospace applications for each switching frequency within the selected range. Chapter three provides the LC filter inductor design by giving the details about the selection of magnetic material, core for the optimized inductor design considering the weight and efficiency. It also discusses the loss calculation of the inductor. Chapter four analyzes the optimization of the overall power converter system weight by giving importance to the inverter efficiency as its contributing to the heatsink weight. This chapter talks about the inverter loss calculation followed by the objective function.

15

Chapter five partially verifies the method proposed for optimizing the overall weight by the selection of best switching frequency. This chapter presents a complete analysis about the simulation and experimental verification. Finally, chapter six concludes the research in this thesis and list the major contributions and other issues that require further research.

16

CHAPTER 2 SELECTION OF PASSIVE COMPONENTS 2.1 Introduction In this chapter, output passive LC filter component selection method is proposed using the VSCF electric power system used in aerospace applications. For the selection of LC filter a single phase analysis is conducted as shown in Figure 2-1 with RL load.

Figure 2-1 Schematic of Single Phase Inverter with LC Filter and RL Load

Using the equation (2.1), the impedance value of the load, ZLoad, is calculated as shown below. Once the ZLoad is calculated, by eliminating the XLoad using the equations (2.2) and (2.3) as shown below, equation (2.4) is obtained. Using the equation (2.4), RLoad is calculated with the known variable pf. Then by submitting the RLoad value to the equation (2.3), XLoad value is calculated. At the end, using the equations (2.5) and (2.6), the LLoad value is calculated. Now the load parameters are ready for calculating the passive LC filter components inductor, Lf, and capacitor, Cf.

17

(2.1)

(2.2)

(2.3)

(2.4)

(2.5)

(2.6) 2.2 Sinusoidal Pulse Width Modulation Technology Among all PWM schemes, Sinusoidal Pulse Width Modulation (SPWM) is one of the most popular and simple methods utilized in power inverter and motor control fields [31]. As shown in Figure 2-2, modulated sine wave is compared with the triangular wave. When the instantaneous value of the triangle wave is less than that of the sine wave, the PWM output signal is in high level, 1, as shown in Figure 2-3 and otherwise it is turned into the low level, 0 [31].

18

Figure 2-2 SPWM Signal Generation

Figure 2-3 Sinusoidal PWM of a Two-Level Voltage Source Inverter

The principle of the sinusoidal PWM scheme for the two-level inverter is illustrated by the three phase sinusoidal modulating waves and the triangular carrier wave [32]. The fundamental frequency component in the inverter output voltage can be controlled by amplitude modulation index ma. Normally, ma is adjusted by varying the modulating waves while keeping the carrier waves fixed. Equation (2.7) shows the relationship between the peak values of the modulation wave, for calculating the modulation index, ma. , and the carrier wave,

19

(2.7)

2.3 Selection of Inductor for the Passive Output Filter In this paper a first order passive LC filter is used in the output side as discussed in the above section. Using (2.8) and (2.9), Lf value can be calculated where Lf is the LC filter inductor, is the ripple current, DIGBT is the duty cycle of the IGBT, ma is the is phase angle of the inverter. DIGBT is changing with time. In

modulation index, and

the equation (2.8), there are two unknown variables such as Lf and . Using the equations (2.8) and (2.9), the relationship (2.10) is obtained.

(2.8)

(2.9)

(2.10)

For one switching period, a number of instantaneous samples, fsw / fo, have been selected where fsw is the switching frequency and fo is the fundamental frequency. In this study, the fundamental frequency used as 400Hz since the power converter system is used for aerospace industry. For each time instance, using the boundaries of sine as -1 and 1, the maximum and minimum value of Lf is obtained for each time instant. Matlab is used for the calculation and the code is attached in Appendix A. Figure 2-2 shows the values obtained for half switching cycle for 15kHz switching frequency with 30% current ripple. Number of points, N, selected for half cycle are 18 as shown in the
20

equation (2.11).

(2.11)

In Figure 2-4, inductance needed for the sample points for half cycle are shown in red. As shown in Figure 2-4, the selected inductance value marked with red circle. In order to consider the worst case scenario of the system behavior, the optimum point selected is the minimum point from the graph in red. The firing angle, , of the inverter

is almost zero degrees since the voltage drop across the filter inductor is very small. In this example design, the value of inductor at 15kHz for the 50kW, 540VDC, 0.8pf is 0.102mH.

350 300

Inductance (H)

250 200 150 0.102mH 100 50 0 0.00 0.17 0.34 0.50 0.67 0.84 1.01 1.17 1.34 1.51 1.68 1.84 2.01 2.18 2.35 2.51 2.68 2.85

t

Figure 2-4 LC Filter Inductor Values for Half Switching Cycle at 15kHz

Analyzing the values of Lf calculated for one switching cycle, worst case scenario
21

Lf has been selected for the LC filter which can handle the highest ripple current for that specific switching frequency. Figure 2-5 shows the inductance value selected for the Lf for each switching frequency within the range 9kHz to 20kHz for the example design of 50kW, 540VDC, 0.8pf where the is selected as 30%.

200 180 160

Inductance (H)

140 120 100 80 60 40 20 0 9 10 11 12 13 14 15 16 17 18 19 20

Switching Frequency (kHz)
Figure 2-5 Selected Inductance Value versus Switching Frequency

This inductor calculation method is used for several example systems for building a test model for verifying the proposed calculation method. Table 2-1 shows the calculated optimum values of LC filter inductor.

22

Table 2-1 Inductor Values versus the Switching Frequency for Various Examples 50kW, Switching 540VDC, 0.8pf, Frequency RL Load (kHz) Lf (mH) 0.1718 9 0.1535 10 0.1391 11 0.1288 12 0.1177 13 0.1094 14 0.1023 15 0.0956 16 0.0902 17 0.0851 18 0.0805 19 0.0768 20 50kW, 540VDC, 1.0pf, R Load Lf (mH) 0.2147 0.1919 0.1739 0.1610 0.1471 0.1368 0.1279 0.1195 0.1128 0.1063 0.1006 0.0960 10kW, 540VDC, 0.8pf, RL Load Lf (mH) 0.8588 0.7676 0.6957 0.6441 0.5885 0.5472 0.5117 0.4779 0.4511 0.4253 0.4025 0.3838 10kW, 540VDC, 1.0 pf, R Load Lf (mH) 1.0735 0.9595 0.8696 0.8051 0.7356 0.6841 0.6397 0.5974 0.5639 0.5316 0.5032 0.4798 10kW, 400VDC, 1.0 pf, R Load Lf (mH) 0.2860 0.2498 0.2240 0.2145 0.1894 0.1769 0.1665 0.1535 0.1464 0.1371 0.1294 0.1249

2.4 Selection of Capacitor for the Passive Output Filter Once the Lf is calculated, using the trial and error method in Matlab Simulink model, LC filter capacitor, Cf, value has been selected by meeting the THD of 5%. The Matlab Simulink model is attached in Appendix B. Figure 2-6 is one of the Fast Fourier Transform (FFT) waveform in selecting the Cf value with the THD value and the fundamental current shown for 60 cycles. Figure 2-7 shows the capacitance value obtained for Cf for each switching frequency using the Matlab simulation trial and error method to maintain the THD less than 5%. This procedure is followed for each switching frequency to select the inductor for the worst case scenario so that the inductor and capacitor selected for the LC filter is sufficient for the entire switching period.

23

Figure 2-6 The Fast Fourier Transform (FFT) Waveform for one Example
9 8 7

Capacitance (C)

6 5 4 3 2 1 0 9 10 11 12 13 14 15 16 17 18 19 20

Switching Frequency (kHz) Figure 2-7 Obtained Capacitance Value versus Switching Frequency

24

CHAPTER 3 INDUCTOR DESIGN Inductors are common component and they can be one of the most massive and lossy components in a power electronic based devices. Therefore, reducing the size and loss of this component can have a significant impact in the overall design of high efficiency, power dense power electronic converters [33]. In the field of power electronics remarkable improvements in switching devices have enabled a decrease in switching loss and an increase in switching frequency for PWM converters. These advances have enabled a reduction of volume of magnetic components such as inductors and transformers. However, in general, the temperature rise caused by the power loss is noticeable in small magnetic components [34]. Hence, accurate loss evaluation and loss measurement of inductors and transformers becomes to be an important issue in designing higher power density converters. 3.1 Selection of Magnetic Material The magnetic material is the paramount player in the design of magnetic components. Most magnetic core materials are poor conductors of magnetic flux and they have low permeability. Figure 3-1 shows the effect of exciting a completely demagnetized, ferromagnetic material, with an external magnetizing force, H, and increasing it slowly, from zero, where the resulting flux density is plotted as a function of the magnetizing force, H [35]. When the magnetic material is taken through a complete cycle of magnetization and demagnetization, the results is shown in a graph which is called Hysteresis Loop. Permeability is the ability of a material to conduct flux and the magnitude of the permeability at a given induction is the measure of the ease with which a core material can be magnetized to that induction [35]. Today, the magnetic materials that can be selected are silicon steel, nickel iron (permalloy), cobalt iron (permendur), amorphous metallic alloys, and ferrites. From this group of magnetic materials, a trade-off will be made with the magnetic properties that are saturation, Bs, permeability, , resistivity, , remanence Br, and coercivity Hc for the specific selected design of the magnetic component. Thus, the choice of magnetic
25

material is based upon achieving the best characteristic using the standard trade-off such as cost, size, and performance.

Figure 3-1Typical Magnetization Curve

In the recent years, so called nanocrystalline soft magnetic materials enjoyed more and more acceptance in modern power electronic designs because of the undisputed excellent performance and improved price level in combination with the availability from several sources worldwide [36]. The nanocrystalline soft magnetic alloy is available on the market since several years now under the brand names of Finemet, Vitroperm, or Nanoperm [37]. Initially, with a quite simple but revolutionary production technology very thin ribbon is produced from low cost raw materials like silicon and iron. The result is a new generation of material with extraordinary soft magnetic properties almost with high flux swing of silicon steel combined with the even improved high frequency performance of ferrites, namely low losses and high permeability [36] - [40].
26

In this study, the inductor, Lf, is designed using nanocrystalline core since as discussed above, it is an iron based material with a saturation of 1.2T flux density and is well suited for high frequency transformers and gapped inductors. The high frequency core loss for the nanocrystal 500F is lower than some ferrite, even operating at a high flux density [34]. Therefore, its relatively high saturation flux density, combined with its incredible low loss and high permeability through a wide frequency range, makes it useful in many applications like high frequency or broadband transformers, broadband current sensors, high frequency filter chokes (inductors), and pulse transformers [38]. Table 3-1 shows the magnetic properties for the selected nanocrystal Vitroperm 500F where Vitroperm is the trademark of Vacuumschmelze [35]. Figure 3-2 shows the B-H loop of Vitroperm 500F material where in has 73.5% Fe, 15.5% Si, and 1% Cu.

Table 3-1 Magnetic Properties for Selected Amorphous Material
Major Compositi on 73.5% Fe, 1% Cu, 15.5% Si Initial Permea bility i 30K 80K Flux Density Tesla Bs 1.0 1.2 Curie Temperature °C DC, Coercive Force, Hc Oersteds Density grams/cm3  Weight Factor x

Material Name

Nanocrystal Vitroperm 500F

460

0.02 - 0.04

7.73

1.013

27

Figure 3-2 Vitroperm 500F Material B-H Loop 3.2 Selection of Magnetic Core To design the three phase inductor, EE core has been selected with the geometrical parameter relationships by introducing the core ratio, Cratio, where the core width and depth are related and window ratio, Wratio, where the window width and height are related to one other. Fairly new development of nanocrystalline soft magnetic material can be manufactured with no limitation to the types of cores such as C-cores, E-cores, uncased toroids, cased toroids, multiple cuts, gapped toroids, etc [38]. Figure 3-3 shows the details of the geometrical dimensions of the EE core used to design the three phase inductor with the air gap.

28

Figure 3-3 EE Core with Geometrical Dimensions 3.3 Optimization of Inductor Design By eliminating the core cross section area, Ac, using the relationships shown in (3.1) and (3.2) where Bmax is the maximum flux density of the core and the Imax is the RMS current of the inductor, the relationship between the gap length, lg, and the number of turns, N, can be derived as (3.3). The purpose of the gap is to store energy and to prevent the core from saturating under load. Using the equation (3.3), the number of turns is selected carefully by minimizing the weight and power loss of the inductor using Matlab optimization. The code for selecting the number of turns using the Matlab code is shown in Appendix C. In order to use these relationships in the initial stage, it is assumed that the reluctance of core, of the gap, is much smaller than the reluctance

, and the reluctance of core is ignored. Using the selected number of

turns and the calculated air gap length, Ac is calculated using the equation (3.4).

29

(3.1)

(3.2)

(3.3)

(3.4)

Using the calculated value Ac, and the relationship Cratio as shown in the equation (3.5), the core width, W, and the depth, D, is calculated. Window area Wa, is calculated using the relationship shown in the equation (3.6) where Aw is the copper cross sectional area. Similar to Cratio, using the window ratio, Wratio, the width of the window, Ww, and the height of the window, Wh, is calculated using the equation (3.7).

(3.5)

(3.6)

(3.7)

Final air gap dimension requires the consideration of the effect of fringing flux, which is a function of gap dimension, the shape of the pole faces, and the shape, size, and the location of the winding [35]. Fringing flux decreases the total reluctance of the magnetic path and increases the inductance by a factor, F, as shown in the equation (3.8). Using the calculated fringing factor, the new number of turns is calculated using
30

the equation (3.9) shown. Table 3-2 lists the contact parameters used in designing the inductor and K, n, and m values of nanocrystaline core as per the design handbook [35].

(3.8)

(3.9)

Table 3-2 Parameter Values used for Inductor Design Parameters Window Utilization Factor, Ku Usable Wound Area, S2 Usable Window Area, S3 Current Density, J Values 0.4 0.60 0.75 800A/cm
2

Parameters Coefficient, K Coefficient, n Coefficient, m Coefficient, Ki

Values 0.864x10-6 2.112 1.834 0.155

For the inductor design of this example, the ratios of core and window areas are optimized as 0.75. This design procedure is repeated for each switching frequency with the calculated switching frequency dependent inductor for the LC filter. Appendix D includes the Matlab code for finding out the optimized new number of turns. 3.3.1 Inductor Weight Calculation Core weight is multiplication of the core weight density and the volume of the core [11]. Also for the copper weight it is the multiplication of the copper weight density, total length, ltot, and the conductor cross sectional area, Aw, as shown in the

equation (3.10). The weight of the inductor is calculated by totaling the weight of the copper and core. Figure 3-4 shows the inductor total weight for each switching frequency.
31

(3.10)

2.90

Inductor Weight (kg)

2.70

2.50

2.30

2.10

1.90

1.70 9 10 11 12 13 14 15 16 17 18 19 20

Switching Frequency (kHz) Figure 3-4 Inductor Weight versus Switching Frequency

3.3.2 Inductor Loss Calculation An inductor is a current filtering device and by resisting change in current, the filter inductor essentially accumulates stored energy as AC current crests each cycle, and releases that energy as it minimizes [41]. Loss calculation is done for the newly designed inductor based on the design parameters and property constants from the design book as shown in the above chapters. When the loss of the inductor is considered, there are three different types of losses such as inductor core loss, copper loss, ,

and gap loss, Pgap. Maximum efficiency is reached in an inductor

when the copper loss and core loss are equal in other words where the gap loss is zero [35]. The gap loss does not occur in the air gap itself but, is caused by magnetic flux
32

fringing around the gap and re-entering the core in a direction of high loss. As the air gap increases, the flux across the gap fringes more and more and some of the fringing flux strikes the core perpendicular to the laminations, and sets up eddy currents which cause additional losses called gap losses. In this study, the gap loss is very small and negligible. Therefore, the total loss of the inductor is the summation of copper and core loss. The matlab code used to calculate the inductor losses are included in Appendix D. 3.3.2.1 Inductor Core Loss When designing the inductor there are two magnetic properties that are AC and DC. One of the most important AC magnetic properties is the core loss. The AC core loss is a function of the magnetic material, magnetic material thickness, magnetic flux density Bac, frequency f, and operating temperature. As shown in (3.11), the core loss is presented in the form of an equation. Resistivity, , of the copper is used as 1.724/cm. Vcore is the volume of the core, Bdc is the dc flux density and Bac is the ac flux density. The unit for this core loss equation is watts/kilogram. For Vitroperm 500, the coefficient K, m, and n are 0.864x10-6, 1.834, and 2.112, respectively. Table 3-3 shows the calculated core loss for the example power converter system of 50kW, 540VDC, 0.8pf used in this study for the frequency ranges between 9kHz and 20kHz. The core loss is in Watts.

(3.11) Bdc can be calculated using the relationship shown below in equation (3.12) where the Bsat is 1.2T used in this study.

(3.12)

33

Table 3-3 Inductor Core Loss Values between the Switching Frequencies 9kHz and 20kHz Fsw (kHz) 9 10 11 12 13 14 15 16 17 18 19 20 Inductor Lf(mH) 0.1718 0.1535 0.1391 0.1288 0.1177 0.1094 0.1023 0.0956 0.0902 0.0851 0.0805 0.0768 Core Loss Pcore(W) 1849.11 2042.81 2244.23 2437.19 2589.57 2735.91 2904.98 3023.05 3160.30 3250.23 3328.46 3445.77

3.3.2.2 Inductor Copper Loss Normally, standard magnet wire is available in three different materials such as copper, aluminum, and silver. But most commonly used is copper even though aluminum is less weight and silver has the highest conductivity. Since the copper wire is used in this study for designing inductor, copper loss of the inductor is produced by the magnet wire used for the winding of the inductor can be calculated using the winding resistance Rdc as shown in equation (3.13). Using the wire table for AWG 10 to 44 data, the bare wire area, Aw, can be calculated. For calculating the total length of the winding, mean length turn will be multiplies by the number of turns as shown in equation (3.14) below. Once the winding resistance is calculated for the copper wire, the copper loss can be calculated as shown in the equation (3.15). When selecting the wire for high frequency, normally the wire is selected where the relationship between ac and dc resistance is 1. The skin effect is also neglected.

34

(3.13)

(3.14)

(3.15)

Table 3-4 shows the calculated copper loss for the example power converter system of 50kW, 540VDC, 1.0pf used in this study for the frequency ranges between 9kHz and 20kHz. The copper loss is in Watts.

Table 3-4 Inductor Copper Loss Values between the Switching Frequencies 9kHz and 20kHz Fsw (kHz) 9 10 11 12 13 14 15 16 17 18 19 20 Inductor Lf(mH) 0.1718 0.1535 0.1391 0.1288 0.1177 0.1094 0.1023 0.0956 0.0902 0.0851 0.0805 0.0768 Copper Loss Pcopper(W) 333.82 322.60 312.24 300.61 288.72 279.84 272.14 260.60 255.71 247.29 235.54 228.44

35

3.4 Summary of Optimized Inductor Design Figure 3-5 below shows the flowchart for the optimized inductor design used in this chapter. As explained in detail above about how the inductor is designed by minimizing the weight of the inductor using the proven algorithm, this flowchart shows the steps in detail. When considering the weight optimization, the importance was given to reduce the weight of the inductor. Therefore, the power loss of the inductor is higher than expected as shown in Table 3-3 and 3-4. This weight optimized design method is repeated for each switching frequency where for each switching frequency, the inductor value is different as mentioned above.

Figure 3-5 Flowchart for the Optimized Design of the Filter Inductor Lf

36

Table 3-5 and 3-6 shows the optimized inductor design parameter values for the example system of 50kW, 540VDC, 0.8pf used in this study. Table 3-5 The Inductor Design Parameter Values for Frequencies 9kHz to 14kHz Fsw Lf (mH) Nnew lg (cm) W (cm) D (cm) Wh (cm) Ww (cm) Cratio Wratio Weight (g) Volume (cm3) 9000 0.1718 67 0.93 1.52 2.02 6.09 8.13 0.75 0.75 1365.55 254.46 10000 0.1535 62 0.79 1.43 1.90 5.60 7.47 0.75 0.75 1115.07 205.88 11000 0.1391 57 0.76 1.45 1.94 5.51 7.35 0.75 0.75 1147.22 209.33 12000 0.1288 54 0.66 1.37 1.83 5.12 6.82 0.75 0.75 950.36 172.26 13000 0.1177 49 0.64 1.42 1.89 5.03 6.71 0.75 0.75 1012.30 180.43 14000 0.1094 47 0.56 1.34 1.78 4.72 6.29 0.75 0.75 846.11 150.37

Table 3-6 The Inductor Design Parameter Values for Frequencies 15kHz to 20kHz Fsw Lf (mH) Nnew lg (cm) W (cm) D (cm) Wh (cm) Ww (cm) Cratio Wratio Weight (g) Volume (cm3) 15000 0.1023 44 0.56 1.38 1.84 4.70 6.27 0.75 0.75 900.65 158.50 16000 0.0956 42 0.49 1.31 1.75 4.42 5.89 0.75 0.75 767.18 134.35 17000 0.0902 39 0.48 1.35 1.80 4.36 5.82 0.75 0.75 817.49 141.25 18000 0.0851 37 0.43 1.31 1.74 4.11 5.48 0.75 0.75 720.89 123.61 19000 0.0805 35 0.42 1.34 1.78 4.10 5.46 0.75 0.75 758.38 129.02 20000 0.0768 33 0.37 1.30 1.73 3.85 5.13 0.75 0.75 679.44 114.36

37

CHAPTER 4 OPTIMIZATION 4.1 Inverter Loss Calculation This chapter aims at the calculation of power losses in IGBT based power electronic inverter used in this study. The three phase IGBT inverter is consist of three same structure phases, and the current and voltage waveforms in each phase are almost the same, which only have a certain phase lag. Thus, it can take one phase as shown in Figure 2-10 to calculate the power loss, and then multiply 3 to get the total power loss of the inverter [42]. IGBT and Diode power losses, PTot_Loss, can be divided in three groups such as conduction loss, Pcond, switching loss, Psw, and blocking or leakage loss, Pb [43]. Normally blocking losses are being neglected. Therefore, the total losses can be shown as (4.1). Matlab code used to calculate the inverter loss in this study is attached in Appendix E.

(4.1) 4.1.1 Conduction Loss of the Inverter IGBT conduction losses can be calculated using an IGBT approximation with a series connection of DC voltage source Vce0 representing IGBT on-state zero-current collector-emitter voltage and a collector-emitter on-state resistance rc. The equations for calculating conduction loss of IGBT and diode are shown in the equation (4.2) where VCE is the voltage across the collector to emitter of IGBT and VF is the forward voltage of the freewheeling Diode. The datasheet is used for calculating the losses of the inverter SEMITRANS IGBT modules.

(4.2)

38

Table 4-1 lists the conduction loss for each IGBT and Diode along with the total conduction loss for six IGBTs and six Diodes for the specific example design of 50kW, 540VDC, 1.0pf used in this study. 4.1.2 Switching Loss of the Inverter The equations for calculating switching loss of IGBT and diode are shown in (4.3). The IGBT turn-on and turn-off energy loss is named as Eon and Eoff, respectively. Similarly, the turn-on energy in the diode is named as Erec. These values can be taken from the manufacturer SEMITRANS IGBT Datasheet.

(4.3)

Table 4-1 Inverter Conduction Loss for Switching Frequencies between 9kHz and 20kHz Fsw (kHz) IGBT Conduction Loss Pcond,IGBT (W) Diode Conduction Loss Pcond,Diode(W) Total Conduction Loss Pcond (W)

9 10 11 12 13 14 15 16 17 18 19 20

348.84 362.77 376.47 388.47 399.34 406.00 411.79 422.14 424.47 429.33 432.86 437.88

103.10 106.76 110.36 115.49 118.42 120.09 121.49 125.47 125.99 127.22 128.05 130.14

451.94 469.53 486.82 503.95 517.76 526.09 533.29 547.61 550.46 556.55 560.91 568.02

39

Table 4-2 lists the switching loss for each IGBT and Diode along with the total conduction loss for six IGBTs and six Diodes for the specific example design of 50kW, 540VDC, 0.8pf used in this study. This table lists the calculated switching losses for the switching frequencies ranges between 9kHz and 20kHz which is the range selected to study in this thesis. The total loss of the inverter is the summation of the conduction and switching loss of the IGBT and diode. Figure 4-1 shows the inverter total loss for each switching frequency for the example design. From the shape of the graph, it can be seen that the inverter total loss is proportionally increase with the switching frequency. The graph is almost a straight line which increase very fast when the switching frequency is increased within the selected range.

Table 4-2 Inverter Switching Loss for Switching Frequencies between 9kHz and 20kHz IGBT Switching Loss Psw,IGBT (W) Diode Switching Loss Psw,Diode(W)

Fsw (kHz)

Total Switching Loss Psw (W)

9 10 11 12 13 14 15 16 17 18 19 20

543.65 614.61 687.57 778.69 853.87 925.04 995.91 1090.74 1159.43 1232.49 1303.81 1393.41

357.89 400.76 444.60 505.96 550.86 593.84 636.67 699.81 741.60 785.48 828.52 889.16

901.54 1015.37 1132.17 1284.65 1404.74 1518.88 1632.58 1790.56 1901.03 2017.97 2132.33 2282.57

40

3000.00 2500.00

Inverter Loss (W)

2000.00 1500.00 1000.00 500.00 0.00 9 10 11 12 13 14 15 16 17 18 19 20

Switching Frequency (kHz) Figure 4-1 Inverter Total Loss versus Switching Frequency 4.2 Optimization of the Weight of the Overall Power System The DC to AC power converter system design is optimized by selecting the best switching frequency by designing the output LC filter inductor. Design of the inductor is depending on the power rating, Po, of the system and the selection of the geometrical parameter ratios Cratio, Wratio, and N are selected by minimizing the power loss, weight, and volume of the power converter system. Since this design is for aerospace applications, the credence given for each of those components is not equal because weight is the driving factor in aerospace over the power loss. In other words, it doesn't mean that the excessive loss can be tolerated since heatsink is in effect to handle the power loss of the inverter. Heatsink also contributes to the overall system weight. Therefore, to maintain a balance in choosing the best frequency for each application, the optimization problem is rearranged with the one common variable .

41

4.2.1 Design Variables Weight of the inverter exclude the heatsink is fixed and it is not depending on the switching frequency. Therefore, in this study, the weight of the inductor and the heatsink is considered in selection of the best frequency. The low converter weight typically means that a reduced amount of material is used and for stationary power supplies allows for simple installation, handling, and maintenance, which is particularly important for mobile system such as hybrid vehicles and more electric aircraft apart from low volume requirement [45]. The weight of the heatsink is approximated with the coefficient C1 with the unit of kg/kW and the total power loss of the inverter as shown in equation (4.4). (4.4) Many studies have been done on optimization of converter heat sink with a target to achieve minimum thermal resistance while using air as a coolant, and only few of them have taken weight into consideration [44]. Currently, power density of the commercially available converters is only 3kW/kg for air cooling [44] ­ [45]. Capriz [46] compared different air cooling technologies to dissipate 6kW originated by 6 IGBT modules with 1kW/each. 4.2.2 Objective Function In an optimization problem, the design variable values that maximize or minimize a given objective function must be determined. In this study, this objective function is the total weight of the DC to AC power converter system used in aerospace applications expressed as a function of the design variable fsw, Po and C1 as discussed above. The goal is to obtain the best frequency that minimizes this objective function shown in equation (4.5). In equation (4.5), a, b, and c are the weight factors for each weight components which reflect the percentage contribution to the total converter weight. In this study, a, b, and c are set as 1 while using SI units in the calculations since the weight considered here is the actual weight of the components.
42

(4.5) 4.2.3 Formulation of the Optimization Problem The design variable values that minimize the objective function must be found, but subject to several constraints defined according to the design specifications, physical limitations, etc. These constraints are specified in the following.

Po = Constant (50kW), and 9kHz < 4.2.4 Optimization Results Figure 4-2 shows the estimated weight of the heatsink needed for the inverter of the design example where the C1 is used as 0.66 for pressed hollow fins.
2.00 1.80

< 20kHz

Heat Sink Weight (kg)

1.60 1.40 1.20 1.00 0.80 0.60 9 10 11 12 13 14 15 16 17 18 19 20

Switching Frequency (kHz) Figure 4-2 Weight of Heatsink versus Switching Frequency Figure 4-3 shows the total weight of the heatsink and inverter and it is the optimized results tradeoff curve of the design sample for selection of the switching frequency. This tradeoff curve can be used as a Pareto frontier in decision making
43

process.
3.80 3.75 3.70

Total Weight (kg)

3.65 3.60 3.55 3.50 3.45 3.40 3.35 9 10 11 12 13 14 15 16 17 18 19 20

Switching Frequency (kHz) Figure 4-3 Weight of the Heatsink and Inductor versus Switching Frequency 4.3 Optimization Summary From Figure 4-3, it can be seen that the lowest weight is at 11kHz for the example design. Based on the results shown in Figure 4-3, the weight is not changing significantly between 11kHz and 15 kHz. Therefore, for the example design studied in this thesis, the best switching frequency selected for aerospace application while optimizing the inductor design is 15kHz considering the reasonable application parameters for this specific example. At this 15kHz switching frequency, the filter inductor and capacitor values are 0.102mH and 3.08C respectively. This procedure can also be extended to generic cases to find the best switching frequency where the weight is not an important driving factor in deciding the best switching frequency. In generic applications, weight and volume are not the major

deciding factors and applications are depending on the system efficiency.

44

CHAPTER 5 SIMULATION AND EXPERIMENT 5.1 Introduction The verification for the method proposed in this study has been done in two different ways. First using the Matlab Simulink simulation model attached in Appendix B, the simulation is conducted to obtain the current and voltage waveforms of the example design. Then, choosing few points, experiment is conducted for partially verify the power loss calculation of the inverter system. For partially verifying the calculations, a de-rated power converter system is used due to the components availability at the power lab. The converter system used to verify the results is 10kW, 540VDC, 1.0pf. Figure 5-1 shows the simulation and experimental setup used to verify the power loss calculation for the inverter. For this partial verification, open-loop control is used. Figure 5-2 shows the back to back Voltage Source Inverter (VSI) used to conduct the experiment for this study. The VSI used in this experiment is a pre existing model which is not commercially available yet and it is being used for other projects under test at the lab. In this experiment, DSP 28335 FPGA V2 board is used for generating the PWM signal using the Code Composer Studio (CCS) tool. The CCS code has been modified to run this experiment. Experiment has some limitations when conducted for high voltage rating. Therefore, the experiment was conducted not only for the de-rated system, but also for the unity power factor where the load is purely resistive.

Figure 5-1Experimental Setup for Power Loss Verification
45

Figure 5-2 Back to Back Voltage Source Inverter Version 2 5.2 Verification by Simulation In order to verify the optimized method proposed in this thesis, the model is built in Matlab Simulink as shown in Appendix B. By generating the SPWM signal for the 3phase IGBT inverter, the output filter inductor current, inductor voltage, load current, load voltage, and the filter capacitor current and voltage are verified. Also, the using FFT function, the THD% is verified to meet the 5% as expected. This 10kW, 540VDC,

46

1.0pf, 2 level, 3 phase system is selected for simulation due to compare the results obtained using the laboratory experiment. 5.3 Verification by Experiment The experiment is setup using the DSP 28335 FPGA V2 board for Voltage Source Inverter as shown in Figure 5-3. Partial CCS code used to generate the PWM signal is attached in Appendix F. Figure 5-3 shows the setup to test the PWM signal generated for the inverter with 400Hz frequency.

Figure 5-3 Experiment Setup for VSI with FPGA LCD Display used to run PWM Signal

Once the PWM signal is verified by running the code at a personal computer with the installed CCS tool, the code is transfered to the FPGA board with LCD display. Once the code is transfererd to the board, the VSI can run the PWM signal to complete
47

the experiment with the applied input power on. Two fans were attached to the VSI heatsink to aircool the system from overheating. For the experiment, only the DC to AC inverter is needed to be used. Therefore, the DC power supply with the rating 600VDC 20A is used to supply the power to energize the experimental setup. The experiment was conducted with the three phase existing 0.55mH inductor model CRX0031CC Hammond PO from the lab. This inductor is used as the output LC filter Lf component. Figure 5-4 shows the three phase Cf capacitor setup using the combinations of 0.5mF, 1mF, and 2mF capacitors in parrallel to make 3mF for each phase. Three phase resitor load used for this experiment has 25 units where each of this unit is 120 and all of them are connected in parrallel to each and 4.8 respectively.

other to use the maximum and minimum resistance of 120

Figure 5-4 below shows the experiment setup from the DC to AC side inverter of output filter. The DC side power the the AC side power is measured using the wide band power analyzer system. The voltages and curents were also measured using this power analyzer.

Figure 5-4 Three-Phase DC to AC Power Converter Connected with Output LC Filter

48

5.4 Simulation and Experiment Results Discussion The experiment is conducted selecting few points to verify the calculation results. Figure 5-5 shows the waveform image taken directly from the oscilloscope used to measure the waveforms during the experiment for partial power loss verification. In this figure, channel 1 waveform in yellow the line to line inverter output voltage, channel 3 waveform in violet is the voltage across the LC filter capacitor and channel 4 waveform in green is the inductor current for phase A. Figure 5-6 shows the simulation and experiment results for phase A inductor current. This was obtained for 400VDC at 18kHz switching frequency. The experimental graph shown in Figure 5-6 is the graph same as shown in Figure 5-5 other than it is drawn using Microsoft Excel with the points obtained from the oscilloscope as comma separated values.

Figure 5-5 Oscilloscope Waveforms for Line-to-Line Inverter Voltage, Filter Capacitor Voltage, and Inductor Current for Phase A

49

From Figure 5-6 experiment results graph, it can be seen that at the peak of the inductor current graph, the current ripple is high as it reaches the saturation. Other than the peaks, the ripple is as expected and similar to the simulation results graph.

40

Experiment Results
30

Inductor Current IA_ind (A)

20 10 0 -10 -20 -30

Time
-40

40

Simulation Results
30

Inductor Current IA_ind (A)

20 10 0 -10 -20 -30 -40

Time

Figure 5-6 Phase A Inductor Current for both Experiment and Simulation for 400VDC

50

Figure 5-7 shows the inverter line to line voltage between phase A and B for both experiment and simulation results. This result is obtained with 400VDC at 18kHz switching frequency with the points obtained from the oscilloscope as comma separated values using Microsoft Excel. The experiment results of the inverter output voltage waveform has the spikes because of the sampling issues due to the high frequency of 18kHz used for this experiment. The modulation index used is 0.898 with 400Hz frequency. However, due to the lack of compensation of line impedance, high spikes are visible in the experimental waveform shown in Figure 5-7.
600

Inverter Voltage VAB (V)

400 200 0 -200 -400 -600

Experiment Results

Time

Inverter Voltage VAB (V)

600 400 200 0 -200 -400 -600

Simulation Results

Time

Figure 5-7 Inverter Line-to-Line Voltage for Experiment and Simulation with 400VDC

Figure 5-8 below shows the inverter current for phase A when the DC voltage is 500V. Due to the high current of 17.873A, cannot conduct the experiment at this high voltage as the power supply used has the maximum rated current as 20A. Therefore, power loss verification is done at 400VDC as shown below.

51

In order to validate the power loss calculation conducted using matlab code, the experiment results image obtained. The loss calcualtion is conducted using the equations (4.2) and (4.3) as discussed in Chapter 4. The code used to do the inverter loss calculation is attached in Appendix G. The value obtained for the inverter loss from the Matlab simulation is 555.5646W. From experiment, the inverter loss can be obtained as 565.21W. Equations (5.1) ­ (5.3) shows the calculations in detail. From experiment, the P1, P2, P3 are the AC invereter output power for three phases A, B, and C respectively. P4 is the input DC side of the power. Equation (5.4) shows the error percentage obtained between the calculated value and the experimental results. Similary, Table 5-1 lists the results obtained for different voltage values such as 500VDC, 270VDC and 186VDC to validate the experiment results.

Figure 5-8 Oscilloscope Waveforms for Inductor Current for Phase A at 500VDC

Total Output Power

= =

P1 + P2 + P3 1.67701 kW + 1.65525 kW + 1.62833 kW
52

(5.1)

= Total Input Power = = Total Power Loss = = = Error % = = =

4960.59 W I4 x V4 13.819 (A) x 399.87 (V) = 5525.80 W Total Input Power ­ Total Output Power 5525.80 (W) ­ 4960.59 (W) 565.21 W (5.3) (5.2)

(5.4) 1.736%

Table 5-1 Power Loss Calculation and Experiment Results Total Output Power (W) 500VDC 400VDC 270VDC 186VDC 7836.25 4960.59 2235.31 1043.86 Total Input Power (W) 8689.56 5525.8 2522.26 1188.01 Experimental Total Power Loss (W) 853.31 565.21 286.95 144.15 Calculated Total Power Loss (W) 851.78 555.38 275.21 164.14 Error (W) (%) 1.53 0.18% 9.65 1.74% 11.74 4.09% 19.99 12.18%

This error percentage obtained between the experimental results and the simulation results are due to the fact that the inductor used in the experiment is not the inductor designed using the optimization method proposed. When the voltage is reduced, the error percentage is high because the loss calculation is based on the ripple current but the measured value is not considering the ripple. Meter errors are also the contributors for the results variations between experimental and simulation. Simulation
53

is conducted using the lossless components such as ideal switches and elements. In addition, the experiment is conducted for the inverter side of the back to back voltage source converter. Both the converter and inverter are unscrewed for avoiding the additional power loss at the converter side.

54

CHAPTER 6 CONCLUSIONS 6.1 Conclusions This thesis studied the selection of optimal switching frequency for the power converter system used in aerospace applications by minimizing the loss, weight, and volume. There is an optimal switching frequency for lowest weight in the design stage. In one hand, the size of the heatsink increases with increasing losses of the power converter system. On the other hand, the inductor size decreases with the increasing switching frequency. In order to find an optimal switching frequency, a method has been developed in this thesis. Firstly, the design of the LC filter for each switching frequency is proposed. Secondly, the proven design algorithm of the filter inductor is proposed by calculating the weight and loss of the inductor. In this design process, the inductor is designed by minimizing the weight over the efficiency of the inductor. Lastly, the inverter loss is calculated for converting it to heatsink weight by a simplified method. The loss calculation of the inverter and inductor is verified by a reduced rated system. This partially verifies the algorithm developed in this study. In this study, it is concluded that there is an optimal switching frequency in the design stage of the power converter systems. 6.2 Major Contributions In this research project, the major contribution is the method proposed for selecting the optimal switching frequency in the design stage of aircraft power converter systems. The simulation and experimental results verify the accuracy of the proposed method. 6.3 Future Work Inductor prototypes will be developed to test the simulation results for the switching frequencies with the existing inverter system similar to the design example.
55

Inductor design procedures can also be changed for different types of core shapes and materials to experiment the results.

56

APPENDICES APPENDIX A
Code for Selection of LC Filter Inductor
%********************************************************** % Variables Definition %********************************************************** clc Vdc = 270; %dc voltage Po = 50000; % output Power Vout = 220; % output voltage line to line Ir = 0.30; % Current Ripple Vr = 0.02; % Voltage Ripple fsw = 9000; % switching frequency ma = 0.8; % modulaton index pf = 1.0; % power factor Theta = acos(pf); % phase shift between the output voltage and current fout = 400; % output frequency %****************************************************** % Voltage and Current Waveforms Definition %****************************************************** %wt = 0 : fout * 2 * pi / fsw : ( fsw / 2 - fout ) * 2 * pi / fsw; % switching interval define (half AC cycle) wt=0 : fout*2*pi/fsw : (fsw-fout)*2*pi/fsw; %switching interval define N = fsw / 2 / fout; % number of sample (half AC cycle) n = fix(N); %****************************************************** % Load Current and Voltage Calculation %****************************************************** Iload = Po / (sqrt(3) * Vout * pf); % Io rms phase rms current Vo = Vout / sqrt(3); % Vout phase voltage %****************************************************** % Load Resistor and Inductance Calculation %****************************************************** Zload = 3 * Vo.^2. * pf / Po; % Output impedance Rload = Zload / sqrt(1+(tan(acos(pf)).^2)); % a + jb =>> r = sqrt(a^2 + b^2), theta = arctan(b/a) Xload = tan(acos(pf)) * Rload; Lload = Xload / (2 * pi * fout); L = 1; for i = 1:n W = wt(i); Lmax = (Vdc - (sqrt(2) * Vo * sin(W))) * (0.5 + (0.5 * ma))/ (Ir*Iload*fsw); Lmax_1(i) = Lmax; Lmin = (Vdc - (sqrt(2) * Vo * sin(W))) * ( 0.5 - (0.5 * ma))/ (Ir*Iload*fsw);

57

Lmin_1(i) = Lmin; if (L >= Lmax) L = Lmax; VL = 270 - (sqrt(2)*Vo * sin(W)); iload = sqrt(2) * Iload * abs(sin(W - Theta)); alpha = asin((((Lmin * 0.30* Iload * fsw)/(270-(sqrt(2)*Vo*sin(W))))-0.5)/(0.5 * 0.8))- W; Duty_IGBT = 0.5 + 0.5 * ma * sin(W + alpha); % duty cycle of IGBT Duty_Diode = 0.5 - 0.5 * ma * sin(W + alpha); % duty cycle of Diode end end

58

APPENDIX B
Matlab Simulation Simulink Model with PWM Signal Generation

59

60

APPENDIX C
Inductor Design Step 1
clc; L = 0.083e-3; fsw = 20000; Irms = 205.7; f = 400; % for nano crystaline Bmax = 1.2; % Testla or HA/m^2 K = 0.864e-6; m = 1.834; n = 2.112; weight_den_fe = 7.73; % weight density of core in grams/cm3

%Io = Ipeak/1.15; % Ipeak = Io + (IrIo/2) Ir = 0.30; Io = Irms / (sqrt(1 + Ir.^2));

Iripple = Ir * Io; uo = 4 * pi * 1e-7; % permiability H/m Cratio = 0.75; WF = 0.75; Ku = 0.4; Ki = 0.1550; % when using AWG #24 %AwB = 2.0470e-3; % bare copper area in cm2 %Aw = 2.5140e-3; % wire area = copper area + insulation in cm2 Aw = Irms/800; % Wire Area in cm2 where J is 8A/mm2 %resistivity = 842.1e-6; % resistivity ohms/cm at 20 deg C resistivity = 1.724e-6; % resistivity ohms/cm at 20 deg C weight_len_cu = 0.01884; % weight density of copper in grams/cm S2 = 0.60; % usable window / wound area S3 = 0.75; % usable window area for i = 1:256 N(i) = i; lgm(i) = N(i) * Irms * uo / Bmax; % in meters lgcm(i) = lgm(i) * 1e2; % in cm Acm(i) = lgm(i) * L / (uo * N(i).^2); %Core cross sectional area m2 Accm(i) = Acm(i) * 1e4; W(i) = sqrt(Accm(i) * Cratio); % Width of the core cm D(i) = W(i)/Cratio; %Depth of the core in cm Wa(i) = 2 * N(i) * Aw / (S2 * S3); % Window Area cm2 Ww(i) = sqrt(Wa(i)/WF); % Window Width cm

61

Wh(i) = WF * Ww(i); % Window Height cm winding_fac(i) = Ku * Wa(i) / Aw; if (N(i) < winding_fac(i)) F(i) = 1 + ((lgcm(i)/sqrt(Accm(i)))*log(2*Wh(i)/lgcm(i))); if (F(i) > 0) Nnew(i) = round(sqrt((lgm(i) * L) /(uo * Acm(i) * F(i) ))); lgm_new(i) = Nnew(i) * Irms * uo / Bmax; % in meters lgcm_new(i) = lgm_new(i) * 1e2; % in cm Acm_new(i) = lgm_new(i) * L / (uo * Nnew(i).^2); %Core cross sectional area m2 Accm_new(i) = Acm_new(i) * 1e4; %Core cross sectional area cm2 W_new(i) = sqrt(Accm_new(i) * Cratio); % Width of the core cm D_new(i) = W_new(i)/Cratio; %Depth of the core in cm Wa_new(i) = 2 * Nnew(i) * Aw / (S2 * S3); % Window Area cm2 Ww_new(i) = sqrt(Wa_new(i)/WF); % Window Width cm Wh_new(i) = WF * Ww_new(i); % Window Height cm winding_fac_new(i) = Ku * Wa_new(i) / Aw; if (Nnew(i) < winding_fac_new(i)) MLT(i) = 2 * (D_new(i) + W_new(i)); % Mean Length Turn cm R(i) = Nnew(i) * MLT(i) * resistivity / Aw; Pcu(i) = 3 * R(i) * Irms.^2; % Total Copper Loss Bac(i) = uo * Nnew(i) * F(i) * (Iripple/2) / lgm_new(i); Bdc(i) = Bmax - (Bac(i)/2); mWg_dc(i) = K * (f.^m) * (Bdc(i).^n); mWg_ac(i) = K * (fsw.^m) * (Bac(i).^n); mWg(i) = mWg_dc(i) + mWg_ac(i); Volfe(i) = ((W_new(i) + W_new(i) + Wh_new(i)) * (W_new(i) + W_new(i) + W_new(i) + Ww_new(i) + Ww_new(i)) * D_new(i)) - 2 * (Ww_new(i) * Wh_new(i) * D_new(i))- 3 * (W_new(i) * lgcm_new(i) * D_new(i)); % Volume of the core in cm3 if (Volfe(i) > 0) N_valid(i) = N(i); N_valid_new(i) = Nnew(i); Wtfe(i) = weight_den_fe * Volfe(i); % weight of Core in grams Wtcu(i) = weight_len_cu * MLT(i) * Nnew(i); % weight of Core in grams Volcu(i) = Aw * Nnew(i) * MLT(i); Total_weight(i) = Wtfe(i) + Wtcu(i); Pfe(i) = mWg(i) * Wtfe(i) * 1e-3; % Total Core Loss Watts Pg(i) = Ki * W_new(i) * 1e-2 * lgm_new(i) * f * Bac(i).^2; % Total Gap Loss Watts Pind_tot(i) = Pcu(i) + Pfe(i) + Pg(i); % Total Inductor Loss in Watts Ap(i) = Wa_new(i) * Accm_new(i); Volume(i) = 19.7 * Ap(i).^(3/4); %cm3 Weight(i) = 68.2 * Ap(i).^(3/4); % grams end end end

62

end end

The following is the graphs generated to find out the optimum value for number of turns for inductor while optimizing the weight and size of the inductor: figure(1) plot(N, Volfe, 'G') figure(2) plot(N,Wtfe, 'R') figure(3) plot(N, Pind_tot, 'B') figure(4) plot(N, lgcm_new, 'C') figure(5) plot(N, Nnew, 'Y') figure(6) plot(N, Pg, 'B') figure(7) plot(N, Pfe, 'B') %plot(N, Volfe/100, 'G', N,Wtfe/100, 'R', N, Pind_tot, 'B', N, lgcm_new, 'C', N, Nnew, 'Y', N, Pg, '-', N, Pfe, 'M') figure (8) plot(N, Volfe/100, 'G', N,Wtfe/100, 'R', N, Pind_tot, 'B', N, lgcm_new, 'C', N, Nnew, 'Y', N, 1e4*Pg, '-', N, 10*Pfe, 'M')

63

APPENDIX D
Inductor Design Step 2
clc; L = 0.083e-3; fsw = 20000; Irms = 205.7; N = 31; f = 400; % for nano crystaline Bmax = 1.2; % Testla or HA/m^2 K = 0.864e-6; m = 1.834; n = 2.112; weight_den_fe = 7.73; % weight density of core in grams/cm3

%Io = Ipeak/1.15; % Ipeak = Io + (IrIo/2) Ir = 0.30; Io = Irms / (sqrt(1 + Ir.^2));

Iripple = Ir * Io; uo = 4 * pi * 1e-7; % permiability H/m Cratio = 0.75; WF = 0.75; Ku = 0.4; Ki = 0.1550; % when using AWG #24 AwB = 2.0470e-3; % bare copper area in cm2 %Aw = 2.5140e-3; % wire area = copper area + insulation in cm2 Aw = Irms/800; % Wire Area in cm2 where J is 8A/mm2 %resistivity = 842.1e-6; % resistivity ohms/cm at 20 deg C resistivity = 1.724e-6; % resistivity ohms/cm at 20 deg C weight_len_cu = 0.01884; % weight density of copper in grams/cm S2 = 0.60; % usable window / wound area S3 = 0.75; % usable window area

lgm = N * Irms * uo / Bmax; % in meters lgcm = lgm * 1e2; % in cm Acm = lgm * L / (uo * N.^2); %Core cross sectional area m2 Accm = Acm * 1e4; W = sqrt(Accm * Cratio); % Width of the core cm D = W/Cratio; %Depth of the core in cm Wa = 2 * N * Aw / (S2 * S3); % Window Area cm2 Ww = sqrt(Wa/WF); % Window Width cm Wh = WF * Ww; % Window Height cm

64

MLT = 2 * (D + W); % Mean Length Turn cm R = N * MLT * resistivity / Aw; Pcu = 3 * R * Irms.^2; % Total Copper Loss F = 1 + ((lgcm/sqrt(Accm))*log(2*Wh/lgcm)); Bac = uo * N * F * (Iripple/2) / lgm; Bdc = Bmax - (Bac/2); mWg_dc = K * (f.^m) * (Bdc.^n); mWg_ac = K * (fsw.^m) * (Bac.^n); mWg = mWg_dc + mWg_ac; Volfe = ((W + W + Wh) * (W + W + W + Ww + Ww) * D) - 2 * (Ww * Wh * D)- 3 * (W * lgcm * D); % Volume of the core in cm3 Wtfe = weight_den_fe * Volfe; % weight of Core in grams Wtcu = weight_len_cu * MLT * N; % weight of Core in grams Volcu = Aw * N * MLT; Total_weight = Wtfe + Wtcu; Total_Volume = Volcu + Volfe; Pfe = mWg * Wtfe * 1e-3; % Total Core Loss Watts Pg = Ki * W * 1e-2 * lgm * f * Bac.^2; % Total Gap Loss Watts Pind_tot = Pcu + Pfe + Pg; % Total Inductor Loss in Watts Ap = Wa * Accm; Volume = 19.7 * Ap.^(3/4); %cm3 Weight = 68.2 * Ap.^(3/4); % grams

65

APPENDIX E

Inverter Loss Calculation for 540VDC with Infineon 1700V IGBT Module
%efficiency test for two level Uc=540; %dc voltage Iphase=145.5; %phase rms current fsw=20000; %switching frequency ma=0.8; %modulaton index pf=1; %power factor alpha=acos(pf); %phase shift between the output voltage and current %alpha= 0; fout=400; %output frequency wt=0 : fout*2*pi/fsw : (fsw/2-fout)*2*pi/fsw; %switching interval define (half AC cycle) N=fsw/2/fout; %number of sample (half AC cycle) Duty_IGBT=0.5+0.5*ma*sin(wt+alpha); %duty cycle of IGBT Duty_Diode=0.5-0.5*ma*sin(wt+alpha); %duty cycle of Diode Ic=Iphase*sqrt(2)*abs(sin(wt)); Iavg_IGBT=sum(Ic.*Duty_IGBT)/N/2; %calculate the IGBT average current, divide 2 means per AC cycle average Iavg_Diode=sum(Ic.*Duty_Diode)/N/2; %calculate the Diode average current Irms_IGBT=sqrt(sum(Ic.^2.*Duty_IGBT)/N/2); %calculate the IGBT rms current Irms_Diode=sqrt(sum(Ic.^2.*Duty_Diode)/N/2); %calculate the Diode rms current %1700V module character Vce125=0.8+1.2*Ic/300; %IGBT voltage drop at 125 degree Vce150=0.75+1.35*Ic/300; Eon125=(2+15*Ic/300)*Uc/600; %IGBT turn on loss at 125 degree , in mJ Eon150=(2+18*Ic/300)*Uc/600; Eoff125=(2+35*Ic/300)*Uc/600;%IGBT turn off loss at 125 degree , in mJ Eoff150=(2+40*Ic/300)*Uc/600; Vf125=0.85+0.8*Ic/300;%diode voltage drop at 125 degree Vf150=0.8+0.85*Ic/300; Erec125=(6+24*Ic/300)*Uc/600;%diode reverse recovery loss at 125 degree , in mJ Erec150=(7.5+27*Ic/300)*Uc/600; %conduction loss calculation Pcon125_igbt=sum(Vce125.*Ic.*Duty_IGBT)/N/2; Pcon125_diode=sum(Vce125.*Ic.*Duty_Diode)/N/2; Pcon150_igbt=sum(Vce150.*Ic.*Duty_IGBT)/N/2; Pcon150_diode=sum(Vce150.*Ic.*Duty_Diode)/N/2; %switching loss calculation %there should be one and only one IGBT turn on and off in each switching cycle %as well as the diode Pswi125_igbt=sum(Eon125+Eoff125)/1000*fout; Pswi125_diode=sum(Erec125)/1000*fout; Pswi150_igbt=sum(Eon150+Eoff150)/1000*fout; Pswi150_diode=sum(Erec150)/1000*fout; %total loss for one switch Pigbt125=Pcon125_igbt+Pswi125_igbt;

66

Pigbt150=Pcon150_igbt+Pswi150_igbt; Pdiode125=Pcon125_diode+Pswi125_diode; Pdiode150=Pcon150_diode+Pswi150_diode; %total loss Ptotalswi125=(Pswi125_igbt+Pswi125_diode)*6; Ptotalswi150=(Pswi150_igbt+Pswi150_diode)*6; Ptotalcon125=(Pcon125_igbt+Pcon125_diode)*6; Ptotalcon150=(Pcon150_igbt+Pcon150_diode)*6; Ptotal125=Pigbt125*6+Pdiode125*6; Ptotal150=Pigbt150*6+Pdiode150*6; %create an output array for further calculation and demonstration Array(1,1)=Iavg_IGBT; Array(2,1)=Iavg_Diode; Array(1,2)=Irms_IGBT; Array(2,2)=Irms_Diode; Array(1,3)=Pcon125_igbt; Array(2,3)=Pcon125_diode; Array(1,5)=Pcon150_igbt; Array(2,5)=Pcon150_diode; Array(1,4)=Pswi125_igbt; Array(2,4)=Pswi125_diode; Array(1,6)=Pswi150_igbt; Array(2,6)=Pswi150_diode; Array(1,7)=Pigbt125; Array(2,7)=Pdiode125; Array(1,8)=Pigbt150; Array(2,8)=Pdiode150; Arraytotal(1,1)=Ptotal125; Arraytotal(1,2)=Ptotal150; Arraytotal(2,1)=Ptotalcon125; Arraytotal(2,2)=Ptotalcon150; Arraytotal(3,1)=Ptotalswi125; Arraytotal(3,2)=Ptotalswi150;

67

APPENDIX F
Partial Code for Generating the PWM Signal for FPGA Board of Voltage Source Inverter
float Detect_inverter_angle() { float inverter_angle; inverter_angle=((PWMB.PLL_modulus-PWMB.Phase)*DOUBLE_PI)/(PWMB.PLL_modulus+1); inverter_angle+=INVERTER_ANGLE_COMPENSATION; if (inverter_angle>=DOUBLE_PI) inverter_angle-=DOUBLE_PI; if (inverter_angle<0) inverter_angle+=DOUBLE_PI; return inverter_angle; } //************************************************************************************ float Calculate_load_angle() { static float load_angle=0; //calculate load side angle load_angle+=load_freq*PWM_PERIOD*4.188790205e-8;//4.188790205e-8=2*pi/150e6 corresponding to radians per each clock cycle if (load_angle>=DOUBLE_PI) load_angle-=DOUBLE_PI; if (load_angle<0) load_angle+=DOUBLE_PI; return load_angle; }

if (FPGA_fault){ //******************************************************************** PWMA.pattern.all=GATE_PATTERN_ALL(REC_S78,REC_S78,REC_S78,REC_S78);//send zero vector (shorted through phase N) PWMB.pattern.all=GATE_PATTERN_ALL(INV_S78,INV_S78,INV_S78,INV_S78);//send zero vector (shorted through phase N) */ POWER_GATE_A_DISABLE(); /*disable the gate signal to feed to the A side gate driver on power module*/ POWER_GATE_B_DISABLE(); PWMA.pattern.all=GATE_PATTERN_ALL(V0,V0,V0,V0);//send zero vector PWMB.pattern.all=GATE_PATTERN_ALL(V0,V0,V0,V0);//send zero vector //******************************************************************** //open the relay at both sides if (relay1) Relay_fan(0,relay1,FAN_PWM);//send the relay signal to left and open the relay to de-energize the module if (relay2) Relay_fan(1,relay2,FAN_PWM);//send the relay signal to left and open the relay to de-energize the module relay1=0; relay2=0; grid_enable=0; inverter_enable=0;

68

} else { load_vector.ma=0.665; load_vector.angle= load_vector.angle + (DOUBLE_PI/45); if(load_vector.angle < 0) load_vector.angle = load_vector.angle + DOUBLE_PI; if(load_vector.angle >= DOUBLE_PI) load_vector.angle = load_vector.angle DOUBLE_PI; //Cm3_monitor=load_vector.ma; //Cm4_monitor=load_vector.angle; //load_vector.ma = 0.8; //load_vector.angle = theta_inverter; //send the SVM signal at load side out if (inverter_enable) { Space_vector_modulation(&PWMB,load_vector,INVERTER); POWER_GATE_B_ENABLE(); } else { POWER_GATE_B_DISABLE(); PWMB.pattern.all=GATE_PATTERN_ALL(V0,V0,V0,V0);//send zero vector to A side (shorted through phase N) } Cm2_monitor=load_vector.angle; //*******************************************************************************/ }

69

APPENDIX G
Inverter Loss Calculation for 400VDC with SKM 75GD123D 1200V IGBT Module
%efficiency test for two level Uc=400; %dc voltage Iphase=18.24; %phase rms current fsw=18000; %switching frequency ma=0.898; %modulaton index pf=1; %power factor alpha=acos(pf); %phase shift between the output voltage and current %alpha= 0; fout=400; %output frequency wt=0 : fout*2*pi/fsw : (fsw/2-fout)*2*pi/fsw; %switching interval define (half AC cycle) N=fsw/2/fout; %number of sample (half AC cycle) Duty_IGBT=0.5+0.5*ma*sin(wt+alpha); %duty cycle of IGBT Duty_Diode=0.5-0.5*ma*sin(wt+alpha); %duty cycle of Diode Ic=Iphase*sqrt(2)*abs(sin(wt));

Iavg_IGBT=sum(Ic.*Duty_IGBT)/N/2; %calculate the IGBT average current, divide 2 means per AC cycle average Iavg_Diode=sum(Ic.*Duty_Diode)/N/2; %calculate the Diode average current Irms_IGBT=sqrt(sum(Ic.^2.*Duty_IGBT)/N/2); %calculate the IGBT rms current Irms_Diode=sqrt(sum(Ic.^2.*Duty_Diode)/N/2); %calculate the Diode rms current %1200V module character Vce125=2.0+0.5*Ic/13; %IGBT voltage drop at 125 degree Eon125=(1+5*Ic/20)*Uc/600; %IGBT turn on loss at 125 degree , in mJ Eoff125=(2+2*Ic/20)*Uc/600;%IGBT turn off loss at 125 degree , in mJ

Vf125=0.75+0.1*Ic/12.5;%diode voltage drop at 125 degree Erec125=(1+3.5*Ic/25)*Uc/600;%diode reverse recovery loss at 125 degree , in mJ %conduction loss calculation Pcon125_igbt=sum(Vce125.*Ic.*Duty_IGBT)/N/2; Pcon125_diode=sum(Vce125.*Ic.*Duty_Diode)/N/2; %switching loss calculation %there should be one and only one IGBT turn on and off in each switching cycle %as well as the diode Pswi125_igbt=sum(Eon125+Eoff125)/1000*fout; Pswi125_diode=sum(Erec125)/1000*fout; %total loss for one switch Pigbt125=Pcon125_igbt+Pswi125_igbt; Pdiode125=Pcon125_diode+Pswi125_diode; %total loss Ptotalswi125=(Pswi125_igbt+Pswi125_diode)*6; Ptotalcon125=(Pcon125_igbt+Pcon125_diode)*6; Ptotal125=Pigbt125*6+Pdiode125*6;

70

%create an output array for further calculation and demonstration Array(1,1)=Iavg_IGBT; Array(2,1)=Iavg_Diode; Array(1,2)=Irms_IGBT; Array(2,2)=Irms_Diode; Array(1,3)=Pcon125_igbt; Array(2,3)=Pcon125_diode; Array(1,4)=Pswi125_igbt; Array(2,4)=Pswi125_diode; Array(1,7)=Pigbt125; Array(2,7)=Pdiode125; Arraytotal(1,1)=Ptotal125; Arraytotal(2,1)=Ptotalcon125; Arraytotal(3,1)=Ptotalswi125;

71

REFERENCES [1] Fahad Alhuwaishel, Ahmed Morsy, and Prasad Enjeti, "A new active output filter (AOF) for variable speed constant frequency (VSCF) power system in aerospace applications," IEEE Energy Conversion Congress and Exposition (ECCE), pp. 5439 ­ 5446, 2015. [2] Malik E. Elbuluk and M. David Kankam, "Potential starter/generator technologies for future aerospace applications," Aerospace and Electronic Systems Magazine, IEEE, vol.12, no.5, pp.24,31, May 1997. [3] U. B. Jensen, P. N. Enjeti, and F. Blaabjerg, "A new space vector based control method for UPS systems powering nonlinear and unbalanced loads," Applied Power Electronics Conference and Exposition, 2000. [4] A. Rendusara and P. N. Enjeti, "An improved inverter output filter configuration reduces common and differential modes dv/dt at the motor terminals in PWM drive systems," IEEE Trans. Power Electron., vol. 13, no. 6, pp. 1135-1143, Nov., 1998. [5] Sebastian Liebig, Jurgen Engstler, and Alfred Engler, "Design and implementation of control algorithm for an active power filter in aviation", Power Electronics and Motion Control Conference (EPE/PEMC) 15th International, LS4a.3-1 ­ LS4a.3-8, 2012. [6] Akshay Sharma, Geet Krishna Capoor, and A.B. Chattopadhyay, "Advanced aircraft electrical systems to enable an All-Electric aircraft", International Conference on Electrical Systems for Aircraft, Railway, Ship Propulsion and Road Vehicles (ESARS), pp. 1 ­ 6, 2015. [7] Johannes Brombach, Torben Schroter, Arno Lucken, and Detlef Schulz, "Optimizing the weight of an aircraft power supply system through a +/- 270 VDC main voltage", 7th International Conference-Workshop Compatibility and Power Electronics (CPE), pp. 425-428, 2011. [8] E. A. Erdelyi, S. V. Ahamed, and R. E. Hopkins, "Design considerations and optimization of homopolar inductor alternators of aerospace power systems", IEEE Transcations on Aerospace and Electronic Systems, pp. 106-115, 1966.

72

[9] Xiaoqing Qin, Hongfei Wu, Junjun Zhang, and Yan Xing, "PWM+SSPS-controlled full-bridge three-port converter for aerospave power system", ITEC Asia-Pacific Conference, pp. 1-6, 2014. [10] Milijana Odavic, Veronica Biagini, Mark Sumner, Pericle Zanchetta, and Marco Degano, "Low carrier-fundamental frequency ratio pwm for multilevel active shunt power filters for aerospace applications", IEEE Transactions on Industry Applications, vol.49, issue 1, pp.159-167, 2013. [11] A. Griffo and J. Wang, "Design optimization of passive dc filters for aerospace applications", Power Electronics, Machines and Drives (PEMD), 5th IET International Conference, pp. 1-6, 2010. [12] R. T. Naayagi, Andrew J. Forsyth, and R. Shuttleworth, "High-power bidirectional dc-dc converter for aerospace applications", IEEE Transactions on Power Electronics, vol. 27, issue 11, pp. 4366-4379, 2012. [13] R.E.J. Quigley, "More Electric Aircraft", Applied power electronics conference and exposition, pp. 906-911, 1993. [14] J.S.Cloyd, "Status of the united states airforce's more electric aircraft initiative", IEEE Aerospace and Electronics Systems Magazine, pp, 17-22, 1998. [15] C.W. Cooper, "The development of voltage and frequency regulators for aircraft electrical systems", Proceedings of the IEE ­ Part A: Power Engineering, vol. 103, issue 1, pp. 170-179, 1956. [16] J. A. Rosero, J. A. Ortega, E. Aldabas, and L. Romeral, "Moving towards a more electric aircraft", IEEE Aerospace and Electronic Systems Magazine, vol. 22, no. 3, pp. 3-9, March 2007. [17] A. Eid, H EI-Kishky, M.Abdel-Salam, and T. EI-Mohandes, "VSCF aircraft electric power system performance with active power filters", 42nd Southeastern Sysmposium on System Theory (SSST), pp. 182 ­ 187, 2010. [18] A. Eid, H EI-Kishky, M.Abdel-Salam, and T. EI-Mohandes, "Constant frequency aircraft electric power systems with harmonic reduction", Industrial Electronics, IECON 2008 34th Annual Conference of IEEE, pp. 623-628, 2008.

73

[19] M.E. Elbuluk and M.D. Kankam, "Potential starter/generator technology for future aerospace application", IEEE Aerospace and Electronic Systems Magazine, vol. 11, issue 10, pp 17-24, 1996. [20] Roy Langton, Chuck Clark, Martin Hewitt, and Lonnie Richards, Aircraft Fuel Systems, First Ediso, United Kingdom: John Wiley & Sons Ltd., 2009. [21] Yinglai Xia and R. Ayyanar, "Optimal variable switching frequency scheme to reduce combined switching loss and inductor core loss of single phase grid connected inverter," IEEE Energy Conversion Congress and Exposition (ECCE), 2015. [22] X. Mao, R. Ayyanar, and H. K. Krishnamurthy, "Optimal variable switching frequency scheme for reducing switching loss in single-phase inverters based on time-domain ripple analysis," IEEE Trans. Power Electron., vol. 24, no. 4, pp. 991­ 1001, 2009. [23] Dong Jiang, and Fei Wang, "Variable switching frequency PWM for three-phase converters based on current ripple prediction", IEEE Transactions on Power Electronics, vol 28, issue 11, pp. 4951 ­ 4961, 2013. [24] Mahesh Swamy and Anupama Balakrishnan, "A novel energy saving method for use with variable frequency drives", IEEE Energy Conversion Congress and Exposition (ECCE), pp. 4880 ­ 4885, 2015. [25] Nidhi Haryani, Rolando Burgos, and Dushan Boroyevich, "Variable frequency and constant frequency modulation techniques for GaN based MHz H-bridge PFC", IEEE Applied Power Electronics Conference and Exposition (APEC), pp. 1889 ­ 1896, 2015. [26] Novixa A. Losci, "Passive vs. active AC-DC power conversion in variable frequency aerospace applications", IEEE Vehicle power and propulsion conference, pp. 1139 ­ 1144, 2009. [27] M. Kuisma, "Variable frequency switching in power supply EMI-control: an overview", IEEE Aerospace and Electronic Systems Magazine, pp. 18 ­ 22, 2003.

74

[28] B. H. Nya, J. Brombach, and D. Schulz, "Benefits of higher voltage levels in aircraft electrical power systems", Electrical Systems for Aircraft, Railway, and Ship Propulsion (ESARS), pp. 1-5, 2012. [29] Torben Schroeter and Detlef Schulz, "An approach for the mathematical description of aircraft electrical systems' load characteristics including electrical dependences validation", Electrical Systems for Aircraft, Railway, and Ship Propulsion, pp.1-6, 2010. [30] J. Brombach, M. Jordan, F. Grumm, and D.Schulz, "Converter topology analysis for aircraft application", Power Electronics, Electrical Drives, Automation and Motion (SPEEDAM) International Symposium, pp. 446-451, 2012. [31] Infineon Technologies, Microcontrollers, "XC164 different PWM waveforms generation for 3-phase AC induction motor with XC164CS", [Online]. Available: www.infineon.com/dgdl/xc164_po_v1.0_2002_02.pdf. [Accessed: June 29, 2016]. [32] B. Wu, High-Power Converters and AC Drives. New York/Piscataway: Wiley-IEEE Press, 2006. [33] G.M. Shane and S.D. Sudhoff, "Permanent magnet inductor design", IEEE Electric Ship Technologies Symposium, pp.330-333, 2011. [34] T. Shinizu, K. Kakazu, K. Takano, and H. Ishii, "Loss evaluation of AC filter inductor core on a PWM converter", Power Electronics and ECCE Asia (ICPE & ECCE), IEEE 8th International Conference, pp. 1047-1052, 2011. [35] C. W. T. McLyman, Transformer and Inductor Design Handbook. Third Edison, New York: Marcel Dekker, 2004. [36] MartinFerch, Magnetec GmbH, "Nanocrystalline core materials for modern power electronic designs, [Online]. Available:

www.magnetec.de/fileadmin/pdf/np_powerelectronic_e.pdf. [Accessed: August 03, 2016]. [37] Anne Roc'h and Frank Leferink, "Nanocrystalline core material for high-performance common mode inductors", IEEE Transactions on Electromagnetic Compatibility, pp. 785-791, 2012.

75

[38] MK

Magnetics

Inc,

Tap

Wound

Core

Specialists,

"A

Special

Product Available:

Announcement",

[Online].

http://www.mkmagnetics.com/nanocrystalline.shtml. [Accessed: August 03, 2016]. [39] Thiago de Carvalho Batista, Benedito Antonio, and Sebastian Yuri Cavalcanti Catunda, "Current transformer with nanocrystalline alloy core for measurement", Instrumentation and Measurement Technology Conference (I2MTC), pp. 1-4, 2011. [40] R. Prochazka, J. Hlavacek, K.Draxler, "Impulse Current Transformer with a nanocrystalline core", vol. 49, issue 1, pp. 77-80, 2013. [41] Magnetics, Division of Spang and Co., Mark A. Swihart, "Inductor cores ­ material and shape choices", [Online]. Available: www.mag-inc.com [Accessed: August 03, 2016]. [42] Rui Wu, Jia Liang Wen, Jian Han, Zhongyuan Chen, Quanqing Wei, Na Jia, and Chenghao Wang, "A power loss calculation method of IGBT three-phase SWPM converter", Intelligent System Design and Engineering Application (ISDEA), Second International Conference, pp. 1180 ­ 1183, 2012. [43] Infineon Technologies, Automotive Power, "IGBT power losses calculation using the datasheet parameters", [Online]. Available: www.infineon.com/ [Accessed: August 03, 2016]. [44] A. Sakanova, Shan Yin, Yong Liu, Kai Men, Jiyun Zhao, K. Y. See, K. J. Tseng, A. Nawawi, C. F. Tong, Yitao Liu, R. Simanjorang, C.J. Gajanayake, and A. K. Gupta, "Heatsink design for high power density converter in aircraft applications: parameter sensitivity analysis", International Conference on Electrical Systems for Aircraft, Railway, Ship Propulsion and Road Vehicles (ESARS), pp. 1 ­ 6, 2015. [45] Sukhvinder S. Kang, "Advanced cooling for power electronics", International Conference in Integrated Power Electronics Systems CIPS, 2012. [46] Ing Cesare Capriz, "Advanced cooling methods for high power density in electronics", Aavid Thermalloy, [Online]. Available: http://www.aavid.com/thermaltools/papers. [Accessed: August 03, 2016].

76

